import { __decorate } from "tslib";
import { Injectable } from '@angular/core';
import { HttpClient, HttpParams } from '@angular/common/http';
import { OccEndpointsService } from '../../services/occ-endpoints.service';
import { ConverterService } from '../../../util/converter.service';
import { COST_CENTER_NORMALIZER, COST_CENTERS_NORMALIZER, } from '../../../organization/connectors/cost-center/converters';
import { BUDGETS_NORMALIZER } from '../../../organization/connectors/budget/converters';
let OccCostCenterAdapter = class OccCostCenterAdapter {
    constructor(http, occEndpoints, converter) {
        this.http = http;
        this.occEndpoints = occEndpoints;
        this.converter = converter;
    }
    load(userId, costCenterCode) {
        return this.http
            .get(this.getCostCenterEndpoint(userId, costCenterCode))
            .pipe(this.converter.pipeable(COST_CENTER_NORMALIZER));
    }
    loadList(userId, params) {
        return this.http
            .get(this.getAllCostCentersEndpoint(userId, params))
            .pipe(this.converter.pipeable(COST_CENTERS_NORMALIZER));
    }
    loadActiveList(userId) {
        const params = new HttpParams().set('fields', 'DEFAULT,unit(BASIC,addresses(DEFAULT))');
        return this.http
            .get(this.getCostCentersEndpoint(userId), { params })
            .pipe(this.converter.pipeable(COST_CENTERS_NORMALIZER));
    }
    create(userId, costCenter) {
        return this.http
            .post(this.getCostCentersEndpoint(userId), costCenter)
            .pipe(this.converter.pipeable(COST_CENTER_NORMALIZER));
    }
    update(userId, costCenterCode, costCenter) {
        return this.http
            .patch(this.getCostCenterEndpoint(userId, costCenterCode), costCenter)
            .pipe(this.converter.pipeable(COST_CENTER_NORMALIZER));
    }
    loadBudgets(userId, costCenterCode, params) {
        return this.http
            .get(this.getBudgetsEndpoint(userId, costCenterCode, params))
            .pipe(this.converter.pipeable(BUDGETS_NORMALIZER));
    }
    assignBudget(userId, costCenterCode, budgetCode) {
        return this.http.post(this.getBudgetsEndpoint(userId, costCenterCode, { budgetCode }), null);
    }
    unassignBudget(userId, costCenterCode, budgetCode) {
        return this.http.delete(this.getBudgetEndpoint(userId, costCenterCode, budgetCode));
    }
    getCostCenterEndpoint(userId, costCenterCode) {
        return this.occEndpoints.getUrl('costCenter', { userId, costCenterCode });
    }
    getCostCentersEndpoint(userId, params) {
        return this.occEndpoints.getUrl('costCenters', { userId }, params);
    }
    getAllCostCentersEndpoint(userId, params) {
        return this.occEndpoints.getUrl('costCentersAll', { userId }, params);
    }
    getBudgetsEndpoint(userId, costCenterCode, params) {
        return this.occEndpoints.getUrl('costCenterBudgets', { userId, costCenterCode }, params);
    }
    getBudgetEndpoint(userId, costCenterCode, budgetCode) {
        return this.occEndpoints.getUrl('costCenterBudget', {
            userId,
            costCenterCode,
            budgetCode,
        });
    }
};
OccCostCenterAdapter.ctorParameters = () => [
    { type: HttpClient },
    { type: OccEndpointsService },
    { type: ConverterService }
];
OccCostCenterAdapter = __decorate([
    Injectable()
], OccCostCenterAdapter);
export { OccCostCenterAdapter };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2NjLWNvc3QtY2VudGVyLmFkYXB0ZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac3BhcnRhY3VzL2NvcmUvIiwic291cmNlcyI6WyJzcmMvb2NjL2FkYXB0ZXJzL29yZ2FuaXphdGlvbi9vY2MtY29zdC1jZW50ZXIuYWRhcHRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUUzQyxPQUFPLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRzlELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBQzNFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ25FLE9BQU8sRUFDTCxzQkFBc0IsRUFDdEIsdUJBQXVCLEdBQ3hCLE1BQU0seURBQXlELENBQUM7QUFDakUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sb0RBQW9ELENBQUM7QUFReEYsSUFBYSxvQkFBb0IsR0FBakMsTUFBYSxvQkFBb0I7SUFFL0IsWUFDWSxJQUFnQixFQUNoQixZQUFpQyxFQUNqQyxTQUEyQjtRQUYzQixTQUFJLEdBQUosSUFBSSxDQUFZO1FBQ2hCLGlCQUFZLEdBQVosWUFBWSxDQUFxQjtRQUNqQyxjQUFTLEdBQVQsU0FBUyxDQUFrQjtJQUNwQyxDQUFDO0lBRUosSUFBSSxDQUFDLE1BQWMsRUFBRSxjQUFzQjtRQUN6QyxPQUFPLElBQUksQ0FBQyxJQUFJO2FBQ2IsR0FBRyxDQUFpQixJQUFJLENBQUMscUJBQXFCLENBQUMsTUFBTSxFQUFFLGNBQWMsQ0FBQyxDQUFDO2FBQ3ZFLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLENBQUM7SUFDM0QsQ0FBQztJQUVELFFBQVEsQ0FDTixNQUFjLEVBQ2QsTUFBd0I7UUFFeEIsT0FBTyxJQUFJLENBQUMsSUFBSTthQUNiLEdB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TUFBYyxFQUNkLGNBQXNCLEVBQ3RCLE1BQWlEO1FBRWpELE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQzdCLG1CQUFtQixFQUNuQixFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUUsRUFDMUIsTUFBTSxDQUNQLENBQUM7SUFDSixDQUFDO0lBRVMsaUJBQWlCLENBQ3pCLE1BQWMsRUFDZCxjQUFzQixFQUN0QixVQUFrQjtRQUVsQixPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLGtCQUFrQixFQUFFO1lBQ2xELE1BQU07WUFDTixjQUFjO1lBQ2QsVUFBVTtTQUNYLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRixDQUFBOztZQTlIbUIsVUFBVTtZQUNGLG1CQUFtQjtZQUN0QixnQkFBZ0I7O0FBTDVCLG9CQUFvQjtJQURoQyxVQUFVLEVBQUU7R0FDQSxvQkFBb0IsQ0FpSWhDO1NBaklZLG9CQUFvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEh0dHBDbGllbnQsIEh0dHBQYXJhbXMgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBDb3N0Q2VudGVyQWRhcHRlciB9IGZyb20gJy4uLy4uLy4uL29yZ2FuaXphdGlvbi9jb25uZWN0b3JzL2Nvc3QtY2VudGVyL2Nvc3QtY2VudGVyLmFkYXB0ZXInO1xuaW1wb3J0IHsgVXNlckNvc3RDZW50ZXJBZGFwdGVyIH0gZnJvbSAnLi4vLi4vLi4vdXNlci9jb25uZWN0b3JzL2Nvc3QtY2VudGVyL3VzZXItY29zdC1jZW50ZXIuYWRhcHRlcic7XG5pbXBvcnQgeyBPY2NFbmRwb2ludHNTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvb2NjLWVuZHBvaW50cy5zZXJ2aWNlJztcbmltcG9ydCB7IENvbnZlcnRlclNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi91dGlsL2NvbnZlcnRlci5zZXJ2aWNlJztcbmltcG9ydCB7XG4gIENPU1RfQ0VOVEVSX05PUk1BTElaRVIsXG4gIENPU1RfQ0VOVEVSU19OT1JNQUxJWkVSLFxufSBmcm9tICcuLi8uLi8uLi9vcmdhbml6YXRpb24vY29ubmVjdG9ycy9jb3N0LWNlbnRlci9jb252ZXJ0ZXJzJztcbmltcG9ydCB7IEJVREdFVFNfTk9STUFMSVpFUiB9IGZyb20gJy4uLy4uLy4uL29yZ2FuaXphdGlvbi9jb25uZWN0b3JzL2J1ZGdldC9jb252ZXJ0ZXJzJztcbmltcG9ydCB7IEIyQlNlYXJjaENvbmZpZyB9IGZyb20gJy4uLy4uLy4uL29yZ2FuaXphdGlvbi9tb2RlbC9zZWFyY2gtY29uZmlnJztcbmltcG9ydCB7IE9jYyB9IGZyb20gJy4uLy4uL29jYy1tb2RlbHMvb2NjLm1vZGVscyc7XG5pbXBvcnQgeyBDb3N0Q2VudGVyIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWwvb3JnLXVuaXQubW9kZWwnO1xuaW1wb3J0IHsgRW50aXRpZXNNb2RlbCB9IGZyb20gJy4uLy4uLy4uL21vZGVsL21pc2MubW9kZWwnO1xuaW1wb3J0IHsgQnVkZ2V0IH0gZnJvbSAnLi4vLi4vLi4vbW9kZWwvYnVkZ2V0Lm1vZGVsJztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIE9jY0Nvc3RDZW50ZXJBZGFwdGVyXG4gIGltcGxlbWVudHMgQ29zdENlbnRlckFkYXB0ZXIsIFVzZXJDb3N0Q2VudGVyQWRhcHRlciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByb3RlY3RlZCBodHRwOiBIdHRwQ2xpZW50LFxuICAgIHByb3RlY3RlZCBvY2NFbmRwb2ludHM6IE9jY0VuZHBvaW50c1NlcnZpY2UsXG4gICAgcHJvdGVjdGVkIGNvbnZlcnRlcjogQ29udmVydGVyU2VydmljZVxuICApIHt9XG5cbiAgbG9hZCh1c2VySWQ6IHN0cmluZywgY29zdENlbnRlckNvZGU6IHN0cmluZyk6IE9ic2VydmFibGU8Q29zdENlbnRlcj4ge1xuICAgIHJldHVybiB0aGlzLmh0dHBcbiAgICAgIC5nZXQ8T2NjLkNvc3RDZW50ZXI+KHRoaXMuZ2V0Q29zdENlbnRlckVuZHBvaW50KHVzZXJJZCwgY29zdENlbnRlckNvZGUpKVxuICAgICAgLnBpcGUodGhpcy5jb252ZXJ0ZXIucGlwZWFibGUoQ09TVF9DRU5URVJfTk9STUFMSVpFUikpO1xuICB9XG5cbiAgbG9hZExpc3QoXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgcGFyYW1zPzogQjJCU2VhcmNoQ29uZmlnXG4gICk6IE9ic2VydmFibGU8RW50aXRpZXNNb2RlbDxDb3N0Q2VudGVyPj4ge1xuICAgIHJldHVybiB0aGlzLmh0dHBcbiAgICAgIC5nZXQ8T2NjLkNvc3RDZW50ZXJzTGlzdD4odGhpcy5nZXRBbGxDb3N0Q2VudGVyc0VuZHBvaW50KHVzZXJJZCwgcGFyYW1zKSlcbiAgICAgIC5waXBlKHRoaXMuY29udmVydGVyLnBpcGVhYmxlKENPU1RfQ0VOVEVSU19OT1JNQUxJWkVSKSk7XG4gIH1cblxuICBsb2FkQWN0aXZlTGlzdCh1c2VySWQ6IHN0cmluZyk6IE9ic2VydmFibGU8RW50aXRpZXNNb2RlbDxDb3N0Q2VudGVyPj4ge1xuICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBIdHRwUGFyYW1zKCkuc2V0KFxuICAgICAgJ2ZpZWxkcycsXG4gICAgICAnREVGQVVMVCx1bml0KEJBU0lDLGFkZHJlc3NlcyhERUZBVUxUKSknXG4gICAgKTtcbiAgICByZXR1cm4gdGhpcy5odHRwXG4gICAgICAuZ2V0PE9jYy5Db3N0Q2VudGVyc0xpc3Q+KHRoaXMuZ2V0Q29zdENlbnRlcnNFbmRwb2ludCh1c2VySWQpLCB7IHBhcmFtcyB9KVxuICAgICAgLnBpcGUodGhpcy5jb252ZXJ0ZXIucGlwZWFibGUoQ09TVF9DRU5URVJTX05PUk1BTElaRVIpKTtcbiAgfVxuXG4gIGNyZWF0ZSh1c2VySWQ6IHN0cmluZywgY29zdENlbnRlcjogQ29zdENlbnRlcik6IE9ic2VydmFibGU8Q29zdENlbnRlcj4ge1xuICAgIHJldHVybiB0aGlzLmh0dHBcbiAgICAgIC5wb3N0PE9jYy5Db3N0Q2VudGVyPih0aGlzLmdldENvc3RDZW50ZXJzRW5kcG9pbnQodXNlcklkKSwgY29zdENlbnRlcilcbiAgICAgIC5waXBlKHRoaXMuY29udmVydGVyLnBpcGVhYmxlKENPU1RfQ0VOVEVSX05PUk1BTElaRVIpKTtcbiAgfVxuXG4gIHVwZGF0ZShcbiAgICB1c2VySWQ6IHN0cmluZyxcbiAgICBjb3N0Q2VudGVyQ29kZTogc3RyaW5nLFxuICAgIGNvc3RDZW50ZXI6IENvc3RDZW50ZXJcbiAgKTogT2JzZXJ2YWJsZTxDb3N0Q2VudGVyPiB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFxuICAgICAgLnBhdGNoPE9jYy5Db3N0Q2VudGVyPihcbiAgICAgICAgdGhpcy5nZXRDb3N0Q2VudGVyRW5kcG9pbnQodXNlcklkLCBjb3N0Q2VudGVyQ29kZSksXG4gICAgICAgIGNvc3RDZW50ZXJcbiAgICAgIClcbiAgICAgIC5waXBlKHRoaXMuY29udmVydGVyLnBpcGVhYmxlKENPU1RfQ0VOVEVSX05PUk1BTElaRVIpKTtcbiAgfVxuXG4gIGxvYWRCdWRnZXRzKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGNvc3RDZW50ZXJDb2RlOiBzdHJpbmcsXG4gICAgcGFyYW1zPzogQjJCU2VhcmNoQ29uZmlnXG4gICk6IE9ic2VydmFibGU8RW50aXRpZXNNb2RlbDxCdWRnZXQ+PiB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFxuICAgICAgLmdldDxPY2MuQnVkZ2V0c0xpc3Q+KFxuICAgICAgICB0aGlzLmdldEJ1ZGdldHNFbmRwb2ludCh1c2VySWQsIGNvc3RDZW50ZXJDb2RlLCBwYXJhbXMpXG4gICAgICApXG4gICAgICAucGlwZSh0aGlzLmNvbnZlcnRlci5waXBlYWJsZShCVURHRVRTX05PUk1BTElaRVIpKTtcbiAgfVxuXG4gIGFzc2lnbkJ1ZGdldChcbiAgICB1c2VySWQ6IHN0cmluZyxcbiAgICBjb3N0Q2VudGVyQ29kZTogc3RyaW5nLFxuICAgIGJ1ZGdldENvZGU6IHN0cmluZ1xuICApOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdDxhbnk+KFxuICAgICAgdGhpcy5nZXRCdWRnZXRzRW5kcG9pbnQodXNlcklkLCBjb3N0Q2VudGVyQ29kZSwgeyBidWRnZXRDb2RlIH0pLFxuICAgICAgbnVsbFxuICAgICk7XG4gIH1cblxuICB1bmFzc2lnbkJ1ZGdldChcbiAgICB1c2VySWQ6IHN0cmluZyxcbiAgICBjb3N0Q2VudGVyQ29kZTogc3RyaW5nLFxuICAgIGJ1ZGdldENvZGU6IHN0cmluZ1xuICApOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLmh0dHAuZGVsZXRlPGFueT4oXG4gICAgICB0aGlzLmdldEJ1ZGdldEVuZHBvaW50KHVzZXJJZCwgY29zdENlbnRlckNvZGUsIGJ1ZGdldENvZGUpXG4gICAgKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBnZXRDb3N0Q2VudGVyRW5kcG9pbnQoXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgY29zdENlbnRlckNvZGU6IHN0cmluZ1xuICApOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLm9jY0VuZHBvaW50cy5nZXRVcmwoJ2Nvc3RDZW50ZXInLCB7IHVzZXJJZCwgY29zdENlbnRlckNvZGUgfSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0Q29zdENlbnRlcnNFbmRwb2ludChcbiAgICB1c2VySWQ6IHN0cmluZyxcbiAgICBwYXJhbXM/OiBCMkJTZWFyY2hDb25maWdcbiAgKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5vY2NFbmRwb2ludHMuZ2V0VXJsKCdjb3N0Q2VudGVycycsIHsgdXNlcklkIH0sIHBhcmFtcyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0QWxsQ29zdENlbnRlcnNFbmRwb2ludChcbiAgICB1c2VySWQ6IHN0cmluZyxcbiAgICBwYXJhbXM/OiBCMkJTZWFyY2hDb25maWdcbiAgKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5vY2NFbmRwb2ludHMuZ2V0VXJsKCdjb3N0Q2VudGVyc0FsbCcsIHsgdXNlcklkIH0sIHBhcmFtcyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0QnVkZ2V0c0VuZHBvaW50KFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGNvc3RDZW50ZXJDb2RlOiBzdHJpbmcsXG4gICAgcGFyYW1zPzogQjJCU2VhcmNoQ29uZmlnIHwgeyBidWRnZXRDb2RlOiBzdHJpbmcgfVxuICApOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLm9jY0VuZHBvaW50cy5nZXRVcmwoXG4gICAgICAnY29zdENlbnRlckJ1ZGdldHMnLFxuICAgICAgeyB1c2VySWQsIGNvc3RDZW50ZXJDb2RlIH0sXG4gICAgICBwYXJhbXNcbiAgICApO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldEJ1ZGdldEVuZHBvaW50KFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGNvc3RDZW50ZXJDb2RlOiBzdHJpbmcsXG4gICAgYnVkZ2V0Q29kZTogc3RyaW5nXG4gICk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMub2NjRW5kcG9pbnRzLmdldFVybCgnY29zdENlbnRlckJ1ZGdldCcsIHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIGNvc3RDZW50ZXJDb2RlLFxuICAgICAgYnVkZ2V0Q29kZSxcbiAgICB9KTtcbiAgfVxufVxuIl19