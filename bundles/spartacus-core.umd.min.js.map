{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","../../../projects/core/src/config/utils/deep-merge.ts","../../../projects/core/src/config/config-tokens.ts","../../../projects/core/src/config/config-providers.ts","../../../projects/core/src/anonymous-consents/config/default-anonymous-consents-config.ts","../../../projects/core/src/occ/utils/occ-constants.ts","../../../projects/core/src/window/window-ref.ts","../../../projects/core/src/routing/configurable-routes/config/routing-config.ts","../../../projects/core/src/routing/configurable-routes/routing-config.service.ts","../../../projects/core/src/routing/configurable-routes/url-translation/path-utils.ts","../../../projects/core/src/routing/configurable-routes/url-translation/url-parsing.service.ts","../../../projects/core/src/routing/configurable-routes/url-translation/semantic-path.service.ts","../../../projects/core/src/routing/store/actions/router.action.ts","../../../projects/core/src/routing/store/routing-state.ts","../../../projects/core/src/routing/store/selectors/routing.selector.ts","../../../projects/core/src/routing/services/activated-routes.service.ts","../../../projects/core/src/routing/facade/routing-params.service.ts","../../../projects/core/src/routing/facade/routing.service.ts","../../../projects/core/src/auth/user-auth/services/auth-redirect-storage.service.ts","../../../projects/core/src/auth/user-auth/services/auth-redirect.service.ts","../../../projects/core/src/auth/user-auth/services/auth-storage.service.ts","../../../projects/core/src/site-context/config/site-context-config.ts","../../../projects/core/src/occ/config/occ-config.ts","../../../projects/core/src/auth/user-auth/models/oauth-flow.ts","../../../projects/core/src/auth/user-auth/config/auth-config.ts","../../../projects/core/src/auth/user-auth/services/auth-config.service.ts","../../../projects/core/src/auth/user-auth/services/oauth-lib-wrapper.service.ts","../../../projects/core/src/auth/user-auth/store/actions/login-logout.action.ts","../../../projects/core/src/auth/user-auth/facade/user-id.service.ts","../../../projects/core/src/model/address.model.ts","../../../projects/core/src/model/cart.model.ts","../../../projects/core/src/model/cms.model.ts","../../../projects/core/src/model/consent.model.ts","../../../projects/core/src/auth/user-auth/facade/auth.service.ts","../../../projects/core/src/model/image.model.ts","../../../projects/core/src/model/org-unit.model.ts","../../../projects/core/src/model/product.model.ts","../../../projects/core/src/model/replenishment-order.model.ts","../../../projects/core/src/model/product-interest.model.ts","../../../projects/core/src/state/utils/entity/entity.action.ts","../../../projects/core/src/state/utils/loader/loader.action.ts","../../../projects/core/src/state/utils/entity-loader/entity-loader.action.ts","../../../projects/core/src/state/utils/loader/loader.reducer.ts","../../../projects/core/src/state/utils/loader/loader.selectors.ts","../../../projects/core/src/state/utils/entity-loader/entity-loader.selectors.ts","../../../projects/core/src/state/utils/entity/entity.reducer.ts","../../../projects/core/src/state/utils/entity-loader/entity-loader.reducer.ts","../../../projects/core/src/state/utils/processes-loader/processes-loader.action.ts","../../../projects/core/src/state/utils/entity-processes-loader/entity-processes-loader.action.ts","../../../projects/core/src/state/utils/processes-loader/processes-loader.selectors.ts","../../../projects/core/src/state/utils/processes-loader/processes-loader.reducer.ts","../../../projects/core/src/state/utils/entity-processes-loader/entity-processes-loader.selectors.ts","../../../projects/core/src/state/utils/entity-processes-loader/entity-processes-loader.reducer.ts","../../../projects/core/src/state/utils/entity/entity.selectors.ts","../../../projects/core/src/state/utils/get-state-slice.ts","../../../projects/core/src/state/utils/serializer.ts","../../../projects/core/src/anonymous-consents/store/anonymous-consents-state.ts","../../../projects/core/src/anonymous-consents/store/actions/anonymous-consents.action.ts","../../../projects/core/src/anonymous-consents/store/selectors/feature.selector.ts","../../../projects/core/src/anonymous-consents/store/selectors/anonymous-consent-templates.selectors.ts","../../../projects/core/src/anonymous-consents/store/selectors/anonymous-consent-ui.selectors.ts","../../../projects/core/src/anonymous-consents/store/selectors/anonymous-consents.selectors.ts","../../../projects/core/src/anonymous-consents/facade/anonymous-consents.service.ts","../../../projects/core/src/config/utils/dynamic-template.ts","../../../projects/core/src/site-context/config/context-config-utils.ts","../../../projects/core/src/site-context/providers/context-ids.ts","../../../projects/core/src/site-context/store/actions/base-site.action.ts","../../../projects/core/src/site-context/store/actions/currencies.action.ts","../../../projects/core/src/site-context/store/actions/languages.action.ts","../../../projects/core/src/site-context/store/state.ts","../../../projects/core/src/site-context/store/selectors/site-context.selector.ts","../../../projects/core/src/site-context/store/selectors/base-site.selectors.ts","../../../projects/core/src/site-context/store/selectors/currencies.selectors.ts","../../../projects/core/src/site-context/store/selectors/languages.selectors.ts","../../../projects/core/src/site-context/facade/base-site.service.ts","../../../projects/core/src/util/http-params-uri.encoder.ts","../../../projects/core/src/occ/occ-models/occ-endpoints.model.ts","../../../projects/core/src/occ/services/occ-endpoints.service.ts","../../../projects/core/src/occ/utils/interceptor-util.ts","../../../projects/core/src/auth/client-auth/store/client-auth-state.ts","../../../projects/core/src/auth/client-auth/store/actions/client-token.action.ts","../../../projects/core/src/auth/client-auth/store/selectors/feature.selector.ts","../../../projects/core/src/auth/client-auth/store/selectors/client-token.selectors.ts","../../../projects/core/src/auth/client-auth/services/client-token.service.ts","../../../projects/core/src/auth/client-auth/services/client-error-handling.service.ts","../../../projects/core/src/auth/client-auth/http-interceptors/client-token.interceptor.ts","../../../projects/core/src/state/config/state-config.ts","../../../projects/core/src/auth/client-auth/http-interceptors/index.ts","../../../projects/core/src/state/config/default-state-config.ts","../../../projects/core/src/state/reducers/storage-sync.reducer.ts","../../../projects/core/src/state/services/state-persistence.service.ts","../../../projects/core/src/auth/user-auth/services/auth-state-persistence.service.ts","../../../projects/core/src/state/reducers/transfer-state.reducer.ts","../../../projects/core/src/state/reducers/index.ts","../../../projects/core/src/state/state.module.ts","../../../projects/core/src/util/normalize-http-error.ts","../../../projects/core/src/auth/client-auth/services/client-authentication-token.service.ts","../../../projects/core/src/auth/client-auth/store/effects/client-token.effect.ts","../../../projects/core/src/auth/client-auth/store/effects/index.ts","../../../projects/core/src/auth/client-auth/store/reducers/index.ts","../../../projects/core/src/auth/client-auth/store/client-auth-store.module.ts","../../../projects/core/src/auth/client-auth/client-auth.module.ts","../../../projects/core/src/config/config-initializer/config-initializer.ts","../../../projects/core/src/config/config-initializer/config-initializer.service.ts","../../../projects/core/src/global-message/models/global-message.model.ts","../../../projects/core/src/auth/user-auth/config/default-auth-config.ts","../../../projects/core/src/global-message/store/actions/global-message.actions.ts","../../../projects/core/src/global-message/store/global-message-state.ts","../../../projects/core/src/global-message/store/selectors/feature.selector.ts","../../../projects/core/src/global-message/store/selectors/global-message.selectors.ts","../../../projects/core/src/global-message/facade/global-message.service.ts","../../../projects/core/src/auth/user-auth/services/auth-http-header.service.ts","../../../projects/core/src/auth/user-auth/http-interceptors/auth.interceptor.ts","../../../projects/core/src/auth/user-auth/http-interceptors/token-revocation.interceptor.ts","../../../projects/core/src/auth/user-auth/http-interceptors/index.ts","../../../projects/core/src/auth/user-auth/user-auth.module.ts","../../../projects/core/src/auth/auth.module.ts","../../../projects/core/src/auth/user-auth/guards/auth.guard.ts","../../../projects/core/src/auth/user-auth/guards/not-auth.guard.ts","../../../projects/core/src/asm/connectors/asm.adapter.ts","../../../projects/core/src/occ/adapters/asm/default-occ-asm-config.ts","../../../projects/core/src/asm/config/asm-config.ts","../../../projects/core/src/asm/connectors/converters.ts","../../../projects/core/src/util/create-from.ts","../../../projects/core/src/lazy-loading/events/module-initialized-event.ts","../../../projects/core/src/event/utils/merging-subject.ts","../../../projects/core/src/event/event.service.ts","../../../projects/core/src/util/combined-injector.ts","../../../projects/core/src/lazy-loading/lazy-modules.service.ts","../../../projects/core/src/lazy-loading/unified-injector.ts","../../../projects/core/src/util/rxjs/get-last-value-sync.ts","../../../projects/core/src/util/converter.service.ts","../../../projects/core/src/occ/adapters/asm/occ-asm.adapter.ts","../../../projects/core/src/occ/adapters/asm/asm-occ.module.ts","../../../projects/core/src/cart/connectors/cart/cart.adapter.ts","../../../projects/core/src/cart/connectors/cart/converters.ts","../../../projects/core/src/cart/connectors/entry/cart-entry.adapter.ts","../../../projects/core/src/cart/connectors/save-cart/save-cart.adapter.ts","../../../projects/core/src/cart/connectors/voucher/cart-voucher.adapter.ts","../../../projects/core/src/product/connectors/product/converters.ts","../../../projects/core/src/occ/adapters/cart/converters/occ-cart-normalizer.ts","../../../projects/core/src/occ/adapters/cart/default-occ-cart-config.ts","../../../projects/core/src/cart/connectors/entry/converters.ts","../../../projects/core/src/occ/adapters/cart/occ-cart-entry.adapter.ts","../../../projects/core/src/cart/connectors/voucher/converters.ts","../../../projects/core/src/occ/adapters/cart/occ-cart-voucher.adapter.ts","../../../projects/core/src/occ/adapters/cart/occ-cart.adapter.ts","../../../projects/core/src/cart/connectors/save-cart/converters.ts","../../../projects/core/src/occ/adapters/cart/occ-save-cart.adapter.ts","../../../projects/core/src/occ/adapters/cart/cart-occ.module.ts","../../../projects/core/src/checkout/connectors/checkout/checkout.adapter.ts","../../../projects/core/src/checkout/connectors/checkout/converters.ts","../../../projects/core/src/checkout/connectors/cost-center/checkout-cost-center.adapter.ts","../../../projects/core/src/checkout/connectors/delivery/checkout-delivery.adapter.ts","../../../projects/core/src/checkout/connectors/checkout/checkout.connector.ts","../../../projects/core/src/checkout/connectors/cost-center/checkout-cost-center.connector.ts","../../../projects/core/src/checkout/connectors/delivery/checkout-delivery.connector.ts","../../../projects/core/src/checkout/connectors/delivery/converters.ts","../../../projects/core/src/checkout/connectors/payment-type/payment-type.adapter.ts","../../../projects/core/src/checkout/connectors/payment-type/payment-type.connector.ts","../../../projects/core/src/checkout/connectors/payment-type/converters.ts","../../../projects/core/src/checkout/connectors/payment/checkout-payment.adapter.ts","../../../projects/core/src/checkout/connectors/payment/checkout-payment.connector.ts","../../../projects/core/src/checkout/connectors/payment/converters.ts","../../../projects/core/src/checkout/connectors/replenishment-order/checkout-replenishment-order.adapter.ts","../../../projects/core/src/checkout/connectors/replenishment-order/checkout-replenishment-order.connector.ts","../../../projects/core/src/checkout/connectors/replenishment-order/converters.ts","../../../projects/core/src/occ/adapters/checkout/converters/occ-order-normalizer.ts","../../../projects/core/src/util/time-utils.ts","../../../projects/core/src/occ/adapters/checkout/converters/occ-replenishment-order-form-serializer.ts","../../../projects/core/src/occ/adapters/checkout/converters/occ-replenishment-order-normalizer.ts","../../../projects/core/src/occ/adapters/checkout/default-occ-checkout-config.ts","../../../projects/core/src/occ/adapters/checkout/occ-checkout-cost-center.adapter.ts","../../../projects/core/src/user/connectors/address/converters.ts","../../../projects/core/src/occ/adapters/checkout/occ-checkout-delivery.adapter.ts","../../../projects/core/src/occ/adapters/checkout/occ-checkout-payment-type.adapter.ts","../../../projects/core/src/occ/adapters/checkout/occ-checkout-payment.adapter.ts","../../../projects/core/src/cms/page/page-meta.resolver.ts","../../../projects/core/src/state/event/state-event.service.ts","../../../projects/core/src/checkout/store/actions/address-verification.action.ts","../../../projects/core/src/checkout/store/actions/card-types.action.ts","../../../projects/core/src/cart/store/multi-cart-state.ts","../../../projects/core/src/process/store/process-state.ts","../../../projects/core/src/checkout/store/checkout-state.ts","../../../projects/core/src/checkout/store/actions/checkout.action.ts","../../../projects/core/src/checkout/store/actions/order-types.action.ts","../../../projects/core/src/checkout/store/actions/payment-types.action.ts","../../../projects/core/src/checkout/store/actions/replenishment-order.action.ts","../../../projects/core/src/checkout/events/checkout.events.ts","../../../projects/core/src/checkout/events/checkout-event.builder.ts","../../../projects/core/src/checkout/events/checkout-event.module.ts","../../../projects/core/src/cart/store/actions/cart-entry.action.ts","../../../projects/core/src/cart/store/actions/cart-voucher.action.ts","../../../projects/core/src/cart/store/actions/cart.action.ts","../../../projects/core/src/cart/store/actions/multi-cart.action.ts","../../../projects/core/src/cart/utils/utils.ts","../../../projects/core/src/cart/store/actions/wish-list.action.ts","../../../projects/core/src/cart/store/selectors/multi-cart.selector.ts","../../../projects/core/src/cart/facade/multi-cart.service.ts","../../../projects/core/src/util/glob-utils.ts","../../../projects/core/src/util/glob.service.ts","../../../projects/core/src/routing/services/url-matcher.service.ts","../../../projects/core/src/routing/configurable-routes/configurable-routes.service.ts","../../../projects/core/src/routing/configurable-routes/url-translation/product-url.pipe.ts","../../../projects/core/src/routing/configurable-routes/url-translation/url.pipe.ts","../../../projects/core/src/routing/configurable-routes/url-translation/url.module.ts","../../../projects/core/src/routing/external-routes/external-routes-config.ts","../../../projects/core/src/routing/external-routes/external-routes.guard.ts","../../../projects/core/src/routing/external-routes/external-routes.providers.ts","../../../projects/core/src/routing/external-routes/external-routes.service.ts","../../../projects/core/src/routing/external-routes/external-routes.module.ts","../../../projects/core/src/routing/models/page-context.model.ts","../../../projects/core/src/routing/protected-routes/protected-routes.service.ts","../../../projects/core/src/routing/protected-routes/protected-routes.guard.ts","../../../projects/core/src/routing/store/effects/router.effect.ts","../../../projects/core/src/routing/store/effects/index.ts","../../../projects/core/src/routing/store/reducers/router.reducer.ts","../../../projects/core/src/routing/routing.module.ts","../../../projects/core/src/routing/url-matcher/default-url-matcher.ts","../../../projects/core/src/checkout/http-interceptors/checkout-cart.interceptor.ts","../../../projects/core/src/cms/model/page.model.ts","../../../projects/core/src/checkout/http-interceptors/index.ts","../../../projects/core/src/util/regex-pattern.ts","../../../projects/core/src/cart/facade/active-cart.service.ts","../../../projects/core/src/i18n/translation.service.ts","../../../projects/core/src/checkout/services/checkout-page-meta.resolver.ts","../../../projects/core/src/user/connectors/address/user-address.adapter.ts","../../../projects/core/src/user/connectors/address/user-address.connector.ts","../../../projects/core/src/util/serialization-utils.ts","../../../projects/core/src/checkout/store/effects/address-verification.effect.ts","../../../projects/core/src/checkout/store/effects/card-types.effect.ts","../../../projects/core/src/user/store/actions/billing-countries.action.ts","../../../projects/core/src/user/store/actions/consignment-tracking.action.ts","../../../projects/core/src/user/store/user-state.ts","../../../projects/core/src/process/store/selectors/process.selectors.ts","../../../projects/core/src/process/store/selectors/feature.selector.ts","../../../projects/core/src/user/store/actions/customer-coupon.action.ts","../../../projects/core/src/user/store/actions/delivery-countries.action.ts","../../../projects/core/src/user/store/actions/forgot-password.action.ts","../../../projects/core/src/user/store/actions/notification-preference.action.ts","../../../projects/core/src/user/store/actions/order-details.action.ts","../../../projects/core/src/user/store/actions/order-return-request.action.ts","../../../projects/core/src/user/store/actions/payment-methods.action.ts","../../../projects/core/src/user/store/actions/product-interests.actions.ts","../../../projects/core/src/user/store/actions/regions.action.ts","../../../projects/core/src/user/store/actions/replenishment-order-details.action.ts","../../../projects/core/src/user/store/actions/reset-password.action.ts","../../../projects/core/src/user/store/actions/titles.action.ts","../../../projects/core/src/user/store/actions/update-email.action.ts","../../../projects/core/src/user/store/actions/update-password.action.ts","../../../projects/core/src/user/store/actions/user-addresses.action.ts","../../../projects/core/src/user/store/actions/user-consents.action.ts","../../../projects/core/src/user/store/actions/user-cost-center.action.ts","../../../projects/core/src/user/store/actions/user-details.action.ts","../../../projects/core/src/user/store/actions/user-misc.action.ts","../../../projects/core/src/user/store/actions/user-orders.action.ts","../../../projects/core/src/user/store/actions/user-register.action.ts","../../../projects/core/src/user/store/actions/user-replenishment-orders.action.ts","../../../projects/core/src/util/rxjs/withdraw-on.ts","../../../projects/core/src/checkout/store/effects/checkout.effect.ts","../../../projects/core/src/checkout/store/effects/payment-types.effect.ts","../../../projects/core/src/checkout/store/effects/replenishment-order.effect.ts","../../../projects/core/src/checkout/store/effects/index.ts","../../../projects/core/src/checkout/store/reducers/address-verification.reducer.ts","../../../projects/core/src/checkout/store/reducers/card-types.reducer.ts","../../../projects/core/src/checkout/store/reducers/checkout.reducer.ts","../../../projects/core/src/checkout/store/reducers/order-types.reducer.ts","../../../projects/core/src/checkout/store/reducers/payment-types.reducer.ts","../../../projects/core/src/checkout/store/reducers/index.ts","../../../projects/core/src/checkout/store/checkout-store.module.ts","../../../projects/core/src/checkout/checkout.module.ts","../../../projects/core/src/checkout/store/selectors/checkout.selectors.ts","../../../projects/core/src/checkout/store/selectors/address-verification.selectors.ts","../../../projects/core/src/checkout/store/selectors/card-types.selectors.ts","../../../projects/core/src/checkout/store/selectors/order-types.selectors.ts","../../../projects/core/src/checkout/store/selectors/payment-types.selectors.ts","../../../projects/core/src/checkout/facade/checkout-cost-center.service.ts","../../../projects/core/src/checkout/facade/checkout-delivery.service.ts","../../../projects/core/src/checkout/facade/checkout-payment.service.ts","../../../projects/core/src/checkout/facade/checkout.service.ts","../../../projects/core/src/checkout/facade/payment-type.service.ts","../../../projects/core/src/occ/adapters/checkout/occ-checkout-replenishment-order.adapter.ts","../../../projects/core/src/occ/adapters/checkout/occ-checkout.adapter.ts","../../../projects/core/src/occ/adapters/checkout/checkout-occ.module.ts","../../../projects/core/src/cms/connectors/page/cms-page.adapter.ts","../../../projects/core/src/cms/connectors/component/converters.ts","../../../projects/core/src/occ/adapters/cms/occ-cms-component.adapter.ts","../../../projects/core/src/cms/config/cms-config.ts","../../../projects/core/src/occ/adapters/cms/converters/occ-cms-page-normalizer.ts","../../../projects/core/src/cms/connectors/page/converters.ts","../../../projects/core/src/occ/adapters/cms/occ-cms-page.adapter.ts","../../../projects/core/src/cms/connectors/component/cms-component.adapter.ts","../../../projects/core/src/occ/adapters/cms/cms-occ.module.ts","../../../projects/core/src/occ/adapters/cms/legacy-occ-cms-component.adapter.ts","../../../projects/core/src/occ/adapters/cost-center/converters/occ-cost-center-normalizer.ts","../../../projects/core/src/occ/adapters/cost-center/converters/occ-cost-center-serializer.ts","../../../projects/core/src/cost-center/connectors/cost-center/converters.ts","../../../projects/core/src/occ/adapters/cost-center/converters/occ-cost-center-list-normalizer.ts","../../../projects/core/src/features-config/config/features-config.ts","../../../projects/core/src/features-config/utils/feature-config-utils.ts","../../../projects/core/src/features-config/services/feature-config.service.ts","../../../projects/core/src/features-config/directives/feature-level.directive.ts","../../../projects/core/src/features-config/directives/feature.directive.ts","../../../projects/core/src/features-config/features-config.module.ts","../../../projects/core/src/config/services/configuration.service.ts","../../../projects/core/src/config/config.module.ts","../../../projects/core/src/occ/adapters/cost-center/default-occ-cost-centers-config.ts","../../../projects/core/src/occ/adapters/cost-center/cost-center-occ.module.ts","../../../projects/core/src/occ/adapters/product/converters/product-image-normalizer.ts","../../../projects/core/src/occ/adapters/product/converters/product-reference-normalizer.ts","../../../projects/core/src/occ/adapters/product/converters/occ-product-search-page-normalizer.ts","../../../projects/core/src/occ/adapters/product/converters/occ-product-references-list-normalizer.ts","../../../projects/core/src/occ/adapters/product/converters/product-name-normalizer.ts","../../../projects/core/src/product/connectors/references/converters.ts","../../../projects/core/src/occ/adapters/product/occ-product-references.adapter.ts","../../../projects/core/src/product/connectors/reviews/converters.ts","../../../projects/core/src/occ/adapters/product/occ-product-reviews.adapter.ts","../../../projects/core/src/product/connectors/search/converters.ts","../../../projects/core/src/occ/adapters/product/occ-product-search.adapter.ts","../../../projects/core/src/occ/utils/occ-fields.ts","../../../projects/core/src/occ/services/occ-fields.service.ts","../../../projects/core/src/occ/services/occ-requests-optimizer.service.ts","../../../projects/core/src/occ/adapters/product/occ-product.adapter.ts","../../../projects/core/src/product/model/product-scope.ts","../../../projects/core/src/product/connectors/product/product.adapter.ts","../../../projects/core/src/product/connectors/references/product-references.adapter.ts","../../../projects/core/src/product/connectors/reviews/product-reviews.adapter.ts","../../../projects/core/src/product/connectors/search/product-search.adapter.ts","../../../projects/core/src/occ/adapters/product/default-occ-product-config.ts","../../../projects/core/src/occ/adapters/product/product-occ.module.ts","../../../projects/core/src/site-context/connectors/converters.ts","../../../projects/core/src/occ/adapters/site-context/occ-site.adapter.ts","../../../projects/core/src/site-context/connectors/site.adapter.ts","../../../projects/core/src/occ/adapters/site-context/default-occ-site-context-config.ts","../../../projects/core/src/site-context/facade/currency.service.ts","../../../projects/core/src/site-context/facade/language.service.ts","../../../projects/core/src/occ/adapters/site-context/site-context.interceptor.ts","../../../projects/core/src/occ/adapters/site-context/site-context-occ.module.ts","../../../projects/core/src/occ/adapters/user/converters/anonymous-consents-normalizer.ts","../../../projects/core/src/occ/adapters/user/converters/occ-return-request-normalizer.ts","../../../projects/core/src/occ/adapters/user/converters/occ-user-interests-normalizer.ts","../../../projects/core/src/anonymous-consents/connectors/converters.ts","../../../projects/core/src/user/connectors/consent/converters.ts","../../../projects/core/src/occ/adapters/user/occ-anonymous-consent-templates.adapter.ts","../../../projects/core/src/user/connectors/customer-coupon/converters.ts","../../../projects/core/src/occ/adapters/user/occ-customer-coupon.adapter.ts","../../../projects/core/src/occ/adapters/user/occ-user-address.adapter.ts","../../../projects/core/src/occ/adapters/user/occ-user-consent.adapter.ts","../../../projects/core/src/user/connectors/interests/converters.ts","../../../projects/core/src/occ/adapters/user/occ-user-interests.adapter.ts","../../../projects/core/src/user/connectors/notification-preference/converters.ts","../../../projects/core/src/user/connectors/notification-preference/user-notification-preference.adapter.ts","../../../projects/core/src/user/connectors/notification-preference/user-notification-preference.connector.ts","../../../projects/core/src/occ/adapters/user/occ-user-notification-preference.adapter.ts","../../../projects/core/src/user/connectors/order/converters.ts","../../../projects/core/src/occ/adapters/user/occ-user-order.adapter.ts","../../../projects/core/src/occ/adapters/user/occ-user-payment.adapter.ts","../../../projects/core/src/user/connectors/replenishment-order/converters.ts","../../../projects/core/src/occ/adapters/user/occ-user-replenishment-order.adapter.ts","../../../projects/core/src/user/connectors/user/converters.ts","../../../projects/core/src/occ/adapters/user/occ-user.adapter.ts","../../../projects/core/src/anonymous-consents/connectors/anonymous-consent-templates.adapter.ts","../../../projects/core/src/user/connectors/consent/user-consent.adapter.ts","../../../projects/core/src/user/connectors/cost-center/user-cost-center.adapter.ts","../../../projects/core/src/user/connectors/customer-coupon/customer-coupon.adapter.ts","../../../projects/core/src/user/connectors/interests/user-interests.adapter.ts","../../../projects/core/src/user/connectors/order/user-order.adapter.ts","../../../projects/core/src/user/connectors/payment/user-payment.adapter.ts","../../../projects/core/src/user/connectors/replenishment-order/user-replenishment-order.adapter.ts","../../../projects/core/src/user/connectors/replenishment-order/user-replenishment-order.connector.ts","../../../projects/core/src/user/connectors/user/user.adapter.ts","../../../projects/core/src/occ/adapters/user/converters/occ-address-list-normalizer.ts","../../../projects/core/src/occ/adapters/user/default-occ-user-config.ts","../../../projects/core/src/occ/adapters/user/occ-user-cost-centers.adapter.ts","../../../projects/core/src/occ/adapters/user/user-occ.module.ts","../../../projects/core/src/occ/config-loader/java-reg-exp-converter.ts","../../../projects/core/src/util/ssr.tokens.ts","../../../projects/core/src/occ/config-loader/occ-loaded-config-converter.ts","../../../projects/core/src/occ/config-loader/occ-sites-config-loader.ts","../../../projects/core/src/occ/config-loader/occ-config-loader.service.ts","../../../projects/core/src/occ/config-loader/occ-config-loader.module.ts","../../../projects/core/src/occ/config/config-from-meta-tag-factory.ts","../../../projects/core/src/occ/config/default-occ-config.ts","../../../projects/core/src/occ/config/occ-config-validator.ts","../../../projects/core/src/occ/occ-models/occ.models.ts","../../../projects/core/src/occ/interceptors/with-credentials.interceptor.ts","../../../projects/core/src/config/config-validator/config-validator.ts","../../../projects/core/src/occ/occ.module.ts","../../../projects/core/src/occ/services/loading-scopes.service.ts","../../../projects/core/src/anonymous-consents/config/anonymous-consents-config.ts","../../../projects/core/src/anonymous-consents/http-interceptors/anonymous-consents-interceptor.ts","../../../projects/core/src/anonymous-consents/http-interceptors/index.ts","../../../projects/core/src/user/store/selectors/feature.selector.ts","../../../projects/core/src/user/store/selectors/billing-countries.selectors.ts","../../../projects/core/src/user/store/selectors/consignment-tracking.selectors.ts","../../../projects/core/src/user/store/selectors/customer-coupons.selectors.ts","../../../projects/core/src/user/store/selectors/delivery-countries.selectors.ts","../../../projects/core/src/user/store/selectors/notification-preference.selectors.ts","../../../projects/core/src/user/store/selectors/order-details.selectors.ts","../../../projects/core/src/user/store/selectors/order-return-request.selectors.ts","../../../projects/core/src/user/store/selectors/payment-methods.selectors.ts","../../../projects/core/src/user/store/selectors/product-interests.selectors.ts","../../../projects/core/src/user/store/selectors/regions.selectors.ts","../../../projects/core/src/user/store/selectors/replenishment-order-details.selectors.ts","../../../projects/core/src/user/store/selectors/reset-password.selectors.ts","../../../projects/core/src/user/store/selectors/titles.selectors.ts","../../../projects/core/src/user/store/selectors/user-addresses.selectors.ts","../../../projects/core/src/user/store/selectors/user-consents.selectors.ts","../../../projects/core/src/user/store/selectors/user-cost-center.selectors.ts","../../../projects/core/src/user/store/selectors/user-details.selectors.ts","../../../projects/core/src/user/store/selectors/user-orders.selectors.ts","../../../projects/core/src/user/store/selectors/user-replenishment-orders.selectors.ts","../../../projects/core/src/user/facade/user-consent.service.ts","../../../projects/core/src/anonymous-consents/connectors/anonymous-consent-templates.connector.ts","../../../projects/core/src/anonymous-consents/store/effects/anonymous-consents.effect.ts","../../../projects/core/src/anonymous-consents/store/effects/index.ts","../../../projects/core/src/site-context/connectors/site.connector.ts","../../../projects/core/src/site-context/providers/context-service-map.ts","../../../projects/core/src/site-context/config/base-site-config-validator.ts","../../../projects/core/src/site-context/config/default-site-context-config.ts","../../../projects/core/src/site-context/services/site-context-params.service.ts","../../../projects/core/src/site-context/services/site-context-url-serializer.ts","../../../projects/core/src/site-context/services/site-context-routes-handler.ts","../../../projects/core/src/site-context/providers/context-service-providers.ts","../../../projects/core/src/site-context/providers/site-context-params-providers.ts","../../../projects/core/src/site-context/store/effects/base-site.effect.ts","../../../projects/core/src/site-context/store/effects/currencies.effect.ts","../../../projects/core/src/site-context/store/effects/languages.effect.ts","../../../projects/core/src/site-context/store/effects/index.ts","../../../projects/core/src/site-context/store/reducers/base-site.reducer.ts","../../../projects/core/src/site-context/store/reducers/currencies.reducer.ts","../../../projects/core/src/site-context/store/reducers/languages.reducer.ts","../../../projects/core/src/site-context/store/reducers/index.ts","../../../projects/core/src/site-context/store/site-context-store.module.ts","../../../projects/core/src/site-context/site-context.module.ts","../../../projects/core/src/anonymous-consents/store/reducers/anonymous-consents-banner.reducer.ts","../../../projects/core/src/anonymous-consents/store/reducers/anonymous-consents-update.reducer.ts","../../../projects/core/src/anonymous-consents/store/reducers/anonymous-consents.reducer.ts","../../../projects/core/src/anonymous-consents/store/reducers/index.ts","../../../projects/core/src/anonymous-consents/services/anonymous-consents-state-persistence.service.ts","../../../projects/core/src/anonymous-consents/store/anonymous-consents-store.module.ts","../../../projects/core/src/anonymous-consents/anonymous-consents.module.ts","../../../projects/core/src/asm/services/asm-auth-storage.service.ts","../../../projects/core/src/asm/config/default-asm-config.ts","../../../projects/core/src/user/facade/user.service.ts","../../../projects/core/src/asm/store/actions/asm-ui.action.ts","../../../projects/core/src/asm/store/asm-state.ts","../../../projects/core/src/asm/store/actions/customer.action.ts","../../../projects/core/src/asm/store/actions/logout-agent.action.ts","../../../projects/core/src/asm/facade/csagent-auth.service.ts","../../../projects/core/src/asm/services/asm-auth-http-header.service.ts","../../../projects/core/src/global-message/models/response-status.model.ts","../../../projects/core/src/global-message/config/global-message-config.ts","../../../projects/core/src/global-message/http-interceptors/handlers/http-error.handler.ts","../../../projects/core/src/global-message/http-interceptors/handlers/bad-gateway/bad-gateway.handler.ts","../../../projects/core/src/global-message/http-interceptors/handlers/bad-request/bad-request.handler.ts","../../../projects/core/src/global-message/http-interceptors/handlers/conflict/conflict.handler.ts","../../../projects/core/src/global-message/http-interceptors/handlers/forbidden/forbidden.handler.ts","../../../projects/core/src/global-message/http-interceptors/handlers/gateway/gateway-timeout.handler.ts","../../../projects/core/src/global-message/http-interceptors/handlers/internal-server/internal-server.handler.ts","../../../projects/core/src/global-message/http-interceptors/handlers/not-found/not-found.handler.ts","../../../projects/core/src/global-message/http-interceptors/handlers/unknown-error/unknown-error.handler.ts","../../../projects/core/src/util/applicable.ts","../../../projects/core/src/global-message/http-interceptors/http-error.interceptor.ts","../../../projects/core/src/global-message/http-interceptors/index.ts","../../../projects/core/src/global-message/store/reducers/global-message.reducer.ts","../../../projects/core/src/global-message/store/reducers/index.ts","../../../projects/core/src/global-message/store/global-message-store.module.ts","../../../projects/core/src/util/compare-equal-objects.ts","../../../projects/core/src/global-message/store/effects/global-message.effect.ts","../../../projects/core/src/global-message/config/default-global-message-config.ts","../../../projects/core/src/global-message/global-message.module.ts","../../../projects/core/src/asm/services/asm-auth.service.ts","../../../projects/core/src/asm/connectors/asm.connector.ts","../../../projects/core/src/asm/store/effects/customer.effect.ts","../../../projects/core/src/asm/store/effects/index.ts","../../../projects/core/src/asm/store/reducers/asm-ui.reducer.ts","../../../projects/core/src/asm/store/reducers/index.ts","../../../projects/core/src/asm/store/selectors/feature.selector.ts","../../../projects/core/src/asm/store/selectors/asm-ui.selectors.ts","../../../projects/core/src/asm/store/selectors/customer-search.selectors.ts","../../../projects/core/src/asm/services/asm-state-persistence.service.ts","../../../projects/core/src/asm/store/asm-store.module.ts","../../../projects/core/src/asm/asm.module.ts","../../../projects/core/src/asm/facade/asm.service.ts","../../../projects/core/src/cart/connectors/entry/cart-entry.connector.ts","../../../projects/core/src/cart/store/effects/cart-entry.effect.ts","../../../projects/core/src/cart/connectors/voucher/cart-voucher.connector.ts","../../../projects/core/src/cart/store/effects/cart-voucher.effect.ts","../../../projects/core/src/cart/connectors/cart/cart.connector.ts","../../../projects/core/src/cart/store/effects/cart.effect.ts","../../../projects/core/src/cart/connectors/save-cart/save-cart.connecter.ts","../../../projects/core/src/cart/store/effects/wish-list.effect.ts","../../../projects/core/src/cart/store/reducers/multi-cart.reducer.ts","../../../projects/core/src/cart/store/reducers/index.ts","../../../projects/core/src/cart/services/multi-cart-state-persistence.service.ts","../../../projects/core/src/cart/cart-persistence.module.ts","../../../projects/core/src/cart/event/cart.events.ts","../../../projects/core/src/cart/event/cart-event.builder.ts","../../../projects/core/src/cart/event/cart-event.module.ts","../../../projects/core/src/cms/store/cms-state.ts","../../../projects/core/src/cms/store/actions/components.action.ts","../../../projects/core/src/cms/store/actions/navigation-entry-item.action.ts","../../../projects/core/src/cms/store/actions/page.action.ts","../../../projects/core/src/cms/store/selectors/feature.selectors.ts","../../../projects/core/src/cms/store/selectors/components.selectors.ts","../../../projects/core/src/cms/store/selectors/navigation-entry-item.selectors.ts","../../../projects/core/src/cms/store/selectors/page.selectors.ts","../../../projects/core/src/cms/utils/cms-utils.ts","../../../projects/core/src/cms/facade/cms.service.ts","../../../projects/core/src/cart/services/cart-page-meta.resolver.ts","../../../projects/core/src/cart/store/effects/multi-cart.effect.ts","../../../projects/core/src/cart/store/multi-cart-store.module.ts","../../../projects/core/src/cart/cart.module.ts","../../../projects/core/src/cart/config/cart-config.ts","../../../projects/core/src/cart/facade/cart-voucher.service.ts","../../../projects/core/src/cart/services/cart-config.service.ts","../../../projects/core/src/cart/facade/selective-cart.service.ts","../../../projects/core/src/cart/facade/wish-list.service.ts","../../../projects/core/src/cms/config/default-cms-config.ts","../../../projects/core/src/cms/page/routing/default-route-page-meta.resolver.ts","../../../projects/core/src/cms/page/routing/routing-page-meta.resolver.ts","../../../projects/core/src/cms/page/content-page-meta.resolver.ts","../../../projects/core/src/cms/page/page.module.ts","../../../projects/core/src/util/rxjs/buffer-debounce-time.ts","../../../projects/core/src/cms/config/cms-structure.config.ts","../../../projects/core/src/cms/services/cms-structure-config.service.ts","../../../projects/core/src/cms/connectors/component/cms-component.connector.ts","../../../projects/core/src/cms/store/effects/components.effect.ts","../../../projects/core/src/cms/store/effects/navigation-entry-item.effect.ts","../../../projects/core/src/cms/connectors/page/cms-page.connector.ts","../../../projects/core/src/cms/store/effects/page.effect.ts","../../../projects/core/src/cms/store/effects/index.ts","../../../projects/core/src/cms/store/reducers/components.reducer.ts","../../../projects/core/src/cms/store/reducers/navigation-entry-item.reducer.ts","../../../projects/core/src/cms/store/reducers/page-data.reducer.ts","../../../projects/core/src/cms/store/reducers/page-index.reducer.ts","../../../projects/core/src/cms/store/reducers/index.ts","../../../projects/core/src/cms/store/cms-store.module.ts","../../../projects/core/src/cms/cms.module.ts","../../../projects/core/src/util/rxjs/unite-latest.ts","../../../projects/core/src/cms/facade/page-meta.service.ts","../../../projects/core/src/smart-edit/services/smart-edit.service.ts","../../../projects/core/src/cms/services/dynamic-attribute.service.ts","../../../projects/core/src/config/config-initializer/config-initializer.module.ts","../../../projects/core/src/config/config-validator/config-validator.module.ts","../../../projects/core/src/config/test-config.module.ts","../../../projects/core/src/config/utils/get-cookie.ts","../../../projects/core/src/i18n/date.pipe.ts","../../../projects/core/src/i18n/translate.pipe.ts","../../../projects/core/src/i18n/config/i18n-config.ts","../../../projects/core/src/i18n/translation-chunk.service.ts","../../../projects/core/src/i18n/config/default-i18n-config.ts","../../../projects/core/src/i18n/i18next/i18next-init.ts","../../../projects/core/src/i18n/i18next/i18next-providers.ts","../../../projects/core/src/i18n/i18next/i18next-translation.service.ts","../../../projects/core/src/i18n/i18n.module.ts","../../../projects/core/src/i18n/testing/mock-translate.ts","../../../projects/core/src/i18n/testing/mock-translate.pipe.ts","../../../projects/core/src/i18n/testing/mock-translation.service.ts","../../../projects/core/src/i18n/testing/mock-date.pipe.ts","../../../projects/core/src/i18n/testing/i18n-testing.module.ts","../../../projects/core/src/cost-center/cost-center.module.ts","../../../projects/core/src/personalization/config/default-personalization-config.ts","../../../projects/core/src/personalization/config/personalization-config.ts","../../../projects/core/src/personalization/http-interceptors/occ-personalization-id.interceptor.ts","../../../projects/core/src/personalization/http-interceptors/occ-personalization-time.interceptor.ts","../../../projects/core/src/personalization/http-interceptors/index.ts","../../../projects/core/src/personalization/personalization.module.ts","../../../projects/core/src/personalization/services/personalization-context.service.ts","../../../projects/core/src/process/store/reducers/index.ts","../../../projects/core/src/process/store/process-store.module.ts","../../../projects/core/src/process/process.module.ts","../../../projects/core/src/product/connectors/product/product.connector.ts","../../../projects/core/src/product/connectors/references/product-references.connector.ts","../../../projects/core/src/product/connectors/reviews/product-reviews.connector.ts","../../../projects/core/src/product/connectors/search/product-search.connector.ts","../../../projects/core/src/product/store/actions/product-references.action.ts","../../../projects/core/src/state/utils/scoped-loader/entity-scoped-loader.actions.ts","../../../projects/core/src/product/store/actions/product-reviews.action.ts","../../../projects/core/src/product/store/actions/product-search.action.ts","../../../projects/core/src/product/store/product-state.ts","../../../projects/core/src/product/store/actions/product.action.ts","../../../projects/core/src/product/store/effects/product-references.effect.ts","../../../projects/core/src/product/store/effects/product-reviews.effect.ts","../../../projects/core/src/product/store/effects/product-search.effect.ts","../../../projects/core/src/product/store/effects/product.effect.ts","../../../projects/core/src/product/store/effects/index.ts","../../../projects/core/src/product/store/reducers/product-references.reducer.ts","../../../projects/core/src/product/store/reducers/product-reviews.reducer.ts","../../../projects/core/src/product/store/reducers/product-search.reducer.ts","../../../projects/core/src/state/utils/scoped-loader/scoped-loader.reducer.ts","../../../projects/core/src/state/utils/scoped-loader/entity-scoped-loader.reducer.ts","../../../projects/core/src/product/store/reducers/index.ts","../../../projects/core/src/product/store/selectors/feature.selector.ts","../../../projects/core/src/product/store/selectors/product-references.selectors.ts","../../../projects/core/src/product/store/selectors/product-reviews.selectors.ts","../../../projects/core/src/product/store/selectors/product-search.selectors.ts","../../../projects/core/src/product/store/selectors/product.selectors.ts","../../../projects/core/src/product/facade/product-reference.service.ts","../../../projects/core/src/product/facade/product-review.service.ts","../../../projects/core/src/product/facade/product-search.service.ts","../../../projects/core/src/product/services/product-loading.service.ts","../../../projects/core/src/product/facade/product.service.ts","../../../projects/core/src/product/facade/searchbox.service.ts","../../../projects/core/src/product/services/category-page-meta.resolver.ts","../../../projects/core/src/product/services/coupon-search-page-meta.resolver.ts","../../../projects/core/src/product/services/product-page-meta.resolver.ts","../../../projects/core/src/product/services/search-page-meta.resolver.ts","../../../projects/core/src/product/store/product-store.module.ts","../../../projects/core/src/product/product.module.ts","../../../projects/core/src/smart-edit/http-interceptors/cms-ticket.interceptor.ts","../../../projects/core/src/smart-edit/http-interceptors/index.ts","../../../projects/core/src/smart-edit/smart-edit.module.ts","../../../projects/core/src/user/connectors/consent/user-consent.connector.ts","../../../projects/core/src/user/connectors/cost-center/user-cost-center.connector.ts","../../../projects/core/src/user/connectors/customer-coupon/customer-coupon.connector.ts","../../../projects/core/src/user/connectors/interests/user-interests.connector.ts","../../../projects/core/src/user/connectors/order/user-order.connector.ts","../../../projects/core/src/user/connectors/payment/user-payment.connector.ts","../../../projects/core/src/user/connectors/user/user.connector.ts","../../../projects/core/src/user/facade/consent.service.ts","../../../projects/core/src/user/facade/customer-coupon.service.ts","../../../projects/core/src/user/facade/order-return-request.service.ts","../../../projects/core/src/user/facade/user-address.service.ts","../../../projects/core/src/user/facade/user-cost-center.service.ts","../../../projects/core/src/user/facade/user-interests.service.ts","../../../projects/core/src/user/facade/user-notification-preference.service.ts","../../../projects/core/src/user/facade/user-order.service.ts","../../../projects/core/src/user/facade/user-payment.service.ts","../../../projects/core/src/user/facade/user-replenishment-order.service.ts","../../../projects/core/src/user/store/reducers/billing-countries.reducer.ts","../../../projects/core/src/user/store/reducers/consignment-tracking.reducer.ts","../../../projects/core/src/user/store/reducers/customer-coupon.reducer.ts","../../../projects/core/src/user/store/reducers/delivery-countries.reducer.ts","../../../projects/core/src/user/store/reducers/notification-preference.reducer.ts","../../../projects/core/src/user/store/reducers/order-details.reducer.ts","../../../projects/core/src/user/store/reducers/order-return-request.reducer.ts","../../../projects/core/src/user/store/reducers/payment-methods.reducer.ts","../../../projects/core/src/user/store/reducers/product-interests.reducer.ts","../../../projects/core/src/user/store/reducers/regions.reducer.ts","../../../projects/core/src/user/store/reducers/replenishment-order-details.reducer.ts","../../../projects/core/src/user/store/reducers/reset-password.reducer.ts","../../../projects/core/src/user/store/reducers/titles.reducer.ts","../../../projects/core/src/user/store/reducers/user-addresses.reducer.ts","../../../projects/core/src/user/store/reducers/user-consents.reducer.ts","../../../projects/core/src/user/store/reducers/user-cost-center.reducer.ts","../../../projects/core/src/user/store/reducers/user-details.reducer.ts","../../../projects/core/src/user/store/reducers/user-orders.reducer.ts","../../../projects/core/src/user/store/reducers/user-replenishment-orders.reducer.ts","../../../projects/core/src/user/store/reducers/index.ts","../../../projects/core/src/user/store/effects/billing-countries.effect.ts","../../../projects/core/src/user/store/effects/clear-miscs-data.effect.ts","../../../projects/core/src/user/store/effects/consignment-tracking.effect.ts","../../../projects/core/src/user/store/effects/customer-coupon.effect.ts","../../../projects/core/src/user/store/effects/delivery-countries.effect.ts","../../../projects/core/src/user/store/effects/forgot-password.effect.ts","../../../projects/core/src/user/store/effects/notification-preference.effect.ts","../../../projects/core/src/user/store/effects/order-details.effect.ts","../../../projects/core/src/user/store/effects/order-return-request.effect.ts","../../../projects/core/src/user/store/effects/payment-methods.effect.ts","../../../projects/core/src/user/store/effects/product-interests.effect.ts","../../../projects/core/src/user/store/effects/regions.effect.ts","../../../projects/core/src/user/store/effects/replenishment-order-details.effect.ts","../../../projects/core/src/user/store/effects/reset-password.effect.ts","../../../projects/core/src/user/store/effects/titles.effect.ts","../../../projects/core/src/user/store/effects/update-email.effect.ts","../../../projects/core/src/user/store/effects/update-password.effect.ts","../../../projects/core/src/user/store/effects/user-addresses.effect.ts","../../../projects/core/src/user/store/effects/user-consents.effect.ts","../../../projects/core/src/user/store/effects/user-cost-center.effect.ts","../../../projects/core/src/user/store/effects/user-details.effect.ts","../../../projects/core/src/user/store/effects/user-orders.effect.ts","../../../projects/core/src/user/store/effects/user-register.effect.ts","../../../projects/core/src/user/store/effects/user-replenishment-orders.effect.ts","../../../projects/core/src/user/store/effects/index.ts","../../../projects/core/src/user/store/user-store.module.ts","../../../projects/core/src/user/user.module.ts","../../../projects/core/src/util/external-js-file-loader/external-js-file-loader.service.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","n","v","op","TypeError","call","pop","push","__values","o","s","m","__read","ar","error","__spread","concat","isObject","item","isArray","deepMerge","sources","_i","source","shift","Date","assign","_a","_b","_c","Config","InjectionToken","providedIn","factory","inject","DefaultConfig","RootConfig","DefaultConfigChunk","InjectFlags","Optional","ConfigChunk","provideConfig","config","defaultConfig","provide","useValue","multi","provideConfigFactory","configFactory","deps","useFactory","provideDefaultConfig","provideDefaultConfigFactory","defaultAnonymousConsentsConfig","anonymousConsents","registerConsent","showLegalDescriptionInDialog","requiredConsents","consentManagementPage","showAnonymousConsents","hideConsents","OCC_USER_ID_CURRENT","OCC_USER_ID_ANONYMOUS","OCC_USER_ID_GUEST","OCC_CART_ID_CURRENT","WindowRef","document","window","undefined","nativeWindow","sessionStorage","localStorage","fromEvent","pipe","debounceTime","startWith","distinctUntilChanged","of","Injectable","args","Inject","DOCUMENT","useExisting","RoutingConfigService","getRouteConfig","routeName","routeConfig","routing","routes","warn","isDevMode","console","getLoadStrategy","loadStrategy","getRouteName","path","routeNamesByPath","initRouteNamesByPath","_this","paths","forEach","_e","entries","_f","_g","RoutingConfig","isParam","segment","startsWith","getParamName","slice","UrlParsingService","router","getPrimarySegments","url","urlTree","parseUrl","_getPrimarySegmentsFromUrlTree","root","tree","segments","map","childrenSegments","children","PRIMARY_OUTLET","Router","SemanticPathService","routingConfigService","urlParser","ROOT_URL","get","transform","commands","commands_1","commands_1_1","command","isRouteCommand","partialResult","generateUrlPart","shouldOutputAbsolute","unshift","Boolean","cxRoute","standarizeRouteCommand","findPathWithFillableParams","params","provideParamsValues","paramsMapping","paramName","mappedParamName","getMappedParamName","foundPath","find","getParams","every","filter","ROUTER_GO","ROUTER_GO_BY_URL","ROUTER_BACK","ROUTER_FORWARD","CHANGE_NEXT_PAGE_CONTEXT","RouteGoAction","payload","type","RouteGoByUrlAction","RouteBackAction","RouteForwardAction","ChangeNextPageContext","ROUTING_FEATURE","getRouterFeatureState","createFeatureSelector","state","getRouterState","createSelector","ɵ0","routingState","semanticRoute","getSemanticRoute","ɵ1","context","id","getPageContext","ɵ2","nextState","getNextPageContext","ɵ3","isNavigating","ɵ4","routes$","events","event","NavigationEnd","route","routerState","snapshot","firstChild","shareReplay","bufferSize","refCount","RoutingParamsService","activatedRoutesService","params$","findAllParam","ActivatedRoutesService","RoutingService","store","winRef","semanticPathService","routingParamsService","select","RoutingSelector.getRouterState","RoutingSelector.getPageContext","RoutingSelector.getNextPageContext","changeNextPageContext","pageContext","dispatch","RoutingActions.ChangeNextPageContext","RoutingSelector.isNavigating","go","query","extras","navigate","goByUrl","RoutingActions.RouteGoByUrlAction","back","referrer","includes","location","origin","RoutingActions.RouteBackAction","forward","RoutingActions.RouteForwardAction","RoutingActions.RouteGoAction","Store","AuthRedirectStorageService","redirectUrl$","BehaviorSubject","getRedirectUrl","setRedirectUrl","redirectUrl","AuthRedirectService","authRedirectStorageService","ignoredUrls","Set","redirect","take","subscribe","lastAuthGuardNavigation","reportAuthGuard","getCurrentNavigation","navigationId","reportNotAuthGuard","initialUrl","add","has","navigation","serializeUrl","finalUrl","AuthStorageService","_super","_token$","decode","nonStringifiedOAuthLibKeys","JSON","stringify","encode","parse","getToken","setToken","token","getItem","currentToken","unsubscribe","removeItem","val","setItem","data","OAuthStorage","OccConfig","SiteContextConfig","OAuthFlow","AuthConfigService","authConfig","occConfig","getClientId","authentication","client_id","getClientSecret","client_secret","getBaseUrl","baseUrl","backend","occ","getTokenEndpoint","tokenEndpoint","prefixEndpoint","getLoginUrl","loginUrl","getRevokeEndpoint","revokeEndpoint","getLogoutUrl","logoutUrl","getUserinfoEndpoint","userinfoEndpoint","getOAuthLibConfig","OAuthLibConfig","endpoint","getOAuthFlow","responseType","types","split","AuthorizationCode","ImplicitFlow","ResourceOwnerPasswordFlow","AuthConfig","OAuthLibWrapperService","oAuthService","authConfigService","platformId","initialize","isSSR","isPlatformServer","configure","clientId","dummyClientSecret","revocationEndpoint","issuer","redirectUri","_d","authorizeWithPasswordFlow","userId","password","fetchTokenUsingPasswordFlow","refreshToken","revokeAndLogout","revokeTokenAndLogout","catch","logOut","finally","logout","getIdToken","initLoginFlow","tryLogin","disableOAuth2StateCheck","OAuthService","PLATFORM_ID","LOGIN","LOGOUT","Login","Logout","UserIdService","_userId","setUserId","getUserId","invokeWithUserId","cb","takeUserId","loggedIn","Error","clearUserId","isEmulated","CountryType","PromotionLocation","B2BPaymentTypeEnum","PageType","CmsBannerCarouselEffect","ANONYMOUS_CONSENT_STATUS","AuthService","userIdService","oAuthLibWrapperService","authStorageService","authRedirectService","routingService","checkOAuthParamsInUrl","AuthActions.Login","loginWithRedirect","loginWithCredentials","coreLogout","AuthActions.Logout","isUserLoggedIn","userToken","access_token","ImageType","B2BUserRole","VariantType","PriceType","VariantQualifier","DaysOfWeek","ANONYMOUS_CONSENTS_HEADER","NotificationType","ORDER_TYPE","ENTITY_REMOVE_ACTION","ENTITY_REMOVE_ALL_ACTION","entityMeta","entityType","entityId","entityRemoveMeta","entityRemove","entityRemoveAllMeta","EntityRemoveAction","meta","EntityRemoveAllAction","LOADER_LOAD_ACTION","LOADER_FAIL_ACTION","LOADER_SUCCESS_ACTION","LOADER_RESET_ACTION","loadMeta","loader","load","failMeta","successMeta","success","resetMeta","LoaderLoadAction","LoaderFailAction","LoaderSuccessAction","LoaderResetAction","ENTITY_LOAD_ACTION","ENTITY_FAIL_ACTION","ENTITY_SUCCESS_ACTION","ENTITY_RESET_ACTION","entityLoadMeta","entityFailMeta","entitySuccessMeta","entityResetMeta","EntityLoadAction","EntityFailAction","EntitySuccessAction","EntityLoaderResetAction","initialLoaderState","loading","loaderReducer","reducer","action","entity","newValue","loaderValueSelector","loaderLoadingSelector","loaderErrorSelector","loaderSuccessSelector","entityLoaderStateSelector","entities","entityValueSelector","initialEntityState","entityReducer","ids","partitionPayload","removed_1","newEntities","keys","reduce","acc","cur","entityUpdates","subAction","newState","entityLoaderReducer","PROCESSES_INCREMENT_ACTION","PROCESSES_DECREMENT_ACTION","PROCESSES_LOADER_RESET_ACTION","processesIncrementMeta","processesCountDiff","processesDecrementMeta","processesLoaderResetMeta","loaderResetMeta","ProcessesLoaderResetAction","ProcessesIncrementAction","ProcessesDecrementAction","ENTITY_PROCESSES_LOADER_RESET_ACTION","ENTITY_PROCESSES_INCREMENT_ACTION","ENTITY_PROCESSES_DECREMENT_ACTION","entityProcessesLoaderResetMeta","entityProcessesIncrementMeta","entityProcessesDecrementMeta","EntityProcessesLoaderResetAction","EntityProcessesIncrementAction","EntityProcessesDecrementAction","isStableSelector","processesCount","hasPendingProcessesSelector","initialProcessesState","processesLoaderReducer","loaderState","initialProcessesLoaderState","entityHasPendingProcessesSelector","entityIsStableSelector","entityProcessesLoaderStateSelector","entityProcessesLoaderReducer","entitySelector","OBJECT_SEPARATOR","getStateSliceValue","previous","current","createShellObject","excludeKeys","shell","reduceRight","exclusionKeys","excludeKeys_1","excludeKeys_1_1","exclusionKey","getExclusionKeys","finalValue","exclusionKeys_1","exclusionKeys_1_1","exclusionChunksSplit","nestedTemp","currentChunk","handleExclusions","getStateSlice","stateSlices","keys_1","keys_1_1","currentKey","filterKeysByType","serializeSearchConfig","pageSize","currentPage","sort","denormalizeCustomB2BSearch","list","serializedList","res","values","code","pagination","sorts","page","searchConfig","toString","ANONYMOUS_CONSENTS_STORE_FEATURE","ANONYMOUS_CONSENTS","LOAD_ANONYMOUS_CONSENT_TEMPLATES","LOAD_ANONYMOUS_CONSENT_TEMPLATES_SUCCESS","LOAD_ANONYMOUS_CONSENT_TEMPLATES_FAIL","RESET_LOAD_ANONYMOUS_CONSENT_TEMPLATES","GET_ALL_ANONYMOUS_CONSENTS","GET_ANONYMOUS_CONSENT","SET_ANONYMOUS_CONSENTS","GIVE_ANONYMOUS_CONSENT","WITHDRAW_ANONYMOUS_CONSENT","TOGGLE_ANONYMOUS_CONSENTS_BANNER_DISMISSED","TOGGLE_ANONYMOUS_CONSENT_TEMPLATES_UPDATED","ANONYMOUS_CONSENT_CHECK_UPDATED_VERSIONS","LoadAnonymousConsentTemplates","StateUtils.LoaderLoadAction","LoadAnonymousConsentTemplatesSuccess","StateUtils.LoaderSuccessAction","LoadAnonymousConsentTemplatesFail","StateUtils.LoaderFailAction","ResetLoadAnonymousConsentTemplates","StateUtils.LoaderResetAction","GetAllAnonymousConsents","GetAnonymousConsent","templateCode","SetAnonymousConsents","GiveAnonymousConsent","WithdrawAnonymousConsent","ToggleAnonymousConsentsBannerDissmissed","dismissed","ToggleAnonymousConsentTemplatesUpdated","updated","AnonymousConsentCheckUpdatedVersions","getAnonymousConsentState","templates","getAnonymousConsentTemplatesState","ɵ0$1","getAnonymousConsentTemplatesValue","StateUtils.loaderValueSelector","getAnonymousConsentTemplatesLoading","StateUtils.loaderLoadingSelector","getAnonymousConsentTemplatesSuccess","StateUtils.loaderSuccessSelector","getAnonymousConsentTemplatesError","StateUtils.loaderErrorSelector","getAnonymousConsentTemplate","template","getAnonymousConsentTemplatesUpdate","ui","bannerDismissed","getAnonymousConsentsBannerDismissed","ɵ1$1","getAnonymousConsents","consents","getAnonymousConsentByTemplateCode","consent","AnonymousConsentsService","authService","loadTemplates","AnonymousConsentsActions.LoadAnonymousConsentTemplates","getTemplates","loadIfMissing","iif","AnonymousConsentsSelectors.getAnonymousConsentTemplatesValue","withLatestFrom","getLoadTemplatesLoading","tap","getTemplate","AnonymousConsentsSelectors.getAnonymousConsentTemplate","AnonymousConsentsSelectors.getAnonymousConsentTemplatesLoading","getLoadTemplatesSuccess","AnonymousConsentsSelectors.getAnonymousConsentTemplatesSuccess","getLoadTemplatesError","AnonymousConsentsSelectors.getAnonymousConsentTemplatesError","resetLoadTemplatesState","AnonymousConsentsActions.ResetLoadAnonymousConsentTemplates","getConsents","AnonymousConsentsSelectors.getAnonymousConsents","setConsents","AnonymousConsentsActions.SetAnonymousConsents","getConsent","templateId","authenticated","switchMap","AnonymousConsentsSelectors.getAnonymousConsentByTemplateCode","giveConsent","AnonymousConsentsActions.GiveAnonymousConsent","giveAllConsents","isConsentGiven","consentState","GIVEN","withdrawConsent","AnonymousConsentsActions.WithdrawAnonymousConsent","withdrawAllConsents","isConsentWithdrawn","WITHDRAWN","toggleBannerDismissed","AnonymousConsentsActions.ToggleAnonymousConsentsBannerDissmissed","toggleTemplatesUpdated","isBannerDismissed","AnonymousConsentsSelectors.getAnonymousConsentsBannerDismissed","getTemplatesUpdated","AnonymousConsentsSelectors.getAnonymousConsentTemplatesUpdate","AnonymousConsentsActions.ToggleAnonymousConsentTemplatesUpdated","isBannerVisible","combineLatest","checkConsentVersions","AnonymousConsentsActions.AnonymousConsentCheckUpdatedVersions","detectUpdatedTemplates","currentTemplates","newTemplates","newTemplate","currentTemplate","version","serializeAndEncode","serialized","encodeURIComponent","decodeAndDeserialize","rawConsents","decoded","decodeURIComponent","consentsUpdated","newConsents","previousConsents","DynamicTemplate","templateString","templateVariables","variableLabel","placeholder","RegExp","replace","getContextParameterValues","parameter","getContextParameterDefault","param","LANGUAGE_CONTEXT_ID","CURRENCY_CONTEXT_ID","BASE_SITE_CONTEXT_ID","LOAD_BASE_SITE","LOAD_BASE_SITE_FAIL","LOAD_BASE_SITE_SUCCESS","LOAD_BASE_SITES","LOAD_BASE_SITES_FAIL","LOAD_BASE_SITES_SUCCESS","SET_ACTIVE_BASE_SITE","BASE_SITE_CHANGE","LoadBaseSite","LoadBaseSiteFail","LoadBaseSiteSuccess","LoadBaseSites","LoadBaseSitesFail","LoadBaseSitesSuccess","SetActiveBaseSite","BaseSiteChange","LOAD_CURRENCIES","LOAD_CURRENCIES_FAIL","LOAD_CURRENCIES_SUCCESS","SET_ACTIVE_CURRENCY","CURRENCY_CHANGE","LoadCurrencies","LoadCurrenciesFail","LoadCurrenciesSuccess","SetActiveCurrency","CurrencyChange","LOAD_LANGUAGES","LOAD_LANGUAGES_FAIL","LOAD_LANGUAGES_SUCCESS","SET_ACTIVE_LANGUAGE","LANGUAGE_CHANGE","LoadLanguages","LoadLanguagesFail","LoadLanguagesSuccess","SetActiveLanguage","LanguageChange","SITE_CONTEXT_FEATURE","getSiteContextState","sitesEntitiesSelector","baseSite","getBaseSiteState","ɵ1$2","activeSite","getActiveBaseSite","ɵ2$1","details","getBaseSiteData","ɵ3$1","getBaseSitesEntities","uid","getAllBaseSites","ɵ4$1","currenciesEntitiesSelector","activeCurrencySelector","activeCurrency","getCurrenciesState","currencies","getCurrenciesEntities","getActiveCurrency","getAllCurrencies","isocode","activeLanguageSelector","activeLanguage","languagesEntitiesSelector","getLanguagesState","languages","getLanguagesEntities","getActiveLanguage","getAllLanguages","BaseSiteService","getActive","SiteContextSelectors.getActiveBaseSite","active","getAll","SiteContextSelectors.getAllBaseSites","sites","SiteContextActions.LoadBaseSites","siteUid","site","activeSiteUid","setActive","activeBaseSite","SiteContextActions.SetActiveBaseSite","HttpParamsURIEncoder","encodeKey","encodeValue","decodeKey","decodeValue","DEFAULT_SCOPE","OccEndpointsService","baseSiteService","_activeBaseSite","getRawEndpoint","endpoints","getOccEndpoint","prefix","endsWith","getBaseEndpoint","getEndpoint","getUrl","urlParams","queryParams","scope","getEndpointForScope","httpParamsOptions","encoder","queryParamsFromEndpoint","fromString","httpParams_1","HttpParams","delete","set","endpointConfig","USE_CLIENT_TOKEN","USE_CUSTOMER_SUPPORT_AGENT_TOKEN","InterceptorUtil","createHeader","headerName","interceptorParam","headers","append","HttpHeaders","removeHeader","request","updatedHeaders","clone","getInterceptorParam","rawValue","CLIENT_AUTH_FEATURE","CLIENT_TOKEN_DATA","LOAD_CLIENT_TOKEN","LOAD_CLIENT_TOKEN_FAIL","LOAD_CLIENT_TOKEN_SUCCESS","LoadClientToken","LoadClientTokenFail","LoadClientTokenSuccess","getClientAuthState","clientToken","getClientTokenState","ɵ0$7","ClientTokenService","getClientToken","ClientAuthSelectors.getClientTokenState","observeOn","queueScheduler","isClientTokenLoaded","ClientAuthActions.LoadClientToken","refreshClientToken","ClientErrorHandlingService","clientTokenService","handleExpiredClientToken","handle","createNewRequestWithNewToken","setHeaders","Authorization","token_type","ClientTokenInterceptor","clientErrorHandlingService","occEndpoints","intercept","isClientTokenRequest","catchError","errResponse","HttpErrorResponse","status","isExpiredToken","throwError","isRequestMapping","resp","errors","StorageSyncType","interceptors","HTTP_INTERCEPTORS","DEFAULT_LOCAL_STORAGE_KEY","DEFAULT_SESSION_STORAGE_KEY","defaultStateConfig","storageSync","localStorageKeyName","sessionStorageKeyName","StateTransferType","getStorageSyncReducer","storageSyncConfig","INIT","UPDATE","rehydratedState","localStorageValue","readFromStorage","sessionStorageValue","rehydrate","localStorageStateSlices","LOCAL_STORAGE","persistToStorage","sessionStorageStateSlices","SESSION_STORAGE","getStorage","storageType","storage","NO_STORAGE","configKey","isSsr","storageValue","StatePersistenceService","syncWithStorage","state$","context$","onRead","subscriptions","Subscription","generateKeyWithContext","readStateFromStorage","join","AuthStatePersistenceService","statePersistenceService","subscription","initSync","getAuthState","authToken","refresh_token","ngOnDestroy","CX_KEY","makeStateKey","getTransferStateReducer","transferState","authStatePersistenceService","ssrTransfer","isPlatformBrowser","isLoggedIn","transferStateKeys","TRANSFER_STATE","hasKey","cxKey","getBrowserTransferStateReducer","stateSlice","getServerTransferStateReducer","TRANSFER_STATE_META_REDUCER","STORAGE_SYNC_META_REDUCER","ɵ1$5","stateMetaReducers","TransferState","META_REDUCERS","StateModule","forRoot","ngModule","providers","normalizeHttpError","normalizedError","message","statusText","error_description","NgModule","ClientAuthenticationTokenService","http","loadClientAuthenticationToken","Content-Type","post","HttpClient","actions$","clientAuthenticationTokenService","loadClientToken$","ofType","ClientAuthActions.LOAD_CLIENT_TOKEN","exhaustMap","ClientAuthActions.LoadClientTokenSuccess","ClientAuthActions.LoadClientTokenFail","Actions","Effect","effects","ClientTokenEffect","getReducers","reducerToken","reducerProvider","imports","CommonModule","HttpClientModule","StoreModule","forFeature","EffectsModule","ClientAuthModule","ClientAuthStoreModule","CONFIG_INITIALIZER","CONFIG_INITIALIZER_FORROOT_GUARD","ConfigInitializerService","initializerGuard","rootConfig","ongoingScopes$","getStableConfig","scopes","isStable","ongoingScopes","areReady","mapTo","toPromise","finishScopes","newScopes","scopes_1","scopes_1_1","splice","indexOf","scopes_2","scopes_2_1","ongoingScopes_1","e_3","ongoingScopes_1_1","ongoingScope","scopesOverlap","a","initializers","asyncConfigs","initializer","this_1","initializerConfig","all","GlobalMessageType","defaultAuthConfig","customTokenParameters","strictDiscoveryDocumentValidation","skipIssuerCheck","disablePKCE","oidc","clearHashAfterLogin","ADD_MESSAGE","REMOVE_MESSAGE","REMOVE_MESSAGES_BY_TYPE","AddMessage","RemoveMessage","RemoveMessagesByType","GLOBAL_MESSAGE_FEATURE","getGlobalMessageState","getGlobalMessageEntities","ɵ0$9","getGlobalMessageEntitiesByType","getGlobalMessageCountByType","GlobalMessageService","GlobalMessageSelectors.getGlobalMessageEntities","text","timeout","GlobalMessageActions.AddMessage","raw","remove","index","GlobalMessageActions.RemoveMessage","GlobalMessageActions.RemoveMessagesByType","AuthHttpHeaderService","globalMessageService","shouldCatchError","isOccUrl","alterRequest","hasAuthorizationHeader","getAuthorizationHeader","createAuthorizationHeader","tok","handleExpiredAccessToken","handleExpiredToken","handleExpiredRefreshToken","MSG_TYPE_ERROR","oldToken","AuthInterceptor","authHttpHeaderService","TokenRevocationInterceptor","isTokenRevocationRequest","configInit","authStatePersistenceFactory","UserAuthModule","APP_INITIALIZER","OAuthModule","AuthModule","AuthGuard","canActivate","NotAuthGuard","defaultOccAsmConfig","asmCustomerSearch","AsmConfig","CUSTOMER_SEARCH_PAGE_NORMALIZER","createFrom","MergingSubject","subscriptionsToSources","Map","output$","Observable","consumer","bindAllSourcesToConsumer","unbindAllSourcesFromConsumer","share","bindSourceToConsumer","unbindSourceFromConsumer","subscriptionToSource","findIndex","EventService","eventsMeta","register","eventType","source$","eventMeta","getEventMeta","mergingSubject","getValidatedEventStream","getInputSubject","inputSubject$","Subject","validateEventType","createEventMeta","name","NOT_FOUND_SYMBOL","CombinedInjector","mainInjector","complementaryInjectors","notFoundValue","flags","Self","service","LazyModulesService","compiler","injector","modules$","ModuleInitializedEvent","moduleRef","publishReplay","dependencyModules","eventSubscription","connect","resolveModuleInstance","moduleFunc","feature","dependencyModuleRefs","parentInjector","resolveModuleFactory","resolveDependencyModuleInstance","moduleFactory","module","from","NgModuleFactory","compileModuleAsync","dependency","destroy","Compiler","Injector","UnifiedInjector","rootInjector","lazyModules","injectors$","instance","getMulti","instances","scan","services","getLastValueSync","emission","ConverterService","unifiedInjector","converters","cacheResetLogic","clear","getConverters","injectionToken","hasConverters","pipeable","model","convertSource","observable","pipeableMany","convertMany","convert","converter","OccAsmAdapter","occEndpointsService","converterService","customerSearch","options","AsmAdapter","useClass","CART_NORMALIZER","PRODUCT_NORMALIZER","OccCartNormalizer","entry","product","removeDuplicatePromotions","potentialOrderPromotions","removeDuplicateItems","potentialProductPromotions","appliedOrderPromotions","appliedProductPromotions","itemList","el","defaultOccCartConfig","carts","cart","createCart","addEntries","updateEntries","removeEntries","addEmail","deleteCart","cartVoucher","saveCart","CART_MODIFICATION_NORMALIZER","OccCartEntryAdapter","cartId","productCode","quantity","toAdd","qty","update","entryNumber","pickupStore","patch","CART_VOUCHER_NORMALIZER","OccCartVoucherAdapter","getCartVoucherEndpoint","getHeaders","voucherId","OccCartAdapter","loadAll","pluck","oldCartId","toMergeCartGuid","email","httpParams","put","SAVE_CART_NORMALIZER","OccSaveCartAdapter","saveCartName","saveCartDescription","CartAdapter","CartEntryAdapter","CartVoucherAdapter","SaveCartAdapter","ORDER_NORMALIZER","POINT_OF_SERVICE_NORMALIZER","CheckoutConnector","adapter","placeOrder","termsChecked","loadCheckoutDetails","clearCheckoutDeliveryAddress","clearCheckoutDeliveryMode","CheckoutAdapter","CheckoutCostCenterConnector","setCostCenter","costCenterId","CheckoutCostCenterAdapter","CheckoutDeliveryConnector","createAddress","address","setAddress","addressId","setMode","deliveryModeId","getMode","getSupportedModes","CheckoutDeliveryAdapter","DELIVERY_MODE_NORMALIZER","PaymentTypeConnector","getPaymentTypes","loadPaymentTypes","setPaymentType","typeCode","poNumber","PaymentTypeAdapter","PAYMENT_TYPE_NORMALIZER","CheckoutPaymentConnector","paymentDetails","paymentDetailsId","getCardTypes","loadCardTypes","CheckoutPaymentAdapter","PAYMENT_DETAILS_NORMALIZER","PAYMENT_DETAILS_SERIALIZER","CARD_TYPE_NORMALIZER","CheckoutReplenishmentOrderConnector","scheduleReplenishmentOrder","scheduleReplenishmentForm","CheckoutReplenishmentOrderAdapter","REPLENISHMENT_ORDER_NORMALIZER","REPLENISHMENT_ORDER_FORM_SERIALIZER","OccOrderNormalizer","convertOrderEntry","consignments","consignment","orderEntry","unconsignedEntries","TimeUtils","getLocalTimezoneOffset","invert","offset","getTimezoneOffset","Math","abs","floor","padStart","convertDateToDatetime","date","endOfDay","convertDatetimeToDate","datetime","substring","toISOString","OccReplenishmentOrderFormSerializer","replenishmentStartDate","convertDate","toLocaleTimeString","hour","minute","hour12","OccReplenishmentOrderNormalizer","defaultOccCheckoutConfig","setDeliveryAddress","OccCheckoutCostCenterAdapter","getCartEndpoint","cartEndpoint","ADDRESS_NORMALIZER","ADDRESS_LIST_NORMALIZER","ADDRESS_SERIALIZER","ADDRESS_VALIDATION_NORMALIZER","OccCheckoutDeliveryAdapter","OccCheckoutPaymentTypeAdapter","paymentTypeList","paymentTypes","paymentType","purchaseOrderNumber","OccCheckoutPaymentAdapter","DOMParser","domparser","getProviderSubInfo","labelsMap","convertToMap","mappingLabels","postUrl","parameters","getParamsForPaymentProvider","mergeMap","sub","createSubWithProvider","response","extractPaymentDetailsFromHtml","fromPaymentProvider","defaultPayment","createDetailsWithParameters","cardTypeList","cardTypes","Accept","accountHolderName","cardType","cardNumber","expiryMonth","expiryYear","cvn","billingAddress","country","firstName","lastName","line1","line2","town","region","isocodeShort","postalCode","html","inputs","parseFromString","getElementsByTagName","input","getAttribute","paramList","PageMetaResolver","getScore","score","pageType","pageTemplate","hasMatch","getPriority","StateEventService","actionsSubject","eventService","mapping","getFromAction","createEvent","ActionsSubject","VERIFY_ADDRESS","VERIFY_ADDRESS_FAIL","VERIFY_ADDRESS_SUCCESS","CLEAR_ADDRESS_VERIFICATION_RESULTS","VerifyAddress","VerifyAddressFail","VerifyAddressSuccess","ClearAddressVerificationResults","LOAD_CARD_TYPES","LOAD_CARD_TYPES_FAIL","LOAD_CARD_TYPES_SUCCESS","LoadCardTypes","LoadCardTypesFail","LoadCardTypesSuccess","MULTI_CART_FEATURE","MULTI_CART_DATA","ADD_VOUCHER_PROCESS_ID","PROCESS_FEATURE","CHECKOUT_FEATURE","CHECKOUT_DETAILS","SET_DELIVERY_ADDRESS_PROCESS_ID","SET_DELIVERY_MODE_PROCESS_ID","SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID","SET_PAYMENT_DETAILS_PROCESS_ID","GET_PAYMENT_TYPES_PROCESS_ID","SET_COST_CENTER_PROCESS_ID","PLACED_ORDER_PROCESS_ID","CLEAR_CHECKOUT_DELIVERY_ADDRESS","CLEAR_CHECKOUT_DELIVERY_ADDRESS_SUCCESS","CLEAR_CHECKOUT_DELIVERY_ADDRESS_FAIL","CLEAR_CHECKOUT_DELIVERY_MODE","CLEAR_CHECKOUT_DELIVERY_MODE_SUCCESS","CLEAR_CHECKOUT_DELIVERY_MODE_FAIL","ADD_DELIVERY_ADDRESS","ADD_DELIVERY_ADDRESS_FAIL","ADD_DELIVERY_ADDRESS_SUCCESS","SET_DELIVERY_ADDRESS","SET_DELIVERY_ADDRESS_FAIL","SET_DELIVERY_ADDRESS_SUCCESS","RESET_SET_DELIVERY_ADDRESS_PROCESS","LOAD_SUPPORTED_DELIVERY_MODES","LOAD_SUPPORTED_DELIVERY_MODES_FAIL","LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS","CLEAR_SUPPORTED_DELIVERY_MODES","SET_DELIVERY_MODE","SET_DELIVERY_MODE_FAIL","SET_DELIVERY_MODE_SUCCESS","RESET_SET_DELIVERY_MODE_PROCESS","RESET_SUPPORTED_SET_DELIVERY_MODES_PROCESS","CREATE_PAYMENT_DETAILS","CREATE_PAYMENT_DETAILS_FAIL","CREATE_PAYMENT_DETAILS_SUCCESS","SET_PAYMENT_DETAILS","SET_PAYMENT_DETAILS_FAIL","SET_PAYMENT_DETAILS_SUCCESS","RESET_SET_PAYMENT_DETAILS_PROCESS","PLACE_ORDER","PLACE_ORDER_FAIL","PLACE_ORDER_SUCCESS","CLEAR_PLACE_ORDER","CLEAR_CHECKOUT_STEP","CLEAR_CHECKOUT_DATA","LOAD_CHECKOUT_DETAILS","LOAD_CHECKOUT_DETAILS_FAIL","LOAD_CHECKOUT_DETAILS_SUCCESS","CHECKOUT_CLEAR_MISCS_DATA","PAYMENT_PROCESS_SUCCESS","SET_COST_CENTER","SET_COST_CENTER_FAIL","SET_COST_CENTER_SUCCESS","RESET_SET_COST_CENTER_PROCESS","AddDeliveryAddress","AddDeliveryAddressFail","AddDeliveryAddressSuccess","SetDeliveryAddress","StateUtils.EntityLoadAction","SetDeliveryAddressFail","StateUtils.EntityFailAction","SetDeliveryAddressSuccess","StateUtils.EntitySuccessAction","ResetSetDeliveryAddressProcess","StateUtils.EntityLoaderResetAction","LoadSupportedDeliveryModes","LoadSupportedDeliveryModesFail","LoadSupportedDeliveryModesSuccess","ResetLoadSupportedDeliveryModesProcess","SetDeliveryMode","SetDeliveryModeFail","SetDeliveryModeSuccess","ResetSetDeliveryModeProcess","CreatePaymentDetails","CreatePaymentDetailsFail","CreatePaymentDetailsSuccess","PaymentProcessSuccess","SetPaymentDetails","SetPaymentDetailsFail","SetPaymentDetailsSuccess","ResetSetPaymentDetailsProcess","PlaceOrder","PlaceOrderFail","PlaceOrderSuccess","ClearPlaceOrder","ClearSupportedDeliveryModes","ClearCheckoutStep","ClearCheckoutData","LoadCheckoutDetails","LoadCheckoutDetailsFail","LoadCheckoutDetailsSuccess","CheckoutClearMiscsData","ClearCheckoutDeliveryAddress","ClearCheckoutDeliveryAddressSuccess","ClearCheckoutDeliveryAddressFail","ClearCheckoutDeliveryMode","ClearCheckoutDeliveryModeSuccess","ClearCheckoutDeliveryModeFail","SetCostCenter","SetCostCenterFail","SetCostCenterSuccess","ResetSetCostCenterProcess","SET_ORDER_TYPE","SetOrderType","LOAD_PAYMENT_TYPES","LOAD_PAYMENT_TYPES_FAIL","LOAD_PAYMENT_TYPES_SUCCESS","RESET_LOAD_PAYMENT_TYPES_PROCESS_ID","SET_PAYMENT_TYPE","SET_PAYMENT_TYPE_FAIL","SET_PAYMENT_TYPE_SUCCESS","LoadPaymentTypes","LoadPaymentTypesFail","LoadPaymentTypesSuccess","ResetLoadPaymentTypesProcess","SetPaymentType","SetPaymentTypeFail","SetPaymentTypeSuccess","SCHEDULE_REPLENISHMENT_ORDER","SCHEDULE_REPLENISHMENT_ORDER_SUCCESS","SCHEDULE_REPLENISHMENT_ORDER_FAIL","CLEAR_SCHEDULE_REPLENISHMENT_ORDER","ScheduleReplenishmentOrder","ScheduleReplenishmentOrderSuccess","ScheduleReplenishmentOrderFail","ClearScheduleReplenishmentOrderAction","CheckoutEventBuilder","stateEventService","orderPlacedEvent","CheckoutActions.PLACE_ORDER_SUCCESS","OrderPlacedEvent","_checkoutEventBuilder","CART_ADD_ENTRY","CART_ADD_ENTRY_SUCCESS","CART_ADD_ENTRY_FAIL","CART_REMOVE_ENTRY","CART_REMOVE_ENTRY_SUCCESS","CART_REMOVE_ENTRY_FAIL","CART_UPDATE_ENTRY","CART_UPDATE_ENTRY_SUCCESS","CART_UPDATE_ENTRY_FAIL","CartAddEntry","CartAddEntrySuccess","CartAddEntryFail","CartRemoveEntry","CartRemoveEntrySuccess","CartRemoveEntryFail","CartUpdateEntry","CartUpdateEntrySuccess","CartUpdateEntryFail","CART_ADD_VOUCHER","CART_ADD_VOUCHER_FAIL","CART_ADD_VOUCHER_SUCCESS","CART_RESET_ADD_VOUCHER","CART_REMOVE_VOUCHER","CART_REMOVE_VOUCHER_FAIL","CART_REMOVE_VOUCHER_SUCCESS","CartAddVoucher","CartAddVoucherFail","CartAddVoucherSuccess","CartResetAddVoucher","CartRemoveVoucher","CartRemoveVoucherFail","CartRemoveVoucherSuccess","CREATE_CART","CREATE_CART_FAIL","CREATE_CART_SUCCESS","LOAD_CART","LOAD_CART_FAIL","LOAD_CART_SUCCESS","ADD_EMAIL_TO_CART","ADD_EMAIL_TO_CART_FAIL","ADD_EMAIL_TO_CART_SUCCESS","MERGE_CART","MERGE_CART_SUCCESS","RESET_CART_DETAILS","REMOVE_CART","DELETE_CART","DELETE_CART_SUCCESS","DELETE_CART_FAIL","CreateCart","tempCartId","CreateCartFail","CreateCartSuccess","AddEmailToCart","AddEmailToCartFail","AddEmailToCartSuccess","LoadCart","LoadCartFail","LoadCartSuccess","MergeCart","MergeCartSuccess","ResetCartDetails","RemoveCart","DeleteCart","DeleteCartSuccess","DeleteCartFail","SET_TEMP_CART","CART_PROCESSES_INCREMENT","CART_PROCESSES_DECREMENT","SET_ACTIVE_CART_ID","CLEAR_CART_STATE","SetTempCart","CartProcessesIncrement","CartProcessesDecrement","SetActiveCartId","ClearCartState","getCartIdByUserId","guid","isCartNotFoundError","reason","subjectType","subject","getWishlistName","customerId","isTempCartId","CREATE_WISH_LIST","CREATE_WISH_LIST_FAIL","CREATE_WISH_LIST_SUCCESS","LOAD_WISH_LIST","LOAD_WISH_LIST_SUCCESS","LOAD_WISH_LIST_FAIL","CreateWishList","CreateWishListSuccess","CreateWishListFail","LoadWishList","LoadWishListSuccess","LoadWishListFail","getMultiCartState","getMultiCartEntities","ɵ0$a","getCartEntitySelectorFactory","getCartSelectorFactory","getCartIsStableSelectorFactory","getCartHasPendingProcessesSelectorFactory","getCartEntriesSelectorFactory","getCartEntrySelectorFactory","getActiveCartId","ɵ1$6","wishList","getWishListId","ɵ2$4","MultiCartService","getCart","MultiCartSelectors.getCartSelectorFactory","getCartEntity","MultiCartSelectors.getCartEntitySelectorFactory","MultiCartSelectors.getCartIsStableSelectorFactory","debounce","timer","EMPTY","generateTempCartId","random","substr","extraData","CartActions.CreateCart","mergeToCurrentCart","CartActions.MergeCart","loadCart","CartActions.LoadCart","getEntries","MultiCartSelectors.getCartEntriesSelectorFactory","getLastEntry","filteredEntries","addEntry","CartActions.CartAddEntry","products","removeEntry","CartActions.CartRemoveEntry","updateEntry","CartActions.CartUpdateEntry","getEntry","MultiCartSelectors.getCartEntrySelectorFactory","assignEmail","CartActions.AddEmailToCart","CartActions.DeleteCart","reloadCart","TO_ESCAPE_BASE","with","TO_ESCAPE_WILDCARD_QM","TO_ESCAPE_LITERAL_QM","globToRegex","glob","literalQuestionMark","toEscape","reverse","regex","seg","escape","processGlobPatterns","urls","positive","GlobService","getValidator","patterns","processedPatterns","includePatterns","spec","excludePatterns","some","pattern","test","UrlMatcherService","globService","getFalsy","getFromPaths","matchers","getFromPath","matcher","getCombined","segmentGroup","pathMatch","hasChildren","consumed","posParams","parts","part","getOpposite","originalMatcher","group","getFromGlob","globPatterns","globValidator","fullPath","ConfigurableRoutesService","urlMatcherService","initCalled","init","resetConfig","configureRoutes","configuredRoute","configureRoute","validateRouteConfig","disabled","resolveUrlMatchers","matchersOrFactories","matcherOrFactory","resolveUrlMatcherFactory","factoryToken","ProductURLPipe","semanticPath","Pipe","UrlPipe","urlService","declarations","exports","ExternalRoutesGuard","href","addExternalRoutesFactory","addRoutes","ExternalRoutesService","internal","newRoutes","getRoutes","internalUrlPatterns","getUrlMatcher","component","ExternalRoutesConfig","ExternalRoutesModule","ProtectedRoutesService","nonProtectedPaths","shouldProtect","getNonProtectedPaths","getSegments","routingConfig","protected","isUrlProtected","urlSegments","matchAnyPath","pathsSegments","pathSegments","matchPath","pathSeg","urlSeg","ProtectedRoutesGuard","authGuard","navigate$","RoutingActions.ROUTER_GO","navigateByUrl$","RoutingActions.ROUTER_GO_BY_URL","navigateByUrl","clearCmsRoutes$","SiteContextActions.LANGUAGE_CHANGE","AuthActions.LOGOUT","AuthActions.LOGIN","filteredConfig","cxCmsRouteContext","navigateBack$","RoutingActions.ROUTER_BACK","navigateForward$","RoutingActions.ROUTER_FORWARD","Location","RouterEffects","initialState","cmsRequired","fromNgrxRouter.ROUTER_NAVIGATION","fromNgrxRouter.ROUTER_ERROR","fromNgrxRouter.ROUTER_CANCEL","fromNgrxRouter.ROUTER_NAVIGATED","CustomSerializer","serialize","urlString","urlSegment","x","guardName","lookupSemanticRoute","CONTENT_PAGE","PRODUCT_PAGE","CATEGORY_PAGE","pageLabel","initConfigurableRoutes","RoutingModule","RouterStateSerializer","StoreRouterConnectingModule","stateKey","DEFAULT_URL_MATCHER","CheckoutCartInterceptor","multiCartService","isUserInCheckoutRoute","cartCode","getCartIdFromError","toLowerCase","PageRobotsMeta","EMAIL_PATTERN","ActiveCartService","PREVIOUS_USER_ID_INITIAL_VALUE","previousUserId","activeCartId$","MultiCartSelectors.getActiveCartId","cartSelector$","initActiveCart","auditTime","isJustLoggedIn","loadOrMerge","activeCart$","cartEntity","activeCartId","loaded","isEmpty","cartUser","user","getLoading","isGuestCart","guestCartMerge","addEntriesGuestMerge","cartEntries","entriesToAdd","requireLoadedCartForGuestMerge","cartState","requireLoadedCart","isCartCreating","customCartSelector$","getAssignedUser","isEmail","str","match","CheckoutPageMetaResolver","translation","activeCartService","cart$","resolveTitle","translate","count","totalItems","resolveRobots","NOFOLLOW","NOINDEX","TranslationService","UserAddressConnector","verify","UserAddressAdapter","UNKNOWN_ERROR","circularReplacer","seen","WeakSet","_key","makeErrorSerializable","stack","serializableError","userAddressConnector","verifyAddress$","CheckoutActions.VERIFY_ADDRESS","CheckoutActions.VerifyAddressSuccess","CheckoutActions.VerifyAddressFail","checkoutPaymentConnector","loadCardTypes$","CheckoutActions.LOAD_CARD_TYPES","CheckoutActions.LoadCardTypesSuccess","CheckoutActions.LoadCardTypesFail","LOAD_BILLING_COUNTRIES","LOAD_BILLING_COUNTRIES_FAIL","LOAD_BILLING_COUNTRIES_SUCCESS","LoadBillingCountries","LoadBillingCountriesFail","LoadBillingCountriesSuccess","LOAD_CONSIGNMENT_TRACKING","LOAD_CONSIGNMENT_TRACKING_FAIL","LOAD_CONSIGNMENT_TRACKING_SUCCESS","CLEAR_CONSIGNMENT_TRACKING","LoadConsignmentTracking","LoadConsignmentTrackingFail","LoadConsignmentTrackingSuccess","ClearConsignmentTracking","USER_FEATURE","UPDATE_EMAIL_PROCESS_ID","UPDATE_PASSWORD_PROCESS_ID","UPDATE_USER_DETAILS_PROCESS_ID","REGISTER_USER_PROCESS_ID","REMOVE_USER_PROCESS_ID","GIVE_CONSENT_PROCESS_ID","WITHDRAW_CONSENT_PROCESS_ID","UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID","ADD_PRODUCT_INTEREST_PROCESS_ID","REMOVE_PRODUCT_INTERESTS_PROCESS_ID","CANCEL_ORDER_PROCESS_ID","CANCEL_RETURN_PROCESS_ID","CANCEL_REPLENISHMENT_ORDER_PROCESS_ID","USER_CONSENTS","USER_PAYMENT_METHODS","USER_ORDERS","USER_ADDRESSES","USER_RETURN_REQUESTS","USER_RETURN_REQUEST_DETAILS","USER_ORDER_DETAILS","USER_COST_CENTERS","USER_REPLENISHMENT_ORDERS","USER_REPLENISHMENT_ORDER_DETAILS","REGIONS","CUSTOMER_COUPONS","SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID","UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID","CLAIM_CUSTOMER_COUPON_PROCESS_ID","NOTIFICATION_PREFERENCES","PRODUCT_INTERESTS","getProcessStateFactory","processId","entityState","StateUtils.entityLoaderStateSelector","getProcessLoadingFactory","getProcessSuccessFactory","getProcessErrorFactory","LOAD_CUSTOMER_COUPONS","LOAD_CUSTOMER_COUPONS_FAIL","LOAD_CUSTOMER_COUPONS_SUCCESS","RESET_LOAD_CUSTOMER_COUPONS","SUBSCRIBE_CUSTOMER_COUPON","SUBSCRIBE_CUSTOMER_COUPON_FAIL","SUBSCRIBE_CUSTOMER_COUPON_SUCCESS","RESET_SUBSCRIBE_CUSTOMER_COUPON_PROCESS","UNSUBSCRIBE_CUSTOMER_COUPON","UNSUBSCRIBE_CUSTOMER_COUPON_FAIL","UNSUBSCRIBE_CUSTOMER_COUPON_SUCCESS","RESET_UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS","CLAIM_CUSTOMER_COUPON","CLAIM_CUSTOMER_COUPON_FAIL","CLAIM_CUSTOMER_COUPON_SUCCESS","LoadCustomerCoupons","LoadCustomerCouponsFail","LoadCustomerCouponsSuccess","ResetLoadCustomerCoupons","SubscribeCustomerCoupon","SubscribeCustomerCouponFail","SubscribeCustomerCouponSuccess","ResetSubscribeCustomerCouponProcess","UnsubscribeCustomerCoupon","UnsubscribeCustomerCouponFail","UnsubscribeCustomerCouponSuccess","ResetUnsubscribeCustomerCouponProcess","ClaimCustomerCoupon","ClaimCustomerCouponFail","ClaimCustomerCouponSuccess","LOAD_DELIVERY_COUNTRIES","LOAD_DELIVERY_COUNTRIES_FAIL","LOAD_DELIVERY_COUNTRIES_SUCCESS","LoadDeliveryCountries","LoadDeliveryCountriesFail","LoadDeliveryCountriesSuccess","FORGOT_PASSWORD_EMAIL_REQUEST","FORGOT_PASSWORD_EMAIL_REQUEST_SUCCESS","FORGOT_PASSWORD_EMAIL_REQUEST_FAIL","ForgotPasswordEmailRequest","ForgotPasswordEmailRequestFail","ForgotPasswordEmailRequestSuccess","LOAD_NOTIFICATION_PREFERENCES","LOAD_NOTIFICATION_PREFERENCES_FAIL","LOAD_NOTIFICATION_PREFERENCES_SUCCESS","UPDATE_NOTIFICATION_PREFERENCES","UPDATE_NOTIFICATION_PREFERENCES_FAIL","UPDATE_NOTIFICATION_PREFERENCES_SUCCESS","RESET_NOTIFICATION_PREFERENCES","CLEAR_NOTIFICATION_PREFERENCES","LoadNotificationPreferences","LoadNotificationPreferencesFail","LoadNotificationPreferencesSuccess","UpdateNotificationPreferences","UpdateNotificationPreferencesFail","UpdateNotificationPreferencesSuccess","ResetNotificationPreferences","ClearNotificationPreferences","LOAD_ORDER_DETAILS","LOAD_ORDER_DETAILS_FAIL","LOAD_ORDER_DETAILS_SUCCESS","CLEAR_ORDER_DETAILS","CANCEL_ORDER","CANCEL_ORDER_FAIL","CANCEL_ORDER_SUCCESS","RESET_CANCEL_ORDER_PROCESS","LoadOrderDetails","LoadOrderDetailsFail","LoadOrderDetailsSuccess","ClearOrderDetails","CancelOrder","CancelOrderFail","CancelOrderSuccess","ResetCancelOrderProcess","CREATE_ORDER_RETURN_REQUEST","CREATE_ORDER_RETURN_REQUEST_FAIL","CREATE_ORDER_RETURN_REQUEST_SUCCESS","LOAD_ORDER_RETURN_REQUEST","LOAD_ORDER_RETURN_REQUEST_FAIL","LOAD_ORDER_RETURN_REQUEST_SUCCESS","CANCEL_ORDER_RETURN_REQUEST","CANCEL_ORDER_RETURN_REQUEST_FAIL","CANCEL_ORDER_RETURN_REQUEST_SUCCESS","LOAD_ORDER_RETURN_REQUEST_LIST","LOAD_ORDER_RETURN_REQUEST_LIST_FAIL","LOAD_ORDER_RETURN_REQUEST_LIST_SUCCESS","CLEAR_ORDER_RETURN_REQUEST","CLEAR_ORDER_RETURN_REQUEST_LIST","RESET_CANCEL_RETURN_PROCESS","CreateOrderReturnRequest","CreateOrderReturnRequestFail","CreateOrderReturnRequestSuccess","LoadOrderReturnRequest","LoadOrderReturnRequestFail","LoadOrderReturnRequestSuccess","CancelOrderReturnRequest","CancelOrderReturnRequestFail","CancelOrderReturnRequestSuccess","LoadOrderReturnRequestList","LoadOrderReturnRequestListFail","LoadOrderReturnRequestListSuccess","ClearOrderReturnRequest","ClearOrderReturnRequestList","ResetCancelReturnProcess","LOAD_USER_PAYMENT_METHODS","LOAD_USER_PAYMENT_METHODS_FAIL","LOAD_USER_PAYMENT_METHODS_SUCCESS","SET_DEFAULT_USER_PAYMENT_METHOD","SET_DEFAULT_USER_PAYMENT_METHOD_FAIL","SET_DEFAULT_USER_PAYMENT_METHOD_SUCCESS","DELETE_USER_PAYMENT_METHOD","DELETE_USER_PAYMENT_METHOD_FAIL","DELETE_USER_PAYMENT_METHOD_SUCCESS","LoadUserPaymentMethods","LoadUserPaymentMethodsFail","LoadUserPaymentMethodsSuccess","SetDefaultUserPaymentMethod","SetDefaultUserPaymentMethodFail","SetDefaultUserPaymentMethodSuccess","DeleteUserPaymentMethod","DeleteUserPaymentMethodFail","DeleteUserPaymentMethodSuccess","LOAD_PRODUCT_INTERESTS","LOAD_PRODUCT_INTERESTS_FAIL","LOAD_PRODUCT_INTERESTS_SUCCESS","REMOVE_PRODUCT_INTEREST","REMOVE_PRODUCT_INTEREST_SUCCESS","REMOVE_PRODUCT_INTEREST_FAIL","ADD_PRODUCT_INTEREST","ADD_PRODUCT_INTEREST_FAIL","ADD_PRODUCT_INTEREST_SUCCESS","ADD_PRODUCT_INTEREST_RESET","REMOVE_PRODUCT_INTEREST_RESET","CLEAR_PRODUCT_INTERESTS","LoadProductInterests","LoadProductInterestsFail","LoadProductInterestsSuccess","RemoveProductInterest","RemoveProductInterestSuccess","RemoveProductInterestFail","AddProductInterest","AddProductInterestSuccess","AddProductInterestFail","ResetAddInterestState","ResetRemoveInterestState","ClearProductInterests","LOAD_REGIONS","LOAD_REGIONS_SUCCESS","LOAD_REGIONS_FAIL","CLEAR_REGIONS","LoadRegions","LoadRegionsFail","LoadRegionsSuccess","ClearRegions","LOAD_REPLENISHMENT_ORDER_DETAILS","LOAD_REPLENISHMENT_ORDER_DETAILS_SUCCESS","LOAD_REPLENISHMENT_ORDER_DETAILS_FAIL","ClEAR_REPLENISHMENT_ORDER_DETAILS","CANCEL_REPLENISHMENT_ORDER","CANCEL_REPLENISHMENT_ORDER_SUCCESS","CANCEL_REPLENISHMENT_ORDER_FAIL","CLEAR_CANCEL_REPLENISHMENT_ORDER","LoadReplenishmentOrderDetails","LoadReplenishmentOrderDetailsSuccess","LoadReplenishmentOrderDetailsFail","ClearReplenishmentOrderDetails","CancelReplenishmentOrder","CancelReplenishmentOrderSuccess","CancelReplenishmentOrderFail","ClearCancelReplenishmentOrder","RESET_PASSWORD","RESET_PASSWORD_SUCCESS","RESET_PASSWORD_FAIL","ResetPassword","ResetPasswordFail","ResetPasswordSuccess","LOAD_TITLES","LOAD_TITLES_FAIL","LOAD_TITLES_SUCCESS","LoadTitles","LoadTitlesFail","LoadTitlesSuccess","UPDATE_EMAIL","UPDATE_EMAIL_ERROR","UPDATE_EMAIL_SUCCESS","RESET_EMAIL","UpdateEmailAction","UpdateEmailSuccessAction","newUid","UpdateEmailErrorAction","ResetUpdateEmailAction","UPDATE_PASSWORD","UPDATE_PASSWORD_FAIL","UPDATE_PASSWORD_SUCCESS","UPDATE_PASSWORD_RESET","UpdatePassword","UpdatePasswordFail","UpdatePasswordSuccess","UpdatePasswordReset","LOAD_USER_ADDRESSES","LOAD_USER_ADDRESSES_FAIL","LOAD_USER_ADDRESSES_SUCCESS","ADD_USER_ADDRESS","ADD_USER_ADDRESS_FAIL","ADD_USER_ADDRESS_SUCCESS","UPDATE_USER_ADDRESS","UPDATE_USER_ADDRESS_FAIL","UPDATE_USER_ADDRESS_SUCCESS","DELETE_USER_ADDRESS","DELETE_USER_ADDRESS_FAIL","DELETE_USER_ADDRESS_SUCCESS","LoadUserAddresses","LoadUserAddressesFail","LoadUserAddressesSuccess","AddUserAddress","AddUserAddressFail","AddUserAddressSuccess","UpdateUserAddress","UpdateUserAddressFail","UpdateUserAddressSuccess","DeleteUserAddress","DeleteUserAddressFail","DeleteUserAddressSuccess","LOAD_USER_CONSENTS","LOAD_USER_CONSENTS_SUCCESS","LOAD_USER_CONSENTS_FAIL","RESET_LOAD_USER_CONSENTS","GIVE_USER_CONSENT","GIVE_USER_CONSENT_FAIL","GIVE_USER_CONSENT_SUCCESS","RESET_GIVE_USER_CONSENT_PROCESS","TRANSFER_ANONYMOUS_CONSENT","WITHDRAW_USER_CONSENT","WITHDRAW_USER_CONSENT_FAIL","WITHDRAW_USER_CONSENT_SUCCESS","RESET_WITHDRAW_USER_CONSENT_PROCESS","LoadUserConsents","LoadUserConsentsFail","LoadUserConsentsSuccess","ResetLoadUserConsents","GiveUserConsent","GiveUserConsentFail","GiveUserConsentSuccess","consentTemplate","ResetGiveUserConsentProcess","TransferAnonymousConsent","WithdrawUserConsent","WithdrawUserConsentFail","WithdrawUserConsentSuccess","ResetWithdrawUserConsentProcess","LOAD_ACTIVE_COST_CENTERS","LOAD_ACTIVE_COST_CENTERS_FAIL","LOAD_ACTIVE_COST_CENTERS_SUCCESS","LoadActiveCostCenters","LoadActiveCostCentersFail","LoadActiveCostCentersSuccess","LOAD_USER_DETAILS","LOAD_USER_DETAILS_FAIL","LOAD_USER_DETAILS_SUCCESS","UPDATE_USER_DETAILS","UPDATE_USER_DETAILS_FAIL","UPDATE_USER_DETAILS_SUCCESS","RESET_USER_DETAILS","LoadUserDetails","LoadUserDetailsFail","LoadUserDetailsSuccess","UpdateUserDetails","UpdateUserDetailsFail","UpdateUserDetailsSuccess","userUpdates","ResetUpdateUserDetails","CLEAR_USER_MISCS_DATA","ClearUserMiscsData","LOAD_USER_ORDERS","LOAD_USER_ORDERS_FAIL","LOAD_USER_ORDERS_SUCCESS","CLEAR_USER_ORDERS","LoadUserOrders","LoadUserOrdersFail","LoadUserOrdersSuccess","ClearUserOrders","REGISTER_USER","REGISTER_USER_FAIL","REGISTER_USER_SUCCESS","RESET_REGISTER_USER_PROCESS","REGISTER_GUEST","REGISTER_GUEST_FAIL","REGISTER_GUEST_SUCCESS","REMOVE_USER","REMOVE_USER_FAIL","REMOVE_USER_SUCCESS","REMOVE_USER_RESET","RegisterUser","RegisterUserFail","RegisterUserSuccess","ResetRegisterUserProcess","RegisterGuest","RegisterGuestFail","RegisterGuestSuccess","RemoveUser","RemoveUserFail","RemoveUserSuccess","RemoveUserReset","LOAD_USER_REPLENISHMENT_ORDERS","LOAD_USER_REPLENISHMENT_ORDERS_FAIL","LOAD_USER_REPLENISHMENT_ORDERS_SUCCESS","CLEAR_USER_REPLENISHMENT_ORDERS","LoadUserReplenishmentOrders","LoadUserReplenishmentOrdersFail","LoadUserReplenishmentOrdersSuccess","ClearUserReplenishmentOrders","withdrawOn","notifier","switchMapTo","checkoutDeliveryConnector","checkoutCostCenterConnector","checkoutConnector","contextChange$","SiteContextActions.CURRENCY_CHANGE","addDeliveryAddress$","CheckoutActions.ADD_DELIVERY_ADDRESS","titleCode","CheckoutActions.SetDeliveryAddress","UserActions.LoadUserAddresses","CheckoutActions.AddDeliveryAddressFail","setDeliveryAddress$","CheckoutActions.SET_DELIVERY_ADDRESS","CheckoutActions.SetDeliveryAddressSuccess","CheckoutActions.ClearCheckoutDeliveryMode","CheckoutActions.ClearSupportedDeliveryModes","CheckoutActions.ResetLoadSupportedDeliveryModesProcess","CheckoutActions.LoadSupportedDeliveryModes","CheckoutActions.SetDeliveryAddressFail","loadSupportedDeliveryModes$","CheckoutActions.LOAD_SUPPORTED_DELIVERY_MODES","CheckoutActions.LoadSupportedDeliveryModesSuccess","CheckoutActions.LoadSupportedDeliveryModesFail","clearCheckoutMiscsDataOnLanguageChange$","CheckoutActions.ResetLoadPaymentTypesProcess","CheckoutActions.CheckoutClearMiscsData","clearDeliveryModesOnCurrencyChange$","clearCheckoutDataOnLogout$","CheckoutActions.ClearCheckoutData","clearCheckoutDataOnLogin$","setDeliveryMode$","CheckoutActions.SET_DELIVERY_MODE","selectedModeId","CheckoutActions.SetDeliveryModeSuccess","CheckoutActions.SetDeliveryModeFail","createPaymentDetails$","CheckoutActions.CREATE_PAYMENT_DETAILS","CheckoutActions.CreatePaymentDetailsSuccess","UserActions.LoadUserPaymentMethods","CheckoutActions.CreatePaymentDetailsFail","setPaymentDetails$","CheckoutActions.SET_PAYMENT_DETAILS","CheckoutActions.SetPaymentDetailsSuccess","CheckoutActions.SetPaymentDetailsFail","placeOrder$","CheckoutActions.PLACE_ORDER","CartActions.RemoveCart","CheckoutActions.PlaceOrderSuccess","CheckoutActions.PlaceOrderFail","loadCheckoutDetails$","CheckoutActions.LOAD_CHECKOUT_DETAILS","CheckoutActions.LoadCheckoutDetailsSuccess","CheckoutActions.LoadCheckoutDetailsFail","reloadDetailsOnMergeCart$","CartActions.MERGE_CART_SUCCESS","CheckoutActions.LoadCheckoutDetails","clearCheckoutDeliveryAddress$","CheckoutActions.CLEAR_CHECKOUT_DELIVERY_ADDRESS","CheckoutActions.ClearCheckoutDeliveryAddressSuccess","CheckoutActions.ClearCheckoutDeliveryAddressFail","clearCheckoutDeliveryMode$","CheckoutActions.CLEAR_CHECKOUT_DELIVERY_MODE","concatMap","CheckoutActions.ClearCheckoutDeliveryModeSuccess","CheckoutActions.ClearCheckoutDeliveryModeFail","setCostCenter$","CheckoutActions.SET_COST_CENTER","_data","CheckoutActions.SetCostCenterSuccess","CheckoutActions.ClearCheckoutDeliveryAddress","CheckoutActions.SetCostCenterFail","paymentTypeConnector","loadPaymentTypes$","CheckoutActions.LOAD_PAYMENT_TYPES","CheckoutActions.LoadPaymentTypesSuccess","CheckoutActions.LoadPaymentTypesFail","setPaymentType$","CheckoutActions.SET_PAYMENT_TYPE","CartActions.LoadCartSuccess","CheckoutActions.SetPaymentTypeSuccess","CheckoutActions.SetPaymentTypeFail","checkoutReplOrderConnector","scheduleReplenishmentOrder$","CheckoutActions.SCHEDULE_REPLENISHMENT_ORDER","CheckoutActions.ScheduleReplenishmentOrderSuccess","CheckoutActions.ScheduleReplenishmentOrderFail","CheckoutEffects","AddressVerificationEffect","CardTypesEffects","PaymentTypesEffects","ReplenishmentOrderEffects","results","initialState$1","CheckoutActions.VERIFY_ADDRESS_SUCCESS","CheckoutActions.VERIFY_ADDRESS_FAIL","CheckoutActions.CLEAR_ADDRESS_VERIFICATION_RESULTS","initialState$2","CheckoutActions.LOAD_CARD_TYPES_SUCCESS","cardTypesEntities","CheckoutActions.CHECKOUT_CLEAR_MISCS_DATA","po","costCenter","deliveryMode","supported","selected","orderDetails","initialState$3","CheckoutActions.SET_PAYMENT_TYPE_SUCCESS","CheckoutActions.SET_COST_CENTER_SUCCESS","CheckoutActions.ADD_DELIVERY_ADDRESS_SUCCESS","CheckoutActions.SET_DELIVERY_ADDRESS_SUCCESS","CheckoutActions.LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS","supportedModes","modes","mode","CheckoutActions.SET_DELIVERY_MODE_SUCCESS","CheckoutActions.CREATE_PAYMENT_DETAILS_SUCCESS","CheckoutActions.SET_PAYMENT_DETAILS_SUCCESS","CheckoutActions.CREATE_PAYMENT_DETAILS_FAIL","CheckoutActions.SCHEDULE_REPLENISHMENT_ORDER_SUCCESS","CheckoutActions.CLEAR_CHECKOUT_DATA","CheckoutActions.CLEAR_CHECKOUT_STEP","CheckoutActions.CLEAR_SUPPORTED_DELIVERY_MODES","CheckoutActions.LOAD_CHECKOUT_DETAILS_SUCCESS","deliveryAddress","paymentInfo","initialState$4","CheckoutActions.SET_ORDER_TYPE","initialState$5","CheckoutActions.LOAD_PAYMENT_TYPES_SUCCESS","paymentTypesEntities","steps","fromCheckout.reducer","fromCardTypes.reducer","addressVerification","fromAddressVerification.reducer","fromPaymentTypes.reducer","orderType","fromOrderTypes.reducer","CheckoutModule","CheckoutStoreModule","CheckoutEventModule","getDeliveryAddressSelector","getDeliveryModeSelector","getPaymentDetailsSelector","getOrderDetailsSelector","getCheckoutState","checkoutState","getCheckoutStepsState","ɵ4$2","getCheckoutSteps","ɵ5","getDeliveryAddress","getDeliveryMode","getSupportedDeliveryModes","ɵ6","getSelectedDeliveryModeCode","ɵ7","getSelectedDeliveryMode","ɵ8","getPaymentDetails","getCheckoutOrderDetails","getCheckoutDetailsLoaded","ɵ9","getPoNumer","ɵ10","getCostCenter","ɵ11","getAddressVerificationResultsState","ɵ0$d","getAddressVerificationResults","getCardTypesState","getCardTypesEntites","entites","getAllCardTypes","ɵ1$8","getSelectedOrderTypeSelector","getOrderTypesState","getSelectedOrderType","getPaymentTypesState","getPaymentTypesEntites","getAllPaymentTypes","getSelectedPaymentType","CheckoutCostCenterService","checkoutStore","CheckoutActions.SetCostCenter","CheckoutSelectors.getCostCenter","CheckoutDeliveryService","CheckoutSelectors.getSupportedDeliveryModes","loadingState","loadSupportedDeliveryModes","CheckoutSelectors.getSelectedDeliveryMode","CheckoutSelectors.getSelectedDeliveryModeCode","CheckoutSelectors.getDeliveryAddress","getSetDeliveryAddressProcess","resetSetDeliveryAddressProcess","CheckoutActions.ResetSetDeliveryAddressProcess","getSetDeliveryModeProcess","resetSetDeliveryModeProcess","CheckoutActions.ResetSetDeliveryModeProcess","resetLoadSupportedDeliveryModesProcess","getLoadSupportedDeliveryModeProcess","clearCheckoutDeliveryModes","CheckoutSelectors.getAddressVerificationResults","createAndSetAddress","userId_1","cartId_1","actionAllowed","occUserId","CheckoutActions.AddDeliveryAddress","userId_2","cartId_2","setDeliveryMode","userId_3","cartId_3","CheckoutActions.SetDeliveryMode","verifyAddress","userId_4","CheckoutActions.VerifyAddress","userId_5","cartId_4","clearAddressVerificationResults","CheckoutActions.ClearAddressVerificationResults","clearCheckoutDeliveryDetails","CheckoutPaymentService","CheckoutSelectors.getAllCardTypes","CheckoutSelectors.getPaymentDetails","getSetPaymentDetailsResultProcess","resetSetPaymentDetailsProcess","CheckoutActions.ResetSetPaymentDetailsProcess","loadSupportedCardTypes","CheckoutActions.LoadCardTypes","createPaymentDetails","CheckoutActions.CreatePaymentDetails","setPaymentDetails","cart_1","activeCart","CheckoutActions.SetPaymentDetails","paymentProcessSuccess","CheckoutActions.PaymentProcessSuccess","CheckoutService","CheckoutActions.PlaceOrder","CheckoutActions.ScheduleReplenishmentOrder","getPlaceOrderLoading","getPlaceOrderSuccess","getPlaceOrderError","clearPlaceOrderState","CheckoutActions.ClearPlaceOrder","clearCheckoutData","clearCheckoutStep","stepNumber","CheckoutActions.ClearCheckoutStep","CheckoutSelectors.getCheckoutDetailsLoaded","getOrderDetails","CheckoutSelectors.getCheckoutOrderDetails","setOrderType","CheckoutActions.SetOrderType","getCurrentOrderType","CheckoutSelectors.getSelectedOrderType","PaymentTypeService","CheckoutSelectors.getAllPaymentTypes","CheckoutActions.LoadPaymentTypes","CheckoutActions.SetPaymentType","CheckoutSelectors.getSelectedPaymentType","isAccountPayment","ACCOUNT_PAYMENT","getPoNumber","CheckoutSelectors.getPoNumer","OccCheckoutReplenishmentOrderAdapter","CARTS_ENDPOINT","OccCheckoutAdapter","subEndpoint","orderEndpoint","CMS_COMPONENT_NORMALIZER","OccCmsComponentAdapter","getComponentEndPoint","findComponentsByIds","fields","requestParams","getContextParams","getPaginationParams","getComponentsEndpoint","categoryCode","CATALOG_PAGE","catalogCode","DeferLoadingStrategy","JSP_INCLUDE_CMS_COMPONENT_TYPE","CMS_FLEX_COMPONENT_TYPE","CmsConfig","OccCmsPageNormalizer","normalizePageData","normalizePageSlotData","normalizePageComponentData","normalizeComponentData","pageId","title","properties","contentSlots","contentSlot","slots","slot","position","components","_h","comp","flexType","e_5","modifiedtime","modifiedTime","CMS_PAGE_NORMALIZER","OccCmsPageAdapter","getPagesRequestParams","getPagesEndpoint","CmsPageAdapter","CmsComponentAdapter","LegacyOccCmsComponentAdapter","idList","OccCostCenterNormalizer","normalizeBoolean","property","OccCostCenterSerializer","activeFlag","COST_CENTER_NORMALIZER","COST_CENTERS_NORMALIZER","COST_CENTER_SERIALIZER","OccCostCenterListNormalizer","costCenters","isFeatureConfig","features","isInLevel","level","levelParts","versionParts","versionNumberPart","Number","levelNumberPart","isFeatureLevel","isFeatureEnabled","featureConfig","FeatureConfigService","isLevel","isEnabled","FeaturesConfig","FeatureLevelDirective","templateRef","viewContainer","hasView","createEmbeddedView","Directive","selector","TemplateRef","ViewContainerRef","Input","FeatureDirective","FeaturesConfigModule","defaultLevel","ConfigurationService","ambientDefaultConfig","ambientConfig","unifiedConfig$","feedUnifiedConfig","configChunks$","defaultConfigChunks$","zip","skip","configChunks","defaultConfigChunks","processConfig","emitUnifiedConfig","newConfig","complete","ConfigModule","_configurationService","withConfig","withConfigFactory","defaultOccCostCentersConfig","getActiveCostCenters","ProductImageNormalizer","images","normalize","source_1","source_1_1","image","isList","imageType","imageContainer","galleryIndex","targetImage","normalizeImageUrl","format","media","ProductReferenceNormalizer","productReferences","references","reference","referenceType","OccProductSearchPageNormalizer","DEFAULT_TOP_VALUES","normalizeFacets","normalizeFacetValues","normalizeUselessFacets","facets","facet","totalResults","visible","facetSource","topValues","facetTarget","getOwnPropertySymbols","propertyIsEnumerable","__rest","topValueCount","OccProductReferencesListNormalizer","ProductNameNormalizer","nameHtml","PRODUCT_REFERENCES_NORMALIZER","OccProductReferencesAdapter","PRODUCT_REVIEW_NORMALIZER","PRODUCT_REVIEW_SERIALIZER","OccProductReviewsAdapter","maxCount","review","URLSearchParams","headline","comment","rating","alias","PRODUCT_SEARCH_PAGE_NORMALIZER","PRODUCT_SUGGESTION_NORMALIZER","DEFAULT_SEARCH_CONFIG","OccProductSearchAdapter","search","getSearchEndpoint","loadSuggestions","term","getSuggestionEndpoint","max","mergeFields","parsedFields","parseFields","stringifyFields","optimizeFields","startIndex","subFields","extractFields","getObjectPart","OccFieldsService","FIELDS_PARAM","getOptimalUrlGroups","models","groupedByUrls","models_1","models_1_1","splitFields","urlPart","scopedData","mergedUrls","getUrlWithFields","lo","urlWithFields","paramsMap","keyValue","nonFields","par","mergedFields","OccRequestsOptimizerService","occFields","scopedDataLoad","scopedDataWithUrls","dataFactory","groupedModelsSet","groupedModels","data$","data$_1","modelData","OccProductAdapter","requestsOptimizer","loadMany","scopedProduct","ProductScope","defaultOccProductConfig","default","attributes","variants","productReviews","productSearch","productSuggestions","loadingScopes","include","LIST","VARIANTS","ProductAdapter","ProductReferencesAdapter","ProductSearchAdapter","ProductReviewsAdapter","LANGUAGE_NORMALIZER","CURRENCY_NORMALIZER","COUNTRY_NORMALIZER","REGION_NORMALIZER","BASE_SITE_NORMALIZER","OccSiteAdapter","loadLanguages","languageList","loadCurrencies","currencyList","loadCountries","countryList","countries","loadRegions","countryIsoCode","isoCode","regionList","regions","loadBaseSite","urlSplits","siteList","baseSites","loadBaseSites","baseSiteList","defaultOccSiteContextConfig","CurrencyService","SiteContextSelectors.getAllCurrencies","SiteContextActions.LoadCurrencies","currenies","SiteContextSelectors.getActiveCurrency","SiteContextActions.SetActiveCurrency","sessionCurrency","LanguageService","SiteContextSelectors.getAllLanguages","SiteContextActions.LoadLanguages","SiteContextSelectors.getActiveLanguage","SiteContextActions.SetActiveLanguage","sessionLanguage","SiteContextInterceptor","languageService","currencyService","activeLang","activeCurr","setParams","lang","curr","SiteAdapter","AnonymousConsentNormalizer","anonymousConsentsService","OccReturnRequestNormalizer","returnEntries","OccUserInterestsNormalizer","ANONYMOUS_CONSENT_NORMALIZER","CONSENT_TEMPLATE_NORMALIZER","OccAnonymousConsentTemplatesAdapter","loadAnonymousConsentTemplates","consentList","consentTemplates","loadAnonymousConsents","head","observe","CUSTOMER_COUPON_SEARCH_RESULT_NORMALIZER","OccCustomerCouponAdapter","getCustomerCoupons","newHttpHeader","turnOffNotification","couponCode","turnOnNotification","claimCustomerCoupon","OccUserAddressAdapter","addressList","addresses","OccUserConsentAdapter","loadConsents","Cache-Control","consentTemplateId","consentTemplateVersion","consentCode","consentId","PRODUCT_INTERESTS_NORMALIZER","OccUserInterestsAdapter","getInterests","notificationType","removeInterest","productInterestEntry","interestType","forkJoin","addInterest","NOTIFICATION_PREFERENCE_SERIALIZER","NOTIFICATION_PREFERENCE_NORMALIZER","UserNotificationPreferenceConnector","preferences","UserNotificationPreferenceAdapter","OccUserNotificationPreferenceAdapter","headers$1","ORDER_HISTORY_NORMALIZER","CONSIGNMENT_TRACKING_NORMALIZER","ORDER_RETURN_REQUEST_NORMALIZER","ORDER_RETURN_REQUEST_INPUT_SERIALIZER","ORDER_RETURNS_NORMALIZER","OccUserOrderAdapter","orderCode","orderId","loadHistory","getConsignmentTracking","consignmentCode","cancel","cancelRequestInput","createReturnRequest","returnRequestInput","loadReturnRequestList","loadReturnRequestDetail","returnRequestCode","cancelReturnRequest","returnRequestModification","OccUserPaymentAdapter","methodList","payments","paymentMethodID","paymentDetailId","setDefault","REPLENISHMENT_ORDER_HISTORY_NORMALIZER","OccUserReplenishmentOrderAdapter","replenishmentOrderCode","loadReplenishmentDetailsHistory","cancelReplenishmentOrder","USER_NORMALIZER","USER_SERIALIZER","USER_SIGN_UP_SERIALIZER","TITLE_NORMALIZER","OccUserAdapter","registerGuest","requestForgotPasswordEmail","userEmailAddress","resetPassword","newPassword","updateEmail","currentPassword","newUserId","updatePassword","oldPassword","loadTitles","titleList","titles","UserReplenishmentOrderConnector","UserReplenishmentOrderAdapter","OccAddressListNormalizer","defaultOccUserConfig","userRegister","userForgotPassword","userResetPassword","userUpdateLoginId","userUpdatePassword","paymentDetailsAll","paymentDetail","orderHistory","orderDetail","anonymousConsentTemplates","consentDetail","addressDetail","consignmentTracking","customerCoupons","claimCoupon","couponNotification","notificationPreference","productInterests","getProductInterests","cancelOrder","returnOrder","orderReturns","orderReturnDetail","cancelReturn","OccUserCostCenterAdapter","loadActiveList","getCostCentersEndpoint","UserAdapter","UserConsentAdapter","AnonymousConsentTemplatesAdapter","UserPaymentAdapter","UserOrderAdapter","CustomerCouponAdapter","UserInterestsAdapter","UserCostCenterAdapter","JavaRegExpConverter","EXTRACT_JAVA_REGEXP_MODIFIERS","toJsRegExp","javaSyntax","modifiers","jsSyntax","SERVER_REQUEST_URL","SERVER_REQUEST_ORIGIN","OccLoadedConfigConverter","javaRegExpConverter","fromOccBaseSites","currentUrl","isCurrentBaseSite","getError","baseStore","stores","getIsoCodes","defaultLanguage","defaultCurrency","urlParameters","getUrlParams","urlEncodingAttributes","toSiteContextConfig","toI18nConfig","i18n","fallbackLang","urlPatterns","javaRegexp","jsRegexp","elements","defaultElement","moveToFirst","array","predicate","OccSitesConfigLoader","baseEndpoint","EXTERNAL_CONFIG_TRANSFER_ID","OccConfigLoaderService","platform","sitesConfigLoader","serverRequestUrl","loadConfig","externalConfig","transfer","getConfigChunks","rehydratedExternalConfig","chunks","shouldReturnI18nChunk","fallbackLangExists","initConfig","configLoader","OccConfigLoaderModule","OCC_BASE_URL_META_TAG_NAME","OCC_BASE_URL_META_TAG_PLACEHOLDER","MEDIA_BASE_URL_META_TAG_NAME","MEDIA_BASE_URL_META_TAG_PLACEHOLDER","occServerConfigFromMetaTagFactory","getMetaTagContent","mediaServerConfigFromMetaTagFactory","metaTag","getTag","content","defaultOccConfig","occConfigValidator","OrderApprovalDecisionValue","Period","CONSENT_STATUS","Type","Fields61","Fields60","Fields59","Fields58","Fields57","Fields56","Fields55","Fields54","Fields53","Fields52","Fields51","Fields50","Fields49","Fields48","Fields47","Fields46","Fields45","Fields44","Fields43","Fields42","Fields41","Fields40","Fields39","Fields38","Fields37","Fields36","Fields35","Fields34","Fields33","Fields32","Fields31","Fields30","Fields29","Fields28","Fields27","Fields26","Fields25","Fields24","Fields23","Fields22","Fields21","Fields20","Fields19","Fields18","Fields17","SortEnum","Fields16","Fields15","Fields14","Fields13","Fields12","Fields11","Fields10","Fields9","Fields8","Fields7","Fields6","Fields5","Fields4","Fields3","Fields2","Fields1","Fields","Occ","WithCredentialsInterceptor","requiresWithCredentials","withCredentials","useWithCredentials","ConfigValidatorToken","provideConfigValidator","configValidator","validateConfig","configValidators","configValidators_1","configValidators_1_1","warning","validate","OccModule","AsmOccModule","CmsOccModule","CartOccModule","CheckoutOccModule","ProductOccModule","SiteContextOccModule","UserOccModule","CostCenterOccModule","LoadingScopesService","expand","scopesConfig","expandedScopes","includedScopes","includedScopes_1","e_1","includedScopes_1_1","includedScope","getMaxAge","maxAge","AnonymousConsentsConfig","AnonymousConsentsInterceptor","clonedRequest","handleRequest","HttpResponse","handleResponse","newRawConsents","giveRequiredConsents","givenConsents","givenConsents_1","givenConsents_1_1","getUserState","billingCountries","getBillingCountriesState","ɵ0$h","getBillingCountriesEntites","ɵ1$a","getAllBillingCountries","ɵ2$6","getConsignmentTrackingState","tracking","getCustomerCouponsState","getCustomerCouponsLoaded","getCustomerCouponsLoading","ɵ3$5","getDeliveryCountriesState","getDeliveryCountriesEntites","getAllDeliveryCountries","countrySelectorFactory","getPreferencesLoaderState","notificationPreferences","getPreferences","getEnabledPreferences","enabled","getPreferencesLoading","getOrderState","order","getOrderReturnRequestState","orderReturn","getOrderReturnRequest","getOrderReturnRequestLoading","getOrderReturnRequestSuccess","orderReturnList","getOrderReturnRequestListState","ɵ4$3","getOrderReturnRequestList","ɵ5$1","getPaymentMethodsState","getPaymentMethods","getPaymentMethodsLoading","getPaymentMethodsLoadedSuccess","getInterestsState","getInterestsLoading","getRegionsLoaderState","getAllRegions","getRegionsDataAndLoading","getRegionsCountry","getRegionsLoading","getRegionsLoaded","getReplenishmentOrderState","replenishmentOrder","getReplenishmentOrderDetailsValue","getReplenishmentOrderDetailsLoading","getReplenishmentOrderDetailsSuccess","getReplenishmentOrderDetailsError","getResetPassword","getTitlesState","getTitlesEntites","getAllTitles","getAddressesLoaderState","getAddresses","getAddressesLoading","getAddressesLoadedSuccess","getConsentsState","getConsentsValue","getConsentByTemplateId","getConsentsLoading","getConsentsSuccess","getConsentsError","getCostCentersState","getCostCenters","getDetailsState","account","getDetails","getOrdersState","orders","getOrdersLoaded","getOrders","getReplenishmentOrdersState","replenishmentOrders","getReplenishmentOrders","getReplenishmentOrdersLoading","getReplenishmentOrdersError","getReplenishmentOrdersSuccess","UserConsentService","UserActions.LoadUserConsents","UsersSelectors.getConsentsValue","getConsentsResultLoading","getConsentsResultSuccess","UsersSelectors.getConsentsLoading","UsersSelectors.getConsentsSuccess","getConsentsResultError","UsersSelectors.getConsentsError","resetConsentsProcessState","UserActions.ResetLoadUserConsents","UsersSelectors.getConsentByTemplateId","currentConsent","consentGivenDate","consentWithdrawnDate","UserActions.GiveUserConsent","getGiveConsentResultLoading","getGiveConsentResultSuccess","getGiveConsentResultError","resetGiveConsentProcessState","UserActions.ResetGiveUserConsentProcess","UserActions.WithdrawUserConsent","getWithdrawConsentResultLoading","getWithdrawConsentResultSuccess","getWithdrawConsentResultError","resetWithdrawConsentProcessState","UserActions.ResetWithdrawUserConsentProcess","filterConsentTemplates","templateList","hideTemplateIds","updatedTemplateList","templateList_1","templateList_1_1","AnonymousConsentTemplatesConnector","AnonymousConsentsEffects","anonymousConsentTemplatesConnector","anonymousConsentsConfig","anonymousConsentService","userConsentService","checkConsentVersions$","AnonymousConsentsActions.ANONYMOUS_CONSENT_CHECK_UPDATED_VERSIONS","currentConsents","currentConsentVersions","templateVersion","newConsentVersions","detectUpdatedVersion","AnonymousConsentsActions.LoadAnonymousConsentTemplatesFail","loadAnonymousConsentTemplates$","AnonymousConsentsActions.LOAD_ANONYMOUS_CONSENT_TEMPLATES","currentConsentTemplates","newConsentTemplates","AnonymousConsentsActions.LoadAnonymousConsentTemplatesSuccess","transferAnonymousConsentsToUser$","UserActions.REGISTER_USER_SUCCESS","registerAction","actions","consents_1","consents_1_1","templates_1","e_2","templates_1_1","UserActions.TransferAnonymousConsent","giveRequiredConsentsToUser$","templates_2","templates_2_1","currentVersions","newVersions","SiteConnector","getLanguages","getCurrencies","getCountries","getRegions","getBaseSite","getBaseSites","serviceMapFactory","contextServiceMapProvider","ContextServiceMap","baseSiteConfigValidator","defaultSiteContextConfigFactory","SiteContextParamsService","serviceMap","getContextParameters","getUrlEncodingParameters","getParamValues","getParamDefaultValue","getSiteContextService","getValue","setValue","getValues","UrlSplit","SiteContextUrlSerializer","siteContextParams","urlEncodingParameters","hasContextInRoutes","urlWithParams","urlExtractContextParameters","parsed","urlTreeIncludeContextParameters","queryPart","paramId","segmentId","siteContext","urlTreeExtractContextParameters","urlIncludeContextParameters","DefaultUrlSerializer","SiteContextRoutesHandler","serializer","contextValues","routingParams","setContextParamsFromRoute","subscribeChanges","subscribeRouting","replaceState","NavigationStart","NavigationError","NavigationCancel","initializeContext","langService","currService","siteContextRoutesHandler","contextServiceProviders","siteContextParamsProviders","UrlSerializer","siteConnector","loadBaseSite$","SiteContextActions.LOAD_BASE_SITE","SiteContextActions.LoadBaseSiteSuccess","SiteContextActions.LoadBaseSiteFail","loadBaseSites$","SiteContextActions.LOAD_BASE_SITES","SiteContextActions.LoadBaseSitesSuccess","SiteContextActions.LoadBaseSitesFail","loadCurrencies$","SiteContextActions.LOAD_CURRENCIES","SiteContextActions.LoadCurrenciesSuccess","SiteContextActions.LoadCurrenciesFail","persist$","SiteContextActions.SET_ACTIVE_CURRENCY","NEVER","activateCurrency$","bufferCount","SiteContextActions.CurrencyChange","loadLanguages$","SiteContextActions.LOAD_LANGUAGES","SiteContextActions.LoadLanguagesSuccess","SiteContextActions.LoadLanguagesFail","SiteContextActions.SET_ACTIVE_LANGUAGE","activateLanguage$","SiteContextActions.LanguageChange","LanguagesEffects","CurrenciesEffects","BaseSiteEffects","initialState$6","SiteContextActions.LOAD_BASE_SITE_SUCCESS","SiteContextActions.SET_ACTIVE_BASE_SITE","SiteContextActions.LOAD_BASE_SITES_SUCCESS","siteEntities","initialState$7","SiteContextActions.LOAD_CURRENCIES_SUCCESS","currEntities","currency","initialState$8","SiteContextActions.LOAD_LANGUAGES_SUCCESS","langEntities","language","fromLanguages.reducer","fromCurrencies.reducer","fromBaseSite.reducer","siteContextStoreConfigFactory","SiteContextModule","SiteContextStoreModule","AnonymousConsentsActions.TOGGLE_ANONYMOUS_CONSENTS_BANNER_DISMISSED","AnonymousConsentsActions.TOGGLE_ANONYMOUS_CONSENT_TEMPLATES_UPDATED","toggleConsentStatus","initialState$b","AnonymousConsentsActions.GIVE_ANONYMOUS_CONSENT","AnonymousConsentsActions.WITHDRAW_ANONYMOUS_CONSENT","AnonymousConsentsActions.SET_ANONYMOUS_CONSENTS","fromAnonymousConsents.reducer","combineReducers","fromAnonymousConsentsBanner.reducer","fromAnonymousConsentsUpdate.reducer","clearAnonymousConsentTemplates","metaReducers","AnonymousConsentsStatePersistenceService","anonymousConsentsStatePersistenceFactory","anonymousConsentsStatePersistenceService","AnonymousConsentsModule","AnonymousConsentsStoreModule","TokenTarget","defaultAsmConfig","asm","agentSessionTimer","startingDelayInSeconds","maxResults","UserService","UsersSelectors.getDetails","UserActions.LoadUserDetails","userRegisterFormData","UserActions.RegisterUser","UserActions.RegisterGuest","getRegisterUserResultLoading","getRegisterUserResultSuccess","getRegisterUserResultError","resetRegisterUserProcessState","UserActions.ResetRegisterUserProcess","UserActions.RemoveUser","getRemoveUserResultLoading","getRemoveUserResultError","getRemoveUserResultSuccess","resetRemoveUserProcessState","UserActions.RemoveUserReset","getTitles","UsersSelectors.getAllTitles","UserActions.LoadTitles","isPasswordReset","UsersSelectors.getResetPassword","updatePersonalDetails","userDetails","UserActions.UpdateUserDetails","username","getUpdatePersonalDetailsResultLoading","getUpdatePersonalDetailsResultError","getUpdatePersonalDetailsResultSuccess","resetUpdatePersonalDetailsProcessingState","UserActions.ResetUpdateUserDetails","UserActions.ResetPassword","UserActions.ForgotPasswordEmailRequest","UserActions.UpdateEmailAction","getUpdateEmailResultSuccess","getUpdateEmailResultError","getUpdateEmailResultLoading","resetUpdateEmailResultState","UserActions.ResetUpdateEmailAction","UserActions.UpdatePassword","getUpdatePasswordResultLoading","getUpdatePasswordResultError","getUpdatePasswordResultSuccess","resetUpdatePasswordProcessState","UserActions.UpdatePasswordReset","AsmAuthStorageService","_tokenTarget$","User","getTokenTarget","setTokenTarget","tokenTarget","getEmulatedUserToken","emulatedUserToken","setEmulatedUserToken","switchTokenTargetToCSAgent","CSAgent","switchTokenTargetToUser","clearEmulatedUserToken","ASM_UI_UPDATE","AsmUiUpdate","ASM_FEATURE","CUSTOMER_SEARCH_DATA","CUSTOMER_SEARCH","CUSTOMER_SEARCH_FAIL","CUSTOMER_SEARCH_SUCCESS","CUSTOMER_SEARCH_RESET","CustomerSearch","CustomerSearchFail","CustomerSearchSuccess","CustomerSearchReset","LOGOUT_CUSTOMER_SUPPORT_AGENT","LogoutCustomerSupportAgent","CsAgentAuthService","userService","authorizeCustomerSupportAgent","customerId_1","startCustomerEmulationSession","isCustomerSupportAgentLoggedIn","isCustomerEmulated","getCustomerSupportAgentTokenLoading","logoutCustomerSupportAgent","emulatedToken","emulated","AsmActions.LogoutCustomerSupportAgent","AsmAuthHttpHeaderService","csAgentAuthService","isCSAgentTokenRequest","isCSAgentRequest","req","isRequestWithCSAgentToken","csAgentLoggedIn","HttpResponseStatus","HttpErrorHandler","errorResponse","responseStatus","BadGatewayHandler","BAD_GATEWAY","handleError","BadRequestHandler","BAD_REQUEST","handleBadPassword","handleBadLoginResponse","handleBadCartRequest","handleValidationError","handleVoucherOperationError","errorMessage","MSG_TYPE_CONFIRMATION","_request","getErrors","ConflictHandler","CONFLICT","ForbiddenHandler","FORBIDDEN","GatewayTimeoutHandler","GATEWAY_TIMEOUT","InternalServerErrorHandler","INTERNAL_SERVER_ERROR","NotFoundHandler","NOT_FOUND","UnknownErrorHandler","UNKNOWN","_errorResponse","resolveApplicable","applicables","matchParams","priorityParams","matchedApplicables","applicable","lastPriority","Infinity","currPriority","HttpErrorInterceptor","handlers","handleErrorResponse","handler","getResponseHandler","errorHandlers","httpErrorInterceptors","initialState$c","GlobalMessageActions.ADD_MESSAGE","currentMessages","GlobalMessageActions.REMOVE_MESSAGE","msgType","msgIndex","messages","GlobalMessageActions.REMOVE_MESSAGES_BY_TYPE","fromGlobalMessage.reducer","deepEqualObjects","objA","objB","indexOfFirstOccurrence","obj","arr","removeDuplicated$","GlobalMessageSelectors.getGlobalMessageEntitiesByType","hideAfterDelay$","globalMessages","GlobalMessageSelectors.getGlobalMessageCountByType","delay","defaultGlobalMessageConfigFactory","MSG_TYPE_INFO","MSG_TYPE_WARNING","GlobalMessageConfig","GlobalMessageModule","GlobalMessageStoreModule","GlobalMessageEffect","AsmAuthService","_super_1","canUserLogin","tokTarget","warnAboutLoggedCSAgent","AsmConnector","asmAdapter","asmConnector","customerSearch$","AsmActions.CUSTOMER_SEARCH","customerSearchResults","AsmActions.CustomerSearchSuccess","AsmActions.CustomerSearchFail","CustomerEffects","collapsed","initialState$d","AsmActions.ASM_UI_UPDATE","customerSearchResult","asmUi","fromAsmUiReducer.reducer","clearCustomerSupportAgentAsmState","AsmActions.LOGOUT_CUSTOMER_SUPPORT_AGENT","getAsmState","getAsmUi","ɵ0$A","getCustomerSearchResultsLoaderState","getCustomerSearchResults","ɵ1$r","getCustomerSearchResultsLoading","ɵ2$j","AsmStatePersistenceService","AsmSelectors.getAsmUi","AsmActions.AsmUiUpdate","asmStatePersistenceFactory","asmStatePersistenceService","metaReducers$1","AsmModule","AsmStoreModule","AsmService","AsmActions.CustomerSearch","customerSearchReset","AsmActions.CustomerSearchReset","AsmSelectors.getCustomerSearchResults","AsmSelectors.getCustomerSearchResultsLoading","updateAsmUiState","getAsmUiState","CartEntryConnector","cartEntryConnector","addEntry$","CartActions.CART_ADD_ENTRY","cartModification","CartActions.CartAddEntrySuccess","CartActions.CartAddEntryFail","removeEntry$","CartActions.CART_REMOVE_ENTRY","CartActions.CartRemoveEntrySuccess","CartActions.CartRemoveEntryFail","updateEntry$","CartActions.CART_UPDATE_ENTRY","CartActions.CartUpdateEntrySuccess","CartActions.CartUpdateEntryFail","CartVoucherConnector","CartVoucherEffects","cartVoucherConnector","messageService","addCartVoucher$","CartActions.CART_ADD_VOUCHER","showGlobalMessage","CartActions.CartAddVoucherSuccess","CartActions.CartAddVoucherFail","CartActions.CartProcessesDecrement","removeCartVoucher$","CartActions.CART_REMOVE_VOUCHER","CartActions.CartRemoveVoucherSuccess","CartActions.CartRemoveVoucherFail","messageType","voucherCode","CartConnector","cartConnector","loadCart$","CartActions.LOAD_CART","groupBy","group$","CartActions.LoadCartFail","err","createCart$","CartActions.CREATE_CART","conditionalActions","CartActions.MergeCartSuccess","CartActions.CreateCartSuccess","CartActions.SetTempCart","CartActions.CreateCartFail","mergeCart$","CartActions.MERGE_CART","currentCart","refresh$","CartActions.CART_ADD_VOUCHER_SUCCESS","refreshWithoutProcesses$","CartActions.CART_ADD_ENTRY_SUCCESS","CartActions.CART_REMOVE_ENTRY_SUCCESS","CartActions.CART_UPDATE_ENTRY_SUCCESS","CartActions.CART_REMOVE_VOUCHER_SUCCESS","CheckoutActions.CLEAR_CHECKOUT_DELIVERY_MODE_SUCCESS","resetCartDetailsOnSiteContextChange$","CartActions.ResetCartDetails","addEmail$","CartActions.ADD_EMAIL_TO_CART","CartActions.AddEmailToCartSuccess","CartActions.AddEmailToCartFail","deleteCart$","CartActions.DELETE_CART","CartActions.DeleteCartSuccess","CartActions.DeleteCartFail","SaveCartConnector","saveCartConnector","createWishList$","CartActions.CREATE_WISH_LIST","description","saveCartResult","CartActions.CreateWishListSuccess","savedCartData","CartActions.CreateWishListFail","loadWishList$","CartActions.LOAD_WISH_LIST","CartActions.LoadWishListSuccess","CartActions.CreateWishList","CartActions.LoadWishListFail","resetWishList$","MultiCartSelectors.getWishListId","wishListId","activeCartReducer","CartActions.LOAD_CART_SUCCESS","CartActions.CREATE_CART_SUCCESS","CartActions.SET_ACTIVE_CART_ID","CartActions.REMOVE_CART","CartActions.DELETE_CART_SUCCESS","CartActions.CLEAR_CART_STATE","cartEntitiesReducer","CartActions.CREATE_WISH_LIST_SUCCESS","CartActions.LOAD_WISH_LIST_SUCCESS","CartActions.SET_TEMP_CART","wishListReducer","clearMultiCartState","multiCartMetaReducers","multiCartReducerToken","getMultiCartReducers","multiCartReducerProvider","MultiCartStatePersistenceService","siteContextParamsService","getCartState","MultiCartSelectors.getMultiCartState","distinctUntilKeyChanged","CartActions.ClearCartState","CartActions.SetActiveCartId","cartStatePersistenceFactory","cartStatePersistenceService","uninitializeActiveCartMetaReducerFactory","CartPersistenceModule","CartEventBuilder","registerAddEntry","registerRemoveEntry","registerUpdateEntry","registerMapped","CartAddEntryEvent","CartAddEntrySuccessEvent","CartActions.CART_ADD_ENTRY_FAIL","CartAddEntryFailEvent","CartRemoveEntrySuccessEvent","CartUpdateEntrySuccessEvent","eventStream$","getAction","actionType","_CartEventBuilder","CMS_FEATURE","NAVIGATION_DETAIL_ENTITY","COMPONENT_ENTITY","LOAD_CMS_COMPONENT","LOAD_CMS_COMPONENT_FAIL","LOAD_CMS_COMPONENT_SUCCESS","CMS_GET_COMPONENT_FROM_PAGE","LoadCmsComponent","LoadCmsComponentFail","LoadCmsComponentSuccess","CmsGetComponentFromPage","cmp","LOAD_CMS_NAVIGATION_ITEMS","LOAD_CMS_NAVIGATION_ITEMS_FAIL","LOAD_CMS_NAVIGATION_ITEMS_SUCCESS","LoadCmsNavigationItems","nodeId","LoadCmsNavigationItemsFail","LoadCmsNavigationItemsSuccess","LOAD_CMS_PAGE_DATA","LOAD_CMS_PAGE_DATA_FAIL","LOAD_CMS_PAGE_DATA_SUCCESS","CMS_SET_PAGE_SUCCESS_INDEX","CMS_SET_PAGE_FAIL_INDEX","LoadCmsPageData","LoadCmsPageDataFail","LoadCmsPageDataSuccess","CmsSetPageSuccessIndex","CmsSetPageFailIndex","getCmsState","getComponentsState","ɵ0$C","componentsContextSelectorFactory","componentsState","StateUtils.entitySelector","componentsLoaderStateSelectorFactory","componentsContext","StateUtils.initialLoaderState","componentsContextExistsSelectorFactory","componentsDataSelectorFactory","componentsSelectorFactory","componentState","exists","getNavigationEntryItemState","getSelectedNavigationEntryItemState","nodes","getNavigationEntryItems","itemState","getPageEntitiesSelector","pageData","getIndexByType","category","catalog","getPageComponentTypesSelector","componentTypes","getPageState","ɵ3$d","getPageStateIndex","ɵ4$7","getPageStateIndexEntityLoaderState","getPageStateIndexLoaderState","indexState","getPageStateIndexValue","getPageEntities","getPageData","indexValue","getPageComponentTypes","getCurrentSlotSelectorFactory","serializePageContext","ignoreContentPageId","CmsService","getCurrentPage","CmsSelectors.getPageData","getComponentData","createComponentData","currentContext","loading$","CmsSelectors.componentsLoaderStateSelectorFactory","nextContext","attemptedLoad","couldBeLoadedWithPageData","CmsActions.LoadCmsComponent","component$","CmsSelectors.componentsSelectorFactory","using","getContentSlot","CmsSelectors.getCurrentSlotSelectorFactory","navigationNodeUid","CmsSelectors.getNavigationEntryItems","loadNavigationItems","rootUid","CmsActions.LoadCmsNavigationItems","items","refreshLatestPage","CmsActions.LoadCmsPageData","refreshPageById","refreshComponent","CmsSelectors.getPageComponentTypes","hasPage","forceReload","CmsSelectors.getPageStateIndexLoaderState","shouldReload","getPage","getPageIndex","CmsSelectors.getPageStateIndexValue","setPageFailIndex","CmsActions.CmsSetPageFailIndex","CartPageMetaResolver","cms","cms$","setTempCart$","processesIncrement$","CartActions.CartProcessesIncrement","CartEffects","CartEntryEffects","WishListEffects","MultiCartEffects","CartModule","MultiCartStoreModule","CartEventModule","CartVoucherService","addVoucher","combineUserAndCartId","cartIdentifier","CartActions.CartAddVoucher","removeVoucher","CartActions.CartRemoveVoucher","getAddVoucherResultError","getAddVoucherResultSuccess","getAddVoucherResultLoading","resetAddVoucherProcessingState","CartActions.CartResetAddVoucher","CartConfigService","isSelectiveCartEnabled","selectiveCart","CartConfig","SelectiveCartService","cartConfigService","cartId$","selectiveCart$","getLoaded","loadAttempted","WishListService","createWishList","getWishList","loadWishList","CartActions.LoadWishList","getWishListLoading","stable","defaultCmsModuleConfig","pages","cmsComponents","DefaultRoutePageMetaResolver","resolveBreadcrumbs","pageMetaConfig","breadcrumbConfig","breadcrumb","link","translateBreadcrumbLabel","i18nKey","RoutingPageMetaResolver","routesWithExtras$","parent","resolver","getResolver","getUrlPart","routesWithExtras","includeCurrentRoute","trimCurrentRoute","routeWithExtras","resolveRouteBreadcrumb","breadcrumbArrays","flat","getPageMetaConfig","breadcrumbResolver","cxPageMeta","ContentPageMetaResolver","routingPageMetaResolver","homeBreadcrumb$","breadcrumbs$","defer","breadcrumbs","bufferDebounceTime","time","scheduler","bufferedValues","CmsStructureConfig","CmsStructureConfigService","cmsDataConfig","mergePageStructure","pageStructure","mergePage","mergeSlots","shouldIgnoreBackend","getPageFromConfig","ignoreBackend","getComponentFromConfig","componentId","getComponentById","getComponentsFromConfig","cmsStructure","getComponentsByPosition","componentIds","CmsComponentConnector","cmsStructureConfigService","cmsComponentAdapter","configuredComponent","getList","configuredComponents","missingIds","loadedComponents","ComponentsEffects","cmsComponentConnector","loadComponent$","createEffect","CmsActions.LOAD_CMS_COMPONENT","actionGroup","loadComponentsEffect","componentUids","uidsLeft","components_1","components_1_1","CmsActions.LoadCmsComponentSuccess","CmsActions.LoadCmsComponentFail","NavigationEntryItemEffects","loadNavigationItems$","CmsActions.LOAD_CMS_NAVIGATION_ITEMS","getIdListByItemType","CmsActions.LoadCmsNavigationItemsSuccess","CmsActions.LoadCmsNavigationItemsFail","pageIds","mediaIds","superType","CmsPageConnector","cmsPageAdapter","loadFromConfig","mergeDefaultPageStructure","cmsPageConnector","refreshPage$","loadPageData$","CmsActions.LOAD_CMS_PAGE_DATA","CmsActions.CmsGetComponentFromPage","CmsActions.LoadCmsPageDataSuccess","CmsActions.CmsSetPageSuccessIndex","CmsActions.LoadCmsPageDataFail","PageEffects","componentExistsReducer","CmsActions.LOAD_CMS_COMPONENT_FAIL","CmsActions.CMS_GET_COMPONENT_FROM_PAGE","CmsActions.LOAD_CMS_COMPONENT_SUCCESS","initialState$e","pageContextReducer","CmsActions.LOAD_CMS_NAVIGATION_ITEMS_SUCCESS","newItem","compItems","initialState$g","CmsActions.LOAD_CMS_PAGE_DATA_SUCCESS","initialState$h","CmsActions.LOAD_CMS_PAGE_DATA_FAIL","CmsActions.CMS_SET_PAGE_FAIL_INDEX","CmsActions.CMS_SET_PAGE_SUCCESS_INDEX","fromPageReducer.reducer","fromPageIndexReducer.reducer","fromComponentsReducer.reducer","fromNavigation.reducer","clearCmsState","cmsStoreConfigFactory","metaReducers$2","CmsModule","uniteLatest","subNo","trigger","subscriber","asapScheduler","schedule","audit","CmsStoreModule","CmsPageTitleModule","PageMetaService","resolvers$","resolverMethods","heading","robots","getMeta","getMetaResolver","metaResolver","resolvers","SmartEditService","cmsService","zone","isPreviewPage","_launchedInSmartEdit","getCmsTicket","smartedit","renderComponent","componentType","parentId","reprocessPage","_cmsTicketId","takeWhile","getDefaultPreviewCode","defaultPreviewCategoryCode","defaultPreviewProductCode","addPageContract","cmsPage","_currentPageId","goToPreviewPage","previousContract_1","classList","attr","classes","classItem","run","isLaunchedInSmartEdit","NgZone","DynamicAttributeService","smartEditService","addDynamicAttributes","element","renderer","cmsRenderingContext","componentData","slotData","groupProps","propName","propValue","setAttribute","configInitializerFactory","configInitializer","locationInitializedFactory","ConfigInitializerModule","LOCATION_INITIALIZED","configValidatorFactory","validators","ConfigValidatorModule","TEST_CONFIG_COOKIE_NAME","configFromCookieFactory","cookieName","cookie","parseConfigJSON","exec","TestConfigModule","CxDatePipe","timezone","getLang","getActiveLang","getLocaleId","reportMissingLocaleData","DatePipe","TranslatePipe","cd","translatedValue","lastKey","aKeys","bKeys","aKeysLen","shallowEqualObjects","lastOptions","markForCheck","pure","ChangeDetectorRef","TranslationChunkService","duplicates","KEY_SEPARATOR","chunk","warnDuplicates","getChunkNameForKey","mainKey","dupes","I18nConfig","defaultI18nConfig","debug","i18nextInit","httpClient","serverRequestOrigin","i18nextConfig","ns","fallbackLng","interpolation","escapeValue","i18next","use","i18nextXhrBackend","loadPath","getLoadPath","ajax","i18nextGetHttpClient","resources","chunkName","addResourceBundle","i18nextAddTranslations","changeLanguage","_options","callback","i18nextProviders","ɵ0$F","I18nextTranslationService","translationChunk","NON_BREAKING_SPACE","String","fromCharCode","NAMESPACE_SEPARATOR","whitespaceUntilLoaded","namespacedKey","getNamespacedKey","isInitialized","loadNamespaces","reportMissingKey","getFallbackValue","on","off","loadChunks","chunkNames","I18nModule","mockTranslate","optionsString","optionName","MockTranslatePipe","MockTranslationService","_whitespaceUntilLoaded","_chunks","MockDatePipe","CostCenterModule","defaultPersonalizationConfig","personalization","httpHeaderName","timestamp","slotPosition","PERSONALIZATION_ID_KEY","OccPersonalizationIdInterceptor","requestHeader","personalizationId","receivedId","PersonalizationConfig","PERSONALIZATION_TIME_KEY","OccPersonalizationTimeInterceptor","receivedTimestamp","PersonalizationModule","PersonalizationContextService","getPersonalizationContext","buildPersonalizationContext","script","atob","ProcessModule","ProcessStoreModule","ProductConnector","getMany","ProductReferencesConnector","ProductReviewsConnector","ProductSearchConnector","getSuggestions","EntityScopedLoaderActions","LOAD_PRODUCT_REFERENCES","LOAD_PRODUCT_REFERENCES_FAIL","LOAD_PRODUCT_REFERENCES_SUCCESS","CLEAN_PRODUCT_REFERENCES","LoadProductReferences","LoadProductReferencesFail","LoadProductReferencesSuccess","CleanProductReferences","LOAD_PRODUCT_REVIEWS","LOAD_PRODUCT_REVIEWS_FAIL","LOAD_PRODUCT_REVIEWS_SUCCESS","POST_PRODUCT_REVIEW","POST_PRODUCT_REVIEW_FAIL","POST_PRODUCT_REVIEW_SUCCESS","LoadProductReviews","LoadProductReviewsFail","LoadProductReviewsSuccess","PostProductReview","PostProductReviewFail","PostProductReviewSuccess","SEARCH_PRODUCTS","SEARCH_PRODUCTS_FAIL","SEARCH_PRODUCTS_SUCCESS","GET_PRODUCT_SUGGESTIONS","GET_PRODUCT_SUGGESTIONS_SUCCESS","GET_PRODUCT_SUGGESTIONS_FAIL","CLEAR_PRODUCT_SEARCH_RESULT","SearchProducts","auxiliary","SearchProductsFail","SearchProductsSuccess","GetProductSuggestions","GetProductSuggestionsSuccess","GetProductSuggestionsFail","ClearProductSearchResult","clearPageResults","clearSearchboxResults","PRODUCT_FEATURE","PRODUCT_DETAIL_ENTITY","entityScopedLoadMeta","entityScopedFailMeta","entityScopedSuccessMeta","entityScopedResetMeta","EntityScopedLoadAction","EntityScopedFailAction","EntityScopedSuccessAction","EntityScopedResetAction","LOAD_PRODUCT","LOAD_PRODUCT_FAIL","LOAD_PRODUCT_SUCCESS","LoadProduct","LoadProductFail","LoadProductSuccess","productReferencesConnector","loadProductReferences$","ProductActions.LOAD_PRODUCT_REFERENCES","ProductActions.LoadProductReferencesSuccess","_error","ProductActions.LoadProductReferencesFail","productReviewsConnector","loadProductReviews$","ProductActions.LOAD_PRODUCT_REVIEWS","ProductActions.LoadProductReviewsSuccess","ProductActions.LoadProductReviewsFail","postProductReview","ProductActions.POST_PRODUCT_REVIEW","reviewResponse","ProductActions.PostProductReviewSuccess","ProductActions.PostProductReviewFail","showGlobalMessageOnPostProductReviewSuccess$","ProductActions.POST_PRODUCT_REVIEW_SUCCESS","productSearchConnector","searchProducts$","ProductActions.SEARCH_PRODUCTS","queryText","ProductActions.SearchProductsSuccess","ProductActions.SearchProductsFail","getProductSuggestions$","ProductActions.GET_PRODUCT_SUGGESTIONS","suggestions","ProductActions.GetProductSuggestionsSuccess","ProductActions.GetProductSuggestionsFail","ProductEffects","productConnector","loadProduct$","ProductActions.LOAD_PRODUCT","merge","productLoadEffect","productLoad","ProductActions.LoadProductSuccess","ProductActions.LoadProductFail","ProductsSearchEffects","ProductReviewsEffects","ProductReferencesEffects","initialState$i","ProductActions.LOAD_PRODUCT_REFERENCES_SUCCESS","productReference","ProductActions.CLEAN_PRODUCT_REFERENCES","initialState$j","ProductActions.LOAD_PRODUCT_REVIEWS_SUCCESS","auxResults","initialState$k","ProductActions.SEARCH_PRODUCTS_SUCCESS","ProductActions.GET_PRODUCT_SUGGESTIONS_SUCCESS","ProductActions.CLEAR_PRODUCT_SEARCH_RESULT","initialScopedLoaderState","scopedLoaderReducer","entityScopedLoaderReducer","fromProductsSearch.reducer","reviews","fromProductReviews.reducer","fromProductReferences.reducer","clearProductsState","getProductsState","getProductReferencesState","ɵ0$G","getSelectedProductReferencesFactory","referenceTypeData","getProductReviewsState","getSelectedProductReviewsFactory","reviewData","getProductsSearchState","getSearchResults","getAuxSearchResults","getProductSuggestions","getProductState","getSelectedProductStateFactory","getSelectedProductFactory","productState","getSelectedProductLoadingFactory","getSelectedProductSuccessFactory","getSelectedProductErrorFactory","getAllProductCodes","ɵ1$t","ProductReferenceService","loadProductReferences","ProductActions.LoadProductReferences","getProductReferences","ProductSelectors.getSelectedProductReferencesFactory","cleanReferences","ProductActions.CleanProductReferences","ProductReviewService","getByProductCode","ProductSelectors.getSelectedProductReviewsFactory","ProductActions.LoadProductReviews","ProductActions.PostProductReview","ProductSearchService","ProductActions.SearchProducts","getResults","ProductSelectors.getSearchResults","clearResults","ProductActions.ClearProductSearchResult","ProductLoadingService","initProductScopes","getScopesIndex","getProductForScope","productParts","shouldLoad$","ProductSelectors.getSelectedProductStateFactory","isLoading$","ProductSelectors.getSelectedProductLoadingFactory","productLoadLogic$","getProductReloadTriggers","ProductActions.LoadProduct","productData$","ProductSelectors.getSelectedProductFactory","triggers","loadFinish$","ProductActions.LOAD_PRODUCT_SUCCESS","ProductActions.LOAD_PRODUCT_FAIL","loadStart$","getMaxAgeTrigger","now","timestamp$","age","timestampRefresh$","ProductService","productLoading","isLoading","isSuccess","ProductSelectors.getSelectedProductSuccessFactory","hasError","ProductSelectors.getSelectedProductErrorFactory","reload","SearchboxService","ProductSelectors.getAuxSearchResults","getSuggestionResults","ProductSelectors.getProductSuggestions","searchSuggestions","ProductActions.GetProductSuggestions","CategoryPageMetaResolver","productSearchService","searchPage$","hasProductListComponent","facetValueName","resolveBreadcrumbData","br","facetCode","facetValueCode","CouponSearchPageResolver","total$","homeLabel","couponLabel","total","coupon","couponcode","ActivatedRoute","ProductPageMetaResolver","productService","product$","DETAILS","resolveHeading","resolveFirstCategory","resolveManufacturer","resolveDescription","summary","categories","_j","resolveImage","PRIMARY","zoom","firstCategory","manufacturer","FOLLOW","INDEX","SearchPageMetaResolver","query$","q","productStoreConfigFactory","metaReducers$3","pageTitleResolvers","ProductModule","ProductStoreModule","CmsTicketInterceptor","cmsTicketId","SmartEditModule","UserConsentConnector","UserCostCenterConnector","getActiveList","CustomerCouponConnector","UserInterestsConnector","UserOrderConnector","getHistory","getReturnRequestDetail","getReturnRequestList","UserPaymentConnector","UserConnector","ConsentService","checkConsentGivenByTemplateId","isAnonymousConsentType","checkConsentWithdrawnByTemplateId","isConsentType","CustomerCouponService","loadCustomerCoupons","UserActions.LoadCustomerCoupons","UsersSelectors.getCustomerCouponsState","getClaimCustomerCouponResultLoading","customerCouponsState","UsersSelectors.getCustomerCouponsLoaded","UsersSelectors.getCustomerCouponsLoading","subscribeCustomerCoupon","UserActions.SubscribeCustomerCoupon","getSubscribeCustomerCouponResultLoading","getSubscribeCustomerCouponResultSuccess","getSubscribeCustomerCouponResultError","unsubscribeCustomerCoupon","UserActions.UnsubscribeCustomerCoupon","getUnsubscribeCustomerCouponResultLoading","getUnsubscribeCustomerCouponResultSuccess","getUnsubscribeCustomerCouponResultError","UserActions.ClaimCustomerCoupon","getClaimCustomerCouponResultSuccess","OrderReturnRequestService","createOrderReturnRequest","UserActions.CreateOrderReturnRequest","UsersSelectors.getOrderReturnRequest","UsersSelectors.getOrderReturnRequestListState","returnListState","loadOrderReturnRequestList","loadOrderReturnRequestDetail","UserActions.LoadOrderReturnRequest","UserActions.LoadOrderReturnRequestList","clearOrderReturnRequestList","UserActions.ClearOrderReturnRequestList","getReturnRequestLoading","UsersSelectors.getOrderReturnRequestLoading","getReturnRequestSuccess","UsersSelectors.getOrderReturnRequestSuccess","clearOrderReturnRequestDetail","UserActions.ClearOrderReturnRequest","cancelOrderReturnRequest","UserActions.CancelOrderReturnRequest","getCancelReturnRequestLoading","getCancelReturnRequestSuccess","resetCancelReturnRequestProcessState","UserActions.ResetCancelReturnProcess","UserAddressService","loadAddresses","addUserAddress","UserActions.AddUserAddress","setAddressAsDefault","UserActions.UpdateUserAddress","defaultAddress","updateUserAddress","deleteUserAddress","UserActions.DeleteUserAddress","UsersSelectors.getAddresses","UsersSelectors.getAddressesLoading","UsersSelectors.getAddressesLoadedSuccess","loadDeliveryCountries","UserActions.LoadDeliveryCountries","getDeliveryCountries","UsersSelectors.getAllDeliveryCountries","getCountry","UsersSelectors.countrySelectorFactory","UserActions.LoadRegions","clearRegions","UserActions.ClearRegions","UsersSelectors.getRegionsDataAndLoading","UserCostCenterService","loadActiveCostCenters","UserActions.LoadActiveCostCenters","UsersSelectors.getCostCentersState","process","getCostCenterAddresses","cc","unit","UserInterestsService","loadProductInterests","UserActions.LoadProductInterests","UsersSelectors.getInterests","getAndLoadProductInterests","UsersSelectors.getInterestsState","interestListState","getProdutInterestsLoading","UsersSelectors.getInterestsLoading","removeProdutInterest","singleDelete","UserActions.RemoveProductInterest","getRemoveProdutInterestLoading","getRemoveProdutInterestSuccess","addProductInterest","UserActions.AddProductInterest","getAddProductInterestSuccess","getAddProductInterestError","resetAddInterestState","UserActions.ResetAddInterestState","resetRemoveInterestState","UserActions.ResetRemoveInterestState","clearProductInterests","UserActions.ClearProductInterests","UserNotificationPreferenceService","UsersSelectors.getPreferences","UsersSelectors.getEnabledPreferences","loadPreferences","UserActions.LoadNotificationPreferences","clearPreferences","UserActions.ClearNotificationPreferences","UsersSelectors.getPreferencesLoading","updatePreferences","UserActions.UpdateNotificationPreferences","getUpdatePreferencesResultLoading","resetNotificationPreferences","UserActions.ResetNotificationPreferences","UserOrderService","UsersSelectors.getOrderDetails","loadOrderDetails","UserActions.LoadOrderDetails","clearOrderDetails","UserActions.ClearOrderDetails","getOrderHistoryList","UsersSelectors.getOrdersState","orderListState","loadOrderList","getOrderHistoryListLoaded","UsersSelectors.getOrdersLoaded","replenishmentOrderCode_1","UserActions.LoadUserOrders","clearOrderList","UserActions.ClearUserOrders","UsersSelectors.getConsignmentTracking","loadConsignmentTracking","UserActions.LoadConsignmentTracking","clearConsignmentTracking","UserActions.ClearConsignmentTracking","UserActions.CancelOrder","getCancelOrderLoading","getCancelOrderSuccess","resetCancelOrderProcessState","UserActions.ResetCancelOrderProcess","UserPaymentService","loadPaymentMethods","UsersSelectors.getPaymentMethods","UsersSelectors.getPaymentMethodsLoading","UsersSelectors.getPaymentMethodsLoadedSuccess","setPaymentMethodAsDefault","paymentMethodId","UserActions.SetDefaultUserPaymentMethod","deletePaymentMethod","UserActions.DeleteUserPaymentMethod","UsersSelectors.getAllBillingCountries","loadBillingCountries","UserActions.LoadBillingCountries","UserReplenishmentOrderService","loadReplenishmentOrderDetails","UserActions.LoadReplenishmentOrderDetails","getReplenishmentOrderDetails","UsersSelectors.getReplenishmentOrderDetailsValue","UsersSelectors.getReplenishmentOrderDetailsLoading","UsersSelectors.getReplenishmentOrderDetailsSuccess","UsersSelectors.getReplenishmentOrderDetailsError","clearReplenishmentOrderDetails","UserActions.ClearReplenishmentOrderDetails","UserActions.CancelReplenishmentOrder","getCancelReplenishmentOrderLoading","getCancelReplenishmentOrderSuccess","getCancelReplenishmentOrderError","clearCancelReplenishmentOrderProcessState","UserActions.ClearCancelReplenishmentOrder","getReplenishmentOrderHistoryList","UsersSelectors.getReplenishmentOrdersState","replenishmentOrderListState","loadReplenishmentOrderList","getReplenishmentOrderHistoryListLoading","UsersSelectors.getReplenishmentOrdersLoading","getReplenishmentOrderHistoryListError","UsersSelectors.getReplenishmentOrdersError","getReplenishmentOrderHistoryListSuccess","UsersSelectors.getReplenishmentOrdersSuccess","UserActions.LoadUserReplenishmentOrders","clearReplenishmentOrderList","UserActions.ClearUserReplenishmentOrders","initialState$l","UserActions.LOAD_BILLING_COUNTRIES_SUCCESS","countryEntities","UserActions.CLEAR_USER_MISCS_DATA","initialState$m","UserActions.LOAD_CONSIGNMENT_TRACKING_SUCCESS","UserActions.CLEAR_CONSIGNMENT_TRACKING","coupons","initialState$n","fromActions.LOAD_CUSTOMER_COUPONS_SUCCESS","fromActions.SUBSCRIBE_CUSTOMER_COUPON_SUCCESS","updatedCustomerCoupon_1","customerCoupons_1","customerCoupon","couponId","fromActions.UNSUBSCRIBE_CUSTOMER_COUPON_SUCCESS","updatedCouponCode_1","customerCoupons_2","notificationOn","initialState$o","UserActions.LOAD_DELIVERY_COUNTRIES_SUCCESS","initialState$p","UserActions.LOAD_NOTIFICATION_PREFERENCES_FAIL","UserActions.LOAD_NOTIFICATION_PREFERENCES_SUCCESS","UserActions.UPDATE_NOTIFICATION_PREFERENCES_SUCCESS","initialState$q","UserActions.LOAD_ORDER_DETAILS_SUCCESS","returnRequests","initialState$r","UserActions.LOAD_ORDER_RETURN_REQUEST_LIST_SUCCESS","initialState$s","UserActions.LOAD_USER_PAYMENT_METHODS_SUCCESS","UserActions.LOAD_USER_PAYMENT_METHODS_FAIL","initialState$t","UserActions.LOAD_PRODUCT_INTERESTS_SUCCESS","UserActions.LOAD_PRODUCT_INTERESTS_FAIL","initialState$u","UserActions.LOAD_REGIONS_SUCCESS","initialState$v","UserActions.LOAD_REPLENISHMENT_ORDER_DETAILS_SUCCESS","UserActions.CANCEL_REPLENISHMENT_ORDER_SUCCESS","UserActions.RESET_PASSWORD_SUCCESS","initialState$x","UserActions.LOAD_TITLES_SUCCESS","titleEntities","initialState$y","UserActions.LOAD_USER_ADDRESSES_FAIL","UserActions.LOAD_USER_ADDRESSES_SUCCESS","initialState$z","UserActions.LOAD_USER_CONSENTS_SUCCESS","UserActions.GIVE_USER_CONSENT_SUCCESS","updatedConsentTemplate_1","initialState$A","UserActions.LOAD_ACTIVE_COST_CENTERS_FAIL","UserActions.LOAD_ACTIVE_COST_CENTERS_SUCCESS","initialState$B","UserActions.LOAD_USER_DETAILS_SUCCESS","UserActions.UPDATE_USER_DETAILS_SUCCESS","updatedDetails","initialState$C","UserActions.LOAD_USER_ORDERS_SUCCESS","UserActions.LOAD_USER_ORDERS_FAIL","initialState$D","UserActions.LOAD_USER_REPLENISHMENT_ORDERS_SUCCESS","cancelledReplenishmentOrder_1","userReplenishmentOrders","fromUserDetailsReducer.reducer","fromAddressesReducer.reducer","fromBillingCountriesReducer.reducer","fromUserConsentsReducer.reducer","fromPaymentReducer.reducer","fromUserOrdersReducer.reducer","fromOrderDetailsReducer.reducer","fromUserReplenishmentOrdersReducer.reducer","fromOrderReturnRequestReducer.reducer","fromDeliveryCountries.reducer","fromTitlesReducer.reducer","fromRegionsReducer.reducer","fromResetPasswordReducer.reducer","fromConsignmentTrackingReducer.reducer","fromCustomerCouponReducer.reducer","fromNotificationPreferenceReducer.reducer","fromInterestsReducer.reducer","fromCostCenterReducer.reducer","fromReplenishmentOrderDetailsReducer.reducer","clearUserState","loadBillingCountries$","UserActions.LOAD_BILLING_COUNTRIES","BILLING","UserActions.LoadBillingCountriesSuccess","UserActions.LoadBillingCountriesFail","clearMiscsData$","UserActions.ClearUserMiscsData","userOrderConnector","loadConsignmentTracking$","UserActions.LOAD_CONSIGNMENT_TRACKING","UserActions.LoadConsignmentTrackingSuccess","UserActions.LoadConsignmentTrackingFail","customerCouponConnector","loadCustomerCoupons$","fromCustomerCouponsAction.LOAD_CUSTOMER_COUPONS","fromCustomerCouponsAction.LoadCustomerCouponsSuccess","fromCustomerCouponsAction.LoadCustomerCouponsFail","subscribeCustomerCoupon$","fromCustomerCouponsAction.SUBSCRIBE_CUSTOMER_COUPON","fromCustomerCouponsAction.SubscribeCustomerCouponSuccess","fromCustomerCouponsAction.SubscribeCustomerCouponFail","unsubscribeCustomerCoupon$","fromCustomerCouponsAction.UNSUBSCRIBE_CUSTOMER_COUPON","fromCustomerCouponsAction.UnsubscribeCustomerCouponSuccess","fromCustomerCouponsAction.UnsubscribeCustomerCouponFail","claimCustomerCoupon$","fromCustomerCouponsAction.CLAIM_CUSTOMER_COUPON","fromCustomerCouponsAction.ClaimCustomerCouponSuccess","fromCustomerCouponsAction.ClaimCustomerCouponFail","loadDeliveryCountries$","UserActions.LOAD_DELIVERY_COUNTRIES","SHIPPING","UserActions.LoadDeliveryCountriesSuccess","UserActions.LoadDeliveryCountriesFail","userAccountConnector","requestForgotPasswordEmail$","UserActions.FORGOT_PASSWORD_EMAIL_REQUEST","UserActions.ForgotPasswordEmailRequestSuccess","UserActions.ForgotPasswordEmailRequestFail","connector","loadPreferences$","UserActions.LOAD_NOTIFICATION_PREFERENCES","UserActions.LoadNotificationPreferencesSuccess","UserActions.LoadNotificationPreferencesFail","updatePreferences$","UserActions.UPDATE_NOTIFICATION_PREFERENCES","UserActions.UpdateNotificationPreferencesSuccess","UserActions.UpdateNotificationPreferencesFail","orderConnector","loadOrderDetails$","UserActions.LOAD_ORDER_DETAILS","UserActions.LoadOrderDetailsSuccess","UserActions.LoadOrderDetailsFail","cancelOrder$","UserActions.CANCEL_ORDER","UserActions.CancelOrderSuccess","UserActions.CancelOrderFail","createReturnRequest$","UserActions.CREATE_ORDER_RETURN_REQUEST","returnRequest","UserActions.CreateOrderReturnRequestSuccess","UserActions.CreateOrderReturnRequestFail","loadReturnRequest$","UserActions.LOAD_ORDER_RETURN_REQUEST","UserActions.LoadOrderReturnRequestSuccess","UserActions.LoadOrderReturnRequestFail","cancelReturnRequest$","UserActions.CANCEL_ORDER_RETURN_REQUEST","UserActions.CancelOrderReturnRequestSuccess","UserActions.CancelOrderReturnRequestFail","loadReturnRequestList$","UserActions.LOAD_ORDER_RETURN_REQUEST_LIST","returnRequestList","UserActions.LoadOrderReturnRequestListSuccess","UserActions.LoadOrderReturnRequestListFail","userPaymentMethodConnector","loadUserPaymentMethods$","UserActions.LOAD_USER_PAYMENT_METHODS","UserActions.LoadUserPaymentMethodsSuccess","UserActions.LoadUserPaymentMethodsFail","setDefaultUserPaymentMethod$","UserActions.SET_DEFAULT_USER_PAYMENT_METHOD","UserActions.SetDefaultUserPaymentMethodSuccess","UserActions.SetDefaultUserPaymentMethodFail","deleteUserPaymentMethod$","UserActions.DELETE_USER_PAYMENT_METHOD","UserActions.DeleteUserPaymentMethodSuccess","UserActions.DeleteUserPaymentMethodFail","userInterestsConnector","loadProductInteres$","UserActions.LOAD_PRODUCT_INTERESTS","interests","UserActions.LoadProductInterestsSuccess","UserActions.LoadProductInterestsFail","removeProductInterest$","UserActions.REMOVE_PRODUCT_INTEREST","UserActions.RemoveProductInterestSuccess","UserActions.RemoveProductInterestFail","addProductInterest$","UserActions.ADD_PRODUCT_INTEREST","UserActions.AddProductInterestSuccess","UserActions.AddProductInterestFail","loadRegions$","UserActions.LOAD_REGIONS","countryCode","UserActions.LoadRegionsSuccess","UserActions.LoadRegionsFail","resetRegions$","UserActions.CLEAR_REGIONS","replenishmentOrderConnector","loadReplenishmentOrderDetails$","UserActions.LOAD_REPLENISHMENT_ORDER_DETAILS","UserActions.LoadReplenishmentOrderDetailsSuccess","UserActions.LoadReplenishmentOrderDetailsFail","cancelReplenishmentOrder$","UserActions.CANCEL_REPLENISHMENT_ORDER","UserActions.CancelReplenishmentOrderSuccess","UserActions.CancelReplenishmentOrderFail","resetPassword$","UserActions.RESET_PASSWORD","UserActions.ResetPasswordSuccess","UserActions.ResetPasswordFail","loadTitles$","UserActions.LOAD_TITLES","UserActions.LoadTitlesSuccess","UserActions.LoadTitlesFail","updateEmail$","UserActions.UPDATE_EMAIL","UserActions.UpdateEmailSuccessAction","UserActions.UpdateEmailErrorAction","updatePassword$","UserActions.UPDATE_PASSWORD","UserActions.UpdatePasswordSuccess","UserActions.UpdatePasswordFail","UserAddressesEffects","userAddressService","loadUserAddresses$","UserActions.LOAD_USER_ADDRESSES","UserActions.LoadUserAddressesSuccess","UserActions.LoadUserAddressesFail","addUserAddress$","UserActions.ADD_USER_ADDRESS","UserActions.AddUserAddressSuccess","UserActions.AddUserAddressFail","updateUserAddress$","UserActions.UPDATE_USER_ADDRESS","UserActions.UpdateUserAddressSuccess","UserActions.UpdateUserAddressFail","deleteUserAddress$","UserActions.DELETE_USER_ADDRESS","UserActions.DeleteUserAddressSuccess","UserActions.DeleteUserAddressFail","showGlobalMessageOnAddSuccess$","UserActions.ADD_USER_ADDRESS_SUCCESS","showGlobalMessageOnUpdateSuccess$","UserActions.UPDATE_USER_ADDRESS_SUCCESS","showGlobalMessageOnDeleteSuccess$","UserActions.DELETE_USER_ADDRESS_SUCCESS","userConsentConnector","resetConsents$","getConsents$","UserActions.LOAD_USER_CONSENTS","UserActions.LoadUserConsentsSuccess","UserActions.LoadUserConsentsFail","giveConsent$","UserActions.GIVE_USER_CONSENT","UserActions.TRANSFER_ANONYMOUS_CONSENT","UserActions.GiveUserConsentSuccess","UserActions.GiveUserConsentFail","withdrawConsent$","UserActions.WITHDRAW_USER_CONSENT","UserActions.WithdrawUserConsentSuccess","UserActions.WithdrawUserConsentFail","userCostCenterConnector","loadActiveCostCenters$","UserActions.LOAD_ACTIVE_COST_CENTERS","UserActions.LoadActiveCostCentersSuccess","UserActions.LoadActiveCostCentersFail","userConnector","loadUserDetails$","UserActions.LOAD_USER_DETAILS","UserActions.LoadUserDetailsSuccess","UserActions.LoadUserDetailsFail","updateUserDetails$","UserActions.UPDATE_USER_DETAILS","UserActions.UpdateUserDetailsSuccess","UserActions.UpdateUserDetailsFail","loadUserOrders$","UserActions.LOAD_USER_ORDERS","UserActions.LoadUserOrdersSuccess","UserActions.LoadUserOrdersFail","resetUserOrders$","registerUser$","UserActions.REGISTER_USER","UserActions.RegisterUserSuccess","UserActions.RegisterUserFail","registerGuest$","UserActions.REGISTER_GUEST","UserActions.RegisterGuestSuccess","UserActions.RegisterGuestFail","removeUser$","UserActions.REMOVE_USER","UserActions.RemoveUserSuccess","UserActions.RemoveUserFail","loadUserReplenishmentOrders$","UserActions.LOAD_USER_REPLENISHMENT_ORDERS","UserActions.LoadUserReplenishmentOrdersSuccess","UserActions.LoadUserReplenishmentOrdersFail","ClearMiscsDataEffect","DeliveryCountriesEffects","RegionsEffects","TitlesEffects","UserDetailsEffects","UserPaymentMethodsEffects","UserRegisterEffects","UserOrdersEffect","OrderDetailsEffect","BillingCountriesEffect","ResetPasswordEffects","ForgotPasswordEffects","UpdateEmailEffects","UpdatePasswordEffects","UserConsentsEffect","ConsignmentTrackingEffects","CustomerCouponEffects","NotificationPreferenceEffects","ProductInterestsEffect","OrderReturnRequestEffect","UserCostCenterEffects","ReplenishmentOrderDetailsEffect","UserReplenishmentOrdersEffect","metaReducers$4","RouterModule","UserModule","UserStoreModule","ExternalJsFileLoader","src","errorCallback","createElement","parseParams","async","addEventListener","appendChild","keysArray","encodeURI","Meta","DAILY","WEEKLY","MONTHLY"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) __createBinding(exports, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","export function isObject(item: any): boolean {\n  return item && typeof item === 'object' && !Array.isArray(item);\n}\n\nexport function deepMerge(target = {}, ...sources: any[]): any {\n  if (!sources.length) {\n    return target;\n  }\n  const source = sources.shift() || {};\n\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (source[key] instanceof Date) {\n        Object.assign(target, { [key]: source[key] });\n      } else if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        deepMerge(target[key], source[key]);\n      } else {\n        Object.assign(target, { [key]: source[key] });\n      }\n    }\n  }\n\n  return deepMerge(target, ...sources);\n}\n","import { inject, InjectFlags, InjectionToken } from '@angular/core';\nimport { deepMerge } from './utils/deep-merge';\n\n/**\n * Global Configuration injection token, can be used to inject configuration to any part of the app\n */\nexport const Config = new InjectionToken('Configuration', {\n  providedIn: 'root',\n  factory: () => deepMerge({}, inject(DefaultConfig), inject(RootConfig)),\n});\n\n/**\n * Default Configuration token, used to build Global Configuration, built from DefaultConfigChunks\n */\nexport const DefaultConfig = new InjectionToken('DefaultConfiguration', {\n  providedIn: 'root',\n  factory: () =>\n    deepMerge({}, ...(inject(DefaultConfigChunk, InjectFlags.Optional) ?? [])),\n});\n\n/**\n * Root Configuration token, used to build Global Configuration, built from ConfigChunks\n */\nexport const RootConfig = new InjectionToken('RootConfiguration', {\n  providedIn: 'root',\n  factory: () =>\n    deepMerge({}, ...(inject(ConfigChunk, InjectFlags.Optional) ?? [])),\n});\n\n/**\n * Config chunk token, can be used to provide configuration chunk and contribute to the global configuration object.\n * Should not be used directly, use `provideConfig` or import `ConfigModule.withConfig` instead.\n */\nexport const ConfigChunk = new InjectionToken<object[]>('ConfigurationChunk');\n/**\n * Config chunk token, can be used to provide configuration chunk and contribute to the default configuration.\n * Should not be used directly, use `provideDefaultConfig` or `provideDefaultConfigFactory` instead.\n *\n * General rule is, that all config provided in libraries should be provided as default config.\n */\nexport const DefaultConfigChunk = new InjectionToken<object[]>(\n  'DefaultConfigurationChunk'\n);\n","import { FactoryProvider, ValueProvider } from '@angular/core';\nimport { ConfigChunk, DefaultConfigChunk } from './config-tokens';\n\n/**\n * Helper function to provide configuration chunk using ConfigChunk token\n *\n * To provide default configuration in libraries provideDefaultConfig should be used instead.\n *\n * @param config Config object to merge with the global configuration\n */\nexport function provideConfig(\n  config: any = {},\n  defaultConfig = false\n): ValueProvider {\n  return {\n    provide: defaultConfig ? DefaultConfigChunk : ConfigChunk,\n    useValue: config,\n    multi: true,\n  };\n}\n\n/**\n * Helper function to provide configuration with factory function, using ConfigChunk token\n *\n * To provide default configuration in libraries provideDefaultConfigFactory should be used instead.\n *\n * @param configFactory Factory Function that will generate config object\n * @param deps Optional dependencies to a factory function\n */\nexport function provideConfigFactory(\n  configFactory: Function,\n  deps?: any[],\n  defaultConfig = false\n): FactoryProvider {\n  return {\n    provide: defaultConfig ? DefaultConfigChunk : ConfigChunk,\n    useFactory: configFactory,\n    multi: true,\n    deps: deps,\n  };\n}\n\n/**\n * Helper function to provide default configuration chunk using DefaultConfigChunk token\n *\n * @param config Config object to merge with the default configuration\n */\nexport function provideDefaultConfig(config: any = {}): ValueProvider {\n  return {\n    provide: DefaultConfigChunk,\n    useValue: config,\n    multi: true,\n  };\n}\n\n/**\n * Helper function to provide default configuration with factory function, using DefaultConfigChunk token\n *\n * @param configFactory Factory Function that will generate config object\n * @param deps Optional dependencies to a factory function\n */\nexport function provideDefaultConfigFactory(\n  configFactory: Function,\n  deps?: any[]\n): FactoryProvider {\n  return {\n    provide: DefaultConfigChunk,\n    useFactory: configFactory,\n    multi: true,\n    deps: deps,\n  };\n}\n","import { AnonymousConsentsConfig } from './anonymous-consents-config';\n\nexport const defaultAnonymousConsentsConfig: AnonymousConsentsConfig = {\n  anonymousConsents: {\n    registerConsent: 'MARKETING_NEWSLETTER',\n    showLegalDescriptionInDialog: true,\n    requiredConsents: [],\n    consentManagementPage: {\n      showAnonymousConsents: true,\n      hideConsents: [],\n    },\n  },\n};\n","export const OCC_USER_ID_CURRENT = 'current';\nexport const OCC_USER_ID_ANONYMOUS = 'anonymous';\nexport const OCC_USER_ID_GUEST = 'guest';\n\nexport const OCC_CART_ID_CURRENT = 'current';\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable } from '@angular/core';\nimport { fromEvent, Observable, of } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, startWith } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class WindowRef {\n  readonly document: Document;\n\n  constructor(@Inject(DOCUMENT) document) {\n    // it's a workaround to have document property properly typed\n    // see: https://github.com/angular/angular/issues/15640\n    this.document = document;\n  }\n\n  get nativeWindow(): Window {\n    return typeof window !== 'undefined' ? window : undefined;\n  }\n\n  get sessionStorage(): Storage {\n    return this.nativeWindow ? this.nativeWindow.sessionStorage : undefined;\n  }\n\n  get localStorage(): Storage {\n    return this.nativeWindow ? this.nativeWindow.localStorage : undefined;\n  }\n\n  /**\n   * Returns an observable for the window resize event and emits an event\n   * every 300ms in case of resizing. An event is simulated initially.\n   *\n   * If there's no window object available (i.e. in SSR), a null value is emitted.\n   */\n  get resize$(): Observable<any> {\n    if (!this.nativeWindow) {\n      return of(null);\n    } else {\n      return fromEvent(this.nativeWindow, 'resize').pipe(\n        debounceTime(300),\n        startWith({ target: this.nativeWindow }),\n        distinctUntilChanged()\n      );\n    }\n  }\n}\n","import { RoutesConfig } from '../routes-config';\nimport { Injectable } from '@angular/core';\nimport { Config } from '../../../config/config-tokens';\n\nexport const enum RouteLoadStrategy {\n  /**\n   * Don't reload the data on navigation if it was loaded before\n   */\n  ONCE = 'once',\n  /**\n   * Always reload the data on navigation\n   */\n  ALWAYS = 'always',\n}\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class RoutingConfig {\n  routing?: {\n    /**\n     * Configuration of semantic routes. Key is route's name. Value is the config specific to this route.\n     */\n    routes?: RoutesConfig;\n\n    /**\n     * When true, it closes the storefront for unauthorized users, except from routes that have individual config flag `protected: false`\n     */\n    protected?: boolean;\n\n    /**\n     * Global load strategy which is used as a fallback for loading data on each navigation\n     */\n    loadStrategy?: RouteLoadStrategy;\n  };\n}\n","import { Injectable, isDevMode } from '@angular/core';\nimport { RouteLoadStrategy, RoutingConfig } from './config/routing-config';\nimport { RouteConfig } from './routes-config';\n\n@Injectable({ providedIn: 'root' })\nexport class RoutingConfigService {\n  /**\n   * Reversed routing config for quick lookup of the route name by the configured path.\n   */\n  protected routeNamesByPath: { [path: string]: string };\n\n  constructor(protected config: RoutingConfig) {}\n\n  /**\n   * Returns the route config for the given route name.\n   */\n  getRouteConfig(routeName: string): RouteConfig {\n    const routeConfig = this.config?.routing?.routes;\n\n    const result = routeConfig && routeConfig[routeName];\n    if (!routeConfig || result === undefined) {\n      this.warn(`No path was configured for the named route '${routeName}'!`);\n    }\n    return result;\n  }\n\n  private warn(...args) {\n    if (isDevMode()) {\n      console.warn(...args);\n    }\n  }\n\n  /**\n   * Returns the configured route loading strategy.\n   */\n  getLoadStrategy(): RouteLoadStrategy {\n    return this.config?.routing?.loadStrategy ?? RouteLoadStrategy.ALWAYS;\n  }\n\n  /**\n   * Returns the route name of the configured path.\n   *\n   * For example, when the config is:\n   * ```\n   * routing: {\n   *   routes: {\n   *      addressBook: { paths: ['my-account/address-book'] }\n   *   }\n   * }\n   * ```\n   *\n   * the `getRouteName('my-account/address-book')` returns `'addressBook'`.\n   */\n  getRouteName(path: string) {\n    if (!this.routeNamesByPath) {\n      this.initRouteNamesByPath();\n    }\n    return this.routeNamesByPath[path];\n  }\n\n  /**\n   * Initializes the property `routeNamesByPath`.\n   *\n   * The original config allows for reading configured path by the route name.\n   * But this method builds up a structure with a 'reversed config'\n   * to read quickly the route name by the path.\n   */\n  protected initRouteNamesByPath() {\n    this.routeNamesByPath = {};\n\n    for (const [routeName, routeConfig] of Object.entries(\n      this.config?.routing?.routes\n    )) {\n      routeConfig?.paths?.forEach((path) => {\n        if (isDevMode() && this.routeNamesByPath[path]) {\n          console.error(\n            `The same path '${path}' is configured for two different route names: '${this.routeNamesByPath[path]}' and '${routeName}`\n          );\n        }\n        this.routeNamesByPath[path] = routeName;\n      });\n    }\n  }\n}\n","export const isParam = (segment: string): boolean => segment.startsWith(':');\n\nexport const getParamName = (segment: string): string => segment.slice(1); // it just removes leading ':'\n\nexport const ensureLeadingSlash = (path: string): string =>\n  path.startsWith('/') ? path : '/' + path;\n\nexport const removeLeadingSlash = (path: string): string =>\n  path.startsWith('/') ? path.slice(1) : path;\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { UrlSegmentGroup, PRIMARY_OUTLET } from '@angular/router';\n\n@Injectable({ providedIn: 'root' })\nexport class UrlParsingService {\n  constructor(private router: Router) {}\n\n  getPrimarySegments(url: string): string[] {\n    const urlTree = this.router.parseUrl(url);\n    return this._getPrimarySegmentsFromUrlTree(urlTree.root);\n  }\n\n  private _getPrimarySegmentsFromUrlTree(tree: UrlSegmentGroup): string[] {\n    const segments = tree.segments.map((s) => s.path);\n    const childrenSegments = tree.children[PRIMARY_OUTLET]\n      ? this._getPrimarySegmentsFromUrlTree(tree.children[PRIMARY_OUTLET])\n      : [];\n    return segments.concat(childrenSegments);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ParamsMapping, RouteConfig } from '../routes-config';\nimport { RoutingConfigService } from '../routing-config.service';\nimport { getParamName, isParam } from './path-utils';\nimport { UrlCommand, UrlCommandRoute, UrlCommands } from './url-command';\nimport { UrlParsingService } from './url-parsing.service';\n\n@Injectable({ providedIn: 'root' })\nexport class SemanticPathService {\n  readonly ROOT_URL = ['/'];\n\n  constructor(\n    protected routingConfigService: RoutingConfigService,\n    protected urlParser: UrlParsingService\n  ) {}\n\n  /**\n   * Returns the first path alias configured for a given route name. It adds `/` at the beginning.\n   */\n  get(routeName: string): string {\n    const routeConfig = this.routingConfigService.getRouteConfig(routeName);\n    return routeConfig && Array.isArray(routeConfig.paths)\n      ? '/' + routeConfig.paths[0]\n      : undefined;\n  }\n\n  /**\n   * Transforms the array of url commands. Each command can be:\n   * a) string - will be left untouched\n   * b) object { cxRoute: <route name> } - will be replaced with semantic path\n   * c) object { cxRoute: <route name>, params: { ... } } - same as above, but with passed params\n   *\n   * If the first command is the object with the `cxRoute` property, returns an absolute url (with the first element of the array `'/'`)\n   */\n  transform(commands: UrlCommands): any[] {\n    if (!Array.isArray(commands)) {\n      commands = [commands];\n    }\n\n    const result: string[] = [];\n    for (const command of commands) {\n      if (!this.isRouteCommand(command)) {\n        // don't modify segment that is not route command:\n        result.push(command);\n      } else {\n        // generate array with url segments for given route command:\n        const partialResult = this.generateUrlPart(command);\n\n        if (partialResult === null) {\n          return this.ROOT_URL;\n        }\n\n        result.push(...partialResult);\n      }\n    }\n\n    if (this.shouldOutputAbsolute(commands)) {\n      result.unshift('/');\n    }\n\n    return result;\n  }\n\n  private isRouteCommand(command: UrlCommand): boolean {\n    return command && Boolean(command.cxRoute);\n  }\n\n  private shouldOutputAbsolute(commands: UrlCommands): boolean {\n    return this.isRouteCommand(commands[0]);\n  }\n\n  private generateUrlPart(command: UrlCommandRoute): string[] | null {\n    this.standarizeRouteCommand(command);\n\n    if (!command.cxRoute) {\n      return null;\n    }\n\n    const routeConfig = this.routingConfigService.getRouteConfig(\n      command.cxRoute\n    );\n\n    // if no route translation was configured, return null:\n    if (!routeConfig || !routeConfig.paths) {\n      return null;\n    }\n\n    // find first path that can satisfy it's parameters with given parameters\n    const path = this.findPathWithFillableParams(routeConfig, command.params);\n\n    // if there is no configured path that can be satisfied with given params, return null\n    if (!path) {\n      return null;\n    }\n\n    const result = this.provideParamsValues(\n      path,\n      command.params,\n      routeConfig.paramsMapping\n    );\n\n    return result;\n  }\n\n  private standarizeRouteCommand(command: UrlCommandRoute): void {\n    command.params = command.params || {};\n  }\n\n  private provideParamsValues(\n    path: string,\n    params: object,\n    paramsMapping: ParamsMapping\n  ): string[] {\n    return this.urlParser.getPrimarySegments(path).map((segment) => {\n      if (isParam(segment)) {\n        const paramName = getParamName(segment);\n        const mappedParamName = this.getMappedParamName(\n          paramName,\n          paramsMapping\n        );\n        return params[mappedParamName];\n      }\n      return segment;\n    });\n  }\n\n  private findPathWithFillableParams(\n    routeConfig: RouteConfig,\n    params: object\n  ): string {\n    const foundPath = routeConfig.paths.find((path) =>\n      this.getParams(path).every((paramName) => {\n        const mappedParamName = this.getMappedParamName(\n          paramName,\n          routeConfig.paramsMapping\n        );\n\n        return params[mappedParamName] !== undefined;\n      })\n    );\n\n    if (foundPath === undefined || foundPath === null) {\n      return null;\n    }\n    return foundPath;\n  }\n\n  private getParams(path: string) {\n    return this.urlParser\n      .getPrimarySegments(path)\n      .filter(isParam)\n      .map(getParamName);\n  }\n\n  private getMappedParamName(paramName: string, paramsMapping: object): string {\n    if (paramsMapping) {\n      return paramsMapping[paramName] || paramName;\n    }\n    return paramName;\n  }\n}\n","import { NavigationExtras } from '@angular/router';\nimport { Action } from '@ngrx/store';\nimport { PageContext } from '../../../routing/models/page-context.model';\n\nexport const ROUTER_GO = '[Router] Go';\nexport const ROUTER_GO_BY_URL = '[Router] Go By Url';\nexport const ROUTER_BACK = '[Router] Back';\nexport const ROUTER_FORWARD = '[Router] Forward';\nexport const CHANGE_NEXT_PAGE_CONTEXT = '[Router] Change Next PageContext';\n\nexport class RouteGoAction implements Action {\n  readonly type = ROUTER_GO;\n  constructor(\n    public payload: {\n      path: string[];\n      query?: object;\n      extras?: NavigationExtras;\n    }\n  ) {}\n}\n\nexport class RouteGoByUrlAction implements Action {\n  readonly type = ROUTER_GO_BY_URL;\n  constructor(public payload: string) {}\n}\n\nexport class RouteBackAction implements Action {\n  readonly type = ROUTER_BACK;\n}\n\nexport class RouteForwardAction implements Action {\n  readonly type = ROUTER_FORWARD;\n}\n\nexport class ChangeNextPageContext implements Action {\n  readonly type = CHANGE_NEXT_PAGE_CONTEXT;\n  constructor(public payload: PageContext) {}\n}\n\nexport type RoutingAction =\n  | RouteGoAction\n  | RouteGoByUrlAction\n  | RouteBackAction\n  | RouteForwardAction\n  | ChangeNextPageContext;\n","import { Params } from '@angular/router';\nimport * as fromNgrxRouter from '@ngrx/router-store';\nimport { PageContext } from '../models/page-context.model';\n\nexport const ROUTING_FEATURE = 'router';\n\nexport interface RouterState\n  extends fromNgrxRouter.RouterReducerState<ActivatedRouterStateSnapshot> {\n  nextState?: ActivatedRouterStateSnapshot;\n}\n\nexport interface ActivatedRouterStateSnapshot {\n  url: string;\n  queryParams: Params;\n  params: Params;\n  context: PageContext;\n  cmsRequired: boolean;\n  semanticRoute?: string;\n}\n\nexport interface State {\n  [ROUTING_FEATURE]: RouterState;\n}\n","import {\n  createFeatureSelector,\n  createSelector,\n  MemoizedSelector,\n} from '@ngrx/store';\nimport { PageContext } from '../../models/page-context.model';\nimport { RouterState, ROUTING_FEATURE, State } from '../routing-state';\n\nexport const getRouterFeatureState: MemoizedSelector<\n  any,\n  State\n> = createFeatureSelector<State>(ROUTING_FEATURE);\n\nexport const getRouterState: MemoizedSelector<\n  any,\n  RouterState\n> = createSelector(getRouterFeatureState, (state) => state.router);\n\nexport const getSemanticRoute: MemoizedSelector<any, string> = createSelector(\n  getRouterState,\n  (routingState: RouterState) =>\n    (routingState.state && routingState.state.semanticRoute) || ''\n);\n\nexport const getPageContext: MemoizedSelector<\n  any,\n  PageContext\n> = createSelector(\n  getRouterState,\n  (routingState: RouterState) =>\n    (routingState.state && routingState.state.context) || { id: '' }\n);\n\nexport const getNextPageContext: MemoizedSelector<\n  any,\n  PageContext\n> = createSelector(\n  getRouterState,\n  (routingState: RouterState) =>\n    routingState.nextState && routingState.nextState.context\n);\n\nexport const isNavigating: MemoizedSelector<any, boolean> = createSelector(\n  getNextPageContext,\n  (context) => !!context\n);\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, NavigationEnd, Router } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { filter, map, shareReplay, startWith } from 'rxjs/operators';\n\n/**\n * Helper service to expose all activated routes\n */\n@Injectable({ providedIn: 'root' })\nexport class ActivatedRoutesService {\n  constructor(protected router: Router) {}\n\n  /**\n   * Array of currently activated routes (from the root route to the leaf route).\n   */\n  readonly routes$: Observable<\n    ActivatedRouteSnapshot[]\n  > = this.router.events.pipe(\n    filter((event) => event instanceof NavigationEnd),\n    // tslint:disable-next-line: deprecation https://github.com/ReactiveX/rxjs/issues/4772\n    startWith(undefined), // emit value for consumer who subscribed lately after NavigationEnd event\n    map(() => {\n      let route = this.router.routerState.snapshot.root;\n      const routes: ActivatedRouteSnapshot[] = [route];\n\n      // traverse to the leaf route:\n      while ((route = route.firstChild)) {\n        routes.push(route);\n      }\n\n      return routes;\n    }),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, Router } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { map, shareReplay } from 'rxjs/operators';\nimport { ActivatedRoutesService } from '../services/activated-routes.service';\n\n/**\n * Service to expose all parameters for the router, including child routes.\n * This is convenient in case the parent route (component) requires awareness\n * of child routes parameters.\n */\n@Injectable({ providedIn: 'root' })\nexport class RoutingParamsService {\n  protected readonly params$: Observable<{\n    [key: string]: string;\n  }> = this.activatedRoutesService.routes$.pipe(\n    map((routes) => this.findAllParam(routes)),\n    shareReplay({ refCount: true, bufferSize: 1 })\n  );\n\n  constructor(\n    protected router: Router,\n    protected activatedRoutesService: ActivatedRoutesService\n  ) {}\n\n  /**\n   * Get the list of all parameters of the full route. This includes\n   * active child routes.\n   */\n  getParams(): Observable<{ [key: string]: string }> {\n    return this.params$;\n  }\n\n  protected findAllParam(\n    routes: ActivatedRouteSnapshot[]\n  ): { [key: string]: string } {\n    return Object.assign({}, ...routes.map((route) => route.params));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { NavigationExtras } from '@angular/router';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { WindowRef } from '../../window/window-ref';\nimport { SemanticPathService } from '../configurable-routes/url-translation/semantic-path.service';\nimport { UrlCommands } from '../configurable-routes/url-translation/url-command';\nimport { PageContext } from '../models/page-context.model';\nimport { RoutingActions } from '../store/actions/index';\nimport { RouterState } from '../store/routing-state';\nimport { RoutingSelector } from '../store/selectors/index';\nimport { RoutingParamsService } from './routing-params.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class RoutingService {\n  constructor(\n    protected store: Store<RouterState>,\n    protected winRef: WindowRef,\n    protected semanticPathService: SemanticPathService,\n    protected routingParamsService: RoutingParamsService\n  ) {}\n\n  /**\n   * Get the list of all parameters of the full route. This includes\n   * active child routes.\n   */\n  getParams(): Observable<{ [key: string]: string }> {\n    return this.routingParamsService?.getParams();\n  }\n\n  /**\n   * Get the current router state\n   */\n  getRouterState(): Observable<RouterState> {\n    return this.store.pipe(select(RoutingSelector.getRouterState));\n  }\n\n  /**\n   * Get the `PageContext` from the state\n   */\n  getPageContext(): Observable<PageContext> {\n    return this.store.pipe(select(RoutingSelector.getPageContext));\n  }\n\n  /**\n   * Get the next `PageContext` from the state\n   */\n  getNextPageContext(): Observable<PageContext> {\n    return this.store.pipe(select(RoutingSelector.getNextPageContext));\n  }\n\n  /**\n   * Allow to change next page context for the ongoing navigation\n   *\n   * @param pageContext\n   */\n  changeNextPageContext(pageContext: PageContext) {\n    this.store.dispatch(new RoutingActions.ChangeNextPageContext(pageContext));\n  }\n\n  /**\n   * Get the `isNavigating` info from the state\n   */\n  isNavigating(): Observable<boolean> {\n    return this.store.pipe(select(RoutingSelector.isNavigating));\n  }\n\n  /**\n   * Navigation with a new state into history\n   * @param commands: url commands\n   * @param query\n   * @param extras: Represents the extra options used during navigation.\n   */\n  go(commands: UrlCommands, query?: object, extras?: NavigationExtras): void {\n    const path = this.semanticPathService.transform(commands);\n\n    return this.navigate(path, query, extras);\n  }\n\n  /**\n   * Navigation using URL\n   * @param url\n   */\n  goByUrl(url: string) {\n    this.store.dispatch(new RoutingActions.RouteGoByUrlAction(url));\n  }\n\n  /**\n   * Navigating back\n   */\n  back(): void {\n    const isLastPageInApp = this.winRef.document.referrer.includes(\n      this.winRef.nativeWindow.location.origin\n    );\n    if (isLastPageInApp) {\n      this.store.dispatch(new RoutingActions.RouteBackAction());\n      return;\n    }\n    this.go(['/']);\n    return;\n  }\n\n  /**\n   * Navigating forward\n   */\n  forward(): void {\n    this.store.dispatch(new RoutingActions.RouteForwardAction());\n  }\n\n  /**\n   * Navigation with a new state into history\n   * @param path\n   * @param query\n   * @param extras: Represents the extra options used during navigation.\n   */\n  protected navigate(\n    path: any[],\n    query?: object,\n    extras?: NavigationExtras\n  ): void {\n    this.store.dispatch(\n      new RoutingActions.RouteGoAction({\n        path,\n        query,\n        extras,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable } from 'rxjs';\n\n/**\n * Service serves storage role for AuthRedirectService.\n * Used by AuthStatePersistenceService to store redirect url for OAuth flows that rely on redirects.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthRedirectStorageService {\n  constructor() {}\n\n  private redirectUrl$: Observable<string> = new BehaviorSubject<string>(\n    undefined\n  );\n\n  /**\n   * Get redirect url after logging in.\n   *\n   * @returns observable with the redirect url as string\n   */\n  getRedirectUrl(): Observable<string> {\n    return this.redirectUrl$;\n  }\n\n  /**\n   * Set url to redirect to after login.\n   *\n   * @param redirectUrl\n   */\n  setRedirectUrl(redirectUrl: string): void {\n    (this.redirectUrl$ as BehaviorSubject<string>).next(redirectUrl);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { take } from 'rxjs/operators';\nimport { RoutingService } from '../../../routing/facade/routing.service';\nimport { AuthRedirectStorageService } from './auth-redirect-storage.service';\n\n/**\n * Responsible for saving last accessed page (or attempted) before login and for redirecting to that page after login.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthRedirectService {\n  /**\n   * This service is responsible for redirecting to the last page before authorization. \"The last page\" can be:\n   * 1. Just the previously opened page; or\n   * 2. The page that we just tried to open, but AuthGuard cancelled it\n   *\n   * For example:\n   * 1. The user opens the product page, then clicks /login link and signs in\n   *    -> Then we should redirect to the product page; or\n   * 2. The user opens the product page, then he clicks /my-account link,\n   *    but is automatically redirected to the login page by the AuthGuard, and he signs in\n   *    -> Then we should redirect to the my-account page, not the product page\n   */\n  constructor(\n    protected routing: RoutingService,\n    protected router: Router,\n    protected authRedirectStorageService: AuthRedirectStorageService\n  ) {}\n\n  private ignoredUrls = new Set<string>();\n  private lastAuthGuardNavigation: {\n    url: string;\n    navigationId: number;\n  };\n\n  /**\n   * Redirect to saved url (homepage if nothing is saved).\n   */\n  redirect() {\n    this.authRedirectStorageService\n      .getRedirectUrl()\n      .pipe(take(1))\n      .subscribe((redirectUrl) => {\n        if (redirectUrl === undefined) {\n          this.routing.go('/');\n        } else {\n          this.routing.goByUrl(redirectUrl);\n        }\n        this.authRedirectStorageService.setRedirectUrl(undefined);\n\n        this.lastAuthGuardNavigation = undefined;\n      });\n  }\n\n  /**\n   * Saves url of a page that user wanted to access, but wasn't yet logged in.\n   */\n  reportAuthGuard() {\n    const { url, navigationId } = this.getCurrentNavigation();\n    this.lastAuthGuardNavigation = { url, navigationId };\n    this.authRedirectStorageService.setRedirectUrl(url);\n  }\n\n  /**\n   * Saves url of a page that was accessed before entering a page only for not auth users.\n   */\n  reportNotAuthGuard() {\n    const { url, initialUrl, navigationId } = this.getCurrentNavigation();\n\n    this.ignoredUrls.add(url);\n\n    // Don't save redirect url if you've already come from page with NotAuthGuard (i.e. user has come from login to register)\n    if (!this.ignoredUrls.has(initialUrl)) {\n      // We compare the navigation id to find out if the url cancelled by AuthGuard (i.e. my-account) is more recent\n      // than the last opened page\n      if (\n        !this.lastAuthGuardNavigation ||\n        this.lastAuthGuardNavigation.navigationId < navigationId - 1\n      ) {\n        this.authRedirectStorageService.setRedirectUrl(initialUrl);\n\n        this.lastAuthGuardNavigation = undefined;\n      }\n    }\n  }\n\n  private getCurrentNavigation(): {\n    navigationId: number;\n    url: string;\n    initialUrl: string;\n  } {\n    const initialUrl = this.router.url;\n    const navigation = this.router.getCurrentNavigation();\n    const url = this.router.serializeUrl(navigation.finalUrl);\n    return {\n      navigationId: navigation.id,\n      url,\n      initialUrl,\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { OAuthStorage } from 'angular-oauth2-oidc';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { AuthToken } from '../models/auth-token.model';\n\n/**\n * Storage service for AuthToken. Used as a storage for angular-oauth2-oidc library.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthStorageService extends OAuthStorage {\n  /**\n   * Extracted keys that are not `JSON.stringify` from reading the angular-oauth2-oidc source code\n   */\n  protected static readonly nonStringifiedOAuthLibKeys = [\n    'PKCE_verifier',\n    'access_token',\n    'refresh_token',\n    'expires_at',\n    'access_token_stored_at',\n    'id_token',\n    'id_token_expires_at',\n    'id_token_stored_at',\n    'session_state',\n    'nonce',\n  ];\n\n  protected _token$: Observable<AuthToken> = new BehaviorSubject<AuthToken>(\n    {} as AuthToken\n  );\n\n  protected decode(key: string, value: any) {\n    if (AuthStorageService.nonStringifiedOAuthLibKeys.includes(key)) {\n      return value;\n    }\n    return JSON.stringify(value);\n  }\n\n  protected encode(key: string, value: any) {\n    if (AuthStorageService.nonStringifiedOAuthLibKeys.includes(key)) {\n      return value;\n    } else {\n      try {\n        return JSON.parse(value);\n      } catch {\n        return value;\n      }\n    }\n  }\n\n  /* Async API for spartacus use */\n\n  /**\n   * Returns complete token (all fields).\n   *\n   * @return observable emitting AuthToken\n   */\n  getToken(): Observable<AuthToken> {\n    return this._token$;\n  }\n\n  /**\n   * Set current value of token.\n   *\n   * @param token\n   */\n  setToken(token: AuthToken): void {\n    (this._token$ as BehaviorSubject<AuthToken>).next(token);\n  }\n\n  /* Sync API for OAuth lib use */\n\n  /**\n   * Get parameter from the token (eg. access_token)\n   *\n   * @param key\n   */\n  getItem(key: string): any {\n    let token;\n    this.getToken()\n      .subscribe((currentToken) => (token = currentToken))\n      .unsubscribe();\n    return this.decode(key, token?.[key]);\n  }\n\n  /**\n   * Removes parameter from the token (eg. access_token)\n   *\n   * @param key\n   */\n  removeItem(key: string): void {\n    const val = { ...(this._token$ as BehaviorSubject<AuthToken>).value };\n    delete val[key];\n    (this._token$ as BehaviorSubject<AuthToken>).next({\n      ...val,\n    });\n  }\n\n  /**\n   * Sets parameter of the token (eg. access_token)\n   *\n   * @param key\n   */\n  setItem(key: string, data: any): void {\n    if (key) {\n      (this._token$ as BehaviorSubject<AuthToken>).next({\n        ...(this._token$ as BehaviorSubject<AuthToken>).value,\n        [key]: this.encode(key, data),\n      });\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class SiteContextConfig {\n  context?: {\n    urlParameters?: string[];\n    [contextName: string]: string[];\n  };\n}\n","import { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\nimport { SiteContextConfig } from '../../site-context/config/site-context-config';\nimport { OccEndpoints } from '../occ-models/occ-endpoints.model';\nimport { LoadingScopes } from './loading-scopes-config';\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class OccConfig extends SiteContextConfig {\n  backend?: {\n    occ?: {\n      baseUrl?: string;\n      prefix?: string;\n      /**\n       * Indicates whether or not cross-site Access-Control requests should be made\n       * using credentials such as cookies, authorization headers or TLS client certificates\n       */\n      useWithCredentials?: boolean;\n\n      endpoints?: OccEndpoints;\n    };\n    media?: {\n      /**\n       * Media URLs are typically relative, so that the host can be configured.\n       * Configurable media baseURLs are useful for SEO, multi-site,\n       * switching environments, etc.\n       */\n      baseUrl?: string;\n    };\n    loadingScopes?: LoadingScopes;\n  };\n}\n","/**\n * Supported OAuth flows.\n */\nexport enum OAuthFlow {\n  /**\n   * Flow when username and password is passed to the application and then the application through API fetches tokens from OAuth server.\n   */\n  ResourceOwnerPasswordFlow,\n  /**\n   * Flow with redirect to OAuth server where user inputs credentials and the are redirected back with token.\n   */\n  ImplicitFlow,\n  /**\n   * Similar to Implicit flow, but user is redirected with code that need to later exchange through API for a token.\n   */\n  AuthorizationCode,\n}\n","import { Injectable } from '@angular/core';\nimport { AuthConfig as LibConfig } from 'angular-oauth2-oidc';\nimport { Config } from '../../../config/config-tokens';\n\n// siletRefreshTimeout - omitted as it is deprecated of typo\n// clientId - we need it for client credentials flow\n// dummyClientSecret - we need it for client credentials flow\n// loginUrl - similarly like the rest of endpoints we want to have full control over that\n// logoutUrl - similarly like the rest of endpoints we want to have full control over that\n// tokenEndpoint - similarly like the rest of endpoints we want to have full control over that\n// revocationEndpoint - similarly like the rest of endpoints we want to have full control over that\n// userinfoEndpoint - similarly like the rest of endpoints we want to have full control over that\n//\nexport type AuthLibConfig = Omit<\n  LibConfig,\n  | 'clientId'\n  | 'dummyClientSecret'\n  | 'siletRefreshTimeout'\n  | 'loginUrl'\n  | 'logoutUrl'\n  | 'tokenEndpoint'\n  | 'revocationEndpoint'\n  | 'userinfoEndpoint'\n>;\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class AuthConfig {\n  authentication?: {\n    /**\n     * OAuth client id.\n     */\n    client_id?: string;\n    /**\n     * Secret for client required by Hybris OAuth.\n     */\n    client_secret?: string;\n    /**\n     * Base url for auth server (for login, token, revoke endpoints).\n     */\n    baseUrl?: string;\n    /**\n     * Endpoint for getting token.\n     */\n    tokenEndpoint?: string;\n    /**\n     * Endpoint url for revoking tokens.\n     */\n    revokeEndpoint?: string;\n    /**\n     * Url for login redirect for Implicit and Authorization Code Flow.\n     */\n    loginUrl?: string;\n    /**\n     * Redirect url after logout.\n     */\n    logoutUrl?: string;\n    /**\n     * Userinfo endpoint.\n     */\n    userinfoEndpoint?: string;\n    /**\n     * Config for angular-oauth-oidc library.\n     */\n    OAuthLibConfig?: AuthLibConfig;\n  };\n}\n","import { Injectable } from '@angular/core';\nimport { OccConfig } from '../../../occ/config/occ-config';\nimport { AuthConfig, AuthLibConfig } from '../config/auth-config';\nimport { OAuthFlow } from '../models/oauth-flow';\n\n/**\n * Utility service on top of the authorization config.\n * Provides handy defaults, when not everything is set in the configuration.\n * Use this service instead of direct configuration.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthConfigService {\n  constructor(\n    protected authConfig: AuthConfig,\n    protected occConfig: OccConfig\n  ) {}\n\n  /**\n   * Get client_id\n   *\n   * @return client_id\n   */\n  public getClientId(): string {\n    return this.authConfig.authentication.client_id ?? '';\n  }\n\n  /**\n   * Get client_secret. OAuth server shouldn't require it from web apps (but Hybris OAuth server requires).\n   *\n   * @return client_secret\n   */\n  public getClientSecret(): string {\n    return this.authConfig.authentication.client_secret ?? '';\n  }\n\n  /**\n   * Returns base url of the authorization server\n   */\n  public getBaseUrl(): string {\n    return (\n      this.authConfig.authentication.baseUrl ??\n      this.occConfig.backend.occ.baseUrl + '/authorizationserver'\n    );\n  }\n\n  /**\n   * Returns endpoint for getting the auth token\n   */\n  public getTokenEndpoint(): string {\n    const tokenEndpoint = this.authConfig.authentication.tokenEndpoint ?? '';\n    return this.prefixEndpoint(tokenEndpoint);\n  }\n\n  /**\n   * Returns url for redirect to the authorization server to get token/code\n   */\n  public getLoginUrl(): string {\n    const loginUrl = this.authConfig.authentication.loginUrl ?? '';\n    return this.prefixEndpoint(loginUrl);\n  }\n\n  /**\n   * Returns endpoint for token revocation (both access and refresh token).\n   */\n  public getRevokeEndpoint(): string {\n    const revokeEndpoint = this.authConfig.authentication.revokeEndpoint ?? '';\n    return this.prefixEndpoint(revokeEndpoint);\n  }\n\n  /**\n   * Returns logout url to redirect to on logout.\n   */\n  public getLogoutUrl(): string {\n    const logoutUrl = this.authConfig.authentication.logoutUrl ?? '';\n    return this.prefixEndpoint(logoutUrl);\n  }\n\n  /**\n   * Returns userinfo endpoint of the OAuth server.\n   */\n  public getUserinfoEndpoint(): string {\n    const userinfoEndpoint =\n      this.authConfig.authentication.userinfoEndpoint ?? '';\n    return this.prefixEndpoint(userinfoEndpoint);\n  }\n\n  /**\n   * Returns configuration specific for the angular-oauth2-oidc library.\n   */\n  public getOAuthLibConfig(): AuthLibConfig {\n    return this.authConfig.authentication?.OAuthLibConfig ?? {};\n  }\n\n  protected prefixEndpoint(endpoint: string): string {\n    let url = endpoint;\n    if (!url.startsWith('/')) {\n      url = '/' + url;\n    }\n    return `${this.getBaseUrl()}${url}`;\n  }\n\n  /**\n   * Returns the type of the OAuth flow based on auth config.\n   * Use when you have to perform particular action only in some of the OAuth flow scenarios.\n   */\n  public getOAuthFlow(): OAuthFlow {\n    const responseType = this.authConfig.authentication?.OAuthLibConfig\n      ?.responseType;\n    if (responseType) {\n      const types = responseType.split(' ');\n      if (types.includes('code')) {\n        return OAuthFlow.AuthorizationCode;\n      } else if (types.includes('token')) {\n        return OAuthFlow.ImplicitFlow;\n      } else {\n        return OAuthFlow.ResourceOwnerPasswordFlow;\n      }\n    }\n    return OAuthFlow.ResourceOwnerPasswordFlow;\n  }\n}\n","import { isPlatformServer } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { OAuthService, TokenResponse } from 'angular-oauth2-oidc';\nimport { WindowRef } from '../../../window/window-ref';\nimport { AuthConfigService } from './auth-config.service';\n\n/**\n * Wrapper service on the library OAuthService. Normalizes the lib API for services.\n * Use this service when you want to access low level OAuth library methods.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class OAuthLibWrapperService {\n  constructor(\n    protected oAuthService: OAuthService,\n    protected authConfigService: AuthConfigService,\n    @Inject(PLATFORM_ID) protected platformId: Object,\n    protected winRef: WindowRef\n  ) {\n    this.initialize();\n  }\n\n  protected initialize() {\n    const isSSR = isPlatformServer(this.platformId);\n    this.oAuthService.configure({\n      tokenEndpoint: this.authConfigService.getTokenEndpoint(),\n      loginUrl: this.authConfigService.getLoginUrl(),\n      clientId: this.authConfigService.getClientId(),\n      dummyClientSecret: this.authConfigService.getClientSecret(),\n      revocationEndpoint: this.authConfigService.getRevokeEndpoint(),\n      logoutUrl: this.authConfigService.getLogoutUrl(),\n      userinfoEndpoint: this.authConfigService.getUserinfoEndpoint(),\n      issuer:\n        this.authConfigService.getOAuthLibConfig()?.issuer ??\n        this.authConfigService.getBaseUrl(),\n      redirectUri:\n        this.authConfigService.getOAuthLibConfig()?.redirectUri ?? !isSSR\n          ? this.winRef.nativeWindow.location.origin\n          : '',\n      ...this.authConfigService.getOAuthLibConfig(),\n    });\n  }\n\n  /**\n   * Authorize with ResourceOwnerPasswordFlow.\n   *\n   * @param userId\n   * @param password\n   *\n   * @return token response from the lib\n   */\n  authorizeWithPasswordFlow(\n    userId: string,\n    password: string\n  ): Promise<TokenResponse> {\n    return this.oAuthService.fetchTokenUsingPasswordFlow(userId, password);\n  }\n\n  /**\n   * Refresh access_token.\n   */\n  refreshToken(): void {\n    this.oAuthService.refreshToken();\n  }\n\n  /**\n   * Revoke access tokens and clear tokens in lib state.\n   */\n  revokeAndLogout(): Promise<any> {\n    return new Promise((resolve) => {\n      this.oAuthService\n        .revokeTokenAndLogout()\n        .catch(() => {\n          // when there would be some kind of error during revocation we can't do anything else, so at least we logout user.\n          this.oAuthService.logOut();\n        })\n        .finally(() => {\n          resolve();\n        });\n    });\n  }\n\n  /**\n   * Clear tokens in library state (no revocation).\n   */\n  logout(): void {\n    this.oAuthService.logOut();\n  }\n\n  /**\n   * Returns Open Id token. Might be empty, when it was not requested with the `responseType` config.\n   *\n   * @return id token\n   */\n  getIdToken(): string {\n    return this.oAuthService.getIdToken();\n  }\n\n  /**\n   * Initialize Implicit Flow or Authorization Code flows with the redirect to OAuth login url.\n   */\n  initLoginFlow() {\n    return this.oAuthService.initLoginFlow();\n  }\n\n  /**\n   * Tries to login user based on `code` or `token` present in the url.\n   */\n  tryLogin() {\n    return this.oAuthService.tryLogin({\n      // We don't load discovery document, because it doesn't contain revoke endpoint information\n      disableOAuth2StateCheck: true,\n    });\n  }\n}\n","import { Action } from '@ngrx/store';\n\nexport const LOGIN = '[Auth] Login';\nexport const LOGOUT = '[Auth] Logout';\n\nexport class Login implements Action {\n  readonly type = LOGIN;\n}\n\nexport class Logout implements Action {\n  readonly type = LOGOUT;\n}\n\n// action types\nexport type LoginLogoutAction = Login | Logout;\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, Subscription } from 'rxjs';\nimport { map, take } from 'rxjs/operators';\nimport {\n  OCC_USER_ID_ANONYMOUS,\n  OCC_USER_ID_CURRENT,\n} from '../../../occ/utils/occ-constants';\n\n/**\n * This implementation is OCC specific.\n * Different backend might have completely different need regarding user id.\n * It might not need user id at all and work based on access_token.\n * To implement custom solution provide your own implementation and customize services that use UserIdService\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserIdService {\n  private _userId: Observable<string> = new BehaviorSubject<string>(\n    OCC_USER_ID_ANONYMOUS\n  );\n\n  /**\n   * Sets current user id.\n   *\n   * @param userId\n   */\n  public setUserId(userId: string): void {\n    (this._userId as BehaviorSubject<string>).next(userId);\n  }\n\n  /**\n   * This function provides the userId the OCC calls should use, depending\n   * on whether there is an active storefront session or not.\n   *\n   * It returns the userId of the current storefront user or 'anonymous'\n   * in the case there are no signed in user in the storefront.\n   *\n   * The user id of a regular customer session is 'current'. In the case of an\n   * asm customer emulation session, the userId will be the customerId.\n   */\n  public getUserId(): Observable<string> {\n    return this._userId;\n  }\n\n  /**\n   * @deprecated Use `takeUserId` method instead.\n   *\n   * Calls provided callback with current user id.\n   *\n   * @param cb callback function to invoke\n   */\n  public invokeWithUserId(cb: (userId: string) => any): Subscription {\n    return this.getUserId()\n      .pipe(take(1))\n      .subscribe((id) => cb(id));\n  }\n\n  /**\n   * Utility method if you need userId to perform single action (eg. dispatch call to API).\n   *\n   * @param loggedIn Set to true if you want the observable to emit id only for logged in user. Throws in case of anonymous user.\n   *\n   * @returns Observable that emits once and completes with the last userId value.\n   */\n  public takeUserId(loggedIn = false): Observable<string | never> {\n    return this.getUserId().pipe(\n      take(1),\n      map((userId) => {\n        if (loggedIn && userId === OCC_USER_ID_ANONYMOUS) {\n          throw new Error(\n            'Requested user id for logged user while user is not logged in.'\n          );\n        }\n        return userId;\n      })\n    );\n  }\n\n  /**\n   * Sets user id to the default value for logged out user.\n   */\n  public clearUserId(): void {\n    this.setUserId(OCC_USER_ID_ANONYMOUS);\n  }\n\n  /**\n   * Checks if the userId is of emulated user type.\n   */\n  public isEmulated(): Observable<boolean> {\n    return this.getUserId().pipe(\n      map(\n        (userId) =>\n          userId !== OCC_USER_ID_ANONYMOUS && userId !== OCC_USER_ID_CURRENT\n      )\n    );\n  }\n}\n","import { ErrorModel } from './misc.model';\n\nexport interface Country {\n  isocode?: string;\n  name?: string;\n}\n\nexport enum CountryType {\n  BILLING = 'BILLING',\n  SHIPPING = 'SHIPPING',\n}\n\nexport interface Region {\n  countryIso?: string;\n  isocode?: string;\n  isocodeShort?: string;\n  name?: string;\n}\n\nexport interface Address {\n  id?: string;\n\n  title?: string;\n  titleCode?: string;\n\n  email?: string;\n  firstName?: string;\n  lastName?: string;\n  companyName?: string;\n\n  line1?: string;\n  line2?: string;\n  postalCode?: string;\n  town?: string;\n  region?: Region;\n  district?: string;\n  country?: Country;\n  cellphone?: string;\n\n  defaultAddress?: boolean;\n  shippingAddress?: boolean;\n\n  formattedAddress?: string;\n  phone?: string;\n\n  visibleInAddressBook?: boolean;\n}\n\nexport interface AddressValidation {\n  decision?: string;\n  // TODO: Simplify with converter\n  errors?: { errors: ErrorModel[] };\n  suggestedAddresses?: Address[];\n}\n","import { Address } from './address.model';\nimport { Currency } from './misc.model';\nimport {\n  DeliveryMode,\n  OrderEntry,\n  PickupOrderEntryGroup,\n  PromotionOrderEntryConsumed,\n} from './order.model';\nimport { CostCenter } from './org-unit.model';\nimport { Price, Promotion } from './product.model';\n\nexport interface PromotionResult {\n  consumedEntries?: PromotionOrderEntryConsumed[];\n  description?: string;\n  promotion?: Promotion;\n}\n\nexport enum PromotionLocation {\n  ActiveCart = 'CART',\n  Checkout = 'CHECKOUT',\n  Order = 'ORDER',\n}\n\nexport enum B2BPaymentTypeEnum {\n  ACCOUNT_PAYMENT = 'ACCOUNT',\n  CARD_PAYMENT = 'CARD',\n}\n\nexport interface Voucher {\n  appliedValue?: Price;\n  code?: string;\n  currency?: Currency;\n  description?: string;\n  freeShipping?: boolean;\n  name?: string;\n  value?: number;\n  valueFormatted?: string;\n  valueString?: string;\n  voucherCode?: string;\n}\n\nexport interface DeliveryOrderEntryGroup {\n  deliveryAddress?: Address;\n  entries?: OrderEntry[];\n  quantity?: number;\n  totalPriceWithTax?: Price;\n}\n\nexport interface Principal {\n  name?: string;\n  uid?: string;\n}\n\nexport interface CardType {\n  code?: string;\n  name?: string;\n}\n\nexport interface PaymentType {\n  code?: string;\n  displayName?: string;\n}\n\nexport interface PaymentDetails {\n  accountHolderName?: string;\n  billingAddress?: Address;\n  cardNumber?: string;\n  cardType?: CardType;\n  cvn?: string;\n  defaultPayment?: boolean;\n  expiryMonth?: string;\n  expiryYear?: string;\n  id?: string;\n  issueNumber?: string;\n  saved?: boolean;\n  startMonth?: string;\n  startYear?: string;\n  subscriptionId?: string;\n}\n\nexport interface SaveCartResult {\n  savedCartData?: Cart;\n}\n\nexport interface Cart {\n  appliedOrderPromotions?: PromotionResult[];\n  appliedProductPromotions?: PromotionResult[];\n  appliedVouchers?: Voucher[];\n  calculated?: boolean;\n  code?: string;\n  costCenter?: CostCenter;\n  deliveryAddress?: Address;\n  deliveryCost?: Price;\n  deliveryItemsQuantity?: number;\n  deliveryMode?: DeliveryMode;\n  deliveryOrderGroups?: DeliveryOrderEntryGroup[];\n  description?: string;\n  entries?: OrderEntry[];\n  expirationTime?: Date;\n  guid?: string;\n  name?: string;\n  net?: boolean;\n  orderDiscounts?: Price;\n  paymentInfo?: PaymentDetails;\n  paymentType?: PaymentType;\n  pickupItemsQuantity?: number;\n  pickupOrderGroups?: PickupOrderEntryGroup[];\n  potentialOrderPromotions?: PromotionResult[];\n  potentialProductPromotions?: PromotionResult[];\n  productDiscounts?: Price;\n  purchaseOrderNumber?: string;\n  saveTime?: Date;\n  savedBy?: Principal;\n  site?: string;\n  store?: string;\n  subTotal?: Price;\n  totalDiscounts?: Price;\n  totalItems?: number;\n  totalPrice?: Price;\n  totalPriceWithTax?: Price;\n  totalTax?: Price;\n  totalUnitCount?: number;\n  user?: Principal;\n}\n\nexport interface CartModification {\n  deliveryModeChanged?: boolean;\n  entry?: OrderEntry;\n  quantity?: number;\n  quantityAdded?: number;\n  statusCode?: string;\n  statusMessage?: string;\n}\n","export interface CmsComponent {\n  modifiedTime?: Date;\n  name?: string;\n  otherProperties?: any;\n  typeCode?: string;\n  uid?: string;\n}\n\nexport enum PageType {\n  CONTENT_PAGE = 'ContentPage',\n  PRODUCT_PAGE = 'ProductPage',\n  CATEGORY_PAGE = 'CategoryPage',\n  CATALOG_PAGE = 'CatalogPage',\n}\n\nexport interface CmsLinkComponent extends CmsComponent {\n  url?: string;\n  container?: boolean;\n  external?: boolean;\n  contentPage?: string;\n  contentPageLabelOrId?: string;\n  linkName?: string;\n  target?: boolean;\n\n  /**\n   * Style classes can be added to the CMS Link component to enhance the UX.\n   * The style classes are typically derived from the (CMS) backend and should\n   * match an existing CSS selector.\n   *\n   * The styleClasses can contain a \"list\" of space separated style classes.\n   */\n  styleClasses?: string;\n\n  /**\n   * Style rules can be added to the CMS Link component to enhance the UX.\n   * The style attributes are typically derived from the (CMS) backend.\n   *\n   * The styleAttributes can contain a \"list\" of semicolon separated style rules.\n   */\n  styleAttributes?: string;\n}\n\nexport interface CmsSiteContextSelectorComponent extends CmsComponent {\n  context?: string;\n}\n\nexport interface CmsSearchBoxComponent extends CmsComponent {\n  container?: boolean;\n  maxSuggestions?: number;\n  maxProducts?: number;\n  displaySuggestions?: boolean;\n  displayProducts?: boolean;\n  displayProductImages?: boolean;\n  waitTimeBeforeRequest?: number;\n  minCharactersBeforeRequest?: number;\n}\n\nexport interface CmsParagraphComponent extends CmsComponent {\n  content?: string;\n  container?: string;\n  title?: string;\n}\n\nexport interface CMSTabParagraphContainer extends CmsComponent {\n  container?: string;\n  components?: string;\n}\n\nexport interface CmsBannerComponentMedia {\n  altText?: string;\n  code?: string;\n  mime?: string;\n  url?: string;\n}\n\nexport interface CmsResponsiveBannerComponentMedia {\n  desktop?: CmsBannerComponentMedia;\n  mobile?: CmsBannerComponentMedia;\n  tablet?: CmsBannerComponentMedia;\n  widescreen?: CmsBannerComponentMedia;\n}\n\nexport interface CmsBannerComponent extends CmsComponent {\n  headline?: string;\n  content?: string;\n  container?: string;\n  media?: CmsBannerComponentMedia | CmsResponsiveBannerComponentMedia;\n  urlLink?: string;\n  external?: string;\n}\n\nexport enum CmsBannerCarouselEffect {\n  FADE = 'FADE',\n  ZOOM = 'ZOOM',\n  CURTAIN = 'CURTAINX',\n  TURNDOWN = 'TURNDOWN',\n}\n\nexport interface CmsBannerCarouselComponent extends CmsComponent {\n  banners?: string;\n  effect?: CmsBannerCarouselEffect;\n}\n\nexport interface CmsProductCarouselComponent extends CmsComponent {\n  title?: string;\n  productCodes?: string;\n  container?: string;\n  popup?: string;\n  scroll?: string;\n}\n\nexport interface CmsProductReferencesComponent extends CmsComponent {\n  title?: string;\n  displayProductTitles?: string;\n  displayProductPrices?: string;\n  maximumNumberProducts?: number;\n  productReferenceTypes?: string;\n  container?: string;\n}\n\nexport interface CmsMiniCartComponent extends CmsComponent {\n  container?: string;\n  shownProductCount?: string;\n  title?: string;\n  totalDisplay?: string;\n  lightboxBannerComponent?: CmsBannerComponent;\n}\n\n// TODO: Upgrade model when Breadcrumbs will be finally used in project\nexport interface CmsBreadcrumbsComponent extends CmsComponent {\n  container?: string;\n}\n\nexport interface CmsNavigationNode {\n  uid?: string;\n  title?: string;\n  children?: Array<CmsNavigationNode>;\n  entries?: Array<CmsNavigationEntry>;\n}\n\nexport interface CmsNavigationEntry {\n  itemId?: string;\n  itemSuperType?: string;\n  itemType?: string;\n}\n\nexport interface CmsNavigationComponent extends CmsComponent {\n  container?: string;\n  styleClass?: string;\n  wrapAfter?: string;\n  notice?: string;\n  showLanguageCurrency?: string;\n  navigationNode?: CmsNavigationNode;\n}\n\nexport interface CmsProductFacetNavigationComponent extends CmsComponent {\n  container?: string;\n  activeFacetValueCode?: string;\n  searchResult?: string;\n  minPerFacet?: string;\n}\n","export interface ConsentTemplate {\n  id?: string;\n  name?: string;\n  description?: string;\n  version?: number;\n  currentConsent?: Consent;\n}\n\nexport interface Consent {\n  code?: string;\n  consentGivenDate?: Date;\n  consentWithdrawnDate?: Date;\n}\n\nexport interface AnonymousConsent {\n  templateCode?: string;\n  templateVersion?: number;\n  consentState?: ANONYMOUS_CONSENT_STATUS;\n}\n\nexport enum ANONYMOUS_CONSENT_STATUS {\n  GIVEN = 'GIVEN',\n  WITHDRAWN = 'WITHDRAWN',\n}\n\nexport const ANONYMOUS_CONSENTS_HEADER = 'X-Anonymous-Consents';\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { distinctUntilChanged, map } from 'rxjs/operators';\nimport { OCC_USER_ID_CURRENT } from '../../../occ/utils/occ-constants';\nimport { RoutingService } from '../../../routing/facade/routing.service';\nimport { StateWithClientAuth } from '../../client-auth/store/client-auth-state';\nimport { AuthRedirectService } from '../services/auth-redirect.service';\nimport { AuthStorageService } from '../services/auth-storage.service';\nimport { OAuthLibWrapperService } from '../services/oauth-lib-wrapper.service';\nimport { AuthActions } from '../store/actions/index';\nimport { UserIdService } from './user-id.service';\n\n/**\n * Auth service for normal user authentication.\n * Use to check auth status, login/logout with different OAuth flows.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthService {\n  constructor(\n    protected store: Store<StateWithClientAuth>,\n    protected userIdService: UserIdService,\n    protected oAuthLibWrapperService: OAuthLibWrapperService,\n    protected authStorageService: AuthStorageService,\n    protected authRedirectService: AuthRedirectService,\n    protected routingService: RoutingService\n  ) {}\n\n  /**\n   * Check params in url and if there is an code/token then try to login with those.\n   */\n  async checkOAuthParamsInUrl(): Promise<void> {\n    try {\n      const result = await this.oAuthLibWrapperService.tryLogin();\n      const token = this.authStorageService.getItem('access_token');\n      // We get the result in the code flow even if we did not logged in that why we also need to check if we have access_token\n      if (result && token) {\n        this.userIdService.setUserId(OCC_USER_ID_CURRENT);\n        this.store.dispatch(new AuthActions.Login());\n        this.authRedirectService.redirect();\n      }\n    } catch {}\n  }\n\n  /**\n   * Initialize Implicit/Authorization Code flow by redirecting to OAuth server.\n   */\n  loginWithRedirect(): boolean {\n    this.oAuthLibWrapperService.initLoginFlow();\n    return true;\n  }\n\n  /**\n   * Loads a new user token with Resource Owner Password Flow.\n   * @param userId\n   * @param password\n   */\n  async loginWithCredentials(userId: string, password: string): Promise<void> {\n    try {\n      await this.oAuthLibWrapperService.authorizeWithPasswordFlow(\n        userId,\n        password\n      );\n      // OCC specific user id handling. Customize when implementing different backend\n      this.userIdService.setUserId(OCC_USER_ID_CURRENT);\n\n      this.store.dispatch(new AuthActions.Login());\n\n      this.authRedirectService.redirect();\n    } catch {}\n  }\n\n  /**\n   * Revokes tokens and clears state for logged user (tokens, userId).\n   * To perform logout it is best to use `logout` method. Use this method with caution.\n   */\n  coreLogout(): Promise<any> {\n    this.userIdService.clearUserId();\n    return new Promise((resolve) => {\n      this.oAuthLibWrapperService.revokeAndLogout().finally(() => {\n        this.store.dispatch(new AuthActions.Logout());\n        resolve();\n      });\n    });\n  }\n\n  /**\n   * Returns `true` if the user is logged in; and `false` if the user is anonymous.\n   */\n  isUserLoggedIn(): Observable<boolean> {\n    return this.authStorageService.getToken().pipe(\n      map((userToken) => Boolean(userToken?.access_token)),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Logout a storefront customer. It will initialize logout procedure by redirecting to the `logout` endpoint.\n   */\n  logout(): void {\n    this.routingService.go({ cxRoute: 'logout' });\n  }\n}\n","export interface Images {\n  [imageType: string]: ImageGroup | ImageGroup[];\n}\n\nexport interface Image {\n  altText?: string;\n  format?: string;\n  galleryIndex?: number;\n  imageType?: ImageType;\n  url?: string;\n}\n\nexport enum ImageType {\n  PRIMARY = 'PRIMARY',\n  GALLERY = 'GALLERY',\n}\n\nexport interface ImageGroup {\n  [format: string]: Image;\n}\n","import { Address } from './address.model';\nimport { User } from './misc.model';\n\n// TODO(#8876): Should we simplify the models only for the fields required by the B2B checkout?\nexport interface CostCenter {\n  active?: boolean;\n  code?: string;\n  name?: string;\n  unit?: B2BUnit;\n}\n\nexport enum B2BUserRole {\n  ADMIN = 'b2badmingroup',\n  CUSTOMER = 'b2bcustomergroup',\n  MANAGER = 'b2bmanagergroup',\n  APPROVER = 'b2bapprovergroup',\n}\n\nexport interface B2BUnit {\n  active?: boolean;\n  addresses?: Address[];\n  uid?: string;\n  name?: string;\n}\n\nexport interface B2BUser extends User {\n  active?: boolean;\n}\n\nexport interface B2BApprovalProcess {\n  code?: string;\n  name?: string;\n}\n\nexport interface OrderApprovalPermissionType {\n  code?: string;\n  name?: string;\n}\n","import { Image, Images } from './image.model';\nimport { User } from './misc.model';\n\nexport interface VariantOptionQualifier {\n  image?: Image;\n  name?: string;\n  qualifier?: VariantQualifier;\n  value?: string;\n}\n\nexport interface PromotionRestriction {\n  description?: string;\n  restrictionType?: string;\n}\n\nexport interface FeatureUnit {\n  name?: string;\n  symbol?: string;\n  unitType?: string;\n}\n\nexport interface FeatureValue {\n  value?: string;\n}\n\nexport interface Feature {\n  code?: string;\n  comparable?: boolean;\n  description?: string;\n  featureUnit?: FeatureUnit;\n  featureValues?: FeatureValue[];\n  name?: string;\n  range?: boolean;\n  type?: string;\n}\n\nexport interface VariantCategory {\n  hasImage?: boolean;\n  name?: string;\n  priority?: number;\n}\n\nexport interface VariantValueCategory {\n  name?: string;\n  sequence?: number;\n  superCategories?: VariantCategory[];\n}\n\nexport enum VariantType {\n  SIZE = 'ApparelSizeVariantProduct',\n  STYLE = 'ApparelStyleVariantProduct',\n  COLOR = 'ElectronicsColorVariantProduct',\n}\n\nexport enum PriceType {\n  BUY = 'BUY',\n  FROM = 'FROM',\n}\n\nexport interface Price {\n  currencyIso?: string;\n  formattedValue?: string;\n  maxQuantity?: number;\n  minQuantity?: number;\n  priceType?: PriceType;\n  value?: number;\n}\n\nexport interface Stock {\n  stockLevel?: number;\n  stockLevelStatus?: string;\n}\n\nexport interface VariantOption {\n  code?: string;\n  priceData?: Price;\n  stock?: Stock;\n  url?: string;\n  variantOptionQualifiers?: VariantOptionQualifier[];\n}\n\nexport interface Promotion {\n  code?: string;\n  couldFireMessages?: string[];\n  description?: string;\n  enabled?: boolean;\n  endDate?: Date;\n  firedMessages?: string[];\n  priority?: number;\n  productBanner?: Image;\n  promotionGroup?: string;\n  promotionType?: string;\n  restrictions?: PromotionRestriction[];\n  startDate?: Date;\n  title?: string;\n}\n\nexport interface Category {\n  code?: string;\n  name?: string;\n  image?: Image;\n  url?: string;\n}\n\nexport interface Classification {\n  code?: string;\n  features?: Feature[];\n  name?: string;\n}\n\nexport interface FutureStock {\n  date?: Date;\n  formattedDate?: string;\n  stock?: Stock;\n}\n\nexport interface PriceRange {\n  maxPrice?: Price;\n  minPrice?: Price;\n}\n\nexport interface ProductReference {\n  description?: string;\n  preselected?: boolean;\n  quantity?: number;\n  referenceType?: string;\n  target?: Product;\n}\n\nexport interface Review {\n  alias?: string;\n  comment?: string;\n  date?: Date;\n  headline?: string;\n  id?: string;\n  principal?: User;\n  rating?: number;\n}\n\nexport interface VariantMatrixElement {\n  elements?: VariantMatrixElement[];\n  isLeaf?: boolean;\n  parentVariantCategory?: VariantCategory;\n  variantOption?: VariantOption;\n  variantValueCategory?: VariantValueCategory;\n}\n\nexport interface ProductReferences {\n  [referenceType: string]: ProductReference[];\n}\n\nexport interface BaseOption {\n  options?: VariantOption[];\n  selected?: VariantOption;\n  variantType?: VariantType;\n}\n\nexport interface Product {\n  availableForPickup?: boolean;\n  averageRating?: number;\n  baseOptions?: BaseOption[];\n  baseProduct?: string;\n  categories?: Category[];\n  classifications?: Classification[];\n  code?: string;\n  description?: string;\n  futureStocks?: FutureStock[];\n  images?: Images;\n  manufacturer?: string;\n  multidimensional?: boolean;\n  name?: string;\n  nameHtml?: string;\n  numberOfReviews?: number;\n  potentialPromotions?: Promotion[];\n  price?: Price;\n  priceRange?: PriceRange;\n  productReferences?: ProductReferences;\n  purchasable?: boolean;\n  reviews?: Review[];\n  stock?: Stock;\n  summary?: string;\n  url?: string;\n  variantMatrix?: VariantMatrixElement[];\n  variantOptions?: VariantOption[];\n  variantType?: VariantType;\n  volumePrices?: Price[];\n  volumePricesFlag?: boolean;\n}\n\nexport enum VariantQualifier {\n  SIZE = 'size',\n  STYLE = 'style',\n  COLOR = 'color',\n  THUMBNAIL = 'thumbnail',\n  PRODUCT = 'product',\n  ROLLUP_PROPERTY = 'rollupProperty',\n}\n","import { Address } from './address.model';\nimport {\n  DeliveryOrderEntryGroup,\n  PaymentDetails,\n  PaymentType,\n  Principal,\n  PromotionResult,\n  Voucher,\n} from './cart.model';\nimport { PaginationModel, SortModel } from './misc.model';\nimport { DeliveryMode, OrderEntry, PickupOrderEntryGroup } from './order.model';\nimport { CostCenter } from './org-unit.model';\nimport { Price } from './product.model';\n\nexport interface ReplenishmentOrder {\n  active?: boolean;\n  appliedOrderPromotions?: PromotionResult[];\n  appliedProductPromotions?: PromotionResult[];\n  appliedVouchers?: Voucher[];\n  calculated?: boolean;\n  code?: string;\n  costCenter?: CostCenter;\n  deliveryAddress?: Address;\n  deliveryCost?: Price;\n  deliveryItemsQuantity?: number;\n  deliveryMode?: DeliveryMode;\n  deliveryOrderGroups?: DeliveryOrderEntryGroup[];\n  description?: string;\n  entries?: OrderEntry[];\n  expirationTime?: string;\n  firstDate?: string;\n  guid?: string;\n  name?: string;\n  net?: boolean;\n  orderDiscounts?: Price;\n  paymentInfo?: PaymentDetails;\n  paymentStatus?: string;\n  paymentType?: PaymentType;\n  pickupItemsQuantity?: number;\n  pickupOrderGroups?: PickupOrderEntryGroup[];\n  potentialOrderPromotions?: PromotionResult[];\n  potentialProductPromotions?: PromotionResult[];\n  productDiscounts?: Price;\n  purchaseOrderNumber?: string;\n  replenishmentOrderCode?: string;\n  saveTime?: string;\n  savedBy?: Principal;\n  site?: string;\n  store?: string;\n  subTotal?: Price;\n  totalDiscounts?: Price;\n  totalItems?: number;\n  totalPrice?: Price;\n  totalPriceWithTax?: Price;\n  totalTax?: Price;\n  totalUnitCount?: number;\n  trigger?: Trigger;\n  user?: Principal;\n}\n\nexport interface ReplenishmentOrderList {\n  replenishmentOrders?: ReplenishmentOrder[];\n  pagination?: PaginationModel;\n  sorts?: SortModel[];\n}\n\nexport interface Trigger {\n  activationTime?: string;\n  displayTimeTable?: string;\n}\n\nexport interface ScheduleReplenishmentForm {\n  daysOfWeek?: DaysOfWeek[];\n  nthDayOfMonth?: string;\n  numberOfDays?: string;\n  numberOfWeeks?: string;\n  recurrencePeriod?: string;\n  replenishmentStartDate?: string;\n}\n\nexport enum DaysOfWeek {\n  MONDAY = 'MONDAY',\n  TUESDAY = 'TUESDAY',\n  WEDNESDAY = 'WEDNESDAY',\n  THURSDAY = 'THURSDAY',\n  FRIDAY = 'FRIDAY',\n  SATURDAY = 'SATURDAY',\n  SUNDAY = 'SUNDAY',\n}\n\nexport const recurrencePeriod = {\n  DAILY: 'DAILY',\n  WEEKLY: 'WEEKLY',\n  MONTHLY: 'MONTHLY',\n};\n\nexport enum ORDER_TYPE {\n  PLACE_ORDER = 'PLACE_ORDER',\n  SCHEDULE_REPLENISHMENT_ORDER = 'SCHEDULE_REPLENISHMENT_ORDER',\n}\n","import { Product } from './product.model';\nimport { Pagination, Sort } from './unused.model';\n\nexport interface ProductInterestEntry {\n  interestType?: NotificationType;\n  dateAdded?: string;\n  expirationDate?: string;\n}\n\nexport interface ProductInterestEntryRelation {\n  product?: Product;\n  productInterestEntry?: ProductInterestEntry[];\n}\n\nexport interface ProductInterestSearchResult {\n  results?: ProductInterestEntryRelation[];\n  sorts?: Sort[];\n  pagination?: Pagination;\n}\n\nexport enum NotificationType {\n  BACK_IN_STOCK = 'BACK_IN_STOCK',\n}\n","import { Action } from '@ngrx/store';\n\nexport const ENTITY_REMOVE_ACTION = '[ENTITY] REMOVE';\nexport const ENTITY_REMOVE_ALL_ACTION = '[ENTITY] REMOVE ALL';\n\nexport interface EntityMeta {\n  entityType: string;\n  entityId: string | string[];\n  entityRemove?: boolean;\n}\n\nexport function entityMeta(type: string, id: string | string[]): EntityMeta {\n  return {\n    entityType: type,\n    entityId: id,\n  };\n}\n\nexport function entityRemoveMeta(\n  type: string,\n  id: string | string[]\n): EntityMeta {\n  return {\n    entityId: id,\n    entityType: type,\n    entityRemove: true,\n  };\n}\n\nexport function entityRemoveAllMeta(type: string): EntityMeta {\n  return {\n    entityId: null,\n    entityType: type,\n    entityRemove: true,\n  };\n}\n\nexport interface EntityAction extends Action {\n  readonly payload?: any;\n  readonly meta?: EntityMeta;\n}\n\nexport class EntityRemoveAction implements EntityAction {\n  type = ENTITY_REMOVE_ACTION;\n  readonly meta: EntityMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityRemoveMeta(entityType, id);\n  }\n}\n\nexport class EntityRemoveAllAction implements EntityAction {\n  type = ENTITY_REMOVE_ALL_ACTION;\n  readonly meta: EntityMeta;\n  constructor(entityType: string) {\n    this.meta = entityRemoveAllMeta(entityType);\n  }\n}\n","import { Action } from '@ngrx/store';\n\nexport const LOADER_LOAD_ACTION = '[LOADER] LOAD';\nexport const LOADER_FAIL_ACTION = '[LOADER] FAIL';\nexport const LOADER_SUCCESS_ACTION = '[LOADER] SUCCESS';\nexport const LOADER_RESET_ACTION = '[LOADER] RESET';\n\nexport interface LoaderMeta {\n  entityType: string;\n  loader: {\n    load?: boolean;\n    error?: any;\n    success?: boolean;\n  };\n}\n\nexport interface LoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: LoaderMeta;\n}\n\nexport function loadMeta(entityType: string): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {\n      load: true,\n    },\n  };\n}\n\nexport function failMeta(entityType: string, error?: any): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {\n      error: error ? error : true,\n    },\n  };\n}\n\nexport function successMeta(entityType: string): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {\n      success: true,\n    },\n  };\n}\n\nexport function resetMeta(entityType: string): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {},\n  };\n}\nexport class LoaderLoadAction implements LoaderAction {\n  type = LOADER_LOAD_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string) {\n    this.meta = loadMeta(entityType);\n  }\n}\n\nexport class LoaderFailAction implements LoaderAction {\n  type = LOADER_FAIL_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string, error?: any) {\n    this.meta = failMeta(entityType, error);\n  }\n}\n\nexport class LoaderSuccessAction implements LoaderAction {\n  type = LOADER_SUCCESS_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string) {\n    this.meta = successMeta(entityType);\n  }\n}\n\nexport class LoaderResetAction implements LoaderAction {\n  type = LOADER_RESET_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string) {\n    this.meta = resetMeta(entityType);\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { entityMeta, EntityMeta } from '../entity/entity.action';\nimport {\n  failMeta,\n  LoaderMeta,\n  loadMeta,\n  resetMeta,\n  successMeta,\n} from '../loader/loader.action';\n\nexport const ENTITY_LOAD_ACTION = '[ENTITY] LOAD';\nexport const ENTITY_FAIL_ACTION = '[ENTITY] LOAD FAIL';\nexport const ENTITY_SUCCESS_ACTION = '[ENTITY] LOAD SUCCESS';\nexport const ENTITY_RESET_ACTION = '[ENTITY] RESET';\n\nexport interface EntityLoaderMeta extends EntityMeta, LoaderMeta {}\n\nexport interface EntityLoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: EntityLoaderMeta;\n}\n\nexport function entityLoadMeta(\n  entityType: string,\n  id: string | string[]\n): EntityLoaderMeta {\n  return {\n    ...loadMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entityFailMeta(\n  entityType: string,\n  id: string | string[],\n  error?: any\n): EntityLoaderMeta {\n  return {\n    ...failMeta(entityType, error),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entitySuccessMeta(\n  entityType: string,\n  id: string | string[]\n): EntityLoaderMeta {\n  return {\n    ...successMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entityResetMeta(\n  entityType: string,\n  id: string | string[]\n): EntityLoaderMeta {\n  return {\n    ...resetMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport class EntityLoadAction implements EntityLoaderAction {\n  type = ENTITY_LOAD_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityLoadMeta(entityType, id);\n  }\n}\n\nexport class EntityFailAction implements EntityLoaderAction {\n  type = ENTITY_FAIL_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[], error?: any) {\n    this.meta = entityFailMeta(entityType, id, error);\n  }\n}\n\nexport class EntitySuccessAction implements EntityLoaderAction {\n  type = ENTITY_SUCCESS_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[], public payload?: any) {\n    this.meta = entitySuccessMeta(entityType, id);\n  }\n}\n\nexport class EntityLoaderResetAction implements EntityLoaderAction {\n  type = ENTITY_RESET_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityResetMeta(entityType, id);\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { LoaderState } from './loader-state';\nimport { LoaderAction } from './loader.action';\n\nexport const initialLoaderState: LoaderState<any> = {\n  loading: false,\n  error: false,\n  success: false,\n  value: undefined,\n};\n\n/**\n * Higher order reducer that adds generic loading flag to chunk of the state\n *\n * Utilizes \"loader\" meta field of actions to set specific flags for specific\n * action (LOAD, SUCCESS, FAIL, RESET)\n */\nexport function loaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: Action) => T\n): (state: LoaderState<T>, action: LoaderAction) => LoaderState<T> {\n  return (\n    state: LoaderState<T> = initialLoaderState,\n    action: LoaderAction\n  ): LoaderState<T> => {\n    if (\n      action.meta &&\n      action.meta.loader &&\n      action.meta.entityType === entityType\n    ) {\n      const entity = action.meta.loader;\n\n      if (entity.load) {\n        return {\n          ...state,\n          loading: true,\n          value: reducer ? reducer(state.value, action) : state.value,\n        };\n      } else if (entity.error) {\n        return {\n          ...state,\n          loading: false,\n          error: true,\n          success: false,\n          value: reducer ? reducer(state.value, action) : undefined,\n        };\n      } else if (entity.success) {\n        return {\n          ...state,\n          value: reducer ? reducer(state.value, action) : action.payload,\n          loading: false,\n          error: false,\n          success: true,\n        };\n      } else {\n        // reset state action\n        return {\n          ...initialLoaderState,\n          value: reducer\n            ? reducer(initialLoaderState.value, action)\n            : initialLoaderState.value,\n        };\n      }\n    }\n\n    if (reducer) {\n      const newValue = reducer(state.value, action);\n      if (newValue !== state.value) {\n        return { ...state, value: newValue };\n      }\n    }\n    return state;\n  };\n}\n","import { LoaderState } from './loader-state';\n\nexport function loaderValueSelector<T>(state: LoaderState<T>): T {\n  return state.value;\n}\n\nexport function loaderLoadingSelector<T>(state: LoaderState<T>): boolean {\n  return state.loading;\n}\n\nexport function loaderErrorSelector<T>(state: LoaderState<T>): boolean {\n  return state.error;\n}\n\nexport function loaderSuccessSelector<T>(state: LoaderState<T>): boolean {\n  return state.success;\n}\n","import { LoaderState } from '../loader/loader-state';\nimport { initialLoaderState } from '../loader/loader.reducer';\nimport { EntityLoaderState } from './entity-loader-state';\nimport {\n  loaderValueSelector,\n  loaderLoadingSelector,\n  loaderErrorSelector,\n  loaderSuccessSelector,\n} from '../loader';\n\nexport function entityLoaderStateSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): LoaderState<T> {\n  return state.entities[id] || initialLoaderState;\n}\n\nexport function entityValueSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): T {\n  const entityState = entityLoaderStateSelector(state, id);\n  return loaderValueSelector(entityState);\n}\n\nexport function entityLoadingSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityLoaderStateSelector(state, id);\n  return loaderLoadingSelector(entityState);\n}\n\nexport function entityErrorSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityLoaderStateSelector(state, id);\n  return loaderErrorSelector(entityState);\n}\n\nexport function entitySuccessSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityLoaderStateSelector(state, id);\n  return loaderSuccessSelector(entityState);\n}\n","import { Action } from '@ngrx/store';\n\nimport { EntityState } from './entity-state';\nimport { EntityAction } from './entity.action';\n\nexport const initialEntityState: EntityState<any> = { entities: {} };\n\n/**\n * Higher order reducer for reusing reducer logic for multiple entities\n *\n * Utilizes entityId meta field to target entity by id in actions\n */\nexport function entityReducer<T>(\n  entityType: string,\n  reducer: (state: T, action: Action) => T\n) {\n  return (\n    state: EntityState<T> = initialEntityState,\n    action: EntityAction\n  ): EntityState<T> => {\n    let ids: string[];\n    let partitionPayload = false;\n    if (\n      action.meta &&\n      action.meta.entityType === entityType &&\n      action.meta.entityId !== undefined\n    ) {\n      ids = [].concat(action.meta.entityId);\n\n      // remove selected entities\n      if (action.meta.entityRemove) {\n        if (action.meta.entityId === null) {\n          return initialEntityState;\n        } else {\n          let removed = false;\n          const newEntities = Object.keys(state.entities).reduce((acc, cur) => {\n            if (ids.includes(cur)) {\n              removed = true;\n            } else {\n              acc[cur] = state.entities[cur];\n            }\n            return acc;\n          }, {});\n\n          return removed ? { entities: newEntities } : state;\n        }\n      }\n\n      partitionPayload =\n        Array.isArray(action.meta.entityId) && Array.isArray(action.payload);\n    } else {\n      ids = Object.keys(state.entities);\n    }\n\n    const entityUpdates: { [id: string]: T } = {};\n\n    for (let i = 0; i < ids.length; i++) {\n      const id = ids[i];\n      const subAction = partitionPayload\n        ? { ...action, payload: action.payload[i] }\n        : action;\n      const newState = reducer(state.entities[id], subAction);\n      if (newState) {\n        entityUpdates[id] = newState;\n      }\n    }\n\n    if (Object.keys(entityUpdates).length > 0) {\n      return {\n        ...state,\n        entities: { ...state.entities, ...entityUpdates },\n      };\n    }\n\n    return state;\n  };\n}\n","import { entityReducer } from '../entity/entity.reducer';\nimport { loaderReducer } from '../loader/loader.reducer';\nimport { LoaderAction } from '../loader/loader.action';\nimport { EntityLoaderState } from './entity-loader-state';\nimport { EntityLoaderAction } from './entity-loader.action';\n\n/**\n * Higher order reducer that wraps LoaderReducer and EntityReducer enhancing\n * single state reducer to support multiple entities with generic loading flags\n */\nexport function entityLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: LoaderAction) => T\n): (\n  state: EntityLoaderState<T>,\n  action: EntityLoaderAction\n) => EntityLoaderState<T> {\n  return entityReducer(entityType, loaderReducer(entityType, reducer));\n}\n","import { Action } from '@ngrx/store';\nimport {\n  LoaderMeta,\n  resetMeta as loaderResetMeta,\n} from '../loader/loader.action';\n\nexport const PROCESSES_INCREMENT_ACTION = '[PROCESSES LOADER] INCREMENT';\nexport const PROCESSES_DECREMENT_ACTION = '[PROCESSES LOADER] DECREMENT';\nexport const PROCESSES_LOADER_RESET_ACTION = '[PROCESSES LOADER] RESET';\n\nexport interface ProcessesLoaderMeta extends LoaderMeta {\n  entityType: string;\n  processesCountDiff?: number;\n}\n\nexport interface ProcessesLoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: ProcessesLoaderMeta;\n}\n\nexport function processesIncrementMeta(\n  entityType: string\n): ProcessesLoaderMeta {\n  return {\n    entityType: entityType,\n    loader: undefined,\n    processesCountDiff: 1,\n  };\n}\n\nexport function processesDecrementMeta(\n  entityType: string\n): ProcessesLoaderMeta {\n  return {\n    entityType: entityType,\n    loader: undefined,\n    processesCountDiff: -1,\n  };\n}\n\nexport function processesLoaderResetMeta(\n  entityType: string\n): ProcessesLoaderMeta {\n  // processes reset action is a reset action for loader reducer, but not the other way around\n  return {\n    ...loaderResetMeta(entityType),\n    processesCountDiff: null,\n  };\n}\n\nexport class ProcessesLoaderResetAction implements ProcessesLoaderAction {\n  type = PROCESSES_LOADER_RESET_ACTION;\n  readonly meta: ProcessesLoaderMeta;\n  constructor(entityType: string) {\n    this.meta = processesLoaderResetMeta(entityType);\n  }\n}\n\nexport class ProcessesIncrementAction implements ProcessesLoaderAction {\n  type = PROCESSES_INCREMENT_ACTION;\n  readonly meta: ProcessesLoaderMeta;\n  constructor(entityType: string) {\n    this.meta = processesIncrementMeta(entityType);\n  }\n}\n\nexport class ProcessesDecrementAction implements ProcessesLoaderAction {\n  type = PROCESSES_DECREMENT_ACTION;\n  readonly meta: ProcessesLoaderMeta;\n  constructor(entityType: string) {\n    this.meta = processesDecrementMeta(entityType);\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { entityMeta, EntityMeta } from '../entity/entity.action';\nimport {\n  processesDecrementMeta,\n  processesIncrementMeta,\n  ProcessesLoaderMeta,\n  processesLoaderResetMeta,\n} from '../processes-loader/processes-loader.action';\n\nexport const ENTITY_PROCESSES_LOADER_RESET_ACTION =\n  '[ENTITY] PROCESSES LOADER RESET';\nexport const ENTITY_PROCESSES_INCREMENT_ACTION = '[ENTITY] PROCESSES INCREMENT';\nexport const ENTITY_PROCESSES_DECREMENT_ACTION = '[ENTITY] PROCESSES DECREMENT';\n\nexport interface EntityProcessesLoaderMeta\n  extends EntityMeta,\n    ProcessesLoaderMeta {}\n\nexport interface EntityProcessesLoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: EntityProcessesLoaderMeta;\n}\n\nexport function entityProcessesLoaderResetMeta(\n  entityType: string,\n  id: string | string[]\n): EntityProcessesLoaderMeta {\n  return {\n    ...processesLoaderResetMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entityProcessesIncrementMeta(\n  entityType: string,\n  id: string | string[]\n): EntityProcessesLoaderMeta {\n  return {\n    ...processesIncrementMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entityProcessesDecrementMeta(\n  entityType: string,\n  id: string | string[]\n): EntityProcessesLoaderMeta {\n  return {\n    ...processesDecrementMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport class EntityProcessesLoaderResetAction\n  implements EntityProcessesLoaderAction {\n  type = ENTITY_PROCESSES_LOADER_RESET_ACTION;\n  readonly meta: EntityProcessesLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityProcessesLoaderResetMeta(entityType, id);\n  }\n}\n\nexport class EntityProcessesIncrementAction\n  implements EntityProcessesLoaderAction {\n  type = ENTITY_PROCESSES_INCREMENT_ACTION;\n  readonly meta: EntityProcessesLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityProcessesIncrementMeta(entityType, id);\n  }\n}\n\nexport class EntityProcessesDecrementAction\n  implements EntityProcessesLoaderAction {\n  type = ENTITY_PROCESSES_DECREMENT_ACTION;\n  readonly meta: EntityProcessesLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityProcessesDecrementMeta(entityType, id);\n  }\n}\n","import { ProcessesLoaderState } from './processes-loader-state';\n\nexport function isStableSelector<T>(state: ProcessesLoaderState<T>): boolean {\n  return state.processesCount === 0 && !state.loading;\n}\n\nexport function hasPendingProcessesSelector<T>(\n  state: ProcessesLoaderState<T>\n): boolean {\n  return state.processesCount > 0;\n}\n","import { isDevMode } from '@angular/core';\nimport { Action } from '@ngrx/store';\nimport { initialLoaderState, loaderReducer } from '../loader/loader.reducer';\nimport { ProcessesLoaderState } from './processes-loader-state';\nimport { ProcessesLoaderAction } from './processes-loader.action';\n\nexport const initialProcessesState: ProcessesLoaderState<any> = {\n  processesCount: 0,\n};\n\n/**\n * Higher order reducer that adds processes count\n */\nexport function processesLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: Action) => T\n): (\n  state: ProcessesLoaderState<T>,\n  action: ProcessesLoaderAction\n) => ProcessesLoaderState<T> {\n  return (\n    state: ProcessesLoaderState<T> = {\n      ...initialProcessesState,\n      ...initialLoaderState,\n    },\n    action: ProcessesLoaderAction\n  ): ProcessesLoaderState<T> => {\n    const loaderState = loaderReducer(entityType, reducer)(state, action);\n    if (action.meta && action.meta.entityType === entityType) {\n      const processesCountDiff = action.meta.processesCountDiff;\n      if (isDevMode() && state.processesCount + processesCountDiff < 0) {\n        console.error(\n          `Action '${action.type}' sets processesCount to value < 0!\\n` +\n            'Make sure to keep processesCount in sync.\\n' +\n            'There should always be only one decrement action for each increment action.\\n' +\n            \"Make sure that you don't reset state in between those actions.\\n\",\n          action\n        );\n      }\n      if (processesCountDiff) {\n        return {\n          ...loaderState,\n          processesCount: state.processesCount\n            ? state.processesCount + processesCountDiff\n            : processesCountDiff,\n        };\n      } else if (processesCountDiff === null) {\n        // reset action\n        return {\n          ...loaderState,\n          ...initialProcessesState,\n        };\n      }\n    }\n\n    return loaderState;\n  };\n}\n","import { entityLoaderStateSelector } from '../entity-loader/entity-loader.selectors';\nimport { initialLoaderState } from '../loader/loader.reducer';\nimport {\n  initialProcessesState,\n  ProcessesLoaderState,\n} from '../processes-loader';\nimport {\n  hasPendingProcessesSelector,\n  isStableSelector,\n} from '../processes-loader/processes-loader.selectors';\nimport { EntityProcessesLoaderState } from './entity-processes-loader-state';\n\nconst initialProcessesLoaderState = {\n  ...initialLoaderState,\n  ...initialProcessesState,\n};\n\nexport function entityHasPendingProcessesSelector<T>(\n  state: EntityProcessesLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityLoaderStateSelector(state, id);\n  return hasPendingProcessesSelector(entityState);\n}\n\nexport function entityIsStableSelector<T>(\n  state: EntityProcessesLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityLoaderStateSelector(state, id);\n  return isStableSelector(entityState);\n}\n\nexport function entityProcessesLoaderStateSelector<T>(\n  state: EntityProcessesLoaderState<T>,\n  id: string\n): ProcessesLoaderState<T> {\n  return state.entities[id] || initialProcessesLoaderState;\n}\n","import { entityReducer } from '../entity/entity.reducer';\nimport { processesLoaderReducer } from '../processes-loader';\nimport { ProcessesLoaderAction } from '../processes-loader/processes-loader.action';\nimport { EntityProcessesLoaderState } from './entity-processes-loader-state';\nimport { EntityProcessesLoaderAction } from './entity-processes-loader.action';\n\n/**\n * Higher order reducer that wraps ProcessesLoaderReducer and EntityReducer enhancing\n * single state reducer to support multiple entities with generic processesCount flag\n */\nexport function entityProcessesLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: ProcessesLoaderAction) => T\n): (\n  state: EntityProcessesLoaderState<T>,\n  action: EntityProcessesLoaderAction\n) => EntityProcessesLoaderState<T> {\n  return entityReducer(entityType, processesLoaderReducer(entityType, reducer));\n}\n","import { EntityState } from './entity-state';\n\nexport function entitySelector<T>(state: EntityState<T>, id: string): T {\n  return state.entities[id] || undefined;\n}\n","import { deepMerge } from '../../config/utils/deep-merge';\nimport { StateTransferType, StorageSyncType } from '../config/state-config';\n\nconst OBJECT_SEPARATOR = '.';\n\nexport function getStateSliceValue<T, E>(keys: string, state: T): E {\n  return keys\n    .split(OBJECT_SEPARATOR)\n    .reduce(\n      (previous, current) => (previous ? previous[current] : undefined),\n      state\n    );\n}\n\nexport function createShellObject<T, E>(\n  key: string,\n  excludeKeys: string[],\n  value: T\n): E {\n  if (!key || !value || Object.keys(value).length === 0) {\n    return {} as E;\n  }\n\n  const shell = key.split(OBJECT_SEPARATOR).reduceRight((acc, previous) => {\n    return ({ [previous]: acc } as unknown) as T;\n  }, value);\n  return handleExclusions(key, excludeKeys, shell);\n}\n\nexport function getStateSlice<T, E>(\n  keys: string[],\n  excludeKeys: string[],\n  state: T\n): E {\n  if (keys && keys.length === 0) {\n    return {} as E;\n  }\n\n  let stateSlices = {};\n  for (const currentKey of keys) {\n    const stateValue = getStateSliceValue(currentKey, state);\n    const shell = createShellObject(currentKey, excludeKeys, stateValue);\n    stateSlices = deepMerge(stateSlices, shell);\n  }\n\n  return stateSlices as E;\n}\n\nexport function handleExclusions(\n  key: string,\n  excludeKeys: string[],\n  value: any\n): any {\n  const exclusionKeys = getExclusionKeys(key, excludeKeys);\n  if (exclusionKeys.length === 0) {\n    return value;\n  }\n\n  const finalValue = deepMerge({}, value);\n  for (const currentExclusionKey of exclusionKeys) {\n    const exclusionChunksSplit = currentExclusionKey.split(OBJECT_SEPARATOR);\n\n    let nestedTemp = finalValue;\n    for (let i = 0; i < exclusionChunksSplit.length; i++) {\n      const currentChunk = exclusionChunksSplit[i];\n\n      // last iteration\n      if (i === exclusionChunksSplit.length - 1) {\n        if (nestedTemp && nestedTemp[currentChunk]) {\n          delete nestedTemp[currentChunk];\n        }\n      } else {\n        nestedTemp = nestedTemp[currentChunk];\n      }\n    }\n  }\n\n  return finalValue;\n}\n\nexport function getExclusionKeys(key: string, excludeKeys: string[]): string[] {\n  if (!key || !excludeKeys) {\n    return [];\n  }\n\n  const exclusionKeys: string[] = [];\n  for (const exclusionKey of excludeKeys) {\n    if (exclusionKey.includes(key)) {\n      exclusionKeys.push(exclusionKey);\n    }\n  }\n\n  return exclusionKeys;\n}\n\nexport function filterKeysByType(\n  keys: { [key: string]: StorageSyncType | StateTransferType },\n  type: StorageSyncType | StateTransferType\n): string[] {\n  if (!keys) {\n    return [];\n  }\n  return Object.keys(keys).filter((key) => keys[key] === type);\n}\n","import { ListModel, EntitiesModel } from '../../model/index';\nimport { SearchConfig } from '../../product/model/search-config';\nimport { EntityListState } from './entity-list-state';\nimport { EntityLoaderState } from './entity-loader/entity-loader-state';\nimport { entityLoaderStateSelector } from './entity-loader/entity-loader.selectors';\nimport { LoaderState } from './loader/loader-state';\n\nconst ALL = 'all';\n\nexport function serializeSearchConfig(\n  config: SearchConfig,\n  id?: string\n): string {\n  return `${id ?? ''}?pageSize=${config.pageSize ?? ''}&currentPage=${\n    config.currentPage ?? ''\n  }&sort=${config.sort ?? ''}`;\n}\n\nexport function denormalizeSearch<T>(\n  state: EntityListState<T>,\n  params?: SearchConfig\n): LoaderState<EntitiesModel<T>> {\n  return denormalizeCustomB2BSearch<T>(state.list, state.entities, params);\n}\n\nexport function denormalizeCustomB2BSearch<T>(\n  list: EntityLoaderState<ListModel>,\n  entities: EntityLoaderState<T>,\n  params?: SearchConfig,\n  id?: string\n): LoaderState<EntitiesModel<T>> {\n  const serializedList: any = entityLoaderStateSelector(\n    list,\n    params ? serializeSearchConfig(params, id) : id ?? ALL\n  );\n  if (!serializedList.value || !serializedList.value.ids) {\n    return serializedList;\n  }\n  const res: LoaderState<EntitiesModel<T>> = Object.assign({}, serializedList, {\n    value: {\n      values: serializedList.value.ids.map(\n        (code) => entityLoaderStateSelector(entities, code).value\n      ),\n    },\n  });\n  if (params) {\n    res.value.pagination = serializedList.value.pagination;\n    res.value.sorts = serializedList.value.sorts;\n  }\n  return res;\n}\n\nexport function normalizeListPage<T>(\n  list: EntitiesModel<T>,\n  id: string\n): { values: T[]; page: ListModel } {\n  const values = list?.values || [];\n  const page: ListModel = {\n    ids: values.map((data) => data[id]),\n  };\n  if (list.pagination) {\n    page.pagination = list.pagination;\n  }\n  if (list.sorts) {\n    page.sorts = list.sorts;\n  }\n  return { values, page };\n}\n\nexport function serializeParams(\n  params: string | string[],\n  searchConfig: SearchConfig\n): string {\n  return [params, serializeSearchConfig(searchConfig)].toString();\n}\n","import { AnonymousConsent, ConsentTemplate } from '../../model/consent.model';\nimport { StateUtils } from '../../state';\n\nexport const ANONYMOUS_CONSENTS_STORE_FEATURE = 'anonymous-consents';\nexport const ANONYMOUS_CONSENTS = '[Anonymous Consents] Anonymous Consents';\n\nexport interface StateWithAnonymousConsents {\n  [ANONYMOUS_CONSENTS_STORE_FEATURE]: AnonymousConsentsState;\n}\n\nexport interface AnonymousConsentsState {\n  templates: StateUtils.LoaderState<ConsentTemplate[]>;\n  consents: AnonymousConsent[];\n  ui: {\n    bannerDismissed: boolean;\n    updated: boolean;\n  };\n}\n","import {\n  AnonymousConsent,\n  ConsentTemplate,\n} from '../../../model/consent.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { ANONYMOUS_CONSENTS } from '../anonymous-consents-state';\n\nexport const LOAD_ANONYMOUS_CONSENT_TEMPLATES =\n  '[Anonymous Consents] Load Anonymous Consent Templates';\nexport const LOAD_ANONYMOUS_CONSENT_TEMPLATES_SUCCESS =\n  '[Anonymous Consents] Load Anonymous Consent Templates Success';\nexport const LOAD_ANONYMOUS_CONSENT_TEMPLATES_FAIL =\n  '[Anonymous Consents] Load Anonymous Consent Templates Fail';\nexport const RESET_LOAD_ANONYMOUS_CONSENT_TEMPLATES =\n  '[Anonymous Consents] Reset Load Anonymous Consent Templates';\n\nexport const GET_ALL_ANONYMOUS_CONSENTS =\n  '[Anonymous Consents] Get All Anonymous Consents';\nexport const GET_ANONYMOUS_CONSENT =\n  '[Anonymous Consents] Get Anonymous Consent';\nexport const SET_ANONYMOUS_CONSENTS =\n  '[Anonymous Consents] Set Anonymous Consents';\nexport const GIVE_ANONYMOUS_CONSENT =\n  '[Anonymous Consents] Give Anonymous Consent';\nexport const WITHDRAW_ANONYMOUS_CONSENT =\n  '[Anonymous Consents] Withdraw Anonymous Consent';\n\nexport const TOGGLE_ANONYMOUS_CONSENTS_BANNER_DISMISSED =\n  '[Anonymous Consents] Toggle Anonymous Consents Banner Dismissed';\nexport const TOGGLE_ANONYMOUS_CONSENT_TEMPLATES_UPDATED =\n  '[Anonymous Consents] Anonymous Consent Templates Updated';\nexport const ANONYMOUS_CONSENT_CHECK_UPDATED_VERSIONS =\n  '[Anonymous Consents] Check Updated Versions';\n\nexport class LoadAnonymousConsentTemplates extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_ANONYMOUS_CONSENT_TEMPLATES;\n  constructor() {\n    super(ANONYMOUS_CONSENTS);\n  }\n}\n\nexport class LoadAnonymousConsentTemplatesSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_ANONYMOUS_CONSENT_TEMPLATES_SUCCESS;\n  constructor(public payload: ConsentTemplate[]) {\n    super(ANONYMOUS_CONSENTS);\n  }\n}\nexport class LoadAnonymousConsentTemplatesFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_ANONYMOUS_CONSENT_TEMPLATES_FAIL;\n  constructor(payload: any) {\n    super(ANONYMOUS_CONSENTS, payload);\n  }\n}\n\nexport class ResetLoadAnonymousConsentTemplates extends StateUtils.LoaderResetAction {\n  readonly type = RESET_LOAD_ANONYMOUS_CONSENT_TEMPLATES;\n  constructor() {\n    super(ANONYMOUS_CONSENTS);\n  }\n}\n\nexport class GetAllAnonymousConsents {\n  readonly type = GET_ALL_ANONYMOUS_CONSENTS;\n  constructor() {}\n}\n\nexport class GetAnonymousConsent {\n  readonly type = GET_ANONYMOUS_CONSENT;\n  constructor(public templateCode: string) {}\n}\n\nexport class SetAnonymousConsents {\n  readonly type = SET_ANONYMOUS_CONSENTS;\n  constructor(public payload: AnonymousConsent[]) {}\n}\n\nexport class GiveAnonymousConsent {\n  readonly type = GIVE_ANONYMOUS_CONSENT;\n  constructor(public templateCode: string) {}\n}\n\nexport class WithdrawAnonymousConsent {\n  readonly type = WITHDRAW_ANONYMOUS_CONSENT;\n  constructor(public templateCode: string) {}\n}\n\nexport class ToggleAnonymousConsentsBannerDissmissed {\n  readonly type = TOGGLE_ANONYMOUS_CONSENTS_BANNER_DISMISSED;\n  constructor(public dismissed: boolean) {}\n}\n\nexport class ToggleAnonymousConsentTemplatesUpdated {\n  readonly type = TOGGLE_ANONYMOUS_CONSENT_TEMPLATES_UPDATED;\n  constructor(public updated: boolean) {}\n}\n\nexport class AnonymousConsentCheckUpdatedVersions {\n  readonly type = ANONYMOUS_CONSENT_CHECK_UPDATED_VERSIONS;\n  constructor() {}\n}\n\nexport type AnonymousConsentsActions =\n  | LoadAnonymousConsentTemplates\n  | LoadAnonymousConsentTemplatesSuccess\n  | LoadAnonymousConsentTemplatesFail\n  | ResetLoadAnonymousConsentTemplates\n  | GetAllAnonymousConsents\n  | SetAnonymousConsents\n  | GetAnonymousConsent\n  | GiveAnonymousConsent\n  | WithdrawAnonymousConsent\n  | ToggleAnonymousConsentsBannerDissmissed\n  | ToggleAnonymousConsentTemplatesUpdated\n  | AnonymousConsentCheckUpdatedVersions;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  AnonymousConsentsState,\n  ANONYMOUS_CONSENTS_STORE_FEATURE,\n  StateWithAnonymousConsents,\n} from '../anonymous-consents-state';\n\nexport const getAnonymousConsentState: MemoizedSelector<\n  StateWithAnonymousConsents,\n  AnonymousConsentsState\n> = createFeatureSelector<AnonymousConsentsState>(\n  ANONYMOUS_CONSENTS_STORE_FEATURE\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithAnonymousConsents } from '../anonymous-consents-state';\nimport { getAnonymousConsentState } from './feature.selector';\n\nexport const getAnonymousConsentTemplatesState: MemoizedSelector<\n  StateWithAnonymousConsents,\n  LoaderState<ConsentTemplate[]>\n> = createSelector(getAnonymousConsentState, (state) => state.templates);\n\nexport const getAnonymousConsentTemplatesValue: MemoizedSelector<\n  StateWithAnonymousConsents,\n  ConsentTemplate[]\n> = createSelector(\n  getAnonymousConsentTemplatesState,\n  StateUtils.loaderValueSelector\n);\n\nexport const getAnonymousConsentTemplatesLoading: MemoizedSelector<\n  StateWithAnonymousConsents,\n  boolean\n> = createSelector(\n  getAnonymousConsentTemplatesState,\n  StateUtils.loaderLoadingSelector\n);\n\nexport const getAnonymousConsentTemplatesSuccess: MemoizedSelector<\n  StateWithAnonymousConsents,\n  boolean\n> = createSelector(\n  getAnonymousConsentTemplatesState,\n  StateUtils.loaderSuccessSelector\n);\n\nexport const getAnonymousConsentTemplatesError: MemoizedSelector<\n  StateWithAnonymousConsents,\n  boolean\n> = createSelector(\n  getAnonymousConsentTemplatesState,\n  StateUtils.loaderErrorSelector\n);\n\nexport const getAnonymousConsentTemplate = (\n  templateCode: string\n): MemoizedSelector<StateWithAnonymousConsents, ConsentTemplate> => {\n  return createSelector(getAnonymousConsentTemplatesValue, (templates) => {\n    return templates\n      ? templates.find((template) => template.id === templateCode)\n      : null;\n  });\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateWithAnonymousConsents } from '../anonymous-consents-state';\nimport { getAnonymousConsentState } from './feature.selector';\n\nexport const getAnonymousConsentTemplatesUpdate: MemoizedSelector<\n  StateWithAnonymousConsents,\n  boolean\n> = createSelector(getAnonymousConsentState, (state) => state.ui.updated);\n\nexport const getAnonymousConsentsBannerDismissed: MemoizedSelector<\n  StateWithAnonymousConsents,\n  boolean\n> = createSelector(\n  getAnonymousConsentState,\n  (state) => state.ui.bannerDismissed\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { AnonymousConsent } from '../../../model/consent.model';\nimport { StateWithAnonymousConsents } from '../anonymous-consents-state';\nimport { getAnonymousConsentState } from './feature.selector';\n\nexport const getAnonymousConsents: MemoizedSelector<\n  StateWithAnonymousConsents,\n  AnonymousConsent[]\n> = createSelector(getAnonymousConsentState, (state) => state.consents);\n\nexport const getAnonymousConsentByTemplateCode = (\n  templateCode: string\n): MemoizedSelector<StateWithAnonymousConsents, AnonymousConsent> =>\n  createSelector(getAnonymousConsents, (consents) =>\n    consents.find((consent) => consent.templateCode === templateCode)\n  );\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, iif, Observable } from 'rxjs';\nimport { filter, map, switchMap, tap, withLatestFrom } from 'rxjs/operators';\nimport { AuthService } from '../../auth/user-auth/facade/auth.service';\nimport {\n  AnonymousConsent,\n  ANONYMOUS_CONSENT_STATUS,\n  ConsentTemplate,\n} from '../../model/index';\nimport { AnonymousConsentsActions } from '../store/actions/index';\nimport { StateWithAnonymousConsents } from '../store/anonymous-consents-state';\nimport { AnonymousConsentsSelectors } from '../store/selectors/index';\n\n@Injectable({ providedIn: 'root' })\nexport class AnonymousConsentsService {\n  constructor(\n    protected store: Store<StateWithAnonymousConsents>,\n    protected authService: AuthService\n  ) {}\n\n  /**\n   * Retrieves the anonymous consent templates.\n   */\n  loadTemplates(): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.LoadAnonymousConsentTemplates()\n    );\n  }\n\n  /**\n   * Conditionally triggers the load of the anonymous consent templates if:\n   *   - `loadIfMissing` parameter is set to `true`\n   *   - the `templates` in the store are `undefined`\n   *\n   * Otherwise it just returns the value from the store.\n   *\n   * @param loadIfMissing setting to `true` will trigger the load of the templates if the currently stored templates are `undefined`\n   */\n  getTemplates(loadIfMissing = false): Observable<ConsentTemplate[]> {\n    return iif(\n      () => loadIfMissing,\n      this.store.pipe(\n        select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesValue),\n        withLatestFrom(this.getLoadTemplatesLoading()),\n        filter(([_templates, loading]) => !loading),\n        tap(([templates, _loading]) => {\n          if (!Boolean(templates)) {\n            this.loadTemplates();\n          }\n        }),\n        filter(([templates, _loading]) => Boolean(templates)),\n        map(([templates, _loading]) => templates)\n      ),\n      this.store.pipe(\n        select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesValue)\n      )\n    );\n  }\n\n  /**\n   * Returns the anonymous consent templates with the given template code.\n   * @param templateCode a template code by which to filter anonymous consent templates.\n   */\n  getTemplate(templateCode: string): Observable<ConsentTemplate> {\n    return this.store.pipe(\n      select(\n        AnonymousConsentsSelectors.getAnonymousConsentTemplate(templateCode)\n      )\n    );\n  }\n\n  /**\n   * Returns an indicator for the loading status for the anonymous consent templates.\n   */\n  getLoadTemplatesLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesLoading)\n    );\n  }\n\n  /**\n   * Returns an indicator for the success status for the anonymous consent templates.\n   */\n  getLoadTemplatesSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesSuccess)\n    );\n  }\n\n  /**\n   * Returns an indicator for the error status for the anonymous consent templates.\n   */\n  getLoadTemplatesError(): Observable<boolean> {\n    return this.store.pipe(\n      select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesError)\n    );\n  }\n\n  /**\n   * Resets the loading, success and error indicators for the anonymous consent templates.\n   */\n  resetLoadTemplatesState(): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.ResetLoadAnonymousConsentTemplates()\n    );\n  }\n\n  /**\n   * Returns all the anonymous consents.\n   */\n  getConsents(): Observable<AnonymousConsent[]> {\n    return this.store.pipe(\n      select(AnonymousConsentsSelectors.getAnonymousConsents)\n    );\n  }\n\n  /**\n   * Puts the provided anonymous consents into the store.\n   */\n  setConsents(consents: AnonymousConsent[]): void {\n    return this.store.dispatch(\n      new AnonymousConsentsActions.SetAnonymousConsents(consents)\n    );\n  }\n\n  /**\n   * Returns the anonymous consent for the given template ID.\n   *\n   * As a side-effect, the method will call `getTemplates(true)` to load the templates if those are not present.\n   *\n   * @param templateId a template ID by which to filter anonymous consent templates.\n   */\n  getConsent(templateId: string): Observable<AnonymousConsent> {\n    return this.authService.isUserLoggedIn().pipe(\n      filter((authenticated) => !authenticated),\n      tap(() => this.getTemplates(true)),\n      switchMap(() =>\n        this.store.pipe(\n          select(\n            AnonymousConsentsSelectors.getAnonymousConsentByTemplateCode(\n              templateId\n            )\n          )\n        )\n      )\n    );\n  }\n\n  /**\n   * Give a consent for the given `templateCode`\n   * @param templateCode for which to give the consent\n   */\n  giveConsent(templateCode: string): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.GiveAnonymousConsent(templateCode)\n    );\n  }\n\n  /**\n   * Sets all the anonymous consents' state to given.\n   */\n  giveAllConsents(): Observable<ConsentTemplate[]> {\n    return this.getTemplates(true).pipe(\n      tap((templates) =>\n        templates.forEach((template) => this.giveConsent(template.id))\n      )\n    );\n  }\n\n  /**\n   * Returns `true` if the provided `consent` is given.\n   * @param consent a consent to test\n   */\n  isConsentGiven(consent: AnonymousConsent): boolean {\n    return consent && consent.consentState === ANONYMOUS_CONSENT_STATUS.GIVEN;\n  }\n\n  /**\n   * Withdraw a consent for the given `templateCode`\n   * @param templateCode for which to withdraw the consent\n   */\n  withdrawConsent(templateCode: string): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.WithdrawAnonymousConsent(templateCode)\n    );\n  }\n\n  /**\n   * Sets all the anonymous consents' state to withdrawn.\n   */\n  withdrawAllConsents(): Observable<ConsentTemplate[]> {\n    return this.getTemplates(true).pipe(\n      tap((templates) =>\n        templates.forEach((template) => this.withdrawConsent(template.id))\n      )\n    );\n  }\n\n  /**\n   * Returns `true` if the provided `consent` is withdrawn.\n   * @param consent a consent to test\n   */\n  isConsentWithdrawn(consent: AnonymousConsent): boolean {\n    return (\n      consent && consent.consentState === ANONYMOUS_CONSENT_STATUS.WITHDRAWN\n    );\n  }\n\n  /**\n   * Toggles the dismissed state of the anonymous consents banner.\n   * @param dismissed the banner will be dismissed if `true` is passed, otherwise it will be visible.\n   */\n  toggleBannerDismissed(dismissed: boolean): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.ToggleAnonymousConsentsBannerDissmissed(\n        dismissed\n      )\n    );\n    if (dismissed) {\n      this.toggleTemplatesUpdated(false);\n    }\n  }\n\n  /**\n   * Returns `true` if the banner was dismissed, `false` otherwise.\n   */\n  isBannerDismissed(): Observable<boolean> {\n    return this.store.pipe(\n      select(AnonymousConsentsSelectors.getAnonymousConsentsBannerDismissed)\n    );\n  }\n\n  /**\n   * Returns `true` if the consent templates were updated on the back-end.\n   * If the templates are not present in the store, it triggers the load.\n   */\n  getTemplatesUpdated(): Observable<boolean> {\n    return this.getTemplates(true).pipe(\n      switchMap(() =>\n        this.store.pipe(\n          select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesUpdate)\n        )\n      )\n    );\n  }\n\n  /**\n   * Toggles the `updated` slice of the state\n   * @param updated\n   */\n  toggleTemplatesUpdated(updated: boolean): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.ToggleAnonymousConsentTemplatesUpdated(\n        updated\n      )\n    );\n  }\n\n  /**\n   * Returns `true` if either the banner is not dismissed or if the templates were updated on the back-end.\n   * Otherwise, it returns `false`.\n   */\n  isBannerVisible(): Observable<boolean> {\n    return combineLatest([\n      this.isBannerDismissed(),\n      this.getTemplatesUpdated(),\n    ]).pipe(\n      tap(() => this.checkConsentVersions()),\n      map(([dismissed, updated]) => !dismissed || updated)\n    );\n  }\n\n  /**\n   * Dispatches an action to trigger the check\n   * whether the anonymous consent version have been updated\n   */\n  private checkConsentVersions(): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.AnonymousConsentCheckUpdatedVersions()\n    );\n  }\n\n  /**\n   * Returns `true` if there's a mismatch in template versions between the provided `currentTemplates` and `newTemplates`\n   * @param currentTemplates current templates to check\n   * @param newTemplates new templates to check\n   */\n  detectUpdatedTemplates(\n    currentTemplates: ConsentTemplate[],\n    newTemplates: ConsentTemplate[]\n  ): boolean {\n    if (newTemplates.length !== currentTemplates.length) {\n      return true;\n    }\n\n    for (let i = 0; i < newTemplates.length; i++) {\n      const newTemplate = newTemplates[i];\n      const currentTemplate = currentTemplates[i];\n      if (newTemplate.version !== currentTemplate.version) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Serializes using `JSON.stringify()` and encodes using `encodeURIComponent()` methods\n   * @param consents to serialize and encode\n   */\n  serializeAndEncode(consents: AnonymousConsent[]): string {\n    if (!consents) {\n      return '';\n    }\n    const serialized = JSON.stringify(consents);\n    const encoded = encodeURIComponent(serialized);\n    return encoded;\n  }\n\n  /**\n   * Decodes using `decodeURIComponent()` and deserializes using `JSON.parse()`\n   * @param rawConsents to decode an deserialize\n   */\n  decodeAndDeserialize(rawConsents: string): AnonymousConsent[] {\n    const decoded = decodeURIComponent(rawConsents);\n    const unserialized = JSON.parse(decoded) as AnonymousConsent[];\n    return unserialized;\n  }\n\n  /**\n   *\n   * Compares the given `newConsents` and `previousConsents` and returns `true` if there are differences (the `newConsents` are updates).\n   * Otherwise it returns `false`.\n   *\n   * @param newConsents new consents to compare\n   * @param previousConsents old consents to compare\n   */\n  consentsUpdated(\n    newConsents: AnonymousConsent[],\n    previousConsents: AnonymousConsent[]\n  ): boolean {\n    const newRawConsents = this.serializeAndEncode(newConsents);\n    const previousRawConsents = this.serializeAndEncode(previousConsents);\n    return newRawConsents !== previousRawConsents;\n  }\n}\n","export class DynamicTemplate {\n  static resolve(templateString: string, templateVariables: Object) {\n    for (const variableLabel of Object.keys(templateVariables)) {\n      const placeholder = new RegExp('\\\\${' + variableLabel + '}', 'g');\n      templateString = templateString.replace(\n        placeholder,\n        templateVariables[variableLabel]\n      );\n    }\n    return templateString;\n  }\n}\n","import { SiteContextConfig } from './site-context-config';\n\n/**\n * Helper function for safely getting context parameter config\n *\n * @param config\n * @param parameter\n */\nexport function getContextParameterValues(\n  config: SiteContextConfig,\n  parameter: string\n): string[] {\n  return (config.context && config.context[parameter]) || [];\n}\n\n/**\n * Helper function for calculating default value for context parameter from config\n *\n * @param config\n * @param parameter\n */\nexport function getContextParameterDefault(\n  config: SiteContextConfig,\n  parameter: string\n): string {\n  const param = getContextParameterValues(config, parameter);\n  return param && param.length ? param[0] : undefined;\n}\n","export const LANGUAGE_CONTEXT_ID = 'language';\nexport const CURRENCY_CONTEXT_ID = 'currency';\nexport const BASE_SITE_CONTEXT_ID = 'baseSite';\n","import { Action } from '@ngrx/store';\nimport { BaseSite } from '../../../model/misc.model';\n\nexport const LOAD_BASE_SITE = '[Site-context] Load BaseSite';\nexport const LOAD_BASE_SITE_FAIL = '[Site-context] Load BaseSite Fail';\nexport const LOAD_BASE_SITE_SUCCESS = '[Site-context] Load BaseSite Success';\n\nexport const LOAD_BASE_SITES = '[Site-context] Load BaseSites';\nexport const LOAD_BASE_SITES_FAIL = '[Site-context] Load BaseSites Fail';\nexport const LOAD_BASE_SITES_SUCCESS = '[Site-context] Load BaseSites Success';\n\nexport const SET_ACTIVE_BASE_SITE = '[Site-context] Set Active BaseSite';\nexport const BASE_SITE_CHANGE = '[Site-context] BaseSite Change';\n\nexport class LoadBaseSite implements Action {\n  readonly type = LOAD_BASE_SITE;\n}\n\nexport class LoadBaseSiteFail implements Action {\n  readonly type = LOAD_BASE_SITE_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadBaseSiteSuccess implements Action {\n  readonly type = LOAD_BASE_SITE_SUCCESS;\n  constructor(public payload: BaseSite) {}\n}\n\nexport class LoadBaseSites implements Action {\n  readonly type = LOAD_BASE_SITES;\n}\n\nexport class LoadBaseSitesFail implements Action {\n  readonly type = LOAD_BASE_SITES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadBaseSitesSuccess implements Action {\n  readonly type = LOAD_BASE_SITES_SUCCESS;\n  constructor(public payload: BaseSite[]) {}\n}\n\nexport class SetActiveBaseSite implements Action {\n  readonly type = SET_ACTIVE_BASE_SITE;\n  constructor(public payload: string) {}\n}\n\nexport class BaseSiteChange implements Action {\n  readonly type = BASE_SITE_CHANGE;\n}\n\n// action types\nexport type BaseSiteAction =\n  | LoadBaseSite\n  | LoadBaseSiteFail\n  | LoadBaseSiteSuccess\n  | LoadBaseSites\n  | LoadBaseSitesFail\n  | LoadBaseSitesSuccess\n  | SetActiveBaseSite\n  | BaseSiteChange;\n","import { Action } from '@ngrx/store';\nimport { Currency } from '../../../model/misc.model';\n\nexport const LOAD_CURRENCIES = '[Site-context] Load Currencies';\nexport const LOAD_CURRENCIES_FAIL = '[Site-context] Load Currencies Fail';\nexport const LOAD_CURRENCIES_SUCCESS = '[Site-context] Load Currencies Success';\nexport const SET_ACTIVE_CURRENCY = '[Site-context] Set Active Currency';\nexport const CURRENCY_CHANGE = '[Site-context] Currency Change';\n\nexport class LoadCurrencies implements Action {\n  readonly type = LOAD_CURRENCIES;\n}\n\nexport class LoadCurrenciesFail implements Action {\n  readonly type = LOAD_CURRENCIES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadCurrenciesSuccess implements Action {\n  readonly type = LOAD_CURRENCIES_SUCCESS;\n  constructor(public payload: Currency[]) {}\n}\n\nexport class SetActiveCurrency implements Action {\n  readonly type = SET_ACTIVE_CURRENCY;\n  constructor(public payload: string) {}\n}\n\nexport class CurrencyChange implements Action {\n  readonly type = CURRENCY_CHANGE;\n  constructor(public payload: { previous: string; current: string }) {}\n}\n\n// action types\nexport type CurrenciesAction =\n  | LoadCurrencies\n  | LoadCurrenciesFail\n  | LoadCurrenciesSuccess\n  | SetActiveCurrency\n  | CurrencyChange;\n","import { Action } from '@ngrx/store';\nimport { Language } from '../../../model/misc.model';\n\nexport const LOAD_LANGUAGES = '[Site-context] Load Languages';\nexport const LOAD_LANGUAGES_FAIL = '[Site-context] Load Languages Fail';\nexport const LOAD_LANGUAGES_SUCCESS = '[Site-context] Load Languages Success';\nexport const SET_ACTIVE_LANGUAGE = '[Site-context] Set Active Language';\nexport const LANGUAGE_CHANGE = '[Site-context] Language Change';\n\nexport class LoadLanguages implements Action {\n  readonly type = LOAD_LANGUAGES;\n}\n\nexport class LoadLanguagesFail implements Action {\n  readonly type = LOAD_LANGUAGES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadLanguagesSuccess implements Action {\n  readonly type = LOAD_LANGUAGES_SUCCESS;\n  constructor(public payload: Language[]) {}\n}\n\nexport class SetActiveLanguage implements Action {\n  readonly type = SET_ACTIVE_LANGUAGE;\n  constructor(public payload: string) {}\n}\n\nexport class LanguageChange implements Action {\n  readonly type = LANGUAGE_CHANGE;\n  constructor(public payload: { previous: string; current: string }) {}\n}\n\n// action types\nexport type LanguagesAction =\n  | LoadLanguages\n  | LoadLanguagesFail\n  | LoadLanguagesSuccess\n  | SetActiveLanguage\n  | LanguageChange;\n","import { BaseSite, Currency, Language } from '../../model/misc.model';\nexport const SITE_CONTEXT_FEATURE = 'siteContext';\n\nexport interface StateWithSiteContext {\n  [SITE_CONTEXT_FEATURE]: SiteContextState;\n}\n\nexport interface SiteContextState {\n  languages: LanguagesState;\n  currencies: CurrenciesState;\n  baseSite: BaseSiteState;\n}\n\nexport interface CurrencyEntities {\n  [isocode: string]: Currency;\n}\n\nexport interface CurrenciesState {\n  entities: CurrencyEntities;\n  activeCurrency: string;\n}\nexport interface LanguagesEntities {\n  [isocode: string]: Language;\n}\n\nexport interface LanguagesState {\n  entities: LanguagesEntities;\n  activeLanguage: string;\n}\n\nexport interface BaseSiteState {\n  entities: BaseSiteEntities;\n  activeSite: string;\n  details: BaseSite;\n}\n\nexport interface BaseSiteEntities {\n  [uid: string]: BaseSite;\n}\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  SiteContextState,\n  SITE_CONTEXT_FEATURE,\n  StateWithSiteContext,\n} from '../state';\n\nexport const getSiteContextState: MemoizedSelector<\n  StateWithSiteContext,\n  SiteContextState\n> = createFeatureSelector<SiteContextState>(SITE_CONTEXT_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { BaseSite } from '../../../model/misc.model';\nimport {\n  BaseSiteEntities,\n  BaseSiteState,\n  SiteContextState,\n  StateWithSiteContext,\n} from '../state';\nimport { getSiteContextState } from './site-context.selector';\n\nconst sitesEntitiesSelector = (state: BaseSiteState) => state.entities;\n\nexport const getBaseSiteState: MemoizedSelector<\n  StateWithSiteContext,\n  BaseSiteState\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) => state.baseSite\n);\n\nexport const getActiveBaseSite: MemoizedSelector<\n  StateWithSiteContext,\n  string\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) =>\n    state && state.baseSite && state.baseSite.activeSite\n);\n\nexport const getBaseSiteData: MemoizedSelector<\n  StateWithSiteContext,\n  BaseSite\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) => state && state.baseSite && state.baseSite.details\n);\n\nexport const getBaseSitesEntities: MemoizedSelector<\n  StateWithSiteContext,\n  BaseSiteEntities\n> = createSelector(getBaseSiteState, sitesEntitiesSelector);\n\nexport const getAllBaseSites: MemoizedSelector<\n  StateWithSiteContext,\n  BaseSite[]\n> = createSelector(getBaseSitesEntities, (entities) => {\n  return entities ? Object.keys(entities).map((uid) => entities[uid]) : null;\n});\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Currency } from '../../../model/misc.model';\nimport {\n  CurrenciesState,\n  CurrencyEntities,\n  SiteContextState,\n  StateWithSiteContext,\n} from '../state';\nimport { getSiteContextState } from './site-context.selector';\n\nconst currenciesEntitiesSelector = (state: CurrenciesState) => state.entities;\nconst activeCurrencySelector = (state: CurrenciesState) => state.activeCurrency;\n\nexport const getCurrenciesState: MemoizedSelector<\n  StateWithSiteContext,\n  CurrenciesState\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) => state.currencies\n);\n\nexport const getCurrenciesEntities: MemoizedSelector<\n  StateWithSiteContext,\n  CurrencyEntities\n> = createSelector(getCurrenciesState, currenciesEntitiesSelector);\n\nexport const getActiveCurrency: MemoizedSelector<\n  StateWithSiteContext,\n  string\n> = createSelector(getCurrenciesState, activeCurrencySelector);\n\nexport const getAllCurrencies: MemoizedSelector<\n  StateWithSiteContext,\n  Currency[]\n> = createSelector(getCurrenciesEntities, (entities) => {\n  return entities\n    ? Object.keys(entities).map((isocode) => entities[isocode])\n    : null;\n});\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Language } from '../../../model/misc.model';\nimport {\n  LanguagesEntities,\n  LanguagesState,\n  SiteContextState,\n  StateWithSiteContext,\n} from '../state';\nimport { getSiteContextState } from './site-context.selector';\n\nconst activeLanguageSelector = (state: LanguagesState) => state.activeLanguage;\nconst languagesEntitiesSelector = (state: LanguagesState) => state.entities;\n\nexport const getLanguagesState: MemoizedSelector<\n  StateWithSiteContext,\n  LanguagesState\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) => state.languages\n);\n\nexport const getLanguagesEntities: MemoizedSelector<\n  StateWithSiteContext,\n  LanguagesEntities\n> = createSelector(getLanguagesState, languagesEntitiesSelector);\n\nexport const getActiveLanguage: MemoizedSelector<\n  StateWithSiteContext,\n  string\n> = createSelector(getLanguagesState, activeLanguageSelector);\n\nexport const getAllLanguages: MemoizedSelector<\n  StateWithSiteContext,\n  Language[]\n> = createSelector(getLanguagesEntities, (entities) => {\n  return entities\n    ? Object.keys(entities).map((isocode) => entities[isocode])\n    : null;\n});\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, map, switchMap, take, tap } from 'rxjs/operators';\nimport { BaseSite } from '../../model/misc.model';\nimport { getContextParameterDefault } from '../config/context-config-utils';\nimport { SiteContextConfig } from '../config/site-context-config';\nimport { BASE_SITE_CONTEXT_ID } from '../providers/context-ids';\nimport { SiteContextActions } from '../store/actions/index';\nimport { SiteContextSelectors } from '../store/selectors/index';\nimport { StateWithSiteContext } from '../store/state';\nimport { SiteContext } from './site-context.interface';\n\n@Injectable()\nexport class BaseSiteService implements SiteContext<BaseSite> {\n  constructor(\n    protected store: Store<StateWithSiteContext>,\n    protected config: SiteContextConfig\n  ) {}\n\n  /**\n   * Represents the current baseSite uid.\n   */\n  getActive(): Observable<string> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getActiveBaseSite),\n      filter((active) => Boolean(active))\n    );\n  }\n\n  /**\n   * Get all base sites data\n   */\n  getAll(): Observable<BaseSite[]> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getAllBaseSites),\n      tap((sites) => {\n        if (!sites) {\n          this.store.dispatch(new SiteContextActions.LoadBaseSites());\n        }\n      }),\n      filter((sites) => Boolean(sites))\n    );\n  }\n\n  /**\n   * Get base site data based on site uid\n   */\n  get(siteUid?: string): Observable<BaseSite> {\n    if (siteUid) {\n      return this.getAll().pipe(\n        map((sites) => sites.find((site) => site.uid === siteUid))\n      );\n    }\n\n    return this.getActive().pipe(\n      switchMap((activeSiteUid) =>\n        this.getAll().pipe(\n          map((sites) => sites.find((site) => site.uid === activeSiteUid))\n        )\n      )\n    );\n  }\n\n  setActive(baseSite: string): void {\n    this.store\n      .pipe(select(SiteContextSelectors.getActiveBaseSite), take(1))\n      .subscribe((activeBaseSite) => {\n        if (baseSite && activeBaseSite !== baseSite) {\n          this.store.dispatch(\n            new SiteContextActions.SetActiveBaseSite(baseSite)\n          );\n        }\n      });\n  }\n\n  /**\n   * Initializes the active baseSite.\n   */\n  initialize(): void {\n    let value;\n    this.getActive()\n      .subscribe((val) => (value = val))\n      .unsubscribe();\n    if (value) {\n      // don't initialize, if there is already a value (i.e. retrieved from route or transferred from SSR)\n      return;\n    }\n\n    this.setActive(\n      getContextParameterDefault(this.config, BASE_SITE_CONTEXT_ID)\n    );\n  }\n}\n","/**\n * Angular uses the native encodeURIComponent function,\n * but then un-encoded some characters that are allowed\n * to be part of the query according to IETF RFC 3986.\n * So, to make these characters still encoded, this encoder only\n * uses the encodeURIComponent.\n */\nimport { HttpParameterCodec } from '@angular/common/http';\n\nexport class HttpParamsURIEncoder implements HttpParameterCodec {\n  encodeKey(key: string): string {\n    return encodeURIComponent(key);\n  }\n\n  encodeValue(value: string): string {\n    return encodeURIComponent(value);\n  }\n\n  decodeKey(key: string): string {\n    return decodeURIComponent(key);\n  }\n\n  decodeValue(value: string): string {\n    return decodeURIComponent(value);\n  }\n}\n","export const DEFAULT_SCOPE = 'default';\n\nexport interface OccEndpoint {\n  default?: string;\n  [scope: string]: string;\n}\n\nexport interface ProductOccEndpoint extends OccEndpoint {\n  list?: string;\n  details?: string;\n  attributes?: string;\n  variants?: string;\n}\n\nexport interface OccEndpoints {\n  /**\n   * Get product details for scope\n   *\n   * @member Object\n   */\n  product?: string | ProductOccEndpoint;\n  /**\n   * Get reviews for a product\n   *\n   * @member {string}\n   */\n  productReviews?: string | OccEndpoint;\n  /**\n   * Get a list of product references\n   *\n   * @member {string}\n   */\n  productReferences?: string | OccEndpoint;\n  /**\n   * Get a list of products and additional data\n   *\n   * @member {string}\n   */\n  productSearch?: string | OccEndpoint;\n  /**\n   * Get a list of available suggestions\n   *\n   * @member {string}\n   */\n  productSuggestions?: string | OccEndpoint;\n  /**\n   * Get CMS component details\n   *\n   * @member {string}\n   */\n  component?: string | OccEndpoint;\n  /**\n   * Get a list of CMS component details\n   *\n   * @member {string}\n   */\n  components?: string | OccEndpoint;\n  /**\n   * Get page data with list of cms content slots\n   *\n   * @member {string}\n   */\n  pages?: string | OccEndpoint;\n  /**\n   * Get page data with list of cms content slots\n   *\n   * @member {string}\n   */\n  page?: string | OccEndpoint;\n  /**\n   * Get all carts\n   *\n   * @member {string} [carts]\n   */\n  carts?: string | OccEndpoint;\n  /**\n   * Get a cart with a given identifier\n   *\n   * @member {string} [cart]\n   */\n  cart?: string | OccEndpoint;\n  /**\n   * Creates or restore a cart for a user\n   *\n   * @member {string} [createCart]\n   */\n  createCart?: string | OccEndpoint;\n  /**\n   * Deletes a cart with a given cart id\n   *\n   * @member {string} [deleteCart]\n   */\n  deleteCart?: string | OccEndpoint;\n  /**\n   * Adds a product to the cart\n   *\n   * @member {string} [addEntries]\n   */\n  addEntries?: string | OccEndpoint;\n  /**\n   * Update quantity and store the details of a cart entry\n   *\n   * @member {string} [updateEntries]\n   */\n  updateEntries?: string | OccEndpoint;\n  /**\n   * Deletes cart entry\n   *\n   * @member {string} [removeEntries]\n   */\n  removeEntries?: string | OccEndpoint;\n  /**\n   * Assign email to cart\n   *\n   * @member {string} [addEmail]\n   */\n  addEmail?: string | OccEndpoint;\n  /**\n   * Get a store location\n   *\n   * @member {string} [page]\n   */\n  store?: string | OccEndpoint;\n  /**\n   * Get a list of store locations\n   *\n   * @member {string} [page]\n   */\n  stores?: string | OccEndpoint;\n  /**\n   * Gets a store location count per country and regions\n   *\n   * @member {string} [page]\n   */\n  storescounts?: string | OccEndpoint;\n  /**\n   * Get a list of available languages\n   *\n   * @member {string}\n   */\n  languages?: string | OccEndpoint;\n  /**\n   * Get a list of available currencies\n   *\n   * @member {string}\n   */\n  currencies?: string | OccEndpoint;\n  /**\n   * Get a list of countries\n   *\n   * @member {string}\n   */\n  countries?: string | OccEndpoint;\n  /**\n   * Fetch the list of regions for the provided country\n   *\n   * @member {string}\n   */\n  regions?: string | OccEndpoint;\n  /**\n   * Titles used for user's personal info.\n   *\n   * @member {string}\n   */\n  titles?: string | OccEndpoint;\n  /**\n   * Get user details\n   *\n   * @member {string}\n   */\n  user?: string | OccEndpoint;\n  /**\n   * Register a new user.\n   *\n   * @member {string}\n   */\n  userRegister?: string | OccEndpoint;\n  /**\n   * Request an email to reset the password\n   *\n   * @member {string}\n   */\n  userForgotPassword?: string | OccEndpoint;\n  /**\n   * Reset the password once the email is recieved.\n   *\n   * @member {string}\n   */\n  userResetPassword?: string | OccEndpoint;\n  /**\n   * Update the user id with which the user authenticates.\n   *\n   * @member {string}\n   */\n  userUpdateLoginId?: string | OccEndpoint;\n  /**\n   * Update the user's password\n   *\n   * @member {string}\n   */\n  userUpdatePassword?: string | OccEndpoint;\n  /**\n   * Payment details root endpoint.\n   *\n   * @member {string}\n   */\n  paymentDetailsAll?: string | OccEndpoint;\n  /**\n   * Endpoint for a specific payment method.\n   *\n   * @member {string}\n   */\n  paymentDetail?: string | OccEndpoint;\n  /**\n   * Endpoint for the list of one user's orders\n   *\n   * @member {string}\n   */\n  orderHistory?: string | OccEndpoint;\n  /**\n   * Endpoint for the details of one user's order\n   *\n   * @member {string}\n   */\n  orderDetail?: string | OccEndpoint;\n  /**\n   * Endpoint for anonymous consent templates\n   *\n   * @member {string}\n   */\n  anonymousConsentTemplates?: string | OccEndpoint;\n  /**\n   * Endpoint for consent templates\n   *\n   * @member {string}\n   */\n  consentTemplates?: string | OccEndpoint;\n  /**\n   * Endpoint for a user's consents\n   *\n   * @member {string}\n   */\n  consents?: string | OccEndpoint;\n  /**\n   * Endpoint for a user's specific previously given consent.\n   *\n   * @member {string}\n   */\n  consentDetail?: string | OccEndpoint;\n  /**\n   * Endpoint for a user's addresses\n   *\n   * @member {string}\n   */\n  addresses?: string | OccEndpoint;\n  /**\n   * Endpoint for a user's specific address\n   *\n   * @member {string}\n   */\n  addressDetail?: string | OccEndpoint;\n  /**\n   * Endpoint for address verification\n   *\n   * @member {string}\n   */\n  addressVerification?: string | OccEndpoint;\n  /**\n   * Endpoint for consignment tracking\n   *\n   * @member {string}\n   */\n  consignmentTracking?: string | OccEndpoint;\n  /**\n   * Endpoint for asm customer search\n   *\n   * @member {string}\n   */\n  asmCustomerSearch?: string | OccEndpoint;\n  /**\n   * Endpoint for cart voucher\n   *\n   * @member {string}\n   */\n  cartVoucher?: string | OccEndpoint;\n  /**\n   * Endpoint for coupons\n   *\n   * @member {string}\n   */\n  customerCoupons?: string | OccEndpoint;\n  /**\n   * Endpoint for claiming coupon\n   *\n   * @member {string}\n   */\n  claimCoupon?: string | OccEndpoint;\n  /**\n   * Endpoint for coupons\n   *\n   * @member {string}\n   */\n  couponNotification?: string | OccEndpoint;\n  /**\n   * Explicitly saves a cart\n   *\n   * @member {string}\n   */\n  saveCart?: string | OccEndpoint;\n  /**\n   * Endpoint for notification preference\n   *\n   * @member {string}\n   */\n  notificationPreference?: string | OccEndpoint;\n  /**\n   * Endpoint for product interests\n   *\n   * @member {string}\n   */\n  productInterests?: string | OccEndpoint;\n  /**\n   * Endpoint for getting product interests\n   *\n   * @member {string}\n   */\n  getProductInterests?: string | OccEndpoint;\n  /**\n   * Endpoint for cancel an order\n   */\n  cancelOrder?: string | OccEndpoint;\n  /**\n   * Endpoint for creating order return request\n   */\n  returnOrder?: string | OccEndpoint;\n  /**\n   * Endpoint for user's order return requests\n   */\n  orderReturns?: string | OccEndpoint;\n  /**\n   * Endpoint for order return request details\n   */\n  orderReturnDetail?: string | OccEndpoint;\n  /**\n   * Endpoint for cancelling return request\n   */\n  cancelReturn?: string | OccEndpoint;\n  /**\n   * Endpoint for set delivery address to cart\n   */\n  setDeliveryAddress?: string | OccEndpoint;\n  /**\n   * Endpoint for place order\n   */\n  placeOrder?: string | OccEndpoint;\n  /**\n   * Endpoint for userGroupOrderApprovalPermission\n   *\n   * @member {string}\n   */\n  budget?: string | OccEndpoint;\n  /**\n   * Endpoint for budgets list\n   *\n   * @member {string}\n   */\n  budgets?: string | OccEndpoint;\n  /**\n   * Endpoint for organizations\n   *\n   * @member {string}\n   */\n  orgUnits?: string | OccEndpoint;\n  /**\n   * Endpoint for organizations list\n   *\n   * @member {string}\n   */\n  orgUnitsAvailable?: string | OccEndpoint;\n  /**\n   * Endpoint for organization units tree\n   *\n   * @member {string}\n   */\n  orgUnitsTree?: string | OccEndpoint;\n  /**\n   * Endpoint for approval processes for organization units\n   *\n   * @member {string}\n   */\n  orgUnitsApprovalProcesses?: string | OccEndpoint;\n  /**\n   * Endpoint for organization\n   *\n   * @member {string}\n   */\n  orgUnit?: string | OccEndpoint;\n  /**\n   * Endpoint for orgUnitUsers:\n   *\n   * @member {string}\n   */\n  orgUnitUsers?: string | OccEndpoint;\n  /**\n   * Endpoint for add orgUnitUserRoles (except approver):\n   *\n   * @member {string}\n   */\n  orgUnitUserRoles?: string | OccEndpoint;\n  /**\n   * Endpoint for remove orgUnitUserRole (except approver):\n   *\n   * @member {string}\n   */\n  orgUnitUserRole?: string | OccEndpoint;\n  /**\n   * Endpoint for add orgUnitApprovers:\n   *\n   * @member {string}\n   */\n  orgUnitApprovers?: string | OccEndpoint;\n  /**\n   * Endpoint for delete orgUnitApprover:\n   *\n   * @member {string}\n   */\n  orgUnitApprover?: string | OccEndpoint;\n  /**\n   * Endpoint for organizational unit addresses\n   *\n   * @member {string}\n   */\n  orgUnitsAddresses?: string | OccEndpoint;\n  /**\n   * Endpoint for organizational unit address\n   *\n   * @member {string}\n   */\n  orgUnitsAddress?: string | OccEndpoint;\n  /**\n   * Endpoint for organizational unit user groups list\n   *\n   * @member {string}\n   */\n  userGroups?: string | OccEndpoint;\n  /**\n   * Endpoint for organizational unit user group\n   *\n   * @member {string}\n   */\n  userGroup?: string | OccEndpoint;\n  /**\n   * Endpoint for costCenter list\n   *\n   * @member {string}\n   */\n  userGroupAvailableOrderApprovalPermissions?: string | OccEndpoint;\n  /**\n   * Endpoint for userGroupAvailableOrderApprovalPermissions list\n   *\n   * @member {string}\n   */\n  userGroupAvailableOrgCustomers?: string | OccEndpoint;\n  /**\n   * Endpoint for userGroupAvailableOrgCustomers list\n   *\n   * @member {string}\n   */\n  userGroupMembers?: string | OccEndpoint;\n  /**\n   * Endpoint for userGroupMembers list\n   *\n   * @member {string}\n   */\n  userGroupMember?: string | OccEndpoint;\n  /**\n   * Endpoint for userGroupMember\n   *\n   * @member {string}\n   */\n  userGroupOrderApprovalPermissions?: string | OccEndpoint;\n  /**\n   * Endpoint for userGroupOrderApprovalPermissions list\n   *\n   * @member {string}\n   */\n  userGroupOrderApprovalPermission?: string | OccEndpoint;\n  /**\n   * Endpoint for userGroupOrderApprovalPermission\n   *\n   * @member {string}\n   */\n  costCenters?: string | OccEndpoint;\n  /**\n   * Endpoint to schedule a replenishment order\n   *\n   * * @member {string}\n   */\n  scheduleReplenishmentOrder?: string | OccEndpoint;\n  /**\n   * * Endpoint for the list of one user's replenishment orders\n   *\n   * * @member {string}\n   */\n  replenishmentOrderHistory?: string | OccEndpoint;\n  /* Endpoint to get a replenishment order details\n   *\n   * * @member {string}\n   */\n  replenishmentOrderDetails?: string | OccEndpoint;\n  /**\n   * Endpoint to get a replenishment order history for a replenishment\n   *\n   * * @member {string}\n   */\n  replenishmentOrderDetailsHistory?: string | OccEndpoint;\n  /**\n   * Endpoint to get a replenishment order history for a replenishment\n   *\n   * * @member {string}\n   */\n  cancelReplenishmentOrder?: string | OccEndpoint;\n  /**\n   * Endpoint for all costCenters\n   *\n   * @member {string}\n   */\n  costCentersAll?: string | OccEndpoint;\n  /**\n   * Endpoint for costCenter\n   *\n   * @member {string}\n   */\n  costCenter?: string | OccEndpoint;\n  /**\n   * Endpoint for budgets assigned to costCenter\n   *\n   * @member {string}\n   */\n  costCenterBudgets?: string | OccEndpoint;\n  /**\n   * Endpoint for budget assigned to costCenter\n   *\n   * @member {string}\n   */\n  costCenterBudget?: string | OccEndpoint;\n  /**\n   * Endpoint for permission list\n   *\n   * @member {string}\n   */\n  permissions?: string | OccEndpoint;\n  /**\n   * Endpoint for permission\n   *\n   * @member {string}\n   */\n  permission?: string | OccEndpoint;\n  /**\n   * Endpoint for order approval permission types\n   *\n   * @member {string}\n   */\n  orderApprovalPermissionTypes?: string | OccEndpoint;\n  /**\n   * Endpoint for organization customers\n   *\n   * @member {string}\n   */\n  b2bUsers?: string | OccEndpoint;\n  /**\n   * Endpoint for organization customer\n   *\n   * @member {string}\n   */\n  b2bUser?: string | OccEndpoint;\n  /**\n   * Endpoint for organization customer approvers\n   *\n   * @member {string}\n   */\n  b2bUserApprovers?: string | OccEndpoint;\n  /**\n   * Endpoint for organization customer approver\n   *\n   * @member {string}\n   */\n  b2bUserApprover?: string | OccEndpoint;\n  /**\n   * Endpoint for organization customer user groups\n   *\n   * @member {string}\n   */\n  b2bUserUserGroups?: string | OccEndpoint;\n  /**\n   * Endpoint for organization customer user group\n   *\n   * @member {string}\n   */\n  b2bUserUserGroup?: string | OccEndpoint;\n  /**\n   * Endpoint for organization customer permissions\n   *\n   * @member {string}\n   */\n  b2bUserPermissions?: string | OccEndpoint;\n  /**\n   * Endpoint for organization customer permission\n   *\n   * @member {string}\n   */\n  b2bUserPermission?: string | OccEndpoint;\n  /**\n   * Endpoint for order approvals\n   *\n   * @member {string}\n   */\n  orderApprovals?: string | OccEndpoint;\n  /**\n   * Endpoint for order approval\n   *\n   * @member {string}\n   */\n  orderApproval?: string | OccEndpoint;\n  /**\n   * Endpoint for order approval decision\n   *\n   * @member {string}\n   */\n  orderApprovalDecision?: string | OccEndpoint;\n  /**\n   * Endpoint for getting all base sites\n   *\n   * @member {string}\n   */\n  baseSites?: string | OccEndpoint;\n  /** Endpoint to returns active cost centers\n   *\n   * @member {string}\n   */\n  getActiveCostCenters?: string | OccEndpoint;\n}\n","import { HttpParams } from '@angular/common/http';\nimport { Injectable, isDevMode, Optional } from '@angular/core';\nimport { DynamicTemplate } from '../../config/utils/dynamic-template';\nimport { getContextParameterDefault } from '../../site-context/config/context-config-utils';\nimport { BaseSiteService } from '../../site-context/facade/base-site.service';\nimport { BASE_SITE_CONTEXT_ID } from '../../site-context/providers/context-ids';\nimport { HttpParamsURIEncoder } from '../../util/http-params-uri.encoder';\nimport { OccConfig } from '../config/occ-config';\nimport { DEFAULT_SCOPE } from '../occ-models/occ-endpoints.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccEndpointsService {\n  private _activeBaseSite: string;\n\n  private get activeBaseSite(): string {\n    return (\n      this._activeBaseSite ??\n      getContextParameterDefault(this.config, BASE_SITE_CONTEXT_ID)\n    );\n  }\n\n  constructor(\n    private config: OccConfig,\n    @Optional() private baseSiteService: BaseSiteService\n  ) {\n    if (this.baseSiteService) {\n      this.baseSiteService\n        .getActive()\n        .subscribe((value) => (this._activeBaseSite = value));\n    }\n  }\n\n  /**\n   * Returns an endpoint starting from the OCC baseUrl (no baseSite)\n   * @param endpoint Endpoint suffix\n   */\n  getRawEndpoint(endpoint: string): string {\n    if (!this.config?.backend?.occ) {\n      return '';\n    }\n    endpoint = this.config.backend.occ.endpoints?.[endpoint];\n\n    if (!endpoint.startsWith('/')) {\n      endpoint = '/' + endpoint;\n    }\n\n    return this.config.backend.occ.baseUrl + endpoint;\n  }\n\n  /**\n   * Returns an endpoint starting from the OCC prefix (no baseSite), i.e. /occ/v2/{endpoint}\n   * Most OCC endpoints are related to a baseSite context and are therefor prefixed\n   * with the baseSite. The `/basesites` endpoint does not relate to a specific baseSite\n   * as it will load all baseSites.\n   *\n   * @param endpoint Endpoint suffix\n   */\n  getOccEndpoint(endpoint: string): string {\n    if (!this.config?.backend?.occ) {\n      return '';\n    }\n    endpoint = this.config.backend.occ.endpoints?.[endpoint];\n\n    if (\n      !endpoint.startsWith('/') &&\n      !this.config.backend.occ.prefix.endsWith('/')\n    ) {\n      endpoint = '/' + endpoint;\n    }\n\n    return (\n      this.config.backend.occ.baseUrl +\n      this.config.backend.occ.prefix +\n      endpoint\n    );\n  }\n\n  /**\n   * Returns base OCC endpoint (baseUrl + prefix + baseSite)\n   */\n  getBaseEndpoint(): string {\n    if (!this.config?.backend?.occ) {\n      return '';\n    }\n\n    return (\n      (this.config.backend.occ.baseUrl || '') +\n      this.config.backend.occ.prefix +\n      this.activeBaseSite\n    );\n  }\n\n  /**\n   * Returns an OCC endpoint including baseUrl and baseSite\n   * @param endpoint Endpoint suffix\n   */\n  getEndpoint(endpoint: string): string {\n    if (!endpoint.startsWith('/')) {\n      endpoint = '/' + endpoint;\n    }\n    return this.getBaseEndpoint() + endpoint;\n  }\n\n  /**\n   * Returns a fully qualified OCC Url (including baseUrl and baseSite)\n   * @param endpoint Name of the OCC endpoint key config\n   * @param urlParams  URL parameters\n   * @param queryParams Query parameters\n   * @param scope\n   */\n  getUrl(\n    endpoint: string,\n    urlParams?: object,\n    queryParams?: object,\n    scope?: string\n  ): string {\n    endpoint = this.getEndpointForScope(endpoint, scope);\n\n    if (urlParams) {\n      Object.keys(urlParams).forEach((key) => {\n        urlParams[key] = encodeURIComponent(urlParams[key]);\n      });\n      endpoint = DynamicTemplate.resolve(endpoint, urlParams);\n    }\n\n    if (queryParams) {\n      let httpParamsOptions = { encoder: new HttpParamsURIEncoder() };\n\n      if (endpoint.includes('?')) {\n        let queryParamsFromEndpoint;\n        [endpoint, queryParamsFromEndpoint] = endpoint.split('?');\n\n        httpParamsOptions = {\n          ...httpParamsOptions,\n          ...{ fromString: queryParamsFromEndpoint },\n        };\n      }\n\n      let httpParams = new HttpParams(httpParamsOptions);\n      Object.keys(queryParams).forEach((key) => {\n        const value = queryParams[key];\n        if (value !== undefined) {\n          if (value === null) {\n            httpParams = httpParams.delete(key);\n          } else {\n            httpParams = httpParams.set(key, value);\n          }\n        }\n      });\n\n      const params = httpParams.toString();\n      if (params.length) {\n        endpoint += '?' + params;\n      }\n    }\n\n    return this.getEndpoint(endpoint);\n  }\n\n  private getEndpointForScope(endpoint: string, scope?: string): string {\n    const endpointsConfig = this.config.backend?.occ?.endpoints;\n    const endpointConfig = endpointsConfig[endpoint];\n\n    if (scope) {\n      if (endpointConfig?.[scope]) {\n        return endpointConfig?.[scope];\n      }\n      if (scope === DEFAULT_SCOPE && typeof endpointConfig === 'string') {\n        return endpointConfig;\n      }\n      if (isDevMode()) {\n        console.warn(\n          `${endpoint} endpoint configuration missing for scope \"${scope}\"`\n        );\n      }\n    }\n\n    return (\n      (typeof endpointConfig === 'string'\n        ? endpointConfig\n        : endpointConfig?.[DEFAULT_SCOPE]) || endpoint\n    );\n  }\n}\n","import { HttpHeaders, HttpRequest } from '@angular/common/http';\n\nexport const USE_CLIENT_TOKEN = 'cx-use-client-token';\nexport const USE_CUSTOMER_SUPPORT_AGENT_TOKEN = 'cx-use-csagent-token';\n\nexport class InterceptorUtil {\n  static createHeader<T>(\n    headerName: string,\n    interceptorParam: T,\n    headers?: HttpHeaders\n  ): HttpHeaders {\n    if (headers) {\n      return headers.append(headerName, JSON.stringify(interceptorParam));\n    }\n    headers = new HttpHeaders().set(\n      headerName,\n      JSON.stringify(interceptorParam)\n    );\n    return headers;\n  }\n\n  static removeHeader(\n    headerName: string,\n    request: HttpRequest<any>\n  ): HttpRequest<any> {\n    const updatedHeaders = request.headers.delete(headerName);\n    return request.clone({ headers: updatedHeaders });\n  }\n\n  static getInterceptorParam<T>(headerName: string, headers: HttpHeaders): T {\n    const rawValue = headers.get(headerName);\n    if (rawValue) {\n      return JSON.parse(rawValue);\n    }\n    return undefined;\n  }\n}\n","import { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { ClientToken } from '../models/client-token.model';\n\nexport const CLIENT_AUTH_FEATURE = 'client-auth';\nexport const CLIENT_TOKEN_DATA = '[Client auth] Client Token Data';\n\nexport interface StateWithClientAuth {\n  [CLIENT_AUTH_FEATURE]: ClientAuthState;\n}\n\nexport interface ClientAuthState {\n  clientToken: LoaderState<ClientToken>;\n}\n","import { StateUtils } from '../../../../state/utils/index';\nimport { ClientToken } from '../../models/client-token.model';\nimport { CLIENT_TOKEN_DATA } from '../client-auth-state';\n\nexport const LOAD_CLIENT_TOKEN = '[Token] Load Client Token';\nexport const LOAD_CLIENT_TOKEN_FAIL = '[Token] Load Client Token Fail';\nexport const LOAD_CLIENT_TOKEN_SUCCESS = '[Token] Load Client Token Success';\n\nexport class LoadClientToken extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_CLIENT_TOKEN;\n  constructor() {\n    super(CLIENT_TOKEN_DATA);\n  }\n}\n\nexport class LoadClientTokenFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_CLIENT_TOKEN_FAIL;\n  constructor(public payload: any) {\n    super(CLIENT_TOKEN_DATA, payload);\n  }\n}\n\nexport class LoadClientTokenSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_CLIENT_TOKEN_SUCCESS;\n  constructor(public payload: ClientToken) {\n    super(CLIENT_TOKEN_DATA);\n  }\n}\n\nexport type ClientTokenAction =\n  | LoadClientToken\n  | LoadClientTokenFail\n  | LoadClientTokenSuccess;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  ClientAuthState,\n  CLIENT_AUTH_FEATURE,\n  StateWithClientAuth,\n} from '../client-auth-state';\n\nexport const getClientAuthState: MemoizedSelector<\n  StateWithClientAuth,\n  ClientAuthState\n> = createFeatureSelector<ClientAuthState>(CLIENT_AUTH_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { LoaderState } from '../../../../state/utils/loader/loader-state';\nimport { ClientToken } from '../../models/client-token.model';\nimport { ClientAuthState, StateWithClientAuth } from '../client-auth-state';\nimport { getClientAuthState } from './feature.selector';\n\nexport const getClientTokenState: MemoizedSelector<\n  StateWithClientAuth,\n  LoaderState<ClientToken>\n> = createSelector(\n  getClientAuthState,\n  (state: ClientAuthState) => state.clientToken\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable, queueScheduler } from 'rxjs';\nimport { filter, map, observeOn } from 'rxjs/operators';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { ClientToken } from '../models/client-token.model';\nimport { ClientAuthActions } from '../store/actions/index';\nimport { StateWithClientAuth } from '../store/client-auth-state';\nimport { ClientAuthSelectors } from '../store/selectors/index';\n\n/**\n * Serves a role of a facade on client token store.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ClientTokenService {\n  constructor(protected store: Store<StateWithClientAuth>) {}\n\n  /**\n   * Returns a client token. The client token from the store is returned if there is one.\n   * Otherwise a new token is fetched from the backend and saved in the store.\n   */\n  getClientToken(): Observable<ClientToken> {\n    return this.store.pipe(\n      select(ClientAuthSelectors.getClientTokenState),\n      observeOn(queueScheduler),\n      filter((state: LoaderState<ClientToken>) => {\n        if (this.isClientTokenLoaded(state)) {\n          return true;\n        } else {\n          if (!state.loading) {\n            this.store.dispatch(new ClientAuthActions.LoadClientToken());\n          }\n          return false;\n        }\n      }),\n      map((state: LoaderState<ClientToken>) => state.value)\n    );\n  }\n\n  /**\n   * Fetches a clientToken from the backend and saves it in the store where getClientToken can use it.\n   * The new clientToken is returned.\n   */\n  refreshClientToken(): Observable<ClientToken> {\n    this.store.dispatch(new ClientAuthActions.LoadClientToken());\n\n    return this.store.pipe(\n      select(ClientAuthSelectors.getClientTokenState),\n      filter((state: LoaderState<ClientToken>) =>\n        this.isClientTokenLoaded(state)\n      ),\n      map((state: LoaderState<ClientToken>) => state.value)\n    );\n  }\n\n  protected isClientTokenLoaded(state: LoaderState<ClientToken>): boolean {\n    return (state.success || state.error) && !state.loading;\n  }\n}\n","import { HttpHandler, HttpRequest } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\nimport { ClientToken } from '../models/client-token.model';\nimport { ClientTokenService } from './client-token.service';\n\n/**\n * Service for handling `Authorization` header and errors for requests that\n * require client token (eg. user registration).\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ClientErrorHandlingService {\n  constructor(protected clientTokenService: ClientTokenService) {}\n\n  /**\n   * Refreshes client token and retries the request with the new token.\n   *\n   * @param request\n   * @param httpHandler\n   */\n  public handleExpiredClientToken(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<any> {\n    return this.clientTokenService.refreshClientToken().pipe(\n      take(1),\n      switchMap((token: ClientToken) => {\n        return next.handle(this.createNewRequestWithNewToken(request, token));\n      })\n    );\n  }\n\n  /**\n   * Clones the requests and provided `Authorization` header.\n   *\n   * @param request\n   * @param token\n   */\n  protected createNewRequestWithNewToken(\n    request: HttpRequest<any>,\n    token: ClientToken\n  ): HttpRequest<any> {\n    request = request.clone({\n      setHeaders: {\n        Authorization: `${token.token_type || 'Bearer'} ${token.access_token}`,\n      },\n    });\n    return request;\n  }\n}\n","import {\n  HttpErrorResponse,\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError, switchMap, take } from 'rxjs/operators';\nimport { OccEndpointsService } from '../../../occ/services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../../occ/utils/interceptor-util';\nimport { ClientToken } from '../models/client-token.model';\nimport { ClientErrorHandlingService } from '../services/client-error-handling.service';\nimport { ClientTokenService } from '../services/client-token.service';\n\n/**\n * Interceptor for handling requests with `USE_CLIENT_TOKEN` header.\n * Provides `Authorization` header with client token and handles errors related to client auth.\n */\n@Injectable({ providedIn: 'root' })\nexport class ClientTokenInterceptor implements HttpInterceptor {\n  constructor(\n    protected clientTokenService: ClientTokenService,\n    protected clientErrorHandlingService: ClientErrorHandlingService,\n    protected occEndpoints: OccEndpointsService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    const isClientTokenRequest = this.isClientTokenRequest(request);\n    if (isClientTokenRequest) {\n      request = InterceptorUtil.removeHeader(USE_CLIENT_TOKEN, request);\n    }\n\n    return this.getClientToken(isClientTokenRequest).pipe(\n      take(1),\n      switchMap((token: ClientToken) => {\n        if (\n          token?.access_token &&\n          request.url.includes(this.occEndpoints.getBaseEndpoint())\n        ) {\n          request = request.clone({\n            setHeaders: {\n              Authorization: `${token.token_type || 'Bearer'} ${\n                token.access_token\n              }`,\n            },\n          });\n        }\n\n        return next.handle(request).pipe(\n          catchError((errResponse: any) => {\n            if (errResponse instanceof HttpErrorResponse) {\n              if (errResponse.status === 401) {\n                if (isClientTokenRequest) {\n                  if (this.isExpiredToken(errResponse)) {\n                    return this.clientErrorHandlingService.handleExpiredClientToken(\n                      request,\n                      next\n                    );\n                  }\n                }\n              }\n            }\n            return throwError(errResponse);\n          })\n        );\n      })\n    );\n  }\n\n  protected getClientToken(\n    isClientTokenRequest: boolean\n  ): Observable<ClientToken> {\n    if (isClientTokenRequest) {\n      return this.clientTokenService.getClientToken();\n    }\n    return of(null);\n  }\n\n  protected isClientTokenRequest(request: HttpRequest<any>): boolean {\n    const isRequestMapping = InterceptorUtil.getInterceptorParam(\n      USE_CLIENT_TOKEN,\n      request.headers\n    );\n    return Boolean(isRequestMapping);\n  }\n\n  protected isExpiredToken(resp: HttpErrorResponse): boolean {\n    return resp.error?.errors?.[0]?.type === 'InvalidTokenError';\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\n\nexport enum StorageSyncType {\n  NO_STORAGE = 'NO_STORAGE',\n  LOCAL_STORAGE = 'LOCAL_STORAGE',\n  SESSION_STORAGE = 'SESSION_STORAGE',\n}\n\nexport enum StateTransferType {\n  TRANSFER_STATE = 'SSR',\n}\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class StateConfig {\n  state?: {\n    /**\n     * @deprecated Since 3.0, to synchronize state from the browser storage, use StatePersistentService\n     */\n    storageSync?: {\n      /**\n       * A key name for the data stored in `localStorage`.\n       * Default is `DEFAULT_LOCAL_STORAGE_KEY`.\n       */\n      localStorageKeyName?: string;\n      /**\n       * A key name for the data stored in `sessionStorage`.\n       * Default is `DEFAULT_SESSION_STORAGE_KEY`.\n       */\n      sessionStorageKeyName?: string;\n      /**\n       * A set of state keys that should be synced with the specified browser's storage.\n       */\n      keys?: {\n        [key: string]: StorageSyncType;\n      };\n      /**\n       * A set of keys not to sync with the specified browser's storage.\n       */\n      excludeKeys?: {\n        [key: string]: StorageSyncType;\n      };\n    };\n    ssrTransfer?: {\n      keys?: {\n        /**\n         * A set of state keys that should be transferred from server.\n         */\n        [key: string]: StateTransferType;\n      };\n    };\n  };\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Provider } from '@angular/core';\nimport { ClientTokenInterceptor } from './client-token.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: ClientTokenInterceptor,\n    multi: true,\n  },\n];\n","import { StateConfig } from './state-config';\n\nexport const DEFAULT_LOCAL_STORAGE_KEY = 'spartacus-local-data';\nexport const DEFAULT_SESSION_STORAGE_KEY = 'spartacus-session-data';\n\nexport const defaultStateConfig: StateConfig = {\n  state: {\n    storageSync: {\n      localStorageKeyName: DEFAULT_LOCAL_STORAGE_KEY,\n      sessionStorageKeyName: DEFAULT_SESSION_STORAGE_KEY,\n      keys: {},\n      excludeKeys: {},\n    },\n  },\n};\n","import { Action, ActionReducer, INIT, MetaReducer, UPDATE } from '@ngrx/store';\nimport { deepMerge } from '../../config/utils/deep-merge';\nimport { WindowRef } from '../../window/window-ref';\nimport { StateConfig, StorageSyncType } from '../config/state-config';\nimport { filterKeysByType, getStateSlice } from '../utils/get-state-slice';\n\nexport function getStorageSyncReducer<T>(\n  winRef: WindowRef,\n  config?: StateConfig\n): MetaReducer<T, Action> {\n  if (\n    !winRef.nativeWindow ||\n    !config ||\n    !config.state ||\n    !config.state.storageSync ||\n    !config.state.storageSync.keys\n  ) {\n    return (reducer) => reducer;\n  }\n\n  const storageSyncConfig = config.state.storageSync;\n\n  return (reducer: ActionReducer<T, Action>): ActionReducer<T, Action> => {\n    return (state, action): T => {\n      const newState = reducer(state, action);\n\n      if (action.type === INIT || action.type === UPDATE) {\n        const rehydratedState = rehydrate(config, winRef);\n        return deepMerge({}, newState, rehydratedState);\n      }\n\n      if (action.type !== INIT) {\n        // handle local storage\n        const localStorageKeys = filterKeysByType(\n          storageSyncConfig.keys,\n          StorageSyncType.LOCAL_STORAGE\n        );\n        const localStorageExclusionKeys = filterKeysByType(\n          storageSyncConfig.excludeKeys,\n          StorageSyncType.LOCAL_STORAGE\n        );\n        const localStorageStateSlices = getStateSlice(\n          localStorageKeys,\n          localStorageExclusionKeys,\n          newState\n        );\n        persistToStorage(\n          config.state.storageSync.localStorageKeyName,\n          localStorageStateSlices,\n          winRef.localStorage\n        );\n\n        // handle session storage\n        const sessionStorageKeys = filterKeysByType(\n          storageSyncConfig.keys,\n          StorageSyncType.SESSION_STORAGE\n        );\n        const sessionStorageExclusionKeys = filterKeysByType(\n          storageSyncConfig.excludeKeys,\n          StorageSyncType.SESSION_STORAGE\n        );\n        const sessionStorageStateSlices = getStateSlice(\n          sessionStorageKeys,\n          sessionStorageExclusionKeys,\n          newState\n        );\n        persistToStorage(\n          config.state.storageSync.sessionStorageKeyName,\n          sessionStorageStateSlices,\n          winRef.sessionStorage\n        );\n      }\n\n      return newState;\n    };\n  };\n}\n\nexport function rehydrate<T>(config: StateConfig, winRef: WindowRef): T {\n  const localStorageValue = readFromStorage(\n    winRef.localStorage,\n    config.state.storageSync.localStorageKeyName\n  );\n  const sessionStorageValue = readFromStorage(\n    winRef.sessionStorage,\n    config.state.storageSync.sessionStorageKeyName\n  );\n\n  return deepMerge(localStorageValue, sessionStorageValue);\n}\n\nexport function exists(value: Object): boolean {\n  if (value != null) {\n    if (typeof value === 'object') {\n      return Object.keys(value).length !== 0;\n    }\n    return value !== '';\n  }\n  return false;\n}\n\nexport function getStorage(\n  storageType: StorageSyncType,\n  winRef: WindowRef\n): Storage {\n  let storage: Storage;\n\n  switch (storageType) {\n    case StorageSyncType.LOCAL_STORAGE: {\n      storage = winRef.localStorage;\n      break;\n    }\n    case StorageSyncType.SESSION_STORAGE: {\n      storage = winRef.sessionStorage;\n      break;\n    }\n    case StorageSyncType.NO_STORAGE: {\n      storage = undefined;\n      break;\n    }\n\n    default: {\n      storage = winRef.sessionStorage;\n    }\n  }\n\n  return storage;\n}\n\nexport function persistToStorage(\n  configKey: string,\n  value: any,\n  storage: Storage\n): void {\n  if (!isSsr(storage) && value) {\n    storage.setItem(configKey, JSON.stringify(value));\n  }\n}\n\nexport function readFromStorage(storage: Storage, key: string): any {\n  if (isSsr(storage)) {\n    return;\n  }\n\n  const storageValue = storage.getItem(key);\n  if (!storageValue) {\n    return;\n  }\n\n  return JSON.parse(storageValue);\n}\n\nexport function isSsr(storage: Storage): boolean {\n  return !Boolean(storage);\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, Subscription } from 'rxjs';\nimport { map, tap, withLatestFrom } from 'rxjs/operators';\nimport { StorageSyncType } from '../../state/config/state-config';\nimport {\n  getStorage,\n  persistToStorage,\n  readFromStorage,\n} from '../../state/reducers/storage-sync.reducer';\nimport { WindowRef } from '../../window/window-ref';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class StatePersistenceService {\n  constructor(protected winRef: WindowRef) {}\n\n  /**\n   * Helper to synchronize state to more persistent storage (localStorage, sessionStorage).\n   * It is context aware, so you can keep different state for te same feature based on specified context.\n   *\n   * Eg. cart is valid only under the same base site. So you want to synchronize cart only with the same base site.\n   * Usage for that case: `syncWithStorage({ key: 'cart', state$: activeCartSelector$, context$: this.siteContextParamsService.getValues([BASE_SITE_CONTEXT_ID]), onRead: (state) => setCorrectStateInStore(state) })`.\n   * Active cart for the `electronics` base site will be stored under `spartacus⚿electronics⚿cart` and for apparel under `spartacus⚿apparel⚿cart`.\n   *\n   * On each context change onRead function will be executed with state from storage provided as a parameter.\n   *\n   * Omitting context$ will trigger onRead only once at initialization.\n   *\n   * @param key Key to use in storage for the synchronized state. Should be unique for each feature.\n   * @param state$ State to be saved and later restored.\n   * @param context$ Context for state\n   * @param storageType Storage type to be used to persist state\n   * @param onRead Function to be executed on each storage read after context change\n   *\n   * @returns Subscriptions for reading/writing in storage on context/state change\n   */\n  syncWithStorage<T>({\n    key,\n    state$,\n    context$ = of(''),\n    storageType = StorageSyncType.LOCAL_STORAGE,\n    onRead = () => {},\n  }: {\n    key: string;\n    state$: Observable<T>;\n    context$?: Observable<string | Array<string>>;\n    storageType?: StorageSyncType;\n    onRead?: (stateFromStorage: T) => void;\n  }): Subscription {\n    const storage = getStorage(storageType, this.winRef);\n\n    const subscriptions = new Subscription();\n\n    // Do not change order of subscription! Read should happen before write on context change.\n    subscriptions.add(\n      context$\n        .pipe(\n          map((context) => {\n            return readFromStorage(\n              storage,\n              this.generateKeyWithContext(context, key)\n            ) as T;\n          }),\n          tap((state) => onRead(state))\n        )\n        .subscribe()\n    );\n\n    subscriptions.add(\n      state$.pipe(withLatestFrom(context$)).subscribe(([state, context]) => {\n        persistToStorage(\n          this.generateKeyWithContext(context, key),\n          state,\n          storage\n        );\n      })\n    );\n\n    return subscriptions;\n  }\n\n  /**\n   * Helper to read state from persistent storage (localStorage, sessionStorage).\n   * It is useful if you need synchronously access state saved with `syncWithStorage`.\n   *\n   * @param key Key to use in storage for state. Should be unique for each feature.\n   * @param context Context value for state\n   * @param storageType Storage type from to read state\n   *\n   * @returns State from the storage\n   */\n  readStateFromStorage<T>({\n    key,\n    context = '',\n    storageType = StorageSyncType.LOCAL_STORAGE,\n  }: {\n    key: string;\n    context?: string | Array<string>;\n    storageType?: StorageSyncType;\n  }): T {\n    const storage = getStorage(storageType, this.winRef);\n\n    return readFromStorage(\n      storage,\n      this.generateKeyWithContext(context, key)\n    ) as T;\n  }\n\n  protected generateKeyWithContext(\n    context: string | Array<string>,\n    key: string\n  ): string {\n    return `spartacus⚿${[].concat(context).join('⚿')}⚿${key}`;\n  }\n}\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { combineLatest, Observable, Subscription } from 'rxjs';\nimport { filter, map } from 'rxjs/operators';\nimport { StatePersistenceService } from '../../../state/services/state-persistence.service';\nimport { UserIdService } from '../facade/user-id.service';\nimport { AuthToken } from '../models/auth-token.model';\nimport { AuthRedirectStorageService } from './auth-redirect-storage.service';\nimport { AuthStorageService } from './auth-storage.service';\n\n/**\n * Auth state synced to browser storage.\n */\nexport interface SyncedAuthState {\n  userId?: string;\n  token?: AuthToken;\n  redirectUrl?: string;\n}\n\n/**\n * Responsible for saving the authorization data (userId, token, redirectUrl) in browser storage.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthStatePersistenceService implements OnDestroy {\n  protected subscription = new Subscription();\n\n  constructor(\n    protected statePersistenceService: StatePersistenceService,\n    protected userIdService: UserIdService,\n    protected authStorageService: AuthStorageService,\n    protected authRedirectStorageService: AuthRedirectStorageService\n  ) {}\n\n  /**\n   * Identifier used for storage key.\n   */\n  protected key = 'auth';\n\n  /**\n   * Initializes the synchronization between state and browser storage.\n   */\n  public initSync() {\n    this.subscription.add(\n      this.statePersistenceService.syncWithStorage({\n        key: this.key,\n        state$: this.getAuthState(),\n        onRead: (state) => this.onRead(state),\n      })\n    );\n  }\n\n  /**\n   * Gets and transforms state from different sources into the form that should\n   * be saved in storage.\n   */\n  protected getAuthState(): Observable<SyncedAuthState> {\n    return combineLatest([\n      this.authStorageService.getToken().pipe(\n        filter((state) => !!state),\n        map((state) => {\n          return {\n            ...state,\n          };\n        })\n      ),\n      this.userIdService.getUserId(),\n      this.authRedirectStorageService.getRedirectUrl(),\n    ]).pipe(\n      map(([authToken, userId, redirectUrl]) => {\n        let token = authToken;\n        if (token) {\n          token = { ...token };\n          // To minimize risk of user account hijacking we don't persist user refresh_token\n          delete token.refresh_token;\n        }\n        return { token, userId, redirectUrl };\n      })\n    );\n  }\n\n  /**\n   * Function called on each browser storage read.\n   * Used to update state from browser -> state.\n   */\n  protected onRead(state: SyncedAuthState) {\n    if (state) {\n      if (state.token) {\n        this.authStorageService.setToken(state.token);\n      }\n      if (state.userId) {\n        this.userIdService.setUserId(state.userId);\n      }\n      if (state.redirectUrl) {\n        this.authRedirectStorageService.setRedirectUrl(state.redirectUrl);\n      }\n    }\n  }\n\n  /**\n   * Reads synchronously state from storage and returns it.\n   */\n  protected readStateFromStorage() {\n    return this.statePersistenceService.readStateFromStorage<SyncedAuthState>({\n      key: this.key,\n    });\n  }\n\n  /**\n   * Check synchronously in browser storage if user is logged in (required by transfer state reducer).\n   * For most cases `isUserLoggedIn` from the `AuthService` should be used instead of this.\n   */\n  public isUserLoggedIn(): boolean {\n    return Boolean(this.readStateFromStorage()?.token?.access_token);\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n}\n","import { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport {\n  makeStateKey,\n  StateKey,\n  TransferState,\n} from '@angular/platform-browser';\nimport { INIT } from '@ngrx/store';\nimport { AuthStatePersistenceService } from '../../auth/user-auth/services/auth-state-persistence.service';\nimport { deepMerge } from '../../config/utils/deep-merge';\nimport { StateConfig, StateTransferType } from '../config/state-config';\nimport { filterKeysByType, getStateSlice } from '../utils/get-state-slice';\n\nexport const CX_KEY: StateKey<string> = makeStateKey<string>('cx-state');\n\nexport function getTransferStateReducer(\n  platformId,\n  transferState?: TransferState,\n  config?: StateConfig,\n  authStatePersistenceService?: AuthStatePersistenceService\n) {\n  if (transferState && config?.state?.ssrTransfer?.keys) {\n    if (isPlatformBrowser(platformId)) {\n      return getBrowserTransferStateReducer(\n        transferState,\n        config.state.ssrTransfer.keys,\n        Boolean(authStatePersistenceService?.isUserLoggedIn())\n      );\n    } else if (isPlatformServer(platformId)) {\n      return getServerTransferStateReducer(\n        transferState,\n        config.state.ssrTransfer.keys\n      );\n    }\n  }\n\n  return (reducer) => reducer;\n}\n\nexport function getServerTransferStateReducer(\n  transferState: TransferState,\n  keys: { [key: string]: StateTransferType }\n) {\n  const transferStateKeys = filterKeysByType(\n    keys,\n    StateTransferType.TRANSFER_STATE\n  );\n\n  return function (reducer) {\n    return function (state, action: any) {\n      const newState = reducer(state, action);\n      if (newState) {\n        const stateSlice = getStateSlice(transferStateKeys, [], newState);\n        transferState.set(CX_KEY, stateSlice);\n      }\n\n      return newState;\n    };\n  };\n}\n\nexport function getBrowserTransferStateReducer(\n  transferState: TransferState,\n  keys: { [key: string]: StateTransferType },\n  isLoggedIn: boolean\n) {\n  const transferStateKeys = filterKeysByType(\n    keys,\n    StateTransferType.TRANSFER_STATE\n  );\n\n  return function (reducer) {\n    return function (state, action: any) {\n      if (action.type === INIT) {\n        if (!state) {\n          state = reducer(state, action);\n        }\n\n        if (!isLoggedIn && transferState.hasKey(CX_KEY)) {\n          const cxKey = transferState.get(CX_KEY, {});\n          const transferredStateSlice = getStateSlice(\n            transferStateKeys,\n            [],\n            cxKey\n          );\n\n          state = deepMerge({}, state, transferredStateSlice);\n        }\n        return state;\n      }\n      return reducer(state, action);\n    };\n  };\n}\n","import { InjectionToken, Optional, PLATFORM_ID, Provider } from '@angular/core';\nimport { TransferState } from '@angular/platform-browser';\nimport { META_REDUCERS } from '@ngrx/store';\nimport { AuthStatePersistenceService } from '../../auth/user-auth/services/auth-state-persistence.service';\nimport { Config } from '../../config/config-tokens';\nimport { WindowRef } from '../../window/window-ref';\nimport { getStorageSyncReducer } from './storage-sync.reducer';\nimport { getTransferStateReducer } from './transfer-state.reducer';\n\nexport { getStateSlice } from '../utils/get-state-slice';\nexport { getStorageSyncReducer } from './storage-sync.reducer';\nexport * from './transfer-state.reducer';\n\nexport const TRANSFER_STATE_META_REDUCER = new InjectionToken(\n  'TransferStateMetaReducer'\n);\nexport const STORAGE_SYNC_META_REDUCER = new InjectionToken(\n  'StorageSyncMetaReducer'\n);\n\nexport const stateMetaReducers: Provider[] = [\n  {\n    provide: TRANSFER_STATE_META_REDUCER,\n    useFactory: getTransferStateReducer,\n    deps: [\n      PLATFORM_ID,\n      [new Optional(), TransferState],\n      [new Optional(), Config],\n      [new Optional(), AuthStatePersistenceService],\n    ],\n  },\n  {\n    provide: STORAGE_SYNC_META_REDUCER,\n    useFactory: getStorageSyncReducer,\n    deps: [WindowRef, [new Optional(), Config]],\n  },\n  {\n    provide: META_REDUCERS,\n    useExisting: TRANSFER_STATE_META_REDUCER,\n    multi: true,\n  },\n  {\n    provide: META_REDUCERS,\n    useExisting: STORAGE_SYNC_META_REDUCER,\n    multi: true,\n  },\n];\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { defaultStateConfig } from './config/default-state-config';\nimport { stateMetaReducers } from './reducers/index';\nimport { provideDefaultConfig } from '../config/config-providers';\n\n@NgModule({})\nexport class StateModule {\n  static forRoot(): ModuleWithProviders<StateModule> {\n    return {\n      ngModule: StateModule,\n      providers: [\n        ...stateMetaReducers,\n        provideDefaultConfig(defaultStateConfig),\n      ],\n    };\n  }\n}\n","import { HttpErrorResponse } from '@angular/common/http';\nimport { HttpErrorModel } from '../model/misc.model';\nimport { isDevMode } from '@angular/core';\n\n/**\n * Normalizes HttpErrorResponse to HttpErrorModel.\n *\n * Can be used as a safe and generic way for embodying http errors into\n * NgRx Action payload, as it will strip potentially unserializable parts from\n * it and warn in debug mode if passed error is not instance of HttpErrorModel\n * (which usually happens when logic in NgRx Effect is not sealed correctly)\n */\nexport function normalizeHttpError(\n  error: HttpErrorResponse | any\n): HttpErrorModel | undefined {\n  if (error instanceof HttpErrorResponse) {\n    const normalizedError: HttpErrorModel = {\n      message: error.message,\n      status: error.status,\n      statusText: error.statusText,\n      url: error.url,\n    };\n\n    // include backend's error details\n    if (Array.isArray(error.error.errors)) {\n      normalizedError.details = error.error.errors;\n    } else if (typeof error.error.error === 'string') {\n      normalizedError.details = [\n        {\n          type: error.error.error,\n          message: error.error.error_description,\n        },\n      ];\n    }\n\n    return normalizedError;\n  }\n\n  if (isDevMode()) {\n    console.error(\n      'Error passed to normalizeHttpError is not HttpErrorResponse instance',\n      error\n    );\n  }\n\n  return undefined;\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { AuthConfigService } from '../../user-auth/services/auth-config.service';\nimport { ClientToken } from '../models/client-token.model';\n\n/**\n * Responsible for requesting from OAuth server `ClientToken` for a particular\n * auth client.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ClientAuthenticationTokenService {\n  constructor(\n    protected http: HttpClient,\n    protected authConfigService: AuthConfigService\n  ) {}\n\n  /**\n   * Loads token with client authentication flow.\n   *\n   * @returns observable with ClientToken\n   */\n  loadClientAuthenticationToken(): Observable<ClientToken> {\n    const url: string = this.authConfigService.getTokenEndpoint();\n    const params = new HttpParams()\n      .set(\n        'client_id',\n        encodeURIComponent(this.authConfigService.getClientId())\n      )\n      .set(\n        'client_secret',\n        encodeURIComponent(this.authConfigService.getClientSecret())\n      )\n      .set('grant_type', 'client_credentials');\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http.post<ClientToken>(url, params, { headers });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map } from 'rxjs/operators';\nimport { normalizeHttpError } from '../../../../util/normalize-http-error';\nimport { ClientToken } from '../../../client-auth/models/client-token.model';\nimport { ClientAuthenticationTokenService } from '../../services/client-authentication-token.service';\nimport { ClientAuthActions } from '../actions/index';\n\n@Injectable()\nexport class ClientTokenEffect {\n  @Effect()\n  loadClientToken$: Observable<\n    ClientAuthActions.ClientTokenAction\n  > = this.actions$.pipe(\n    ofType(ClientAuthActions.LOAD_CLIENT_TOKEN),\n    exhaustMap(() => {\n      return this.clientAuthenticationTokenService\n        .loadClientAuthenticationToken()\n        .pipe(\n          map((token: ClientToken) => {\n            return new ClientAuthActions.LoadClientTokenSuccess(token);\n          }),\n          catchError((error) =>\n            of(\n              new ClientAuthActions.LoadClientTokenFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private clientAuthenticationTokenService: ClientAuthenticationTokenService\n  ) {}\n}\n","import { ClientTokenEffect } from './client-token.effect';\n\nexport const effects: any[] = [ClientTokenEffect];\n\nexport * from './client-token.effect';\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducerMap } from '@ngrx/store';\nimport { loaderReducer } from '../../../../state/utils/loader/loader.reducer';\nimport { ClientToken } from '../../models/client-token.model';\nimport { ClientAuthState, CLIENT_TOKEN_DATA } from '../client-auth-state';\n\nexport function getReducers(): ActionReducerMap<ClientAuthState> {\n  return {\n    clientToken: loaderReducer<ClientToken>(CLIENT_TOKEN_DATA),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  ClientAuthState\n>> = new InjectionToken<ActionReducerMap<ClientAuthState>>(\n  'ClientAuthReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { StateModule } from '../../../state/state.module';\nimport { CLIENT_AUTH_FEATURE } from './client-auth-state';\nimport { effects } from './effects/index';\nimport { reducerProvider, reducerToken } from './reducers/index';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StateModule,\n    StoreModule.forFeature(CLIENT_AUTH_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [reducerProvider],\n})\nexport class ClientAuthStoreModule {}\n","import { CommonModule } from '@angular/common';\nimport { ModuleWithProviders, NgModule } from '@angular/core';\nimport { interceptors } from './http-interceptors/index';\nimport { ClientAuthStoreModule } from './store/client-auth-store.module';\n\n/**\n * Some of the OCC endpoints require Authorization header with the client token (eg. user registration).\n * This pattern should not be used in the frontend apps, but until OCC changes this requirement\n * we provide this module to support using those endpoints.\n *\n * After OCC improvements regarding client authentication this module can be safely removed.\n */\n@NgModule({\n  imports: [CommonModule, ClientAuthStoreModule],\n})\nexport class ClientAuthModule {\n  static forRoot(): ModuleWithProviders<ClientAuthModule> {\n    return {\n      ngModule: ClientAuthModule,\n      providers: [...interceptors],\n    };\n  }\n}\n","import { InjectionToken } from '@angular/core';\n\nexport const CONFIG_INITIALIZER = new InjectionToken('ConfigInitializer');\n\n/**\n * Used to provide asynchronous config during app initialization\n */\nexport interface ConfigInitializer {\n  /**\n   * List of config parts that are resolved by configFactory, e.g.:\n   * 'context.baseSite', 'context.language'\n   */\n  scopes: string[];\n  /**\n   * Promise that returns config chunk\n   */\n  configFactory: () => Promise<any>;\n}\n\nexport const CONFIG_INITIALIZER_FORROOT_GUARD = new InjectionToken<void>(\n  'CONFIG_INITIALIZER_FORROOT_GUARD'\n);\n","import { Inject, Injectable, isDevMode, Optional } from '@angular/core';\nimport {\n  CONFIG_INITIALIZER_FORROOT_GUARD,\n  ConfigInitializer,\n} from './config-initializer';\nimport { BehaviorSubject } from 'rxjs';\nimport { filter, mapTo, take } from 'rxjs/operators';\nimport { deepMerge } from '../utils/deep-merge';\nimport { Config, RootConfig } from '../config-tokens';\n\n/**\n * Provides support for CONFIG_INITIALIZERS\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConfigInitializerService {\n  constructor(\n    @Inject(Config) protected config: any,\n    @Optional()\n    @Inject(CONFIG_INITIALIZER_FORROOT_GUARD)\n    protected initializerGuard,\n    @Inject(RootConfig) protected rootConfig: any\n  ) {}\n\n  protected ongoingScopes$ = new BehaviorSubject<string[]>(undefined);\n\n  /**\n   * Returns true if config is stable, i.e. all CONFIG_INITIALIZERS resolved correctly\n   */\n  get isStable(): boolean {\n    return (\n      !this.initializerGuard ||\n      (this.ongoingScopes$.value && this.ongoingScopes$.value.length === 0)\n    );\n  }\n\n  /**\n   * Recommended way to get config for code that can run before app will finish\n   * initialization (APP_INITIALIZERS, selected service constructors)\n   *\n   * Used without parameters waits for the whole config to become stable\n   *\n   * Parameters allow to describe which part of the config should be stable using\n   * string describing config part, e.g.:\n   * 'siteContext', 'siteContext.language', etc.\n   *\n   * @param scopes String describing parts of the config we want to be sure are stable\n   */\n  async getStableConfig(...scopes: string[]): Promise<any> {\n    if (this.isStable) {\n      return this.config;\n    }\n    return this.ongoingScopes$\n      .pipe(\n        filter(\n          (ongoingScopes) =>\n            ongoingScopes && this.areReady(scopes, ongoingScopes)\n        ),\n        take(1),\n        mapTo(this.config)\n      )\n      .toPromise();\n  }\n\n  /**\n   * Removes provided scopes from currently ongoingScopes\n   *\n   * @param scopes\n   */\n  protected finishScopes(scopes: string[]) {\n    const newScopes = [...this.ongoingScopes$.value];\n    for (const scope of scopes) {\n      newScopes.splice(newScopes.indexOf(scope), 1);\n    }\n    this.ongoingScopes$.next(newScopes);\n  }\n\n  /**\n   * Return true if provided scopes are not part of ongoingScopes\n   *\n   * @param scopes\n   * @param ongoingScopes\n   */\n  protected areReady(scopes: string[], ongoingScopes: string[]): boolean {\n    if (!scopes.length) {\n      return !ongoingScopes.length;\n    }\n    for (const scope of scopes) {\n      for (const ongoingScope of ongoingScopes) {\n        if (this.scopesOverlap(scope, ongoingScope)) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Check if two scopes overlap.\n   *\n   * Example of scopes that overlap:\n   * 'test' and 'test', 'test.a' and 'test', 'test' and 'test.a'\n   *\n   * Example of scopes that do not overlap:\n   * 'test' and 'testA', 'test.a' and 'test.b', 'test.nested' and 'test.nest'\n   *\n   * @param a ScopeA\n   * @param b ScopeB\n   */\n  protected scopesOverlap(a: string, b: string): boolean {\n    if (b.length > a.length) {\n      [a, b] = [b, a];\n    }\n    return a.startsWith(b) && (a[b.length] || '.') === '.';\n  }\n\n  /**\n   * @internal\n   *\n   * Not a part of a public API, used by APP_INITIALIZER to initialize all provided CONFIG_INITIALIZERS\n   *\n   */\n  async initialize(initializers?: ConfigInitializer[]) {\n    if (this.ongoingScopes$.value) {\n      // guard for double initialization\n      return;\n    }\n\n    const ongoingScopes: string[] = [];\n\n    const asyncConfigs: Promise<void>[] = [];\n\n    for (const initializer of initializers || []) {\n      if (!initializer) {\n        continue;\n      }\n      if (!initializer.scopes || !initializer.scopes.length) {\n        throw new Error('CONFIG_INITIALIZER should provide scope!');\n      }\n\n      if (isDevMode() && !this.areReady(initializer.scopes, ongoingScopes)) {\n        console.warn(\n          'More than one CONFIG_INITIALIZER is initializing the same config scope.'\n        );\n      }\n\n      ongoingScopes.push(...initializer.scopes);\n\n      asyncConfigs.push(\n        (async () => {\n          const initializerConfig = await initializer.configFactory();\n          // contribute configuration to rootConfig\n          deepMerge(this.rootConfig, initializerConfig);\n          // contribute configuration to global config\n          deepMerge(this.config, initializerConfig);\n          this.finishScopes(initializer.scopes);\n        })()\n      );\n    }\n    this.ongoingScopes$.next(ongoingScopes);\n\n    if (asyncConfigs.length) {\n      await Promise.all(asyncConfigs);\n    }\n  }\n}\n","import { Translatable } from '../../i18n/translatable';\n\nexport enum GlobalMessageType {\n  MSG_TYPE_CONFIRMATION = '[GlobalMessage] Confirmation',\n  MSG_TYPE_ERROR = '[GlobalMessage] Error',\n  MSG_TYPE_INFO = '[GlobalMessage] Information',\n  MSG_TYPE_WARNING = '[GlobalMessage] Warning',\n}\n\nexport interface GlobalMessage {\n  text: Translatable;\n  type: GlobalMessageType;\n  timeout?: number;\n}\n","import { AuthConfig } from './auth-config';\n\nexport const defaultAuthConfig: AuthConfig = {\n  authentication: {\n    client_id: 'mobile_android',\n    client_secret: 'secret',\n    tokenEndpoint: '/oauth/token',\n    revokeEndpoint: '/oauth/revoke',\n    loginUrl: '/oauth/authorize',\n    OAuthLibConfig: {\n      scope: '',\n      customTokenParameters: ['token_type'],\n      strictDiscoveryDocumentValidation: false,\n      skipIssuerCheck: true,\n      disablePKCE: true,\n      oidc: false,\n      clearHashAfterLogin: false,\n    },\n  },\n};\n","import { Action } from '@ngrx/store';\nimport {\n  GlobalMessage,\n  GlobalMessageType,\n} from '../../models/global-message.model';\n\nexport const ADD_MESSAGE = '[Global-message] Add a Message';\nexport const REMOVE_MESSAGE = '[Global-message] Remove a Message';\nexport const REMOVE_MESSAGES_BY_TYPE =\n  '[Global-message] Remove messages by type';\n\nexport class AddMessage implements Action {\n  readonly type = ADD_MESSAGE;\n  constructor(public payload: GlobalMessage) {}\n}\n\nexport class RemoveMessage implements Action {\n  readonly type = REMOVE_MESSAGE;\n  constructor(public payload: { type: GlobalMessageType; index: number }) {}\n}\n\nexport class RemoveMessagesByType implements Action {\n  readonly type = REMOVE_MESSAGES_BY_TYPE;\n  constructor(public payload: GlobalMessageType) {}\n}\n\nexport type GlobalMessageAction =\n  | AddMessage\n  | RemoveMessage\n  | RemoveMessagesByType;\n","import { Translatable } from '../../i18n/translatable';\n\nexport const GLOBAL_MESSAGE_FEATURE = 'global-message';\n\nexport interface StateWithGlobalMessage {\n  [GLOBAL_MESSAGE_FEATURE]: GlobalMessageState;\n}\n\nexport interface GlobalMessageState {\n  entities: GlobalMessageEntities;\n}\n\nexport interface GlobalMessageEntities {\n  [messageType: string]: Translatable[];\n}\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  GlobalMessageState,\n  GLOBAL_MESSAGE_FEATURE,\n  StateWithGlobalMessage,\n} from '../global-message-state';\n\nexport const getGlobalMessageState: MemoizedSelector<\n  StateWithGlobalMessage,\n  GlobalMessageState\n> = createFeatureSelector<GlobalMessageState>(GLOBAL_MESSAGE_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Translatable } from '../../../i18n/translatable';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport {\n  GlobalMessageEntities,\n  GlobalMessageState,\n  StateWithGlobalMessage,\n} from '../global-message-state';\nimport { getGlobalMessageState } from './feature.selector';\n\nexport const getGlobalMessageEntities: MemoizedSelector<\n  StateWithGlobalMessage,\n  GlobalMessageEntities\n> = createSelector(\n  getGlobalMessageState,\n  (state: GlobalMessageState) => state.entities\n);\n\nexport const getGlobalMessageEntitiesByType = (\n  type: GlobalMessageType\n): MemoizedSelector<StateWithGlobalMessage, Translatable[]> => {\n  return createSelector(\n    getGlobalMessageEntities,\n    (entities) => entities && entities[type]\n  );\n};\n\nexport const getGlobalMessageCountByType = (\n  type: GlobalMessageType\n): MemoizedSelector<StateWithGlobalMessage, number> => {\n  return createSelector(\n    getGlobalMessageEntitiesByType(type),\n    (entities) => entities && entities.length\n  );\n};\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter } from 'rxjs/operators';\nimport { Translatable } from '../../i18n/translatable';\nimport { GlobalMessageType } from '../models/global-message.model';\nimport { GlobalMessageActions } from '../store/actions/index';\nimport {\n  GlobalMessageEntities,\n  StateWithGlobalMessage,\n} from '../store/global-message-state';\nimport { GlobalMessageSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class GlobalMessageService {\n  constructor(protected store: Store<StateWithGlobalMessage>) {}\n\n  /**\n   * Get all global messages\n   */\n  get(): Observable<GlobalMessageEntities> {\n    return this.store.pipe(\n      select(GlobalMessageSelectors.getGlobalMessageEntities),\n      filter((data) => data !== undefined)\n    );\n  }\n\n  /**\n   * Add one message into store\n   * @param text: string | Translatable\n   * @param type: GlobalMessageType object\n   * @param timeout: number\n   */\n  add(\n    text: string | Translatable,\n    type: GlobalMessageType,\n    timeout?: number\n  ): void {\n    this.store.dispatch(\n      new GlobalMessageActions.AddMessage({\n        text: typeof text === 'string' ? { raw: text } : text,\n        type,\n        timeout,\n      })\n    );\n  }\n\n  /**\n   * Remove message(s) from store\n   * @param type: GlobalMessageType\n   * @param index:optional. Without it, messages will be removed by type; otherwise,\n   * message will be removed from list by index.\n   */\n  remove(type: GlobalMessageType, index?: number): void {\n    this.store.dispatch(\n      index !== undefined\n        ? new GlobalMessageActions.RemoveMessage({\n            type: type,\n            index: index,\n          })\n        : new GlobalMessageActions.RemoveMessagesByType(type)\n    );\n  }\n}\n","import { HttpEvent, HttpHandler, HttpRequest } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { filter, switchMap, take, tap } from 'rxjs/operators';\nimport { GlobalMessageService } from '../../../global-message/facade/global-message.service';\nimport { GlobalMessageType } from '../../../global-message/models/global-message.model';\nimport { OccEndpointsService } from '../../../occ/services/occ-endpoints.service';\nimport { RoutingService } from '../../../routing/facade/routing.service';\nimport { AuthService } from '../facade/auth.service';\nimport { AuthToken } from '../models/auth-token.model';\nimport { AuthStorageService } from './auth-storage.service';\nimport { OAuthLibWrapperService } from './oauth-lib-wrapper.service';\n\n/**\n * Extendable service for `AuthInterceptor`.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthHttpHeaderService {\n  constructor(\n    protected authService: AuthService,\n    protected authStorageService: AuthStorageService,\n    protected oAuthLibWrapperService: OAuthLibWrapperService,\n    protected routingService: RoutingService,\n    protected occEndpoints: OccEndpointsService,\n    protected globalMessageService: GlobalMessageService\n  ) {}\n\n  /**\n   * Checks if request should be handled by this service (if it's OCC call).\n   */\n  public shouldCatchError(request: HttpRequest<any>): boolean {\n    return this.isOccUrl(request.url);\n  }\n\n  /**\n   * Adds `Authorization` header for OCC calls.\n   */\n  public alterRequest(request: HttpRequest<any>): HttpRequest<any> {\n    const hasAuthorizationHeader = !!this.getAuthorizationHeader(request);\n    const isOccUrl = this.isOccUrl(request.url);\n    if (!hasAuthorizationHeader && isOccUrl) {\n      return request.clone({\n        setHeaders: {\n          ...this.createAuthorizationHeader(),\n        },\n      });\n    }\n    return request;\n  }\n\n  protected isOccUrl(url: string): boolean {\n    return url.includes(this.occEndpoints.getBaseEndpoint());\n  }\n\n  protected getAuthorizationHeader(request: HttpRequest<any>): string {\n    const rawValue = request.headers.get('Authorization');\n    return rawValue;\n  }\n\n  protected createAuthorizationHeader(): { Authorization?: string } {\n    let token;\n    this.authStorageService\n      .getToken()\n      .subscribe((tok) => (token = tok))\n      .unsubscribe();\n\n    if (token?.access_token) {\n      return {\n        Authorization: `${token.token_type || 'Bearer'} ${token.access_token}`,\n      };\n    }\n    return {};\n  }\n\n  /**\n   * Refreshes access_token and then retries the call with the new token.\n   */\n  public handleExpiredAccessToken(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<AuthToken>> {\n    return this.handleExpiredToken().pipe(\n      switchMap((token: AuthToken) => {\n        return next.handle(this.createNewRequestWithNewToken(request, token));\n      })\n    );\n  }\n\n  /**\n   * Logout user, redirected to login page and informs about expired session.\n   */\n  public handleExpiredRefreshToken(): void {\n    // Logout user\n    // TODO(#9638): Use logout route when it will support passing redirect url\n    this.authService.coreLogout();\n    this.routingService.go({ cxRoute: 'login' });\n    this.globalMessageService.add(\n      {\n        key: 'httpHandlers.sessionExpired',\n      },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n\n  /**\n   * Attempts to refresh token if possible.\n   * If it is not possible calls `handleExpiredRefreshToken`.\n   *\n   * @return observable which omits new access_token. (Warn: might never emit!).\n   */\n  protected handleExpiredToken(): Observable<AuthToken> {\n    const stream = this.authStorageService.getToken();\n    let oldToken: AuthToken;\n    return stream.pipe(\n      tap((token: AuthToken) => {\n        if (token.access_token && token.refresh_token && !oldToken) {\n          this.oAuthLibWrapperService.refreshToken();\n        } else if (!token.refresh_token) {\n          this.handleExpiredRefreshToken();\n        }\n        oldToken = oldToken || token;\n      }),\n      filter(\n        (token: AuthToken) => oldToken.access_token !== token.access_token\n      ),\n      take(1)\n    );\n  }\n\n  protected createNewRequestWithNewToken(\n    request: HttpRequest<any>,\n    token: AuthToken\n  ): HttpRequest<any> {\n    request = request.clone({\n      setHeaders: {\n        Authorization: `${token.token_type || 'Bearer'} ${token.access_token}`,\n      },\n    });\n    return request;\n  }\n}\n","import {\n  HttpErrorResponse,\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { AuthConfigService } from '../services/auth-config.service';\nimport { AuthHttpHeaderService } from '../services/auth-http-header.service';\n\n/**\n * Responsible for catching auth errors and providing `Authorization` header for API calls.\n * Uses AuthHttpHeaderService for request manipulation and error handling. Interceptor only hooks into request send/received events.\n */\n@Injectable({ providedIn: 'root' })\nexport class AuthInterceptor implements HttpInterceptor {\n  constructor(\n    protected authHttpHeaderService: AuthHttpHeaderService,\n    protected authConfigService: AuthConfigService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    const shouldCatchError = this.authHttpHeaderService.shouldCatchError(\n      request\n    );\n\n    request = this.authHttpHeaderService.alterRequest(request);\n\n    return next.handle(request).pipe(\n      catchError((errResponse: any) => {\n        if (errResponse instanceof HttpErrorResponse) {\n          switch (errResponse.status) {\n            case 401: // Unauthorized\n              if (this.isExpiredToken(errResponse) && shouldCatchError) {\n                return this.authHttpHeaderService.handleExpiredAccessToken(\n                  request,\n                  next\n                );\n              } else if (\n                // Refresh expired token\n                // Check that the OAUTH endpoint was called and the error is for refresh token is expired\n                errResponse.url.includes(\n                  this.authConfigService.getTokenEndpoint()\n                ) &&\n                errResponse.error.error === 'invalid_token'\n              ) {\n                this.authHttpHeaderService.handleExpiredRefreshToken();\n                return of<HttpEvent<any>>();\n              }\n\n              break;\n            case 400: // Bad Request\n              if (\n                errResponse.url.includes(\n                  this.authConfigService.getTokenEndpoint()\n                ) &&\n                errResponse.error.error === 'invalid_grant'\n              ) {\n                if (request.body.get('grant_type') === 'refresh_token') {\n                  this.authHttpHeaderService.handleExpiredRefreshToken();\n                }\n              }\n              break;\n          }\n        }\n        return throwError(errResponse);\n      })\n    );\n  }\n\n  protected isExpiredToken(resp: HttpErrorResponse): boolean {\n    return resp.error?.errors?.[0]?.type === 'InvalidTokenError';\n  }\n}\n","import {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\nimport { AuthConfigService } from '../services/auth-config.service';\nimport { AuthStorageService } from '../services/auth-storage.service';\n\n/**\n * This interceptor is dedicated for Hybris OAuth server which requires `Authorization` header for revoke token calls.\n */\n@Injectable({ providedIn: 'root' })\nexport class TokenRevocationInterceptor implements HttpInterceptor {\n  constructor(\n    protected authStorageService: AuthStorageService,\n    protected authConfigService: AuthConfigService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    const isTokenRevocationRequest = this.isTokenRevocationRequest(request);\n    return this.authStorageService.getToken().pipe(\n      take(1),\n      switchMap((token) => {\n        if (isTokenRevocationRequest) {\n          request = request.clone({\n            setHeaders: {\n              Authorization: `${token.token_type || 'Bearer'} ${\n                token.access_token\n              }`,\n            },\n          });\n        }\n        return next.handle(request);\n      })\n    );\n  }\n\n  protected isTokenRevocationRequest(request: HttpRequest<any>): boolean {\n    return request.url === this.authConfigService.getRevokeEndpoint();\n  }\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Provider } from '@angular/core';\nimport { AuthInterceptor } from './auth.interceptor';\nimport { TokenRevocationInterceptor } from './token-revocation.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: AuthInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: TokenRevocationInterceptor,\n    multi: true,\n  },\n];\n","import { CommonModule } from '@angular/common';\nimport { APP_INITIALIZER, ModuleWithProviders, NgModule } from '@angular/core';\nimport { OAuthModule, OAuthStorage } from 'angular-oauth2-oidc';\nimport { ConfigInitializerService } from '../../config/config-initializer/config-initializer.service';\nimport { provideDefaultConfig } from '../../config/config-providers';\nimport { defaultAuthConfig } from './config/default-auth-config';\nimport { AuthService } from './facade/auth.service';\nimport { interceptors } from './http-interceptors/index';\nimport { AuthStatePersistenceService } from './services/auth-state-persistence.service';\nimport { AuthStorageService } from './services/auth-storage.service';\n\n/**\n * Initialize the check for `token` or `code` in the url returned from the OAuth server.\n */\nexport function checkOAuthParamsInUrl(\n  authService: AuthService,\n  configInit: ConfigInitializerService\n) {\n  const result = () =>\n    configInit.getStableConfig().then(() => {\n      // Wait for stable config is used, because with auth redirect would kick so quickly that the page would not be loaded correctly\n      authService.checkOAuthParamsInUrl();\n    });\n\n  return result;\n}\n\nexport function authStatePersistenceFactory(\n  authStatePersistenceService: AuthStatePersistenceService\n) {\n  const result = () => authStatePersistenceService.initSync();\n  return result;\n}\n\n/**\n * Authentication module for a user. Handlers requests for logged in users,\n * provides authorization services and storage for tokens.\n */\n@NgModule({\n  imports: [CommonModule, OAuthModule.forRoot()],\n})\nexport class UserAuthModule {\n  static forRoot(): ModuleWithProviders<UserAuthModule> {\n    return {\n      ngModule: UserAuthModule,\n      providers: [\n        provideDefaultConfig(defaultAuthConfig),\n        ...interceptors,\n        {\n          provide: OAuthStorage,\n          useExisting: AuthStorageService,\n        },\n        {\n          provide: APP_INITIALIZER,\n          useFactory: authStatePersistenceFactory,\n          deps: [AuthStatePersistenceService],\n          multi: true,\n        },\n        {\n          provide: APP_INITIALIZER,\n          useFactory: checkOAuthParamsInUrl,\n          deps: [AuthService, ConfigInitializerService],\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { ModuleWithProviders, NgModule } from '@angular/core';\nimport { ClientAuthModule } from './client-auth/client-auth.module';\nimport { UserAuthModule } from './user-auth/user-auth.module';\n\n@NgModule({\n  imports: [CommonModule, ClientAuthModule.forRoot(), UserAuthModule.forRoot()],\n})\nexport class AuthModule {\n  static forRoot(): ModuleWithProviders<AuthModule> {\n    return {\n      ngModule: AuthModule,\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CanActivate, Router, UrlTree } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { SemanticPathService } from '../../../routing/configurable-routes/url-translation/semantic-path.service';\nimport { AuthService } from '../facade/auth.service';\nimport { AuthRedirectService } from '../services/auth-redirect.service';\n\n/**\n * Checks if there is currently logged in user.\n * Use to protect pages dedicated only for logged in users.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthGuard implements CanActivate {\n  constructor(\n    protected authService: AuthService,\n    protected authRedirectService: AuthRedirectService,\n    protected router: Router,\n    protected semanticPathService: SemanticPathService\n  ) {}\n\n  canActivate(): Observable<boolean | UrlTree> {\n    return this.authService.isUserLoggedIn().pipe(\n      map((isLoggedIn) => {\n        if (!isLoggedIn) {\n          this.authRedirectService.reportAuthGuard();\n          return this.router.parseUrl(this.semanticPathService.get('login'));\n        }\n        return isLoggedIn;\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CanActivate, Router, UrlTree } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { SemanticPathService } from '../../../routing/configurable-routes/url-translation/semantic-path.service';\nimport { AuthService } from '../facade/auth.service';\nimport { AuthRedirectService } from '../services/auth-redirect.service';\n\n/**\n * Checks if there isn't any logged in user.\n * Use to protect pages dedicated only for guests (eg. login page).\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class NotAuthGuard implements CanActivate {\n  constructor(\n    protected authService: AuthService,\n    protected authRedirectService: AuthRedirectService,\n    protected semanticPathService: SemanticPathService,\n    protected router: Router\n  ) {}\n\n  canActivate(): Observable<boolean | UrlTree> {\n    this.authRedirectService.reportNotAuthGuard();\n\n    // redirect, if user is already logged in:\n    return this.authService.isUserLoggedIn().pipe(\n      map((isLoggedIn) => {\n        if (isLoggedIn) {\n          return this.router.parseUrl(this.semanticPathService.get('home'));\n        }\n        return !isLoggedIn;\n      })\n    );\n  }\n}\n","import { Observable } from 'rxjs';\nimport {\n  CustomerSearchOptions,\n  CustomerSearchPage,\n} from '../models/asm.models';\n\nexport abstract class AsmAdapter {\n  /**\n   * Abstract function used to search for customers.\n   */\n  abstract customerSearch(\n    options: CustomerSearchOptions\n  ): Observable<CustomerSearchPage>;\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccAsmConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        asmCustomerSearch: '/assistedservicewebservices/customers/search',\n      },\n    },\n  },\n};\n","import { OccConfig } from '../../occ/config/occ-config';\nimport { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class AsmConfig extends OccConfig {\n  asm?: {\n    agentSessionTimer?: {\n      startingDelayInSeconds?: number;\n    };\n    customerSearch?: {\n      maxResults?: number;\n    };\n  };\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../util/converter.service';\nimport { CustomerSearchPage } from '../models/asm.models';\n\nexport const CUSTOMER_SEARCH_PAGE_NORMALIZER = new InjectionToken<\n  Converter<any, CustomerSearchPage>\n>('CustomerSearchPageNormalizer');\n","import { Type } from '@angular/core';\n\n/**\n * Creates an instance of the given class and fills its properties with the given data.\n *\n * @param type reference to the class\n * @param data object with properties to be copied to the class\n */\nexport function createFrom<T>(type: Type<T>, data: T): T {\n  return Object.assign(new type(), data);\n}\n","import { NgModuleRef } from '@angular/core';\n\n/**\n * Will be thrown in case lazy loaded modules are loaded and instantiated.\n *\n * This event is thrown for cms driven lazy loaded feature modules amd it's\n * dependencies\n */\nexport class ModuleInitializedEvent {\n  /**\n   * Name/identifier of the feature associated with this module.\n   *\n   * You can differentiate between feature and dependency modules, as the latter\n   * won't have thus property set.\n   */\n  feature?: string;\n  /**\n   * Reference fpr lazy loaded module instance\n   */\n  moduleRef: NgModuleRef<any>;\n}\n","import { Observable, Subscriber, Subscription } from 'rxjs';\nimport { share } from 'rxjs/operators';\n\n// PRIVATE API\n\n/**\n * Allows for dynamic adding and removing source observables\n * and exposes them as one merged observable at a property `output$`.\n *\n * Thanks to the `share()` operator used inside, it subscribes to source observables\n * only when someone subscribes to it. And it unsubscribes from source observables\n * when the counter of consumers drops to 0.\n *\n * **To avoid memory leaks**, all manually added sources should be manually removed\n * when not plan to emit values anymore. In particular closed event sources won't be\n * automatically removed.\n */\nexport class MergingSubject<T> {\n  /**\n   * List of already added sources (but not removed yet)\n   */\n  private sources: Observable<T>[] = [];\n\n  /**\n   * For each source: it stores a subscription responsible for\n   * passing all values from source to the consumer\n   */\n  private subscriptionsToSources = new Map<Observable<T>, Subscription>();\n\n  /**\n   * Observable with all sources merged.\n   *\n   * Only after subscribing to it, under the hood it subscribes to the source observables.\n   * When the number of subscribers drops to 0, it unsubscribes from all source observables.\n   * But if later on something subscribes to it again, it subscribes to the source observables again.\n   *\n   * It multicasts the emissions for each subscriber.\n   */\n  readonly output$: Observable<T> = new Observable<T>((consumer) => {\n    // There can be only 0 or 1 consumer of this observable coming from the `share()` operator\n    // that is piped right after this observable.\n    // `share()` not only multicasts the results but also  When all end-subscribers unsubscribe from `share()` operator, it will unsubscribe\n    // from this observable (by the nature `refCount`-nature of the `share()` operator).\n\n    this.consumer = consumer;\n    this.bindAllSourcesToConsumer(consumer);\n\n    return () => {\n      this.consumer = null;\n      this.unbindAllSourcesFromConsumer();\n    };\n  }).pipe(share());\n\n  /**\n   * Reference to the subscriber coming from the `share()` operator piped to the `output$` observable.\n   * For more, see docs of the `output$` observable;\n   */\n  private consumer: Subscriber<any> = null;\n\n  /**\n   * Registers the given source to pass its values to the `output$` observable.\n   *\n   * It does nothing, when the source has been already added (but not removed yet).\n   */\n  add(source: Observable<T>): void {\n    if (this.has(source)) {\n      return;\n    }\n\n    if (this.consumer) {\n      this.bindSourceToConsumer(source, this.consumer);\n    }\n    this.sources.push(source);\n  }\n\n  /**\n   * Starts passing all values from already added sources to consumer\n   */\n  private bindAllSourcesToConsumer(consumer: Subscriber<T>) {\n    this.sources.forEach((source) =>\n      this.bindSourceToConsumer(source, consumer)\n    );\n  }\n\n  /**\n   * Stops passing all values from already added sources to consumer\n   * (if any consumer is active at the moment)\n   */\n  private unbindAllSourcesFromConsumer() {\n    this.sources.forEach((source) => this.unbindSourceFromConsumer(source));\n  }\n\n  /**\n   * Starts passing all values from a single source to consumer\n   */\n  private bindSourceToConsumer(source: Observable<T>, consumer: Subscriber<T>) {\n    const subscriptionToSource = source.subscribe((val) => consumer.next(val)); // passes all emissions from source to consumer\n    this.subscriptionsToSources.set(source, subscriptionToSource);\n  }\n\n  /**\n   * Stops passing all values from a single source to consumer\n   * (if any consumer is active at the moment)\n   */\n  private unbindSourceFromConsumer(source: Observable<T>) {\n    const subscriptionToSource = this.subscriptionsToSources.get(source);\n    if (subscriptionToSource !== undefined) {\n      subscriptionToSource.unsubscribe();\n      this.subscriptionsToSources.delete(source);\n    }\n  }\n\n  /**\n   * Unregisters the given source so it stops passing its values to `output$` observable.\n   *\n   * Should be used when a source is no longer maintained **to avoid memory leaks**.\n   */\n  remove(source: Observable<T>): void {\n    // clear binding from source to consumer (if any consumer exists at the moment)\n    this.unbindSourceFromConsumer(source);\n\n    // remove source from array\n    let i: number;\n    if ((i = this.sources.findIndex((s) => s === source)) !== -1) {\n      this.sources.splice(i, 1);\n    }\n  }\n\n  /**\n   * Returns whether the given source has been already addded\n   */\n  has(source: Observable<T>): boolean {\n    return this.sources.includes(source);\n  }\n}\n","import { Injectable, isDevMode, Type } from '@angular/core';\nimport { Observable, Subject } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { MergingSubject } from './utils/merging-subject';\n\n/**\n * The object holds registered source observables as well as the merged result observable.\n */\ninterface EventMeta<T> {\n  /**\n   * Input subject used for dispatching occasional event (without registering a source)\n   */\n  inputSubject$: Subject<T>;\n\n  /**\n   * A custom subject that allows for dynamic adding and removing sources to be merged as an output\n   */\n  mergingSubject: MergingSubject<T>;\n}\n\n/**\n * A service to register and observe event sources. Events are driven by event types, which are class signatures\n * for the given event.\n *\n * It is possible to register multiple sources to a single event, even without\n * knowing as multiple decoupled features can attach sources to the same\n * event type.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class EventService {\n  /**\n   * The various events meta are collected in a map, stored by the event type class\n   */\n  private eventsMeta = new Map<Type<any>, EventMeta<any>>();\n\n  /**\n   * Register an event source for the given event type.\n   *\n   * CAUTION: To avoid memory leaks, the returned teardown function should be called\n   *  when the event source is no longer maintained by its creator\n   * (i.e. in `ngOnDestroy` if the event source was registered in the component).\n   *\n   * @param eventType the event type\n   * @param source$ an observable that represents the source\n   *\n   * @returns a teardown function which unregisters the given event source\n   */\n  register<T>(eventType: Type<T>, source$: Observable<T>): () => void {\n    const eventMeta = this.getEventMeta(eventType);\n    if (eventMeta.mergingSubject.has(source$)) {\n      if (isDevMode()) {\n        console.warn(\n          `EventService: the event source`,\n          source$,\n          `has been already registered for the type`,\n          eventType\n        );\n      }\n    } else {\n      eventMeta.mergingSubject.add(source$);\n    }\n\n    return () => eventMeta.mergingSubject.remove(source$);\n  }\n\n  /**\n   * Returns a stream of events for the given event type\n   * @param eventTypes event type\n   */\n  get<T>(eventType: Type<T>): Observable<T> {\n    let output$ = this.getEventMeta(eventType).mergingSubject.output$;\n    if (isDevMode()) {\n      output$ = this.getValidatedEventStream(output$, eventType);\n    }\n    return output$;\n  }\n\n  /**\n   * Dispatches an instance of an individual event.\n   */\n  dispatch(event: Object): void {\n    const eventType = event.constructor as Type<any>;\n    const inputSubject$ = this.getInputSubject(eventType);\n    inputSubject$.next(event);\n  }\n\n  /**\n   * Returns the input subject used to dispatch a single event.\n   * The subject is created on demand, when it's needed for the first time.\n   * @param eventType type of event\n   */\n  private getInputSubject<T>(eventType: Type<T>): Subject<T> {\n    const eventMeta = this.getEventMeta(eventType);\n\n    if (!eventMeta.inputSubject$) {\n      eventMeta.inputSubject$ = new Subject<any>();\n      this.register(eventType, eventMeta.inputSubject$);\n    }\n    return eventMeta.inputSubject$;\n  }\n\n  /**\n   * Returns the event meta object for the given event type\n   */\n  private getEventMeta<T>(eventType: Type<T>): EventMeta<T> {\n    if (isDevMode()) {\n      this.validateEventType(eventType);\n    }\n\n    if (!this.eventsMeta.get(eventType)) {\n      this.createEventMeta(eventType);\n    }\n    return this.eventsMeta.get(eventType);\n  }\n\n  /**\n   * Creates the event meta object for the given event type\n   */\n  private createEventMeta<T>(eventType: Type<T>): void {\n    this.eventsMeta.set(eventType, {\n      inputSubject$: null, // will be created lazily by the `dispatch` method\n      mergingSubject: new MergingSubject(),\n    });\n  }\n\n  /**\n   * Checks if the event type is a valid type (is a class with constructor).\n   *\n   * Should be used only in dev mode.\n   */\n  private validateEventType<T>(eventType: Type<T>): void {\n    if (!eventType?.constructor) {\n      throw new Error(\n        `EventService:  ${eventType} is not a valid event type. Please provide a class reference.`\n      );\n    }\n  }\n\n  /**\n   * Returns the given event source with runtime validation whether the emitted values are instances of given event type.\n   *\n   * Should be used only in dev mode.\n   */\n  private getValidatedEventStream<T>(\n    source$: Observable<T>,\n    eventType: Type<T>\n  ): Observable<T> {\n    return source$.pipe(\n      tap((event) => {\n        if (!(event instanceof eventType)) {\n          console.warn(\n            `EventService: The stream`,\n            source$,\n            `emitted the event`,\n            event,\n            `that is not an instance of the declared type`,\n            eventType.name\n          );\n        }\n      })\n    );\n  }\n}\n","import {\n  AbstractType,\n  InjectFlags,\n  InjectionToken,\n  Injector,\n  Type,\n} from '@angular/core';\n\nconst NOT_FOUND_SYMBOL = {};\n\n/**\n * CombinedInjector is able to combine more than one injector together.\n *\n * Can be used to instantiate lazy loaded modules with dependency modules,\n * so lazy loaded module can use instances provided in all dependency modules.\n *\n * Injector tries to resolve token in all Injector, taking into account the order\n * in which they were provided in complementaryInjectors and fallbacks to the\n * mainInjector.\n */\nexport class CombinedInjector implements Injector {\n  /**\n   * @param mainInjector Component hierarchical injector\n   * @param complementaryInjectors Additional injector that will be taken into an account when resolving dependencies\n   */\n  constructor(\n    private mainInjector: Injector,\n    private complementaryInjectors: Injector[]\n  ) {}\n\n  get<T>(\n    token: Type<T> | InjectionToken<T> | AbstractType<T>,\n    notFoundValue?: T,\n    flags?: InjectFlags\n  ): T;\n  get(token: any, notFoundValue?: any): any;\n  get(token, notFoundValue?: any, flags?: InjectFlags): any {\n    // tslint:disable-next-line:no-bitwise\n    if (flags & InjectFlags.Self) {\n      if (notFoundValue !== undefined) {\n        return notFoundValue;\n      }\n      throw new Error(\n        \"CombinedInjector should be used as a parent injector / doesn't support self dependencies\"\n      );\n    }\n\n    for (const injector of [...this.complementaryInjectors]) {\n      // First we are resolving providers provided at Self level\n      // in all complementary injectors...\n      const service = injector.get(token, NOT_FOUND_SYMBOL, InjectFlags.Self);\n      if (service !== NOT_FOUND_SYMBOL) {\n        return service;\n      }\n    }\n    // ...and then fallback to main injector passing the flag\n    return this.mainInjector.get(token, notFoundValue, flags);\n  }\n}\n","import {\n  Compiler,\n  Injectable,\n  Injector,\n  NgModuleFactory,\n  NgModuleRef,\n  OnDestroy,\n} from '@angular/core';\nimport {\n  combineLatest,\n  ConnectableObservable,\n  from,\n  Observable,\n  of,\n  queueScheduler,\n  Subscription,\n} from 'rxjs';\nimport { map, observeOn, publishReplay, switchMap, tap } from 'rxjs/operators';\nimport { createFrom } from '../util/create-from';\nimport { ModuleInitializedEvent } from './events/module-initialized-event';\nimport { EventService } from '../event/event.service';\nimport { CombinedInjector } from '../util/combined-injector';\n\n/**\n * Utility service for managing dynamic imports of Angular services\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class LazyModulesService implements OnDestroy {\n  /**\n   * Expose lazy loaded module references\n   */\n  readonly modules$: Observable<NgModuleRef<any>> = this.events\n    .get(ModuleInitializedEvent)\n    .pipe(\n      map((event) => event.moduleRef),\n      publishReplay()\n    );\n\n  private readonly dependencyModules = new Map<any, NgModuleRef<any>>();\n  private readonly eventSubscription: Subscription;\n\n  constructor(\n    protected compiler: Compiler,\n    protected injector: Injector,\n    protected events: EventService\n  ) {\n    this.eventSubscription = (this.modules$ as ConnectableObservable<\n      NgModuleRef<any>\n    >).connect();\n  }\n\n  /**\n   * Resolves module instance based dynamic import wrapped in an arrow function\n   *\n   * New module instance will be created with each call.\n   *\n   * @param moduleFunc\n   * @param feature\n   */\n  public resolveModuleInstance(\n    moduleFunc: () => Promise<any>,\n    feature?: string,\n    dependencyModuleRefs: NgModuleRef<any>[] = []\n  ): Observable<NgModuleRef<any>> {\n    const parentInjector = dependencyModuleRefs.length\n      ? new CombinedInjector(\n          this.injector,\n          dependencyModuleRefs.map((moduleRef) => moduleRef.injector)\n        )\n      : this.injector;\n\n    return this.resolveModuleFactory(moduleFunc).pipe(\n      map(([moduleFactory]) => moduleFactory.create(parentInjector)),\n      tap((moduleRef) =>\n        this.events.dispatch(\n          createFrom(ModuleInitializedEvent, {\n            feature,\n            moduleRef,\n          })\n        )\n      )\n    );\n  }\n\n  /**\n   * Returns dependency module instance and initializes it when needed.\n   *\n   * Module will be instantiated only once, at first request for a this specific module class\n   */\n  public resolveDependencyModuleInstance(\n    moduleFunc: () => Promise<any>\n  ): Observable<NgModuleRef<any>> {\n    // We grab moduleFactory symbol from module function and if there is no\n    // such a module created yet, we create it and store it in a\n    // dependencyModules map\n    return this.resolveModuleFactory(moduleFunc).pipe(\n      map(([moduleFactory, module]) => {\n        if (!this.dependencyModules.has(module)) {\n          const moduleRef = moduleFactory.create(this.injector);\n          this.dependencyModules.set(module, moduleRef);\n        }\n\n        return this.dependencyModules.get(module);\n      }),\n      tap((moduleRef) =>\n        this.events.dispatch(\n          createFrom(ModuleInitializedEvent, {\n            moduleRef,\n          })\n        )\n      )\n    );\n  }\n\n  /**\n   * Resolve any Angular module from an function that return module or moduleFactory\n   */\n  private resolveModuleFactory(\n    moduleFunc: () => Promise<any>\n  ): Observable<[NgModuleFactory<any>, any]> {\n    return from(moduleFunc()).pipe(\n      switchMap((module) =>\n        module instanceof NgModuleFactory\n          ? (of([module, module]) as Observable<[NgModuleFactory<any>, any]>)\n          : combineLatest([\n              // using compiler here is for jit compatibility, there is no overhead\n              // for aot production builds as it will be stubbed\n              from(this.compiler.compileModuleAsync(module as any)),\n              of(module),\n            ])\n      ),\n      observeOn(queueScheduler)\n    );\n  }\n\n  ngOnDestroy(): void {\n    if (this.eventSubscription) {\n      this.eventSubscription.unsubscribe();\n    }\n\n    // clean up all initialized dependency modules\n    this.dependencyModules.forEach((dependency) => dependency.destroy());\n  }\n}\n","import {\n  AbstractType,\n  Injectable,\n  InjectFlags,\n  InjectionToken,\n  Injector,\n  Type,\n} from '@angular/core';\nimport { LazyModulesService } from './lazy-modules.service';\nimport { Observable } from 'rxjs';\nimport { filter, map, scan, startWith } from 'rxjs/operators';\n\nconst NOT_FOUND_SYMBOL: any = {};\n\n/**\n * UnifiedInjector provides a way to get instances of tokens not only once, from the root injector,\n * but also from lazy loaded module injectors that can be initialized over time.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class UnifiedInjector {\n  /**\n   * Gather all the injectors, with the root injector as a first one\n   *\n   */\n  readonly injectors$: Observable<Injector> = this.lazyModules.modules$.pipe(\n    map((moduleRef) => moduleRef.injector),\n    startWith(this.rootInjector)\n  );\n\n  constructor(\n    protected rootInjector: Injector,\n    protected lazyModules: LazyModulesService\n  ) {}\n\n  /**\n   * Gen instances for specified tokens.\n   *\n   * When notFoundValue is provided, it will consistently emit once per injector,\n   * even if injector doesn't contain instances for specified token.\n   * Otherwise, emissions will only involve cases, where new instances will be found.\n   *\n   * @param token\n   * @param notFoundValue\n   */\n  get<T>(\n    token: Type<T> | InjectionToken<T> | AbstractType<T>,\n    notFoundValue?: T\n  ): Observable<T> {\n    return this.injectors$.pipe(\n      map((injector, index) =>\n        injector.get<T>(\n          token,\n          notFoundValue ?? NOT_FOUND_SYMBOL,\n          // we want to get only Self instances from all injectors except the\n          // first one, which is a root injector\n          index ? InjectFlags.Self : undefined\n        )\n      ),\n      filter((instance) => instance !== NOT_FOUND_SYMBOL)\n    );\n  }\n\n  /**\n   * Get multi provided instances for a specified token\n   *\n   * @param token\n   */\n  getMulti<T>(\n    token: Type<T> | InjectionToken<T> | AbstractType<T>\n  ): Observable<T[]>;\n  getMulti<T>(token: any): Observable<T>;\n  getMulti<T>(\n    token: Type<T> | InjectionToken<T> | AbstractType<T> | any\n  ): Observable<T[]> {\n    return this.get(token, []).pipe(\n      filter((instances) => {\n        if (!Array.isArray(instances)) {\n          throw new Error(\n            `Multi-providers mixed with single providers for ${token.toString()}!`\n          );\n        }\n        return instances.length > 0;\n      }),\n      scan((acc, services) => [...acc, ...services], [])\n    );\n  }\n}\n","import { Observable } from 'rxjs';\n\n/**\n * Will grab last synchronously available value from the observable stream\n * at the time of the call.\n *\n * Should be used with caution, as it's not a legitimate way for getting value\n * from the observable. Observable composition or standard subscribe method\n * should be used for most of the cases.\n *\n * @param source\n */\nexport function getLastValueSync<T>(source: Observable<T>): T | undefined {\n  let value: T | undefined;\n  source.subscribe((emission) => (value = emission)).unsubscribe();\n  return value;\n}\n","import { Injectable, InjectionToken, OnDestroy } from '@angular/core';\nimport { Observable, OperatorFunction, Subscription } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { UnifiedInjector } from '../lazy-loading/unified-injector';\nimport { getLastValueSync } from './rxjs/get-last-value-sync';\n\n/**\n * Converter is used to convert source data model to target data model.\n * By convention, we distinguish two flows:\n *   - *Normalize* is the conversion from backend models to UI models\n *   - *Serialize* is the conversion of UI models to backend models (in case of submitting data to the backend).\n *\n * Converters can be stacked together to to apply decoupled customizations\n */\nexport interface Converter<S, T> {\n  /**\n   * Convert converts source model to target model. Can use optional target parameter,\n   * used in case of stacking multiple converters (for example, to implement populator pattern).\n   *\n   * @param source Source data model\n   * @param target Optional, partially converted target model\n   */\n  convert(source: S, target?: T): T;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConverterService implements OnDestroy {\n  protected subscriptions = new Subscription();\n\n  constructor(protected unifiedInjector: UnifiedInjector) {\n    // Clear cached converters when new injectors appear\n    const cacheResetLogic = this.unifiedInjector.injectors$.pipe(\n      tap(() => this.converters.clear())\n    );\n\n    this.subscriptions.add(cacheResetLogic.subscribe());\n  }\n\n  private converters: Map<\n    InjectionToken<Converter<any, any>>,\n    Converter<any, any>[]\n  > = new Map();\n\n  private getConverters<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): Converter<S, T>[] {\n    if (!this.converters.has(injectionToken)) {\n      const converters = getLastValueSync(\n        this.unifiedInjector.getMulti(injectionToken)\n      );\n      this.converters.set(injectionToken, converters);\n    }\n\n    return this.converters.get(injectionToken);\n  }\n\n  /**\n   * Will return true if converters for specified token were provided\n   */\n  hasConverters<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): boolean {\n    const converters = this.getConverters(injectionToken);\n    return Array.isArray(converters) && converters.length > 0;\n  }\n\n  /**\n   * Pipeable operator to apply converter logic in a observable stream\n   */\n  pipeable<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): OperatorFunction<S, T> {\n    if (this.hasConverters(injectionToken)) {\n      return map((model: S) => this.convertSource(model, injectionToken));\n    } else {\n      return (observable: Observable<any>) => observable as Observable<T>;\n    }\n  }\n\n  /**\n   * Pipeable operator to apply converter logic in a observable stream to collection of items\n   */\n  pipeableMany<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): OperatorFunction<S[], T[]> {\n    if (this.hasConverters(injectionToken)) {\n      return map((model: S[]) => this.convertMany(model, injectionToken));\n    } else {\n      return (observable: Observable<any[]>) => observable as Observable<T[]>;\n    }\n  }\n\n  /**\n   * Apply converter logic specified by injection token to source data\n   */\n  convert<S, T>(source: S, injectionToken: InjectionToken<Converter<S, T>>): T {\n    if (this.hasConverters(injectionToken)) {\n      return this.convertSource(source, injectionToken);\n    } else {\n      return source as any;\n    }\n  }\n\n  /**\n   * Apply converter logic specified by injection token to a collection\n   */\n  convertMany<S, T>(\n    sources: S[],\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): T[] {\n    if (this.hasConverters(injectionToken) && Array.isArray(sources)) {\n      return sources.map((source) =>\n        this.convertSource(source, injectionToken)\n      );\n    } else {\n      return sources as any[];\n    }\n  }\n\n  private convertSource<S, T>(\n    source: S,\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): T {\n    return this.getConverters(injectionToken).reduce((target, converter) => {\n      return converter.convert(source, target);\n    }, undefined as T);\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { AsmConfig } from '../../../asm/config/asm-config';\nimport { AsmAdapter } from '../../../asm/connectors/asm.adapter';\nimport { CUSTOMER_SEARCH_PAGE_NORMALIZER } from '../../../asm/connectors/converters';\nimport {\n  CustomerSearchOptions,\n  CustomerSearchPage,\n} from '../../../asm/models/asm.models';\nimport { BaseSiteService } from '../../../site-context/facade/base-site.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n} from '../../utils/interceptor-util';\n\n@Injectable()\nexport class OccAsmAdapter implements AsmAdapter {\n  private activeBaseSite: string;\n\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService,\n    protected config: AsmConfig,\n    protected baseSiteService: BaseSiteService\n  ) {\n    this.baseSiteService\n      .getActive()\n      .subscribe((value) => (this.activeBaseSite = value));\n  }\n\n  customerSearch(\n    options: CustomerSearchOptions\n  ): Observable<CustomerSearchPage> {\n    const headers = InterceptorUtil.createHeader(\n      USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n      true,\n      new HttpHeaders()\n    );\n    let params: HttpParams = new HttpParams()\n      .set('baseSite', this.activeBaseSite)\n      .set('sort', 'byNameAsc');\n\n    if (typeof options['query'] !== 'undefined') {\n      params = params.set('query', '' + options.query);\n    }\n\n    if (typeof options['pageSize'] !== 'undefined') {\n      params = params.set('pageSize', '' + options.pageSize);\n    }\n\n    const url = this.occEndpointsService.getRawEndpoint('asmCustomerSearch');\n\n    return this.http\n      .get<CustomerSearchPage>(url, { headers, params })\n      .pipe(this.converterService.pipeable(CUSTOMER_SEARCH_PAGE_NORMALIZER));\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { AsmAdapter } from '../../../asm/connectors/asm.adapter';\nimport { defaultOccAsmConfig } from './default-occ-asm-config';\nimport { OccAsmAdapter } from './occ-asm.adapter';\nimport { provideDefaultConfig } from '../../../config/config-providers';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccAsmConfig),\n    {\n      provide: AsmAdapter,\n      useClass: OccAsmAdapter,\n    },\n  ],\n})\nexport class AsmOccModule {}\n","import { Observable } from 'rxjs';\nimport { Cart } from '../../../model/cart.model';\n\nexport abstract class CartAdapter {\n  /**\n   * Abstract method used to load all carts\n   *\n   * @param userId\n   */\n  abstract loadAll(userId: string): Observable<Cart[]>;\n\n  /**\n   * Abstract method used to load cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract load(userId: string, cartId: string): Observable<Cart>;\n\n  /**\n   * Abstract method used to create cart. If toMergeCartGuid is specified, cart will be merged with existing one\n   *\n   * @param userId\n   * @param oldCartId\n   * @param toMergeCartGuid\n   */\n  abstract create(\n    userId: string,\n    oldCartId?: string,\n    toMergeCartGuid?: string\n  ): Observable<Cart>;\n\n  /**\n   * Abstract method used to delete cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract delete(userId: string, cartId: string): Observable<{}>;\n\n  /**\n   * Abstract method to assign an email to the cart. This step is required to make a guest checkout\n   * @param userId\n   * @param cartId\n   * @param email\n   */\n  abstract addEmail(\n    userId: string,\n    cartId: string,\n    email: string\n  ): Observable<{}>;\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Cart } from '../../../model/cart.model';\n\nexport const CART_NORMALIZER = new InjectionToken<Converter<any, Cart>>(\n  'CartNormalizer'\n);\n","import { Observable } from 'rxjs';\nimport { CartModification } from '../../../model/cart.model';\n\nexport abstract class CartEntryAdapter {\n  /**\n   * Abstract method used to add entry to cart\n   *\n   * @param userId\n   * @param cartId\n   * @param productCode\n   * @param quantity\n   */\n  abstract add(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity?: number\n  ): Observable<CartModification>;\n\n  /**\n   * Abstract method used to update entry in cart\n   * @param userId\n   * @param cartId\n   * @param entryNumber\n   * @param qty\n   * @param pickupStore\n   */\n  abstract update(\n    userId: string,\n    cartId: string,\n    entryNumber: string,\n    qty: number,\n    pickupStore?: string\n  ): Observable<CartModification>;\n\n  /**\n   * Abstract method used to remove entry from cart\n   *\n   * @param userId\n   * @param cartId\n   * @param entryNumber\n   */\n  abstract remove(\n    userId: string,\n    cartId: string,\n    entryNumber: string\n  ): Observable<any>;\n}\n","import { Observable } from 'rxjs';\nimport { SaveCartResult } from '../../../model/cart.model';\n\nexport abstract class SaveCartAdapter {\n  /**\n   * Abstract method used to save a cart\n   *\n   * @param userId: string\n   * @param cartId: string\n   * @param saveCartName?: string\n   * @param saveCartDescription?: string\n   */\n  abstract saveCart(\n    userId: string,\n    cartId: string,\n    saveCartName?: string,\n    saveCartDescription?: string\n  ): Observable<SaveCartResult>;\n}\n","import { Observable } from 'rxjs';\n\nexport abstract class CartVoucherAdapter {\n  /**\n   * Abstract method used to apply voucher to cart\n   *\n   * @param userId\n   * @param cartId\n   * @param voucherId\n   */\n  abstract add(\n    userId: string,\n    cartId: string,\n    voucherId: string\n  ): Observable<{}>;\n\n  /**\n   * Abstract method used to remove voucher from cart\n   *\n   * @param userId\n   * @param cartId\n   * @param voucherId\n   */\n  abstract remove(\n    userId: string,\n    cartId: string,\n    voucherId: string\n  ): Observable<{}>;\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Product } from '../../../model/product.model';\n\nexport const PRODUCT_NORMALIZER = new InjectionToken<Converter<any, Product>>(\n  'ProductNormalizer'\n);\n","import { Injectable } from '@angular/core';\nimport { Cart } from '../../../../model/cart.model';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccCartNormalizer implements Converter<Occ.Cart, Cart> {\n  constructor(private converter: ConverterService) {}\n\n  convert(source: Occ.Cart, target?: Cart): Cart {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source && source.entries) {\n      target.entries = source.entries.map((entry) => ({\n        ...entry,\n        product: this.converter.convert(entry.product, PRODUCT_NORMALIZER),\n      }));\n    }\n\n    this.removeDuplicatePromotions(source, target);\n    return target;\n  }\n\n  /**\n   * Remove all duplicate promotions\n   */\n  private removeDuplicatePromotions(source: any, target: Cart): void {\n    if (source && source.potentialOrderPromotions) {\n      target.potentialOrderPromotions = this.removeDuplicateItems(\n        source.potentialOrderPromotions\n      );\n    }\n\n    if (source && source.potentialProductPromotions) {\n      target.potentialProductPromotions = this.removeDuplicateItems(\n        source.potentialProductPromotions\n      );\n    }\n\n    if (source && source.appliedOrderPromotions) {\n      target.appliedOrderPromotions = this.removeDuplicateItems(\n        source.appliedOrderPromotions\n      );\n    }\n\n    if (source && source.appliedProductPromotions) {\n      target.appliedProductPromotions = this.removeDuplicateItems(\n        source.appliedProductPromotions\n      );\n    }\n  }\n\n  private removeDuplicateItems(itemList: any[]): any[] {\n    return itemList.filter((p, i, a) => {\n      const b = a.map((el) => JSON.stringify(el));\n      return i === b.indexOf(JSON.stringify(p));\n    });\n  }\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccCartConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        // tslint:disable:max-line-length\n        carts:\n          'users/${userId}/carts?fields=carts(DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),saveTime,user,name)',\n        cart:\n          'users/${userId}/carts/${cartId}?fields=DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user',\n        createCart:\n          'users/${userId}/carts?fields=DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user',\n        addEntries: 'users/${userId}/carts/${cartId}/entries',\n        updateEntries: 'users/${userId}/carts/${cartId}/entries/${entryNumber}',\n        removeEntries: 'users/${userId}/carts/${cartId}/entries/${entryNumber}',\n        addEmail: 'users/${userId}/carts/${cartId}/email',\n        deleteCart: 'users/${userId}/carts/${cartId}',\n        cartVoucher: 'users/${userId}/carts/${cartId}/vouchers',\n        saveCart: 'users/${userId}/carts/${cartId}/save',\n        // tslint:enable\n      },\n    },\n  },\n};\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { CartModification } from '../../../model/cart.model';\n\nexport const CART_MODIFICATION_NORMALIZER = new InjectionToken<\n  Converter<any, CartModification>\n>('CartModificationNormalizer');\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CartEntryAdapter } from '../../../cart/connectors/entry/cart-entry.adapter';\nimport { CART_MODIFICATION_NORMALIZER } from '../../../cart/connectors/entry/converters';\nimport { CartModification } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCartEntryAdapter implements CartEntryAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService\n  ) {}\n\n  public add(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity: number = 1\n  ): Observable<CartModification> {\n    const toAdd = JSON.stringify({});\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    const url = this.occEndpointsService.getUrl(\n      'addEntries',\n      {\n        userId,\n        cartId,\n        quantity, // The \"quantity\" parameter is required for the b2b add to cart endpoint.\n      },\n      { code: productCode, qty: quantity } // The \"qty\" parameter is used for the base b2c add to cart endpoint.\n    );\n\n    return this.http\n      .post<CartModification>(url, toAdd, { headers })\n      .pipe(this.converterService.pipeable(CART_MODIFICATION_NORMALIZER));\n  }\n\n  public update(\n    userId: string,\n    cartId: string,\n    entryNumber: string,\n    qty: number,\n    pickupStore?: string\n  ): Observable<CartModification> {\n    let params = {};\n    if (pickupStore) {\n      params = { pickupStore };\n    }\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    const url = this.occEndpointsService.getUrl(\n      'updateEntries',\n      { userId, cartId, entryNumber },\n      { qty, ...params }\n    );\n\n    return this.http\n      .patch<CartModification>(url, {}, { headers })\n      .pipe(this.converterService.pipeable(CART_MODIFICATION_NORMALIZER));\n  }\n\n  public remove(\n    userId: string,\n    cartId: string,\n    entryNumber: string\n  ): Observable<any> {\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    const url = this.occEndpointsService.getUrl('removeEntries', {\n      userId,\n      cartId,\n      entryNumber,\n    });\n\n    return this.http.delete(url, { headers });\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Voucher } from '../../../model/cart.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const CART_VOUCHER_NORMALIZER = new InjectionToken<\n  Converter<any, Voucher>\n>('CartVoucherNormalizer');\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { CartVoucherAdapter } from '../../../cart/connectors/voucher/cart-voucher.adapter';\nimport { CART_VOUCHER_NORMALIZER } from '../../../cart/connectors/voucher/converters';\nimport { OCC_USER_ID_ANONYMOUS } from '../../utils/occ-constants';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\n\n@Injectable()\nexport class OccCartVoucherAdapter implements CartVoucherAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getCartVoucherEndpoint(userId: string, cartId): string {\n    return this.occEndpoints.getUrl('cartVoucher', { userId, cartId });\n  }\n\n  protected getHeaders(userId: string): HttpHeaders {\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n\n    return headers;\n  }\n\n  add(userId: string, cartId: string, voucherId: string): Observable<{}> {\n    const url = this.getCartVoucherEndpoint(userId, cartId);\n\n    const toAdd = JSON.stringify({});\n\n    const params: HttpParams = new HttpParams().set('voucherId', voucherId);\n\n    const headers = this.getHeaders(userId);\n\n    return this.http.post(url, toAdd, { headers, params }).pipe(\n      catchError((error: any) => throwError(error)),\n      this.converter.pipeable(CART_VOUCHER_NORMALIZER)\n    );\n  }\n\n  remove(userId: string, cartId: string, voucherId: string): Observable<{}> {\n    const url =\n      this.getCartVoucherEndpoint(userId, cartId) +\n      '/' +\n      encodeURIComponent(voucherId);\n\n    const headers = this.getHeaders(userId);\n\n    return this.http\n      .delete(url, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map, pluck } from 'rxjs/operators';\nimport { CartAdapter } from '../../../cart/connectors/cart/cart.adapter';\nimport { CART_NORMALIZER } from '../../../cart/connectors/cart/converters';\nimport { Cart } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\nimport {\n  OCC_CART_ID_CURRENT,\n  OCC_USER_ID_ANONYMOUS,\n} from '../../utils/occ-constants';\n\n@Injectable()\nexport class OccCartAdapter implements CartAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService\n  ) {}\n\n  public loadAll(userId: string): Observable<Cart[]> {\n    return this.http\n      .get<Occ.CartList>(this.occEndpointsService.getUrl('carts', { userId }))\n      .pipe(\n        pluck('carts'),\n        this.converterService.pipeableMany(CART_NORMALIZER)\n      );\n  }\n\n  public load(userId: string, cartId: string): Observable<Cart> {\n    if (cartId === OCC_CART_ID_CURRENT) {\n      return this.loadAll(userId).pipe(\n        map((carts) => {\n          if (carts) {\n            const activeCart = carts.find((cart) => {\n              return cart['saveTime'] === undefined;\n            });\n            return activeCart;\n          } else {\n            return null;\n          }\n        })\n      );\n    } else {\n      return this.http\n        .get<Occ.Cart>(\n          this.occEndpointsService.getUrl('cart', { userId, cartId })\n        )\n        .pipe(this.converterService.pipeable(CART_NORMALIZER));\n    }\n  }\n\n  create(\n    userId: string,\n    oldCartId?: string,\n    toMergeCartGuid?: string\n  ): Observable<Cart> {\n    const toAdd = JSON.stringify({});\n\n    let params = {};\n\n    if (oldCartId) {\n      params = { oldCartId: oldCartId };\n    }\n    if (toMergeCartGuid) {\n      params['toMergeCartGuid'] = toMergeCartGuid;\n    }\n\n    return this.http\n      .post<Occ.Cart>(\n        this.occEndpointsService.getUrl('createCart', { userId }, params),\n        toAdd\n      )\n      .pipe(this.converterService.pipeable(CART_NORMALIZER));\n  }\n\n  delete(userId: string, cartId: string): Observable<{}> {\n    let headers = new HttpHeaders();\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n    return this.http.delete<{}>(\n      this.occEndpointsService.getUrl('deleteCart', { userId, cartId }),\n      { headers }\n    );\n  }\n\n  addEmail(userId: string, cartId: string, email: string): Observable<{}> {\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n\n    const httpParams: HttpParams = new HttpParams().set('email', email);\n\n    const url = this.occEndpointsService.getUrl('addEmail', {\n      userId,\n      cartId,\n    });\n\n    return this.http.put(url, httpParams, { headers });\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { SaveCartResult } from '../../../model/cart.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const SAVE_CART_NORMALIZER = new InjectionToken<\n  Converter<any, SaveCartResult>\n>('SaveCartNormalizer');\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { SAVE_CART_NORMALIZER } from '../../../cart/connectors/save-cart/converters';\nimport { SaveCartAdapter } from '../../../cart/connectors/save-cart/save-cart.adapter';\nimport { SaveCartResult } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccSaveCartAdapter implements SaveCartAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService\n  ) {}\n\n  public saveCart(\n    userId: string,\n    cartId: string,\n    saveCartName?: string,\n    saveCartDescription?: string\n  ): Observable<SaveCartResult> {\n    let httpParams = new HttpParams();\n\n    if (Boolean(saveCartName)) {\n      httpParams = httpParams.set('saveCartName', saveCartName);\n    }\n\n    if (Boolean(saveCartDescription)) {\n      httpParams = httpParams.set('saveCartDescription', saveCartDescription);\n    }\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .patch<Occ.SaveCartResult>(\n        this.occEndpointsService.getUrl('saveCart', { userId, cartId }),\n        httpParams,\n        { headers }\n      )\n      .pipe(this.converterService.pipeable(SAVE_CART_NORMALIZER));\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { CartAdapter } from '../../../cart/connectors/cart/cart.adapter';\nimport { CART_NORMALIZER } from '../../../cart/connectors/cart/converters';\nimport { CartEntryAdapter } from '../../../cart/connectors/entry/cart-entry.adapter';\nimport { SaveCartAdapter } from '../../../cart/connectors/save-cart/save-cart.adapter';\nimport { CartVoucherAdapter } from '../../../cart/connectors/voucher/cart-voucher.adapter';\nimport { OccCartNormalizer } from './converters/occ-cart-normalizer';\nimport { defaultOccCartConfig } from './default-occ-cart-config';\nimport { OccCartEntryAdapter } from './occ-cart-entry.adapter';\nimport { OccCartVoucherAdapter } from './occ-cart-voucher.adapter';\nimport { OccCartAdapter } from './occ-cart.adapter';\nimport { OccSaveCartAdapter } from './occ-save-cart.adapter';\nimport { provideDefaultConfig } from '../../../config/config-providers';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccCartConfig),\n    {\n      provide: CartAdapter,\n      useClass: OccCartAdapter,\n    },\n    {\n      provide: CART_NORMALIZER,\n      useExisting: OccCartNormalizer,\n      multi: true,\n    },\n    {\n      provide: CartEntryAdapter,\n      useClass: OccCartEntryAdapter,\n    },\n    {\n      provide: CartVoucherAdapter,\n      useClass: OccCartVoucherAdapter,\n    },\n    {\n      provide: SaveCartAdapter,\n      useClass: OccSaveCartAdapter,\n    },\n  ],\n})\nexport class CartOccModule {}\n","import { Observable } from 'rxjs';\nimport { Order } from '../../../model/order.model';\nimport { CheckoutDetails } from '../../models/checkout.model';\n\nexport abstract class CheckoutAdapter {\n  /**\n   * Abstract method used to place an order.\n   *\n   * @param userId The `userId` for given user\n   * @param cartId The `cartId` for cart used for placing order\n   * @param termsChecked The `boolean value` whether the terms were accepted or not\n   */\n  abstract placeOrder(\n    userId: string,\n    cartId: string,\n    termsChecked: boolean\n  ): Observable<Order>;\n\n  /**\n   * Abstract method used to load checkout details\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract loadCheckoutDetails(\n    userId: string,\n    cartId: string\n  ): Observable<CheckoutDetails>;\n\n  /**\n   * Abstract method used to clear checkout delivery address\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract clearCheckoutDeliveryAddress(\n    userId: string,\n    cartId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to clear checkout delivery mode\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract clearCheckoutDeliveryMode(\n    userId: string,\n    cartId: string\n  ): Observable<any>;\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Order } from '../../../model/order.model';\nimport { PointOfService } from '../../../model/point-of-service.model';\n\nexport const ORDER_NORMALIZER = new InjectionToken<Converter<any, Order>>(\n  'OrderNormalizer'\n);\n\nexport const POINT_OF_SERVICE_NORMALIZER = new InjectionToken<\n  Converter<any, PointOfService>\n>('PointOfServiceNormalizer');\n","import { Observable } from 'rxjs';\nimport { Cart } from '../../../model/cart.model';\n\nexport abstract class CheckoutCostCenterAdapter {\n  /**\n   * Abstract method used to set cost center to cart\n   *\n   * @param userId: user id\n   * @param cartId: cart id\n   * @param costCenterId: cost center id\n   */\n  abstract setCostCenter(\n    userId: string,\n    cartId: string,\n    costCenterId: string\n  ): Observable<Cart>;\n}\n","import { Observable } from 'rxjs';\nimport { Address } from '../../../model/address.model';\nimport { DeliveryMode } from '../../../model/order.model';\n\nexport abstract class CheckoutDeliveryAdapter {\n  /**\n   * Abstract method used to create address in cart\n   *\n   * @param userId\n   * @param cartId\n   * @param address\n   */\n  abstract createAddress(\n    userId: string,\n    cartId: string,\n    address: Address\n  ): Observable<Address>;\n\n  /**\n   * Abstract method used to set adress for delivery\n   *\n   * @param userId\n   * @param cartId\n   * @param addressId\n   */\n  abstract setAddress(\n    userId: string,\n    cartId: string,\n    addressId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to set delivery mode on cart\n   *\n   * @param userId\n   * @param cartId\n   * @param deliveryModeId\n   */\n  abstract setMode(\n    userId: string,\n    cartId: string,\n    deliveryModeId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to get current delivery mode from cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract getMode(userId: string, cartId: string): Observable<DeliveryMode>;\n\n  /**\n   * Abstract method used to get supported delivery modes for cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract getSupportedModes(\n    userId: string,\n    cartId: string\n  ): Observable<DeliveryMode[]>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Order } from '../../../model/order.model';\nimport { CheckoutDetails } from '../../models/checkout.model';\nimport { CheckoutAdapter } from './checkout.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutConnector {\n  constructor(protected adapter: CheckoutAdapter) {}\n\n  public placeOrder(\n    userId: string,\n    cartId: string,\n    termsChecked: boolean\n  ): Observable<Order> {\n    return this.adapter.placeOrder(userId, cartId, termsChecked);\n  }\n\n  public loadCheckoutDetails(\n    userId: string,\n    cartId: string\n  ): Observable<CheckoutDetails> {\n    return this.adapter.loadCheckoutDetails(userId, cartId);\n  }\n\n  public clearCheckoutDeliveryAddress(\n    userId: string,\n    cartId: string\n  ): Observable<any> {\n    return this.adapter.clearCheckoutDeliveryAddress(userId, cartId);\n  }\n\n  public clearCheckoutDeliveryMode(\n    userId: string,\n    cartId: string\n  ): Observable<any> {\n    return this.adapter.clearCheckoutDeliveryMode(userId, cartId);\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { CheckoutCostCenterAdapter } from './checkout-cost-center.adapter';\nimport { Cart } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutCostCenterConnector {\n  constructor(protected adapter: CheckoutCostCenterAdapter) {}\n\n  setCostCenter(\n    userId: string,\n    cartId: string,\n    costCenterId: string\n  ): Observable<Cart> {\n    return this.adapter.setCostCenter(userId, cartId, costCenterId);\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { CheckoutDeliveryAdapter } from './checkout-delivery.adapter';\nimport { Address } from '../../../model/address.model';\nimport { DeliveryMode } from '../../../model/order.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutDeliveryConnector {\n  constructor(protected adapter: CheckoutDeliveryAdapter) {}\n\n  public createAddress(\n    userId: string,\n    cartId: string,\n    address: Address\n  ): Observable<Address> {\n    return this.adapter.createAddress(userId, cartId, address);\n  }\n\n  public setAddress(\n    userId: string,\n    cartId: string,\n    addressId: string\n  ): Observable<any> {\n    return this.adapter.setAddress(userId, cartId, addressId);\n  }\n\n  public setMode(\n    userId: string,\n    cartId: string,\n    deliveryModeId: string\n  ): Observable<any> {\n    return this.adapter.setMode(userId, cartId, deliveryModeId);\n  }\n\n  public getMode(userId: string, cartId: string): Observable<DeliveryMode> {\n    return this.adapter.getMode(userId, cartId);\n  }\n\n  public getSupportedModes(\n    userId: string,\n    cartId: string\n  ): Observable<DeliveryMode[]> {\n    return this.adapter.getSupportedModes(userId, cartId);\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { DeliveryMode } from '../../../model/order.model';\n\nexport const DELIVERY_MODE_NORMALIZER = new InjectionToken<\n  Converter<any, DeliveryMode>\n>('DeliveryModeNormalizer');\n","import { Observable } from 'rxjs';\nimport { PaymentType } from '../../../model/cart.model';\n\nexport abstract class PaymentTypeAdapter {\n  /**\n   * Abstract method used to get available payment types\n   */\n  abstract loadPaymentTypes(): Observable<PaymentType[]>;\n\n  /**\n   * Abstract method used to set payment type to cart\n   *\n   * @param userId\n   * @param cartId\n   * @param typeCode\n   * @param poNumber: purchase order number\n   */\n  abstract setPaymentType(\n    userId: string,\n    cartId: string,\n    typeCode: string,\n    poNumber?: string\n  ): Observable<any>;\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { PaymentTypeAdapter } from './payment-type.adapter';\nimport { PaymentType } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class PaymentTypeConnector {\n  constructor(protected adapter: PaymentTypeAdapter) {}\n\n  getPaymentTypes(): Observable<PaymentType[]> {\n    return this.adapter.loadPaymentTypes();\n  }\n\n  setPaymentType(\n    userId: string,\n    cartId: string,\n    typeCode: string,\n    poNumber?: string\n  ): Observable<any> {\n    return this.adapter.setPaymentType(userId, cartId, typeCode, poNumber);\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { PaymentType } from '../../../model/cart.model';\n\nexport const PAYMENT_TYPE_NORMALIZER = new InjectionToken<\n  Converter<any, PaymentType>\n>('PaymentTypeNormalizer');\n","import { Observable } from 'rxjs';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\n\nexport abstract class CheckoutPaymentAdapter {\n  /**\n   * Abstract method used to create payment details on cart\n   *\n   * @param userId\n   * @param cartId\n   * @param paymentDetails\n   */\n  abstract create(\n    userId: string,\n    cartId: string,\n    paymentDetails: PaymentDetails\n  ): Observable<PaymentDetails>;\n\n  /**\n   * Abstract method used to set payment details on cart\n   *\n   * @param userId\n   * @param cartId\n   * @param paymentDetailsId\n   */\n  abstract set(\n    userId: string,\n    cartId: string,\n    paymentDetailsId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to get available cart types\n   */\n  abstract loadCardTypes(): Observable<CardType[]>;\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { CheckoutPaymentAdapter } from './checkout-payment.adapter';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutPaymentConnector {\n  constructor(protected adapter: CheckoutPaymentAdapter) {}\n\n  public create(\n    userId: string,\n    cartId: string,\n    paymentDetails: PaymentDetails\n  ): Observable<PaymentDetails> {\n    return this.adapter.create(userId, cartId, paymentDetails);\n  }\n\n  public set(\n    userId: string,\n    cartId: string,\n    paymentDetailsId: string\n  ): Observable<any> {\n    return this.adapter.set(userId, cartId, paymentDetailsId);\n  }\n\n  getCardTypes(): Observable<CardType[]> {\n    return this.adapter.loadCardTypes();\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\n\nexport const PAYMENT_DETAILS_NORMALIZER = new InjectionToken<\n  Converter<any, PaymentDetails>\n>('PaymentDetailsNormalizer');\n\nexport const PAYMENT_DETAILS_SERIALIZER = new InjectionToken<\n  Converter<PaymentDetails, any>\n>('PaymentDetailsSerializer');\n\nexport const CARD_TYPE_NORMALIZER = new InjectionToken<\n  Converter<any, CardType>\n>('CardTypeNormalizer');\n","import { Observable } from 'rxjs';\nimport {\n  ReplenishmentOrder,\n  ScheduleReplenishmentForm,\n} from '../../../model/replenishment-order.model';\n\nexport abstract class CheckoutReplenishmentOrderAdapter {\n  /**\n   * Abstract method used to schedule a replenishment order.\n   *\n   * @param cartId The `cartId` for cart used for scheduling a replenishment order\n   * @param scheduleReplenishmentForm The `object` that contains the form data for replenishment\n   * @param termsChecked The `boolean value` whether the terms were accepted or not\n   * @param userId The `userId` for given user\n   */\n  abstract scheduleReplenishmentOrder(\n    cartId: string,\n    scheduleReplenishmentForm: ScheduleReplenishmentForm,\n    termsChecked: boolean,\n    userId: string\n  ): Observable<ReplenishmentOrder>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport {\n  ReplenishmentOrder,\n  ScheduleReplenishmentForm,\n} from '../../../model/replenishment-order.model';\nimport { CheckoutReplenishmentOrderAdapter } from './checkout-replenishment-order.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutReplenishmentOrderConnector {\n  constructor(protected adapter: CheckoutReplenishmentOrderAdapter) {}\n\n  public scheduleReplenishmentOrder(\n    cartId: string,\n    scheduleReplenishmentForm: ScheduleReplenishmentForm,\n    termsChecked: boolean,\n    userId: string\n  ): Observable<ReplenishmentOrder> {\n    return this.adapter.scheduleReplenishmentOrder(\n      cartId,\n      scheduleReplenishmentForm,\n      termsChecked,\n      userId\n    );\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport {\n  ReplenishmentOrder,\n  ScheduleReplenishmentForm,\n} from '../../../model/replenishment-order.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const REPLENISHMENT_ORDER_NORMALIZER = new InjectionToken<\n  Converter<any, ReplenishmentOrder>\n>('ReplenishmentOrderNormalizer');\n\nexport const REPLENISHMENT_ORDER_FORM_SERIALIZER = new InjectionToken<\n  Converter<ScheduleReplenishmentForm, any>\n>('ReplenishmentOrderFormSerializer');\n","import { Injectable } from '@angular/core';\nimport { Order, OrderEntry } from '../../../../model/order.model';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccOrderNormalizer implements Converter<Occ.Order, Order> {\n  constructor(private converter: ConverterService) {}\n\n  convert(source: Occ.Order, target?: Order): Order {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source.entries) {\n      target.entries = source.entries.map((entry) =>\n        this.convertOrderEntry(entry)\n      );\n    }\n\n    if (source.consignments) {\n      target.consignments = source.consignments.map((consignment) => ({\n        ...consignment,\n        entries: consignment.entries.map((entry) => ({\n          ...entry,\n          orderEntry: this.convertOrderEntry(entry.orderEntry),\n        })),\n      }));\n    }\n\n    if (source.unconsignedEntries) {\n      target.unconsignedEntries = source.unconsignedEntries.map((entry) =>\n        this.convertOrderEntry(entry)\n      );\n    }\n\n    return target;\n  }\n\n  private convertOrderEntry(source: Occ.OrderEntry): OrderEntry {\n    return {\n      ...source,\n      product: this.converter.convert(source.product, PRODUCT_NORMALIZER),\n    };\n  }\n}\n","export class TimeUtils {\n  /**\n   * Returns the local timezone in a format that can be appended to a date-like string.\n   * @param invert (default: false): returns the opposite operator relative to the local timezone\n   *\n   * @example\n   * When locale is set to a CEST timezone, `getLocalTimezoneOffset()` returns '+02:00'\n   * and `getLocalTimezoneOffset(true)` returns '-02:00'\n   */\n  static getLocalTimezoneOffset(invert?: boolean): string {\n    const offset = new Date().getTimezoneOffset() * -1;\n    const hours = Math.abs(Math.floor(offset / 60))\n      .toString()\n      .padStart(2, '0');\n    const minutes = (offset % 60).toString().padStart(2, '0');\n    const sign = offset >= 0 ? (invert ? `-` : `+`) : invert ? `+` : `-`;\n    return `${sign}${hours}:${minutes}`;\n  }\n\n  static convertDateToDatetime(date: string, endOfDay?: boolean): string {\n    return `${date}T${\n      !endOfDay ? '00:00:00' : '23:59:59'\n    }${TimeUtils.getLocalTimezoneOffset()}`;\n  }\n\n  static convertDatetimeToDate(datetime: string): string {\n    return new Date(\n      `${datetime.substring(0, 19)}${TimeUtils.getLocalTimezoneOffset(true)}`\n    )\n      .toISOString()\n      .substring(0, 10);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { TimeUtils } from '../../../../util/time-utils';\nimport { ScheduleReplenishmentForm } from '../../../../model/replenishment-order.model';\nimport { Converter } from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccReplenishmentOrderFormSerializer\n  implements\n    Converter<Occ.ScheduleReplenishmentForm, ScheduleReplenishmentForm> {\n  convert(\n    source: Occ.ScheduleReplenishmentForm,\n    target?: ScheduleReplenishmentForm\n  ): ScheduleReplenishmentForm {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source.replenishmentStartDate) {\n      target.replenishmentStartDate = this.convertDate(\n        source.replenishmentStartDate\n      );\n    }\n\n    return target;\n  }\n\n  /**\n   * Adds the current timestamp (including timezone offset) to a date string in the format YYYY-mm-dd\n   * @Example\n   * Converts 2021-10-15 to 2021-10-15T15:38:05-05:00\n   */\n  private convertDate(date: string): string {\n    const localTime = new Date().toLocaleTimeString([], {\n      hour: '2-digit',\n      minute: '2-digit',\n      hour12: false,\n    });\n    return `${date}T${localTime}:00${TimeUtils.getLocalTimezoneOffset()}`;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { OrderEntry } from '../../../../model/order.model';\nimport { ReplenishmentOrder } from '../../../../model/replenishment-order.model';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccReplenishmentOrderNormalizer\n  implements Converter<Occ.ReplenishmentOrder, ReplenishmentOrder> {\n  constructor(private converter: ConverterService) {}\n\n  convert(\n    source: Occ.ReplenishmentOrder,\n    target?: ReplenishmentOrder\n  ): ReplenishmentOrder {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source.entries) {\n      target.entries = source.entries.map((entry) =>\n        this.convertOrderEntry(entry)\n      );\n    }\n\n    return target;\n  }\n\n  private convertOrderEntry(source: Occ.OrderEntry): OrderEntry {\n    return {\n      ...source,\n      product: this.converter.convert(source.product, PRODUCT_NORMALIZER),\n    };\n  }\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccCheckoutConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        setDeliveryAddress:\n          'users/${userId}/carts/${cartId}/addresses/delivery',\n        placeOrder: 'users/${userId}/orders?fields=FULL',\n      },\n    },\n  },\n};\n","import { HttpClient, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CART_NORMALIZER } from '../../../cart/connectors/cart/converters';\nimport { CheckoutCostCenterAdapter } from '../../../checkout/connectors/cost-center/checkout-cost-center.adapter';\nimport { Cart } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCheckoutCostCenterAdapter implements CheckoutCostCenterAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  setCostCenter(\n    userId: string,\n    cartId: string,\n    costCenterId: string\n  ): Observable<Cart> {\n    let httpParams = new HttpParams().set('costCenterId', costCenterId);\n    /* tslint:disable:max-line-length */\n    httpParams = httpParams.set(\n      'fields',\n      'DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user'\n    );\n    // TODO(#8877): Should we improve configurable endpoints for this use case?\n\n    return this.http\n      .put(\n        this.getCartEndpoint(userId) + cartId + '/costcenter',\n        {},\n        {\n          params: httpParams,\n        }\n      )\n      .pipe(this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = 'users/' + userId + '/carts/';\n    return this.occEndpoints.getEndpoint(cartEndpoint);\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Address, AddressValidation } from '../../../model/address.model';\nimport { EntitiesModel } from '../../../model/misc.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const ADDRESS_NORMALIZER = new InjectionToken<Converter<any, Address>>(\n  'AddressNormalizer'\n);\n\nexport const ADDRESS_LIST_NORMALIZER = new InjectionToken<\n  Converter<any, EntitiesModel<Address>>\n>('AddressesNormalizer');\n\nexport const ADDRESS_SERIALIZER = new InjectionToken<Converter<Address, any>>(\n  'AddressSerializer'\n);\n\nexport const ADDRESS_VALIDATION_NORMALIZER = new InjectionToken<\n  Converter<any, AddressValidation>\n>('AddressValidationNormalizer');\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport { CheckoutDeliveryAdapter } from '../../../checkout/connectors/delivery/checkout-delivery.adapter';\nimport { DELIVERY_MODE_NORMALIZER } from '../../../checkout/connectors/delivery/converters';\nimport { Address } from '../../../model/address.model';\nimport { DeliveryMode } from '../../../model/order.model';\nimport {\n  ADDRESS_NORMALIZER,\n  ADDRESS_SERIALIZER,\n} from '../../../user/connectors/address/converters';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCheckoutDeliveryAdapter implements CheckoutDeliveryAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = 'users/' + userId + '/carts/';\n    return this.occEndpoints.getEndpoint(cartEndpoint);\n  }\n\n  public createAddress(\n    userId: string,\n    cartId: string,\n    address: Address\n  ): Observable<Address> {\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .post<Occ.Address>(\n        this.getCartEndpoint(userId) + cartId + '/addresses/delivery',\n        address,\n        {\n          headers: new HttpHeaders().set('Content-Type', 'application/json'),\n        }\n      )\n      .pipe(this.converter.pipeable(ADDRESS_NORMALIZER));\n  }\n\n  public setAddress(\n    userId: string,\n    cartId: string,\n    addressId: string\n  ): Observable<any> {\n    return this.http.put(\n      this.occEndpoints.getUrl('setDeliveryAddress', { userId, cartId }),\n      {},\n      {\n        params: { addressId: addressId },\n      }\n    );\n  }\n\n  public setMode(\n    userId: string,\n    cartId: string,\n    deliveryModeId: string\n  ): Observable<any> {\n    return this.http.put(\n      this.getCartEndpoint(userId) + cartId + '/deliverymode',\n      {},\n      {\n        params: { deliveryModeId: deliveryModeId },\n      }\n    );\n  }\n\n  public getMode(userId: string, cartId: string): Observable<any> {\n    return this.http\n      .get(this.getCartEndpoint(userId) + cartId + '/deliverymode')\n      .pipe(this.converter.pipeable(DELIVERY_MODE_NORMALIZER));\n  }\n\n  public getSupportedModes(\n    userId: string,\n    cartId: string\n  ): Observable<DeliveryMode[]> {\n    return this.http\n      .get<Occ.DeliveryModeList>(\n        this.getCartEndpoint(userId) + cartId + '/deliverymodes'\n      )\n      .pipe(\n        pluck('deliveryModes'),\n        this.converter.pipeableMany(DELIVERY_MODE_NORMALIZER)\n      );\n  }\n}\n","import { HttpClient, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { CART_NORMALIZER } from '../../../cart/connectors/cart/converters';\nimport { PAYMENT_TYPE_NORMALIZER } from '../../../checkout/connectors/payment-type/converters';\nimport { PaymentTypeAdapter } from '../../../checkout/connectors/payment-type/payment-type.adapter';\nimport { Cart, PaymentType } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\nconst ENDPOINT_PAYMENT_TYPES = 'paymenttypes';\n\n@Injectable()\nexport class OccCheckoutPaymentTypeAdapter implements PaymentTypeAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadPaymentTypes(): Observable<PaymentType[]> {\n    return this.http\n      .get<Occ.PaymentTypeList>(\n        this.occEndpoints.getEndpoint(ENDPOINT_PAYMENT_TYPES)\n      )\n      .pipe(\n        map((paymentTypeList) => paymentTypeList.paymentTypes),\n        this.converter.pipeableMany(PAYMENT_TYPE_NORMALIZER)\n      );\n  }\n\n  setPaymentType(\n    userId: string,\n    cartId: string,\n    paymentType: string,\n    purchaseOrderNumber?: string\n  ): Observable<Cart> {\n    let httpParams = new HttpParams().set('paymentType', paymentType);\n    if (purchaseOrderNumber !== undefined) {\n      httpParams = httpParams.set('purchaseOrderNumber', purchaseOrderNumber);\n    }\n    /* tslint:disable:max-line-length */\n    httpParams = httpParams.set(\n      'fields',\n      'DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user'\n    );\n    // TODO(#8877): Should we improve configurable endpoints for this use case?\n\n    return this.http\n      .put(\n        this.getCartEndpoint(userId) + cartId + '/paymenttype',\n        {},\n        {\n          params: httpParams,\n        }\n      )\n      .pipe(this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = 'users/' + userId + '/carts/';\n    return this.occEndpoints.getEndpoint(cartEndpoint);\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map, mergeMap } from 'rxjs/operators';\nimport { CheckoutPaymentAdapter } from '../../../checkout/connectors/payment/checkout-payment.adapter';\nimport {\n  CARD_TYPE_NORMALIZER,\n  PAYMENT_DETAILS_NORMALIZER,\n  PAYMENT_DETAILS_SERIALIZER,\n} from '../../../checkout/connectors/payment/converters';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { HttpParamsURIEncoder } from '../../../util/http-params-uri.encoder';\n\nconst ENDPOINT_CARD_TYPES = 'cardtypes';\n\n@Injectable()\nexport class OccCheckoutPaymentAdapter implements CheckoutPaymentAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {\n    if (typeof DOMParser !== 'undefined') {\n      this.domparser = new DOMParser();\n    }\n  }\n\n  private domparser: DOMParser;\n\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = 'users/' + userId + '/carts/';\n    return this.occEndpoints.getEndpoint(cartEndpoint);\n  }\n\n  public create(\n    userId: string,\n    cartId: string,\n    paymentDetails: PaymentDetails\n  ): Observable<PaymentDetails> {\n    paymentDetails = this.converter.convert(\n      paymentDetails,\n      PAYMENT_DETAILS_SERIALIZER\n    );\n    return this.getProviderSubInfo(userId, cartId).pipe(\n      map((data) => {\n        const labelsMap = this.convertToMap(data.mappingLabels.entry);\n        return {\n          url: data.postUrl,\n          parameters: this.getParamsForPaymentProvider(\n            paymentDetails,\n            data.parameters.entry,\n            labelsMap\n          ),\n          mappingLabels: labelsMap,\n        };\n      }),\n      mergeMap((sub) => {\n        // create a subscription directly with payment provider\n        return this.createSubWithProvider(sub.url, sub.parameters).pipe(\n          map((response) => this.extractPaymentDetailsFromHtml(response)),\n          mergeMap((fromPaymentProvider) => {\n            fromPaymentProvider['defaultPayment'] =\n              paymentDetails.defaultPayment;\n            fromPaymentProvider['savePaymentInfo'] = true;\n            return this.createDetailsWithParameters(\n              userId,\n              cartId,\n              fromPaymentProvider\n            ).pipe(this.converter.pipeable(PAYMENT_DETAILS_NORMALIZER));\n          })\n        );\n      })\n    );\n  }\n\n  public set(\n    userId: string,\n    cartId: string,\n    paymentDetailsId: string\n  ): Observable<any> {\n    return this.http.put(\n      this.getCartEndpoint(userId) + cartId + '/paymentdetails',\n      {},\n      {\n        params: { paymentDetailsId: paymentDetailsId },\n      }\n    );\n  }\n\n  loadCardTypes(): Observable<CardType[]> {\n    return this.http\n      .get<Occ.CardTypeList>(this.occEndpoints.getEndpoint(ENDPOINT_CARD_TYPES))\n      .pipe(\n        map((cardTypeList) => cardTypeList.cardTypes),\n        this.converter.pipeableMany(CARD_TYPE_NORMALIZER)\n      );\n  }\n\n  protected getProviderSubInfo(\n    userId: string,\n    cartId: string\n  ): Observable<any> {\n    return this.http.get(\n      this.getCartEndpoint(userId) +\n        cartId +\n        '/payment/sop/request?responseUrl=sampleUrl'\n    );\n  }\n\n  protected createSubWithProvider(\n    postUrl: string,\n    parameters: any\n  ): Observable<any> {\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n      Accept: 'text/html',\n    });\n    let httpParams = new HttpParams({ encoder: new HttpParamsURIEncoder() });\n    Object.keys(parameters).forEach((key) => {\n      httpParams = httpParams.append(key, parameters[key]);\n    });\n\n    return this.http.post(postUrl, httpParams, {\n      headers,\n      responseType: 'text',\n    });\n  }\n\n  protected createDetailsWithParameters(\n    userId: string,\n    cartId: string,\n    parameters: any\n  ): Observable<PaymentDetails> {\n    let httpParams = new HttpParams({ encoder: new HttpParamsURIEncoder() });\n    Object.keys(parameters).forEach((key) => {\n      httpParams = httpParams.append(key, parameters[key]);\n    });\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http.post<PaymentDetails>(\n      this.getCartEndpoint(userId) + cartId + '/payment/sop/response',\n      httpParams,\n      { headers }\n    );\n  }\n\n  private getParamsForPaymentProvider(\n    paymentDetails: PaymentDetails,\n    parameters: { key; value }[],\n    mappingLabels: any\n  ) {\n    const params = this.convertToMap(parameters);\n    params[mappingLabels['hybris_account_holder_name']] =\n      paymentDetails.accountHolderName;\n    params[mappingLabels['hybris_card_type']] = paymentDetails.cardType.code;\n    params[mappingLabels['hybris_card_number']] = paymentDetails.cardNumber;\n    if (mappingLabels['hybris_combined_expiry_date'] === 'true') {\n      params[mappingLabels['hybris_card_expiry_date']] =\n        paymentDetails.expiryMonth +\n        mappingLabels['hybris_separator_expiry_date'] +\n        paymentDetails.expiryYear;\n    } else {\n      params[mappingLabels['hybris_card_expiration_month']] =\n        paymentDetails.expiryMonth;\n      params[mappingLabels['hybris_card_expiration_year']] =\n        paymentDetails.expiryYear;\n    }\n    params[mappingLabels['hybris_card_cvn']] = paymentDetails.cvn;\n\n    // billing address\n    params[mappingLabels['hybris_billTo_country']] =\n      paymentDetails.billingAddress.country.isocode;\n    params[mappingLabels['hybris_billTo_firstname']] =\n      paymentDetails.billingAddress.firstName;\n    params[mappingLabels['hybris_billTo_lastname']] =\n      paymentDetails.billingAddress.lastName;\n    params[mappingLabels['hybris_billTo_street1']] =\n      paymentDetails.billingAddress.line1 +\n      ' ' +\n      paymentDetails.billingAddress.line2;\n    params[mappingLabels['hybris_billTo_city']] =\n      paymentDetails.billingAddress.town;\n    if (paymentDetails.billingAddress.region) {\n      params[mappingLabels['hybris_billTo_region']] =\n        paymentDetails.billingAddress.region.isocodeShort;\n    } else {\n      params[mappingLabels['hybris_billTo_region']] = '';\n    }\n    params[mappingLabels['hybris_billTo_postalcode']] =\n      paymentDetails.billingAddress.postalCode;\n    return params;\n  }\n\n  private extractPaymentDetailsFromHtml(html: string): any {\n    const domdoc = this.domparser.parseFromString(html, 'text/xml');\n    const responseForm = domdoc.getElementsByTagName('form')[0];\n    const inputs = responseForm.getElementsByTagName('input');\n\n    const values = {};\n    for (let i = 0; inputs[i]; i++) {\n      const input = inputs[i];\n      if (\n        input.getAttribute('name') !== '{}' &&\n        input.getAttribute('value') !== ''\n      ) {\n        values[input.getAttribute('name')] = input.getAttribute('value');\n      }\n    }\n\n    return values;\n  }\n\n  private convertToMap(paramList: { key; value }[]) {\n    return paramList.reduce(function (result, item) {\n      const key = item.key;\n      result[key] = item.value;\n      return result;\n    }, {});\n  }\n}\n","import { PageType } from '../../model/cms.model';\nimport { Page } from '../model/page.model';\nimport { Applicable } from '../../util/applicable';\n\n/**\n * Abstract class that can be used to resolve meta data for specific pages.\n * The `getScore` method is used to select the right resolver for a specific\n * page, based on a score. The score is calculated by the (non)matching page\n * type and page template.\n */\nexport abstract class PageMetaResolver implements Applicable {\n  /** The `PageType` is used to score the (non)matching page */\n  pageType: PageType;\n\n  /** The page template is used to score the (non)matching page template */\n  pageTemplate: string;\n\n  /**\n   * Returns the matching score for a resolver class, based on\n   * the page type and page template.\n   */\n  getScore(page: Page): number {\n    let score = 0;\n    if (this.pageType) {\n      score += page.type === this.pageType ? 1 : -1;\n    }\n    if (this.pageTemplate) {\n      score += page.template === this.pageTemplate ? 1 : -1;\n    }\n    return score;\n  }\n\n  hasMatch(page: Page): boolean {\n    return this.getScore(page) > 0;\n  }\n\n  getPriority(page: Page): number {\n    return this.getScore(page);\n  }\n}\n","import { Injectable, Type } from '@angular/core';\nimport { ofType } from '@ngrx/effects';\nimport { ActionsSubject } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { EventService } from '../../event/event.service';\nimport { createFrom } from '../../util/create-from';\nimport { ActionToEventMapping } from './action-to-event-mapping';\n\n/**\n * Registers streams of ngrx actions as events source streams\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class StateEventService {\n  constructor(\n    protected actionsSubject: ActionsSubject,\n    protected eventService: EventService\n  ) {}\n\n  /**\n   * Registers an event source stream of specific events\n   * mapped from a given action type.\n   *\n   * @param mapping mapping from action to event\n   *\n   * @returns a teardown function that unregisters the event source\n   */\n  register<T>(mapping: ActionToEventMapping<T>): () => void {\n    return this.eventService.register(\n      mapping.event,\n      this.getFromAction(mapping)\n    );\n  }\n\n  /**\n   * Returns a stream of specific events mapped from a specific action.\n   * @param mapping mapping from action to event\n   */\n  protected getFromAction<T>(mapping: ActionToEventMapping<T>): Observable<T> {\n    return this.actionsSubject\n      .pipe(ofType(...[].concat(mapping.action)))\n      .pipe(\n        map((action: { type: string; payload: T }) =>\n          this.createEvent(action, mapping.event, mapping.factory)\n        )\n      );\n  }\n\n  /**\n   * Creates an event instance for given class out from the action object.\n   * Unless the `factory` parameter is given, the action's `payload` is used\n   * as the argument for the event's constructor.\n   *\n   * @param action instance of an Action\n   * @param mapping mapping from action to event\n   * @param factory optional function getting an action instance and returning an event instance\n   *\n   * @returns instance of an Event\n   */\n  protected createEvent<T>(\n    action: { type: string; payload?: any },\n    eventType: Type<T>,\n    factory?: (action: any) => T\n  ): T {\n    return factory\n      ? factory(action)\n      : createFrom(eventType, action.payload ?? {});\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\nexport const VERIFY_ADDRESS = '[Checkout] Verify Address';\nexport const VERIFY_ADDRESS_FAIL = '[Checkout] Verify Address Fail';\nexport const VERIFY_ADDRESS_SUCCESS = '[Checkout] Verify Address Success';\n\nexport const CLEAR_ADDRESS_VERIFICATION_RESULTS =\n  '[Checkout] Clear Address Verification Results';\n\nexport class VerifyAddress implements Action {\n  readonly type = VERIFY_ADDRESS;\n  constructor(public payload: { userId: string; address: Address }) {}\n}\n\nexport class VerifyAddressFail implements Action {\n  readonly type = VERIFY_ADDRESS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class VerifyAddressSuccess implements Action {\n  readonly type = VERIFY_ADDRESS_SUCCESS;\n  constructor(public payload: AddressValidation) {}\n}\n\nexport class ClearAddressVerificationResults implements Action {\n  readonly type = CLEAR_ADDRESS_VERIFICATION_RESULTS;\n  constructor() {}\n}\n\nexport type AddressVerificationActions =\n  | VerifyAddress\n  | VerifyAddressFail\n  | VerifyAddressSuccess\n  | ClearAddressVerificationResults;\n","import { Action } from '@ngrx/store';\nimport { CardType } from '../../../model/cart.model';\n\nexport const LOAD_CARD_TYPES = '[Checkout] Load Card Types';\nexport const LOAD_CARD_TYPES_FAIL = '[Checkout] Load Card Fail';\nexport const LOAD_CARD_TYPES_SUCCESS = '[Checkout] Load Card Success';\n\nexport class LoadCardTypes implements Action {\n  readonly type = LOAD_CARD_TYPES;\n  constructor() {}\n}\n\nexport class LoadCardTypesFail implements Action {\n  readonly type = LOAD_CARD_TYPES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadCardTypesSuccess implements Action {\n  readonly type = LOAD_CARD_TYPES_SUCCESS;\n  constructor(public payload: CardType[]) {}\n}\n\nexport type CardTypesAction =\n  | LoadCardTypes\n  | LoadCardTypesFail\n  | LoadCardTypesSuccess;\n","import { Cart } from '../../model/cart.model';\nimport { EntityProcessesLoaderState } from '../../state/utils/entity-processes-loader/entity-processes-loader-state';\n\nexport const MULTI_CART_FEATURE = 'cart';\nexport const MULTI_CART_DATA = '[Multi Cart] Multi Cart Data';\n\n// TODO(#7241): Drop after event system implementation for cart vouchers\n/**\n * Add voucher process const\n * @deprecated since 2.0\n */\nexport const ADD_VOUCHER_PROCESS_ID = 'addVoucher';\n\nexport interface StateWithMultiCart {\n  [MULTI_CART_FEATURE]: MultiCartState;\n}\n\nexport interface MultiCartState {\n  carts: EntityProcessesLoaderState<Cart>;\n  active: string;\n  wishList: string;\n}\n","import { EntityLoaderState } from '../../state/utils/entity-loader/entity-loader-state';\n\nexport const PROCESS_FEATURE = 'process';\n\nexport interface StateWithProcess<T> {\n  [PROCESS_FEATURE]: EntityLoaderState<T>;\n}\n","import { Address, AddressValidation } from '../../model/address.model';\nimport { CardType, PaymentDetails, PaymentType } from '../../model/cart.model';\nimport { DeliveryMode, Order } from '../../model/order.model';\nimport {\n  ORDER_TYPE,\n  ReplenishmentOrder,\n} from '../../model/replenishment-order.model';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\n\nexport const CHECKOUT_FEATURE = 'checkout';\nexport const CHECKOUT_DETAILS = '[Checkout] Checkout Details';\n\nexport const SET_DELIVERY_ADDRESS_PROCESS_ID = 'setDeliveryAddress';\nexport const SET_DELIVERY_MODE_PROCESS_ID = 'setDeliveryMode';\nexport const SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID =\n  'setSupportedDeliveryMode';\nexport const SET_PAYMENT_DETAILS_PROCESS_ID = 'setPaymentDetails';\nexport const GET_PAYMENT_TYPES_PROCESS_ID = 'getPaymentTypes';\nexport const SET_COST_CENTER_PROCESS_ID = 'setCostCenter';\nexport const PLACED_ORDER_PROCESS_ID = 'placeOrder';\n\nexport interface StateWithCheckout {\n  [CHECKOUT_FEATURE]: CheckoutState;\n}\n\nexport interface AddressVerificationState {\n  results: AddressValidation | string;\n}\n\nexport interface CardTypesState {\n  entities: { [code: string]: CardType };\n}\n\nexport interface CheckoutStepsState {\n  poNumber: {\n    po: string;\n    costCenter: string;\n  };\n  address: Address;\n  deliveryMode: {\n    supported: { [code: string]: DeliveryMode };\n    selected: string;\n  };\n  paymentDetails: PaymentDetails;\n  orderDetails: Order | ReplenishmentOrder;\n}\n\nexport interface PaymentTypesState {\n  entities: { [code: string]: PaymentType };\n  selected: string;\n}\n\nexport interface OrderTypesState {\n  selected: ORDER_TYPE;\n}\n\nexport interface PaymentTypesState {\n  entities: { [code: string]: PaymentType };\n  selected: string;\n}\n\nexport interface CheckoutState {\n  steps: LoaderState<CheckoutStepsState>;\n  cardTypes: CardTypesState;\n  addressVerification: AddressVerificationState;\n  paymentTypes: PaymentTypesState;\n  orderType: OrderTypesState;\n}\n","import { Action } from '@ngrx/store';\nimport { MULTI_CART_DATA } from '../../../cart/store/multi-cart-state';\nimport { Address } from '../../../model/address.model';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { DeliveryMode, Order } from '../../../model/order.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  EntityProcessesDecrementAction,\n  EntityProcessesIncrementAction,\n} from '../../../state/utils/entity-processes-loader/entity-processes-loader.action';\nimport { StateUtils } from '../../../state/utils/index';\nimport { CheckoutDetails } from '../../models/checkout.model';\nimport {\n  CHECKOUT_DETAILS,\n  PLACED_ORDER_PROCESS_ID,\n  SET_COST_CENTER_PROCESS_ID,\n  SET_DELIVERY_ADDRESS_PROCESS_ID,\n  SET_DELIVERY_MODE_PROCESS_ID,\n  SET_PAYMENT_DETAILS_PROCESS_ID,\n  SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID,\n} from '../checkout-state';\n\nexport const CLEAR_CHECKOUT_DELIVERY_ADDRESS =\n  '[Checkout] Clear Checkout Delivery Address';\nexport const CLEAR_CHECKOUT_DELIVERY_ADDRESS_SUCCESS =\n  '[Checkout] Clear Checkout Delivery Address Success';\nexport const CLEAR_CHECKOUT_DELIVERY_ADDRESS_FAIL =\n  '[Checkout] Clear Checkout Delivery Address Fail';\n\nexport const CLEAR_CHECKOUT_DELIVERY_MODE =\n  '[Checkout] Clear Checkout Delivery Mode';\nexport const CLEAR_CHECKOUT_DELIVERY_MODE_SUCCESS =\n  '[Checkout] Clear Checkout Delivery Mode Success';\nexport const CLEAR_CHECKOUT_DELIVERY_MODE_FAIL =\n  '[Checkout] Clear Checkout Delivery Mode Fail';\n\nexport const ADD_DELIVERY_ADDRESS = '[Checkout] Add Delivery Address';\nexport const ADD_DELIVERY_ADDRESS_FAIL = '[Checkout] Add Delivery Address Fail';\nexport const ADD_DELIVERY_ADDRESS_SUCCESS =\n  '[Checkout] Add Delivery Address Success';\n\nexport const SET_DELIVERY_ADDRESS = '[Checkout] Set Delivery Address';\nexport const SET_DELIVERY_ADDRESS_FAIL = '[Checkout] Set Delivery Address Fail';\nexport const SET_DELIVERY_ADDRESS_SUCCESS =\n  '[Checkout] Set Delivery Address Success';\nexport const RESET_SET_DELIVERY_ADDRESS_PROCESS =\n  '[Checkout] Reset Set Delivery Address Process';\n\nexport const LOAD_SUPPORTED_DELIVERY_MODES =\n  '[Checkout] Load Supported Delivery Modes';\nexport const LOAD_SUPPORTED_DELIVERY_MODES_FAIL =\n  '[Checkout] Load Supported Delivery Modes Fail';\nexport const LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS =\n  '[Checkout] Load Supported Delivery Modes Success';\nexport const CLEAR_SUPPORTED_DELIVERY_MODES =\n  '[Checkout] Clear Supported Delivery Modes';\n\nexport const SET_DELIVERY_MODE = '[Checkout] Set Delivery Mode';\nexport const SET_DELIVERY_MODE_FAIL = '[Checkout] Set Delivery Mode Fail';\nexport const SET_DELIVERY_MODE_SUCCESS = '[Checkout] Set Delivery Mode Success';\nexport const RESET_SET_DELIVERY_MODE_PROCESS =\n  '[Checkout] Reset Set Delivery Mode Process';\n\nexport const SET_SUPPORTED_DELIVERY_MODES =\n  '[Checkout] Set Supported Delivery Modes';\nexport const SET_SUPPORTED_DELIVERY_MODES_FAIL =\n  '[Checkout] Set Supported Delivery Modes Fail';\nexport const SET_SUPPORTED_DELIVERY_MODES_SUCCESS =\n  '[Checkout] Set Supported Delivery Modes Success';\nexport const RESET_SUPPORTED_SET_DELIVERY_MODES_PROCESS =\n  '[Checkout] Reset Set Supported Delivery Modes Process';\n\nexport const CREATE_PAYMENT_DETAILS = '[Checkout] Create Payment Details';\nexport const CREATE_PAYMENT_DETAILS_FAIL =\n  '[Checkout] Create Payment Details Fail';\nexport const CREATE_PAYMENT_DETAILS_SUCCESS =\n  '[Checkout] Create Payment Details Success';\n\nexport const SET_PAYMENT_DETAILS = '[Checkout] Set Payment Details';\nexport const SET_PAYMENT_DETAILS_FAIL = '[Checkout] Set Payment Details Fail';\nexport const SET_PAYMENT_DETAILS_SUCCESS =\n  '[Checkout] Set Payment Details Success';\nexport const RESET_SET_PAYMENT_DETAILS_PROCESS =\n  '[Checkout] Reset Set Payment Details Process';\n\nexport const PLACE_ORDER = '[Checkout] Place Order';\nexport const PLACE_ORDER_FAIL = '[Checkout] Place Order Fail';\nexport const PLACE_ORDER_SUCCESS = '[Checkout] Place Order Success';\nexport const CLEAR_PLACE_ORDER = '[Checkout] Clear Place Order';\n\nexport const CLEAR_CHECKOUT_STEP = '[Checkout] Clear One Checkout Step';\nexport const CLEAR_CHECKOUT_DATA = '[Checkout] Clear Checkout Data';\n\nexport const LOAD_CHECKOUT_DETAILS = '[Checkout] Load Checkout Details';\nexport const LOAD_CHECKOUT_DETAILS_FAIL =\n  '[Checkout] Load Checkout Details Fail';\nexport const LOAD_CHECKOUT_DETAILS_SUCCESS =\n  '[Checkout] Load Checkout Details Success';\n\nexport const CHECKOUT_CLEAR_MISCS_DATA = '[Checkout] Clear Miscs Data';\nexport const PAYMENT_PROCESS_SUCCESS = '[Checkout] Payment Process Success';\n\nexport const SET_COST_CENTER = '[Checkout] Set Cost Center';\nexport const SET_COST_CENTER_FAIL = '[Checkout] Set Cost Center Fail';\nexport const SET_COST_CENTER_SUCCESS = '[Checkout] Set Cost Center Success';\nexport const RESET_SET_COST_CENTER_PROCESS =\n  '[Checkout] Reset Set Cost Center Process';\n\nexport class AddDeliveryAddress implements Action {\n  readonly type = ADD_DELIVERY_ADDRESS;\n  constructor(\n    public payload: { userId: string; cartId: string; address: Address }\n  ) {}\n}\n\nexport class AddDeliveryAddressFail implements Action {\n  readonly type = ADD_DELIVERY_ADDRESS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class AddDeliveryAddressSuccess implements Action {\n  readonly type = ADD_DELIVERY_ADDRESS_SUCCESS;\n  constructor(public payload: Address) {}\n}\n\nexport class SetDeliveryAddress extends StateUtils.EntityLoadAction {\n  readonly type = SET_DELIVERY_ADDRESS;\n  constructor(\n    public payload: { userId: string; cartId: string; address: Address }\n  ) {\n    super(PROCESS_FEATURE, SET_DELIVERY_ADDRESS_PROCESS_ID);\n  }\n}\n\nexport class SetDeliveryAddressFail extends StateUtils.EntityFailAction {\n  readonly type = SET_DELIVERY_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_DELIVERY_ADDRESS_PROCESS_ID, payload);\n  }\n}\n\nexport class SetDeliveryAddressSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = SET_DELIVERY_ADDRESS_SUCCESS;\n  constructor(public payload: Address) {\n    super(PROCESS_FEATURE, SET_DELIVERY_ADDRESS_PROCESS_ID);\n  }\n}\n\nexport class ResetSetDeliveryAddressProcess extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_SET_DELIVERY_ADDRESS_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_DELIVERY_ADDRESS_PROCESS_ID);\n  }\n}\n\nexport class LoadSupportedDeliveryModes extends StateUtils.EntityLoadAction {\n  readonly type = LOAD_SUPPORTED_DELIVERY_MODES;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(PROCESS_FEATURE, SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class LoadSupportedDeliveryModesFail extends StateUtils.EntityFailAction {\n  readonly type = LOAD_SUPPORTED_DELIVERY_MODES_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class LoadSupportedDeliveryModesSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS;\n  constructor(public payload: DeliveryMode[]) {\n    super(PROCESS_FEATURE, SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class ResetLoadSupportedDeliveryModesProcess extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_SUPPORTED_SET_DELIVERY_MODES_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class SetDeliveryMode extends StateUtils.EntityLoadAction {\n  readonly type = SET_DELIVERY_MODE;\n  constructor(\n    public payload: { userId: string; cartId: string; selectedModeId: string }\n  ) {\n    super(PROCESS_FEATURE, SET_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class SetDeliveryModeFail extends StateUtils.EntityFailAction {\n  readonly type = SET_DELIVERY_MODE_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_DELIVERY_MODE_PROCESS_ID, payload);\n  }\n}\n\nexport class SetDeliveryModeSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = SET_DELIVERY_MODE_SUCCESS;\n  constructor(public payload: string) {\n    super(PROCESS_FEATURE, SET_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class ResetSetDeliveryModeProcess extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_SET_DELIVERY_MODE_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class CreatePaymentDetails extends StateUtils.EntityLoadAction {\n  readonly type = CREATE_PAYMENT_DETAILS;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      paymentDetails: PaymentDetails;\n    }\n  ) {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class CreatePaymentDetailsFail extends StateUtils.EntityFailAction {\n  readonly type = CREATE_PAYMENT_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class CreatePaymentDetailsSuccess implements Action {\n  readonly type = CREATE_PAYMENT_DETAILS_SUCCESS;\n  constructor(public payload: PaymentDetails) {}\n}\n\nexport class PaymentProcessSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = PAYMENT_PROCESS_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class SetPaymentDetails extends StateUtils.EntityLoadAction {\n  readonly type = SET_PAYMENT_DETAILS;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      paymentDetails: PaymentDetails;\n    }\n  ) {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class SetPaymentDetailsFail extends StateUtils.EntityFailAction {\n  readonly type = SET_PAYMENT_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID, payload);\n  }\n}\n\nexport class SetPaymentDetailsSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = SET_PAYMENT_DETAILS_SUCCESS;\n  constructor(public payload: PaymentDetails) {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class ResetSetPaymentDetailsProcess extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_SET_PAYMENT_DETAILS_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class PlaceOrder extends StateUtils.EntityLoadAction {\n  readonly type = PLACE_ORDER;\n  constructor(\n    public payload: { userId: string; cartId: string; termsChecked: boolean }\n  ) {\n    super(PROCESS_FEATURE, PLACED_ORDER_PROCESS_ID);\n  }\n}\n\nexport class PlaceOrderFail extends StateUtils.EntityFailAction {\n  readonly type = PLACE_ORDER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, PLACED_ORDER_PROCESS_ID, payload);\n  }\n}\n\nexport class PlaceOrderSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = PLACE_ORDER_SUCCESS;\n  constructor(public payload: Order) {\n    super(PROCESS_FEATURE, PLACED_ORDER_PROCESS_ID);\n  }\n}\n\nexport class ClearPlaceOrder extends StateUtils.EntityLoaderResetAction {\n  readonly type = CLEAR_PLACE_ORDER;\n  constructor() {\n    super(PROCESS_FEATURE, PLACED_ORDER_PROCESS_ID);\n  }\n}\n\nexport class ClearSupportedDeliveryModes implements Action {\n  readonly type = CLEAR_SUPPORTED_DELIVERY_MODES;\n}\n\nexport class ClearCheckoutStep implements Action {\n  readonly type = CLEAR_CHECKOUT_STEP;\n  constructor(public payload: number) {}\n}\n\nexport class ClearCheckoutData implements Action {\n  readonly type = CLEAR_CHECKOUT_DATA;\n}\n\nexport class LoadCheckoutDetails extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_CHECKOUT_DETAILS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(CHECKOUT_DETAILS);\n  }\n}\n\nexport class LoadCheckoutDetailsFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_CHECKOUT_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(CHECKOUT_DETAILS, payload);\n  }\n}\n\nexport class LoadCheckoutDetailsSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_CHECKOUT_DETAILS_SUCCESS;\n  constructor(public payload: CheckoutDetails) {\n    super(CHECKOUT_DETAILS);\n  }\n}\n\nexport class CheckoutClearMiscsData implements Action {\n  readonly type = CHECKOUT_CLEAR_MISCS_DATA;\n}\n\nexport class ClearCheckoutDeliveryAddress implements Action {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_ADDRESS;\n  constructor(public payload: { userId: string; cartId: string }) {}\n}\n\nexport class ClearCheckoutDeliveryAddressSuccess implements Action {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_ADDRESS_SUCCESS;\n  constructor() {}\n}\n\nexport class ClearCheckoutDeliveryAddressFail implements Action {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_ADDRESS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class ClearCheckoutDeliveryMode extends EntityProcessesIncrementAction {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_MODE;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class ClearCheckoutDeliveryModeSuccess extends EntityProcessesDecrementAction {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_MODE_SUCCESS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class ClearCheckoutDeliveryModeFail extends EntityProcessesDecrementAction {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_MODE_FAIL;\n  constructor(public payload: { userId: string; cartId: string; error: any }) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class SetCostCenter extends StateUtils.EntityLoadAction {\n  readonly type = SET_COST_CENTER;\n  constructor(\n    public payload: { userId: string; cartId: string; costCenterId: string }\n  ) {\n    super(PROCESS_FEATURE, SET_COST_CENTER_PROCESS_ID);\n  }\n}\n\nexport class SetCostCenterFail extends StateUtils.EntityFailAction {\n  readonly type = SET_COST_CENTER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_COST_CENTER_PROCESS_ID, payload);\n  }\n}\n\nexport class SetCostCenterSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = SET_COST_CENTER_SUCCESS;\n  constructor(public payload: string) {\n    super(PROCESS_FEATURE, SET_COST_CENTER_PROCESS_ID);\n  }\n}\n\nexport class ResetSetCostCenterProcess extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_SET_COST_CENTER_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_COST_CENTER_PROCESS_ID);\n  }\n}\n\nexport type CheckoutAction =\n  | AddDeliveryAddress\n  | AddDeliveryAddressFail\n  | AddDeliveryAddressSuccess\n  | SetDeliveryAddress\n  | SetDeliveryAddressFail\n  | SetDeliveryAddressSuccess\n  | ResetSetDeliveryAddressProcess\n  | LoadSupportedDeliveryModes\n  | LoadSupportedDeliveryModesFail\n  | LoadSupportedDeliveryModesSuccess\n  | SetDeliveryMode\n  | SetDeliveryModeFail\n  | SetDeliveryModeSuccess\n  | ResetSetDeliveryModeProcess\n  | ClearSupportedDeliveryModes\n  | CreatePaymentDetails\n  | CreatePaymentDetailsFail\n  | CreatePaymentDetailsSuccess\n  | SetPaymentDetails\n  | SetPaymentDetailsFail\n  | SetPaymentDetailsSuccess\n  | ResetSetPaymentDetailsProcess\n  | PlaceOrder\n  | PlaceOrderFail\n  | PlaceOrderSuccess\n  | ClearCheckoutStep\n  | ClearCheckoutData\n  | ClearCheckoutDeliveryAddress\n  | ClearCheckoutDeliveryAddressFail\n  | ClearCheckoutDeliveryAddressSuccess\n  | ClearCheckoutDeliveryMode\n  | ClearCheckoutDeliveryModeFail\n  | ClearCheckoutDeliveryModeSuccess\n  | LoadCheckoutDetails\n  | LoadCheckoutDetailsFail\n  | LoadCheckoutDetailsSuccess\n  | CheckoutClearMiscsData\n  | SetCostCenter\n  | SetCostCenterFail\n  | SetCostCenterSuccess\n  | ResetSetCostCenterProcess;\n","import { Action } from '@ngrx/store';\nimport { ORDER_TYPE } from '../../../model/replenishment-order.model';\n\nexport const SET_ORDER_TYPE = '[Checkout] Set Order Type';\n\nexport class SetOrderType implements Action {\n  readonly type = SET_ORDER_TYPE;\n  constructor(public payload: ORDER_TYPE) {}\n}\n\nexport type OrderTypesActions = SetOrderType;\n","import { Action } from '@ngrx/store';\nimport { PaymentType, Cart } from '../../../model/cart.model';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntitySuccessAction,\n  EntityLoaderResetAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { GET_PAYMENT_TYPES_PROCESS_ID } from '../checkout-state';\n\nexport const LOAD_PAYMENT_TYPES = '[Checkout] Load Payment Types';\nexport const LOAD_PAYMENT_TYPES_FAIL = '[Checkout] Load Payment Types Fail';\nexport const LOAD_PAYMENT_TYPES_SUCCESS =\n  '[Checkout] Load Payment Types Success';\nexport const RESET_LOAD_PAYMENT_TYPES_PROCESS_ID =\n  '[Checkout] Reset Load Payment Type Process';\n\nexport const SET_PAYMENT_TYPE = '[Checkout] Set Payment Type';\nexport const SET_PAYMENT_TYPE_FAIL = '[Checkout] Set Payment Type Fail';\nexport const SET_PAYMENT_TYPE_SUCCESS = '[Checkout] Set Payment Type Success';\n\nexport class LoadPaymentTypes extends EntityLoadAction {\n  readonly type = LOAD_PAYMENT_TYPES;\n  constructor() {\n    super(PROCESS_FEATURE, GET_PAYMENT_TYPES_PROCESS_ID);\n  }\n}\n\nexport class LoadPaymentTypesFail extends EntityFailAction {\n  readonly type = LOAD_PAYMENT_TYPES_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, GET_PAYMENT_TYPES_PROCESS_ID);\n  }\n}\n\nexport class LoadPaymentTypesSuccess extends EntitySuccessAction {\n  readonly type = LOAD_PAYMENT_TYPES_SUCCESS;\n  constructor(public payload: PaymentType[]) {\n    super(PROCESS_FEATURE, GET_PAYMENT_TYPES_PROCESS_ID);\n  }\n}\n\nexport class ResetLoadPaymentTypesProcess extends EntityLoaderResetAction {\n  readonly type = RESET_LOAD_PAYMENT_TYPES_PROCESS_ID;\n  constructor() {\n    super(PROCESS_FEATURE, GET_PAYMENT_TYPES_PROCESS_ID);\n  }\n}\n\nexport class SetPaymentType implements Action {\n  readonly type = SET_PAYMENT_TYPE;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      typeCode: string;\n      poNumber?: string;\n    }\n  ) {}\n}\n\nexport class SetPaymentTypeFail implements Action {\n  readonly type = SET_PAYMENT_TYPE_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class SetPaymentTypeSuccess implements Action {\n  readonly type = SET_PAYMENT_TYPE_SUCCESS;\n  constructor(public payload: Cart) {}\n}\n\nexport type PaymentTypesAction =\n  | LoadPaymentTypes\n  | LoadPaymentTypesFail\n  | LoadPaymentTypesSuccess\n  | ResetLoadPaymentTypesProcess\n  | SetPaymentType\n  | SetPaymentTypeFail\n  | SetPaymentTypeSuccess;\n","import {\n  ReplenishmentOrder,\n  ScheduleReplenishmentForm,\n} from '../../../model/replenishment-order.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateUtils } from '../../../state/utils/index';\nimport { PLACED_ORDER_PROCESS_ID } from '../checkout-state';\n\nexport const SCHEDULE_REPLENISHMENT_ORDER =\n  '[Checkout] Schedule Replenishment Order';\nexport const SCHEDULE_REPLENISHMENT_ORDER_SUCCESS =\n  '[Checkout] Schedule Replenishment Order Success';\nexport const SCHEDULE_REPLENISHMENT_ORDER_FAIL =\n  '[Checkout] Schedule Replenishment Order Fail';\nexport const CLEAR_SCHEDULE_REPLENISHMENT_ORDER =\n  '[Checkout] Clear Schedule Replenishment Data';\n\nexport class ScheduleReplenishmentOrder extends StateUtils.EntityLoadAction {\n  readonly type = SCHEDULE_REPLENISHMENT_ORDER;\n  constructor(\n    public payload: {\n      cartId: string;\n      scheduleReplenishmentForm: ScheduleReplenishmentForm;\n      termsChecked: boolean;\n      userId: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, PLACED_ORDER_PROCESS_ID);\n  }\n}\n\nexport class ScheduleReplenishmentOrderSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = SCHEDULE_REPLENISHMENT_ORDER_SUCCESS;\n  constructor(public payload: ReplenishmentOrder) {\n    super(PROCESS_FEATURE, PLACED_ORDER_PROCESS_ID);\n  }\n}\n\nexport class ScheduleReplenishmentOrderFail extends StateUtils.EntityFailAction {\n  readonly type = SCHEDULE_REPLENISHMENT_ORDER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, PLACED_ORDER_PROCESS_ID, payload);\n  }\n}\n\nexport class ClearScheduleReplenishmentOrderAction extends StateUtils.EntityLoaderResetAction {\n  readonly type = CLEAR_SCHEDULE_REPLENISHMENT_ORDER;\n  constructor() {\n    super(PROCESS_FEATURE, PLACED_ORDER_PROCESS_ID);\n  }\n}\n\nexport type ReplenishmentOrderActions =\n  | ScheduleReplenishmentOrder\n  | ScheduleReplenishmentOrderSuccess\n  | ScheduleReplenishmentOrderFail\n  | ClearScheduleReplenishmentOrderAction;\n","/**\n * Indicates that a user has successfully placed an order\n */\nexport class OrderPlacedEvent {\n  code: string;\n}\n","import { Injectable } from '@angular/core';\nimport { StateEventService } from '../../state/event/state-event.service';\nimport { CheckoutActions } from '../store/actions/index';\nimport { OrderPlacedEvent } from './checkout.events';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutEventBuilder {\n  constructor(protected stateEventService: StateEventService) {\n    this.register();\n  }\n\n  /**\n   * Registers checkout events\n   */\n  protected register(): void {\n    this.orderPlacedEvent();\n  }\n\n  /**\n   * Register an order successfully placed event\n   */\n  protected orderPlacedEvent(): void {\n    this.stateEventService.register({\n      action: CheckoutActions.PLACE_ORDER_SUCCESS,\n      event: OrderPlacedEvent,\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CheckoutEventBuilder } from './checkout-event.builder';\n\n@NgModule({})\nexport class CheckoutEventModule {\n  constructor(_checkoutEventBuilder: CheckoutEventBuilder) {}\n}\n","import { OrderEntry } from '../../../model/order.model';\nimport {\n  EntityProcessesDecrementAction,\n  EntityProcessesIncrementAction,\n} from '../../../state/utils/entity-processes-loader/entity-processes-loader.action';\nimport { MULTI_CART_DATA } from '../multi-cart-state';\n\nexport const CART_ADD_ENTRY = '[Cart-entry] Add Entry';\nexport const CART_ADD_ENTRY_SUCCESS = '[Cart-entry] Add Entry Success';\nexport const CART_ADD_ENTRY_FAIL = '[Cart-entry] Add Entry Fail';\nexport const CART_REMOVE_ENTRY = '[Cart-entry] Remove Entry';\nexport const CART_REMOVE_ENTRY_SUCCESS = '[Cart-entry] Remove Entry Success';\nexport const CART_REMOVE_ENTRY_FAIL = '[Cart-entry] Remove Entry Fail';\n\nexport const CART_UPDATE_ENTRY = '[Cart-entry] Update Entry';\nexport const CART_UPDATE_ENTRY_SUCCESS = '[Cart-entry] Update Entry Success';\nexport const CART_UPDATE_ENTRY_FAIL = '[Cart-entry] Update Entry Fail';\n\nexport class CartAddEntry extends EntityProcessesIncrementAction {\n  readonly type = CART_ADD_ENTRY;\n  constructor(\n    public payload: {\n      cartId: string;\n      userId: string;\n      productCode: string;\n      quantity: number;\n    }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class CartAddEntrySuccess extends EntityProcessesDecrementAction {\n  readonly type = CART_ADD_ENTRY_SUCCESS;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      productCode: string;\n      quantity: number;\n      deliveryModeChanged: boolean;\n      entry: OrderEntry;\n      quantityAdded: number;\n      statusCode: string;\n      statusMessage: string;\n    }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class CartAddEntryFail extends EntityProcessesDecrementAction {\n  readonly type = CART_ADD_ENTRY_FAIL;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      productCode: string;\n      quantity: number;\n      error: any;\n    }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class CartRemoveEntry extends EntityProcessesIncrementAction {\n  readonly type = CART_REMOVE_ENTRY;\n  constructor(\n    public payload: { cartId: string; userId: string; entryNumber: string }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class CartRemoveEntrySuccess extends EntityProcessesDecrementAction {\n  readonly type = CART_REMOVE_ENTRY_SUCCESS;\n  constructor(\n    public payload: { userId: string; cartId: string; entryNumber: string }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class CartRemoveEntryFail extends EntityProcessesDecrementAction {\n  readonly type = CART_REMOVE_ENTRY_FAIL;\n  constructor(\n    public payload: {\n      error: any;\n      cartId: string;\n      userId: string;\n      entryNumber: string;\n    }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class CartUpdateEntry extends EntityProcessesIncrementAction {\n  readonly type = CART_UPDATE_ENTRY;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      entryNumber: string;\n      quantity: number;\n    }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class CartUpdateEntrySuccess extends EntityProcessesDecrementAction {\n  readonly type = CART_UPDATE_ENTRY_SUCCESS;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      entryNumber: string;\n      quantity: number;\n    }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class CartUpdateEntryFail extends EntityProcessesDecrementAction {\n  readonly type = CART_UPDATE_ENTRY_FAIL;\n  constructor(\n    public payload: {\n      error: any;\n      userId: string;\n      cartId: string;\n      entryNumber: string;\n      quantity: number;\n    }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport type CartEntryAction =\n  | CartAddEntry\n  | CartAddEntrySuccess\n  | CartAddEntryFail\n  | CartRemoveEntry\n  | CartRemoveEntrySuccess\n  | CartRemoveEntryFail\n  | CartUpdateEntry\n  | CartUpdateEntrySuccess\n  | CartUpdateEntryFail;\n","import { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityLoaderResetAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport {\n  EntityProcessesDecrementAction,\n  EntityProcessesIncrementAction,\n} from '../../../state/utils/entity-processes-loader/entity-processes-loader.action';\nimport { ADD_VOUCHER_PROCESS_ID, MULTI_CART_DATA } from '../multi-cart-state';\n\nexport const CART_ADD_VOUCHER = '[Cart-voucher] Add Cart Vouchers';\nexport const CART_ADD_VOUCHER_FAIL = '[Cart-voucher] Add Cart Voucher Fail';\nexport const CART_ADD_VOUCHER_SUCCESS =\n  '[Cart-voucher] Add Cart Voucher Success';\nexport const CART_RESET_ADD_VOUCHER = '[Cart-voucher] Reset Add Cart Voucher';\n\nexport const CART_REMOVE_VOUCHER = '[Cart-voucher] Remove Cart Voucher';\nexport const CART_REMOVE_VOUCHER_FAIL =\n  '[Cart-voucher] Remove Cart Voucher Fail';\nexport const CART_REMOVE_VOUCHER_SUCCESS =\n  '[Cart-voucher] Remove Cart Voucher Success';\n\n// Adding cart voucher actions\nexport class CartAddVoucher extends EntityLoadAction {\n  readonly type = CART_ADD_VOUCHER;\n  constructor(\n    public payload: { userId: string; cartId: string; voucherId: string }\n  ) {\n    super(PROCESS_FEATURE, ADD_VOUCHER_PROCESS_ID);\n  }\n}\n\nexport class CartAddVoucherFail extends EntityFailAction {\n  readonly type = CART_ADD_VOUCHER_FAIL;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      voucherId: string;\n      error: any;\n    }\n  ) {\n    super(PROCESS_FEATURE, ADD_VOUCHER_PROCESS_ID, payload.error);\n  }\n}\n\nexport class CartAddVoucherSuccess extends EntitySuccessAction {\n  readonly type = CART_ADD_VOUCHER_SUCCESS;\n  constructor(\n    public payload: { userId: string; cartId: string; voucherId: string }\n  ) {\n    super(PROCESS_FEATURE, ADD_VOUCHER_PROCESS_ID);\n  }\n}\n\n// TODO(#7241): Remove when switching to event system for vouchers\n/**\n * Resets add voucher process\n *\n * @deprecated since 2.0\n */\nexport class CartResetAddVoucher extends EntityLoaderResetAction {\n  readonly type = CART_RESET_ADD_VOUCHER;\n  constructor() {\n    super(PROCESS_FEATURE, ADD_VOUCHER_PROCESS_ID);\n  }\n}\n\n// Deleting cart voucher\nexport class CartRemoveVoucher extends EntityProcessesIncrementAction {\n  readonly type = CART_REMOVE_VOUCHER;\n  constructor(\n    public payload: { userId: string; cartId: string; voucherId: string }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class CartRemoveVoucherFail extends EntityProcessesDecrementAction {\n  readonly type = CART_REMOVE_VOUCHER_FAIL;\n  constructor(\n    public payload: {\n      error: any;\n      cartId: string;\n      userId: string;\n      voucherId: string;\n    }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class CartRemoveVoucherSuccess extends EntityProcessesDecrementAction {\n  readonly type = CART_REMOVE_VOUCHER_SUCCESS;\n  constructor(\n    public payload: { userId: string; cartId: string; voucherId: string }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\n// action types\nexport type CartVoucherAction =\n  | CartAddVoucher\n  | CartAddVoucherFail\n  | CartAddVoucherSuccess\n  | CartResetAddVoucher\n  | CartRemoveVoucher\n  | CartRemoveVoucherFail\n  | CartRemoveVoucherSuccess;\n","import { Action } from '@ngrx/store';\nimport { Cart } from '../../../model/cart.model';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport {\n  EntityProcessesDecrementAction,\n  EntityProcessesIncrementAction,\n} from '../../../state/utils/entity-processes-loader/entity-processes-loader.action';\nimport { EntityRemoveAction } from '../../../state/utils/entity/entity.action';\nimport { ProcessesLoaderResetAction } from '../../../state/utils/processes-loader/processes-loader.action';\nimport { MULTI_CART_DATA } from '../multi-cart-state';\n\nexport const CREATE_CART = '[Cart] Create Cart';\nexport const CREATE_CART_FAIL = '[Cart] Create Cart Fail';\nexport const CREATE_CART_SUCCESS = '[Cart] Create Cart Success';\n\nexport const LOAD_CART = '[Cart] Load Cart';\nexport const LOAD_CART_FAIL = '[Cart] Load Cart Fail';\nexport const LOAD_CART_SUCCESS = '[Cart] Load Cart Success';\n\nexport const ADD_EMAIL_TO_CART = '[Cart] Add Email to Cart';\nexport const ADD_EMAIL_TO_CART_FAIL = '[Cart] Add Email to Cart Fail';\nexport const ADD_EMAIL_TO_CART_SUCCESS = '[Cart] Add Email to Cart Success';\n\nexport const MERGE_CART = '[Cart] Merge Cart';\nexport const MERGE_CART_SUCCESS = '[Cart] Merge Cart Success';\n\nexport const RESET_CART_DETAILS = '[Cart] Reset Cart Details';\n\nexport const REMOVE_CART = '[Cart] Remove Cart';\n\nexport const DELETE_CART = '[Cart] Delete Cart';\nexport const DELETE_CART_SUCCESS = '[Cart] Delete Cart Success';\nexport const DELETE_CART_FAIL = '[Cart] Delete Cart Fail';\n\ninterface CreateCartPayload {\n  userId: string;\n  /** Used as a unique key in ngrx carts store (we don't know cartId at that time) */\n  tempCartId: string;\n  extraData?: {\n    active?: boolean;\n  };\n  /** Anonymous cart which should be merged to new cart */\n  oldCartId?: string;\n  /** Cart to which should we merge (not passing this will create new cart) */\n  toMergeCartGuid?: string;\n}\n\nexport class CreateCart extends EntityLoadAction {\n  readonly type = CREATE_CART;\n  constructor(public payload: CreateCartPayload) {\n    super(MULTI_CART_DATA, payload.tempCartId);\n  }\n}\n\ninterface CreateCartFailPayload extends CreateCartPayload {\n  error: any;\n}\n\nexport class CreateCartFail extends EntityFailAction {\n  readonly type = CREATE_CART_FAIL;\n  constructor(public payload: CreateCartFailPayload) {\n    super(MULTI_CART_DATA, payload.tempCartId);\n  }\n}\n\ninterface CreateCartSuccessPayload extends CreateCartPayload {\n  cart: Cart;\n  cartId: string;\n}\n\nexport class CreateCartSuccess extends EntitySuccessAction {\n  readonly type = CREATE_CART_SUCCESS;\n  constructor(public payload: CreateCartSuccessPayload) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class AddEmailToCart extends EntityProcessesIncrementAction {\n  readonly type = ADD_EMAIL_TO_CART;\n  constructor(\n    public payload: { userId: string; cartId: string; email: string }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class AddEmailToCartFail extends EntityProcessesDecrementAction {\n  readonly type = ADD_EMAIL_TO_CART_FAIL;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      error: any;\n      email: string;\n    }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class AddEmailToCartSuccess extends EntityProcessesDecrementAction {\n  readonly type = ADD_EMAIL_TO_CART_SUCCESS;\n  constructor(\n    public payload: { userId: string; cartId: string; email: string }\n  ) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\ninterface LoadCartPayload {\n  userId: string;\n  cartId: string;\n  extraData?: {\n    active?: boolean;\n  };\n}\n\nexport class LoadCart extends EntityLoadAction {\n  readonly type = LOAD_CART;\n  constructor(public payload: LoadCartPayload) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\ninterface LoadCartFailPayload extends LoadCartPayload {\n  error: any;\n}\n\nexport class LoadCartFail extends EntityFailAction {\n  readonly type = LOAD_CART_FAIL;\n  constructor(public payload: LoadCartFailPayload) {\n    super(MULTI_CART_DATA, payload.cartId, payload.error);\n  }\n}\n\ninterface LoadCartSuccessPayload extends LoadCartPayload {\n  cart: Cart;\n}\n\nexport class LoadCartSuccess extends EntitySuccessAction {\n  readonly type = LOAD_CART_SUCCESS;\n  constructor(public payload: LoadCartSuccessPayload) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\ninterface MergeCartPayload {\n  cartId: string;\n  userId: string;\n  extraData?: { active?: boolean };\n  /**\n   * MergeCart actions triggers CreateCart which requires this parameter, so that's why it is required.\n   */\n  tempCartId: string;\n}\n\nexport class MergeCart implements Action {\n  readonly type = MERGE_CART;\n  constructor(public payload: MergeCartPayload) {}\n}\n\ninterface MergeCartSuccessPayload extends MergeCartPayload {\n  /**\n   * Previous cart id which was merged with new/user cart.\n   * Needed to know which obsolete entity should be removed.\n   */\n  oldCartId: string;\n}\n\nexport class MergeCartSuccess extends EntityRemoveAction {\n  readonly type = MERGE_CART_SUCCESS;\n  constructor(public payload: MergeCartSuccessPayload) {\n    super(MULTI_CART_DATA, payload.oldCartId);\n  }\n}\n\n/**\n * On site context change we want to keep current list of entities, but we want to clear the value and flags.\n * With ProcessesLoaderResetAction we run it on every entity of this type.\n */\nexport class ResetCartDetails extends ProcessesLoaderResetAction {\n  readonly type = RESET_CART_DETAILS;\n  constructor() {\n    super(MULTI_CART_DATA);\n  }\n}\n\n/**\n * Used for cleaning cart in local state, when we get information that it no longer exists in the backend.\n * For removing particular cart in both places use DeleteCart actions.\n */\nexport class RemoveCart extends EntityRemoveAction {\n  readonly type = REMOVE_CART;\n  constructor(public payload: { cartId: string }) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class DeleteCart implements Action {\n  readonly type = DELETE_CART;\n  constructor(public payload: { userId: string; cartId: string }) {}\n}\n\nexport class DeleteCartSuccess extends EntityRemoveAction {\n  readonly type = DELETE_CART_SUCCESS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\nexport class DeleteCartFail implements Action {\n  readonly type = DELETE_CART_FAIL;\n  constructor(public payload: { userId: string; cartId: string; error: any }) {}\n}\n\nexport type CartAction =\n  | CreateCart\n  | CreateCartFail\n  | CreateCartSuccess\n  | LoadCart\n  | LoadCartFail\n  | LoadCartSuccess\n  | MergeCart\n  | MergeCartSuccess\n  | ResetCartDetails\n  | AddEmailToCart\n  | AddEmailToCartFail\n  | AddEmailToCartSuccess\n  | DeleteCart\n  | DeleteCartSuccess\n  | DeleteCartFail\n  | RemoveCart;\n","import { Action } from '@ngrx/store';\nimport { Cart } from '../../../model/cart.model';\nimport { EntitySuccessAction } from '../../../state/utils/entity-loader/entity-loader.action';\nimport {\n  EntityProcessesDecrementAction,\n  EntityProcessesIncrementAction,\n} from '../../../state/utils/entity-processes-loader/entity-processes-loader.action';\nimport { EntityRemoveAllAction } from '../../../state/utils/entity/entity.action';\nimport { MULTI_CART_DATA } from '../multi-cart-state';\n\nexport const SET_TEMP_CART = '[Cart] Set Temp Cart';\n\nexport const CART_PROCESSES_INCREMENT = '[Cart] Cart Processes Increment';\nexport const CART_PROCESSES_DECREMENT = '[Cart] Cart Processes Decrement';\n\nexport const SET_ACTIVE_CART_ID = '[Cart] Set Active Cart Id';\n\nexport const CLEAR_CART_STATE = '[Cart] Clear Cart State';\n\n/**\n * To keep track of cart creation process we use cart with `temp-${uuid}` id.\n * After creating cart we switch to entity with `code` or `guid`.\n * We need `temp-${uuid}` cart entities for loading/error state.\n */\nexport class SetTempCart extends EntitySuccessAction {\n  readonly type = SET_TEMP_CART;\n  constructor(public payload: { cart: Cart; tempCartId: string }) {\n    super(MULTI_CART_DATA, payload.tempCartId, payload.cart);\n  }\n}\n\n// TODO(#7241): Remove when there won't be any usage\n/**\n * Increases process counter on cart entities\n * All actions that cause computations on cart should extend EntityProcessesIncrementAction instead of dispatching this action.\n * @deprecated since 2.0\n */\nexport class CartProcessesIncrement extends EntityProcessesIncrementAction {\n  readonly type = CART_PROCESSES_INCREMENT;\n  constructor(public payload: string) {\n    super(MULTI_CART_DATA, payload);\n  }\n}\n\n// TODO(#7241): Remove when there won't be any usage\n/**\n * Decrement process counter on cart entities\n * All actions that cause computations on cart should extend EntityProcessesDecrementAction instead of dispatching this action.\n * @deprecated since 2.0\n */\nexport class CartProcessesDecrement extends EntityProcessesDecrementAction {\n  readonly type = CART_PROCESSES_DECREMENT;\n  constructor(public payload: string) {\n    super(MULTI_CART_DATA, payload);\n  }\n}\n\n/**\n * Only sets active cart property with id of active cart. Then services take care of loading that cart.\n */\nexport class SetActiveCartId implements Action {\n  readonly type = SET_ACTIVE_CART_ID;\n  constructor(public payload: string) {}\n}\n\n/**\n * Clear whole cart store state: all entities + reset rest of the cart state.\n */\nexport class ClearCartState extends EntityRemoveAllAction {\n  readonly type = CLEAR_CART_STATE;\n  constructor() {\n    super(MULTI_CART_DATA);\n  }\n}\n\nexport type MultiCartActions =\n  | SetTempCart\n  | CartProcessesIncrement\n  | CartProcessesDecrement\n  | SetActiveCartId\n  | ClearCartState;\n","import { ErrorModel } from '../../model';\nimport { Cart } from '../../model/cart.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\n\n/**\n * Extract cart identifier for current user. Anonymous calls use `guid` and for logged users `code` is used.\n */\nexport function getCartIdByUserId(cart: Cart, userId: string): string {\n  if (userId === OCC_USER_ID_ANONYMOUS) {\n    return cart.guid;\n  }\n  return cart.code;\n}\n\n/**\n * Check if cart is selective (save for later) based on id.\n */\nexport function isSelectiveCart(cartId = ''): boolean {\n  return cartId.startsWith('selectivecart');\n}\n\n/**\n * Check if the returned error is of type notFound.\n *\n * We additionally check if the cart is not a selective cart.\n * For selective cart this error can happen only when extension is disabled.\n * It should never happen, because in that case, selective cart should also be disabled in our configuration.\n * However if that happens we want to handle these errors silently.\n */\nexport function isCartNotFoundError(error: ErrorModel): boolean {\n  return (\n    error.reason === 'notFound' &&\n    error.subjectType === 'cart' &&\n    !isSelectiveCart(error.subject)\n  );\n}\n\n/**\n * Compute wishlist cart name for customer.\n */\nexport function getWishlistName(customerId: string): string {\n  return `wishlist${customerId}`;\n}\n\n/**\n * What is a temporary cart?\n * - frontend only cart entity!\n * - can be identified in store by `temp-` prefix with some unique id (multiple carts can be created at the same time eg. active cart, wishlist)\n *\n * Why we need temporary carts?\n * - to have information about cart creation process (meta flags: loading, error - for showing loader, error message)\n * - to know if there is currently a cart creation process in progress (eg. so, we don't create more than one active cart at the same time)\n * - cart identifiers are created in the backend, so those are only known after cart is created\n *\n * Temporary cart life cycle\n * - create cart method invoked\n * - new `temp-${uuid}` cart is created with `loading=true` state\n * - backend returns created cart\n * - normal cart entity is saved under correct id (eg. for logged user under cart `code` key)\n * - temporary cart value is set to backend response (anyone observing this cart can read code/guid from it and switch selector to normal cart)\n * - in next tick temporary cart is removed\n */\nexport function isTempCartId(cartId: string): boolean {\n  return cartId.startsWith('temp-');\n}\n","import { Action } from '@ngrx/store';\nimport { Cart } from '../../../model/cart.model';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport { getCartIdByUserId } from '../../utils/utils';\nimport { MULTI_CART_DATA } from '../multi-cart-state';\n\nexport const CREATE_WISH_LIST = '[Wish List] Create Wish List';\nexport const CREATE_WISH_LIST_FAIL = '[Wish List] Create Wish List Fail';\nexport const CREATE_WISH_LIST_SUCCESS = '[Wish List] Create Wish List Success';\n\nexport const LOAD_WISH_LIST = '[Wish List] Load Wish List';\nexport const LOAD_WISH_LIST_SUCCESS = '[Wish List] Load Wish List Success';\nexport const LOAD_WISH_LIST_FAIL = '[Wish List] Load Wish List Fail';\n\nexport const RESET_WISH_LIST_DETAILS = '[Wish List] Reset Wish List';\n\nexport class CreateWishList implements Action {\n  readonly type = CREATE_WISH_LIST;\n  constructor(\n    public payload: {\n      userId: string;\n      name: string;\n      description?: string;\n    }\n  ) {}\n}\n\nexport class CreateWishListSuccess extends EntitySuccessAction {\n  readonly type = CREATE_WISH_LIST_SUCCESS;\n  constructor(public payload: { cart: Cart; userId: string }) {\n    super(MULTI_CART_DATA, getCartIdByUserId(payload.cart, payload.userId));\n  }\n}\n\nexport class CreateWishListFail extends EntityFailAction {\n  readonly type = CREATE_WISH_LIST_FAIL;\n  constructor(public payload: { cartId: string; error?: any }) {\n    super(MULTI_CART_DATA, payload.cartId, payload.error);\n  }\n}\n\ninterface LoadWishListPayload {\n  userId: string;\n  /**\n   * Used to compute wishlist cart name and find it in list of all carts.\n   */\n  customerId: string;\n  /**\n   * When we try load wishlist for the first time we don't know cart id.\n   * Instead we create temporary cart with id equal to wishlist name to keep track of loading/error state.\n   */\n  tempCartId: string;\n}\n\nexport class LoadWishList extends EntityLoadAction {\n  readonly type = LOAD_WISH_LIST;\n  constructor(public payload: LoadWishListPayload) {\n    super(MULTI_CART_DATA, payload.tempCartId);\n  }\n}\n\ninterface LoadWishListSuccessPayload {\n  cart: Cart;\n  userId: string;\n  /**\n   * When LoadWishListSuccess action was dispatched as an completion to LoadWishList action\n   * we get temporary cartId that was used to keep track of loading state.\n   * In case of loading wish list with known cartId this property will be empty.\n   */\n  tempCartId?: string;\n  /**\n   * Used to compute wishlist cart name and find it in list of all carts.\n   * In case of loading wish list with known cartId this property will be empty.\n   */\n  customerId?: string;\n  /**\n   * Wish list cart id. Extracted from cart content (code property).\n   */\n  cartId: string;\n}\n\nexport class LoadWishListSuccess extends EntitySuccessAction {\n  readonly type = LOAD_WISH_LIST_SUCCESS;\n  constructor(public payload: LoadWishListSuccessPayload) {\n    super(MULTI_CART_DATA, payload.cartId);\n  }\n}\n\ninterface LoadWishListFailPayload {\n  userId: string;\n  /**\n   * Used to compute wishlist cart name and find it in list of all carts.\n   * In case of loading wish list with known cartId this property will be empty.\n   */\n  customerId?: string;\n  /**\n   * Cart id used as a store entity key. This could point either to some\n   * temporary cart used to track loading/error state or to normal wish list entity.\n   */\n  cartId: string;\n  error: any;\n}\n\nexport class LoadWishListFail extends EntityFailAction {\n  readonly type = LOAD_WISH_LIST_FAIL;\n  constructor(public payload: LoadWishListFailPayload) {\n    super(MULTI_CART_DATA, payload.cartId, payload.error);\n  }\n}\n\nexport type WishListActions =\n  | CreateWishList\n  | CreateWishListSuccess\n  | CreateWishListFail\n  | LoadWishList\n  | LoadWishListSuccess\n  | LoadWishListFail;\n","import {\n  createFeatureSelector,\n  createSelector,\n  MemoizedSelector,\n} from '@ngrx/store';\nimport { Cart } from '../../../model/cart.model';\nimport { OrderEntry } from '../../../model/order.model';\nimport { entityValueSelector } from '../../../state/utils/entity-loader/entity-loader.selectors';\nimport { EntityProcessesLoaderState } from '../../../state/utils/entity-processes-loader/entity-processes-loader-state';\nimport {\n  entityHasPendingProcessesSelector,\n  entityIsStableSelector,\n  entityProcessesLoaderStateSelector,\n} from '../../../state/utils/entity-processes-loader/entity-processes-loader.selectors';\nimport { ProcessesLoaderState } from '../../../state/utils/processes-loader/processes-loader-state';\nimport {\n  MultiCartState,\n  MULTI_CART_FEATURE,\n  StateWithMultiCart,\n} from '../multi-cart-state';\n\nexport const getMultiCartState: MemoizedSelector<\n  StateWithMultiCart,\n  MultiCartState\n> = createFeatureSelector<MultiCartState>(MULTI_CART_FEATURE);\n\nexport const getMultiCartEntities: MemoizedSelector<\n  StateWithMultiCart,\n  EntityProcessesLoaderState<Cart>\n> = createSelector(getMultiCartState, (state: MultiCartState) => state.carts);\n\nexport const getCartEntitySelectorFactory = (\n  cartId: string\n): MemoizedSelector<StateWithMultiCart, ProcessesLoaderState<Cart>> => {\n  return createSelector(\n    getMultiCartEntities,\n    (state: EntityProcessesLoaderState<Cart>) =>\n      entityProcessesLoaderStateSelector(state, cartId)\n  );\n};\n\nexport const getCartSelectorFactory = (\n  cartId: string\n): MemoizedSelector<StateWithMultiCart, Cart> => {\n  return createSelector(\n    getMultiCartEntities,\n    (state: EntityProcessesLoaderState<Cart>) =>\n      entityValueSelector(state, cartId)\n  );\n};\n\nexport const getCartIsStableSelectorFactory = (\n  cartId: string\n): MemoizedSelector<StateWithMultiCart, boolean> => {\n  return createSelector(\n    getMultiCartEntities,\n    (state: EntityProcessesLoaderState<Cart>) =>\n      entityIsStableSelector(state, cartId)\n  );\n};\n\nexport const getCartHasPendingProcessesSelectorFactory = (\n  cartId: string\n): MemoizedSelector<StateWithMultiCart, boolean> => {\n  return createSelector(\n    getMultiCartEntities,\n    (state: EntityProcessesLoaderState<Cart>) =>\n      entityHasPendingProcessesSelector(state, cartId)\n  );\n};\n\nexport const getCartEntriesSelectorFactory = (\n  cartId: string\n): MemoizedSelector<StateWithMultiCart, OrderEntry[]> => {\n  return createSelector(getCartSelectorFactory(cartId), (state: Cart) => {\n    return state && state.entries ? state.entries : [];\n  });\n};\n\nexport const getCartEntrySelectorFactory = (\n  cartId: string,\n  productCode: string\n): MemoizedSelector<StateWithMultiCart, OrderEntry> => {\n  return createSelector(\n    getCartEntriesSelectorFactory(cartId),\n    (state: OrderEntry[]) => {\n      return state\n        ? state.find((entry) => entry.product.code === productCode)\n        : undefined;\n    }\n  );\n};\n\nexport const getActiveCartId: MemoizedSelector<\n  StateWithMultiCart,\n  string\n> = createSelector(getMultiCartState, (state: MultiCartState) => state.active);\n\nexport const getWishListId: MemoizedSelector<\n  StateWithMultiCart,\n  string\n> = createSelector(\n  getMultiCartState,\n  (state: MultiCartState) => state.wishList\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { EMPTY, Observable, timer } from 'rxjs';\nimport { debounce, distinctUntilChanged, map } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/index';\nimport { Cart } from '../../model/cart.model';\nimport { OrderEntry } from '../../model/order.model';\nimport { ProcessesLoaderState } from '../../state/utils/processes-loader/processes-loader-state';\nimport { CartActions } from '../store/actions/index';\nimport { StateWithMultiCart } from '../store/multi-cart-state';\nimport { MultiCartSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class MultiCartService {\n  constructor(\n    protected store: Store<StateWithMultiCart>,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Returns cart from store as an observable\n   *\n   * @param cartId\n   */\n  getCart(cartId: string): Observable<Cart> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getCartSelectorFactory(cartId))\n    );\n  }\n\n  /**\n   * Returns cart entity from store (cart with loading, error, success flags) as an observable\n   *\n   * @param cartId\n   */\n  getCartEntity(cartId: string): Observable<ProcessesLoaderState<Cart>> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getCartEntitySelectorFactory(cartId))\n    );\n  }\n\n  /**\n   * Returns true when there are no operations on that in progress and it is not currently loading\n   *\n   * @param cartId\n   */\n  isStable(cartId: string): Observable<boolean> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getCartIsStableSelectorFactory(cartId)),\n      // We dispatch a lot of actions just after finishing some process or loading, so we want this flag not to flicker.\n      // This flickering should only be avoided when switching from false to true\n      // Start of loading should be showed instantly (no debounce)\n      // Extra actions are only dispatched after some loading\n      debounce((isStable) => (isStable ? timer(0) : EMPTY)),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Simple random temp cart id generator\n   */\n  private generateTempCartId(): string {\n    const pseudoUuid = Math.random().toString(36).substr(2, 9);\n    return `temp-${pseudoUuid}`;\n  }\n\n  /**\n   * Create or merge cart\n   *\n   * @param params Object with userId, oldCartId, toMergeCartGuid and extraData\n   */\n  createCart({\n    userId,\n    oldCartId,\n    toMergeCartGuid,\n    extraData,\n  }: {\n    userId: string;\n    oldCartId?: string;\n    toMergeCartGuid?: string;\n    extraData?: {\n      active?: boolean;\n    };\n  }): Observable<ProcessesLoaderState<Cart>> {\n    // to support creating multiple carts at the same time we need to use different entity for every process\n    // simple random uuid generator is used here for entity names\n    const tempCartId = this.generateTempCartId();\n    this.store.dispatch(\n      new CartActions.CreateCart({\n        extraData,\n        userId,\n        oldCartId,\n        toMergeCartGuid,\n        tempCartId,\n      })\n    );\n    return this.getCartEntity(tempCartId);\n  }\n\n  /**\n   * Merge provided cart to current user cart\n   *\n   * @param params Object with userId, cartId and extraData\n   */\n  mergeToCurrentCart({\n    userId,\n    cartId,\n    extraData,\n  }: {\n    userId: string;\n    cartId: string;\n    extraData?: {\n      active?: boolean;\n    };\n  }) {\n    const tempCartId = this.generateTempCartId();\n    this.store.dispatch(\n      new CartActions.MergeCart({\n        userId,\n        cartId,\n        extraData,\n        tempCartId,\n      })\n    );\n  }\n\n  /**\n   * Load cart\n   *\n   * @param params Object with userId, cartId and extraData\n   */\n  loadCart({\n    cartId,\n    userId,\n    extraData,\n  }: {\n    cartId: string;\n    userId: string;\n    extraData?: any;\n  }): void {\n    this.store.dispatch(\n      new CartActions.LoadCart({\n        userId,\n        cartId,\n        extraData,\n      })\n    );\n  }\n\n  /**\n   * Get cart entries as an observable\n   * @param cartId\n   */\n  getEntries(cartId: string): Observable<OrderEntry[]> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getCartEntriesSelectorFactory(cartId))\n    );\n  }\n\n  /**\n   * Get last entry for specific product code from cart.\n   * Needed to cover processes where multiple entries can share the same product code\n   * (e.g. promotions or configurable products)\n   *\n   * @param cartId\n   * @param productCode\n   */\n  getLastEntry(\n    cartId: string,\n    productCode: string\n  ): Observable<OrderEntry | null> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getCartEntriesSelectorFactory(cartId)),\n      map((entries) => {\n        const filteredEntries = entries.filter(\n          (entry) => entry.product.code === productCode\n        );\n        return filteredEntries\n          ? filteredEntries[filteredEntries.length - 1]\n          : undefined;\n      })\n    );\n  }\n\n  /**\n   * Add entry to cart\n   *\n   * @param userId\n   * @param cartId\n   * @param productCode\n   * @param quantity\n   */\n  addEntry(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity: number\n  ): void {\n    this.store.dispatch(\n      new CartActions.CartAddEntry({\n        userId,\n        cartId,\n        productCode,\n        quantity,\n      })\n    );\n  }\n\n  /**\n   * Add multiple entries to cart\n   *\n   * @param userId\n   * @param cartId\n   * @param products Array with items (productCode and quantity)\n   */\n  addEntries(\n    userId: string,\n    cartId: string,\n    products: Array<{ productCode: string; quantity: number }>\n  ): void {\n    products.forEach((product) => {\n      this.store.dispatch(\n        new CartActions.CartAddEntry({\n          userId,\n          cartId,\n          productCode: product.productCode,\n          quantity: product.quantity,\n        })\n      );\n    });\n  }\n\n  /**\n   * Remove entry from cart\n   *\n   * @param userId\n   * @param cartId\n   * @param entryNumber\n   */\n  removeEntry(userId: string, cartId: string, entryNumber: number): void {\n    this.store.dispatch(\n      new CartActions.CartRemoveEntry({\n        userId,\n        cartId,\n        entryNumber: `${entryNumber}`,\n      })\n    );\n  }\n\n  /**\n   * Update entry in cart. For quantity = 0 it removes entry\n   *\n   * @param userId\n   * @param cartId\n   * @param entryNumber\n   * @param quantity\n   */\n  updateEntry(\n    userId: string,\n    cartId: string,\n    entryNumber: number,\n    quantity: number\n  ): void {\n    if (quantity > 0) {\n      this.store.dispatch(\n        new CartActions.CartUpdateEntry({\n          userId,\n          cartId,\n          entryNumber: `${entryNumber}`,\n          quantity: quantity,\n        })\n      );\n    } else {\n      this.removeEntry(userId, cartId, entryNumber);\n    }\n  }\n\n  /**\n   * Get first entry from cart matching the specified product code\n   *\n   * @param cartId\n   * @param productCode\n   */\n  getEntry(cartId: string, productCode: string): Observable<OrderEntry | null> {\n    return this.store.pipe(\n      select(\n        MultiCartSelectors.getCartEntrySelectorFactory(cartId, productCode)\n      )\n    );\n  }\n\n  /**\n   * Assign email to the cart\n   *\n   * @param cartId\n   * @param userId\n   * @param email\n   */\n  assignEmail(cartId: string, userId: string, email: string): void {\n    this.store.dispatch(\n      new CartActions.AddEmailToCart({\n        userId,\n        cartId,\n        email,\n      })\n    );\n  }\n\n  /**\n   * Delete cart\n   *\n   * @param cartId\n   * @param userId\n   */\n  deleteCart(cartId: string, userId: string): void {\n    this.store.dispatch(\n      new CartActions.DeleteCart({\n        userId,\n        cartId,\n      })\n    );\n  }\n\n  /**\n   * Reloads the cart with specified id.\n   *\n   * @param cartId\n   * @param extraData\n   */\n  reloadCart(cartId: string, extraData?: { active: boolean }): void {\n    this.userIdService.invokeWithUserId((userId) =>\n      this.store.dispatch(\n        new CartActions.LoadCart({\n          userId,\n          cartId,\n          extraData,\n        })\n      )\n    );\n  }\n}\n","/**\n * @license\n * The MIT License\n * Copyright (c) 2010-2019 Google LLC. http://angular.io/license\n *\n * See:\n * - https://github.com/angular/angular/blob/6f5f481fdae03f1d8db36284b64c7b82d9519d85/packages/service-worker/config/src/glob.ts\n * - https://github.com/angular/angular/blob/6f5f481fdae03f1d8db36284b64c7b82d9519d85/aio/tests/deployment/shared/helpers.ts#L17\n * - https://github.com/angular/angular/blob/6f5f481fdae03f1d8db36284b64c7b82d9519d85/packages/service-worker/config/src/generator.ts#L86\n */\n\nconst QUESTION_MARK = '[^/]';\nconst WILD_SINGLE = '[^/]*';\nconst WILD_OPEN = '(?:.+\\\\/)?';\nconst TO_ESCAPE_BASE = [\n  { replace: /\\./g, with: '\\\\.' },\n  { replace: /\\+/g, with: '\\\\+' },\n  { replace: /\\*/g, with: WILD_SINGLE },\n];\nconst TO_ESCAPE_WILDCARD_QM = [\n  ...TO_ESCAPE_BASE,\n  { replace: /\\?/g, with: QUESTION_MARK },\n];\nconst TO_ESCAPE_LITERAL_QM = [\n  ...TO_ESCAPE_BASE,\n  { replace: /\\?/g, with: '\\\\?' },\n];\n\n/**\n * Converts the glob-like pattern into regex string.\n *\n * Patterns use a limited glob format:\n * `**` matches 0 or more path segments\n * `*` matches 0 or more characters excluding `/`\n * `?` matches exactly one character excluding `/` (but when @param literalQuestionMark is true, `?` is treated as normal character)\n * The `!` prefix marks the pattern as being negative, meaning that only URLs that don't match the pattern will be included\n *\n * @param glob glob-like pattern\n * @param literalQuestionMark when true, it tells that `?` is treated as a normal character\n */\nexport function globToRegex(glob: string, literalQuestionMark = false): string {\n  const toEscape = literalQuestionMark\n    ? TO_ESCAPE_LITERAL_QM\n    : TO_ESCAPE_WILDCARD_QM;\n  const segments = glob.split('/').reverse();\n  let regex = '';\n  while (segments.length > 0) {\n    const segment = segments.pop();\n    if (segment === '**') {\n      if (segments.length > 0) {\n        regex += WILD_OPEN;\n      } else {\n        regex += '.*';\n      }\n    } else {\n      const processed = toEscape.reduce(\n        (seg, escape) => seg.replace(escape.replace, escape.with),\n        segment\n      );\n      regex += processed;\n      if (segments.length > 0) {\n        regex += '\\\\/';\n      }\n    }\n  }\n  return regex;\n}\n\n/**\n * For given list of glob-like patterns, returns a matcher function.\n *\n * The matcher returns true for given URL only when ANY of the positive patterns is matched and NONE of the negative ones.\n */\nexport function getGlobMatcher(patterns: string[]): (url: string) => boolean {\n  const processedPatterns: {\n    positive: boolean;\n    regex: RegExp;\n  }[] = processGlobPatterns(patterns).map(({ positive, regex }) => ({\n    positive,\n    regex: new RegExp(regex),\n  }));\n\n  const includePatterns = processedPatterns.filter((spec) => spec.positive);\n  const excludePatterns = processedPatterns.filter((spec) => !spec.positive);\n\n  return (url: string) =>\n    includePatterns.some((pattern) => pattern.regex.test(url)) &&\n    !excludePatterns.some((pattern) => pattern.regex.test(url));\n}\n\n/**\n * Converts list of glob-like patterns into list of RegExps with information whether the glob pattern is positive or negative\n */\nexport function processGlobPatterns(\n  urls: string[]\n): { positive: boolean; regex: string }[] {\n  return urls.map((url) => {\n    const positive = !url.startsWith('!');\n    url = positive ? url : url.substr(1);\n    return { positive, regex: `^${globToRegex(url)}$` };\n  });\n}\n","import { Injectable } from '@angular/core';\nimport { processGlobPatterns } from './glob-utils';\n\n@Injectable({ providedIn: 'root' })\nexport class GlobService {\n  /**\n   * For given list of glob-like patterns, returns a validator function.\n   *\n   * The validator returns true for given URL only when ANY of the positive patterns is matched and NONE of the negative ones.\n   */\n  getValidator(patterns: string[]): (url: string) => boolean {\n    const processedPatterns: {\n      positive: boolean;\n      regex: RegExp;\n    }[] = processGlobPatterns(patterns).map(({ positive, regex }) => ({\n      positive,\n      regex: new RegExp(regex),\n    }));\n\n    const includePatterns = processedPatterns.filter((spec) => spec.positive);\n    const excludePatterns = processedPatterns.filter((spec) => !spec.positive);\n\n    return (url: string) =>\n      includePatterns.some((pattern) => pattern.regex.test(url)) &&\n      !excludePatterns.some((pattern) => pattern.regex.test(url));\n  }\n}\n","import { Injectable, isDevMode } from '@angular/core';\nimport {\n  Route,\n  UrlMatcher,\n  UrlMatchResult,\n  UrlSegment,\n  UrlSegmentGroup,\n} from '@angular/router';\nimport { GlobService } from '../../util/glob.service';\n\n@Injectable({ providedIn: 'root' })\nexport class UrlMatcherService {\n  constructor(protected globService: GlobService) {}\n\n  /**\n   * Returns a matcher that is always fails\n   */\n  getFalsy(): UrlMatcher {\n    return function falsyUrlMatcher(): null {\n      return null;\n    };\n  }\n\n  /**\n   * Returns a matcher for given list of paths\n   */\n  getFromPaths(paths: string[]): UrlMatcher {\n    const matchers = paths.map((path) => this.getFromPath(path));\n    const matcher = this.getCombined(matchers);\n    if (isDevMode()) {\n      matcher['_paths'] = paths; // property added for easier debugging of routes\n    }\n    return matcher;\n  }\n\n  /**\n   * Returns a matcher that combines the given matchers\n   * */\n  getCombined(matchers: UrlMatcher[]): UrlMatcher {\n    const matcher = function combinedUrlMatchers(\n      segments: UrlSegment[],\n      segmentGroup: UrlSegmentGroup,\n      route: Route\n    ): UrlMatchResult | null {\n      for (let i = 0; i < matchers.length; i++) {\n        const result = matchers[i](segments, segmentGroup, route);\n        if (result) {\n          return result;\n        }\n      }\n      return null;\n    };\n    if (isDevMode()) {\n      matcher['_matchers'] = matchers; // property added for easier debugging of routes\n    }\n    return matcher;\n  }\n\n  /**\n   * Similar to Angular's defaultUrlMatcher. Differences:\n   * - the `path` comes from function's argument, not from `route.path`\n   * - the empty path `''` is handled here, but in Angular is handled one level higher in the match() function\n   */\n  protected getFromPath(path: string = ''): UrlMatcher {\n    const matcher = function pathUrlMatcher(\n      segments: UrlSegment[],\n      segmentGroup: UrlSegmentGroup,\n      route: Route\n    ): UrlMatchResult | null {\n      /**\n       * @license\n       * The MIT License\n       * Copyright (c) 2010-2019 Google LLC. http://angular.io/license\n       *\n       * See:\n       * - https://github.com/angular/angular/blob/6f5f481fdae03f1d8db36284b64c7b82d9519d85/packages/router/src/shared.ts#L121\n       */\n\n      // use function's argument, not the `route.path`\n      if (path === '') {\n        if (\n          route.pathMatch === 'full' &&\n          (segmentGroup.hasChildren() || segments.length > 0)\n        ) {\n          return null;\n        }\n        return { consumed: [], posParams: {} };\n      }\n\n      const parts = path.split('/'); // use function's argument, not the `route.path`\n\n      if (parts.length > segments.length) {\n        // The actual URL is shorter than the config, no match\n        return null;\n      }\n\n      if (\n        route.pathMatch === 'full' &&\n        (segmentGroup.hasChildren() || parts.length < segments.length)\n      ) {\n        // The config is longer than the actual URL but we are looking for a full match, return null\n        return null;\n      }\n\n      const posParams: { [key: string]: UrlSegment } = {};\n\n      // Check each config part against the actual URL\n      for (let index = 0; index < parts.length; index++) {\n        const part = parts[index];\n        const segment = segments[index];\n        const isParameter = part.startsWith(':');\n        if (isParameter) {\n          posParams[part.substring(1)] = segment;\n        } else if (part !== segment.path) {\n          // The actual URL part does not match the config, no match\n          return null;\n        }\n      }\n\n      return { consumed: segments.slice(0, parts.length), posParams };\n    };\n    if (isDevMode()) {\n      matcher['_path'] = path; // property added for easier debugging of routes\n    }\n    return matcher;\n  }\n\n  /**\n   * Returns URL matcher that accepts almost everything (like `**` route), but not paths accepted by the given matcher\n   */\n  getOpposite(originalMatcher: UrlMatcher): UrlMatcher {\n    const matcher = function oppositeUrlMatcher(\n      segments: UrlSegment[],\n      group: UrlSegmentGroup,\n      route: Route\n    ) {\n      return originalMatcher(segments, group, route)\n        ? null\n        : { consumed: segments, posParams: {} };\n    };\n    if (isDevMode()) {\n      matcher['_originalMatcher'] = originalMatcher; // property added for easier debugging of routes\n    }\n    return matcher;\n  }\n\n  /**\n   * Returns URL matcher for the given list of glob-like patterns. Each pattern must start with `/` or `!/`.\n   */\n  getFromGlob(globPatterns: string[]): UrlMatcher {\n    const globValidator = this.globService.getValidator(globPatterns);\n\n    const matcher = function globUrlMatcher(\n      segments: UrlSegment[]\n    ): UrlMatchResult | null {\n      const fullPath = `/${segments.map((s) => s.path).join('/')}`;\n\n      return globValidator(fullPath)\n        ? { consumed: segments, posParams: {} }\n        : null;\n    };\n    if (isDevMode()) {\n      matcher['_globPatterns'] = globPatterns; // property added for easier debugging of routes\n    }\n    return matcher;\n  }\n}\n","import { Injectable, InjectionToken, Injector, isDevMode } from '@angular/core';\nimport { Route, Router, Routes, UrlMatcher } from '@angular/router';\nimport { UrlMatcherService } from '../services/url-matcher.service';\nimport { UrlMatcherFactory } from '../url-matcher/url-matcher-factory';\nimport { RouteConfig } from './routes-config';\nimport { RoutingConfigService } from './routing-config.service';\n\n@Injectable({ providedIn: 'root' })\nexport class ConfigurableRoutesService {\n  constructor(\n    protected injector: Injector,\n    protected routingConfigService: RoutingConfigService,\n    protected urlMatcherService: UrlMatcherService\n  ) {}\n\n  protected initCalled = false; // guard not to call init() more than once\n\n  /**\n   * Enhances existing Angular routes using the routing config of Spartacus.\n   * Can be called only once.\n   */\n  init(): void {\n    if (!this.initCalled) {\n      this.initCalled = true;\n\n      this.configure();\n    }\n  }\n\n  /**\n   * Enhances existing Angular routes using the routing config of Spartacus.\n   */\n  protected configure(): void {\n    // Router could not be injected in constructor due to cyclic dependency with APP_INITIALIZER:\n    const router = this.injector.get(Router);\n    router.resetConfig(this.configureRoutes(router.config));\n  }\n\n  /**\n   * Sets the property `path` or `matcher` for the given routes, based on the Spartacus' routing configuration.\n   *\n   * @param routes list of Angular `Route` objects\n   */\n  protected configureRoutes(routes: Routes): Routes {\n    return routes.map((route) => {\n      const configuredRoute = this.configureRoute(route);\n\n      if (route.children && route.children.length) {\n        configuredRoute.children = this.configureRoutes(route.children);\n      }\n      return configuredRoute;\n    });\n  }\n\n  /**\n   * Sets the property `path` or `matcher` of the `Route`, based on the Spartacus' routing configuration.\n   * Uses the property `data.cxRoute` to determine the name of the route.\n   * It's the same name used as a key in the routing configuration: `routing.routes[ROUTE NAME]`.\n   *\n   * @param route Angular `Route` object\n   */\n  protected configureRoute(route: Route): Route {\n    const routeName = this.getRouteName(route);\n    if (routeName) {\n      const routeConfig = this.routingConfigService.getRouteConfig(routeName);\n      this.validateRouteConfig(routeConfig, routeName, route);\n\n      if (routeConfig?.disabled) {\n        delete route.path;\n        return {\n          ...route,\n          matcher: this.urlMatcherService.getFalsy(),\n        };\n      } else if (routeConfig?.matchers) {\n        delete route.path;\n        return {\n          ...route,\n          matcher: this.resolveUrlMatchers(route, routeConfig?.matchers),\n        };\n      } else if (routeConfig?.paths?.length === 1) {\n        delete route.matcher;\n        return { ...route, path: routeConfig?.paths[0] };\n      } else {\n        delete route.path;\n        return {\n          ...route,\n          matcher: this.urlMatcherService.getFromPaths(\n            routeConfig?.paths || []\n          ),\n        };\n      }\n    }\n    return route; // if route doesn't have a name, just pass the original route\n  }\n\n  /**\n   * Creates a single `UrlMatcher` based on given matchers and factories of matchers.\n   *\n   * @param route Route object\n   * @param matchersOrFactories `UrlMatcher`s or injection tokens with a factory functions\n   *  that create UrlMatchers based on the given route.\n   */\n  protected resolveUrlMatchers(\n    route: Route,\n    matchersOrFactories: RouteConfig['matchers']\n  ): UrlMatcher {\n    const matchers: UrlMatcher[] = matchersOrFactories.map(\n      (matcherOrFactory) => {\n        return typeof matcherOrFactory === 'function'\n          ? matcherOrFactory // matcher\n          : this.resolveUrlMatcherFactory(route, matcherOrFactory); // factory injection token\n      }\n    );\n    return this.urlMatcherService.getCombined(matchers);\n  }\n\n  /**\n   * Creates an `UrlMatcher` based on the given route, using the factory function coming from the given injection token.\n   *\n   * @param route Route object\n   * @param factoryToken injection token with a factory function that will create an UrlMatcher using given route\n   */\n  protected resolveUrlMatcherFactory(\n    route: Route,\n    factoryToken: InjectionToken<UrlMatcherFactory>\n  ): UrlMatcher {\n    const factory = this.injector.get(factoryToken);\n    return factory(route);\n  }\n\n  /**\n   * Returns the name of the Route stored in its property `data.cxRoute`\n   * @param route\n   */\n  protected getRouteName(route: Route): string {\n    return route.data && route.data.cxRoute;\n  }\n\n  protected validateRouteConfig(\n    routeConfig: RouteConfig,\n    routeName: string,\n    route: Route\n  ) {\n    if (isDevMode()) {\n      // - null value of routeConfig or routeConfig.paths means explicit switching off the route - it's valid config\n      // - routeConfig with defined `matchers` is valid, even if `paths` are undefined\n      if (\n        routeConfig === null ||\n        routeConfig?.paths === null ||\n        routeConfig?.matchers\n      ) {\n        return;\n      }\n\n      // undefined value of routeConfig or routeConfig.paths is a misconfiguration\n      if (!routeConfig?.paths) {\n        this.warn(\n          `Could not configure the named route '${routeName}'`,\n          route,\n          `due to undefined config or undefined 'paths' property for this route`\n        );\n        return;\n      }\n    }\n  }\n\n  private warn(...args) {\n    if (isDevMode()) {\n      console.warn(...args);\n    }\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { SemanticPathService } from './semantic-path.service';\nimport { Product } from '../../../model/product.model';\n@Pipe({\n  name: 'cxProductUrl',\n})\nexport class ProductURLPipe implements PipeTransform {\n  constructor(private semanticPath: SemanticPathService) {}\n  transform(product: Product) {\n    return this.semanticPath.transform({ cxRoute: 'product', params: product });\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { SemanticPathService } from './semantic-path.service';\nimport { UrlCommands } from './url-command';\n\n@Pipe({\n  name: 'cxUrl',\n})\nexport class UrlPipe implements PipeTransform {\n  constructor(private urlService: SemanticPathService) {}\n\n  transform(commands: UrlCommands): any[] {\n    return this.urlService.transform(commands);\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { UrlPipe } from './url.pipe';\nimport { ProductURLPipe } from './product-url.pipe';\n\n@NgModule({\n  imports: [CommonModule],\n  declarations: [UrlPipe, ProductURLPipe],\n  exports: [UrlPipe, ProductURLPipe],\n})\nexport class UrlModule {}\n","import { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class ExternalRoutesConfig {\n  routing?: {\n    internal?: string[];\n  };\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport {\n  ActivatedRouteSnapshot,\n  CanActivate,\n  RouterStateSnapshot,\n} from '@angular/router';\nimport { WindowRef } from '../../window/window-ref';\n\n@Injectable({ providedIn: 'root' })\nexport class ExternalRoutesGuard implements CanActivate {\n  constructor(\n    protected winRef: WindowRef,\n    @Inject(PLATFORM_ID) protected platformId: Object\n  ) {}\n\n  /**\n   * Redirects to different storefront system for anticipated URL\n   */\n  canActivate(\n    route: ActivatedRouteSnapshot,\n    state: RouterStateSnapshot\n  ): boolean {\n    if (isPlatformBrowser(this.platformId)) {\n      this.redirect(route, state);\n    }\n    return false;\n  }\n\n  /**\n   * Redirects to anticipated URL using full page reload, not Angular routing\n   */\n  protected redirect(_: ActivatedRouteSnapshot, state: RouterStateSnapshot) {\n    const window = this.winRef.nativeWindow;\n\n    if (window && window.location) {\n      window.location.href = state.url;\n    }\n  }\n}\n","import { ExternalRoutesService } from './external-routes.service';\n\nexport function addExternalRoutesFactory(service: ExternalRoutesService) {\n  const result = () => {\n    service.addRoutes();\n  };\n  return result;\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { Router, Routes, UrlMatcher } from '@angular/router';\nimport { UrlMatcherService } from '../services/url-matcher.service';\nimport { ExternalRoutesConfig } from './external-routes-config';\nimport { ExternalRoutesGuard } from './external-routes.guard';\n\n/**\n * Service that helps redirecting to different storefront systems for configured URLs\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ExternalRoutesService {\n  constructor(\n    protected config: ExternalRoutesConfig,\n    protected urlMatcherService: UrlMatcherService,\n    protected injector: Injector\n  ) {}\n\n  protected get internalUrlPatterns(): ExternalRoutesConfig['routing']['internal'] {\n    return (\n      (this.config && this.config.routing && this.config.routing.internal) || []\n    );\n  }\n\n  /**\n   * Prepends routes (to the Router.config) that are responsible for redirecting to a different storefront system\n   */\n  addRoutes(): void {\n    const router: Router = this.injector.get(Router);\n    const newRoutes = this.getRoutes();\n    if (newRoutes.length) {\n      router.resetConfig([...newRoutes, ...router.config]);\n    }\n  }\n\n  /**\n   * Returns routes that are responsible for redirection to different storefront systems\n   */\n  protected getRoutes(): Routes {\n    if (!this.internalUrlPatterns.length) {\n      return [];\n    }\n    const routes: Routes = [];\n\n    routes.push({\n      pathMatch: 'full',\n      matcher: this.getUrlMatcher(),\n      canActivate: [ExternalRoutesGuard],\n      component: {} as any,\n    });\n\n    return routes;\n  }\n\n  /**\n   * Returns the URL matcher for the external route\n   */\n  protected getUrlMatcher(): UrlMatcher {\n    const matcher = this.urlMatcherService.getFromGlob(\n      this.internalUrlPatterns\n    );\n    return this.urlMatcherService.getOpposite(matcher); // the external route should be activated only when it's NOT an internal route\n  }\n}\n","import { APP_INITIALIZER, ModuleWithProviders, NgModule } from '@angular/core';\nimport { addExternalRoutesFactory } from './external-routes.providers';\nimport { ExternalRoutesService } from './external-routes.service';\n\n/**\n * Prepends the external route that redirects to a different storefront system for configured URLs\n */\n@NgModule()\nexport class ExternalRoutesModule {\n  static forRoot(): ModuleWithProviders<ExternalRoutesModule> {\n    return {\n      ngModule: ExternalRoutesModule,\n      providers: [\n        {\n          provide: APP_INITIALIZER,\n          multi: true,\n          useFactory: addExternalRoutesFactory,\n          deps: [ExternalRoutesService],\n        },\n      ],\n    };\n  }\n}\n","import { PageType } from '../../model/cms.model';\n\nexport class PageContext {\n  id: string;\n  type?: PageType;\n\n  constructor(id: string, type?: PageType) {\n    this.id = id;\n    this.type = type;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { RoutingConfig } from '../configurable-routes/config/routing-config';\n\n@Injectable({ providedIn: 'root' })\nexport class ProtectedRoutesService {\n  private nonProtectedPaths: string[][] = []; // arrays of paths' segments list\n\n  protected get routingConfig(): RoutingConfig['routing'] {\n    return this.config && this.config.routing;\n  }\n\n  /**\n   * Returns 'protected' property (boolean) from routing config\n   *\n   * @returns boolean\n   */\n  public get shouldProtect(): boolean {\n    return this.routingConfig.protected;\n  }\n\n  constructor(protected config: RoutingConfig) {\n    if (this.shouldProtect) {\n      // pre-process config for performance:\n      this.nonProtectedPaths = this.getNonProtectedPaths().map((path) =>\n        this.getSegments(path)\n      );\n    }\n  }\n\n  /**\n   * Tells if the url is protected\n   */\n  isUrlProtected(urlSegments: string[]): boolean {\n    return (\n      this.shouldProtect &&\n      !this.matchAnyPath(urlSegments, this.nonProtectedPaths)\n    );\n  }\n\n  /**\n   * Tells whether the url matches at least one of the paths\n   */\n  protected matchAnyPath(\n    urlSegments: string[],\n    pathsSegments: string[][]\n  ): boolean {\n    return pathsSegments.some((pathSegments) =>\n      this.matchPath(urlSegments, pathSegments)\n    );\n  }\n\n  /**\n   * Tells whether the url matches the path\n   */\n  protected matchPath(urlSegments: string[], pathSegments: string[]): boolean {\n    if (urlSegments.length !== pathSegments.length) {\n      return false;\n    }\n\n    for (let i = 0; i < pathSegments.length; i++) {\n      const pathSeg = pathSegments[i];\n      const urlSeg = urlSegments[i];\n\n      // compare only static segments:\n      if (!pathSeg.startsWith(':') && pathSeg !== urlSeg) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Returns a list of paths that are not protected\n   */\n  protected getNonProtectedPaths(): string[] {\n    return Object.values(this.routingConfig.routes).reduce(\n      (acc, routeConfig) =>\n        routeConfig.protected === false && // must be explicitly false, ignore undefined\n        routeConfig.paths &&\n        routeConfig.paths.length\n          ? acc.concat(routeConfig.paths)\n          : acc,\n      []\n    );\n  }\n\n  /**\n   * Splits the url by slashes\n   */\n  protected getSegments(url: string): string[] {\n    return (url || '').split('/');\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, UrlTree } from '@angular/router';\nimport { Observable, of } from 'rxjs';\nimport { AuthGuard } from '../../auth/user-auth/guards/auth.guard';\nimport { ProtectedRoutesService } from './protected-routes.service';\n\n@Injectable({ providedIn: 'root' })\nexport class ProtectedRoutesGuard implements CanActivate {\n  constructor(\n    protected service: ProtectedRoutesService,\n    protected authGuard: AuthGuard\n  ) {}\n\n  /**\n   * When the anticipated url is protected, it switches to the AuthGuard. Otherwise emits true.\n   */\n  canActivate(route: ActivatedRouteSnapshot): Observable<boolean | UrlTree> {\n    let urlSegments: string[] = route.url.map((seg) => seg.path);\n\n    // For the root path `/` ActivatedRoute contains an empty array of segments:\n    urlSegments = urlSegments.length ? urlSegments : [''];\n\n    if (this.service.isUrlProtected(urlSegments)) {\n      return this.authGuard.canActivate();\n    }\n    return of(true);\n  }\n}\n","import { Location } from '@angular/common';\nimport { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/user-auth/store/actions/index';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { CmsRoute } from '../../models/cms-route';\nimport { RoutingActions } from '../actions/index';\n\n@Injectable()\nexport class RouterEffects {\n  @Effect({ dispatch: false })\n  navigate$: Observable<any> = this.actions$.pipe(\n    ofType(RoutingActions.ROUTER_GO),\n    map((action: RoutingActions.RouteGoAction) => action.payload),\n    tap(({ path, query: queryParams, extras }) => {\n      this.router.navigate(path, { queryParams, ...extras });\n    })\n  );\n\n  @Effect({ dispatch: false })\n  navigateByUrl$: Observable<any> = this.actions$.pipe(\n    ofType(RoutingActions.ROUTER_GO_BY_URL),\n    map((action: RoutingActions.RouteGoAction) => action.payload),\n    tap((url) => {\n      this.router.navigateByUrl(url);\n    })\n  );\n\n  @Effect({ dispatch: false })\n  clearCmsRoutes$: Observable<Action> = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      AuthActions.LOGOUT,\n      AuthActions.LOGIN\n    ),\n    tap(() => {\n      const filteredConfig = this.router.config.filter(\n        (route: CmsRoute) => !(route.data && route.data.cxCmsRouteContext)\n      );\n      if (filteredConfig.length !== this.router.config.length) {\n        this.router.resetConfig(filteredConfig);\n      }\n    })\n  );\n\n  @Effect({ dispatch: false })\n  navigateBack$: Observable<Action> = this.actions$.pipe(\n    ofType(RoutingActions.ROUTER_BACK),\n    tap(() => this.location.back())\n  );\n\n  @Effect({ dispatch: false })\n  navigateForward$: Observable<Action> = this.actions$.pipe(\n    ofType(RoutingActions.ROUTER_FORWARD),\n    tap(() => this.location.forward())\n  );\n\n  constructor(\n    private actions$: Actions,\n    private router: Router,\n    private location: Location\n  ) {}\n}\n","import { RouterEffects } from './router.effect';\n\nexport const effects: any[] = [RouterEffects];\n\nexport * from './router.effect';\n","import { Injectable, InjectionToken, Provider } from '@angular/core';\nimport { RouterStateSnapshot } from '@angular/router';\nimport * as fromNgrxRouter from '@ngrx/router-store';\nimport { ActionReducerMap } from '@ngrx/store';\nimport { PageType } from '../../../model/cms.model';\nimport { RoutingConfigService } from '../../configurable-routes/routing-config.service';\nimport { CmsActivatedRouteSnapshot } from '../../models/cms-route';\nimport { PageContext } from '../../models/page-context.model';\nimport {\n  ActivatedRouterStateSnapshot,\n  RouterState,\n  State,\n} from '../routing-state';\nimport { CHANGE_NEXT_PAGE_CONTEXT } from '../actions/router.action';\n\nexport const initialState: RouterState = {\n  navigationId: 0,\n  state: {\n    url: '',\n    queryParams: {},\n    params: {},\n    context: {\n      id: '',\n    },\n    cmsRequired: false,\n    semanticRoute: undefined,\n  },\n  nextState: undefined,\n};\n\nexport function getReducers(): ActionReducerMap<State> {\n  return {\n    router: reducer,\n  };\n}\n\nexport function reducer(\n  state: RouterState = initialState,\n  action: any\n): RouterState {\n  switch (action.type) {\n    case fromNgrxRouter.ROUTER_NAVIGATION: {\n      return {\n        ...state,\n        nextState: action.payload.routerState,\n        navigationId: action.payload.event.id,\n      };\n    }\n\n    case fromNgrxRouter.ROUTER_ERROR:\n    case fromNgrxRouter.ROUTER_CANCEL: {\n      return {\n        ...state,\n        nextState: undefined,\n      };\n    }\n\n    case CHANGE_NEXT_PAGE_CONTEXT: {\n      return state.nextState\n        ? {\n            ...state,\n            nextState: { ...state.nextState, context: action.payload },\n          }\n        : state;\n    }\n\n    case fromNgrxRouter.ROUTER_NAVIGATED: {\n      return {\n        state: {\n          ...action.payload.routerState,\n          context:\n            // we want to preserve already resolved context,\n            // in case it was changed while navigating\n            state.nextState?.context ?? action.payload.routerState.context,\n        },\n        navigationId: action.payload.event.id,\n        nextState: undefined,\n      };\n    }\n\n    default: {\n      return state;\n    }\n  }\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  State\n>> = new InjectionToken<ActionReducerMap<State>>('RouterReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\n/* The serializer is there to parse the RouterStateSnapshot,\nand to reduce the amount of properties to be passed to the reducer.\n */\n@Injectable()\nexport class CustomSerializer\n  implements\n    fromNgrxRouter.RouterStateSerializer<ActivatedRouterStateSnapshot> {\n  serialize(routerState: RouterStateSnapshot): ActivatedRouterStateSnapshot {\n    let state: CmsActivatedRouteSnapshot = routerState.root as CmsActivatedRouteSnapshot;\n    let cmsRequired = false;\n    let context: PageContext;\n    let semanticRoute: string;\n    let urlString = '';\n\n    while (state.firstChild) {\n      state = state.firstChild as CmsActivatedRouteSnapshot;\n      urlString +=\n        '/' + state.url.map((urlSegment) => urlSegment.path).join('/');\n\n      // we use semantic route information embedded from any parent route\n      if (state.data?.cxRoute) {\n        semanticRoute = state.data?.cxRoute;\n      }\n\n      // we use context information embedded in Cms driven routes from any parent route\n      if (state.data && state.data.cxCmsRouteContext) {\n        context = state.data.cxCmsRouteContext;\n      }\n\n      // we assume, that any route that has CmsPageGuard or it's child\n      // is cmsRequired\n      if (\n        !cmsRequired &&\n        (context ||\n          (state.routeConfig &&\n            state.routeConfig.canActivate &&\n            state.routeConfig.canActivate.find(\n              (x) => x && x.guardName === 'CmsPageGuard'\n            )))\n      ) {\n        cmsRequired = true;\n      }\n    }\n\n    // If `semanticRoute` couldn't be already recognized using `data.cxRoute` property\n    // let's lookup the routing configuration to find the semantic route that has exactly the same configured path as the current URL.\n    // This will work only for simple URLs without any dynamic routing parameters.\n    semanticRoute = semanticRoute || this.lookupSemanticRoute(urlString);\n\n    const { params } = state;\n    // we give smartedit preview page a PageContext\n    if (state.url.length > 0 && state.url[0].path === 'cx-preview') {\n      context = {\n        id: 'smartedit-preview',\n        type: PageType.CONTENT_PAGE,\n      };\n    } else {\n      if (params['productCode']) {\n        context = { id: params['productCode'], type: PageType.PRODUCT_PAGE };\n      } else if (params['categoryCode']) {\n        context = { id: params['categoryCode'], type: PageType.CATEGORY_PAGE };\n      } else if (params['brandCode']) {\n        context = { id: params['brandCode'], type: PageType.CATEGORY_PAGE };\n      } else if (state.data.pageLabel !== undefined) {\n        context = { id: state.data.pageLabel, type: PageType.CONTENT_PAGE };\n      } else if (!context) {\n        if (state.url.length > 0) {\n          const pageLabel =\n            '/' + state.url.map((urlSegment) => urlSegment.path).join('/');\n          context = {\n            id: pageLabel,\n            type: PageType.CONTENT_PAGE,\n          };\n        } else {\n          context = {\n            id: 'homepage',\n            type: PageType.CONTENT_PAGE,\n          };\n        }\n      }\n    }\n\n    return {\n      url: routerState.url,\n      queryParams: routerState.root.queryParams,\n      params,\n      context,\n      cmsRequired,\n      semanticRoute,\n    };\n  }\n\n  /**\n   * Returns the semantic route name for given page label.\n   *\n   * *NOTE*: It works only for simple static urls that are equal to the page label\n   * of cms-driven content page. For example: `/my-account/address-book`.\n   *\n   * It doesn't work for URLs with dynamic parameters. But such case can be handled\n   * by reading the defined `data.cxRoute` from the Angular Routes.\n   *\n   * @param path path to be found in the routing config\n   */\n  private lookupSemanticRoute(path: string): string {\n    // Page label is assumed to start with `/`, but Spartacus configured paths\n    // don't start with slash. So we remove the leading slash:\n    return this.routingConfig.getRouteName(path.substr(1));\n  }\n\n  constructor(private routingConfig: RoutingConfigService) {}\n}\n","import { APP_INITIALIZER, ModuleWithProviders, NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport {\n  RouterState,\n  RouterStateSerializer,\n  StoreRouterConnectingModule,\n} from '@ngrx/router-store';\nimport { StoreModule } from '@ngrx/store';\nimport { ConfigurableRoutesService } from './configurable-routes/configurable-routes.service';\nimport { effects } from './store/effects/index';\nimport {\n  CustomSerializer,\n  reducerProvider,\n  reducerToken,\n} from './store/reducers/router.reducer';\nimport { ROUTING_FEATURE } from './store/routing-state';\n\nexport function initConfigurableRoutes(\n  service: ConfigurableRoutesService\n): () => void {\n  const result = () => service.init(); // workaround for AOT compilation (see https://stackoverflow.com/a/51977115)\n  return result;\n}\n\n@NgModule({\n  imports: [\n    StoreModule.forFeature(ROUTING_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n    StoreRouterConnectingModule.forRoot({\n      routerState: RouterState.Minimal,\n      stateKey: ROUTING_FEATURE, // name of reducer key\n    }),\n  ],\n})\nexport class RoutingModule {\n  static forRoot(): ModuleWithProviders<RoutingModule> {\n    return {\n      ngModule: RoutingModule,\n      providers: [\n        reducerProvider,\n        {\n          provide: RouterStateSerializer,\n          useClass: CustomSerializer,\n        },\n        {\n          provide: APP_INITIALIZER,\n          useFactory: initConfigurableRoutes,\n          deps: [ConfigurableRoutesService],\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import { inject, InjectionToken } from '@angular/core';\nimport { Route } from '@angular/router';\nimport { RoutingConfigService } from '../configurable-routes';\nimport { UrlMatcherService } from '../services/url-matcher.service';\nimport { UrlMatcherFactory } from './url-matcher-factory';\n\nexport function getDefaultUrlMatcherFactory(\n  routingConfigService: RoutingConfigService,\n  urlMatcherService: UrlMatcherService\n): UrlMatcherFactory {\n  const factory = (route: Route) => {\n    const routeName = route.data && route.data['cxRoute'];\n    const routeConfig = routingConfigService.getRouteConfig(routeName);\n    const paths = (routeConfig && routeConfig.paths) || [];\n    return urlMatcherService.getFromPaths(paths);\n  };\n  return factory;\n}\n\n/**\n * Injection token with url matcher factory for spartacus routes containing property `data.cxRoute`.\n * The provided url matcher matches the configured `paths` from routing config.\n *\n * If this matcher doesn't fit the requirements, it can be replaced with custom matcher\n * or additional matchers can be added for a specific route. See for example PRODUCT_DETAILS_URL_MATCHER.\n *\n * Note: Matchers will \"match\" a route, but do not contribute to the creation of the route, nor do they guard routes.\n */\nexport const DEFAULT_URL_MATCHER = new InjectionToken<UrlMatcherFactory>(\n  'DEFAULT_URL_MATCHER',\n  {\n    providedIn: 'root',\n    factory: () =>\n      getDefaultUrlMatcherFactory(\n        inject(RoutingConfigService),\n        inject(UrlMatcherService)\n      ),\n  }\n);\n","import {\n  HttpErrorResponse,\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, switchMap, take } from 'rxjs/operators';\nimport { MultiCartService } from '../../cart/facade/multi-cart.service';\nimport { RouterState, RoutingService } from '../../routing/index';\n\n/**\n * Interceptor that handles \"Cart not found\" errors while a user is in a checkout step.\n *\n * When a user doing a checkout has a \"Cart not found\" error, he is redirected to checkout and the cart is reloaded.\n * If a \"Cart not found\" error happens and the user is not on checkout, this interceptor does not perform any actions.\n */\n@Injectable({ providedIn: 'root' })\nexport class CheckoutCartInterceptor implements HttpInterceptor {\n  constructor(\n    protected routingService: RoutingService,\n    protected multiCartService: MultiCartService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return this.routingService.getRouterState().pipe(\n      take(1),\n      switchMap((state: RouterState) => {\n        return next.handle(request).pipe(\n          catchError((response: any) => {\n            if (\n              response instanceof HttpErrorResponse &&\n              this.isUserInCheckoutRoute(state.state?.semanticRoute)\n            ) {\n              if (this.isCartNotFoundError(response)) {\n                this.routingService.go({ cxRoute: 'cart' });\n\n                const cartCode = this.getCartIdFromError(response);\n                if (cartCode) {\n                  this.multiCartService.reloadCart(cartCode);\n                }\n              }\n            }\n            return throwError(response);\n          })\n        );\n      })\n    );\n  }\n\n  /**\n   * Returns true if the parameter semantic route is part of \"checkout\"\n   * Checkout semantic routes:\n   * checkout\n   * checkoutPaymentType\n   * CheckoutShippingAddress\n   * checkoutDeliveryMode\n   * checkoutPaymentDetails\n   * checkoutReviewOrder\n   * checkoutLogin\n   * @param semanticRoute\n   */\n  protected isUserInCheckoutRoute(semanticRoute: string): boolean {\n    return semanticRoute?.toLowerCase().startsWith('checkout');\n  }\n\n  /**\n   * Checks of the error is for a cart not found, i.e. the cart doesn't exist anymore\n   *\n   * @param response\n   */\n  protected isCartNotFoundError(response: HttpErrorResponse): boolean {\n    return (\n      response.status === 400 &&\n      response.error?.errors?.[0]?.type === 'CartError' &&\n      response.error?.errors?.[0]?.reason === 'notFound'\n    );\n  }\n\n  protected getCartIdFromError(response: HttpErrorResponse): string {\n    return response.error?.errors?.[0]?.subject;\n  }\n}\n","import { CmsComponent } from '../../model/cms.model';\nimport { ContentSlotData } from './content-slot-data.model';\n\nexport interface Page {\n  pageId?: string;\n  name?: string;\n  type?: string;\n  title?: string;\n  template?: string;\n  loadTime?: number;\n  slots?: { [key: string]: ContentSlotData };\n  properties?: any;\n  label?: string;\n}\n\n/**\n * Represents the cms structure for pages, slots and components.\n */\nexport interface CmsStructureModel {\n  page?: Page;\n  components?: CmsComponent[];\n}\n\n/**\n * Represents the page meta data that can be used\n * to resolve page data and seo related data.\n */\nexport interface PageMeta {\n  /**\n   * the page title is used for the page title tag which\n   * is visible in the browser navigation as well as in the\n   * Search Engine Result Page\n   */\n  title?: string;\n\n  /**\n   * the page heading is typically used in the UI\n   */\n  heading?: string;\n\n  /**\n   * the page description is used in the Search Engine Result Page\n   */\n  description?: string;\n\n  /**\n   * the robots information drives search engines to index the page and\n   * follow links in the page\n   */\n  robots?: PageRobotsMeta[];\n\n  /**\n   * image that can be added to the og:image metatag\n   */\n  image?: string;\n\n  /**\n   * the list of breadcrumbs that can be rendered in the page UI.\n   */\n  breadcrumbs?: BreadcrumbMeta[];\n}\n\nexport interface BreadcrumbMeta {\n  label: string;\n  link: string;\n}\n\nexport enum PageRobotsMeta {\n  INDEX = 'INDEX',\n  NOINDEX = 'NOINDEX',\n  FOLLOW = 'FOLLOW',\n  NOFOLLOW = 'NOFOLLOW',\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Provider } from '@angular/core';\nimport { CheckoutCartInterceptor } from './checkout-cart.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: CheckoutCartInterceptor,\n    multi: true,\n  },\n];\n","// Email Standard RFC 5322:\nexport const EMAIL_PATTERN = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/; // tslint:disable-line\n\nexport const PASSWORD_PATTERN = /^(?=.*?[A-Z])(?=.*?[0-9])(?=.*?[!@#$%^*()_\\-+{};:.,]).{6,}$/;\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, EMPTY, Observable, Subscription, timer } from 'rxjs';\nimport {\n  auditTime,\n  debounce,\n  distinctUntilChanged,\n  filter,\n  map,\n  shareReplay,\n  switchMap,\n  take,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { UserIdService } from '../../auth/index';\nimport { Cart } from '../../model/cart.model';\nimport { User } from '../../model/misc.model';\nimport { OrderEntry } from '../../model/order.model';\nimport {\n  OCC_CART_ID_CURRENT,\n  OCC_USER_ID_ANONYMOUS,\n  OCC_USER_ID_GUEST,\n} from '../../occ/utils/occ-constants';\nimport { ProcessesLoaderState } from '../../state/utils/processes-loader/processes-loader-state';\nimport { EMAIL_PATTERN } from '../../util/regex-pattern';\nimport { StateWithMultiCart } from '../store/multi-cart-state';\nimport { MultiCartSelectors } from '../store/selectors/index';\nimport { getCartIdByUserId, isTempCartId } from '../utils/utils';\nimport { MultiCartService } from './multi-cart.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ActiveCartService implements OnDestroy {\n  private readonly PREVIOUS_USER_ID_INITIAL_VALUE =\n    'PREVIOUS_USER_ID_INITIAL_VALUE';\n  private previousUserId = this.PREVIOUS_USER_ID_INITIAL_VALUE;\n  private activeCart$: Observable<Cart>;\n  protected subscription = new Subscription();\n\n  private userId = OCC_USER_ID_ANONYMOUS;\n  private cartId;\n  private cartUser: User;\n\n  private activeCartId$ = this.store.pipe(\n    select(MultiCartSelectors.getActiveCartId),\n    filter((cartId) => typeof cartId !== 'undefined'),\n    map((cartId) => {\n      if (!cartId) {\n        return OCC_CART_ID_CURRENT;\n      }\n      return cartId;\n    })\n  );\n  private cartSelector$ = this.activeCartId$.pipe(\n    switchMap((cartId) => this.multiCartService.getCartEntity(cartId))\n  );\n\n  constructor(\n    protected store: Store<StateWithMultiCart>,\n    protected multiCartService: MultiCartService,\n    protected userIdService: UserIdService\n  ) {\n    this.initActiveCart();\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n\n  protected initActiveCart() {\n    this.subscription.add(\n      combineLatest([\n        this.userIdService.getUserId(),\n        this.activeCartId$.pipe(auditTime(0)),\n      ])\n        .pipe(map(([userId]) => userId))\n        .subscribe((userId) => {\n          this.userId = userId;\n          if (this.userId !== OCC_USER_ID_ANONYMOUS) {\n            if (this.isJustLoggedIn(userId)) {\n              this.loadOrMerge(this.cartId);\n            }\n          }\n          this.previousUserId = userId;\n        })\n    );\n\n    this.subscription.add(\n      this.activeCartId$.subscribe((cartId) => {\n        this.cartId = cartId;\n      })\n    );\n\n    this.activeCart$ = this.cartSelector$.pipe(\n      withLatestFrom(this.activeCartId$),\n      map(([cartEntity, activeCartId]: [ProcessesLoaderState<Cart>, string]): {\n        cart: Cart;\n        cartId: string;\n        isStable: boolean;\n        loaded: boolean;\n      } => {\n        return {\n          cart: cartEntity.value,\n          cartId: activeCartId,\n          isStable: !cartEntity.loading && cartEntity.processesCount === 0,\n          loaded:\n            (cartEntity.error || cartEntity.success) && !cartEntity.loading,\n        };\n      }),\n      // we want to emit empty carts even if those are not stable\n      // on merge cart action we want to switch to empty cart so no one would use old cartId which can be already obsolete\n      // so on merge action the resulting stream looks like this: old_cart -> {} -> new_cart\n      filter(({ isStable, cart }) => isStable || this.isEmpty(cart)),\n      tap(({ cart, cartId, loaded, isStable }) => {\n        if (\n          isStable &&\n          this.isEmpty(cart) &&\n          !loaded &&\n          !isTempCartId(cartId)\n        ) {\n          this.load(cartId);\n        }\n      }),\n      map(({ cart }) => (cart ? cart : {})),\n      tap((cart) => {\n        if (cart) {\n          this.cartUser = cart.user;\n        }\n      }),\n      distinctUntilChanged(),\n      shareReplay({ bufferSize: 1, refCount: true })\n    );\n  }\n\n  /**\n   * Returns active cart\n   */\n  getActive(): Observable<Cart> {\n    return this.activeCart$;\n  }\n\n  /**\n   * Returns active cart id\n   */\n  getActiveCartId(): Observable<string> {\n    return this.activeCart$.pipe(\n      map((cart) => getCartIdByUserId(cart, this.userId)),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Returns cart entries\n   */\n  getEntries(): Observable<OrderEntry[]> {\n    return this.activeCartId$.pipe(\n      switchMap((cartId) => this.multiCartService.getEntries(cartId)),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Returns last cart entry for provided product code.\n   * Needed to cover processes where multiple entries can share the same product code\n   * (e.g. promotions or configurable products)\n   *\n   * @param productCode\n   */\n  getLastEntry(productCode: string): Observable<OrderEntry> {\n    return this.activeCartId$.pipe(\n      switchMap((cartId) =>\n        this.multiCartService.getLastEntry(cartId, productCode)\n      ),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Returns cart loading state\n   */\n  getLoading(): Observable<boolean> {\n    return this.cartSelector$.pipe(\n      map((cartEntity) => cartEntity.loading),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Returns true when cart is stable (not loading and not pending processes on cart)\n   */\n  isStable(): Observable<boolean> {\n    // Debounce is used here, to avoid flickering when we switch between different cart entities.\n    // For example during `addEntry` method. We might try to load current cart, so `current cart will be then active id.\n    // After load fails we might create new cart so we switch to `temp-${uuid}` cart entity used when creating cart.\n    // At the end we finally switch to cart `code` for cart id. Between those switches cart `isStable` function should not flicker.\n    return this.activeCartId$.pipe(\n      switchMap((cartId) => this.multiCartService.isStable(cartId)),\n      debounce((state) => (state ? timer(0) : EMPTY)),\n      distinctUntilChanged()\n    );\n  }\n\n  private loadOrMerge(cartId: string): void {\n    // for login user, whenever there's an existing cart, we will load the user\n    // current cart and merge it into the existing cart\n    if (!cartId || cartId === OCC_CART_ID_CURRENT) {\n      this.multiCartService.loadCart({\n        userId: this.userId,\n        cartId: OCC_CART_ID_CURRENT,\n        extraData: {\n          active: true,\n        },\n      });\n    } else if (this.isGuestCart()) {\n      this.guestCartMerge(cartId);\n    } else if (\n      this.userId !== this.previousUserId &&\n      this.userId !== OCC_USER_ID_ANONYMOUS &&\n      this.previousUserId !== OCC_USER_ID_ANONYMOUS\n    ) {\n      // This case covers the case when you are logged in and then asm user logs in and you don't want to merge, but only load emulated user cart\n      // Similarly when you are logged in as asm user and you logout and want to resume previous user session\n      this.multiCartService.loadCart({\n        userId: this.userId,\n        cartId,\n        extraData: {\n          active: true,\n        },\n      });\n    } else {\n      this.multiCartService.mergeToCurrentCart({\n        userId: this.userId,\n        cartId,\n        extraData: {\n          active: true,\n        },\n      });\n    }\n  }\n\n  private load(cartId: string): void {\n    if (this.userId !== OCC_USER_ID_ANONYMOUS) {\n      this.multiCartService.loadCart({\n        userId: this.userId,\n        cartId: cartId ? cartId : OCC_CART_ID_CURRENT,\n        extraData: {\n          active: true,\n        },\n      });\n    } else if (cartId && cartId !== OCC_CART_ID_CURRENT) {\n      this.multiCartService.loadCart({\n        userId: this.userId,\n        cartId: cartId,\n        extraData: {\n          active: true,\n        },\n      });\n    }\n  }\n\n  private addEntriesGuestMerge(cartEntries: OrderEntry[]) {\n    const entriesToAdd = cartEntries.map((entry) => ({\n      productCode: entry.product.code,\n      quantity: entry.quantity,\n    }));\n    this.requireLoadedCartForGuestMerge().subscribe((cartState) => {\n      this.multiCartService.addEntries(\n        this.userId,\n        getCartIdByUserId(cartState.value, this.userId),\n        entriesToAdd\n      );\n    });\n  }\n\n  private requireLoadedCartForGuestMerge() {\n    return this.requireLoadedCart(\n      this.cartSelector$.pipe(filter(() => !this.isGuestCart()))\n    );\n  }\n\n  private isCartCreating(cartState) {\n    // cart creating is always represented with loading flags\n    // when all loading flags are false it means that we restored wrong cart id\n    // could happen on context change or reload right in the middle on cart create call\n    return (\n      isTempCartId(this.cartId) &&\n      (cartState.loading || cartState.success || cartState.error)\n    );\n  }\n\n  private requireLoadedCart(\n    customCartSelector$?: Observable<ProcessesLoaderState<Cart>>\n  ): Observable<ProcessesLoaderState<Cart>> {\n    // For guest cart merge we want to filter guest cart in the whole stream\n    // We have to wait with load/create/addEntry after guest cart will be deleted.\n    // That's why you can provide custom selector with this filter applied.\n    const cartSelector$ = customCartSelector$\n      ? customCartSelector$\n      : this.cartSelector$;\n\n    return cartSelector$.pipe(\n      filter((cartState) => !cartState.loading),\n      // Avoid load/create call when there are new cart creating at the moment\n      filter((cartState) => !this.isCartCreating(cartState)),\n      take(1),\n      switchMap((cartState) => {\n        // Try to load the cart, because it might have been created on another device between our login and add entry call\n        if (\n          this.isEmpty(cartState.value) &&\n          this.userId !== OCC_USER_ID_ANONYMOUS\n        ) {\n          this.load(undefined);\n        }\n        return cartSelector$;\n      }),\n      filter((cartState) => !cartState.loading),\n      // create cart can happen to anonymous user if it is not empty or to any other user if it is loaded and empty\n      filter(\n        (cartState) =>\n          this.userId === OCC_USER_ID_ANONYMOUS ||\n          cartState.success ||\n          cartState.error\n      ),\n      take(1),\n      switchMap((cartState) => {\n        if (this.isEmpty(cartState.value)) {\n          this.multiCartService.createCart({\n            userId: this.userId,\n            extraData: {\n              active: true,\n            },\n          });\n        }\n        return cartSelector$;\n      }),\n      filter((cartState) => !cartState.loading),\n      filter((cartState) => cartState.success || cartState.error),\n      // wait for active cart id to point to code/guid to avoid some work on temp cart entity\n      filter((cartState) => !this.isCartCreating(cartState)),\n      filter((cartState) => !this.isEmpty(cartState.value)),\n      take(1)\n    );\n  }\n\n  /**\n   * Add entry to active cart\n   *\n   * @param productCode\n   * @param quantity\n   */\n  addEntry(productCode: string, quantity: number): void {\n    this.requireLoadedCart().subscribe((cartState) => {\n      this.multiCartService.addEntry(\n        this.userId,\n        getCartIdByUserId(cartState.value, this.userId),\n        productCode,\n        quantity\n      );\n    });\n  }\n\n  /**\n   * Remove entry\n   *\n   * @param entry\n   */\n  removeEntry(entry: OrderEntry): void {\n    this.multiCartService.removeEntry(\n      this.userId,\n      this.cartId,\n      entry.entryNumber\n    );\n  }\n\n  /**\n   * Update entry\n   *\n   * @param entryNumber\n   * @param quantity\n   */\n  updateEntry(entryNumber: number, quantity: number): void {\n    this.multiCartService.updateEntry(\n      this.userId,\n      this.cartId,\n      entryNumber,\n      quantity\n    );\n  }\n\n  /**\n   * Returns cart entry\n   *\n   * @param productCode\n   */\n  getEntry(productCode: string): Observable<OrderEntry> {\n    return this.activeCartId$.pipe(\n      switchMap((cartId) =>\n        this.multiCartService.getEntry(cartId, productCode)\n      ),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Assign email to cart\n   *\n   * @param email\n   */\n  addEmail(email: string): void {\n    this.multiCartService.assignEmail(this.cartId, this.userId, email);\n  }\n\n  /**\n   * Get assigned user to cart\n   */\n  getAssignedUser(): Observable<User> {\n    return this.getActive().pipe(map((cart) => cart.user));\n  }\n\n  /**\n   * Returns true for guest cart\n   */\n  isGuestCart(): boolean {\n    return (\n      this.cartUser &&\n      (this.cartUser.name === OCC_USER_ID_GUEST ||\n        this.isEmail(this.cartUser.uid.split('|').slice(1).join('|')))\n    );\n  }\n\n  /**\n   * Add multiple entries to a cart\n   *\n   * @param cartEntries : list of entries to add (OrderEntry[])\n   */\n  addEntries(cartEntries: OrderEntry[]): void {\n    cartEntries.forEach((entry) => {\n      this.addEntry(entry.product.code, entry.quantity);\n    });\n  }\n\n  private isEmail(str: string): boolean {\n    if (str) {\n      return str.match(EMAIL_PATTERN) ? true : false;\n    }\n    return false;\n  }\n\n  // TODO: Remove once backend is updated\n  /**\n   * Temporary method to merge guest cart with user cart because of backend limitation\n   * This is for an edge case\n   */\n  private guestCartMerge(cartId: string): void {\n    let cartEntries: OrderEntry[];\n    this.getEntries()\n      .pipe(take(1))\n      .subscribe((entries) => {\n        cartEntries = entries;\n        this.multiCartService.deleteCart(cartId, OCC_USER_ID_ANONYMOUS);\n        this.addEntriesGuestMerge(cartEntries);\n      });\n  }\n\n  private isEmpty(cart: Cart): boolean {\n    return (\n      !cart || (typeof cart === 'object' && Object.keys(cart).length === 0)\n    );\n  }\n\n  private isJustLoggedIn(userId: string): boolean {\n    return (\n      this.previousUserId !== userId && // *just* logged in\n      this.previousUserId !== this.PREVIOUS_USER_ID_INITIAL_VALUE // not app initialization\n    );\n  }\n}\n","import { Observable } from 'rxjs';\n\nexport abstract class TranslationService {\n  /**\n   * Translates given key with options.\n   * If key is missing, it tries to load the chunk and emits a value when chunk is loaded.\n   * If key is missing after loaded chunk, a fallback value is emitted\n   *\n   * @param key translation key\n   * @param options values for interpolation in translation\n   * @param whitespaceUntilLoaded if true, immediately emits a non-breaking space\n   */\n  translate: (\n    key: string,\n    options?: any,\n    whitespaceUntilLoaded?: boolean\n  ) => Observable<string>;\n\n  /**\n   * Loads chunks with translations\n   *\n   * @param chunkNames array of chunk names to be loaded\n   */\n  loadChunks: (chunkNames: string | string[]) => Promise<any>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport { ActiveCartService } from '../../cart/facade/active-cart.service';\nimport { PageRobotsMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageRobotsResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\n\n/**\n * Resolves the page data for all Content Pages based on the `PageType.CONTENT_PAGE`\n * and the `MultiStepCheckoutSummaryPageTemplate`. If the checkout page matches this template,\n * the more generic `ContentPageMetaResolver` is overriden by this resolver.\n *\n * The page title and robots are resolved in this implementation only.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutPageMetaResolver\n  extends PageMetaResolver\n  implements PageTitleResolver, PageRobotsResolver {\n  protected cart$ = this.activeCartService.getActive();\n\n  constructor(\n    protected translation: TranslationService,\n    protected activeCartService: ActiveCartService\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'MultiStepCheckoutSummaryPageTemplate';\n  }\n\n  resolveTitle(): Observable<string> {\n    return this.cart$.pipe(\n      switchMap((c) =>\n        this.translation.translate('pageMetaResolver.checkout.title', {\n          count: c.totalItems,\n        })\n      )\n    );\n  }\n\n  resolveRobots(): Observable<PageRobotsMeta[]> {\n    return of([PageRobotsMeta.NOFOLLOW, PageRobotsMeta.NOINDEX]);\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\nexport abstract class UserAddressAdapter {\n  abstract loadAll(userId: string): Observable<Address[]>;\n\n  abstract add(userId: string, address: Address): Observable<{}>;\n\n  abstract update(\n    userId: string,\n    addressId: string,\n    address: Address\n  ): Observable<{}>;\n\n  abstract verify(\n    userId: string,\n    address: Address\n  ): Observable<AddressValidation>;\n\n  abstract delete(userId: string, addressId: string): Observable<{}>;\n}\n","import { Injectable } from '@angular/core';\nimport { UserAddressAdapter } from './user-address.adapter';\nimport { Observable } from 'rxjs';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserAddressConnector {\n  constructor(protected adapter: UserAddressAdapter) {}\n\n  getAll(userId: string): Observable<Address[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  add(userId: string, address: Address): Observable<{}> {\n    return this.adapter.add(userId, address);\n  }\n\n  update(userId: string, addressId: string, address: Address): Observable<{}> {\n    return this.adapter.update(userId, addressId, address);\n  }\n\n  verify(userId: string, address: Address): Observable<AddressValidation> {\n    return this.adapter.verify(userId, address);\n  }\n\n  delete(userId: string, addressId: string): Observable<{}> {\n    return this.adapter.delete(userId, addressId);\n  }\n}\n","import { HttpErrorResponse } from '@angular/common/http';\nimport { isObject } from '../config/utils/deep-merge';\nimport { ErrorModel, HttpErrorModel } from '../model/misc.model';\n\n/**\n * @deprecated since 2.1, use normalizeHttpError instead\n */\nexport const UNKNOWN_ERROR = {\n  error: 'unknown error',\n};\n\nconst circularReplacer = () => {\n  const seen = new WeakSet();\n  return (_key: any, value: any) => {\n    if (typeof value === 'object' && value !== null) {\n      if (seen.has(value)) {\n        return;\n      }\n      seen.add(value);\n    }\n    return value;\n  };\n};\n\n/**\n * @deprecated since 2.1, use normalizeHttpError instead\n */\nexport function makeErrorSerializable(\n  error: HttpErrorResponse | ErrorModel | any\n): HttpErrorModel | Error | any {\n  if (error instanceof Error) {\n    return {\n      message: error.message,\n      type: error.name,\n      reason: error.stack,\n    } as ErrorModel;\n  }\n\n  if (error instanceof HttpErrorResponse) {\n    let serializableError = error.error;\n    if (isObject(error.error)) {\n      serializableError = JSON.stringify(error.error, circularReplacer());\n    }\n\n    return {\n      message: error.message,\n      error: serializableError,\n      status: error.status,\n      statusText: error.statusText,\n      url: error.url,\n    } as HttpErrorModel;\n  }\n\n  return isObject(error) ? UNKNOWN_ERROR : error;\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { UserAddressConnector } from '../../../user/connectors/address/user-address.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CheckoutActions } from '../actions/index';\n\n@Injectable()\nexport class AddressVerificationEffect {\n  @Effect()\n  verifyAddress$: Observable<\n    CheckoutActions.VerifyAddressSuccess | CheckoutActions.VerifyAddressFail\n  > = this.actions$.pipe(\n    ofType<CheckoutActions.VerifyAddress>(CheckoutActions.VERIFY_ADDRESS),\n    map((action) => action.payload),\n    mergeMap((payload) =>\n      this.userAddressConnector.verify(payload.userId, payload.address).pipe(\n        map((data) => new CheckoutActions.VerifyAddressSuccess(data)),\n        catchError((error) =>\n          of(\n            new CheckoutActions.VerifyAddressFail(makeErrorSerializable(error))\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAddressConnector: UserAddressConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CheckoutPaymentConnector } from '../../connectors/payment/checkout-payment.connector';\nimport { CheckoutActions } from '../actions/index';\n\n@Injectable()\nexport class CardTypesEffects {\n  @Effect()\n  loadCardTypes$: Observable<\n    CheckoutActions.LoadCardTypesSuccess | CheckoutActions.LoadCardTypesFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.LOAD_CARD_TYPES),\n    switchMap(() => {\n      return this.checkoutPaymentConnector.getCardTypes().pipe(\n        map((cardTypes) => new CheckoutActions.LoadCardTypesSuccess(cardTypes)),\n        catchError((error) =>\n          of(\n            new CheckoutActions.LoadCardTypesFail(makeErrorSerializable(error))\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private checkoutPaymentConnector: CheckoutPaymentConnector\n  ) {}\n}\n","import { Action } from '@ngrx/store';\n\nexport const LOAD_BILLING_COUNTRIES = '[User] Load Billing Countries';\nexport const LOAD_BILLING_COUNTRIES_FAIL = '[User] Load Billing Countries Fail';\nexport const LOAD_BILLING_COUNTRIES_SUCCESS =\n  '[User] Load Billing Countries Success';\n\nexport class LoadBillingCountries implements Action {\n  readonly type = LOAD_BILLING_COUNTRIES;\n  constructor() {}\n}\n\nexport class LoadBillingCountriesFail implements Action {\n  readonly type = LOAD_BILLING_COUNTRIES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadBillingCountriesSuccess implements Action {\n  readonly type = LOAD_BILLING_COUNTRIES_SUCCESS;\n  constructor(public payload: any) {}\n}\n\nexport type BillingCountriesAction =\n  | LoadBillingCountries\n  | LoadBillingCountriesFail\n  | LoadBillingCountriesSuccess;\n","import { Action } from '@ngrx/store';\nimport { ConsignmentTracking } from '../../../model/index';\n\nexport const LOAD_CONSIGNMENT_TRACKING = '[User] Load Consignment Tracking';\nexport const LOAD_CONSIGNMENT_TRACKING_FAIL =\n  '[User] Load Consignment Tracking Fail';\nexport const LOAD_CONSIGNMENT_TRACKING_SUCCESS =\n  '[User] Load Consignment Tracking Success';\nexport const CLEAR_CONSIGNMENT_TRACKING = '[User] Clear Consignment Tracking';\n\nexport class LoadConsignmentTracking implements Action {\n  readonly type = LOAD_CONSIGNMENT_TRACKING;\n  constructor(\n    public payload: {\n      userId?: string;\n      orderCode: string;\n      consignmentCode: string;\n    }\n  ) {}\n}\n\nexport class LoadConsignmentTrackingFail implements Action {\n  readonly type = LOAD_CONSIGNMENT_TRACKING_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadConsignmentTrackingSuccess implements Action {\n  readonly type = LOAD_CONSIGNMENT_TRACKING_SUCCESS;\n  constructor(public payload: ConsignmentTracking) {}\n}\n\nexport class ClearConsignmentTracking {\n  readonly type = CLEAR_CONSIGNMENT_TRACKING;\n  constructor() {}\n}\n\nexport type ConsignmentTrackingAction =\n  | LoadConsignmentTracking\n  | LoadConsignmentTrackingFail\n  | LoadConsignmentTrackingSuccess\n  | ClearConsignmentTracking;\n","import { Address, Country, Region } from '../../model/address.model';\nimport { PaymentDetails } from '../../model/cart.model';\nimport { ConsentTemplate } from '../../model/consent.model';\nimport { ConsignmentTracking } from '../../model/consignment-tracking.model';\nimport { CustomerCouponSearchResult } from '../../model/customer-coupon.model';\nimport { Title, User } from '../../model/misc.model';\nimport { NotificationPreference } from '../../model/notification-preference.model';\nimport {\n  Order,\n  OrderHistoryList,\n  ReturnRequest,\n  ReturnRequestList,\n} from '../../model/order.model';\nimport { ReplenishmentOrderList } from '../../model/replenishment-order.model';\nimport { CostCenter } from '../../model/org-unit.model';\nimport { ProductInterestSearchResult } from '../../model/product-interest.model';\nimport { ReplenishmentOrder } from '../../model/replenishment-order.model';\nimport { StateUtils } from '../../state/utils/index';\n\nexport const USER_FEATURE = 'user';\nexport const UPDATE_EMAIL_PROCESS_ID = 'updateEmail';\nexport const UPDATE_PASSWORD_PROCESS_ID = 'updatePassword';\nexport const UPDATE_USER_DETAILS_PROCESS_ID = 'updateUserDetails';\nexport const REGISTER_USER_PROCESS_ID = 'registerUser';\nexport const REMOVE_USER_PROCESS_ID = 'removeUser';\nexport const GIVE_CONSENT_PROCESS_ID = 'giveConsent';\nexport const WITHDRAW_CONSENT_PROCESS_ID = 'withdrawConsent';\nexport const UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID =\n  'updateNotificationPreferences';\nexport const ADD_PRODUCT_INTEREST_PROCESS_ID = 'addProductInterests';\nexport const REMOVE_PRODUCT_INTERESTS_PROCESS_ID = 'removeProductInterests';\nexport const CANCEL_ORDER_PROCESS_ID = 'cancelOrder';\nexport const CANCEL_RETURN_PROCESS_ID = 'cancelReturn';\nexport const CANCEL_REPLENISHMENT_ORDER_PROCESS_ID = 'cancelReplenishmentOrder';\n\nexport const USER_CONSENTS = '[User] User Consents';\nexport const USER_PAYMENT_METHODS = '[User] User Payment Methods';\nexport const USER_ORDERS = '[User] User Orders';\nexport const USER_ADDRESSES = '[User] User Addresses';\nexport const USER_RETURN_REQUESTS = '[User] Order Return Requests';\nexport const USER_RETURN_REQUEST_DETAILS = '[User] Return Request Details';\nexport const USER_ORDER_DETAILS = '[User] User Order Details';\nexport const USER_COST_CENTERS = '[User] User Cost Centers';\nexport const USER_REPLENISHMENT_ORDERS = '[User] User Replenishment Orders';\nexport const USER_REPLENISHMENT_ORDER_DETAILS =\n  '[User] User Replenishment Order Details';\nexport const REGIONS = '[User] Regions';\n\nexport const CUSTOMER_COUPONS = '[User] Customer Coupons';\nexport const SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID = 'subscribeCustomerCoupon';\nexport const UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID =\n  'unsubscribeCustomerCoupon';\nexport const CLAIM_CUSTOMER_COUPON_PROCESS_ID = 'claimCustomerCoupon';\nexport const NOTIFICATION_PREFERENCES = '[User] Notification Preferences';\nexport const PRODUCT_INTERESTS = '[User] Product Interests';\n\nexport interface StateWithUser {\n  [USER_FEATURE]: UserState;\n}\n\nexport interface UserState {\n  account: UserDetailsState;\n  addresses: StateUtils.LoaderState<Address[]>;\n  consents: StateUtils.LoaderState<ConsentTemplate[]>;\n  billingCountries: BillingCountriesState;\n  countries: DeliveryCountriesState;\n  payments: StateUtils.LoaderState<PaymentDetails[]>;\n  orders: StateUtils.LoaderState<OrderHistoryList>;\n  order: StateUtils.LoaderState<Order>;\n  replenishmentOrders: StateUtils.LoaderState<ReplenishmentOrderList>;\n  orderReturn: StateUtils.LoaderState<ReturnRequest>;\n  orderReturnList: StateUtils.LoaderState<ReturnRequestList>;\n  titles: TitlesState;\n  regions: StateUtils.LoaderState<RegionsState>;\n  resetPassword: boolean;\n  consignmentTracking: ConsignmentTrackingState;\n  customerCoupons: StateUtils.LoaderState<CustomerCouponSearchResult>;\n  notificationPreferences: StateUtils.LoaderState<NotificationPreference[]>;\n  productInterests: StateUtils.LoaderState<ProductInterestSearchResult>;\n  costCenters: StateUtils.LoaderState<CostCenter[]>;\n  replenishmentOrder: StateUtils.LoaderState<ReplenishmentOrder>;\n}\n\nexport interface RegionsState {\n  entities: Region[];\n  country: string;\n}\n\nexport interface BillingCountryEntities {\n  [key: string]: Country;\n}\n\nexport interface BillingCountriesState {\n  entities: BillingCountryEntities;\n}\n\nexport interface DeliveryCountryEntities {\n  [key: string]: Country;\n}\n\nexport interface DeliveryCountriesState {\n  entities: DeliveryCountryEntities;\n}\n\nexport interface TitleEntities {\n  [key: string]: Title;\n}\n\nexport interface TitlesState {\n  entities: TitleEntities;\n}\n\nexport interface UserDetailsState {\n  details: User;\n}\n\nexport interface ConsignmentTrackingState {\n  tracking?: ConsignmentTracking;\n}\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateUtils } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderErrorSelector,\n  loaderLoadingSelector,\n  loaderSuccessSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { StateWithProcess } from '../process-state';\nimport { getProcessState } from './feature.selector';\n\nexport function getProcessStateFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, LoaderState<T>> {\n  return createSelector(getProcessState(), (entityState) =>\n    StateUtils.entityLoaderStateSelector(entityState, processId)\n  );\n}\n\nexport function getProcessLoadingFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, boolean> {\n  return createSelector(getProcessStateFactory(processId), (loaderState) =>\n    loaderLoadingSelector(loaderState)\n  );\n}\n\nexport function getProcessSuccessFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, boolean> {\n  return createSelector(getProcessStateFactory(processId), (loaderState) =>\n    loaderSuccessSelector(loaderState)\n  );\n}\n\nexport function getProcessErrorFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, boolean> {\n  return createSelector(getProcessStateFactory(processId), (loaderState) =>\n    loaderErrorSelector(loaderState)\n  );\n}\n","import { MemoizedSelector, createFeatureSelector } from '@ngrx/store';\n\nimport { StateWithProcess, PROCESS_FEATURE } from '../process-state';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\n\nexport function getProcessState<T>(): MemoizedSelector<\n  StateWithProcess<T>,\n  EntityLoaderState<T>\n> {\n  return createFeatureSelector<EntityLoaderState<T>>(PROCESS_FEATURE);\n}\n","import {\n  CUSTOMER_COUPONS,\n  SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID,\n  UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID,\n  CLAIM_CUSTOMER_COUPON_PROCESS_ID,\n} from '../user-state';\nimport {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n  LoaderResetAction,\n} from '../../../state/utils/loader/loader.action';\nimport {\n  CustomerCouponSearchResult,\n  CustomerCouponNotification,\n  CustomerCoupon2Customer,\n} from '../../../model/customer-coupon.model';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityLoaderResetAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport { PROCESS_FEATURE } from '../../../process/store';\n\nexport const LOAD_CUSTOMER_COUPONS = '[User] Load Customer Coupons';\nexport const LOAD_CUSTOMER_COUPONS_FAIL = '[User] Load Customer Coupons Fail';\nexport const LOAD_CUSTOMER_COUPONS_SUCCESS =\n  '[User] Load Customer Coupons Success';\nexport const RESET_LOAD_CUSTOMER_COUPONS = '[User] Reset Load Customer Coupons';\n\nexport const SUBSCRIBE_CUSTOMER_COUPON =\n  '[User] Subscribe Customer Notification Coupon';\nexport const SUBSCRIBE_CUSTOMER_COUPON_FAIL =\n  '[User] Subscribe Customer Coupon Notification Fail';\nexport const SUBSCRIBE_CUSTOMER_COUPON_SUCCESS =\n  '[User] Subscribe Customer Coupon Notification Success';\nexport const RESET_SUBSCRIBE_CUSTOMER_COUPON_PROCESS =\n  '[User] Reset Subscribe Customer Coupon Process';\n\nexport const UNSUBSCRIBE_CUSTOMER_COUPON =\n  '[User] Unsubscribe Customer Notification Coupon';\nexport const UNSUBSCRIBE_CUSTOMER_COUPON_FAIL =\n  '[User] Unsubscribe Customer Coupon Notification Fail';\nexport const UNSUBSCRIBE_CUSTOMER_COUPON_SUCCESS =\n  '[User] Unsubscribe Customer Coupon Notification Success';\nexport const RESET_UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS =\n  '[User] Reset Unsubscribe Customer Coupon Process';\n\nexport const CLAIM_CUSTOMER_COUPON = '[User] Claim Customer';\nexport const CLAIM_CUSTOMER_COUPON_FAIL = '[User] Claim Customer Fail';\nexport const CLAIM_CUSTOMER_COUPON_SUCCESS = '[User] Claim Customer Success';\n\nexport class LoadCustomerCoupons extends LoaderLoadAction {\n  readonly type = LOAD_CUSTOMER_COUPONS;\n  constructor(\n    public payload: {\n      userId: string;\n      pageSize: number;\n      currentPage?: number;\n      sort?: string;\n    }\n  ) {\n    super(CUSTOMER_COUPONS);\n  }\n}\n\nexport class LoadCustomerCouponsFail extends LoaderFailAction {\n  readonly type = LOAD_CUSTOMER_COUPONS_FAIL;\n  constructor(public payload: any) {\n    super(CUSTOMER_COUPONS, payload);\n  }\n}\n\nexport class LoadCustomerCouponsSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_CUSTOMER_COUPONS_SUCCESS;\n  constructor(public payload: CustomerCouponSearchResult) {\n    super(CUSTOMER_COUPONS);\n  }\n}\n\nexport class ResetLoadCustomerCoupons extends LoaderResetAction {\n  readonly type = RESET_LOAD_CUSTOMER_COUPONS;\n  constructor() {\n    super(CUSTOMER_COUPONS);\n  }\n}\n\n// Subscribe coupon notification actions\nexport class SubscribeCustomerCoupon extends EntityLoadAction {\n  readonly type = SUBSCRIBE_CUSTOMER_COUPON;\n  constructor(\n    public payload: {\n      userId: string;\n      couponCode: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID);\n  }\n}\n\nexport class SubscribeCustomerCouponFail extends EntityFailAction {\n  readonly type = SUBSCRIBE_CUSTOMER_COUPON_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\nexport class SubscribeCustomerCouponSuccess extends EntitySuccessAction {\n  readonly type = SUBSCRIBE_CUSTOMER_COUPON_SUCCESS;\n  constructor(public payload: CustomerCouponNotification) {\n    super(PROCESS_FEATURE, SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\nexport class ResetSubscribeCustomerCouponProcess extends EntityLoaderResetAction {\n  readonly type = RESET_SUBSCRIBE_CUSTOMER_COUPON_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID);\n  }\n}\n\nexport class UnsubscribeCustomerCoupon extends EntityLoadAction {\n  readonly type = UNSUBSCRIBE_CUSTOMER_COUPON;\n  constructor(\n    public payload: {\n      userId: string;\n      couponCode: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID);\n  }\n}\n\nexport class UnsubscribeCustomerCouponFail extends EntityFailAction {\n  readonly type = UNSUBSCRIBE_CUSTOMER_COUPON_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\nexport class UnsubscribeCustomerCouponSuccess extends EntitySuccessAction {\n  readonly type = UNSUBSCRIBE_CUSTOMER_COUPON_SUCCESS;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\nexport class ResetUnsubscribeCustomerCouponProcess extends EntityLoaderResetAction {\n  readonly type = RESET_UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID);\n  }\n}\n\nexport class ClaimCustomerCoupon extends EntityLoadAction {\n  readonly type = CLAIM_CUSTOMER_COUPON;\n  constructor(\n    public payload: {\n      userId: string;\n      couponCode;\n    }\n  ) {\n    super(PROCESS_FEATURE, CLAIM_CUSTOMER_COUPON_PROCESS_ID);\n  }\n}\n\nexport class ClaimCustomerCouponFail extends EntityFailAction {\n  readonly type = CLAIM_CUSTOMER_COUPON_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, CLAIM_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\nexport class ClaimCustomerCouponSuccess extends EntitySuccessAction {\n  readonly type = CLAIM_CUSTOMER_COUPON_SUCCESS;\n  constructor(public payload: CustomerCoupon2Customer) {\n    super(PROCESS_FEATURE, CLAIM_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\n// action types\nexport type CustomerCouponAction =\n  | LoadCustomerCoupons\n  | LoadCustomerCouponsFail\n  | LoadCustomerCouponsSuccess\n  | ResetLoadCustomerCoupons\n  | SubscribeCustomerCoupon\n  | SubscribeCustomerCouponFail\n  | SubscribeCustomerCouponSuccess\n  | ResetSubscribeCustomerCouponProcess\n  | UnsubscribeCustomerCoupon\n  | UnsubscribeCustomerCouponFail\n  | UnsubscribeCustomerCouponSuccess\n  | ResetUnsubscribeCustomerCouponProcess\n  | ClaimCustomerCoupon\n  | ClaimCustomerCouponFail\n  | ClaimCustomerCouponSuccess;\n","import { Action } from '@ngrx/store';\nimport { Country } from '../../../model/address.model';\n\nexport const LOAD_DELIVERY_COUNTRIES = '[User] Load Delivery Countries';\nexport const LOAD_DELIVERY_COUNTRIES_FAIL =\n  '[User] Load Delivery Countries Fail';\nexport const LOAD_DELIVERY_COUNTRIES_SUCCESS =\n  '[User] Load Delivery Countries Success';\n\nexport class LoadDeliveryCountries implements Action {\n  readonly type = LOAD_DELIVERY_COUNTRIES;\n  constructor() {}\n}\n\nexport class LoadDeliveryCountriesFail implements Action {\n  readonly type = LOAD_DELIVERY_COUNTRIES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadDeliveryCountriesSuccess implements Action {\n  readonly type = LOAD_DELIVERY_COUNTRIES_SUCCESS;\n  constructor(public payload: Country[]) {}\n}\n\nexport type DeliveryCountriesAction =\n  | LoadDeliveryCountries\n  | LoadDeliveryCountriesFail\n  | LoadDeliveryCountriesSuccess;\n","import { Action } from '@ngrx/store';\n\nexport const FORGOT_PASSWORD_EMAIL_REQUEST =\n  '[User] Forgot Password Email Request';\nexport const FORGOT_PASSWORD_EMAIL_REQUEST_SUCCESS =\n  '[User] Forgot Password Email Request Success';\nexport const FORGOT_PASSWORD_EMAIL_REQUEST_FAIL =\n  '[User] Forgot Password Email Request Fail';\n\nexport class ForgotPasswordEmailRequest implements Action {\n  readonly type = FORGOT_PASSWORD_EMAIL_REQUEST;\n  constructor(public payload: string) {}\n}\n\nexport class ForgotPasswordEmailRequestFail implements Action {\n  readonly type = FORGOT_PASSWORD_EMAIL_REQUEST_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class ForgotPasswordEmailRequestSuccess implements Action {\n  readonly type = FORGOT_PASSWORD_EMAIL_REQUEST_SUCCESS;\n}\n\nexport type ForgotPasswordEmailRequestAction =\n  | ForgotPasswordEmailRequest\n  | ForgotPasswordEmailRequestFail\n  | ForgotPasswordEmailRequestSuccess;\n","import { StateUtils } from '../../../state/utils/index';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityLoaderResetAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport {\n  UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID,\n  NOTIFICATION_PREFERENCES,\n} from '../user-state';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\n\nexport const LOAD_NOTIFICATION_PREFERENCES =\n  '[User] Load Notification Preferences';\nexport const LOAD_NOTIFICATION_PREFERENCES_FAIL =\n  '[User] Load Notification Preferences Fail';\nexport const LOAD_NOTIFICATION_PREFERENCES_SUCCESS =\n  '[User] Load Notification Preferences Success';\nexport const UPDATE_NOTIFICATION_PREFERENCES =\n  '[User] Update Notification Preferences';\nexport const UPDATE_NOTIFICATION_PREFERENCES_FAIL =\n  '[User] Update Notification Preferences Fail';\nexport const UPDATE_NOTIFICATION_PREFERENCES_SUCCESS =\n  '[User] Update Notification Preferences Success';\nexport const RESET_NOTIFICATION_PREFERENCES =\n  '[User] Reset Notification Preferences';\nexport const CLEAR_NOTIFICATION_PREFERENCES =\n  '[User] Clear Notification Preferences';\n\nexport class LoadNotificationPreferences extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_NOTIFICATION_PREFERENCES;\n  constructor(public payload: string) {\n    super(NOTIFICATION_PREFERENCES);\n  }\n}\n\nexport class LoadNotificationPreferencesFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_NOTIFICATION_PREFERENCES_FAIL;\n  constructor(public payload: any) {\n    super(NOTIFICATION_PREFERENCES, payload);\n  }\n}\n\nexport class LoadNotificationPreferencesSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_NOTIFICATION_PREFERENCES_SUCCESS;\n  constructor(public payload: NotificationPreference[]) {\n    super(NOTIFICATION_PREFERENCES);\n  }\n}\n\nexport class UpdateNotificationPreferences extends EntityLoadAction {\n  readonly type = UPDATE_NOTIFICATION_PREFERENCES;\n  constructor(\n    public payload: { userId: string; preferences: NotificationPreference[] }\n  ) {\n    super(PROCESS_FEATURE, UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID);\n  }\n}\n\nexport class UpdateNotificationPreferencesFail extends EntityFailAction {\n  readonly type = UPDATE_NOTIFICATION_PREFERENCES_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID, payload);\n  }\n}\n\nexport class UpdateNotificationPreferencesSuccess extends EntitySuccessAction {\n  readonly type = UPDATE_NOTIFICATION_PREFERENCES_SUCCESS;\n  constructor(public payload: NotificationPreference[]) {\n    super(PROCESS_FEATURE, UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID);\n  }\n}\n\nexport class ResetNotificationPreferences extends EntityLoaderResetAction {\n  readonly type = RESET_NOTIFICATION_PREFERENCES;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID);\n  }\n}\n\nexport class ClearNotificationPreferences extends StateUtils.LoaderResetAction {\n  readonly type = CLEAR_NOTIFICATION_PREFERENCES;\n  constructor() {\n    super(NOTIFICATION_PREFERENCES);\n  }\n}\n\nexport type NotificationPreferenceAction =\n  | LoadNotificationPreferences\n  | LoadNotificationPreferencesFail\n  | LoadNotificationPreferencesSuccess\n  | UpdateNotificationPreferences\n  | UpdateNotificationPreferencesFail\n  | UpdateNotificationPreferencesSuccess\n  | ResetNotificationPreferences\n  | ClearNotificationPreferences;\n","import {\n  Order,\n  CancellationRequestEntryInputList,\n} from '../../../model/order.model';\nimport {\n  LoaderFailAction,\n  LoaderLoadAction,\n  LoaderSuccessAction,\n  LoaderResetAction,\n} from '../../../state/utils/loader/loader.action';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateUtils } from '../../../state/utils/index';\nimport { USER_ORDER_DETAILS, CANCEL_ORDER_PROCESS_ID } from '../user-state';\n\nexport const LOAD_ORDER_DETAILS = '[User] Load Order Details';\nexport const LOAD_ORDER_DETAILS_FAIL = '[User] Load Order Details Fail';\nexport const LOAD_ORDER_DETAILS_SUCCESS = '[User] Load Order Details Success';\nexport const CLEAR_ORDER_DETAILS = '[User] Clear Order Details';\n\nexport const CANCEL_ORDER = '[User] Cancel Order';\nexport const CANCEL_ORDER_FAIL = '[User] Cancel Order Fail';\nexport const CANCEL_ORDER_SUCCESS = '[User] Cancel Order Success';\nexport const RESET_CANCEL_ORDER_PROCESS = '[User] Reset Cancel Order Process';\n\nexport class LoadOrderDetails extends LoaderLoadAction {\n  readonly type = LOAD_ORDER_DETAILS;\n  constructor(\n    public payload: {\n      userId: string;\n      orderCode: string;\n    }\n  ) {\n    super(USER_ORDER_DETAILS);\n  }\n}\n\nexport class LoadOrderDetailsFail extends LoaderFailAction {\n  readonly type = LOAD_ORDER_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ORDER_DETAILS, payload);\n  }\n}\n\nexport class LoadOrderDetailsSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_ORDER_DETAILS_SUCCESS;\n  constructor(public payload: Order) {\n    super(USER_ORDER_DETAILS);\n  }\n}\n\nexport class ClearOrderDetails extends LoaderResetAction {\n  readonly type = CLEAR_ORDER_DETAILS;\n  constructor() {\n    super(USER_ORDER_DETAILS);\n  }\n}\n\nexport class CancelOrder extends StateUtils.EntityLoadAction {\n  readonly type = CANCEL_ORDER;\n  constructor(\n    public payload: {\n      userId: string;\n      orderCode: string;\n      cancelRequestInput: CancellationRequestEntryInputList;\n    }\n  ) {\n    super(PROCESS_FEATURE, CANCEL_ORDER_PROCESS_ID);\n  }\n}\n\nexport class CancelOrderFail extends StateUtils.EntityFailAction {\n  readonly type = CANCEL_ORDER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, CANCEL_ORDER_PROCESS_ID, payload);\n  }\n}\n\nexport class CancelOrderSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = CANCEL_ORDER_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, CANCEL_ORDER_PROCESS_ID);\n  }\n}\n\nexport class ResetCancelOrderProcess extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_CANCEL_ORDER_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, CANCEL_ORDER_PROCESS_ID);\n  }\n}\n\nexport type OrderDetailsAction =\n  | LoadOrderDetails\n  | LoadOrderDetailsFail\n  | LoadOrderDetailsSuccess\n  | ClearOrderDetails\n  | CancelOrder\n  | CancelOrderFail\n  | CancelOrderSuccess;\n","import {\n  ReturnRequest,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequestModification,\n} from '../../../model/order.model';\nimport {\n  USER_RETURN_REQUESTS,\n  USER_RETURN_REQUEST_DETAILS,\n  CANCEL_RETURN_PROCESS_ID,\n} from '../user-state';\nimport {\n  LoaderFailAction,\n  LoaderLoadAction,\n  LoaderSuccessAction,\n  LoaderResetAction,\n} from '../../../state/utils/loader/loader.action';\nimport { StateUtils } from '../../../state/utils/index';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\n\nexport const CREATE_ORDER_RETURN_REQUEST = '[User] Create Order Return Request';\nexport const CREATE_ORDER_RETURN_REQUEST_FAIL =\n  '[User] Create Order Return Request Fail';\nexport const CREATE_ORDER_RETURN_REQUEST_SUCCESS =\n  '[User] Create Order Return Request Success';\n\nexport const LOAD_ORDER_RETURN_REQUEST =\n  '[User] Load Order Return Request details';\nexport const LOAD_ORDER_RETURN_REQUEST_FAIL =\n  '[User] Load Order Return Request details Fail';\nexport const LOAD_ORDER_RETURN_REQUEST_SUCCESS =\n  '[User] Load Order Return Request details Success';\n\nexport const CANCEL_ORDER_RETURN_REQUEST = '[User] Cancel Order Return Request';\nexport const CANCEL_ORDER_RETURN_REQUEST_FAIL =\n  '[User] Cancel Order Return Request Fail';\nexport const CANCEL_ORDER_RETURN_REQUEST_SUCCESS =\n  '[User] Cancel Order Return Request Success';\n\nexport const LOAD_ORDER_RETURN_REQUEST_LIST =\n  '[User] Load User Order Return Request List';\nexport const LOAD_ORDER_RETURN_REQUEST_LIST_FAIL =\n  '[User] Load User Order Return Request List Fail';\nexport const LOAD_ORDER_RETURN_REQUEST_LIST_SUCCESS =\n  '[User] Load User Order Return Request List Success';\n\nexport const CLEAR_ORDER_RETURN_REQUEST =\n  '[User] Clear Order Return Request Details';\nexport const CLEAR_ORDER_RETURN_REQUEST_LIST =\n  '[User] Clear Order Return Request List';\nexport const RESET_CANCEL_RETURN_PROCESS =\n  '[User] Reset Cancel Return Request Process';\n\nexport class CreateOrderReturnRequest extends LoaderLoadAction {\n  readonly type = CREATE_ORDER_RETURN_REQUEST;\n  constructor(\n    public payload: {\n      userId: string;\n      returnRequestInput: ReturnRequestEntryInputList;\n    }\n  ) {\n    super(USER_RETURN_REQUEST_DETAILS);\n  }\n}\n\nexport class CreateOrderReturnRequestFail extends LoaderFailAction {\n  readonly type = CREATE_ORDER_RETURN_REQUEST_FAIL;\n  constructor(public payload: any) {\n    super(USER_RETURN_REQUEST_DETAILS, payload);\n  }\n}\n\nexport class CreateOrderReturnRequestSuccess extends LoaderSuccessAction {\n  readonly type = CREATE_ORDER_RETURN_REQUEST_SUCCESS;\n  constructor(public payload: ReturnRequest) {\n    super(USER_RETURN_REQUEST_DETAILS);\n  }\n}\n\nexport class LoadOrderReturnRequest extends LoaderLoadAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST;\n  constructor(\n    public payload: {\n      userId: string;\n      returnRequestCode: string;\n    }\n  ) {\n    super(USER_RETURN_REQUEST_DETAILS);\n  }\n}\n\nexport class LoadOrderReturnRequestFail extends LoaderFailAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST_FAIL;\n  constructor(public payload: any) {\n    super(USER_RETURN_REQUEST_DETAILS, payload);\n  }\n}\n\nexport class LoadOrderReturnRequestSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST_SUCCESS;\n  constructor(public payload: ReturnRequest) {\n    super(USER_RETURN_REQUEST_DETAILS);\n  }\n}\n\nexport class CancelOrderReturnRequest extends StateUtils.EntityLoadAction {\n  readonly type = CANCEL_ORDER_RETURN_REQUEST;\n  constructor(\n    public payload: {\n      userId: string;\n      returnRequestCode: string;\n      returnRequestModification: ReturnRequestModification;\n    }\n  ) {\n    super(PROCESS_FEATURE, CANCEL_RETURN_PROCESS_ID);\n  }\n}\n\nexport class CancelOrderReturnRequestFail extends StateUtils.EntityFailAction {\n  readonly type = CANCEL_ORDER_RETURN_REQUEST_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, CANCEL_RETURN_PROCESS_ID, payload);\n  }\n}\n\nexport class CancelOrderReturnRequestSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = CANCEL_ORDER_RETURN_REQUEST_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, CANCEL_RETURN_PROCESS_ID);\n  }\n}\n\nexport class LoadOrderReturnRequestList extends LoaderLoadAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST_LIST;\n  constructor(\n    public payload: {\n      userId: string;\n      pageSize?: number;\n      currentPage?: number;\n      sort?: string;\n    }\n  ) {\n    super(USER_RETURN_REQUESTS);\n  }\n}\n\nexport class LoadOrderReturnRequestListFail extends LoaderFailAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST_LIST_FAIL;\n  constructor(public payload: any) {\n    super(USER_RETURN_REQUESTS, payload);\n  }\n}\n\nexport class LoadOrderReturnRequestListSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST_LIST_SUCCESS;\n  constructor(public payload: ReturnRequestList) {\n    super(USER_RETURN_REQUESTS);\n  }\n}\n\nexport class ClearOrderReturnRequest extends LoaderResetAction {\n  readonly type = CLEAR_ORDER_RETURN_REQUEST;\n  constructor() {\n    super(USER_RETURN_REQUEST_DETAILS);\n  }\n}\n\nexport class ClearOrderReturnRequestList extends LoaderResetAction {\n  readonly type = CLEAR_ORDER_RETURN_REQUEST_LIST;\n  constructor() {\n    super(USER_RETURN_REQUESTS);\n  }\n}\n\nexport class ResetCancelReturnProcess extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_CANCEL_RETURN_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, CANCEL_RETURN_PROCESS_ID);\n  }\n}\n\nexport type OrderReturnRequestAction =\n  | CreateOrderReturnRequest\n  | CreateOrderReturnRequestFail\n  | CreateOrderReturnRequestSuccess\n  | LoadOrderReturnRequest\n  | LoadOrderReturnRequestFail\n  | LoadOrderReturnRequestSuccess\n  | CancelOrderReturnRequest\n  | CancelOrderReturnRequestFail\n  | CancelOrderReturnRequestSuccess\n  | LoadOrderReturnRequestList\n  | LoadOrderReturnRequestListFail\n  | LoadOrderReturnRequestListSuccess\n  | ClearOrderReturnRequest\n  | ClearOrderReturnRequestList\n  | ResetCancelReturnProcess;\n","import { PaymentDetails } from '../../../model/cart.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { USER_PAYMENT_METHODS } from '../user-state';\n\nexport const LOAD_USER_PAYMENT_METHODS = '[User] Load User Payment Methods';\nexport const LOAD_USER_PAYMENT_METHODS_FAIL =\n  '[User] Load User Payment Methods Fail';\nexport const LOAD_USER_PAYMENT_METHODS_SUCCESS =\n  '[User] Load User Payment Methods Success';\n\nexport const SET_DEFAULT_USER_PAYMENT_METHOD =\n  '[User] Set Default User Payment Method';\nexport const SET_DEFAULT_USER_PAYMENT_METHOD_FAIL =\n  '[User] Set Default User Payment Method Fail';\nexport const SET_DEFAULT_USER_PAYMENT_METHOD_SUCCESS =\n  '[User] Set Default User Payment Method Success';\n\nexport const DELETE_USER_PAYMENT_METHOD = '[User] Delete User Payment Method';\nexport const DELETE_USER_PAYMENT_METHOD_FAIL =\n  '[User] Delete User Payment Method Fail';\nexport const DELETE_USER_PAYMENT_METHOD_SUCCESS =\n  '[User] Delete User  Payment Method Success';\n\nexport class LoadUserPaymentMethods extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_USER_PAYMENT_METHODS;\n  constructor(public payload: string) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class LoadUserPaymentMethodsFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_USER_PAYMENT_METHODS_FAIL;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS, payload);\n  }\n}\n\nexport class LoadUserPaymentMethodsSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_USER_PAYMENT_METHODS_SUCCESS;\n  constructor(public payload: PaymentDetails[]) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class SetDefaultUserPaymentMethod extends StateUtils.LoaderLoadAction {\n  readonly type = SET_DEFAULT_USER_PAYMENT_METHOD;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class SetDefaultUserPaymentMethodFail extends StateUtils.LoaderFailAction {\n  readonly type = SET_DEFAULT_USER_PAYMENT_METHOD_FAIL;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS, payload);\n  }\n}\n\nexport class SetDefaultUserPaymentMethodSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = SET_DEFAULT_USER_PAYMENT_METHOD_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class DeleteUserPaymentMethod extends StateUtils.LoaderLoadAction {\n  readonly type = DELETE_USER_PAYMENT_METHOD;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class DeleteUserPaymentMethodFail extends StateUtils.LoaderFailAction {\n  readonly type = DELETE_USER_PAYMENT_METHOD_FAIL;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS, payload);\n  }\n}\n\nexport class DeleteUserPaymentMethodSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = DELETE_USER_PAYMENT_METHOD_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\n// action types\nexport type UserPaymentMethodsAction =\n  | LoadUserPaymentMethods\n  | LoadUserPaymentMethodsFail\n  | LoadUserPaymentMethodsSuccess\n  | SetDefaultUserPaymentMethod\n  | SetDefaultUserPaymentMethodFail\n  | SetDefaultUserPaymentMethodSuccess\n  | DeleteUserPaymentMethod\n  | DeleteUserPaymentMethodFail\n  | DeleteUserPaymentMethodSuccess;\n","import {\n  PRODUCT_INTERESTS,\n  REMOVE_PRODUCT_INTERESTS_PROCESS_ID,\n  ADD_PRODUCT_INTEREST_PROCESS_ID,\n} from '../user-state';\nimport {\n  ProductInterestSearchResult,\n  ProductInterestEntryRelation,\n  NotificationType,\n} from '../../../model/product-interest.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n  LoaderResetAction,\n} from '../../../state/utils/loader/loader.action';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntitySuccessAction,\n  EntityLoaderResetAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\n\nexport const LOAD_PRODUCT_INTERESTS = 'Load Product Interests';\nexport const LOAD_PRODUCT_INTERESTS_FAIL = 'Load Product Interests Fail';\nexport const LOAD_PRODUCT_INTERESTS_SUCCESS = 'Load Product Interests Success';\n\nexport const REMOVE_PRODUCT_INTEREST = 'Remove Product Interest';\nexport const REMOVE_PRODUCT_INTEREST_SUCCESS =\n  'Remove Product Interest Success';\nexport const REMOVE_PRODUCT_INTEREST_FAIL = 'Remove Product Interest Fail';\n\nexport const ADD_PRODUCT_INTEREST = 'Add Product Interest';\nexport const ADD_PRODUCT_INTEREST_FAIL = 'Add Product Interest Fail';\nexport const ADD_PRODUCT_INTEREST_SUCCESS = 'Add Product Interest Success';\n\nexport const ADD_PRODUCT_INTEREST_RESET = 'Add Product Interest Reset';\nexport const REMOVE_PRODUCT_INTEREST_RESET = 'Remove Product Interest Reset';\n\nexport const CLEAR_PRODUCT_INTERESTS = 'Clear Product Interests';\n\nexport class LoadProductInterests extends LoaderLoadAction {\n  readonly type = LOAD_PRODUCT_INTERESTS;\n  constructor(\n    public payload: {\n      userId: string;\n      pageSize?: number;\n      currentPage?: number;\n      sort?: string;\n      productCode?: string;\n      notificationType?: NotificationType;\n    }\n  ) {\n    super(PRODUCT_INTERESTS);\n  }\n}\n\nexport class LoadProductInterestsFail extends LoaderFailAction {\n  readonly type = LOAD_PRODUCT_INTERESTS_FAIL;\n  constructor(public payload: any) {\n    super(PRODUCT_INTERESTS, payload);\n  }\n}\n\nexport class LoadProductInterestsSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_PRODUCT_INTERESTS_SUCCESS;\n  constructor(public payload: ProductInterestSearchResult) {\n    super(PRODUCT_INTERESTS);\n  }\n}\n\nexport class RemoveProductInterest extends EntityLoadAction {\n  readonly type = REMOVE_PRODUCT_INTEREST;\n  constructor(\n    public payload: {\n      userId: string;\n      item: ProductInterestEntryRelation;\n      singleDelete?: boolean;\n    }\n  ) {\n    super(PROCESS_FEATURE, REMOVE_PRODUCT_INTERESTS_PROCESS_ID);\n  }\n}\n\nexport class RemoveProductInterestSuccess extends EntitySuccessAction {\n  readonly type = REMOVE_PRODUCT_INTEREST_SUCCESS;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, REMOVE_PRODUCT_INTERESTS_PROCESS_ID);\n  }\n}\n\nexport class RemoveProductInterestFail extends EntityFailAction {\n  readonly type = REMOVE_PRODUCT_INTEREST_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, REMOVE_PRODUCT_INTERESTS_PROCESS_ID, payload);\n  }\n}\n\nexport class AddProductInterest extends EntityLoadAction {\n  readonly type = ADD_PRODUCT_INTEREST;\n  constructor(\n    public payload: {\n      userId: string;\n      productCode: string;\n      notificationType: NotificationType;\n    }\n  ) {\n    super(PROCESS_FEATURE, ADD_PRODUCT_INTEREST_PROCESS_ID);\n  }\n}\n\nexport class AddProductInterestSuccess extends EntitySuccessAction {\n  readonly type = ADD_PRODUCT_INTEREST_SUCCESS;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, ADD_PRODUCT_INTEREST_PROCESS_ID);\n  }\n}\n\nexport class AddProductInterestFail extends EntityFailAction {\n  readonly type = ADD_PRODUCT_INTEREST_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, ADD_PRODUCT_INTEREST_PROCESS_ID, payload);\n  }\n}\n\nexport class ResetAddInterestState extends EntityLoaderResetAction {\n  readonly type = ADD_PRODUCT_INTEREST_RESET;\n  constructor() {\n    super(PROCESS_FEATURE, ADD_PRODUCT_INTEREST_PROCESS_ID);\n  }\n}\n\nexport class ResetRemoveInterestState extends EntityLoaderResetAction {\n  readonly type = REMOVE_PRODUCT_INTEREST_RESET;\n  constructor() {\n    super(PROCESS_FEATURE, REMOVE_PRODUCT_INTERESTS_PROCESS_ID);\n  }\n}\n\nexport class ClearProductInterests extends LoaderResetAction {\n  readonly type = CLEAR_PRODUCT_INTERESTS;\n  constructor() {\n    super(PRODUCT_INTERESTS);\n  }\n}\n\nexport type ProductInterestsAction =\n  | LoadProductInterests\n  | LoadProductInterestsFail\n  | LoadProductInterestsSuccess\n  | RemoveProductInterest\n  | RemoveProductInterestSuccess\n  | RemoveProductInterestFail\n  | AddProductInterest\n  | AddProductInterestFail\n  | AddProductInterestSuccess\n  | ResetAddInterestState\n  | ResetRemoveInterestState\n  | ClearProductInterests;\n","import { Action } from '@ngrx/store';\nimport { Region } from '../../../model/address.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { REGIONS } from '../user-state';\n\nexport const LOAD_REGIONS = '[User] Load Regions';\nexport const LOAD_REGIONS_SUCCESS = '[User] Load Regions Success';\nexport const LOAD_REGIONS_FAIL = '[User] Load Regions Fail';\nexport const CLEAR_REGIONS = '[User] Clear Regions';\n\nexport class LoadRegions extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_REGIONS;\n  constructor(public payload: string) {\n    super(REGIONS);\n  }\n}\n\nexport class LoadRegionsFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_REGIONS_FAIL;\n  constructor(public payload: any) {\n    super(REGIONS, payload);\n  }\n}\n\nexport class LoadRegionsSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_REGIONS_SUCCESS;\n  constructor(public payload: { entities: Region[]; country: string }) {\n    super(REGIONS);\n  }\n}\n\nexport class ClearRegions implements Action {\n  readonly type = CLEAR_REGIONS;\n  constructor() {}\n}\n\nexport type RegionsAction =\n  | LoadRegions\n  | LoadRegionsFail\n  | LoadRegionsSuccess\n  | ClearRegions;\n","import { ReplenishmentOrder } from '../../../model/replenishment-order.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateUtils } from '../../../state/utils/index';\nimport {\n  CANCEL_REPLENISHMENT_ORDER_PROCESS_ID,\n  USER_REPLENISHMENT_ORDER_DETAILS,\n} from '../user-state';\n\nexport const LOAD_REPLENISHMENT_ORDER_DETAILS =\n  '[User] Load Replenishment Order Details';\nexport const LOAD_REPLENISHMENT_ORDER_DETAILS_SUCCESS =\n  '[User] Load Replenishment Order Details Success';\nexport const LOAD_REPLENISHMENT_ORDER_DETAILS_FAIL =\n  '[User] Load Replenishment Order Details Fail';\nexport const ClEAR_REPLENISHMENT_ORDER_DETAILS =\n  '[User] Clear Replenishment Order Details';\n\nexport const CANCEL_REPLENISHMENT_ORDER = '[User] Cancel Replenishment Order';\nexport const CANCEL_REPLENISHMENT_ORDER_SUCCESS =\n  '[User] Cancel Replenishment Order Success';\nexport const CANCEL_REPLENISHMENT_ORDER_FAIL =\n  '[User] Cancel Replenishment Order Fail';\nexport const CLEAR_CANCEL_REPLENISHMENT_ORDER =\n  '[User] Clear Cancel Replenishment Order';\n\nexport class LoadReplenishmentOrderDetails extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_REPLENISHMENT_ORDER_DETAILS;\n  constructor(\n    public payload: {\n      userId: string;\n      replenishmentOrderCode: string;\n    }\n  ) {\n    super(USER_REPLENISHMENT_ORDER_DETAILS);\n  }\n}\n\nexport class LoadReplenishmentOrderDetailsSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_REPLENISHMENT_ORDER_DETAILS_SUCCESS;\n  constructor(public payload: ReplenishmentOrder) {\n    super(USER_REPLENISHMENT_ORDER_DETAILS);\n  }\n}\n\nexport class LoadReplenishmentOrderDetailsFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_REPLENISHMENT_ORDER_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(USER_REPLENISHMENT_ORDER_DETAILS, payload);\n  }\n}\n\nexport class ClearReplenishmentOrderDetails extends StateUtils.LoaderResetAction {\n  readonly type = ClEAR_REPLENISHMENT_ORDER_DETAILS;\n  constructor() {\n    super(USER_REPLENISHMENT_ORDER_DETAILS);\n  }\n}\n\nexport class CancelReplenishmentOrder extends StateUtils.EntityLoadAction {\n  readonly type = CANCEL_REPLENISHMENT_ORDER;\n  constructor(\n    public payload: {\n      userId: string;\n      replenishmentOrderCode: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, CANCEL_REPLENISHMENT_ORDER_PROCESS_ID);\n  }\n}\n\nexport class CancelReplenishmentOrderSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = CANCEL_REPLENISHMENT_ORDER_SUCCESS;\n  constructor(public payload: ReplenishmentOrder) {\n    super(PROCESS_FEATURE, CANCEL_REPLENISHMENT_ORDER_PROCESS_ID);\n  }\n}\n\nexport class CancelReplenishmentOrderFail extends StateUtils.EntityFailAction {\n  readonly type = CANCEL_REPLENISHMENT_ORDER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, CANCEL_REPLENISHMENT_ORDER_PROCESS_ID, payload);\n  }\n}\n\nexport class ClearCancelReplenishmentOrder extends StateUtils.EntityLoaderResetAction {\n  readonly type = CLEAR_CANCEL_REPLENISHMENT_ORDER;\n  constructor() {\n    super(PROCESS_FEATURE, CANCEL_REPLENISHMENT_ORDER_PROCESS_ID);\n  }\n}\n\nexport type ReplenishmentOrderDetailsAction =\n  | LoadReplenishmentOrderDetails\n  | LoadReplenishmentOrderDetailsSuccess\n  | LoadReplenishmentOrderDetailsFail\n  | ClearReplenishmentOrderDetails\n  | CancelReplenishmentOrder\n  | CancelReplenishmentOrderSuccess\n  | CancelReplenishmentOrderFail\n  | ClearCancelReplenishmentOrder;\n","import { Action } from '@ngrx/store';\n\nexport const RESET_PASSWORD = '[User] Reset Password';\nexport const RESET_PASSWORD_SUCCESS = '[User] Reset Password Success';\nexport const RESET_PASSWORD_FAIL = '[User] Reset Password Fail';\n\nexport class ResetPassword implements Action {\n  readonly type = RESET_PASSWORD;\n  constructor(public payload: { token: string; password: string }) {}\n}\n\nexport class ResetPasswordFail implements Action {\n  readonly type = RESET_PASSWORD_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class ResetPasswordSuccess implements Action {\n  readonly type = RESET_PASSWORD_SUCCESS;\n}\n\nexport type ResetPasswordAction =\n  | ResetPassword\n  | ResetPasswordFail\n  | ResetPasswordSuccess;\n","import { Action } from '@ngrx/store';\nimport { Title } from '../../../model/misc.model';\n\nexport const LOAD_TITLES = '[User] Load Tiltes';\nexport const LOAD_TITLES_FAIL = '[User] Load Titles Fail';\nexport const LOAD_TITLES_SUCCESS = '[User] Load Titles Success';\n\nexport class LoadTitles implements Action {\n  readonly type = LOAD_TITLES;\n  constructor() {}\n}\n\nexport class LoadTitlesFail implements Action {\n  readonly type = LOAD_TITLES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadTitlesSuccess implements Action {\n  readonly type = LOAD_TITLES_SUCCESS;\n  constructor(public payload: Title[]) {}\n}\n\nexport type TitlesAction = LoadTitles | LoadTitlesFail | LoadTitlesSuccess;\n","import { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateUtils } from '../../../state/utils/index';\nimport { UPDATE_EMAIL_PROCESS_ID } from '../user-state';\n\nexport const UPDATE_EMAIL = '[User] Update Email';\nexport const UPDATE_EMAIL_ERROR = '[User] Update Email Error';\nexport const UPDATE_EMAIL_SUCCESS = '[User] Update Email Success';\nexport const RESET_EMAIL = '[User] Reset Email';\n\nexport class UpdateEmailAction extends StateUtils.EntityLoadAction {\n  readonly type = UPDATE_EMAIL;\n  constructor(\n    public payload: {\n      uid: string;\n      password: string;\n      newUid: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID);\n  }\n}\n\nexport class UpdateEmailSuccessAction extends StateUtils.EntitySuccessAction {\n  readonly type = UPDATE_EMAIL_SUCCESS;\n  constructor(public newUid: string) {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID);\n  }\n}\n\nexport class UpdateEmailErrorAction extends StateUtils.EntityFailAction {\n  readonly type = UPDATE_EMAIL_ERROR;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID, payload);\n  }\n}\n\nexport class ResetUpdateEmailAction extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_EMAIL;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID);\n  }\n}\n\nexport type EmailActions =\n  | UpdateEmailAction\n  | UpdateEmailSuccessAction\n  | UpdateEmailErrorAction\n  | ResetUpdateEmailAction;\n","import { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateUtils } from '../../../state/utils/index';\nimport { UPDATE_PASSWORD_PROCESS_ID } from '../user-state';\n\nexport const UPDATE_PASSWORD = '[User] Update Password';\nexport const UPDATE_PASSWORD_FAIL = '[User] Update Password Fail';\nexport const UPDATE_PASSWORD_SUCCESS = '[User] Update Password Success';\nexport const UPDATE_PASSWORD_RESET =\n  '[User] Reset Update Password Process State';\n\nexport class UpdatePassword extends StateUtils.EntityLoadAction {\n  readonly type = UPDATE_PASSWORD;\n  constructor(\n    public payload: { userId: string; oldPassword: string; newPassword: string }\n  ) {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID);\n  }\n}\n\nexport class UpdatePasswordFail extends StateUtils.EntityFailAction {\n  readonly type = UPDATE_PASSWORD_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID, payload);\n  }\n}\n\nexport class UpdatePasswordSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = UPDATE_PASSWORD_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID);\n  }\n}\n\nexport class UpdatePasswordReset extends StateUtils.EntityLoaderResetAction {\n  readonly type = UPDATE_PASSWORD_RESET;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID);\n  }\n}\n\n// action types\nexport type UpdatePasswordAction =\n  | UpdatePassword\n  | UpdatePasswordFail\n  | UpdatePasswordSuccess\n  | UpdatePasswordReset;\n","import { Address } from '../../../model/address.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { USER_ADDRESSES } from '../user-state';\n\nexport const LOAD_USER_ADDRESSES = '[User] Load User Addresses';\nexport const LOAD_USER_ADDRESSES_FAIL = '[User] Load User Addresses Fail';\nexport const LOAD_USER_ADDRESSES_SUCCESS = '[User] Load User Addresses Success';\n\nexport const ADD_USER_ADDRESS = '[User] Add User Address';\nexport const ADD_USER_ADDRESS_FAIL = '[User] Add User Address Fail';\nexport const ADD_USER_ADDRESS_SUCCESS = '[User] Add User Address Success';\n\nexport const UPDATE_USER_ADDRESS = '[User] Update User Address';\nexport const UPDATE_USER_ADDRESS_FAIL = '[User] Update User Address Fail';\nexport const UPDATE_USER_ADDRESS_SUCCESS = '[User] Update User Address Success';\n\nexport const DELETE_USER_ADDRESS = '[User] Delete User Address';\nexport const DELETE_USER_ADDRESS_FAIL = '[User] Delete User Address Fail';\nexport const DELETE_USER_ADDRESS_SUCCESS = '[User] Delete User Address Success';\n\nexport class LoadUserAddresses extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_USER_ADDRESSES;\n  constructor(public payload: string) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class LoadUserAddressesFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_USER_ADDRESSES_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class LoadUserAddressesSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_USER_ADDRESSES_SUCCESS;\n  constructor(public payload: Address[]) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// Adding address actions\nexport class AddUserAddress extends StateUtils.LoaderLoadAction {\n  readonly type = ADD_USER_ADDRESS;\n  constructor(public payload: { userId: string; address: Address }) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class AddUserAddressFail extends StateUtils.LoaderFailAction {\n  readonly type = ADD_USER_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class AddUserAddressSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = ADD_USER_ADDRESS_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// Updating address actions\nexport class UpdateUserAddress extends StateUtils.LoaderLoadAction {\n  readonly type = UPDATE_USER_ADDRESS;\n  constructor(\n    public payload: { userId: string; addressId: string; address: Address }\n  ) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class UpdateUserAddressFail extends StateUtils.LoaderFailAction {\n  readonly type = UPDATE_USER_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class UpdateUserAddressSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = UPDATE_USER_ADDRESS_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// Deleting address actions\nexport class DeleteUserAddress extends StateUtils.LoaderLoadAction {\n  readonly type = DELETE_USER_ADDRESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class DeleteUserAddressFail extends StateUtils.LoaderFailAction {\n  readonly type = DELETE_USER_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class DeleteUserAddressSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = DELETE_USER_ADDRESS_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// action types\nexport type UserAddressesAction =\n  | LoadUserAddresses\n  | LoadUserAddressesFail\n  | LoadUserAddressesSuccess\n  | AddUserAddress\n  | AddUserAddressFail\n  | AddUserAddressSuccess\n  | UpdateUserAddress\n  | UpdateUserAddressFail\n  | UpdateUserAddressSuccess\n  | DeleteUserAddress\n  | DeleteUserAddressFail\n  | DeleteUserAddressSuccess;\n","import { ConsentTemplate } from '../../../model/consent.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateUtils } from '../../../state/utils/index';\nimport {\n  GIVE_CONSENT_PROCESS_ID,\n  USER_CONSENTS,\n  WITHDRAW_CONSENT_PROCESS_ID,\n} from '../user-state';\n\nexport const LOAD_USER_CONSENTS = '[User] Load User Consents';\nexport const LOAD_USER_CONSENTS_SUCCESS = '[User] Load User Consents Success';\nexport const LOAD_USER_CONSENTS_FAIL = '[User] Load User Consents Fail';\nexport const RESET_LOAD_USER_CONSENTS = '[User] Reset Load User Consents';\n\nexport const GIVE_USER_CONSENT = '[User] Give User Consent';\nexport const GIVE_USER_CONSENT_FAIL = '[User] Give User Consent Fail';\nexport const GIVE_USER_CONSENT_SUCCESS = '[User] Give User Consent Success';\nexport const RESET_GIVE_USER_CONSENT_PROCESS =\n  '[User] Reset Give User Consent Process';\nexport const TRANSFER_ANONYMOUS_CONSENT = '[User] Transfer Anonymous Consent';\n\nexport const WITHDRAW_USER_CONSENT = '[User] Withdraw User Consent';\nexport const WITHDRAW_USER_CONSENT_FAIL = '[User] Withdraw User Consent Fail';\nexport const WITHDRAW_USER_CONSENT_SUCCESS =\n  '[User] Withdraw User Consent Success';\nexport const RESET_WITHDRAW_USER_CONSENT_PROCESS =\n  '[User] Reset Withdraw User Consent Process';\n\nexport class LoadUserConsents extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_USER_CONSENTS;\n  constructor(public payload: string) {\n    super(USER_CONSENTS);\n  }\n}\n\nexport class LoadUserConsentsFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_USER_CONSENTS_FAIL;\n  constructor(public payload: any) {\n    super(USER_CONSENTS, payload);\n  }\n}\n\nexport class LoadUserConsentsSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_USER_CONSENTS_SUCCESS;\n  constructor(public payload: ConsentTemplate[]) {\n    super(USER_CONSENTS);\n  }\n}\n\nexport class ResetLoadUserConsents extends StateUtils.LoaderResetAction {\n  readonly type = RESET_LOAD_USER_CONSENTS;\n  constructor() {\n    super(USER_CONSENTS);\n  }\n}\n\nexport class GiveUserConsent extends StateUtils.EntityLoadAction {\n  readonly type = GIVE_USER_CONSENT;\n  constructor(\n    public payload: {\n      userId: string;\n      consentTemplateId: string;\n      consentTemplateVersion: number;\n    }\n  ) {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class GiveUserConsentFail extends StateUtils.EntityFailAction {\n  readonly type = GIVE_USER_CONSENT_FAIL;\n  constructor(payload: any) {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID, payload);\n  }\n}\n\nexport class GiveUserConsentSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = GIVE_USER_CONSENT_SUCCESS;\n  constructor(public consentTemplate: ConsentTemplate) {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class ResetGiveUserConsentProcess extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_GIVE_USER_CONSENT_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class TransferAnonymousConsent {\n  readonly type = TRANSFER_ANONYMOUS_CONSENT;\n  constructor(\n    public payload: {\n      userId: string;\n      consentTemplateId: string;\n      consentTemplateVersion: number;\n    }\n  ) {}\n}\n\nexport class WithdrawUserConsent extends StateUtils.EntityLoadAction {\n  readonly type = WITHDRAW_USER_CONSENT;\n  constructor(\n    public payload: {\n      userId: string;\n      consentCode: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class WithdrawUserConsentFail extends StateUtils.EntityFailAction {\n  readonly type = WITHDRAW_USER_CONSENT_FAIL;\n  constructor(payload: any) {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID, payload);\n  }\n}\n\nexport class WithdrawUserConsentSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = WITHDRAW_USER_CONSENT_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class ResetWithdrawUserConsentProcess extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_WITHDRAW_USER_CONSENT_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID);\n  }\n}\n\nexport type UserConsentsAction =\n  | LoadUserConsents\n  | LoadUserConsentsFail\n  | LoadUserConsentsSuccess\n  | ResetLoadUserConsents\n  | GiveUserConsent\n  | GiveUserConsentFail\n  | GiveUserConsentSuccess\n  | ResetGiveUserConsentProcess\n  | WithdrawUserConsent\n  | WithdrawUserConsentFail\n  | WithdrawUserConsentSuccess\n  | ResetWithdrawUserConsentProcess;\n","import { CostCenter } from '../../../model/org-unit.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { USER_COST_CENTERS } from '../user-state';\n\nexport const LOAD_ACTIVE_COST_CENTERS = '[User] Load Active CostCenters';\nexport const LOAD_ACTIVE_COST_CENTERS_FAIL =\n  '[User] Load Active CostCenters Fail';\nexport const LOAD_ACTIVE_COST_CENTERS_SUCCESS =\n  '[User] Load Active CostCenters Success';\n\nexport class LoadActiveCostCenters extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_ACTIVE_COST_CENTERS;\n  constructor(public payload: string) {\n    super(USER_COST_CENTERS);\n  }\n}\n\nexport class LoadActiveCostCentersFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_ACTIVE_COST_CENTERS_FAIL;\n  constructor(public payload: any) {\n    super(USER_COST_CENTERS, payload);\n  }\n}\n\nexport class LoadActiveCostCentersSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_ACTIVE_COST_CENTERS_SUCCESS;\n  constructor(public payload: CostCenter[]) {\n    super(USER_COST_CENTERS);\n  }\n}\n\nexport type UserCostCenterAction =\n  | LoadActiveCostCenters\n  | LoadActiveCostCentersFail\n  | LoadActiveCostCentersSuccess;\n","import { Action } from '@ngrx/store';\nimport { User } from '../../../model/misc.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateUtils } from '../../../state/utils/index';\nimport { UPDATE_USER_DETAILS_PROCESS_ID } from '../user-state';\n\nexport const LOAD_USER_DETAILS = '[User] Load User Details';\nexport const LOAD_USER_DETAILS_FAIL = '[User] Load User Details Fail';\nexport const LOAD_USER_DETAILS_SUCCESS = '[User] Load User Details Success';\n\nexport const UPDATE_USER_DETAILS = '[User] Update User Details';\nexport const UPDATE_USER_DETAILS_FAIL = '[User] Update User Details Fail';\nexport const UPDATE_USER_DETAILS_SUCCESS = '[User] Update User Details Success';\nexport const RESET_USER_DETAILS = '[User] Reset User Details';\n\nexport class LoadUserDetails implements Action {\n  readonly type = LOAD_USER_DETAILS;\n  constructor(public payload: string) {}\n}\n\nexport class LoadUserDetailsFail implements Action {\n  readonly type = LOAD_USER_DETAILS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadUserDetailsSuccess implements Action {\n  readonly type = LOAD_USER_DETAILS_SUCCESS;\n  constructor(public payload: User) {}\n}\n\nexport class UpdateUserDetails extends StateUtils.EntityLoadAction {\n  readonly type = UPDATE_USER_DETAILS;\n  constructor(public payload: { username: string; userDetails: User }) {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class UpdateUserDetailsFail extends StateUtils.EntityFailAction {\n  readonly type = UPDATE_USER_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID, payload);\n  }\n}\n\nexport class UpdateUserDetailsSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = UPDATE_USER_DETAILS_SUCCESS;\n  constructor(public userUpdates: User) {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class ResetUpdateUserDetails extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_USER_DETAILS;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID);\n  }\n}\n\n// action types\nexport type UserDetailsAction =\n  | LoadUserDetails\n  | LoadUserDetailsFail\n  | LoadUserDetailsSuccess\n  | UpdateUserDetails\n  | UpdateUserDetailsFail\n  | UpdateUserDetailsSuccess\n  | ResetUpdateUserDetails;\n","import { Action } from '@ngrx/store';\nexport const CLEAR_USER_MISCS_DATA = '[User] Clear User Misc Data';\n\nexport class ClearUserMiscsData implements Action {\n  readonly type = CLEAR_USER_MISCS_DATA;\n}\n","import { OrderHistoryList } from '../../../model/order.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { USER_ORDERS } from '../user-state';\n\nexport const LOAD_USER_ORDERS = '[User] Load User Orders';\nexport const LOAD_USER_ORDERS_FAIL = '[User] Load User Orders Fail';\nexport const LOAD_USER_ORDERS_SUCCESS = '[User] Load User Orders Success';\nexport const CLEAR_USER_ORDERS = '[User] Clear User Orders';\n\nexport class LoadUserOrders extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_USER_ORDERS;\n  constructor(\n    public payload: {\n      userId: string;\n      pageSize?: number;\n      currentPage?: number;\n      sort?: string;\n      replenishmentOrderCode?: string;\n    }\n  ) {\n    super(USER_ORDERS);\n  }\n}\n\nexport class LoadUserOrdersFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_USER_ORDERS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ORDERS, payload);\n  }\n}\n\nexport class LoadUserOrdersSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_USER_ORDERS_SUCCESS;\n  constructor(public payload: OrderHistoryList) {\n    super(USER_ORDERS);\n  }\n}\n\nexport class ClearUserOrders extends StateUtils.LoaderResetAction {\n  readonly type = CLEAR_USER_ORDERS;\n  constructor() {\n    super(USER_ORDERS);\n  }\n}\n\nexport type UserOrdersAction =\n  | LoadUserOrders\n  | LoadUserOrdersFail\n  | LoadUserOrdersSuccess\n  | ClearUserOrders;\n","import { Action } from '@ngrx/store';\nimport { UserSignUp } from '../../../model/misc.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateUtils } from '../../../state/utils/index';\nimport {\n  REGISTER_USER_PROCESS_ID,\n  REMOVE_USER_PROCESS_ID,\n} from '../user-state';\n\nexport const REGISTER_USER = '[User] Register User';\nexport const REGISTER_USER_FAIL = '[User] Register User Fail';\nexport const REGISTER_USER_SUCCESS = '[User] Register User Success';\nexport const RESET_REGISTER_USER_PROCESS = '[User] Reset Register User Process';\n\nexport const REGISTER_GUEST = '[User] Register Guest';\nexport const REGISTER_GUEST_FAIL = '[User] Register Guest Fail';\nexport const REGISTER_GUEST_SUCCESS = '[User] Register Guest Success';\n\nexport const REMOVE_USER = '[User] Remove User';\nexport const REMOVE_USER_FAIL = '[User] Remove User Fail';\nexport const REMOVE_USER_SUCCESS = '[User] Remove User Success';\nexport const REMOVE_USER_RESET = '[User] Reset Remove User Process State';\n\nexport class RegisterUser extends StateUtils.EntityLoadAction {\n  readonly type = REGISTER_USER;\n  constructor(public payload: UserSignUp) {\n    super(PROCESS_FEATURE, REGISTER_USER_PROCESS_ID);\n  }\n}\n\nexport class RegisterUserFail extends StateUtils.EntityFailAction {\n  readonly type = REGISTER_USER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, REGISTER_USER_PROCESS_ID, payload);\n  }\n}\n\nexport class RegisterUserSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = REGISTER_USER_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, REGISTER_USER_PROCESS_ID);\n  }\n}\n\nexport class ResetRegisterUserProcess extends StateUtils.EntityLoaderResetAction {\n  readonly type = RESET_REGISTER_USER_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, REGISTER_USER_PROCESS_ID);\n  }\n}\n\nexport class RegisterGuest implements Action {\n  readonly type = REGISTER_GUEST;\n  constructor(public payload: { guid: string; password: string }) {}\n}\n\nexport class RegisterGuestFail implements Action {\n  readonly type = REGISTER_GUEST_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class RegisterGuestSuccess implements Action {\n  readonly type = REGISTER_GUEST_SUCCESS;\n}\n\nexport class RemoveUser extends StateUtils.EntityLoadAction {\n  readonly type = REMOVE_USER;\n  constructor(public payload: string) {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID);\n  }\n}\n\nexport class RemoveUserFail extends StateUtils.EntityFailAction {\n  readonly type = REMOVE_USER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID, payload);\n  }\n}\n\nexport class RemoveUserSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = REMOVE_USER_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID);\n  }\n}\n\nexport class RemoveUserReset extends StateUtils.EntityLoaderResetAction {\n  readonly type = REMOVE_USER_RESET;\n  constructor() {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID);\n  }\n}\n\n// action types\nexport type UserRegisterOrRemoveAction =\n  | RegisterUser\n  | RegisterUserFail\n  | RegisterUserSuccess\n  | ResetRegisterUserProcess\n  | RegisterGuest\n  | RegisterGuestFail\n  | RegisterGuestSuccess\n  | RemoveUser\n  | RemoveUserFail\n  | RemoveUserSuccess\n  | RemoveUserReset;\n","import { ReplenishmentOrderList } from '../../../model/replenishment-order.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { USER_REPLENISHMENT_ORDERS } from '../user-state';\n\nexport const LOAD_USER_REPLENISHMENT_ORDERS =\n  '[User] Load User Replenishment Orders';\nexport const LOAD_USER_REPLENISHMENT_ORDERS_FAIL =\n  '[User] Load User Replenishment Orders Fail';\nexport const LOAD_USER_REPLENISHMENT_ORDERS_SUCCESS =\n  '[User] Load User Replenishment Orders Success';\nexport const CLEAR_USER_REPLENISHMENT_ORDERS =\n  '[User] Clear User Replenishment Orders';\n\nexport class LoadUserReplenishmentOrders extends StateUtils.LoaderLoadAction {\n  readonly type = LOAD_USER_REPLENISHMENT_ORDERS;\n  constructor(\n    public payload: {\n      userId: string;\n      pageSize?: number;\n      currentPage?: number;\n      sort?: string;\n    }\n  ) {\n    super(USER_REPLENISHMENT_ORDERS);\n  }\n}\n\nexport class LoadUserReplenishmentOrdersFail extends StateUtils.LoaderFailAction {\n  readonly type = LOAD_USER_REPLENISHMENT_ORDERS_FAIL;\n  constructor(public payload: any) {\n    super(USER_REPLENISHMENT_ORDERS, payload);\n  }\n}\n\nexport class LoadUserReplenishmentOrdersSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = LOAD_USER_REPLENISHMENT_ORDERS_SUCCESS;\n  constructor(public payload: ReplenishmentOrderList) {\n    super(USER_REPLENISHMENT_ORDERS);\n  }\n}\n\nexport class ClearUserReplenishmentOrders extends StateUtils.LoaderResetAction {\n  readonly type = CLEAR_USER_REPLENISHMENT_ORDERS;\n  constructor() {\n    super(USER_REPLENISHMENT_ORDERS);\n  }\n}\n\nexport type UserReplenishmentOrdersAction =\n  | LoadUserReplenishmentOrders\n  | LoadUserReplenishmentOrdersFail\n  | LoadUserReplenishmentOrdersSuccess\n  | ClearUserReplenishmentOrders;\n","import { Observable, OperatorFunction } from 'rxjs';\nimport { startWith, switchMapTo } from 'rxjs/operators';\n\n/**\n *\n * Withdraw from the source observable when notifier emits a value\n *\n * Withdraw will result in resubscribing to the source observable\n * Operator is useful to kill ongoing emission transformation on notifier emission\n *\n * @param notifier\n */\nexport function withdrawOn<T>(\n  notifier: Observable<any>\n): OperatorFunction<T, T> {\n  return (source: Observable<T>) =>\n    notifier.pipe(startWith(undefined), switchMapTo(source));\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { from, Observable, of } from 'rxjs';\nimport {\n  catchError,\n  concatMap,\n  filter,\n  map,\n  mergeMap,\n  switchMap,\n} from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/user-auth/store/actions/index';\nimport { CartActions } from '../../../cart/store/actions/index';\nimport { CheckoutDetails } from '../../../checkout/models/checkout.model';\nimport { GlobalMessageActions } from '../../../global-message/store/actions/index';\nimport { OCC_USER_ID_ANONYMOUS } from '../../../occ/utils/occ-constants';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { UserActions } from '../../../user/store/actions/index';\nimport { normalizeHttpError } from '../../../util/normalize-http-error';\nimport { withdrawOn } from '../../../util/rxjs/withdraw-on';\nimport { CheckoutConnector } from '../../connectors/checkout/checkout.connector';\nimport { CheckoutCostCenterConnector } from '../../connectors/cost-center/checkout-cost-center.connector';\nimport { CheckoutDeliveryConnector } from '../../connectors/delivery/checkout-delivery.connector';\nimport { CheckoutPaymentConnector } from '../../connectors/payment/checkout-payment.connector';\nimport { CheckoutActions } from '../actions/index';\n\n@Injectable()\nexport class CheckoutEffects {\n  private contextChange$ = this.actions$.pipe(\n    ofType(\n      SiteContextActions.CURRENCY_CHANGE,\n      SiteContextActions.LANGUAGE_CHANGE\n    )\n  );\n\n  @Effect()\n  addDeliveryAddress$: Observable<\n    | UserActions.LoadUserAddresses\n    | CheckoutActions.SetDeliveryAddress\n    | CheckoutActions.AddDeliveryAddressFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.ADD_DELIVERY_ADDRESS),\n    map((action: CheckoutActions.AddDeliveryAddress) => action.payload),\n    mergeMap((payload) =>\n      this.checkoutDeliveryConnector\n        .createAddress(payload.userId, payload.cartId, payload.address)\n        .pipe(\n          mergeMap((address) => {\n            address['titleCode'] = payload.address.titleCode;\n            if (payload.address.region && payload.address.region.isocodeShort) {\n              Object.assign(address.region, {\n                isocodeShort: payload.address.region.isocodeShort,\n              });\n            }\n            if (payload.userId === OCC_USER_ID_ANONYMOUS) {\n              return [\n                new CheckoutActions.SetDeliveryAddress({\n                  userId: payload.userId,\n                  cartId: payload.cartId,\n                  address: address,\n                }),\n              ];\n            } else {\n              return [\n                new UserActions.LoadUserAddresses(payload.userId),\n                new CheckoutActions.SetDeliveryAddress({\n                  userId: payload.userId,\n                  cartId: payload.cartId,\n                  address: address,\n                }),\n              ];\n            }\n          }),\n          catchError((error) =>\n            of(\n              new CheckoutActions.AddDeliveryAddressFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        )\n    ),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  setDeliveryAddress$: Observable<\n    | CheckoutActions.SetDeliveryAddressSuccess\n    | CheckoutActions.ClearSupportedDeliveryModes\n    | CheckoutActions.ClearCheckoutDeliveryMode\n    | CheckoutActions.ResetLoadSupportedDeliveryModesProcess\n    | CheckoutActions.LoadSupportedDeliveryModes\n    | CheckoutActions.SetDeliveryAddressFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.SET_DELIVERY_ADDRESS),\n    map((action: any) => action.payload),\n    mergeMap((payload) => {\n      return this.checkoutDeliveryConnector\n        .setAddress(payload.userId, payload.cartId, payload.address.id)\n        .pipe(\n          mergeMap(() => [\n            new CheckoutActions.SetDeliveryAddressSuccess(payload.address),\n            new CheckoutActions.ClearCheckoutDeliveryMode({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            }),\n            new CheckoutActions.ClearSupportedDeliveryModes(),\n            new CheckoutActions.ResetLoadSupportedDeliveryModesProcess(),\n            new CheckoutActions.LoadSupportedDeliveryModes({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            }),\n          ]),\n          catchError((error) =>\n            of(\n              new CheckoutActions.SetDeliveryAddressFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  loadSupportedDeliveryModes$: Observable<\n    | CheckoutActions.LoadSupportedDeliveryModesSuccess\n    | CheckoutActions.LoadSupportedDeliveryModesFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.LOAD_SUPPORTED_DELIVERY_MODES),\n    map((action: any) => action.payload),\n    mergeMap((payload) => {\n      return this.checkoutDeliveryConnector\n        .getSupportedModes(payload.userId, payload.cartId)\n        .pipe(\n          map((data) => {\n            return new CheckoutActions.LoadSupportedDeliveryModesSuccess(data);\n          }),\n          catchError((error) =>\n            of(\n              new CheckoutActions.LoadSupportedDeliveryModesFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  clearCheckoutMiscsDataOnLanguageChange$: Observable<\n    | CheckoutActions.CheckoutClearMiscsData\n    | CheckoutActions.ResetLoadSupportedDeliveryModesProcess\n    | CheckoutActions.ResetLoadPaymentTypesProcess\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LANGUAGE_CHANGE),\n    mergeMap(() => [\n      new CheckoutActions.ResetLoadSupportedDeliveryModesProcess(),\n      new CheckoutActions.ResetLoadPaymentTypesProcess(),\n      new CheckoutActions.CheckoutClearMiscsData(),\n    ])\n  );\n\n  @Effect()\n  clearDeliveryModesOnCurrencyChange$: Observable<\n    CheckoutActions.ClearSupportedDeliveryModes\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.CURRENCY_CHANGE),\n    map(() => new CheckoutActions.ClearSupportedDeliveryModes())\n  );\n\n  @Effect()\n  clearCheckoutDataOnLogout$: Observable<\n    CheckoutActions.ClearCheckoutData\n  > = this.actions$.pipe(\n    ofType(AuthActions.LOGOUT),\n    map(() => new CheckoutActions.ClearCheckoutData())\n  );\n\n  @Effect()\n  clearCheckoutDataOnLogin$: Observable<\n    CheckoutActions.ClearCheckoutData\n  > = this.actions$.pipe(\n    ofType(AuthActions.LOGIN),\n    map(() => new CheckoutActions.ClearCheckoutData())\n  );\n\n  @Effect()\n  setDeliveryMode$: Observable<\n    | CheckoutActions.SetDeliveryModeSuccess\n    | CheckoutActions.SetDeliveryModeFail\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.SET_DELIVERY_MODE),\n    map((action: any) => action.payload),\n    mergeMap((payload) => {\n      return this.checkoutDeliveryConnector\n        .setMode(payload.userId, payload.cartId, payload.selectedModeId)\n        .pipe(\n          mergeMap(() => {\n            return [\n              new CheckoutActions.SetDeliveryModeSuccess(\n                payload.selectedModeId\n              ),\n              new CartActions.LoadCart({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ];\n          }),\n          catchError((error) =>\n            of(\n              new CheckoutActions.SetDeliveryModeFail(normalizeHttpError(error))\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  createPaymentDetails$: Observable<\n    | UserActions.LoadUserPaymentMethods\n    | CheckoutActions.CreatePaymentDetailsSuccess\n    | CheckoutActions.CreatePaymentDetailsFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.CREATE_PAYMENT_DETAILS),\n    map((action: any) => action.payload),\n    mergeMap((payload) => {\n      // get information for creating a subscription directly with payment provider\n      return this.checkoutPaymentConnector\n        .create(payload.userId, payload.cartId, payload.paymentDetails)\n        .pipe(\n          mergeMap((details) => {\n            if (payload.userId === OCC_USER_ID_ANONYMOUS) {\n              return [new CheckoutActions.CreatePaymentDetailsSuccess(details)];\n            } else {\n              return [\n                new UserActions.LoadUserPaymentMethods(payload.userId),\n                new CheckoutActions.CreatePaymentDetailsSuccess(details),\n              ];\n            }\n          }),\n          catchError((error) =>\n            of(\n              new CheckoutActions.CreatePaymentDetailsFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  setPaymentDetails$: Observable<\n    | CheckoutActions.SetPaymentDetailsSuccess\n    | CheckoutActions.SetPaymentDetailsFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.SET_PAYMENT_DETAILS),\n    map((action: any) => action.payload),\n    mergeMap((payload) => {\n      return this.checkoutPaymentConnector\n        .set(payload.userId, payload.cartId, payload.paymentDetails.id)\n        .pipe(\n          map(\n            () =>\n              new CheckoutActions.SetPaymentDetailsSuccess(\n                payload.paymentDetails\n              )\n          ),\n          catchError((error) =>\n            of(\n              new CheckoutActions.SetPaymentDetailsFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  placeOrder$: Observable<\n    | CheckoutActions.PlaceOrderSuccess\n    | GlobalMessageActions.AddMessage\n    | CheckoutActions.PlaceOrderFail\n    | CartActions.RemoveCart\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.PLACE_ORDER),\n    map((action: any) => action.payload),\n    mergeMap((payload) => {\n      return this.checkoutConnector\n        .placeOrder(payload.userId, payload.cartId, payload.termsChecked)\n        .pipe(\n          switchMap((data) => [\n            new CartActions.RemoveCart({ cartId: payload.cartId }),\n            new CheckoutActions.PlaceOrderSuccess(data),\n          ]),\n          catchError((error) =>\n            of(new CheckoutActions.PlaceOrderFail(normalizeHttpError(error)))\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  loadCheckoutDetails$: Observable<\n    | CheckoutActions.LoadCheckoutDetailsSuccess\n    | CheckoutActions.LoadCheckoutDetailsFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.LOAD_CHECKOUT_DETAILS),\n    map((action: CheckoutActions.LoadCheckoutDetails) => action.payload),\n    mergeMap((payload) => {\n      return this.checkoutConnector\n        .loadCheckoutDetails(payload.userId, payload.cartId)\n        .pipe(\n          map(\n            (data: CheckoutDetails) =>\n              new CheckoutActions.LoadCheckoutDetailsSuccess(data)\n          ),\n          catchError((error) =>\n            of(\n              new CheckoutActions.LoadCheckoutDetailsFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  reloadDetailsOnMergeCart$: Observable<\n    CheckoutActions.LoadCheckoutDetails\n  > = this.actions$.pipe(\n    ofType(CartActions.MERGE_CART_SUCCESS),\n    map((action: CartActions.MergeCartSuccess) => action.payload),\n    map((payload) => {\n      return new CheckoutActions.LoadCheckoutDetails({\n        userId: payload.userId,\n        cartId: payload.cartId,\n      });\n    })\n  );\n\n  @Effect()\n  clearCheckoutDeliveryAddress$: Observable<\n    | CheckoutActions.ClearCheckoutDeliveryAddressFail\n    | CheckoutActions.ClearCheckoutDeliveryAddressSuccess\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.CLEAR_CHECKOUT_DELIVERY_ADDRESS),\n    map(\n      (action: CheckoutActions.ClearCheckoutDeliveryAddress) => action.payload\n    ),\n    filter((payload) => Boolean(payload.cartId)),\n    switchMap((payload) => {\n      return this.checkoutConnector\n        .clearCheckoutDeliveryAddress(payload.userId, payload.cartId)\n        .pipe(\n          map(() => new CheckoutActions.ClearCheckoutDeliveryAddressSuccess()),\n          catchError((error) =>\n            of(\n              new CheckoutActions.ClearCheckoutDeliveryAddressFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  clearCheckoutDeliveryMode$: Observable<\n    | CheckoutActions.ClearCheckoutDeliveryModeFail\n    | CheckoutActions.ClearCheckoutDeliveryModeSuccess\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.CLEAR_CHECKOUT_DELIVERY_MODE),\n    map((action: CheckoutActions.ClearCheckoutDeliveryMode) => action.payload),\n    filter((payload) => Boolean(payload.cartId)),\n    concatMap((payload) => {\n      return this.checkoutConnector\n        .clearCheckoutDeliveryMode(payload.userId, payload.cartId)\n        .pipe(\n          map(\n            () =>\n              new CheckoutActions.ClearCheckoutDeliveryModeSuccess({\n                ...payload,\n              })\n          ),\n          catchError((error) =>\n            from([\n              new CheckoutActions.ClearCheckoutDeliveryModeFail({\n                ...payload,\n                error: normalizeHttpError(error),\n              }),\n              new CartActions.LoadCart({\n                cartId: payload.cartId,\n                userId: payload.userId,\n              }),\n            ])\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  setCostCenter$: Observable<\n    | CheckoutActions.SetCostCenterSuccess\n    | CheckoutActions.SetCostCenterFail\n    | CheckoutActions.ClearCheckoutDeliveryAddress\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.SET_COST_CENTER),\n    map((action: CheckoutActions.SetCostCenter) => action.payload),\n    switchMap((payload) => {\n      return this.checkoutCostCenterConnector\n        .setCostCenter(payload.userId, payload.cartId, payload.costCenterId)\n        .pipe(\n          mergeMap((_data) => [\n            new CartActions.LoadCart({\n              cartId: payload.cartId,\n              userId: payload.userId,\n            }),\n            new CheckoutActions.SetCostCenterSuccess(payload.costCenterId),\n            new CheckoutActions.ClearCheckoutDeliveryAddress({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            }),\n          ]),\n          catchError((error) =>\n            of(new CheckoutActions.SetCostCenterFail(normalizeHttpError(error)))\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  constructor(\n    private actions$: Actions,\n    private checkoutDeliveryConnector: CheckoutDeliveryConnector,\n    private checkoutPaymentConnector: CheckoutPaymentConnector,\n    private checkoutCostCenterConnector: CheckoutCostCenterConnector,\n    private checkoutConnector: CheckoutConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { CartActions } from '../../../cart/store/actions/index';\nimport { normalizeHttpError } from '../../../util/normalize-http-error';\nimport { PaymentTypeConnector } from '../../connectors/payment-type/payment-type.connector';\nimport { CheckoutActions } from '../actions/index';\n\n@Injectable()\nexport class PaymentTypesEffects {\n  @Effect()\n  loadPaymentTypes$: Observable<\n    | CheckoutActions.LoadPaymentTypesSuccess\n    | CheckoutActions.LoadPaymentTypesFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.LOAD_PAYMENT_TYPES),\n    switchMap(() => {\n      return this.paymentTypeConnector.getPaymentTypes().pipe(\n        map(\n          (paymentTypes) =>\n            new CheckoutActions.LoadPaymentTypesSuccess(paymentTypes)\n        ),\n        catchError((error) =>\n          of(\n            new CheckoutActions.LoadPaymentTypesFail(normalizeHttpError(error))\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  setPaymentType$: Observable<\n    | CheckoutActions.SetPaymentTypeSuccess\n    | CheckoutActions.SetPaymentTypeFail\n    | CartActions.LoadCartSuccess\n    | CheckoutActions.ClearCheckoutData\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.SET_PAYMENT_TYPE),\n    map((action: CheckoutActions.SetPaymentType) => action.payload),\n    switchMap((payload) => {\n      return this.paymentTypeConnector\n        .setPaymentType(\n          payload.userId,\n          payload.cartId,\n          payload.typeCode,\n          payload.poNumber\n        )\n        .pipe(\n          mergeMap((data) => {\n            return [\n              new CartActions.LoadCartSuccess({\n                cart: data,\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n              new CheckoutActions.ClearCheckoutData(),\n              new CheckoutActions.SetPaymentTypeSuccess(data),\n            ];\n          }),\n          catchError((error) =>\n            of(\n              new CheckoutActions.SetPaymentTypeFail(normalizeHttpError(error))\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private paymentTypeConnector: PaymentTypeConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { CartActions } from '../../../cart/store/actions/index';\nimport { normalizeHttpError } from '../../../util/normalize-http-error';\nimport { CheckoutReplenishmentOrderConnector } from '../../connectors/index';\nimport { CheckoutActions } from '../actions/index';\n\n@Injectable()\nexport class ReplenishmentOrderEffects {\n  @Effect()\n  scheduleReplenishmentOrder$: Observable<\n    | CheckoutActions.ScheduleReplenishmentOrderSuccess\n    | CheckoutActions.ScheduleReplenishmentOrderFail\n    | CartActions.RemoveCart\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.SCHEDULE_REPLENISHMENT_ORDER),\n    map((action: CheckoutActions.ScheduleReplenishmentOrder) => action.payload),\n    mergeMap((payload) => {\n      return this.checkoutReplOrderConnector\n        .scheduleReplenishmentOrder(\n          payload.cartId,\n          payload.scheduleReplenishmentForm,\n          payload.termsChecked,\n          payload.userId\n        )\n        .pipe(\n          switchMap((data) => [\n            new CartActions.RemoveCart({ cartId: payload.cartId }),\n            new CheckoutActions.ScheduleReplenishmentOrderSuccess(data),\n          ]),\n          catchError((error) =>\n            of(\n              new CheckoutActions.ScheduleReplenishmentOrderFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private checkoutReplOrderConnector: CheckoutReplenishmentOrderConnector\n  ) {}\n}\n","import { AddressVerificationEffect } from './address-verification.effect';\nimport { CardTypesEffects } from './card-types.effect';\nimport { CheckoutEffects } from './checkout.effect';\nimport { PaymentTypesEffects } from './payment-types.effect';\nimport { ReplenishmentOrderEffects } from './replenishment-order.effect';\n\nexport const effects: any[] = [\n  CheckoutEffects,\n  AddressVerificationEffect,\n  CardTypesEffects,\n  PaymentTypesEffects,\n  ReplenishmentOrderEffects,\n];\n\nexport * from './address-verification.effect';\nexport * from './card-types.effect';\nexport * from './checkout.effect';\nexport * from './payment-types.effect';\nexport * from './replenishment-order.effect';\n","import { CheckoutActions } from '../actions/index';\nimport { AddressVerificationState } from '../checkout-state';\n\nexport const initialState: AddressVerificationState = {\n  results: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: CheckoutActions.AddressVerificationActions\n): AddressVerificationState {\n  switch (action.type) {\n    case CheckoutActions.VERIFY_ADDRESS_SUCCESS: {\n      const results = action.payload;\n\n      return {\n        ...state,\n        results,\n      };\n    }\n\n    case CheckoutActions.VERIFY_ADDRESS_FAIL: {\n      return {\n        ...state,\n        results: 'FAIL',\n      };\n    }\n\n    case CheckoutActions.CLEAR_ADDRESS_VERIFICATION_RESULTS: {\n      return {\n        ...state,\n        results: {},\n      };\n    }\n  }\n\n  return state;\n}\n\nexport const getAddressVerificationResults = (\n  state: AddressVerificationState\n) => state.results;\n","import { CardType } from '../../../model/cart.model';\nimport { CheckoutActions } from '../actions/index';\nimport { CardTypesState } from '../checkout-state';\n\nexport const initialState: CardTypesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action:\n    | CheckoutActions.CardTypesAction\n    | CheckoutActions.CheckoutClearMiscsData\n): CardTypesState {\n  switch (action.type) {\n    case CheckoutActions.LOAD_CARD_TYPES_SUCCESS: {\n      const cardTypes: CardType[] = action.payload;\n      const entities = cardTypes.reduce(\n        (cardTypesEntities: { [code: string]: CardType }, name: CardType) => {\n          return {\n            ...cardTypesEntities,\n            [name.code]: name,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case CheckoutActions.CHECKOUT_CLEAR_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n\nexport const getCardTypesEntites = (state: CardTypesState) => state.entities;\n","import { Address } from '../../../model/address.model';\nimport { Cart } from '../../../model/cart.model';\nimport { DeliveryMode, Order } from '../../../model/order.model';\nimport { ReplenishmentOrder } from '../../../model/replenishment-order.model';\nimport { CheckoutStepsState } from '../checkout-state';\nimport { CheckoutActions } from './../actions/index';\n\nexport const initialState: CheckoutStepsState = {\n  poNumber: { po: undefined, costCenter: undefined },\n  address: {},\n  deliveryMode: {\n    supported: {},\n    selected: '',\n  },\n  paymentDetails: {},\n  orderDetails: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action:\n    | CheckoutActions.CheckoutAction\n    | CheckoutActions.CheckoutClearMiscsData\n    | CheckoutActions.SetPaymentTypeSuccess\n    | CheckoutActions.ReplenishmentOrderActions\n): CheckoutStepsState {\n  switch (action.type) {\n    case CheckoutActions.SET_PAYMENT_TYPE_SUCCESS: {\n      const cart: Cart = action.payload;\n      return {\n        ...state,\n        poNumber: {\n          ...state.poNumber,\n          po: cart.purchaseOrderNumber,\n        },\n      };\n    }\n\n    case CheckoutActions.SET_COST_CENTER_SUCCESS: {\n      return {\n        ...state,\n        poNumber: {\n          ...state.poNumber,\n          costCenter: action.payload,\n        },\n      };\n    }\n\n    case CheckoutActions.ADD_DELIVERY_ADDRESS_SUCCESS:\n    case CheckoutActions.SET_DELIVERY_ADDRESS_SUCCESS: {\n      const address: Address = action.payload;\n\n      return {\n        ...state,\n        address,\n      };\n    }\n\n    case CheckoutActions.LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS: {\n      const supportedModes = action.payload;\n      if (!supportedModes) {\n        return state;\n      }\n\n      const supported = supportedModes.reduce(\n        (modes: { [code: string]: DeliveryMode }, mode: DeliveryMode) => {\n          return {\n            ...modes,\n            [mode.code]: mode,\n          };\n        },\n        {\n          ...state.deliveryMode.supported,\n        }\n      );\n\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          supported,\n        },\n      };\n    }\n\n    case CheckoutActions.SET_DELIVERY_MODE_SUCCESS: {\n      const selected = action.payload;\n\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          selected,\n        },\n      };\n    }\n\n    case CheckoutActions.CREATE_PAYMENT_DETAILS_SUCCESS:\n    case CheckoutActions.SET_PAYMENT_DETAILS_SUCCESS: {\n      return {\n        ...state,\n        paymentDetails: action.payload,\n      };\n    }\n\n    case CheckoutActions.CREATE_PAYMENT_DETAILS_FAIL: {\n      const paymentDetails = action.payload;\n      if (paymentDetails['hasError']) {\n        return {\n          ...state,\n          paymentDetails,\n        };\n      }\n\n      return state;\n    }\n\n    case CheckoutActions.PLACE_ORDER_SUCCESS:\n    case CheckoutActions.SCHEDULE_REPLENISHMENT_ORDER_SUCCESS: {\n      const orderDetails: Order | ReplenishmentOrder = action.payload;\n\n      return {\n        ...state,\n        orderDetails,\n      };\n    }\n\n    case CheckoutActions.CLEAR_CHECKOUT_DATA: {\n      return initialState;\n    }\n\n    case CheckoutActions.CLEAR_CHECKOUT_STEP: {\n      const stepNumber = action.payload;\n      switch (stepNumber) {\n        case 1: {\n          return {\n            ...state,\n            address: {},\n          };\n        }\n\n        case 2: {\n          return {\n            ...state,\n            deliveryMode: {\n              ...state.deliveryMode,\n              supported: {},\n              selected: '',\n            },\n          };\n        }\n\n        case 3: {\n          return {\n            ...state,\n            paymentDetails: {},\n          };\n        }\n      }\n\n      return state;\n    }\n\n    case CheckoutActions.CLEAR_SUPPORTED_DELIVERY_MODES:\n    case CheckoutActions.CHECKOUT_CLEAR_MISCS_DATA: {\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          supported: {},\n        },\n      };\n    }\n    case CheckoutActions.LOAD_CHECKOUT_DETAILS_SUCCESS: {\n      return {\n        ...state,\n        address: action.payload.deliveryAddress,\n        deliveryMode: {\n          ...state.deliveryMode,\n          selected:\n            action.payload.deliveryMode && action.payload.deliveryMode.code,\n        },\n        paymentDetails: action.payload.paymentInfo,\n      };\n    }\n\n    case CheckoutActions.CLEAR_CHECKOUT_DELIVERY_ADDRESS: {\n      return {\n        ...state,\n        address: {},\n      };\n    }\n\n    case CheckoutActions.CLEAR_CHECKOUT_DELIVERY_MODE: {\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          selected: '',\n        },\n      };\n    }\n  }\n\n  return state;\n}\n","import { ORDER_TYPE } from '../../../model/replenishment-order.model';\nimport { CheckoutActions } from '../actions/index';\nimport { OrderTypesState } from '../checkout-state';\n\nexport const initialState: OrderTypesState = {\n  selected: ORDER_TYPE.PLACE_ORDER,\n};\n\nexport function reducer(\n  state = initialState,\n  action: CheckoutActions.OrderTypesActions | CheckoutActions.CheckoutAction\n): OrderTypesState {\n  switch (action.type) {\n    case CheckoutActions.SET_ORDER_TYPE: {\n      return {\n        ...state,\n        selected: action.payload,\n      };\n    }\n\n    case CheckoutActions.CLEAR_CHECKOUT_DATA: {\n      return initialState;\n    }\n\n    default: {\n      return state;\n    }\n  }\n}\n","import { PaymentType } from '../../../model/cart.model';\nimport { CheckoutActions } from '../actions/index';\nimport { PaymentTypesState } from '../checkout-state';\n\nexport const initialState: PaymentTypesState = {\n  entities: {},\n  selected: undefined,\n};\n\nexport function reducer(\n  state = initialState,\n  action:\n    | CheckoutActions.PaymentTypesAction\n    | CheckoutActions.ClearCheckoutData\n    | CheckoutActions.CheckoutClearMiscsData\n): PaymentTypesState {\n  switch (action.type) {\n    case CheckoutActions.LOAD_PAYMENT_TYPES_SUCCESS: {\n      const paymentTypes: PaymentType[] = action.payload;\n      const entities = paymentTypes.reduce(\n        (\n          paymentTypesEntities: { [code: string]: PaymentType },\n          name: PaymentType\n        ) => {\n          return {\n            ...paymentTypesEntities,\n            [name.code]: name,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case CheckoutActions.SET_PAYMENT_TYPE_SUCCESS: {\n      return {\n        ...state,\n        selected: action.payload.paymentType.code,\n      };\n    }\n\n    case CheckoutActions.CLEAR_CHECKOUT_DATA: {\n      return {\n        ...state,\n        selected: undefined,\n      };\n    }\n\n    case CheckoutActions.CHECKOUT_CLEAR_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n\nexport const getPaymentTypesEntites = (state: PaymentTypesState) =>\n  state.entities;\nexport const getSelectedPaymentType = (state: PaymentTypesState) =>\n  state.selected;\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducerMap } from '@ngrx/store';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport {\n  CheckoutState,\n  CheckoutStepsState,\n  CHECKOUT_DETAILS,\n} from '../checkout-state';\nimport * as fromAddressVerification from './address-verification.reducer';\nimport * as fromCardTypes from './card-types.reducer';\nimport * as fromCheckout from './checkout.reducer';\nimport * as fromOrderTypes from './order-types.reducer';\nimport * as fromPaymentTypes from './payment-types.reducer';\n\nexport function getReducers(): ActionReducerMap<CheckoutState> {\n  return {\n    steps: loaderReducer<CheckoutStepsState>(\n      CHECKOUT_DETAILS,\n      fromCheckout.reducer\n    ),\n    cardTypes: fromCardTypes.reducer,\n    addressVerification: fromAddressVerification.reducer,\n    paymentTypes: fromPaymentTypes.reducer,\n    orderType: fromOrderTypes.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  CheckoutState\n>> = new InjectionToken<ActionReducerMap<CheckoutState>>('CheckoutReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { CHECKOUT_FEATURE } from './checkout-state';\nimport { effects } from './effects/index';\nimport { reducerProvider, reducerToken } from './reducers/index';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    StoreModule.forFeature(CHECKOUT_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [reducerProvider],\n})\nexport class CheckoutStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { PageMetaResolver } from '../cms/page/page-meta.resolver';\nimport { CheckoutEventModule } from './events/checkout-event.module';\nimport { interceptors } from './http-interceptors/index';\nimport { CheckoutPageMetaResolver } from './services/checkout-page-meta.resolver';\nimport { CheckoutStoreModule } from './store/checkout-store.module';\n\n@NgModule({\n  imports: [CheckoutStoreModule, CheckoutEventModule],\n})\nexport class CheckoutModule {\n  static forRoot(): ModuleWithProviders<CheckoutModule> {\n    return {\n      ngModule: CheckoutModule,\n      providers: [\n        ...interceptors,\n        {\n          provide: PageMetaResolver,\n          useExisting: CheckoutPageMetaResolver,\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import {\n  createFeatureSelector,\n  createSelector,\n  MemoizedSelector,\n} from '@ngrx/store';\nimport { Address } from '../../../model/address.model';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { DeliveryMode, Order } from '../../../model/order.model';\nimport { ReplenishmentOrder } from '../../../model/replenishment-order.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  CheckoutState,\n  CheckoutStepsState,\n  CHECKOUT_FEATURE,\n  StateWithCheckout,\n} from '../checkout-state';\n\nconst getDeliveryAddressSelector = (state: CheckoutStepsState) => state.address;\nconst getDeliveryModeSelector = (state: CheckoutStepsState) =>\n  state.deliveryMode;\nconst getPaymentDetailsSelector = (state: CheckoutStepsState) =>\n  state.paymentDetails;\nconst getOrderDetailsSelector = (state: CheckoutStepsState) =>\n  state.orderDetails;\n\nexport const getCheckoutState: MemoizedSelector<\n  StateWithCheckout,\n  CheckoutState\n> = createFeatureSelector<CheckoutState>(CHECKOUT_FEATURE);\n\nexport const getCheckoutStepsState: MemoizedSelector<\n  StateWithCheckout,\n  LoaderState<CheckoutStepsState>\n> = createSelector(\n  getCheckoutState,\n  (checkoutState: CheckoutState) => checkoutState.steps\n);\n\nexport const getCheckoutSteps: MemoizedSelector<\n  StateWithCheckout,\n  CheckoutStepsState\n> = createSelector(getCheckoutStepsState, (state) =>\n  StateUtils.loaderValueSelector(state)\n);\n\nexport const getDeliveryAddress: MemoizedSelector<\n  StateWithCheckout,\n  Address\n> = createSelector(getCheckoutSteps, getDeliveryAddressSelector);\n\nexport const getDeliveryMode: MemoizedSelector<\n  StateWithCheckout,\n  {\n    supported: { [code: string]: DeliveryMode };\n    selected: string;\n  }\n> = createSelector(getCheckoutSteps, getDeliveryModeSelector);\n\nexport const getSupportedDeliveryModes: MemoizedSelector<\n  StateWithCheckout,\n  DeliveryMode[]\n> = createSelector(getDeliveryMode, (deliveryMode) => {\n  return (\n    deliveryMode &&\n    Object.keys(deliveryMode.supported).map(\n      (code) => deliveryMode.supported[code]\n    )\n  );\n});\n\nexport const getSelectedDeliveryModeCode: MemoizedSelector<\n  StateWithCheckout,\n  string\n> = createSelector(getDeliveryMode, (deliveryMode) => {\n  return deliveryMode && deliveryMode.selected;\n});\n\nexport const getSelectedDeliveryMode: MemoizedSelector<\n  StateWithCheckout,\n  DeliveryMode\n> = createSelector(getDeliveryMode, (deliveryMode) => {\n  if (deliveryMode.selected !== '') {\n    if (Object.keys(deliveryMode.supported).length === 0) {\n      return null;\n    }\n    return deliveryMode.supported[deliveryMode.selected];\n  }\n});\n\nexport const getPaymentDetails: MemoizedSelector<\n  StateWithCheckout,\n  PaymentDetails\n> = createSelector(getCheckoutSteps, getPaymentDetailsSelector);\n\nexport const getCheckoutOrderDetails: MemoizedSelector<\n  StateWithCheckout,\n  Order | ReplenishmentOrder\n> = createSelector(getCheckoutSteps, getOrderDetailsSelector);\n\nexport const getCheckoutDetailsLoaded: MemoizedSelector<\n  StateWithCheckout,\n  boolean\n> = createSelector(\n  getCheckoutStepsState,\n  (state) =>\n    StateUtils.loaderSuccessSelector(state) &&\n    !StateUtils.loaderLoadingSelector(state)\n);\n\nexport const getPoNumer: MemoizedSelector<\n  StateWithCheckout,\n  string\n> = createSelector(\n  getCheckoutSteps,\n  (state: CheckoutStepsState) => state.poNumber.po\n);\n\nexport const getCostCenter: MemoizedSelector<\n  StateWithCheckout,\n  string\n> = createSelector(\n  getCheckoutSteps,\n  (state: CheckoutStepsState) => state.poNumber.costCenter\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { AddressValidation } from '../../../model/address.model';\nimport {\n  AddressVerificationState,\n  CheckoutState,\n  StateWithCheckout,\n} from '../checkout-state';\nimport * as fromReducer from './../reducers/address-verification.reducer';\nimport { getCheckoutState } from './checkout.selectors';\n\nexport const getAddressVerificationResultsState: MemoizedSelector<\n  StateWithCheckout,\n  AddressVerificationState\n> = createSelector(\n  getCheckoutState,\n  (state: CheckoutState) => state.addressVerification\n);\n\nexport const getAddressVerificationResults: MemoizedSelector<\n  StateWithCheckout,\n  string | AddressValidation\n> = createSelector(\n  getAddressVerificationResultsState,\n  fromReducer.getAddressVerificationResults\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { CardType } from '../../../model/cart.model';\nimport {\n  CardTypesState,\n  CheckoutState,\n  StateWithCheckout,\n} from '../checkout-state';\nimport * as fromReducer from './../reducers/card-types.reducer';\nimport { getCheckoutState } from './checkout.selectors';\n\nexport const getCardTypesState: MemoizedSelector<\n  StateWithCheckout,\n  CardTypesState\n> = createSelector(getCheckoutState, (state: CheckoutState) => state.cardTypes);\n\nexport const getCardTypesEntites: MemoizedSelector<\n  StateWithCheckout,\n  { [code: string]: CardType }\n> = createSelector(getCardTypesState, fromReducer.getCardTypesEntites);\n\nexport const getAllCardTypes: MemoizedSelector<\n  StateWithCheckout,\n  CardType[]\n> = createSelector(getCardTypesEntites, (entites) => {\n  return Object.keys(entites).map((code) => entites[code]);\n});\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ORDER_TYPE } from '../../../model/replenishment-order.model';\nimport {\n  CheckoutState,\n  OrderTypesState,\n  StateWithCheckout,\n} from '../checkout-state';\nimport { getCheckoutState } from './checkout.selectors';\n\nexport const getSelectedOrderTypeSelector = (state: OrderTypesState) =>\n  state.selected;\n\nexport const getOrderTypesState: MemoizedSelector<\n  StateWithCheckout,\n  OrderTypesState\n> = createSelector(getCheckoutState, (state: CheckoutState) => state.orderType);\n\nexport const getSelectedOrderType: MemoizedSelector<\n  StateWithCheckout,\n  ORDER_TYPE\n> = createSelector(getOrderTypesState, getSelectedOrderTypeSelector);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { PaymentType } from '../../../model/cart.model';\nimport {\n  PaymentTypesState,\n  CheckoutState,\n  StateWithCheckout,\n} from '../checkout-state';\nimport * as fromReducer from './../reducers/payment-types.reducer';\nimport { getCheckoutState } from './checkout.selectors';\n\nexport const getPaymentTypesState: MemoizedSelector<\n  StateWithCheckout,\n  PaymentTypesState\n> = createSelector(\n  getCheckoutState,\n  (state: CheckoutState) => state.paymentTypes\n);\n\nexport const getPaymentTypesEntites: MemoizedSelector<\n  StateWithCheckout,\n  { [code: string]: PaymentType }\n> = createSelector(getPaymentTypesState, fromReducer.getPaymentTypesEntites);\n\nexport const getAllPaymentTypes: MemoizedSelector<\n  StateWithCheckout,\n  PaymentType[]\n> = createSelector(getPaymentTypesEntites, (entites) => {\n  return Object.keys(entites).map((code) => entites[code]);\n});\n\nexport const getSelectedPaymentType: MemoizedSelector<\n  StateWithCheckout,\n  string\n> = createSelector(getPaymentTypesState, fromReducer.getSelectedPaymentType);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, Observable } from 'rxjs';\nimport { filter, map, take } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { ActiveCartService } from '../../cart/facade/active-cart.service';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { CheckoutActions } from '../store/actions/index';\nimport { StateWithCheckout } from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutCostCenterService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout | StateWithProcess<void>>,\n    protected activeCartService: ActiveCartService,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Set cost center to cart\n   * @param costCenterId : cost center id\n   */\n  setCostCenter(costCenterId: string): void {\n    let cartId;\n    this.activeCartService\n      .getActiveCartId()\n      .pipe(take(1))\n      .subscribe((activeCartId) => (cartId = activeCartId));\n\n    this.userIdService.invokeWithUserId((userId) => {\n      if (userId && userId !== OCC_USER_ID_ANONYMOUS && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.SetCostCenter({\n            userId: userId,\n            cartId: cartId,\n            costCenterId: costCenterId,\n          })\n        );\n      }\n    });\n  }\n\n  /**\n   * Get cost center id from cart\n   */\n  getCostCenter(): Observable<string> {\n    return combineLatest([\n      this.activeCartService.getActive(),\n      this.checkoutStore.pipe(select(CheckoutSelectors.getCostCenter)),\n    ]).pipe(\n      filter(([cart]) => Boolean(cart)),\n      map(([cart, costCenterId]) => {\n        if (costCenterId === undefined && cart.costCenter) {\n          costCenterId = cart.costCenter.code;\n          this.checkoutStore.dispatch(\n            new CheckoutActions.SetCostCenterSuccess(cart.costCenter.code)\n          );\n        }\n        return costCenterId;\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport {\n  filter,\n  pluck,\n  shareReplay,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { ActiveCartService } from '../../cart/facade/active-cart.service';\nimport { Address, AddressValidation } from '../../model/address.model';\nimport { DeliveryMode } from '../../model/order.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { getProcessStateFactory } from '../../process/store/selectors/process-group.selectors';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { CheckoutActions } from '../store/actions/index';\nimport {\n  SET_DELIVERY_ADDRESS_PROCESS_ID,\n  SET_DELIVERY_MODE_PROCESS_ID,\n  SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID,\n  StateWithCheckout,\n} from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutDeliveryService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout | StateWithProcess<void>>,\n    protected activeCartService: ActiveCartService,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Get supported delivery modes\n   */\n  getSupportedDeliveryModes(): Observable<DeliveryMode[]> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getSupportedDeliveryModes),\n      withLatestFrom(\n        this.checkoutStore.pipe(\n          select(getProcessStateFactory(SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID))\n        )\n      ),\n      tap(([, loadingState]) => {\n        if (\n          !(loadingState.loading || loadingState.success || loadingState.error)\n        ) {\n          this.loadSupportedDeliveryModes();\n        }\n      }),\n      pluck(0),\n      shareReplay({ bufferSize: 1, refCount: true })\n    );\n  }\n\n  /**\n   * Get selected delivery mode\n   */\n  getSelectedDeliveryMode(): Observable<DeliveryMode> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getSelectedDeliveryMode)\n    );\n  }\n\n  /**\n   * Get selected delivery mode code\n   */\n  getSelectedDeliveryModeCode(): Observable<string> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getSelectedDeliveryModeCode)\n    );\n  }\n\n  /**\n   * Get delivery address\n   */\n  getDeliveryAddress(): Observable<Address> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getDeliveryAddress)\n    );\n  }\n\n  /**\n   * Get status about successfully set Delivery Address\n   */\n  getSetDeliveryAddressProcess(): Observable<LoaderState<void>> {\n    return this.checkoutStore.pipe(\n      select(getProcessStateFactory(SET_DELIVERY_ADDRESS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Clear info about process of setting Delivery Address\n   */\n  resetSetDeliveryAddressProcess(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ResetSetDeliveryAddressProcess()\n    );\n  }\n\n  /**\n   * Get status about of set Delivery Mode process\n   */\n  getSetDeliveryModeProcess(): Observable<LoaderState<void>> {\n    return this.checkoutStore.pipe(\n      select(getProcessStateFactory(SET_DELIVERY_MODE_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Clear info about process of setting Delivery Mode\n   */\n  resetSetDeliveryModeProcess(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ResetSetDeliveryModeProcess()\n    );\n  }\n\n  /**\n   * Clear info about process of setting Supported Delivery Modes\n   */\n  resetLoadSupportedDeliveryModesProcess(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ResetLoadSupportedDeliveryModesProcess()\n    );\n  }\n\n  /**\n   * Get status about of set supported Delivery Modes process\n   */\n  getLoadSupportedDeliveryModeProcess(): Observable<LoaderState<void>> {\n    return this.checkoutStore.pipe(\n      select(getProcessStateFactory(SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Clear supported delivery modes loaded in last checkout process\n   */\n  clearCheckoutDeliveryModes(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ClearSupportedDeliveryModes()\n    );\n  }\n\n  /**\n   * Get address verification results\n   */\n  getAddressVerificationResults(): Observable<AddressValidation | string> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getAddressVerificationResults),\n      filter((results) => Object.keys(results).length !== 0)\n    );\n  }\n\n  /**\n   * Create and set a delivery address using the address param\n   * @param address : the Address to be created and set\n   */\n  createAndSetAddress(address: Address): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.userIdService\n        .getUserId()\n        .subscribe((occUserId) => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe((activeCartId) => (cartId = activeCartId))\n        .unsubscribe();\n      if (userId && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.AddDeliveryAddress({\n            userId,\n            cartId,\n            address: address,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Load supported delivery modes\n   */\n  loadSupportedDeliveryModes(): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.userIdService\n        .getUserId()\n        .subscribe((occUserId) => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe((activeCartId) => (cartId = activeCartId))\n        .unsubscribe();\n      if (userId && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.LoadSupportedDeliveryModes({\n            userId,\n            cartId,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Set delivery mode\n   * @param mode : The delivery mode to be set\n   */\n  setDeliveryMode(mode: string): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.userIdService\n        .getUserId()\n        .subscribe((occUserId) => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe((activeCartId) => (cartId = activeCartId))\n        .unsubscribe();\n      if (userId && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.SetDeliveryMode({\n            userId,\n            cartId,\n            selectedModeId: mode,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Verifies the address\n   * @param address : the address to be verified\n   */\n  verifyAddress(address: Address): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.userIdService\n        .getUserId()\n        .subscribe((occUserId) => (userId = occUserId))\n        .unsubscribe();\n      if (userId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.VerifyAddress({\n            userId,\n            address,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Set delivery address\n   * @param address : The address to be set\n   */\n  setDeliveryAddress(address: Address): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.userIdService\n        .getUserId()\n        .subscribe((occUserId) => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe((activeCartId) => (cartId = activeCartId))\n        .unsubscribe();\n      if (cartId && userId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.SetDeliveryAddress({\n            userId,\n            cartId,\n            address: address,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Clear address verification results\n   */\n  clearAddressVerificationResults(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ClearAddressVerificationResults()\n    );\n  }\n\n  /**\n   * Clear address already setup in last checkout process\n   */\n  clearCheckoutDeliveryAddress(): void {\n    let userId;\n    this.userIdService\n      .getUserId()\n      .subscribe((occUserId) => (userId = occUserId))\n      .unsubscribe();\n\n    let cartId;\n    this.activeCartService\n      .getActiveCartId()\n      .subscribe((activeCartId) => (cartId = activeCartId))\n      .unsubscribe();\n    if (userId && cartId) {\n      this.checkoutStore.dispatch(\n        new CheckoutActions.ClearCheckoutDeliveryAddress({\n          userId,\n          cartId,\n        })\n      );\n    }\n  }\n\n  /**\n   * Clear selected delivery mode setup in last checkout process\n   */\n  clearCheckoutDeliveryMode(): void {\n    let userId;\n    this.userIdService\n      .getUserId()\n      .subscribe((occUserId) => (userId = occUserId))\n      .unsubscribe();\n\n    let cartId;\n    this.activeCartService\n      .getActiveCartId()\n      .subscribe((activeCartId) => (cartId = activeCartId))\n      .unsubscribe();\n    if (userId && cartId) {\n      this.checkoutStore.dispatch(\n        new CheckoutActions.ClearCheckoutDeliveryMode({\n          userId,\n          cartId,\n        })\n      );\n    }\n  }\n\n  /**\n   * Clear address and delivery mode already setup in last checkout process\n   */\n  clearCheckoutDeliveryDetails(): void {\n    this.clearCheckoutDeliveryAddress();\n    this.clearCheckoutDeliveryMode();\n    this.clearCheckoutDeliveryModes();\n  }\n\n  protected actionAllowed(): boolean {\n    let userId;\n    this.userIdService\n      .getUserId()\n      .subscribe((occUserId) => (userId = occUserId))\n      .unsubscribe();\n    return (\n      (userId && userId !== OCC_USER_ID_ANONYMOUS) ||\n      this.activeCartService.isGuestCart()\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { ActiveCartService } from '../../cart/facade/active-cart.service';\nimport { CardType, PaymentDetails } from '../../model/cart.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { getProcessStateFactory } from '../../process/store/selectors/process-group.selectors';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { CheckoutActions } from '../store/actions/index';\nimport {\n  SET_PAYMENT_DETAILS_PROCESS_ID,\n  StateWithCheckout,\n} from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutPaymentService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout | StateWithProcess<void>>,\n    protected activeCartService: ActiveCartService,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Get card types\n   */\n  getCardTypes(): Observable<CardType[]> {\n    return this.checkoutStore.pipe(select(CheckoutSelectors.getAllCardTypes));\n  }\n\n  /**\n   * Get payment details\n   */\n  getPaymentDetails(): Observable<PaymentDetails> {\n    return this.checkoutStore.pipe(select(CheckoutSelectors.getPaymentDetails));\n  }\n\n  /**\n   * Get status about set Payment Details process\n   */\n  getSetPaymentDetailsResultProcess(): Observable<LoaderState<void>> {\n    return this.checkoutStore.pipe(\n      select(getProcessStateFactory(SET_PAYMENT_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Clear info about process of setting Payment Details\n   */\n  resetSetPaymentDetailsProcess(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ResetSetPaymentDetailsProcess()\n    );\n  }\n\n  /**\n   * Load the supported card types\n   */\n  loadSupportedCardTypes(): void {\n    this.checkoutStore.dispatch(new CheckoutActions.LoadCardTypes());\n  }\n\n  /**\n   * Create payment details using the given paymentDetails param\n   * @param paymentDetails: the PaymentDetails to be created\n   */\n  createPaymentDetails(paymentDetails: PaymentDetails): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.userIdService\n        .getUserId()\n        .subscribe((occUserId) => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe((activeCartId) => (cartId = activeCartId))\n        .unsubscribe();\n\n      if (userId && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.CreatePaymentDetails({\n            userId,\n            cartId,\n            paymentDetails,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Set payment details\n   * @param paymentDetails : the PaymentDetails to be set\n   */\n  setPaymentDetails(paymentDetails: PaymentDetails): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.userIdService\n        .getUserId()\n        .subscribe((occUserId) => (userId = occUserId))\n        .unsubscribe();\n\n      let cart;\n      this.activeCartService\n        .getActive()\n        .subscribe((activeCart) => (cart = activeCart))\n        .unsubscribe();\n      if (userId && cart) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.SetPaymentDetails({\n            userId,\n            cartId: cart.code,\n            paymentDetails: paymentDetails,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Sets payment loading to true without having the flicker issue (GH-3102)\n   */\n  paymentProcessSuccess() {\n    this.checkoutStore.dispatch(new CheckoutActions.PaymentProcessSuccess());\n  }\n\n  protected actionAllowed(): boolean {\n    let userId;\n    this.userIdService\n      .getUserId()\n      .subscribe((occUserId) => (userId = occUserId))\n      .unsubscribe();\n    return (\n      (userId && userId !== OCC_USER_ID_ANONYMOUS) ||\n      this.activeCartService.isGuestCart()\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { ActiveCartService } from '../../cart/facade/active-cart.service';\nimport { Order } from '../../model/order.model';\nimport {\n  ORDER_TYPE,\n  ReplenishmentOrder,\n  ScheduleReplenishmentForm,\n} from '../../model/replenishment-order.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process-group.selectors';\nimport { CheckoutActions } from '../store/actions/index';\nimport {\n  PLACED_ORDER_PROCESS_ID,\n  StateWithCheckout,\n} from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout | StateWithProcess<void>>,\n    protected activeCartService: ActiveCartService,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Places an order\n   */\n  placeOrder(termsChecked: boolean): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.userIdService\n        .getUserId()\n        .subscribe((occUserId) => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe((activeCartId) => (cartId = activeCartId))\n        .unsubscribe();\n\n      if (userId && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.PlaceOrder({\n            userId,\n            cartId,\n            termsChecked,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Schedule a replenishment order\n   */\n  scheduleReplenishmentOrder(\n    scheduleReplenishmentForm: ScheduleReplenishmentForm,\n    termsChecked: boolean\n  ): void {\n    let cartId;\n\n    this.activeCartService\n      .getActiveCartId()\n      .pipe(take(1))\n      .subscribe((activeCartId) => (cartId = activeCartId));\n\n    this.userIdService.invokeWithUserId((userId) => {\n      if (\n        Boolean(cartId) &&\n        Boolean(userId) &&\n        userId !== OCC_USER_ID_ANONYMOUS\n      ) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.ScheduleReplenishmentOrder({\n            cartId,\n            scheduleReplenishmentForm,\n            termsChecked,\n            userId,\n          })\n        );\n      }\n    });\n  }\n\n  /**\n   * Returns the place or schedule replenishment order's loading flag\n   */\n  getPlaceOrderLoading(): Observable<boolean> {\n    return this.checkoutStore.pipe(\n      select(getProcessLoadingFactory(PLACED_ORDER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the place or schedule replenishment order's success flag\n   */\n  getPlaceOrderSuccess(): Observable<boolean> {\n    return this.checkoutStore.pipe(\n      select(getProcessSuccessFactory(PLACED_ORDER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the place or schedule replenishment order's error flag\n   */\n  getPlaceOrderError(): Observable<boolean> {\n    return this.checkoutStore.pipe(\n      select(getProcessErrorFactory(PLACED_ORDER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the place or schedule replenishment order's processing state\n   */\n  clearPlaceOrderState(): void {\n    this.checkoutStore.dispatch(new CheckoutActions.ClearPlaceOrder());\n  }\n\n  /**\n   * Clear checkout data\n   */\n  clearCheckoutData(): void {\n    this.checkoutStore.dispatch(new CheckoutActions.ClearCheckoutData());\n  }\n\n  /**\n   * Clear checkout step\n   * @param stepNumber : the step number to be cleared\n   */\n  clearCheckoutStep(stepNumber: number): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ClearCheckoutStep(stepNumber)\n    );\n  }\n\n  /**\n   * Load checkout details data\n   * @param cartId : string Cart ID of loaded cart\n   */\n  loadCheckoutDetails(cartId: string) {\n    let userId;\n    this.userIdService\n      .getUserId()\n      .subscribe((occUserId) => (userId = occUserId))\n      .unsubscribe();\n    if (userId) {\n      this.checkoutStore.dispatch(\n        new CheckoutActions.LoadCheckoutDetails({\n          userId,\n          cartId,\n        })\n      );\n    }\n  }\n\n  /**\n   * Get status of checkout details loaded\n   */\n  getCheckoutDetailsLoaded(): Observable<boolean> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getCheckoutDetailsLoaded)\n    );\n  }\n\n  /**\n   * Get order details\n   */\n  getOrderDetails(): Observable<Order | ReplenishmentOrder> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getCheckoutOrderDetails)\n    );\n  }\n\n  /**\n   * Set checkout order type\n   * @param orderType : an enum of types of order we are placing\n   */\n  setOrderType(orderType: ORDER_TYPE): void {\n    this.checkoutStore.dispatch(new CheckoutActions.SetOrderType(orderType));\n  }\n\n  /**\n   * Get current checkout order type\n   */\n  getCurrentOrderType(): Observable<ORDER_TYPE> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getSelectedOrderType)\n    );\n  }\n\n  protected actionAllowed(): boolean {\n    let userId;\n    this.userIdService\n      .getUserId()\n      .subscribe((occUserId) => (userId = occUserId))\n      .unsubscribe();\n    return (\n      (userId && userId !== OCC_USER_ID_ANONYMOUS) ||\n      this.activeCartService.isGuestCart()\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, Observable } from 'rxjs';\nimport {\n  map,\n  pluck,\n  shareReplay,\n  take,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { ActiveCartService } from '../../cart/facade/active-cart.service';\nimport { B2BPaymentTypeEnum, PaymentType } from '../../model/cart.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { getProcessStateFactory } from '../../process/store/selectors/process-group.selectors';\nimport { CheckoutActions } from '../store/actions/index';\nimport {\n  GET_PAYMENT_TYPES_PROCESS_ID,\n  StateWithCheckout,\n} from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class PaymentTypeService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout | StateWithProcess<void>>,\n    protected activeCartService: ActiveCartService,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Get payment types\n   */\n  getPaymentTypes(): Observable<PaymentType[]> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getAllPaymentTypes),\n      withLatestFrom(\n        this.checkoutStore.pipe(\n          select(getProcessStateFactory(GET_PAYMENT_TYPES_PROCESS_ID))\n        )\n      ),\n      tap(([_, loadingState]) => {\n        if (\n          !(loadingState.loading || loadingState.success || loadingState.error)\n        ) {\n          this.loadPaymentTypes();\n        }\n      }),\n      pluck(0),\n      shareReplay({ bufferSize: 1, refCount: true })\n    );\n  }\n\n  /**\n   * Load the supported payment types\n   */\n  loadPaymentTypes(): void {\n    this.checkoutStore.dispatch(new CheckoutActions.LoadPaymentTypes());\n  }\n\n  /**\n   * Set payment type to cart\n   * @param typeCode\n   * @param poNumber : purchase order number\n   */\n  setPaymentType(typeCode: string, poNumber?: string): void {\n    let cartId;\n    this.activeCartService\n      .getActiveCartId()\n      .pipe(take(1))\n      .subscribe((activeCartId) => (cartId = activeCartId));\n\n    this.userIdService.invokeWithUserId((userId) => {\n      if (userId && userId !== OCC_USER_ID_ANONYMOUS && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.SetPaymentType({\n            userId: userId,\n            cartId: cartId,\n            typeCode: typeCode,\n            poNumber: poNumber,\n          })\n        );\n      }\n    });\n  }\n\n  /**\n   * Get the selected payment type\n   */\n  getSelectedPaymentType(): Observable<string> {\n    return combineLatest([\n      this.activeCartService.getActive(),\n      this.checkoutStore.pipe(select(CheckoutSelectors.getSelectedPaymentType)),\n    ]).pipe(\n      tap(([cart, selected]) => {\n        if (selected === undefined) {\n          // in b2b, cart always has paymentType (default value 'CARD')\n          if (cart && cart.paymentType) {\n            this.checkoutStore.dispatch(\n              new CheckoutActions.SetPaymentTypeSuccess(cart)\n            );\n          }\n        }\n      }),\n      map(([, selected]) => selected)\n    );\n  }\n\n  /**\n   * Get whether the selected payment type is \"ACCOUNT\" payment\n   */\n  isAccountPayment(): Observable<boolean> {\n    return this.getSelectedPaymentType().pipe(\n      map((selected) => selected === B2BPaymentTypeEnum.ACCOUNT_PAYMENT)\n    );\n  }\n\n  /**\n   * Get PO Number\n   */\n  getPoNumber(): Observable<string> {\n    return combineLatest([\n      this.activeCartService.getActive(),\n      this.checkoutStore.pipe(select(CheckoutSelectors.getPoNumer)),\n    ]).pipe(\n      tap(([cart, po]) => {\n        if (po === undefined && cart && cart.purchaseOrderNumber) {\n          this.checkoutStore.dispatch(\n            new CheckoutActions.SetPaymentTypeSuccess(cart)\n          );\n        }\n      }),\n      map(([_, po]) => po)\n    );\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport {\n  CheckoutReplenishmentOrderAdapter,\n  REPLENISHMENT_ORDER_FORM_SERIALIZER,\n  REPLENISHMENT_ORDER_NORMALIZER,\n} from '../../../checkout/index';\nimport {\n  ReplenishmentOrder,\n  ScheduleReplenishmentForm,\n} from '../../../model/replenishment-order.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCheckoutReplenishmentOrderAdapter\n  implements CheckoutReplenishmentOrderAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  scheduleReplenishmentOrder(\n    cartId: string,\n    scheduleReplenishmentForm: ScheduleReplenishmentForm,\n    termsChecked: boolean,\n    userId: string\n  ): Observable<ReplenishmentOrder> {\n    scheduleReplenishmentForm = this.converter.convert(\n      scheduleReplenishmentForm,\n      REPLENISHMENT_ORDER_FORM_SERIALIZER\n    );\n\n    const headers = new HttpHeaders().set('Content-Type', 'application/json');\n\n    const params = new HttpParams()\n      .set('cartId', cartId)\n      .set('termsChecked', termsChecked.toString());\n\n    return this.http\n      .post(\n        this.occEndpoints.getUrl('scheduleReplenishmentOrder', {\n          userId,\n        }),\n        scheduleReplenishmentForm,\n        { headers, params }\n      )\n      .pipe(this.converter.pipeable(REPLENISHMENT_ORDER_NORMALIZER));\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CheckoutAdapter } from '../../../checkout/connectors/checkout/checkout.adapter';\nimport { ORDER_NORMALIZER } from '../../../checkout/connectors/checkout/converters';\nimport { CheckoutDetails } from '../../../checkout/models/checkout.model';\nimport { Order } from '../../../model/order.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\nimport { OCC_USER_ID_ANONYMOUS } from '../../utils/occ-constants';\n\n// To be changed to a more optimised params after ticket: C3PO-1076\nconst CHECKOUT_PARAMS = 'deliveryAddress(FULL),deliveryMode,paymentInfo(FULL)';\nconst CARTS_ENDPOINT = '/carts/';\n\n@Injectable()\nexport class OccCheckoutAdapter implements CheckoutAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getEndpoint(userId: string, subEndpoint: string): string {\n    const orderEndpoint = 'users/' + userId + subEndpoint;\n    return this.occEndpoints.getEndpoint(orderEndpoint);\n  }\n\n  public placeOrder(\n    userId: string,\n    cartId: string,\n    termsChecked: boolean\n  ): Observable<Order> {\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n    const params = new HttpParams()\n      .set('cartId', cartId)\n      .set('termsChecked', termsChecked.toString());\n\n    return this.http\n      .post<Occ.Order>(\n        this.occEndpoints.getUrl('placeOrder', { userId }),\n        {},\n        { headers, params }\n      )\n      .pipe(this.converter.pipeable(ORDER_NORMALIZER));\n  }\n\n  loadCheckoutDetails(\n    userId: string,\n    cartId: string\n  ): Observable<CheckoutDetails> {\n    const url = this.getEndpoint(userId, CARTS_ENDPOINT) + cartId;\n    const params = new HttpParams({\n      fromString: `fields=${CHECKOUT_PARAMS}`,\n    });\n    return this.http.get<CheckoutDetails>(url, { params });\n  }\n\n  clearCheckoutDeliveryAddress(\n    userId: string,\n    cartId: string\n  ): Observable<any> {\n    const url = `${this.getEndpoint(\n      userId,\n      CARTS_ENDPOINT\n    )}${cartId}/addresses/delivery`;\n    return this.http.delete<any>(url);\n  }\n\n  clearCheckoutDeliveryMode(userId: string, cartId: string): Observable<any> {\n    const url = `${this.getEndpoint(\n      userId,\n      CARTS_ENDPOINT\n    )}${cartId}/deliverymode`;\n    return this.http.delete<any>(url);\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { CheckoutAdapter } from '../../../checkout/connectors/checkout/checkout.adapter';\nimport { ORDER_NORMALIZER } from '../../../checkout/connectors/checkout/converters';\nimport { CheckoutCostCenterAdapter } from '../../../checkout/connectors/cost-center/checkout-cost-center.adapter';\nimport { CheckoutDeliveryAdapter } from '../../../checkout/connectors/delivery/checkout-delivery.adapter';\nimport {\n  CheckoutReplenishmentOrderAdapter,\n  REPLENISHMENT_ORDER_FORM_SERIALIZER,\n  REPLENISHMENT_ORDER_NORMALIZER,\n} from '../../../checkout/connectors/index';\nimport { PaymentTypeAdapter } from '../../../checkout/connectors/payment-type/payment-type.adapter';\nimport { CheckoutPaymentAdapter } from '../../../checkout/connectors/payment/checkout-payment.adapter';\nimport { provideDefaultConfig } from '../../../config/config-providers';\nimport {\n  OccOrderNormalizer,\n  OccReplenishmentOrderFormSerializer,\n  OccReplenishmentOrderNormalizer,\n} from './converters/index';\nimport { defaultOccCheckoutConfig } from './default-occ-checkout-config';\nimport { OccCheckoutCostCenterAdapter } from './occ-checkout-cost-center.adapter';\nimport { OccCheckoutDeliveryAdapter } from './occ-checkout-delivery.adapter';\nimport { OccCheckoutPaymentTypeAdapter } from './occ-checkout-payment-type.adapter';\nimport { OccCheckoutPaymentAdapter } from './occ-checkout-payment.adapter';\nimport { OccCheckoutReplenishmentOrderAdapter } from './occ-checkout-replenishment-order.adapter';\nimport { OccCheckoutAdapter } from './occ-checkout.adapter';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccCheckoutConfig),\n    {\n      provide: CheckoutAdapter,\n      useClass: OccCheckoutAdapter,\n    },\n    { provide: ORDER_NORMALIZER, useExisting: OccOrderNormalizer, multi: true },\n    {\n      provide: CheckoutDeliveryAdapter,\n      useClass: OccCheckoutDeliveryAdapter,\n    },\n    {\n      provide: CheckoutPaymentAdapter,\n      useClass: OccCheckoutPaymentAdapter,\n    },\n    {\n      provide: PaymentTypeAdapter,\n      useClass: OccCheckoutPaymentTypeAdapter,\n    },\n    {\n      provide: CheckoutCostCenterAdapter,\n      useClass: OccCheckoutCostCenterAdapter,\n    },\n    {\n      provide: CheckoutReplenishmentOrderAdapter,\n      useClass: OccCheckoutReplenishmentOrderAdapter,\n    },\n    {\n      provide: REPLENISHMENT_ORDER_NORMALIZER,\n      useExisting: OccReplenishmentOrderNormalizer,\n      multi: true,\n    },\n    {\n      provide: REPLENISHMENT_ORDER_FORM_SERIALIZER,\n      useExisting: OccReplenishmentOrderFormSerializer,\n      multi: true,\n    },\n  ],\n})\nexport class CheckoutOccModule {}\n","import { Observable } from 'rxjs';\nimport { PageContext } from '../../../routing/models/page-context.model';\nimport { CmsStructureModel } from '../../model/page.model';\n\n/**\n * Abstract class that can be used to implement custom loader logic\n * in order to load CMS structure from third-party CMS system.\n */\nexport abstract class CmsPageAdapter {\n  /**\n   * Abstract method must be used to load the page structure for a given `PageContext`.\n   * The page can be loaded from alternative sources, as long as the structure\n   * converts to the `CmsStructureModel`.\n   *\n   * @param pageContext The `PageContext` holding the page Id.\n   */\n  abstract load(pageContext: PageContext): Observable<CmsStructureModel>;\n}\n","import { InjectionToken } from '@angular/core';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const CMS_COMPONENT_NORMALIZER = new InjectionToken<\n  Converter<any, CmsComponent>\n>('CmsComponentNormalizer');\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport { CmsComponentAdapter } from '../../../cms/connectors/component/cms-component.adapter';\nimport { CMS_COMPONENT_NORMALIZER } from '../../../cms/connectors/component/converters';\nimport { CmsComponent, PageType } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccCmsComponentAdapter implements CmsComponentAdapter {\n  protected headers = new HttpHeaders().set('Content-Type', 'application/json');\n\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load<T extends CmsComponent>(\n    id: string,\n    pageContext: PageContext\n  ): Observable<T> {\n    return this.http\n      .get<T>(this.getComponentEndPoint(id, pageContext), {\n        headers: this.headers,\n      })\n      .pipe(this.converter.pipeable<any, T>(CMS_COMPONENT_NORMALIZER));\n  }\n\n  findComponentsByIds(\n    ids: string[],\n    pageContext: PageContext,\n    fields = 'DEFAULT',\n    currentPage = 0,\n    pageSize = ids.length,\n    sort?: string\n  ): Observable<CmsComponent[]> {\n    const requestParams = {\n      ...this.getContextParams(pageContext),\n      ...this.getPaginationParams(currentPage, pageSize, sort),\n    };\n\n    requestParams['componentIds'] = ids.toString();\n\n    return this.http\n      .get<Occ.ComponentList>(\n        this.getComponentsEndpoint(requestParams, fields),\n        {\n          headers: this.headers,\n        }\n      )\n      .pipe(\n        pluck('component'),\n        this.converter.pipeableMany(CMS_COMPONENT_NORMALIZER)\n      );\n  }\n\n  protected getComponentEndPoint(id: string, pageContext: PageContext): string {\n    return this.occEndpoints.getUrl(\n      'component',\n      { id },\n      this.getContextParams(pageContext)\n    );\n  }\n\n  protected getComponentsEndpoint(requestParams: any, fields: string): string {\n    return this.occEndpoints.getUrl(\n      'components',\n      {},\n      { fields, ...requestParams }\n    );\n  }\n\n  protected getPaginationParams(\n    currentPage?: number,\n    pageSize?: number,\n    sort?: string\n  ): { [key: string]: string } {\n    const requestParams = {};\n    if (currentPage !== undefined) {\n      requestParams['currentPage'] = currentPage.toString();\n    }\n    if (pageSize !== undefined) {\n      requestParams['pageSize'] = pageSize.toString();\n    }\n    if (sort !== undefined) {\n      requestParams['sort'] = sort;\n    }\n\n    return requestParams;\n  }\n\n  protected getContextParams(\n    pageContext: PageContext\n  ): { [key: string]: string } {\n    let requestParams = {};\n    switch (pageContext.type) {\n      case PageType.PRODUCT_PAGE: {\n        requestParams = { productCode: pageContext.id };\n        break;\n      }\n      case PageType.CATEGORY_PAGE: {\n        requestParams = { categoryCode: pageContext.id };\n        break;\n      }\n      case PageType.CATALOG_PAGE: {\n        requestParams = { catalogCode: pageContext.id };\n        break;\n      }\n    }\n\n    return requestParams;\n  }\n}\n","import { Injectable, StaticProvider } from '@angular/core';\nimport { Route } from '@angular/router';\nimport { Config } from '../../config/config-tokens';\nimport { OccConfig } from '../../occ/config/occ-config';\n\nexport interface StandardCmsComponentConfig {\n  CMSSiteContextComponent?: CmsComponentMapping;\n  CMSLinkComponent?: CmsComponentMapping;\n  SimpleResponsiveBannerComponent?: CmsComponentMapping;\n  SimpleBannerComponent?: CmsComponentMapping;\n  BannerComponent?: CmsComponentMapping;\n  CMSParagraphComponent?: CmsComponentMapping;\n  BreadcrumbComponent?: CmsComponentMapping;\n  NavigationComponent?: CmsComponentMapping;\n  FooterNavigationComponent?: CmsComponentMapping;\n  CategoryNavigationComponent?: CmsComponentMapping;\n  ProductAddToCartComponent?: CmsComponentMapping;\n  MiniCartComponent?: CmsComponentMapping;\n  ProductCarouselComponent?: CmsComponentMapping;\n  SearchBoxComponent?: CmsComponentMapping;\n  ProductReferencesComponent?: CmsComponentMapping;\n  CMSTabParagraphComponent?: CmsComponentMapping;\n  LoginComponent?: CmsComponentMapping;\n}\n\nexport interface JspIncludeCmsComponentConfig {\n  AccountAddressBookComponent?: CmsComponentMapping;\n  ForgotPasswordComponent?: CmsComponentMapping;\n  ResetPasswordComponent?: CmsComponentMapping;\n  ProductDetailsTabComponent?: CmsComponentMapping;\n  ProductSpecsTabComponent?: CmsComponentMapping;\n  ProductReviewsTabComponent?: CmsComponentMapping;\n}\n\nexport const JSP_INCLUDE_CMS_COMPONENT_TYPE = 'JspIncludeComponent';\nexport const CMS_FLEX_COMPONENT_TYPE = 'CMSFlexComponent';\n\n/**\n * Configuration of the CMS component's child routes\n */\nexport interface CmsComponentChildRoutesConfig {\n  /**\n   * Route `data` property to apply on the parent (host) route of the CMS child routes.\n   */\n  parent?: Pick<Route, 'data'>;\n\n  /**\n   * Child routes defined by the existence of the CMS component on the page.\n   */\n  children?: Route[];\n}\n\nexport interface CmsComponentMapping {\n  component?: any;\n  providers?: StaticProvider[];\n  childRoutes?: Route[] | CmsComponentChildRoutesConfig;\n  disableSSR?: boolean;\n  i18nKeys?: string[];\n  guards?: any[];\n\n  /**\n   * DeferLoading can be specified globally, but also per component.\n   * Some components require direct loading while it's not initially\n   * in the viewport.\n   */\n  deferLoading?: DeferLoadingStrategy;\n}\n\n/** Strategy to control the loading strategy of DOM elements. */\nexport enum DeferLoadingStrategy {\n  /** Defers loading of DOM elements until element is near/in the users view port */\n  DEFER = 'DEFERRED-LOADING',\n  /** Renders the DOM instantly without being concerned with the view port */\n  INSTANT = 'INSTANT-LOADING',\n}\n\nexport interface CMSComponentConfig\n  extends StandardCmsComponentConfig,\n    JspIncludeCmsComponentConfig {\n  [componentType: string]: CmsComponentMapping;\n}\n\nexport interface FeatureModuleConfig {\n  /**\n   * Lazy resolved feature module\n   */\n  module?: () => Promise<any>;\n  /**\n   * Lazy resolved dependency modules\n   */\n  dependencies?: (() => Promise<any>)[];\n  /**\n   * Cms components covered by this feature\n   */\n  cmsComponents?: string[];\n}\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class CmsConfig extends OccConfig {\n  featureModules?: { [featureName: string]: FeatureModuleConfig };\n  cmsComponents?: CMSComponentConfig;\n}\n","import { Injectable } from '@angular/core';\nimport {\n  CMS_FLEX_COMPONENT_TYPE,\n  JSP_INCLUDE_CMS_COMPONENT_TYPE,\n} from '../../../../cms/config/cms-config';\nimport { ContentSlotComponentData } from '../../../../cms/model/content-slot-component-data.model';\nimport { ContentSlotData } from '../../../../cms/model/content-slot-data.model';\nimport { CmsStructureModel, Page } from '../../../../cms/model/page.model';\nimport { Converter } from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccCmsPageNormalizer\n  implements Converter<Occ.CMSPage, CmsStructureModel> {\n  convert(\n    source: Occ.CMSPage,\n    target: CmsStructureModel = {}\n  ): CmsStructureModel {\n    this.normalizePageData(source, target);\n    this.normalizePageSlotData(source, target);\n    this.normalizePageComponentData(source, target);\n    this.normalizeComponentData(source, target);\n    return target;\n  }\n\n  /**\n   * Converts the OCC cms page model to the `Page` in the `CmsStructureModel`.\n   */\n  protected normalizePageData(\n    source: Occ.CMSPage,\n    target: CmsStructureModel\n  ): void {\n    if (!source) {\n      return;\n    }\n    const page: Page = {};\n\n    if (source.name) {\n      page.name = source.name;\n    }\n    if (source.typeCode) {\n      page.type = source.typeCode;\n    }\n    if (source.label) {\n      page.label = source.label;\n    }\n    if (source.template) {\n      page.template = source.template;\n    }\n    if (source.uid) {\n      page.pageId = source.uid;\n    }\n    if (source.title) {\n      page.title = source.title;\n    }\n    if (source.properties) {\n      page.properties = source.properties;\n    }\n\n    target.page = page;\n  }\n\n  /**\n   * Adds a ContentSlotData for each page slot in the `CmsStructureModel`.\n   */\n  protected normalizePageSlotData(\n    source: Occ.CMSPage,\n    target: CmsStructureModel\n  ): void {\n    if (!source?.contentSlots) {\n      return;\n    }\n    if (!Array.isArray(source.contentSlots.contentSlot)) {\n      source.contentSlots.contentSlot = [source.contentSlots.contentSlot];\n    }\n    target.page.slots = {};\n    for (const slot of source.contentSlots.contentSlot) {\n      target.page.slots[slot.position] = {} as ContentSlotData;\n      if (slot.properties) {\n        target.page.slots[slot.position].properties = slot.properties;\n      }\n    }\n  }\n\n  /**\n   * Registers the `ContentSlotComponentData` for each component.\n   */\n  protected normalizePageComponentData(\n    source: Occ.CMSPage,\n    target: CmsStructureModel\n  ): void {\n    if (!source?.contentSlots?.contentSlot) {\n      return;\n    }\n    for (const slot of source.contentSlots.contentSlot) {\n      if (Array.isArray(slot.components?.component)) {\n        for (const component of slot.components.component) {\n          const comp: ContentSlotComponentData = {\n            uid: component.uid,\n            typeCode: component.typeCode,\n          };\n          if (component.properties) {\n            comp.properties = component.properties;\n          }\n\n          if (component.typeCode === CMS_FLEX_COMPONENT_TYPE) {\n            comp.flexType = component.flexType;\n          } else if (component.typeCode === JSP_INCLUDE_CMS_COMPONENT_TYPE) {\n            comp.flexType = component.uid;\n          } else {\n            comp.flexType = component.typeCode;\n          }\n          if (!target.page.slots[slot.position].components) {\n            target.page.slots[slot.position].components = [];\n          }\n          target.page.slots[slot.position].components.push(comp);\n        }\n      }\n    }\n  }\n\n  /**\n   * Adds the actual component data whenever available in the CMS page data.\n   *\n   * If the data is not populated in this payload, it is loaded separately\n   * (`OccCmsComponentAdapter`).\n   */\n  protected normalizeComponentData(\n    source: Occ.CMSPage,\n    target: CmsStructureModel\n  ): void {\n    if (!source?.contentSlots?.contentSlot) {\n      return;\n    }\n\n    for (const slot of source.contentSlots.contentSlot) {\n      if (Array.isArray(slot.components?.component)) {\n        for (const component of slot.components.component as any) {\n          // while we're hoping to get this right from the backend api,\n          // the OCC api stills seems out of sync with the right model.\n          if (component.modifiedtime) {\n            component.modifiedTime = component.modifiedtime;\n            delete component.modifiedtime;\n          }\n\n          // we don't put properties into component state\n          if (component.properties) {\n            component.properties = undefined;\n          }\n          if (!target.components) {\n            target.components = [];\n          }\n          target.components.push(component);\n        }\n      }\n    }\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { CmsStructureModel } from '../../model/page.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const CMS_PAGE_NORMALIZER = new InjectionToken<\n  Converter<any, CmsStructureModel>\n>('CmsPageNormalizer');\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CmsPageAdapter } from '../../../cms/connectors/page/cms-page.adapter';\nimport { CMS_PAGE_NORMALIZER } from '../../../cms/connectors/page/converters';\nimport { CmsStructureModel } from '../../../cms/model/page.model';\nimport { PageType } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccCmsPageAdapter implements CmsPageAdapter {\n  protected headers = new HttpHeaders().set('Content-Type', 'application/json');\n\n  constructor(\n    private http: HttpClient,\n    private occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(\n    pageContext: PageContext,\n    fields?: string\n  ): Observable<CmsStructureModel> {\n    // load page by Id\n    if (pageContext.type === undefined) {\n      return this.http\n        .get(\n          this.occEndpoints.getUrl(\n            'page',\n            {\n              id: pageContext.id,\n            },\n            { fields: fields ? fields : 'DEFAULT' }\n          ),\n          {\n            headers: this.headers,\n          }\n        )\n        .pipe(this.converter.pipeable(CMS_PAGE_NORMALIZER));\n    }\n\n    // load page by PageContext\n    const httpParams = this.getPagesRequestParams(pageContext);\n    return this.http\n      .get(this.getPagesEndpoint(httpParams, fields), {\n        headers: this.headers,\n      })\n      .pipe(this.converter.pipeable(CMS_PAGE_NORMALIZER));\n  }\n\n  protected getPagesEndpoint(\n    params: {\n      [key: string]: string;\n    },\n    fields?: string\n  ): string {\n    fields = fields ? fields : 'DEFAULT';\n    return this.occEndpoints.getUrl('pages', {}, { fields, ...params });\n  }\n\n  protected getPagesRequestParams(\n    pageContext: PageContext\n  ): { [key: string]: any } {\n    let httpParams = {};\n\n    // smartedit preview page is loaded by previewToken which added by interceptor\n    if (pageContext.id !== 'smartedit-preview') {\n      httpParams = { pageType: pageContext.type };\n\n      if (pageContext.type === PageType.CONTENT_PAGE) {\n        httpParams['pageLabelOrId'] = pageContext.id;\n      } else {\n        httpParams['code'] = pageContext.id;\n      }\n    }\n    return httpParams;\n  }\n}\n","import { Observable } from 'rxjs';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing/models/page-context.model';\n\nexport abstract class CmsComponentAdapter {\n  /**\n   * Abstract method must be used to load the component for a given `id` and `PageContext`.\n   * The component can be loaded from alternative backend, as long as the structure\n   * converts to the `CmsStructureModel`.\n   *\n   * @param pageContext The `PageContext` holding the page Id.\n   */\n  abstract load<T extends CmsComponent>(\n    id: string,\n    pageContext: PageContext,\n    fields?: string\n  ): Observable<T>;\n\n  abstract findComponentsByIds(\n    ids: string[],\n    pageContext: PageContext\n  ): Observable<CmsComponent[]>;\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { CmsPageAdapter } from '../../../cms/connectors/page/cms-page.adapter';\nimport { OccCmsComponentAdapter } from './occ-cms-component.adapter';\nimport { OccCmsPageNormalizer } from './converters/occ-cms-page-normalizer';\nimport { OccCmsPageAdapter } from './occ-cms-page.adapter';\nimport { CMS_PAGE_NORMALIZER } from '../../../cms/connectors/page/converters';\nimport { CmsComponentAdapter } from '../../../cms/connectors/component/cms-component.adapter';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    {\n      provide: CmsPageAdapter,\n      useClass: OccCmsPageAdapter,\n    },\n    {\n      provide: CMS_PAGE_NORMALIZER,\n      useExisting: OccCmsPageNormalizer,\n      multi: true,\n    },\n    {\n      provide: CmsComponentAdapter,\n      useClass: OccCmsComponentAdapter,\n    },\n  ],\n})\nexport class CmsOccModule {}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport { CMS_COMPONENT_NORMALIZER } from '../../../cms/connectors/component/converters';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccCmsComponentAdapter } from './occ-cms-component.adapter';\n\n/**\n * Before 1905, the OCC CMS component API required was using POST method\n * to load a (potentially large) number of components. With 1905, the endpoint\n * evaluated to use GET. Switching from POST to GET has been initially implemented\n * with the `legacy` flag, but from version 3.0 onwards, we're moving the\n * implementation to this optional Adapter.\n *\n * If you like to connect to a pre 1905 version, you can provide this adapter for the\n * `CmsComponentAdapter` injection token.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class LegacyOccCmsComponentAdapter extends OccCmsComponentAdapter {\n  findComponentsByIds(\n    ids: string[],\n    pageContext: PageContext,\n    fields = 'DEFAULT',\n    currentPage = 0,\n    pageSize = ids.length,\n    sort?: string\n  ): Observable<CmsComponent[]> {\n    const idList: Occ.ComponentIDList = { idList: ids };\n\n    const requestParams = {\n      ...this.getContextParams(pageContext),\n      ...this.getPaginationParams(currentPage, pageSize, sort),\n    };\n\n    return this.http\n      .post<Occ.ComponentList>(\n        this.getComponentsEndpoint(requestParams, fields),\n        idList,\n        {\n          headers: this.headers,\n        }\n      )\n      .pipe(\n        pluck('component'),\n        this.converter.pipeableMany(CMS_COMPONENT_NORMALIZER)\n      );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CostCenter } from '../../../../model/org-unit.model';\nimport { Converter } from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccCostCenterNormalizer\n  implements Converter<Occ.CostCenter, CostCenter> {\n  convert(source: Occ.CostCenter, target?: CostCenter): CostCenter {\n    if (target === undefined) {\n      target = {\n        ...(source as any),\n        active: this.normalizeBoolean(source.active),\n      };\n    }\n    return target;\n  }\n\n  /**\n   * Returns the boolean value for a string property that is supposed\n   * to be of type boolean.\n   */\n  protected normalizeBoolean(property: string | boolean): boolean {\n    return typeof property === 'string' ? property === 'true' : property;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CostCenter } from '../../../../model/org-unit.model';\nimport { Converter } from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccCostCenterSerializer\n  implements Converter<CostCenter, Occ.CostCenter> {\n  convert(source: CostCenter, target?: Occ.CostCenter): Occ.CostCenter {\n    if (target === undefined) {\n      target = {\n        ...(source as any),\n        activeFlag: source.active,\n      };\n      delete target.active;\n    }\n    return target;\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { CostCenter } from '../../../model/org-unit.model';\nimport { EntitiesModel } from '../../../model/misc.model';\n\nexport const COST_CENTER_NORMALIZER = new InjectionToken<\n  Converter<any, CostCenter>\n>('CostCenterNormalizer');\n\nexport const COST_CENTERS_NORMALIZER = new InjectionToken<\n  Converter<any, EntitiesModel<CostCenter>>\n>('CostCentersListNormalizer');\n\nexport const COST_CENTER_SERIALIZER = new InjectionToken<\n  Converter<CostCenter, any>\n>('CostCenterSerializer');\n","import { Injectable } from '@angular/core';\nimport { COST_CENTER_NORMALIZER } from '../../../../cost-center/connectors/cost-center/converters';\nimport { EntitiesModel } from '../../../../model/misc.model';\nimport { CostCenter } from '../../../../model/org-unit.model';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccCostCenterListNormalizer\n  implements Converter<Occ.CostCentersList, EntitiesModel<CostCenter>> {\n  constructor(private converter: ConverterService) {}\n\n  convert(\n    source: Occ.CostCentersList,\n    target?: EntitiesModel<CostCenter>\n  ): EntitiesModel<CostCenter> {\n    if (target === undefined) {\n      target = {\n        ...(source as any),\n        values: source.costCenters.map((costCenter) => ({\n          ...this.converter.convert(costCenter, COST_CENTER_NORMALIZER),\n        })),\n      };\n    }\n    return target;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class FeaturesConfig {\n  features?: {\n    [featureToggle: string]: string | boolean;\n  };\n}\n","import { FeaturesConfig } from '../config/features-config';\n\nfunction isFeatureConfig(config: any): config is FeaturesConfig {\n  return typeof config === 'object' && config.features;\n}\n\nfunction isInLevel(level, version) {\n  if (level === '*') {\n    return true;\n  }\n  const levelParts = level.split('.');\n  const versionParts = version.split('.');\n\n  for (let i = 0; i < versionParts.length; i++) {\n    const versionNumberPart = Number(versionParts[i]);\n    const levelNumberPart = Number(levelParts[i]) || 0;\n\n    if (versionNumberPart !== levelNumberPart) {\n      return levelNumberPart > versionNumberPart;\n    }\n  }\n  return true;\n}\n\nexport function isFeatureLevel(config: unknown, level: string): boolean {\n  if (isFeatureConfig(config)) {\n    return level[0] === '!'\n      ? !isInLevel(config.features.level, level.substr(1, level.length))\n      : isInLevel(config.features.level, level);\n  }\n}\n\nexport function isFeatureEnabled(config: unknown, feature: string): boolean {\n  if (isFeatureConfig(config)) {\n    const featureConfig =\n      feature[0] === '!'\n        ? config.features[feature.substr(1, feature.length)]\n        : config.features[feature];\n\n    const result =\n      typeof featureConfig === 'string'\n        ? isFeatureLevel(config, featureConfig)\n        : featureConfig;\n\n    return feature[0] === '!' ? !result : result;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { FeaturesConfig } from '../config/features-config';\nimport {\n  isFeatureEnabled,\n  isFeatureLevel,\n} from '../utils/feature-config-utils';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class FeatureConfigService {\n  constructor(protected config: FeaturesConfig) {}\n\n  isLevel(version: string): boolean {\n    return isFeatureLevel(this.config, version);\n  }\n\n  isEnabled(feature: string) {\n    return isFeatureEnabled(this.config, feature);\n  }\n}\n","import { Directive, Input, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { FeatureConfigService } from '../services/feature-config.service';\n\n@Directive({\n  selector: '[cxFeatureLevel]',\n})\nexport class FeatureLevelDirective {\n  constructor(\n    protected templateRef: TemplateRef<any>,\n    protected viewContainer: ViewContainerRef,\n    protected featureConfig: FeatureConfigService\n  ) {}\n\n  private hasView = false;\n\n  @Input() set cxFeatureLevel(level: string | number) {\n    if (this.featureConfig.isLevel(level.toString()) && !this.hasView) {\n      this.viewContainer.createEmbeddedView(this.templateRef);\n      this.hasView = true;\n    } else if (!this.featureConfig.isLevel(level.toString()) && this.hasView) {\n      this.viewContainer.clear();\n      this.hasView = false;\n    }\n  }\n}\n","import { Directive, Input, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { FeatureConfigService } from '../services/feature-config.service';\n\n@Directive({\n  selector: '[cxFeature]',\n})\nexport class FeatureDirective {\n  constructor(\n    protected templateRef: TemplateRef<any>,\n    protected viewContainer: ViewContainerRef,\n    protected featureConfig: FeatureConfigService\n  ) {}\n\n  private hasView = false;\n\n  @Input() set cxFeature(feature: string) {\n    if (this.featureConfig.isEnabled(feature) && !this.hasView) {\n      this.viewContainer.createEmbeddedView(this.templateRef);\n      this.hasView = true;\n    } else if (!this.featureConfig.isEnabled(feature) && this.hasView) {\n      this.viewContainer.clear();\n      this.hasView = false;\n    }\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { FeaturesConfig } from './config/features-config';\nimport { FeatureLevelDirective } from './directives/feature-level.directive';\nimport { FeatureDirective } from './directives/feature.directive';\nimport { provideDefaultConfig } from '../config/config-providers';\n\n@NgModule({\n  declarations: [FeatureLevelDirective, FeatureDirective],\n  exports: [FeatureLevelDirective, FeatureDirective],\n})\nexport class FeaturesConfigModule {\n  static forRoot(\n    defaultLevel?: string\n  ): ModuleWithProviders<FeaturesConfigModule> {\n    return {\n      ngModule: FeaturesConfigModule,\n      providers: [\n        provideDefaultConfig(<FeaturesConfig>{\n          features: {\n            level: defaultLevel || '*',\n          },\n        }),\n      ],\n    };\n  }\n}\n","import { Inject, Injectable, OnDestroy } from '@angular/core';\nimport { BehaviorSubject, Observable, Subscription, zip } from 'rxjs';\nimport { deepMerge } from '../utils/deep-merge';\nimport { isFeatureEnabled } from '../../features-config';\nimport {\n  Config,\n  ConfigChunk,\n  DefaultConfig,\n  DefaultConfigChunk,\n  RootConfig,\n} from '../config-tokens';\nimport { UnifiedInjector } from '../../lazy-loading/unified-injector';\nimport { skip, tap } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConfigurationService implements OnDestroy {\n  /**\n   * Will emit unified configuration when some ambient configuration will appear\n   *\n   * Ambient configuration can appear when we lazy load module with configuration\n   */\n  readonly unifiedConfig$: Observable<any>;\n\n  /**\n   * Global application configuration\n   */\n  readonly config: any;\n\n  private readonly ambientDefaultConfig: any = {};\n  private readonly ambientConfig: any = {};\n\n  private subscription: Subscription;\n\n  constructor(\n    @Inject(RootConfig) protected rootConfig: any,\n    @Inject(DefaultConfig) protected defaultConfig: any,\n    protected unifiedInjector: UnifiedInjector,\n    @Inject(Config) config: any\n  ) {\n    this.config = config;\n    this.unifiedConfig$ = new BehaviorSubject(config);\n\n    // We need to use subscription to propagate changes to the config from the beginning.\n    // It will be possible to make it lazy, when we drop this compatibility feature\n    // in the future.\n    this.subscription = this.feedUnifiedConfig().subscribe();\n  }\n\n  private feedUnifiedConfig(): Observable<any> {\n    const configChunks$: Observable<object[]> = this.unifiedInjector.get(\n      ConfigChunk,\n      []\n    );\n    const defaultConfigChunks$ = this.unifiedInjector.get(\n      DefaultConfigChunk,\n      []\n    );\n\n    return zip(configChunks$, defaultConfigChunks$).pipe(\n      // we don't need result from the root injector\n      skip(1),\n      tap(([configChunks, defaultConfigChunks]) =>\n        this.processConfig(configChunks, defaultConfigChunks)\n      )\n    );\n  }\n\n  private processConfig(configChunks: any[], defaultConfigChunks: any[]) {\n    if (defaultConfigChunks?.length) {\n      deepMerge(this.ambientDefaultConfig, ...defaultConfigChunks);\n    }\n    if (configChunks.length) {\n      deepMerge(this.ambientConfig, ...configChunks);\n    }\n\n    if (configChunks.length || defaultConfigChunks.length) {\n      this.emitUnifiedConfig();\n    }\n  }\n\n  private emitUnifiedConfig(): void {\n    const newConfig = deepMerge(\n      {},\n      this.defaultConfig,\n      this.ambientDefaultConfig,\n      this.ambientConfig,\n      this.rootConfig\n    );\n    (this.unifiedConfig$ as BehaviorSubject<any>).next(newConfig);\n\n    // compatibility mechanism, can be disabled with feature toggle\n    if (!isFeatureEnabled(this.config, 'disableConfigUpdates')) {\n      deepMerge(this.config, newConfig);\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.subscription) {\n      this.subscription.unsubscribe();\n    }\n    (this.unifiedConfig$ as BehaviorSubject<any>).complete();\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { provideConfig, provideConfigFactory } from './config-providers';\nimport { ConfigurationService } from './services/configuration.service';\n\n@NgModule({})\nexport class ConfigModule {\n  // To make sure ConfigurationService will be instantiated, we inject it into\n  // module constructor\n  constructor(_configurationService: ConfigurationService) {}\n\n  /**\n   * Import ConfigModule and contribute config to the global configuration\n   *\n   * To provide default configuration in libraries provideDefaultConfig should be used instead.\n   *\n   * @param config Config object to merge with the global configuration\n   */\n  static withConfig(config: object): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule,\n      providers: [provideConfig(config)],\n    };\n  }\n\n  /**\n   * Import ConfigModule and contribute config to the global configuration using factory function\n   *\n   * To provide default configuration in libraries provideDefaultConfigFactory should be used instead.\n   *\n   * @param configFactory Factory function that will generate configuration\n   * @param deps Optional dependencies to factory function\n   */\n  static withConfigFactory(\n    configFactory: Function,\n    deps?: any[]\n  ): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule,\n      providers: [provideConfigFactory(configFactory, deps)],\n    };\n  }\n\n  /**\n   * Module with providers, should be imported only once, if possible, at the root of the app.\n   *\n   * @param config\n   */\n  static forRoot(config: any = {}): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule,\n      providers: [provideConfig(config)],\n    };\n  }\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccCostCentersConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        getActiveCostCenters:\n          '/costcenters?fields=DEFAULT,unit(BASIC,addresses(DEFAULT))',\n      },\n    },\n  },\n};\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { ConfigModule } from '../../../config/config.module';\nimport {\n  COST_CENTERS_NORMALIZER,\n  COST_CENTER_NORMALIZER,\n  COST_CENTER_SERIALIZER,\n} from '../../../cost-center/connectors/cost-center/converters';\nimport { OccCostCenterListNormalizer } from './converters/occ-cost-center-list-normalizer';\nimport { OccCostCenterNormalizer } from './converters/occ-cost-center-normalizer';\nimport { OccCostCenterSerializer } from './converters/occ-cost-center-serializer';\nimport { defaultOccCostCentersConfig } from './default-occ-cost-centers-config';\n\n@NgModule({\n  imports: [CommonModule, ConfigModule.withConfig(defaultOccCostCentersConfig)],\n  providers: [\n    {\n      provide: COST_CENTERS_NORMALIZER,\n      useExisting: OccCostCenterListNormalizer,\n      multi: true,\n    },\n    {\n      provide: COST_CENTER_NORMALIZER,\n      useExisting: OccCostCenterNormalizer,\n      multi: true,\n    },\n    {\n      provide: COST_CENTER_SERIALIZER,\n      useExisting: OccCostCenterSerializer,\n      multi: true,\n    },\n  ],\n})\nexport class CostCenterOccModule {}\n","import { Injectable } from '@angular/core';\nimport { OccConfig } from '../../../config/occ-config';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { Converter } from '../../../../util/converter.service';\nimport { Product } from '../../../../model/product.model';\nimport { Images } from '../../../../model/image.model';\n\n@Injectable({ providedIn: 'root' })\nexport class ProductImageNormalizer implements Converter<Occ.Product, Product> {\n  constructor(protected config: OccConfig) {}\n\n  convert(source: Occ.Product, target?: Product): Product {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n    if (source.images) {\n      target.images = this.normalize(source.images);\n    }\n    return target;\n  }\n\n  /**\n   * @desc\n   * Creates the image structure we'd like to have. Instead of\n   * having a single list with all images despite type and format\n   * we create a proper structure. With that we can do:\n   * - images.primary.thumnail.url\n   * - images.GALLERY[0].thumnail.url\n   */\n  normalize(source: Occ.Image[]): Images {\n    const images = {};\n    if (source) {\n      for (const image of source) {\n        const isList = image.hasOwnProperty('galleryIndex');\n        if (!images.hasOwnProperty(image.imageType)) {\n          images[image.imageType] = isList ? [] : {};\n        }\n\n        let imageContainer;\n        if (isList && !images[image.imageType][image.galleryIndex]) {\n          images[image.imageType][image.galleryIndex] = {};\n        }\n\n        if (isList) {\n          imageContainer = images[image.imageType][image.galleryIndex];\n        } else {\n          imageContainer = images[image.imageType];\n        }\n\n        const targetImage = { ...image };\n        targetImage.url = this.normalizeImageUrl(targetImage.url);\n        imageContainer[image.format] = targetImage;\n      }\n    }\n    return images;\n  }\n  /**\n   * Traditionally, in an on-prem world, medias and other backend related calls\n   * are hosted at the same platform, but in a cloud setup, applications are are\n   * typically distributed cross different environments. For media, we use the\n   * `backend.media.baseUrl` by default, but fallback to `backend.occ.baseUrl`\n   * if none provided.\n   */\n  private normalizeImageUrl(url: string): string {\n    if (new RegExp(/^(http|data:image|\\/\\/)/i).test(url)) {\n      return url;\n    }\n    return (\n      (this.config.backend.media.baseUrl ||\n        this.config.backend.occ.baseUrl ||\n        '') + url\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { Converter } from '../../../../util/converter.service';\nimport { Product, ProductReferences } from '../../../../model/product.model';\n\n@Injectable()\nexport class ProductReferenceNormalizer\n  implements Converter<Occ.Product, Product> {\n  convert(source: Occ.Product, target?: Product): Product {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source.productReferences) {\n      target.productReferences = this.normalize(source.productReferences);\n    }\n    return target;\n  }\n\n  /**\n   * @desc\n   * Creates the reference structure we'd like to have. Instead of\n   * having a single list with all references we create a proper structure.\n   * With that we have a semantic API for the clients\n   * - product.references.SIMILAR[0].code\n   */\n  protected normalize(source: Occ.ProductReference[]): ProductReferences {\n    const references = {};\n\n    if (source) {\n      for (const reference of source) {\n        if (!references.hasOwnProperty(reference.referenceType)) {\n          references[reference.referenceType] = [];\n        }\n        references[reference.referenceType].push(reference);\n      }\n    }\n    return references;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  Facet,\n  ProductSearchPage,\n} from '../../../../model/product-search.model';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccProductSearchPageNormalizer\n  implements Converter<Occ.ProductSearchPage, ProductSearchPage> {\n  constructor(private converterService: ConverterService) {}\n\n  /**\n   * Specifies the minimal number of top values in case\n   * non have been setup by the business.\n   */\n  protected DEFAULT_TOP_VALUES = 6;\n\n  convert(\n    source: Occ.ProductSearchPage,\n    target: ProductSearchPage = {}\n  ): ProductSearchPage {\n    target = {\n      ...target,\n      ...(source as any),\n    };\n\n    this.normalizeFacets(target);\n    if (source.products) {\n      target.products = source.products.map((product) =>\n        this.converterService.convert(product, PRODUCT_NORMALIZER)\n      );\n    }\n    return target;\n  }\n\n  private normalizeFacets(target: ProductSearchPage): void {\n    this.normalizeFacetValues(target);\n    this.normalizeUselessFacets(target);\n  }\n\n  /**\n   * The (current) backend returns facets with values that do not contribute\n   * to the facet navigation much, as the number in the result list will not get\n   * behavior, see https://jira.hybris.com/browse/CS-427.\n   *\n   * As long as this is not in place, we manually filter the facet from the list;\n   * any facet that does not have a count < the total results will be dropped from\n   * the facets.\n   */\n  private normalizeUselessFacets(target: ProductSearchPage): void {\n    if (target.facets) {\n      target.facets = target.facets.filter((facet) => {\n        return (\n          !target.pagination ||\n          !target.pagination.totalResults ||\n          ((!facet.hasOwnProperty('visible') || facet.visible) &&\n            facet.values &&\n            facet.values.find((value) => {\n              return (\n                value.selected || value.count < target.pagination.totalResults\n              );\n            }))\n        );\n      });\n    }\n  }\n\n  /*\n   * In case there are so-called `topValues` given for the facet values,\n   * values are obsolete.\n   *\n   * `topValues` is a feature in Adaptive Search which can limit a large\n   * amount of facet values to a small set (5 by default). As long as the backend\n   * provides all facet values AND topValues, we normalize the data to not bother\n   * the UI with this specific feature.\n   */\n  private normalizeFacetValues(target: ProductSearchPage): void {\n    if (target.facets) {\n      target.facets = target.facets.map((facetSource: Facet) => {\n        const { topValues, ...facetTarget } = facetSource;\n        facetTarget.topValueCount =\n          topValues?.length > 0 ? topValues.length : this.DEFAULT_TOP_VALUES;\n        return facetTarget;\n      });\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ProductReference } from '../../../../model/product.model';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\n\n@Injectable({ providedIn: 'root' })\nexport class OccProductReferencesListNormalizer\n  implements Converter<Occ.ProductReferenceList, ProductReference[]> {\n  constructor(private converter: ConverterService) {}\n\n  convert(\n    source: Occ.ProductReferenceList,\n    target: ProductReference[] = []\n  ): ProductReference[] {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source && source.references) {\n      target = source.references.map((reference) => ({\n        ...reference,\n        target: this.converter.convert(reference.target, PRODUCT_NORMALIZER),\n      }));\n\n      return target;\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { OccConfig } from '../../../config/occ-config';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { Converter } from '../../../../util/converter.service';\nimport { Product } from '../../../../model/product.model';\n\n@Injectable({ providedIn: 'root' })\nexport class ProductNameNormalizer implements Converter<Occ.Product, Product> {\n  constructor(protected config: OccConfig) {}\n\n  convert(source: Occ.Product, target?: Product): Product {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n    if (source.name) {\n      target.name = this.normalize(source.name);\n      target.nameHtml = source.name;\n    }\n    return target;\n  }\n\n  protected normalize(name: string): string {\n    return name.replace(/<[^>]*>/g, '');\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { ProductReference } from '../../../model/product.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const PRODUCT_REFERENCES_NORMALIZER = new InjectionToken<\n  Converter<any, ProductReference[]>\n>('ProductReferencesListNormalizer');\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ProductReference } from '../../../model/product.model';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport { PRODUCT_REFERENCES_NORMALIZER } from '../../../product/connectors/references/converters';\nimport { ProductReferencesAdapter } from '../../../product/connectors/references/product-references.adapter';\n\n@Injectable()\nexport class OccProductReferencesAdapter implements ProductReferencesAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]> {\n    return this.http\n      .get(this.getEndpoint(productCode, referenceType, pageSize))\n      .pipe(this.converter.pipeable(PRODUCT_REFERENCES_NORMALIZER));\n  }\n\n  protected getEndpoint(\n    code: string,\n    reference?: string,\n    pageSize?: number\n  ): string {\n    return this.occEndpoints.getUrl(\n      'productReferences',\n      {\n        productCode: code,\n      },\n      { referenceType: reference, pageSize }\n    );\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Review } from '../../../model/product.model';\n\nexport const PRODUCT_REVIEW_NORMALIZER = new InjectionToken<\n  Converter<any, Review>\n>('ProductReviewNormalizer');\n\nexport const PRODUCT_REVIEW_SERIALIZER = new InjectionToken<\n  Converter<Review, any>\n>('ProductReviewSerializer');\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport { Review } from '../../../model/product.model';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport {\n  PRODUCT_REVIEW_NORMALIZER,\n  PRODUCT_REVIEW_SERIALIZER,\n} from '../../../product/connectors/reviews/converters';\nimport { ProductReviewsAdapter } from '../../../product/connectors/reviews/product-reviews.adapter';\n\n@Injectable()\nexport class OccProductReviewsAdapter implements ProductReviewsAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(productCode: string, maxCount?: number): Observable<Review[]> {\n    return this.http\n      .get(this.getEndpoint(productCode, maxCount))\n      .pipe(\n        pluck('reviews'),\n        this.converter.pipeableMany(PRODUCT_REVIEW_NORMALIZER)\n      );\n  }\n\n  post(productCode: string, review: any): Observable<Review> {\n    review = this.converter.convert(review, PRODUCT_REVIEW_SERIALIZER);\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    const body = new URLSearchParams();\n    body.append('headline', review.headline);\n    body.append('comment', review.comment);\n    body.append('rating', review.rating.toString());\n    body.append('alias', review.alias);\n\n    return this.http.post(this.getEndpoint(productCode), body.toString(), {\n      headers,\n    });\n  }\n\n  protected getEndpoint(code: string, maxCount?: number): string {\n    return this.occEndpoints.getUrl(\n      'productReviews',\n      {\n        productCode: code,\n      },\n      { maxCount }\n    );\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport {\n  Suggestion,\n  ProductSearchPage,\n} from '../../../model/product-search.model';\n\nexport const PRODUCT_SEARCH_PAGE_NORMALIZER = new InjectionToken<\n  Converter<any, ProductSearchPage>\n>('ProductSearchPageNormalizer');\n\nexport const PRODUCT_SUGGESTION_NORMALIZER = new InjectionToken<\n  Converter<any, Suggestion>\n>('ProductSuggestionNormalizer');\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport {\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport {\n  PRODUCT_SEARCH_PAGE_NORMALIZER,\n  PRODUCT_SUGGESTION_NORMALIZER,\n} from '../../../product/connectors/search/converters';\nimport { ProductSearchAdapter } from '../../../product/connectors/search/product-search.adapter';\nimport { SearchConfig } from '../../../product/model/search-config';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\nconst DEFAULT_SEARCH_CONFIG: SearchConfig = {\n  pageSize: 20,\n};\n\n@Injectable()\nexport class OccProductSearchAdapter implements ProductSearchAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  search(\n    query: string,\n    searchConfig: SearchConfig = DEFAULT_SEARCH_CONFIG\n  ): Observable<ProductSearchPage> {\n    return this.http\n      .get(this.getSearchEndpoint(query, searchConfig))\n      .pipe(this.converter.pipeable(PRODUCT_SEARCH_PAGE_NORMALIZER));\n  }\n\n  loadSuggestions(\n    term: string,\n    pageSize: number = 3\n  ): Observable<Suggestion[]> {\n    return this.http\n      .get(this.getSuggestionEndpoint(term, pageSize.toString()))\n      .pipe(\n        pluck('suggestions'),\n        this.converter.pipeableMany(PRODUCT_SUGGESTION_NORMALIZER)\n      );\n  }\n\n  protected getSearchEndpoint(\n    query: string,\n    searchConfig: SearchConfig\n  ): string {\n    return this.occEndpoints.getUrl(\n      'productSearch',\n      {},\n      {\n        query,\n        ...searchConfig,\n      }\n    );\n  }\n\n  protected getSuggestionEndpoint(term: string, max: string): string {\n    return this.occEndpoints.getUrl('productSuggestions', {}, { term, max });\n  }\n}\n","import { deepMerge, isObject } from '../../config/utils/deep-merge';\n\n/**\n * Merge occ fields parameters\n *\n * @param fields Fields definition as string or object\n */\nexport function mergeFields(fields: (string | object)[]): string {\n  const parsedFields = fields.map((f) =>\n    typeof f === 'string' ? parseFields(f) : f\n  );\n  const mergedFields = optimizeFields(deepMerge({}, ...parsedFields));\n  return stringifyFields(mergedFields);\n}\n\n/**\n * Optimize fields definition by removing not needed groups\n *\n * @param fields\n */\nexport function optimizeFields(fields: object = {}): object {\n  const keys = Object.keys(fields);\n  if (keys.includes('FULL')) {\n    delete fields['DEFAULT'];\n    delete fields['BASIC'];\n  } else if (keys.includes('DEFAULT')) {\n    delete fields['BASIC'];\n  }\n  Object.keys(fields).forEach((key) => {\n    fields[key] = optimizeFields(fields[key]);\n  });\n  return fields;\n}\n\n/**\n * Parse string field definition to an AST object\n *\n * @param fields Fields string definition\n * @param startIndex Used for recurrence\n */\nexport function parseFields(\n  fields: string,\n  startIndex = 0\n): [object, number] | object {\n  const parsedFields = {};\n\n  let i = startIndex;\n  while (i < fields.length) {\n    if (fields[i] === ',') {\n      if (i > startIndex) {\n        parsedFields[fields.substr(startIndex, i - startIndex)] = {};\n      }\n      startIndex = i + 1;\n    } else if (fields[i] === '(') {\n      const subFields = parseFields(fields, i + 1);\n      if (Array.isArray(subFields)) {\n        parsedFields[fields.substr(startIndex, i - startIndex)] = subFields[0];\n        startIndex = subFields[1];\n        i = startIndex - 1;\n      } else {\n        return parsedFields;\n      }\n    } else if (fields[i] === ')') {\n      if (i > startIndex) {\n        parsedFields[fields.substr(startIndex, i - startIndex)] = {};\n      }\n      return [parsedFields, i + 1];\n    }\n    i++;\n  }\n\n  if (startIndex < fields.length) {\n    parsedFields[fields.substr(startIndex, i - startIndex)] = {};\n  }\n\n  return parsedFields;\n}\n\n/**\n * Convert AST object fields definition to string representation\n *\n * @param fields\n */\nexport function stringifyFields(fields: object): string {\n  return Object.keys(fields)\n    .map((key) => {\n      const subFields = stringifyFields(fields[key]);\n      return subFields ? `${key}(${subFields})` : key;\n    })\n    .join(',');\n}\n\n/**\n * Extract part of the object described by fields definition\n *\n * @param data\n * @param fields\n */\nexport function extractFields<T>(data: T, fields: string | object): T {\n  const parsedFields =\n    typeof fields === 'string' ? parseFields(fields) : fields;\n  return getObjectPart<T>(data, parsedFields);\n}\n\nfunction getObjectPart<T>(data: T, fields: object): T {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  const keys = Object.keys(fields);\n\n  if (\n    keys.length === 0 ||\n    // we should not extract parts of the object with ambiguous fields definitions\n    keys.find((el) => el === 'BASIC' || el === 'DEFAULT' || el === 'FULL')\n  ) {\n    return data;\n  }\n\n  const result = {} as T;\n\n  keys.forEach((key) => {\n    if (data.hasOwnProperty(key)) {\n      result[key] = getObjectPart(data[key], fields[key]);\n    }\n  });\n\n  return result;\n}\n","import { Injectable } from '@angular/core';\nimport { mergeFields, parseFields } from '../utils/occ-fields';\nimport { ScopedData } from '../../model/scoped-data';\nimport { HttpClient } from '@angular/common/http';\n\nexport interface ScopedDataWithUrl {\n  /** Url (with fields) to load scoped data */\n  url?: string;\n  /** scoped data model */\n  scopedData: ScopedData<any>;\n}\n\n/**\n * Intermediate model to accommodate all data needed to perform occ fields optimizations\n * wrapping ScopedData with url and fields\n */\nexport interface OccFieldsModel extends ScopedDataWithUrl {\n  /** extracted fields object, used to extract data from broader model */\n  fields?: object;\n}\n\n/**\n * Grouped rest calls with optimal urls\n *\n * One url groups all scopes it covers with related occFieldsModels\n */\nexport interface OccOptimimalUrlGroups {\n  [optimalUrl: string]: {\n    [scope: string]: OccFieldsModel;\n  };\n}\n\n/**\n * Helper service for optimizing endpoint calls to occ backend\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccFieldsService {\n  constructor(protected http: HttpClient) {}\n\n  protected FIELDS_PARAM = 'fields';\n\n  /**\n   * Merge similar occ endpoints calls by merging fields parameter\n   *\n   * We assume that different scopes are defined by different fields parameters,\n   * so we are grouping all requests with the same urls (except fields definition)\n   * and merging into one request with fields that will satisfy all separate ones.\n   *\n   * @param models\n   */\n  getOptimalUrlGroups(models: ScopedDataWithUrl[]): OccOptimimalUrlGroups {\n    const groupedByUrls: OccOptimimalUrlGroups = {};\n    for (const model of models as OccFieldsModel[]) {\n      const [urlPart, fields] = this.splitFields(model.url);\n      if (!groupedByUrls[urlPart]) {\n        groupedByUrls[urlPart] = {};\n      }\n      model.fields = fields ? parseFields(fields) : {};\n      groupedByUrls[urlPart][model.scopedData.scope] = model;\n    }\n\n    const mergedUrls: OccOptimimalUrlGroups = {};\n    for (const [url, group] of Object.entries(groupedByUrls)) {\n      const urlWithFields = this.getUrlWithFields(\n        url,\n        Object.values(group).map((lo) => lo.fields)\n      );\n      mergedUrls[urlWithFields] = group;\n    }\n\n    return mergedUrls;\n  }\n\n  /**\n   * Extract fields parameter from occ endpoint url\n   *\n   * @param urlWithFields\n   */\n  private splitFields(urlWithFields: string): [string, string] {\n    const [url, params] = urlWithFields.split('?');\n\n    const paramsMap = {};\n\n    if (params) {\n      params.split('&').map((param) => {\n        const keyValue = param.split('=');\n        paramsMap[keyValue[0]] = keyValue[1];\n      });\n    }\n\n    const nonFieldsParams = Object.keys(paramsMap)\n      .sort()\n      .reduce((id, par) => {\n        if (par !== this.FIELDS_PARAM) {\n          id.push(paramsMap[par] ? `${par}=${paramsMap[par]}` : par);\n        }\n        return id;\n      }, []);\n\n    const nonFields = nonFieldsParams.join('&');\n\n    return [\n      nonFields ? `${url}?${nonFields}` : url,\n      paramsMap[this.FIELDS_PARAM],\n    ];\n  }\n\n  /**\n   * Combine url with field parameters\n   *\n   * @param url\n   * @param fields\n   */\n  private getUrlWithFields(url: string, fields: (string | object)[]): string {\n    const mergedFields = mergeFields(fields);\n\n    if (mergedFields) {\n      url += url.includes('?') ? '&' : '?';\n      url += `${this.FIELDS_PARAM}=${mergedFields}`;\n    }\n\n    return url;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ScopedData } from '../../model/scoped-data';\nimport { map, shareReplay } from 'rxjs/operators';\nimport { extractFields } from '../utils/occ-fields';\nimport {\n  OccFieldsModel,\n  OccFieldsService,\n  ScopedDataWithUrl,\n} from './occ-fields.service';\nimport { HttpClient } from '@angular/common/http';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccRequestsOptimizerService {\n  constructor(\n    protected http: HttpClient,\n    protected occFields: OccFieldsService\n  ) {}\n\n  /**\n   * Optimize occ endpoint calls merging requests to the same url by merging field parameters\n   *\n   * @param scopedDataWithUrls\n   * @param dataFactory\n   */\n  scopedDataLoad<T>(\n    scopedDataWithUrls: ScopedDataWithUrl[],\n    dataFactory?: (url: string) => Observable<T>\n  ): ScopedData<T>[] {\n    const result = [];\n\n    if (!dataFactory) {\n      dataFactory = (url) => this.http.get<any>(url);\n    }\n\n    const mergedUrls = this.occFields.getOptimalUrlGroups(scopedDataWithUrls);\n\n    Object.entries(mergedUrls).forEach(\n      ([url, groupedModelsSet]: [\n        string,\n        {\n          [scope: string]: OccFieldsModel;\n        }\n      ]) => {\n        const groupedModels = Object.values(groupedModelsSet);\n\n        if (groupedModels.length === 1) {\n          // only one scope for url, we can pass the data straightaway\n          result.push({\n            ...groupedModels[0].scopedData,\n            data$: dataFactory(url),\n          });\n        } else {\n          // multiple scopes per url\n          // we have to split the model per each scope\n          const data$ = dataFactory(url).pipe(shareReplay(1));\n\n          groupedModels.forEach((modelData) => {\n            result.push({\n              ...modelData.scopedData,\n              data$: data$.pipe(\n                map((data) => extractFields<T>(data, modelData.fields))\n              ),\n            });\n          });\n        }\n      }\n    );\n\n    return result;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ProductAdapter } from '../../../product/connectors/product/product.adapter';\nimport { Observable } from 'rxjs';\nimport { HttpClient } from '@angular/common/http';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport { PRODUCT_NORMALIZER } from '../../../product/connectors/product/converters';\nimport { Product } from '../../../model/product.model';\nimport { ScopedProductData } from '../../../product/connectors/product/scoped-product-data';\nimport { ScopedDataWithUrl } from '../../services/occ-fields.service';\nimport { Occ } from '../../occ-models';\nimport { OccRequestsOptimizerService } from '../../services/occ-requests-optimizer.service';\n\n@Injectable()\nexport class OccProductAdapter implements ProductAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService,\n    protected requestsOptimizer: OccRequestsOptimizerService\n  ) {}\n\n  load(productCode: string, scope?: string): Observable<Product> {\n    return this.http\n      .get(this.getEndpoint(productCode, scope))\n      .pipe(this.converter.pipeable(PRODUCT_NORMALIZER));\n  }\n\n  loadMany(products: ScopedProductData[]): ScopedProductData[] {\n    const scopedDataWithUrls: ScopedDataWithUrl[] = products.map((model) => ({\n      scopedData: model,\n      url: this.getEndpoint(model.code, model.scope),\n    }));\n\n    return this.requestsOptimizer\n      .scopedDataLoad<Occ.Product>(scopedDataWithUrls)\n      .map(\n        (scopedProduct) =>\n          ({\n            ...scopedProduct,\n            data$: scopedProduct.data$.pipe(\n              this.converter.pipeable(PRODUCT_NORMALIZER)\n            ),\n          } as ScopedProductData)\n      );\n  }\n\n  protected getEndpoint(code: string, scope?: string): string {\n    return this.occEndpoints.getUrl(\n      'product',\n      {\n        productCode: code,\n      },\n      undefined,\n      scope\n    );\n  }\n}\n","export enum ProductScope {\n  LIST = 'list',\n  DETAILS = 'details',\n  ATTRIBUTES = 'attributes',\n  VARIANTS = 'variants',\n}\n","import { Observable } from 'rxjs';\nimport { Product } from '../../../model/product.model';\nimport { ScopedProductData } from './scoped-product-data';\n\nexport abstract class ProductAdapter {\n  /**\n   * Abstract method used to load product's details data.\n   * Product's data can be loaded from alternative sources, as long as the structure\n   * converts to the `Product`.\n   *\n   * @param productCode The `productCode` for given product\n   * @param scope The product scope to load\n   */\n  abstract load(productCode: string, scope?: string): Observable<Product>;\n\n  /**\n   * Abstract method used to load data for multiple product and scopes\n   * Adapter is able to optimize necessary backend calls and load\n   * products in the most efficient way possible.\n   *\n   * @param products\n   */\n  abstract loadMany?(products: ScopedProductData[]): ScopedProductData[];\n}\n","import { Observable } from 'rxjs';\nimport { ProductReference } from '../../../model/product.model';\n\nexport abstract class ProductReferencesAdapter {\n  /**\n   * Abstract method used to load product references for a given product.\n   * References can be loaded from alternative sources, as long as the structure\n   * converts to the `ProductReference[]`.\n   *\n   * @param productCode The `productCode` for given product\n   * @param referenceType Reference type according to enum ProductReferenceTypeEnum\n   * @param pageSize Maximum number of product refrence to load\n   */\n  abstract load(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]>;\n}\n","import { Observable } from 'rxjs';\nimport { Review } from '../../../model/product.model';\n\nexport abstract class ProductReviewsAdapter {\n  /**\n   * Abstract method used to load reviews for a given product.\n   * Reviews can be loaded from alternative sources, as long as the structure\n   * converts to the `Review[]`.\n   *\n   * @param productCode The `productCode` for given product\n   * @param maxCount Maximum number of review to load\n   */\n  abstract load(productCode: string, maxCount?: number): Observable<Review[]>;\n\n  /**\n   * Abstract method used to post review for a given product.\n   *\n   * @param productCode The `productCode` for given product\n   * @param review Review to post\n   */\n  abstract post(productCode: string, review: any): Observable<Review>;\n}\n","import { SearchConfig } from '../../model/search-config';\n\nimport { Observable } from 'rxjs';\nimport {\n  Suggestion,\n  ProductSearchPage,\n} from '../../../model/product-search.model';\n\nexport abstract class ProductSearchAdapter {\n  abstract search(\n    query: string,\n    searchConfig?: SearchConfig\n  ): Observable<ProductSearchPage>;\n\n  abstract loadSuggestions(\n    term: string,\n    pageSize?: number\n  ): Observable<Suggestion[]>;\n}\n","import { ProductScope } from '../../../product/model/product-scope';\nimport { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccProductConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        product: {\n          default:\n            'products/${productCode}?fields=DEFAULT,averageRating,images(FULL),classifications,manufacturer,numberOfReviews,categories(FULL),baseOptions,baseProduct,variantOptions,variantType',\n          list:\n            'products/${productCode}?fields=code,name,summary,price(formattedValue),images(DEFAULT,galleryIndex)',\n          details:\n            'products/${productCode}?fields=averageRating,stock(DEFAULT),description,availableForPickup,code,url,price(DEFAULT),numberOfReviews,manufacturer,categories(FULL),priceRange,multidimensional,configuratorType,configurable,tags,images(FULL)',\n          attributes: 'products/${productCode}?fields=classifications',\n          variants:\n            'products/${productCode}?fields=name,purchasable,baseOptions(DEFAULT),baseProduct,variantOptions(DEFAULT),variantType',\n        },\n        productReviews: 'products/${productCode}/reviews',\n        // Uncomment this when occ gets configured\n        // productReferences:\n        //   'products/${productCode}/references?fields=DEFAULT,references(target(images(FULL)))&referenceType=${referenceType}',\n        productReferences:\n          'products/${productCode}/references?fields=DEFAULT,references(target(images(FULL)))',\n        // tslint:disable:max-line-length\n        productSearch:\n          'products/search?fields=products(code,name,summary,price(FULL),images(DEFAULT),stock(FULL),averageRating,variantOptions),facets,breadcrumbs,pagination(DEFAULT),sorts(DEFAULT),freeTextSearch,currentQuery',\n        // tslint:enable\n        productSuggestions: 'products/suggestions',\n      },\n    },\n    loadingScopes: {\n      product: {\n        details: {\n          include: [ProductScope.LIST, ProductScope.VARIANTS],\n        },\n      },\n    },\n  },\n};\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { PRODUCT_NORMALIZER } from '../../../product/connectors/product/converters';\nimport { ProductAdapter } from '../../../product/connectors/product/product.adapter';\nimport { PRODUCT_REFERENCES_NORMALIZER } from '../../../product/connectors/references/converters';\nimport { ProductReferencesAdapter } from '../../../product/connectors/references/product-references.adapter';\nimport { ProductReviewsAdapter } from '../../../product/connectors/reviews/product-reviews.adapter';\nimport { PRODUCT_SEARCH_PAGE_NORMALIZER } from '../../../product/connectors/search/converters';\nimport { ProductSearchAdapter } from '../../../product/connectors/search/product-search.adapter';\nimport { OccProductReferencesListNormalizer } from './converters/occ-product-references-list-normalizer';\nimport { OccProductSearchPageNormalizer } from './converters/occ-product-search-page-normalizer';\nimport { ProductImageNormalizer } from './converters/product-image-normalizer';\nimport { OccProductReferencesAdapter } from './occ-product-references.adapter';\nimport { OccProductReviewsAdapter } from './occ-product-reviews.adapter';\nimport { OccProductSearchAdapter } from './occ-product-search.adapter';\nimport { OccProductAdapter } from './occ-product.adapter';\nimport { ProductNameNormalizer } from './converters/product-name-normalizer';\nimport { defaultOccProductConfig } from './default-occ-product-config';\nimport './product-occ-config';\nimport { provideDefaultConfig } from '../../../config/config-providers';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccProductConfig),\n    {\n      provide: ProductAdapter,\n      useClass: OccProductAdapter,\n    },\n    {\n      provide: PRODUCT_NORMALIZER,\n      useExisting: ProductImageNormalizer,\n      multi: true,\n    },\n    {\n      provide: PRODUCT_NORMALIZER,\n      useExisting: ProductNameNormalizer,\n      multi: true,\n    },\n    {\n      provide: ProductReferencesAdapter,\n      useClass: OccProductReferencesAdapter,\n    },\n    {\n      provide: PRODUCT_REFERENCES_NORMALIZER,\n      useExisting: OccProductReferencesListNormalizer,\n      multi: true,\n    },\n    {\n      provide: ProductSearchAdapter,\n      useClass: OccProductSearchAdapter,\n    },\n    {\n      provide: PRODUCT_SEARCH_PAGE_NORMALIZER,\n      useExisting: OccProductSearchPageNormalizer,\n      multi: true,\n    },\n    {\n      provide: ProductReviewsAdapter,\n      useClass: OccProductReviewsAdapter,\n    },\n  ],\n})\nexport class ProductOccModule {}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../util/converter.service';\nimport { BaseSite, Currency, Language } from '../../model/misc.model';\nimport { Country, Region } from '../../model/address.model';\n\nexport const LANGUAGE_NORMALIZER = new InjectionToken<Converter<any, Language>>(\n  'LanguageNormalizer'\n);\n\nexport const CURRENCY_NORMALIZER = new InjectionToken<Converter<any, Currency>>(\n  'CurrencyNormalizer'\n);\n\nexport const COUNTRY_NORMALIZER = new InjectionToken<Converter<any, Country>>(\n  'CountryNormalizer'\n);\n\nexport const REGION_NORMALIZER = new InjectionToken<Converter<any, Region>>(\n  'RegionNormalizer'\n);\n\nexport const BASE_SITE_NORMALIZER = new InjectionToken<\n  Converter<any, BaseSite>\n>('BaseSiteNormalizer');\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Country, CountryType, Region } from '../../../model/address.model';\nimport { BaseSite, Currency, Language } from '../../../model/misc.model';\nimport {\n  BASE_SITE_NORMALIZER,\n  COUNTRY_NORMALIZER,\n  CURRENCY_NORMALIZER,\n  LANGUAGE_NORMALIZER,\n  REGION_NORMALIZER,\n} from '../../../site-context/connectors/converters';\nimport { SiteAdapter } from '../../../site-context/connectors/site.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccSiteAdapter implements SiteAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService\n  ) {}\n\n  loadLanguages(): Observable<Language[]> {\n    return this.http\n      .get<Occ.LanguageList>(this.occEndpointsService.getUrl('languages'))\n      .pipe(\n        map((languageList) => languageList.languages),\n        this.converterService.pipeableMany(LANGUAGE_NORMALIZER)\n      );\n  }\n\n  loadCurrencies(): Observable<Currency[]> {\n    return this.http\n      .get<Occ.CurrencyList>(this.occEndpointsService.getUrl('currencies'))\n      .pipe(\n        map((currencyList) => currencyList.currencies),\n        this.converterService.pipeableMany(CURRENCY_NORMALIZER)\n      );\n  }\n\n  loadCountries(type?: CountryType): Observable<Country[]> {\n    return this.http\n      .get<Occ.CountryList>(\n        this.occEndpointsService.getUrl(\n          'countries',\n          undefined,\n          type ? { type } : undefined\n        )\n      )\n      .pipe(\n        map((countryList) => countryList.countries),\n        this.converterService.pipeableMany(COUNTRY_NORMALIZER)\n      );\n  }\n\n  loadRegions(countryIsoCode: string): Observable<Region[]> {\n    return this.http\n      .get<Occ.RegionList>(\n        this.occEndpointsService.getUrl('regions', { isoCode: countryIsoCode })\n      )\n      .pipe(\n        map((regionList) => regionList.regions),\n        this.converterService.pipeableMany(REGION_NORMALIZER)\n      );\n  }\n\n  /**\n   * There is no OCC API to load one site based on Uid.\n   * So, we have to load all sites, and find the one from the list.\n   */\n  loadBaseSite(siteUid?: string): Observable<BaseSite> {\n    if (!siteUid) {\n      const baseUrl = this.occEndpointsService.getBaseEndpoint();\n      const urlSplits = baseUrl.split('/');\n      siteUid = urlSplits.pop();\n    }\n\n    return this.http\n      .get<{ baseSites: BaseSite[] }>(\n        this.occEndpointsService.getOccEndpoint('baseSites')\n      )\n      .pipe(\n        map((siteList) => {\n          return siteList.baseSites.find((site) => site.uid === siteUid);\n        })\n      );\n  }\n\n  loadBaseSites(): Observable<BaseSite[]> {\n    return this.http\n      .get<{ baseSites: BaseSite[] }>(\n        this.occEndpointsService.getOccEndpoint('baseSites')\n      )\n      .pipe(\n        map((baseSiteList) => baseSiteList.baseSites),\n        this.converterService.pipeableMany(BASE_SITE_NORMALIZER)\n      );\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Country, CountryType, Region } from '../../model/address.model';\nimport { BaseSite, Currency, Language } from '../../model/misc.model';\n\nexport abstract class SiteAdapter {\n  /**\n   * Abstract method used to load languages.\n   */\n  abstract loadLanguages(): Observable<Language[]>;\n\n  /**\n   * Abstract method used to load currencies.\n   */\n  abstract loadCurrencies(): Observable<Currency[]>;\n\n  /**\n   * Abstract method used to get countries with optional type.\n   */\n  abstract loadCountries(type?: CountryType): Observable<Country[]>;\n\n  /**\n   * Abstract method used to get regions for a country.\n   */\n  abstract loadRegions(countryIsoCode: string): Observable<Region[]>;\n\n  /**\n   * Abstract method used to get base site data based on siteUid.\n   */\n  abstract loadBaseSite(siteUid?: string): Observable<BaseSite>;\n\n  /**\n   * Abstract method used to get all base sites data.\n   */\n  abstract loadBaseSites(): Observable<BaseSite[]>;\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccSiteContextConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        languages: 'languages',\n        currencies: 'currencies',\n        countries: 'countries',\n        regions:\n          'countries/${isoCode}/regions?fields=regions(name,isocode,isocodeShort)',\n        baseSites:\n          'basesites?fields=DEFAULT,baseSites(defaultPreviewCatalogId,defaultPreviewCategoryCode,defaultPreviewProductCode,urlEncodingAttributes)',\n      },\n    },\n  },\n};\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, take, tap } from 'rxjs/operators';\nimport { Currency } from '../../model/misc.model';\nimport { WindowRef } from '../../window/window-ref';\nimport {\n  getContextParameterDefault,\n  getContextParameterValues,\n} from '../config/context-config-utils';\nimport { SiteContextConfig } from '../config/site-context-config';\nimport { CURRENCY_CONTEXT_ID } from '../providers/context-ids';\nimport { SiteContextActions } from '../store/actions/index';\nimport { SiteContextSelectors } from '../store/selectors/index';\nimport { StateWithSiteContext } from '../store/state';\nimport { SiteContext } from './site-context.interface';\n\n/**\n * Facade that provides easy access to curreny state, actions and selectors.\n */\n@Injectable()\nexport class CurrencyService implements SiteContext<Currency> {\n  private sessionStorage: Storage;\n\n  constructor(\n    protected store: Store<StateWithSiteContext>,\n    winRef: WindowRef,\n    protected config: SiteContextConfig\n  ) {\n    this.sessionStorage = winRef.sessionStorage;\n  }\n\n  /**\n   * Represents all the currencies supported by the current store.\n   */\n  getAll(): Observable<Currency[]> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getAllCurrencies),\n      tap((currencies) => {\n        if (!currencies) {\n          this.store.dispatch(new SiteContextActions.LoadCurrencies());\n        }\n      }),\n      filter((currenies) => Boolean(currenies))\n    );\n  }\n\n  /**\n   * Represents the isocode of the active currency.\n   */\n  getActive(): Observable<string> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getActiveCurrency),\n      filter((active) => Boolean(active))\n    );\n  }\n\n  /**\n   * Sets the active language.\n   */\n  setActive(isocode: string): void {\n    this.store\n      .pipe(select(SiteContextSelectors.getActiveCurrency), take(1))\n      .subscribe((activeCurrency) => {\n        if (activeCurrency !== isocode) {\n          this.store.dispatch(\n            new SiteContextActions.SetActiveCurrency(isocode)\n          );\n        }\n      });\n  }\n\n  /**\n   * Initials the active currency. The active currency is either given\n   * by the last visit (stored in session storage) or by the\n   * default session currency of the store.\n   */\n  initialize(): void {\n    let value;\n    this.getActive()\n      .subscribe((val) => (value = val))\n      .unsubscribe();\n    if (value) {\n      // don't initialize, if there is already a value (i.e. retrieved from route or transferred from SSR)\n      return;\n    }\n\n    const sessionCurrency =\n      this.sessionStorage && this.sessionStorage.getItem('currency');\n    if (\n      sessionCurrency &&\n      getContextParameterValues(this.config, CURRENCY_CONTEXT_ID).includes(\n        sessionCurrency\n      )\n    ) {\n      this.setActive(sessionCurrency);\n    } else {\n      this.setActive(\n        getContextParameterDefault(this.config, CURRENCY_CONTEXT_ID)\n      );\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, take, tap } from 'rxjs/operators';\nimport { Language } from '../../model/misc.model';\nimport { WindowRef } from '../../window/window-ref';\nimport {\n  getContextParameterDefault,\n  getContextParameterValues,\n} from '../config/context-config-utils';\nimport { SiteContextConfig } from '../config/site-context-config';\nimport { LANGUAGE_CONTEXT_ID } from '../providers/context-ids';\nimport { SiteContextActions } from '../store/actions/index';\nimport { SiteContextSelectors } from '../store/selectors/index';\nimport { StateWithSiteContext } from '../store/state';\nimport { SiteContext } from './site-context.interface';\n\n/**\n * Facade that provides easy access to language state, actions and selectors.\n */\n@Injectable()\nexport class LanguageService implements SiteContext<Language> {\n  private sessionStorage: Storage;\n\n  constructor(\n    protected store: Store<StateWithSiteContext>,\n    winRef: WindowRef,\n    protected config: SiteContextConfig\n  ) {\n    this.sessionStorage = winRef.sessionStorage;\n  }\n\n  /**\n   * Represents all the languages supported by the current store.\n   */\n  getAll(): Observable<Language[]> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getAllLanguages),\n      tap((languages) => {\n        if (!languages) {\n          this.store.dispatch(new SiteContextActions.LoadLanguages());\n        }\n      }),\n      filter((languages) => Boolean(languages))\n    );\n  }\n\n  /**\n   * Represents the isocode of the active language.\n   */\n  getActive(): Observable<string> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getActiveLanguage),\n      filter((active) => Boolean(active))\n    );\n  }\n\n  /**\n   * Sets the active language.\n   */\n  setActive(isocode: string): void {\n    this.store\n      .pipe(select(SiteContextSelectors.getActiveLanguage), take(1))\n      .subscribe((activeLanguage) => {\n        if (activeLanguage !== isocode) {\n          this.store.dispatch(\n            new SiteContextActions.SetActiveLanguage(isocode)\n          );\n        }\n      });\n  }\n\n  /**\n   * Initials the active language. The active language is either given\n   * by the last visit (stored in session storage) or by the\n   * default session language of the store.\n   */\n  initialize(): void {\n    let value;\n    this.getActive()\n      .subscribe((val) => (value = val))\n      .unsubscribe();\n    if (value) {\n      // don't initialize, if there is already a value (i.e. retrieved from route or transferred from SSR)\n      return;\n    }\n\n    const sessionLanguage =\n      this.sessionStorage && this.sessionStorage.getItem('language');\n    if (\n      sessionLanguage &&\n      getContextParameterValues(this.config, LANGUAGE_CONTEXT_ID).includes(\n        sessionLanguage\n      )\n    ) {\n      this.setActive(sessionLanguage);\n    } else {\n      this.setActive(\n        getContextParameterDefault(this.config, LANGUAGE_CONTEXT_ID)\n      );\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\n\nimport { Observable } from 'rxjs';\nimport { CurrencyService } from '../../../site-context/facade/currency.service';\nimport { LanguageService } from '../../../site-context/facade/language.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { SiteContextConfig } from '../../../site-context/config/site-context-config';\nimport { getContextParameterDefault } from '../../../site-context/config/context-config-utils';\nimport {\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from '../../../site-context/providers/context-ids';\n\n@Injectable({ providedIn: 'root' })\nexport class SiteContextInterceptor implements HttpInterceptor {\n  activeLang: string;\n  activeCurr: string;\n\n  constructor(\n    private languageService: LanguageService,\n    private currencyService: CurrencyService,\n    private occEndpoints: OccEndpointsService,\n    private config: SiteContextConfig\n  ) {\n    this.activeLang = getContextParameterDefault(\n      this.config,\n      LANGUAGE_CONTEXT_ID\n    );\n    this.activeCurr = getContextParameterDefault(\n      this.config,\n      CURRENCY_CONTEXT_ID\n    );\n\n    this.languageService\n      .getActive()\n      .subscribe((data) => (this.activeLang = data));\n\n    this.currencyService.getActive().subscribe((data) => {\n      this.activeCurr = data;\n    });\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (request.url.includes(this.occEndpoints.getBaseEndpoint())) {\n      request = request.clone({\n        setParams: {\n          lang: this.activeLang,\n          curr: this.activeCurr,\n        },\n      });\n    }\n\n    return next.handle(request);\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { SiteAdapter } from '../../../site-context/connectors/site.adapter';\nimport { defaultOccSiteContextConfig } from './default-occ-site-context-config';\nimport { OccSiteAdapter } from './occ-site.adapter';\nimport { SiteContextInterceptor } from './site-context.interceptor';\nimport { provideDefaultConfig } from '../../../config/config-providers';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccSiteContextConfig),\n    {\n      provide: SiteAdapter,\n      useClass: OccSiteAdapter,\n    },\n    {\n      provide: HTTP_INTERCEPTORS,\n      useExisting: SiteContextInterceptor,\n      multi: true,\n    },\n  ],\n})\nexport class SiteContextOccModule {}\n","import { Injectable } from '@angular/core';\nimport { AnonymousConsentsService } from '../../../../anonymous-consents/facade/anonymous-consents.service';\nimport { AnonymousConsent } from '../../../../model/consent.model';\nimport { Converter } from '../../../../util/converter.service';\n\n@Injectable({ providedIn: 'root' })\nexport class AnonymousConsentNormalizer\n  implements Converter<string, AnonymousConsent[]> {\n  constructor(protected anonymousConsentsService: AnonymousConsentsService) {}\n\n  convert(source: string, target: AnonymousConsent[] = []): AnonymousConsent[] {\n    target = this.anonymousConsentsService.decodeAndDeserialize(source);\n    return target;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Occ } from '../../../occ-models/occ.models';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { OrderEntry, ReturnRequest } from '../../../../model/order.model';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\n\n@Injectable({ providedIn: 'root' })\nexport class OccReturnRequestNormalizer\n  implements Converter<Occ.ReturnRequest, ReturnRequest> {\n  constructor(private converter: ConverterService) {}\n\n  convert(source: Occ.ReturnRequest, target?: ReturnRequest): ReturnRequest {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source.returnEntries) {\n      target.returnEntries = source.returnEntries.map((entry) => ({\n        ...entry,\n        orderEntry: this.convertOrderEntry(entry.orderEntry),\n      }));\n    }\n\n    return target;\n  }\n\n  private convertOrderEntry(source: Occ.OrderEntry): OrderEntry {\n    return {\n      ...source,\n      product: this.converter.convert(source.product, PRODUCT_NORMALIZER),\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { ProductInterestSearchResult } from '../../../../model/product-interest.model';\n\n@Injectable({ providedIn: 'root' })\nexport class OccUserInterestsNormalizer\n  implements\n    Converter<Occ.ProductInterestSearchResult, ProductInterestSearchResult> {\n  constructor(private converter: ConverterService) {}\n\n  convert(\n    source: Occ.ProductInterestSearchResult,\n    target?: ProductInterestSearchResult\n  ): ProductInterestSearchResult {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n    if (source && source.results) {\n      target.results = source.results.map((result) => ({\n        ...result,\n        product: this.converter.convert(result.product, PRODUCT_NORMALIZER),\n      }));\n    }\n\n    return target;\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { AnonymousConsent } from '../../model/consent.model';\nimport { Converter } from '../../util/converter.service';\n\nexport const ANONYMOUS_CONSENT_NORMALIZER = new InjectionToken<\n  Converter<string, AnonymousConsent[]>\n>('AnonymousConsentNormalizer');\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\nexport const CONSENT_TEMPLATE_NORMALIZER = new InjectionToken<\n  Converter<any, ConsentTemplate>\n>('ConsentTemplateNormalizer');\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { AnonymousConsentTemplatesAdapter } from '../../../anonymous-consents/connectors/anonymous-consent-templates.adapter';\nimport { ANONYMOUS_CONSENT_NORMALIZER } from '../../../anonymous-consents/connectors/converters';\nimport {\n  AnonymousConsent,\n  ANONYMOUS_CONSENTS_HEADER,\n  ConsentTemplate,\n} from '../../../model/consent.model';\nimport { CONSENT_TEMPLATE_NORMALIZER } from '../../../user/connectors/consent/converters';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccAnonymousConsentTemplatesAdapter\n  implements AnonymousConsentTemplatesAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadAnonymousConsentTemplates(): Observable<ConsentTemplate[]> {\n    const url = this.occEndpoints.getUrl('anonymousConsentTemplates');\n    return this.http.get<Occ.ConsentTemplateList>(url).pipe(\n      catchError((error) => throwError(error)),\n      map((consentList) => consentList.consentTemplates),\n      this.converter.pipeableMany(CONSENT_TEMPLATE_NORMALIZER)\n    );\n  }\n\n  loadAnonymousConsents(): Observable<AnonymousConsent[]> {\n    // using the endpoint that doesn't set caching headers\n    const url = this.occEndpoints.getUrl('anonymousConsentTemplates');\n    return this.http\n      .head<Occ.ConsentTemplateList>(url, { observe: 'response' })\n      .pipe(\n        catchError((error) => throwError(error)),\n        map((response) => response.headers.get(ANONYMOUS_CONSENTS_HEADER)),\n        this.converter.pipeable(ANONYMOUS_CONSENT_NORMALIZER)\n      );\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { CustomerCouponSearchResult } from '../../../model/customer-coupon.model';\n\nexport const CUSTOMER_COUPON_SEARCH_RESULT_NORMALIZER = new InjectionToken<\n  Converter<any, CustomerCouponSearchResult>\n>('CustomerCouponSearchResultNormalizer');\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport {\n  CustomerCoupon2Customer,\n  CustomerCouponNotification,\n  CustomerCouponSearchResult,\n} from '../../../model/customer-coupon.model';\nimport { CUSTOMER_COUPON_SEARCH_RESULT_NORMALIZER } from '../../../user/connectors/customer-coupon/converters';\nimport { CustomerCouponAdapter } from '../../../user/connectors/customer-coupon/customer-coupon.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { OCC_USER_ID_ANONYMOUS } from '../../utils/occ-constants';\n\n@Injectable()\nexport class OccCustomerCouponAdapter implements CustomerCouponAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  getCustomerCoupons(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<CustomerCouponSearchResult> {\n    // Currently OCC only supports calls for customer coupons in case of logged users\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      return of({});\n    }\n\n    const url = this.occEndpoints.getUrl('customerCoupons', { userId });\n\n    let params = new HttpParams().set('sort', sort ? sort : 'startDate:asc');\n\n    if (pageSize) {\n      params = params.set('pageSize', pageSize.toString());\n    }\n    if (currentPage) {\n      params = params.set('currentPage', currentPage.toString());\n    }\n\n    const headers = this.newHttpHeader();\n\n    return this.http\n      .get<Occ.CustomerCouponSearchResult>(url, { headers, params })\n      .pipe(this.converter.pipeable(CUSTOMER_COUPON_SEARCH_RESULT_NORMALIZER));\n  }\n\n  turnOffNotification(userId: string, couponCode: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('couponNotification', {\n      userId,\n      couponCode,\n    });\n    const headers = this.newHttpHeader();\n\n    return this.http.delete(url, { headers });\n  }\n\n  turnOnNotification(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCouponNotification> {\n    const url = this.occEndpoints.getUrl('couponNotification', {\n      userId,\n      couponCode,\n    });\n    const headers = this.newHttpHeader();\n\n    return this.http.post(url, { headers });\n  }\n\n  claimCustomerCoupon(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCoupon2Customer> {\n    const url = this.occEndpoints.getUrl('claimCoupon', {\n      userId,\n      couponCode,\n    });\n    const headers = this.newHttpHeader();\n\n    return this.http.post(url, { headers });\n  }\n\n  private newHttpHeader() {\n    return new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n  }\n}\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { Address, AddressValidation } from '../../../model/address.model';\nimport {\n  ADDRESS_NORMALIZER,\n  ADDRESS_SERIALIZER,\n  ADDRESS_VALIDATION_NORMALIZER,\n} from '../../../user/connectors/address/converters';\nimport { UserAddressAdapter } from '../../../user/connectors/address/user-address.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\nimport { OCC_USER_ID_ANONYMOUS } from '../../utils/occ-constants';\n\n@Injectable()\nexport class OccUserAddressAdapter implements UserAddressAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadAll(userId: string): Observable<Address[]> {\n    const url = this.occEndpoints.getUrl('addresses', { userId });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .get<Occ.AddressList>(url, { headers })\n      .pipe(\n        catchError((error: any) => throwError(error)),\n        map((addressList) => addressList.addresses),\n        this.converter.pipeableMany(ADDRESS_NORMALIZER)\n      );\n  }\n\n  add(userId: string, address: Address): Observable<{}> {\n    const url = this.occEndpoints.getUrl('addresses', { userId });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .post(url, address, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  update(userId: string, addressId: string, address: Address): Observable<{}> {\n    const url = this.occEndpoints.getUrl('addressDetail', {\n      userId,\n      addressId,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .patch(url, address, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  verify(userId: string, address: Address): Observable<AddressValidation> {\n    const url = this.occEndpoints.getUrl('addressVerification', { userId });\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .post<AddressValidation>(url, address, { headers })\n      .pipe(\n        catchError((error: any) => throwError(error)),\n        this.converter.pipeable(ADDRESS_VALIDATION_NORMALIZER)\n      );\n  }\n\n  delete(userId: string, addressId: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('addressDetail', {\n      userId,\n      addressId,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .delete(url, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { CONSENT_TEMPLATE_NORMALIZER } from '../../../user/connectors/consent/converters';\nimport { UserConsentAdapter } from '../../../user/connectors/consent/user-consent.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccUserConsentAdapter implements UserConsentAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadConsents(userId: string): Observable<ConsentTemplate[]> {\n    const url = this.occEndpoints.getUrl('consentTemplates', { userId });\n    const headers = new HttpHeaders({ 'Cache-Control': 'no-cache' });\n    return this.http\n      .get<Occ.ConsentTemplateList>(url, { headers })\n      .pipe(\n        catchError((error: any) => throwError(error)),\n        map((consentList) => consentList.consentTemplates),\n        this.converter.pipeableMany(CONSENT_TEMPLATE_NORMALIZER)\n      );\n  }\n\n  giveConsent(\n    userId: string,\n    consentTemplateId: string,\n    consentTemplateVersion: number\n  ): Observable<ConsentTemplate> {\n    const url = this.occEndpoints.getUrl('consents', { userId });\n    const httpParams = new HttpParams()\n      .set('consentTemplateId', consentTemplateId)\n      .set('consentTemplateVersion', consentTemplateVersion.toString());\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n      'Cache-Control': 'no-cache',\n    });\n    return this.http\n      .post<Occ.ConsentTemplate>(url, httpParams, { headers })\n      .pipe(\n        catchError((error) => throwError(error)),\n        this.converter.pipeable(CONSENT_TEMPLATE_NORMALIZER)\n      );\n  }\n\n  withdrawConsent(userId: string, consentCode: string): Observable<{}> {\n    const headers = new HttpHeaders({\n      'Cache-Control': 'no-cache',\n    });\n    const url = this.occEndpoints.getUrl('consentDetail', {\n      userId,\n      consentId: consentCode,\n    });\n\n    return this.http.delete(url, { headers });\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { ProductInterestSearchResult } from '../../../model/product-interest.model';\n\nexport const PRODUCT_INTERESTS_NORMALIZER = new InjectionToken<\n  Converter<any, ProductInterestSearchResult>\n>('ProductInterestsNormalizer');\n","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { Observable, throwError, forkJoin } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { UserInterestsAdapter } from '../../../user/connectors/interests/user-interests.adapter';\nimport {\n  ProductInterestSearchResult,\n  ProductInterestEntryRelation,\n  NotificationType,\n} from '../../../model/product-interest.model';\nimport { OccConfig } from '../../config/occ-config';\nimport { ConverterService } from '../../../util/converter.service';\nimport { PRODUCT_INTERESTS_NORMALIZER } from '../../../user/connectors/interests/converters';\n\nconst headers = new HttpHeaders({\n  'Content-Type': 'application/json',\n});\n\n@Injectable()\nexport class OccUserInterestsAdapter implements UserInterestsAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected config: OccConfig,\n    protected converter: ConverterService\n  ) {}\n\n  public getInterests(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string,\n    productCode?: string,\n    notificationType?: NotificationType\n  ): Observable<ProductInterestSearchResult> {\n    let params = new HttpParams().set('sort', sort ? sort : 'name:asc');\n    if (pageSize) {\n      params = params.set('pageSize', pageSize.toString());\n    }\n    if (currentPage) {\n      params = params.set('currentPage', currentPage.toString());\n    }\n    if (productCode) {\n      params = params.set('productCode', productCode);\n    }\n    if (notificationType) {\n      params = params.set('notificationType', notificationType.toString());\n    }\n\n    return this.http\n      .get(this.occEndpoints.getUrl('getProductInterests', { userId }), {\n        headers,\n        params,\n      })\n      .pipe(\n        this.converter.pipeable(PRODUCT_INTERESTS_NORMALIZER),\n        catchError((error: any) => throwError(error))\n      );\n  }\n\n  public removeInterest(\n    userId: string,\n    item: ProductInterestEntryRelation\n  ): Observable<any[]> {\n    const r: Observable<any>[] = [];\n    item.productInterestEntry.forEach((entry: any) => {\n      const params: HttpParams = new HttpParams()\n        .set('productCode', item.product.code)\n        .set('notificationType', entry.interestType);\n      r.push(\n        this.http\n          .delete(this.occEndpoints.getUrl('productInterests', { userId }), {\n            params: params,\n          })\n          .pipe(catchError((error: any) => throwError(error)))\n      );\n    });\n    return forkJoin(r);\n  }\n\n  public addInterest(\n    userId: string,\n    productCode: string,\n    notificationType: NotificationType\n  ): Observable<any> {\n    const params = new HttpParams()\n      .set('productCode', productCode)\n      .set('notificationType', notificationType.toString());\n    return this.http\n      .post(\n        this.occEndpoints.getUrl('productInterests', { userId }),\n        {},\n        {\n          headers,\n          params,\n        }\n      )\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const NOTIFICATION_PREFERENCE_SERIALIZER = new InjectionToken<\n  Converter<NotificationPreference[], any>\n>('NotificationPreferenceSerializer');\n\nexport const NOTIFICATION_PREFERENCE_NORMALIZER = new InjectionToken<\n  Converter<any, NotificationPreference>\n>('NotificationPreferenceNormalizer');\n","import { Observable } from 'rxjs';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\n\nexport abstract class UserNotificationPreferenceAdapter {\n  /**\n   * Abstract method used to load notification preferences for an user.\n   *\n   * @param userId The `userId` for given user\n   */\n  abstract loadAll(userId: string): Observable<NotificationPreference[]>;\n\n  /**\n   * Abstract method used to update notification preferences for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param preferences The notification preferences to be updated.\n   */\n  abstract update(\n    userId: string,\n    preferences: NotificationPreference[]\n  ): Observable<{}>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { UserNotificationPreferenceAdapter } from './user-notification-preference.adapter';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserNotificationPreferenceConnector {\n  constructor(protected adapter: UserNotificationPreferenceAdapter) {}\n\n  loadAll(userId: string): Observable<NotificationPreference[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  update(userId: string, preferences: NotificationPreference[]) {\n    return this.adapter.update(userId, preferences);\n  }\n}\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport {\n  NotificationPreference,\n  NotificationPreferenceList,\n} from '../../../model/notification-preference.model';\nimport {\n  NOTIFICATION_PREFERENCE_NORMALIZER,\n  NOTIFICATION_PREFERENCE_SERIALIZER,\n} from '../../../user/connectors/notification-preference';\nimport { UserNotificationPreferenceAdapter } from '../../../user/connectors/notification-preference/user-notification-preference.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\nconst headers = new HttpHeaders({\n  'Content-Type': 'application/json',\n});\n\n@Injectable()\nexport class OccUserNotificationPreferenceAdapter\n  implements UserNotificationPreferenceAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected converter: ConverterService,\n    protected occEndpoints: OccEndpointsService\n  ) {}\n\n  loadAll(userId: string): Observable<NotificationPreference[]> {\n    return this.http\n      .get<NotificationPreferenceList>(\n        this.occEndpoints.getUrl('notificationPreference', { userId }),\n        {\n          headers,\n        }\n      )\n      .pipe(\n        map((list) => list.preferences),\n        this.converter.pipeableMany(NOTIFICATION_PREFERENCE_NORMALIZER),\n        catchError((error: any) => throwError(error))\n      );\n  }\n\n  update(\n    userId: string,\n    preferences: NotificationPreference[]\n  ): Observable<{}> {\n    preferences = this.converter.convert(\n      preferences,\n      NOTIFICATION_PREFERENCE_SERIALIZER\n    );\n    return this.http\n      .patch(\n        this.occEndpoints.getUrl('notificationPreference', { userId }),\n        { preferences: preferences },\n        { headers }\n      )\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport {\n  OrderHistoryList,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequest,\n} from '../../../model/order.model';\nimport { ConsignmentTracking } from '../../../model/consignment-tracking.model';\n\nexport const ORDER_HISTORY_NORMALIZER = new InjectionToken<\n  Converter<any, OrderHistoryList>\n>('OrderHistoryNormalizer');\n\nexport const CONSIGNMENT_TRACKING_NORMALIZER = new InjectionToken<\n  Converter<any, ConsignmentTracking>\n>('ConsignmentTrackingNormalizer');\n\nexport const ORDER_RETURN_REQUEST_NORMALIZER = new InjectionToken<\n  Converter<any, ReturnRequest>\n>('OrderReturnRequestNormalizer');\n\nexport const ORDER_RETURN_REQUEST_INPUT_SERIALIZER = new InjectionToken<\n  Converter<ReturnRequestEntryInputList, any>\n>('OrderReturnRequestInputSerializer');\n\nexport const ORDER_RETURNS_NORMALIZER = new InjectionToken<\n  Converter<any, ReturnRequestList>\n>('OrderReturnsNormalizer');\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { ORDER_NORMALIZER } from '../../../checkout/connectors/checkout/converters';\nimport { ConsignmentTracking } from '../../../model/consignment-tracking.model';\nimport {\n  CancellationRequestEntryInputList,\n  Order,\n  OrderHistoryList,\n  ReturnRequest,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequestModification,\n} from '../../../model/order.model';\nimport {\n  CONSIGNMENT_TRACKING_NORMALIZER,\n  ORDER_HISTORY_NORMALIZER,\n  ORDER_RETURNS_NORMALIZER,\n  ORDER_RETURN_REQUEST_INPUT_SERIALIZER,\n  ORDER_RETURN_REQUEST_NORMALIZER,\n} from '../../../user/connectors/order/converters';\nimport { UserOrderAdapter } from '../../../user/connectors/order/user-order.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\nimport {\n  OCC_USER_ID_ANONYMOUS,\n  OCC_USER_ID_CURRENT,\n} from '../../utils/occ-constants';\n\n@Injectable()\nexport class OccUserOrderAdapter implements UserOrderAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  public load(userId: string, orderCode: string): Observable<Order> {\n    const url = this.occEndpoints.getUrl('orderDetail', {\n      userId,\n      orderId: orderCode,\n    });\n\n    let headers = new HttpHeaders();\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n\n    return this.http\n      .get<Occ.Order>(url, { headers })\n      .pipe(this.converter.pipeable(ORDER_NORMALIZER));\n  }\n\n  public loadHistory(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<OrderHistoryList> {\n    const params = {};\n    if (pageSize) {\n      params['pageSize'] = pageSize.toString();\n    }\n    if (currentPage) {\n      params['currentPage'] = currentPage.toString();\n    }\n    if (sort) {\n      params['sort'] = sort.toString();\n    }\n\n    const url = this.occEndpoints.getUrl('orderHistory', { userId }, params);\n\n    return this.http\n      .get<Occ.OrderHistoryList>(url)\n      .pipe(this.converter.pipeable(ORDER_HISTORY_NORMALIZER));\n  }\n\n  public getConsignmentTracking(\n    orderCode: string,\n    consignmentCode: string,\n    userId: string = OCC_USER_ID_CURRENT\n  ): Observable<ConsignmentTracking> {\n    const url = this.occEndpoints.getUrl('consignmentTracking', {\n      userId,\n      orderCode,\n      consignmentCode,\n    });\n    return this.http\n      .get<ConsignmentTracking>(url)\n      .pipe(this.converter.pipeable(CONSIGNMENT_TRACKING_NORMALIZER));\n  }\n\n  public cancel(\n    userId: string,\n    orderCode: string,\n    cancelRequestInput: CancellationRequestEntryInputList\n  ): Observable<{}> {\n    const url = this.occEndpoints.getUrl('cancelOrder', {\n      userId,\n      orderId: orderCode,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .post(url, cancelRequestInput, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  public createReturnRequest(\n    userId: string,\n    returnRequestInput: ReturnRequestEntryInputList\n  ): Observable<ReturnRequest> {\n    const url = this.occEndpoints.getUrl('returnOrder', {\n      userId,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    returnRequestInput = this.converter.convert(\n      returnRequestInput,\n      ORDER_RETURN_REQUEST_INPUT_SERIALIZER\n    );\n\n    return this.http.post(url, returnRequestInput, { headers }).pipe(\n      catchError((error: any) => throwError(error)),\n      this.converter.pipeable(ORDER_RETURN_REQUEST_NORMALIZER)\n    );\n  }\n\n  public loadReturnRequestList(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<ReturnRequestList> {\n    const params = {};\n    if (pageSize) {\n      params['pageSize'] = pageSize.toString();\n    }\n    if (currentPage) {\n      params['currentPage'] = currentPage.toString();\n    }\n    if (sort) {\n      params['sort'] = sort.toString();\n    }\n\n    const url = this.occEndpoints.getUrl('orderReturns', { userId }, params);\n\n    return this.http\n      .get<ReturnRequestList>(url)\n      .pipe(this.converter.pipeable(ORDER_RETURNS_NORMALIZER));\n  }\n\n  public loadReturnRequestDetail(\n    userId: string,\n    returnRequestCode: string\n  ): Observable<ReturnRequest> {\n    const url = this.occEndpoints.getUrl('orderReturnDetail', {\n      userId,\n      returnRequestCode,\n    });\n\n    return this.http\n      .get<ReturnRequest>(url)\n      .pipe(this.converter.pipeable(ORDER_RETURN_REQUEST_NORMALIZER));\n  }\n\n  public cancelReturnRequest(\n    userId: string,\n    returnRequestCode: string,\n    returnRequestModification: ReturnRequestModification\n  ): Observable<{}> {\n    const url = this.occEndpoints.getUrl('cancelReturn', {\n      userId,\n      returnRequestCode,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .patch(url, returnRequestModification, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { PAYMENT_DETAILS_NORMALIZER } from '../../../checkout/connectors/payment/converters';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { UserPaymentAdapter } from '../../../user/connectors/payment/user-payment.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccUserPaymentAdapter implements UserPaymentAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadAll(userId: string): Observable<PaymentDetails[]> {\n    const url =\n      this.occEndpoints.getUrl('paymentDetailsAll', { userId }) + '?saved=true';\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .get<Occ.PaymentDetailsList>(url, { headers })\n      .pipe(\n        catchError((error: any) => throwError(error)),\n        map((methodList) => methodList.payments),\n        this.converter.pipeableMany(PAYMENT_DETAILS_NORMALIZER)\n      );\n  }\n\n  delete(userId: string, paymentMethodID: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('paymentDetail', {\n      userId,\n      paymentDetailId: paymentMethodID,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .delete(url, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  setDefault(userId: string, paymentMethodID: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('paymentDetail', {\n      userId,\n      paymentDetailId: paymentMethodID,\n    });\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .patch(\n        url,\n        // TODO: Remove billingAddress property\n        { billingAddress: { titleCode: 'mr' }, defaultPayment: true },\n        { headers }\n      )\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { ReplenishmentOrderList } from '../../../model/replenishment-order.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const REPLENISHMENT_ORDER_HISTORY_NORMALIZER = new InjectionToken<\n  Converter<any, ReplenishmentOrderList>\n>('ReplenishmentOrderHistoryNormalizer');\n","import { ReplenishmentOrderList } from '../../../model/replenishment-order.model';\nimport { REPLENISHMENT_ORDER_HISTORY_NORMALIZER } from '../../../user/connectors/replenishment-order/converters';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { REPLENISHMENT_ORDER_NORMALIZER } from '../../../checkout/connectors/replenishment-order/converters';\nimport { OrderHistoryList, ReplenishmentOrder } from '../../../model/index';\nimport { ORDER_HISTORY_NORMALIZER } from '../../../user/connectors/order/converters';\nimport { UserReplenishmentOrderAdapter } from '../../../user/connectors/replenishment-order/user-replenishment-order.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccUserReplenishmentOrderAdapter\n  implements UserReplenishmentOrderAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n  public load(\n    userId: string,\n    replenishmentOrderCode: string\n  ): Observable<ReplenishmentOrder> {\n    return this.http\n      .get<Occ.ReplenishmentOrder>(\n        this.occEndpoints.getUrl('replenishmentOrderDetails', {\n          userId,\n          replenishmentOrderCode,\n        })\n      )\n      .pipe(this.converter.pipeable(REPLENISHMENT_ORDER_NORMALIZER));\n  }\n\n  public loadReplenishmentDetailsHistory(\n    userId: string,\n    replenishmentOrderCode: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<OrderHistoryList> {\n    const params = {};\n\n    if (pageSize) {\n      params['pageSize'] = pageSize.toString();\n    }\n    if (currentPage) {\n      params['currentPage'] = currentPage.toString();\n    }\n    if (sort) {\n      params['sort'] = sort.toString();\n    }\n\n    return this.http\n      .get<Occ.OrderHistoryList>(\n        this.occEndpoints.getUrl(\n          'replenishmentOrderDetailsHistory',\n          {\n            userId,\n            replenishmentOrderCode,\n          },\n          params\n        )\n      )\n      .pipe(this.converter.pipeable(ORDER_HISTORY_NORMALIZER));\n  }\n\n  public cancelReplenishmentOrder(\n    userId: string,\n    replenishmentOrderCode: string\n  ): Observable<ReplenishmentOrder> {\n    const headers = new HttpHeaders().set('Content-Type', 'application/json');\n\n    return this.http\n      .patch<Occ.ReplenishmentOrder>(\n        this.occEndpoints.getUrl('cancelReplenishmentOrder', {\n          userId,\n          replenishmentOrderCode,\n        }),\n        {},\n        { headers }\n      )\n      .pipe(this.converter.pipeable(REPLENISHMENT_ORDER_NORMALIZER));\n  }\n\n  public loadHistory(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<ReplenishmentOrderList> {\n    const params = {};\n    if (pageSize) {\n      params['pageSize'] = pageSize.toString();\n    }\n    if (currentPage) {\n      params['currentPage'] = currentPage.toString();\n    }\n    if (sort) {\n      params['sort'] = sort.toString();\n    }\n\n    const url = this.occEndpoints.getUrl(\n      'replenishmentOrderHistory',\n      { userId },\n      params\n    );\n\n    return this.http\n      .get<Occ.ReplenishmentOrderList>(url)\n      .pipe(this.converter.pipeable(REPLENISHMENT_ORDER_HISTORY_NORMALIZER));\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\n\nexport const USER_NORMALIZER = new InjectionToken<Converter<any, User>>(\n  'UserNormalizer'\n);\n\nexport const USER_SERIALIZER = new InjectionToken<Converter<User, any>>(\n  'UserSerializer'\n);\n\nexport const USER_SIGN_UP_SERIALIZER = new InjectionToken<\n  Converter<UserSignUp, any>\n>('UserSignUpSerializer');\n\nexport const TITLE_NORMALIZER = new InjectionToken<Converter<any, Title>>(\n  'TitleNormalizer'\n);\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\nimport {\n  TITLE_NORMALIZER,\n  USER_NORMALIZER,\n  USER_SERIALIZER,\n  USER_SIGN_UP_SERIALIZER,\n} from '../../../user/connectors/user/converters';\nimport { UserAdapter } from '../../../user/connectors/user/user.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\n@Injectable()\nexport class OccUserAdapter implements UserAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(userId: string): Observable<User> {\n    const url = this.occEndpoints.getUrl('user', { userId });\n    return this.http\n      .get<Occ.User>(url)\n      .pipe(this.converter.pipeable(USER_NORMALIZER));\n  }\n\n  update(userId: string, user: User): Observable<{}> {\n    const url = this.occEndpoints.getUrl('user', { userId });\n    user = this.converter.convert(user, USER_SERIALIZER);\n    return this.http.patch(url, user);\n  }\n\n  register(user: UserSignUp): Observable<User> {\n    const url: string = this.occEndpoints.getUrl('userRegister');\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    user = this.converter.convert(user, USER_SIGN_UP_SERIALIZER);\n\n    return this.http\n      .post<User>(url, user, { headers })\n      .pipe(this.converter.pipeable(USER_NORMALIZER));\n  }\n\n  registerGuest(guid: string, password: string): Observable<User> {\n    const url: string = this.occEndpoints.getUrl('userRegister');\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n\n    const httpParams: HttpParams = new HttpParams()\n      .set('guid', guid)\n      .set('password', password);\n\n    return this.http\n      .post<User>(url, httpParams, { headers })\n      .pipe(this.converter.pipeable(USER_NORMALIZER));\n  }\n\n  requestForgotPasswordEmail(userEmailAddress: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('userForgotPassword');\n    const httpParams: HttpParams = new HttpParams().set(\n      'userId',\n      userEmailAddress\n    );\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    return this.http.post(url, httpParams, { headers });\n  }\n\n  resetPassword(token: string, newPassword: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('userResetPassword');\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n\n    return this.http.post(url, { token, newPassword }, { headers });\n  }\n\n  updateEmail(\n    userId: string,\n    currentPassword: string,\n    newUserId: string\n  ): Observable<{}> {\n    const url = this.occEndpoints.getUrl('userUpdateLoginId', { userId });\n    const httpParams: HttpParams = new HttpParams()\n      .set('password', currentPassword)\n      .set('newLogin', newUserId);\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http.put(url, httpParams, { headers });\n  }\n\n  updatePassword(\n    userId: string,\n    oldPassword: string,\n    newPassword: string\n  ): Observable<{}> {\n    const url = this.occEndpoints.getUrl('userUpdatePassword', { userId });\n    const httpParams: HttpParams = new HttpParams()\n      .set('old', oldPassword)\n      .set('new', newPassword);\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http.put(url, httpParams, { headers });\n  }\n\n  remove(userId: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('user', { userId });\n    return this.http.delete<User>(url);\n  }\n\n  loadTitles(): Observable<Title[]> {\n    const url = this.occEndpoints.getUrl('titles');\n    return this.http.get<Occ.TitleList>(url).pipe(\n      map((titleList) => titleList.titles),\n      this.converter.pipeableMany(TITLE_NORMALIZER)\n    );\n  }\n}\n","import { Observable } from 'rxjs';\nimport { AnonymousConsent, ConsentTemplate } from '../../model/consent.model';\n\nexport abstract class AnonymousConsentTemplatesAdapter {\n  /**\n   * Abstract method used to load anonymous consents.\n   */\n  abstract loadAnonymousConsentTemplates(): Observable<ConsentTemplate[]>;\n\n  /**\n   * Loads anonymous consents in an optimal way.\n   */\n  abstract loadAnonymousConsents(): Observable<AnonymousConsent[]>;\n}\n","import { Observable } from 'rxjs';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\nexport abstract class UserConsentAdapter {\n  abstract loadConsents(userId: string): Observable<ConsentTemplate[]>;\n\n  abstract giveConsent(\n    userId: string,\n    consentTemplateId: string,\n    consentTemplateVersion: number\n  ): Observable<ConsentTemplate>;\n\n  abstract withdrawConsent(userId: string, consentCode: string): Observable<{}>;\n}\n","import { Observable } from 'rxjs';\nimport { CostCenter } from '../../../model/org-unit.model';\nimport { EntitiesModel } from '../../../model/misc.model';\n\nexport abstract class UserCostCenterAdapter {\n  /**\n   * Returns the list of all active cost centers of the login user\n   * @param userId\n   */\n  abstract loadActiveList(\n    userId: string\n  ): Observable<EntitiesModel<CostCenter>>;\n}\n","import { Observable } from 'rxjs';\nimport {\n  CustomerCouponSearchResult,\n  CustomerCouponNotification,\n  CustomerCoupon2Customer,\n} from '../../../model/customer-coupon.model';\n\nexport abstract class CustomerCouponAdapter {\n  abstract getCustomerCoupons(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<CustomerCouponSearchResult>;\n\n  abstract turnOnNotification(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCouponNotification>;\n\n  abstract turnOffNotification(\n    userId: string,\n    couponCode: string\n  ): Observable<{}>;\n\n  abstract claimCustomerCoupon(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCoupon2Customer>;\n}\n","import { Observable } from 'rxjs';\nimport {\n  ProductInterestSearchResult,\n  ProductInterestEntryRelation,\n  NotificationType,\n} from '../../../model/product-interest.model';\n\nexport abstract class UserInterestsAdapter {\n  /**\n   * Abstract method used to load product interests for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param pageSize\n   * @param currentPage\n   * @param sort Sorting method\n   * @param productCode The product code\n   * @param  notificationType The notification type\n   */\n  abstract getInterests(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string,\n    productCode?: string,\n    notificationType?: NotificationType\n  ): Observable<ProductInterestSearchResult>;\n\n  /**\n   * Abstract method used to remove product interest for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param ProductInterestRelation The product interest to be removed.\n   */\n  abstract removeInterest(\n    userId: string,\n    item: ProductInterestEntryRelation\n  ): Observable<any[]>;\n\n  /**\n   * Abstract method to add a product interest for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param productCode The product code\n   * @param notificationType The notification type\n   */\n  abstract addInterest(\n    userId: string,\n    productCode: string,\n    notificationType: NotificationType\n  ): Observable<any>;\n}\n","import { Observable } from 'rxjs';\nimport { ConsignmentTracking } from '../../../model/consignment-tracking.model';\nimport {\n  CancellationRequestEntryInputList,\n  Order,\n  OrderHistoryList,\n  ReturnRequest,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequestModification,\n} from '../../../model/order.model';\n\nexport abstract class UserOrderAdapter {\n  /**\n   * Abstract method used to load order data.\n   *\n   * @param userId The `userId` for given user\n   * @param orderCode The `orderCode` for given order\n   */\n  abstract load(userId: string, orderCode: string): Observable<Order>;\n\n  /**\n   * Abstract method used to load order history for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param pageSize\n   * @param currentPage\n   * @param sort Sorting method\n   */\n  abstract loadHistory(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<OrderHistoryList>;\n\n  /**\n   * Abstract method used to get consignment tracking details\n   * @param orderCode an order code\n   * @param consignmentCode a consignment code\n   * @param userId user id related to order\n   */\n  abstract getConsignmentTracking(\n    orderCode: string,\n    consignmentCode: string,\n    userId?: string\n  ): Observable<ConsignmentTracking>;\n\n  /**\n   * Abstract method used to create return request\n   * @param userId The `userId` for given user\n   * @param returnRequestInput Return request entry input list\n   */\n  abstract createReturnRequest(\n    userId: string,\n    returnRequestInput: ReturnRequestEntryInputList\n  ): Observable<ReturnRequest>;\n\n  /**\n   * Abstract method used to load order return request details\n   * @param userId\n   * @param returnRequestCode\n   */\n  abstract loadReturnRequestDetail(\n    userId: string,\n    returnRequestCode: string\n  ): Observable<ReturnRequest>;\n\n  /**\n   * Abstract method used to load order return request list for an user.\n   * @param userId\n   * @param pageSize\n   * @param currentPage\n   * @param sort\n   */\n  abstract loadReturnRequestList(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<ReturnRequestList>;\n\n  /**\n   * Abstract method used to cancel order\n   * @param userId\n   * @param orderCode\n   * @param cancelRequestInput Cancel request entry input list\n   */\n  abstract cancel(\n    userId: string,\n    orderCode: string,\n    cancelRequestInput: CancellationRequestEntryInputList\n  ): Observable<{}>;\n\n  /**\n   * Abstract method used to cancel one return request\n   * @param userId\n   * @param returnRequestCode\n   * @param returnRequestModification\n   */\n  abstract cancelReturnRequest(\n    userId: string,\n    returnRequestCode: string,\n    returnRequestModification: ReturnRequestModification\n  ): Observable<{}>;\n}\n","import { Observable } from 'rxjs';\nimport { PaymentDetails } from '../../../model/cart.model';\n\nexport abstract class UserPaymentAdapter {\n  abstract loadAll(userId: string): Observable<PaymentDetails[]>;\n\n  abstract delete(userId: string, paymentMethodID: string): Observable<{}>;\n\n  abstract setDefault(userId: string, paymentMethodID: string): Observable<{}>;\n}\n","import { Observable } from 'rxjs';\nimport {\n  OrderHistoryList,\n  ReplenishmentOrder,\n  ReplenishmentOrderList,\n} from '../../../model/index';\n\nexport abstract class UserReplenishmentOrderAdapter {\n  /**\n   * Abstract method used to load replenishment order details.\n   *\n   * @param userId The `userId` for given user\n   * @param replenishmentOrderCode The `replenishmentOrderCode` for a given scheduled replenishment\n   */\n  abstract load(\n    userId: string,\n    replenishmentOrderCode: string\n  ): Observable<ReplenishmentOrder>;\n\n  /**\n   * Abstract method used to load order history from a replenishment order.\n   *\n   * @param userId The `userId` for given user\n   * @param replenishmentOrderCode The `replenishmentOrderCode` for a given scheduled replenishment\n   * @param pageSize The `pageSize` to display number of data as order history\n   * @param currentPage The `currentPage` of the order history list\n   * @param sort The `sort` for a sorting method\n   */\n  abstract loadReplenishmentDetailsHistory(\n    userId: string,\n    replenishmentOrderCode: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<OrderHistoryList>;\n\n  /**\n   * Abstract method used to cancel a replenishment order.\n   *\n   * @param userId The `userId` for given user\n   * @param replenishmentOrderCode The `replenishmentOrderCode` for a given scheduled replenishment\n   */\n  abstract cancelReplenishmentOrder(\n    userId: string,\n    replenishmentOrderCode: string\n  ): Observable<ReplenishmentOrder>;\n\n  /**\n   * Abstract method used to load replenishment order history for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param pageSize\n   * @param currentPage\n   * @param sort Sorting method\n   */\n  abstract loadHistory(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<ReplenishmentOrderList>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport {\n  OrderHistoryList,\n  ReplenishmentOrder,\n  ReplenishmentOrderList,\n} from '../../../model/index';\nimport { UserReplenishmentOrderAdapter } from './user-replenishment-order.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserReplenishmentOrderConnector {\n  constructor(protected adapter: UserReplenishmentOrderAdapter) {}\n\n  public load(\n    userId: string,\n    replenishmentOrderCode: string\n  ): Observable<ReplenishmentOrder> {\n    return this.adapter.load(userId, replenishmentOrderCode);\n  }\n\n  public loadReplenishmentDetailsHistory(\n    userId: string,\n    replenishmentOrderCode: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<OrderHistoryList> {\n    return this.adapter.loadReplenishmentDetailsHistory(\n      userId,\n      replenishmentOrderCode,\n      pageSize,\n      currentPage,\n      sort\n    );\n  }\n\n  public cancelReplenishmentOrder(\n    userId: string,\n    replenishmentOrderCode: string\n  ): Observable<ReplenishmentOrder> {\n    return this.adapter.cancelReplenishmentOrder(\n      userId,\n      replenishmentOrderCode\n    );\n  }\n\n  public loadHistory(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<ReplenishmentOrderList> {\n    return this.adapter.loadHistory(userId, pageSize, currentPage, sort);\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\n\nexport abstract class UserAdapter {\n  abstract load(userId: string): Observable<User>;\n\n  abstract update(username: string, user: User): Observable<{}>;\n\n  abstract register(user: UserSignUp): Observable<User>;\n\n  abstract registerGuest(guid: string, password: string): Observable<User>;\n\n  abstract requestForgotPasswordEmail(userEmailAddress: string): Observable<{}>;\n\n  abstract resetPassword(token: string, newPassword: string): Observable<{}>;\n\n  abstract updateEmail(\n    userId: string,\n    currentPassword: string,\n    newUserId: string\n  ): Observable<{}>;\n\n  abstract updatePassword(\n    userId: string,\n    oldPassword: string,\n    newPassword: string\n  ): Observable<{}>;\n\n  abstract remove(userId: string): Observable<{}>;\n\n  abstract loadTitles(): Observable<Title[]>;\n}\n","import { Injectable } from '@angular/core';\nimport { Address } from '../../../../model/address.model';\nimport { EntitiesModel } from '../../../../model/misc.model';\nimport { ADDRESS_NORMALIZER } from '../../../../user/connectors/address/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccAddressListNormalizer\n  implements Converter<Occ.AddressList, EntitiesModel<Address>> {\n  constructor(private converter: ConverterService) {}\n\n  convert(\n    source: Occ.AddressList,\n    target?: EntitiesModel<Address>\n  ): EntitiesModel<Address> {\n    if (target === undefined) {\n      target = {\n        ...(source as any),\n        values: source.addresses.map((address) => ({\n          ...this.converter.convert(address, ADDRESS_NORMALIZER),\n        })),\n      };\n    }\n    return target;\n  }\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccUserConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        // tslint:disable:max-line-length\n        user: 'users/${userId}',\n        userRegister: 'users',\n        userForgotPassword: 'forgottenpasswordtokens',\n        userResetPassword: 'resetpassword',\n        userUpdateLoginId: 'users/${userId}/login',\n        userUpdatePassword: 'users/${userId}/password',\n        titles: 'titles',\n        paymentDetailsAll: 'users/${userId}/paymentdetails',\n        paymentDetail: 'users/${userId}/paymentdetails/${paymentDetailId}',\n        orderHistory: 'users/${userId}/orders',\n        orderDetail: 'users/${userId}/orders/${orderId}?fields=FULL',\n        anonymousConsentTemplates: 'users/anonymous/consenttemplates',\n        consentTemplates: 'users/${userId}/consenttemplates',\n        consents: 'users/${userId}/consents',\n        consentDetail: 'users/${userId}/consents/${consentId}',\n        addresses: 'users/${userId}/addresses',\n        addressDetail: 'users/${userId}/addresses/${addressId}',\n        addressVerification: 'users/${userId}/addresses/verification',\n        consignmentTracking:\n          'users/${userId}/orders/${orderCode}/consignments/${consignmentCode}/tracking',\n        customerCoupons: 'users/${userId}/customercoupons',\n        claimCoupon: 'users/${userId}/customercoupons/${couponCode}/claim',\n        couponNotification:\n          'users/${userId}/customercoupons/${couponCode}/notification',\n        notificationPreference: 'users/${userId}/notificationpreferences',\n        productInterests: 'users/${userId}/productinterests',\n        getProductInterests:\n          'users/${userId}/productinterests?fields=sorts,pagination,results(productInterestEntry,product(code))',\n        cancelOrder: 'users/${userId}/orders/${orderId}/cancellation',\n        returnOrder:\n          'users/${userId}/orderReturns?fields=BASIC,returnEntries(BASIC,refundAmount(formattedValue),orderEntry(basePrice(formattedValue),product(name,code,baseOptions,images(DEFAULT,galleryIndex)))),deliveryCost(formattedValue),totalPrice(formattedValue),subTotal(formattedValue)',\n        orderReturns: 'users/${userId}/orderReturns?fields=BASIC',\n        orderReturnDetail:\n          'users/${userId}/orderReturns/${returnRequestCode}?fields=BASIC,returnEntries(BASIC,refundAmount(formattedValue),orderEntry(basePrice(formattedValue),product(name,code,baseOptions,images(DEFAULT,galleryIndex)))),deliveryCost(formattedValue),totalPrice(formattedValue),subTotal(formattedValue)',\n        cancelReturn: 'users/${userId}/orderReturns/${returnRequestCode}',\n        // tslint:enable\n      },\n    },\n  },\n};\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { COST_CENTERS_NORMALIZER } from '../../../cost-center/connectors/cost-center/converters';\nimport { EntitiesModel } from '../../../model/misc.model';\nimport { CostCenter } from '../../../model/org-unit.model';\nimport { SearchConfig } from '../../../product/model/search-config';\nimport { UserCostCenterAdapter } from '../../../user/connectors/cost-center/user-cost-center.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccUserCostCenterAdapter implements UserCostCenterAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadActiveList(userId: string): Observable<EntitiesModel<CostCenter>> {\n    return this.http\n      .get<Occ.CostCentersList>(this.getCostCentersEndpoint(userId))\n      .pipe(this.converter.pipeable(COST_CENTERS_NORMALIZER));\n  }\n\n  protected getCostCentersEndpoint(\n    userId: string,\n    params?: SearchConfig\n  ): string {\n    return this.occEndpoints.getUrl('getActiveCostCenters', { userId }, params);\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { AnonymousConsentTemplatesAdapter } from '../../../anonymous-consents/connectors/anonymous-consent-templates.adapter';\nimport { ANONYMOUS_CONSENT_NORMALIZER } from '../../../anonymous-consents/connectors/converters';\nimport { provideDefaultConfig } from '../../../config/config-providers';\nimport { ADDRESS_LIST_NORMALIZER } from '../../../user/connectors/address/converters';\nimport { UserAddressAdapter } from '../../../user/connectors/address/user-address.adapter';\nimport { UserConsentAdapter } from '../../../user/connectors/consent/user-consent.adapter';\nimport { UserCostCenterAdapter } from '../../../user/connectors/cost-center/user-cost-center.adapter';\nimport { CustomerCouponAdapter } from '../../../user/connectors/customer-coupon/customer-coupon.adapter';\nimport { PRODUCT_INTERESTS_NORMALIZER } from '../../../user/connectors/interests/converters';\nimport { UserInterestsAdapter } from '../../../user/connectors/interests/user-interests.adapter';\nimport { UserNotificationPreferenceAdapter } from '../../../user/connectors/notification-preference/user-notification-preference.adapter';\nimport { ORDER_RETURN_REQUEST_NORMALIZER } from '../../../user/connectors/order/converters';\nimport { UserOrderAdapter } from '../../../user/connectors/order/user-order.adapter';\nimport { UserPaymentAdapter } from '../../../user/connectors/payment/user-payment.adapter';\nimport { UserReplenishmentOrderAdapter } from '../../../user/connectors/replenishment-order';\nimport { UserAdapter } from '../../../user/connectors/user/user.adapter';\nimport { OccCustomerCouponAdapter } from '../user/occ-customer-coupon.adapter';\nimport { AnonymousConsentNormalizer } from './converters/anonymous-consents-normalizer';\nimport { OccAddressListNormalizer } from './converters/occ-address-list-normalizer';\nimport { OccReturnRequestNormalizer } from './converters/occ-return-request-normalizer';\nimport { OccUserInterestsNormalizer } from './converters/occ-user-interests-normalizer';\nimport { defaultOccUserConfig } from './default-occ-user-config';\nimport { OccAnonymousConsentTemplatesAdapter } from './occ-anonymous-consent-templates.adapter';\nimport { OccUserAddressAdapter } from './occ-user-address.adapter';\nimport { OccUserConsentAdapter } from './occ-user-consent.adapter';\nimport { OccUserCostCenterAdapter } from './occ-user-cost-centers.adapter';\nimport { OccUserInterestsAdapter } from './occ-user-interests.adapter';\nimport { OccUserNotificationPreferenceAdapter } from './occ-user-notification-preference.adapter';\nimport { OccUserOrderAdapter } from './occ-user-order.adapter';\nimport { OccUserPaymentAdapter } from './occ-user-payment.adapter';\nimport { OccUserReplenishmentOrderAdapter } from './occ-user-replenishment-order.adapter';\nimport { OccUserAdapter } from './occ-user.adapter';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccUserConfig),\n    { provide: UserAdapter, useClass: OccUserAdapter },\n    { provide: UserAddressAdapter, useClass: OccUserAddressAdapter },\n    { provide: UserConsentAdapter, useClass: OccUserConsentAdapter },\n    {\n      provide: AnonymousConsentTemplatesAdapter,\n      useClass: OccAnonymousConsentTemplatesAdapter,\n    },\n    {\n      provide: UserPaymentAdapter,\n      useClass: OccUserPaymentAdapter,\n    },\n    { provide: UserOrderAdapter, useClass: OccUserOrderAdapter },\n    { provide: CustomerCouponAdapter, useClass: OccCustomerCouponAdapter },\n    {\n      provide: UserNotificationPreferenceAdapter,\n      useClass: OccUserNotificationPreferenceAdapter,\n    },\n    { provide: UserInterestsAdapter, useClass: OccUserInterestsAdapter },\n    { provide: UserCostCenterAdapter, useClass: OccUserCostCenterAdapter },\n    {\n      provide: PRODUCT_INTERESTS_NORMALIZER,\n      useExisting: OccUserInterestsNormalizer,\n      multi: true,\n    },\n    {\n      provide: ORDER_RETURN_REQUEST_NORMALIZER,\n      useExisting: OccReturnRequestNormalizer,\n      multi: true,\n    },\n    {\n      provide: ANONYMOUS_CONSENT_NORMALIZER,\n      useExisting: AnonymousConsentNormalizer,\n      multi: true,\n    },\n    {\n      provide: ADDRESS_LIST_NORMALIZER,\n      useExisting: OccAddressListNormalizer,\n      multi: true,\n    },\n    {\n      provide: UserReplenishmentOrderAdapter,\n      useClass: OccUserReplenishmentOrderAdapter,\n    },\n  ],\n})\nexport class UserOccModule {}\n","import { Injectable, isDevMode } from '@angular/core';\n\n@Injectable({ providedIn: 'root' })\nexport class JavaRegExpConverter {\n  /**\n   * Pattern that extracts modifiers from the Java regexp.\n   *\n   * Java regexps MAY start with ONE or MANY modifiers like `(?MODIFIERS)PATTERN`. Examples:\n   * - `(?i)` for Case Insensitive Mode: `(?i)PATTERN`\n   * - `(?u)` for Unicode-Aware Case Folding; `(?u)PATTERN`\n   * - or multiple combined:  `(?iu)PATTERN`\n   * - (more modifiers in the official Java docs https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html)\n   *\n   * This pattern extracts 3 parts from the input string, i.e. for `(?iu)PATTERN`:\n   *    1. original modifiers syntax, i.e. `(?iu)` (or undefined if no modifiers present)\n   *    2. extracted modifiers, i.e. `iu` (or undefined if no modifiers present)\n   *    3. the rest of the regexp, i.e. `PATTERN`\n   */\n  private readonly EXTRACT_JAVA_REGEXP_MODIFIERS: RegExp = /^(\\(\\?([a-z]+)\\))?(.*)/;\n\n  /**\n   * Converts RegExp from Java syntax to Javascript, by recognizing Java regexp modifiers\n   * and converting them to the Javascript ones (i.e. case insensitive mode: `(?i)PATTERN` -> `/pattern/i`)\n   *\n   * **CAUTION!** Not all features and modifiers of Java regexps are valid in Javascript!\n   * If unsupported feature or modifier is used, then `null` will be returned instead of Javascript RegExp.\n   *\n   * See differences between Java and Javascript regexps:\n   * - https://stackoverflow.com/questions/8754444/convert-javascript-regular-expression-to-java-syntax\n   * - https://en.wikipedia.org/wiki/Comparison_of_regular_expression_engines#Language_features\n   */\n  toJsRegExp(javaSyntax: string): RegExp {\n    const parts = javaSyntax.match(this.EXTRACT_JAVA_REGEXP_MODIFIERS);\n    if (!parts) {\n      return null;\n    }\n    const [, , modifiers, jsSyntax] = parts;\n    try {\n      return new RegExp(jsSyntax, modifiers);\n    } catch (error) {\n      if (isDevMode()) {\n        console.warn(\n          `WARNING: Could not convert Java regexp into Javascript. Original regexp: ${javaSyntax} \\nMessage: ${error}`\n        );\n      }\n      return null;\n    }\n  }\n}\n","import { InjectionToken } from '@angular/core';\n\n/**\n * The url of the server request when running SSR\n * */\nexport const SERVER_REQUEST_URL = new InjectionToken<string>(\n  'SERVER_REQUEST_URL'\n);\n\n/**\n * The url of the server request host when running SSR\n * */\nexport const SERVER_REQUEST_ORIGIN = new InjectionToken<string>(\n  'SERVER_REQUEST_ORIGIN'\n);\n","import { Injectable } from '@angular/core';\nimport { I18nConfig } from '../../i18n';\nimport { BaseSite } from '../../model/misc.model';\nimport { SiteContextConfig } from '../../site-context/config/site-context-config';\nimport {\n  BASE_SITE_CONTEXT_ID,\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from '../../site-context/providers/context-ids';\nimport { Occ } from '../occ-models/occ.models';\nimport { JavaRegExpConverter } from './java-reg-exp-converter';\nimport { OccLoadedConfig } from './occ-loaded-config';\n\n@Injectable({ providedIn: 'root' })\nexport class OccLoadedConfigConverter {\n  constructor(private javaRegExpConverter: JavaRegExpConverter) {}\n\n  fromOccBaseSites(baseSites: BaseSite[], currentUrl: string): OccLoadedConfig {\n    const baseSite = baseSites.find((site) =>\n      this.isCurrentBaseSite(site, currentUrl)\n    );\n    if (!baseSite) {\n      throw this.getError(\n        `Current url (${currentUrl}) doesn't match with any of url patterns of any base site.`\n      );\n    }\n\n    // Although `stores` property is an array, typically there is only one store. So we return the first store from the list.\n    const baseStore = baseSite.stores && baseSite.stores[0];\n    if (!baseStore) {\n      throw this.getError(\n        `Current base site (${baseSite.uid}) doesn't have any base store.`\n      );\n    }\n\n    return {\n      baseSite: baseSite.uid,\n      languages: this.getIsoCodes(\n        baseStore.languages,\n        baseSite.defaultLanguage || baseStore.defaultLanguage\n      ),\n      currencies: this.getIsoCodes(\n        baseStore.currencies,\n        baseStore.defaultCurrency\n      ),\n      urlParameters: this.getUrlParams(baseSite.urlEncodingAttributes),\n    };\n  }\n\n  toSiteContextConfig({\n    baseSite,\n    languages,\n    currencies,\n    urlParameters: urlEncodingAttributes,\n  }: OccLoadedConfig): SiteContextConfig {\n    const result = {\n      context: {\n        urlParameters: urlEncodingAttributes,\n        [BASE_SITE_CONTEXT_ID]: [baseSite],\n        [LANGUAGE_CONTEXT_ID]: languages,\n        [CURRENCY_CONTEXT_ID]: currencies,\n      },\n    };\n    return result;\n  }\n\n  toI18nConfig({ languages }: OccLoadedConfig): I18nConfig {\n    return { i18n: { fallbackLang: languages[0] } };\n  }\n\n  private isCurrentBaseSite(site: Occ.BaseSite, currentUrl: string): boolean {\n    const index = (site.urlPatterns || []).findIndex((javaRegexp) => {\n      const jsRegexp = this.javaRegExpConverter.toJsRegExp(javaRegexp);\n      if (jsRegexp) {\n        const result = jsRegexp.test(currentUrl);\n        return result;\n      }\n    });\n\n    return index !== -1;\n  }\n\n  /**\n   * Returns an array of url encoded site context parameters.\n   *\n   * It maps the string \"storefront\" (used in OCC) to the \"baseSite\" (used in Spartacus)\n   */\n  private getUrlParams(params: string[]): string[] {\n    const STOREFRONT_PARAM = 'storefront';\n\n    return (params || []).map((param) =>\n      param === STOREFRONT_PARAM ? BASE_SITE_CONTEXT_ID : param\n    );\n  }\n\n  /**\n   * Returns iso codes in a array, where the first element is the default iso code.\n   */\n  private getIsoCodes(\n    elements: { isocode?: string }[],\n    defaultElement: { isocode?: string }\n  ) {\n    const result = this.moveToFirst(\n      elements,\n      (el) => el.isocode === defaultElement.isocode\n    ).map((el) => el.isocode);\n    return result;\n  }\n\n  /**\n   * Moves to the start of the array the first element that satisfies the given predicate.\n   *\n   * @param array array to modify\n   * @param predicate function called on elements\n   */\n  private moveToFirst(array: any[], predicate: (el: any) => boolean): any[] {\n    array = [...array];\n    const index = array.findIndex(predicate);\n    if (index !== -1) {\n      const [el] = array.splice(index, 1);\n      array.unshift(el);\n    }\n    return array;\n  }\n\n  private getError(message: string): Error {\n    return new Error(`Error: Cannot get base site config! ${message}`);\n  }\n}\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { BaseSite } from '../../model/misc.model';\nimport { OccConfig } from '../config/occ-config';\nimport { Occ } from '../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccSitesConfigLoader {\n  constructor(protected config: OccConfig, protected http: HttpClient) {}\n\n  protected readonly endpoint =\n    'basesites?fields=baseSites(uid,defaultLanguage(isocode),urlEncodingAttributes,urlPatterns,stores(currencies(isocode),defaultCurrency(isocode),languages(isocode),defaultLanguage(isocode)))';\n\n  private get baseEndpoint(): string {\n    return (\n      (this.config.backend.occ.baseUrl || '') + this.config.backend.occ.prefix\n    );\n  }\n\n  private get url(): string {\n    return `${this.baseEndpoint}${this.endpoint}`;\n  }\n\n  load(): Observable<BaseSite[]> {\n    if (!this.config || !this.config.backend || !this.config.backend.occ) {\n      return throwError(new Error(`Missing config for OCC backend!`));\n    }\n\n    return this.http\n      .get<Occ.BaseSites>(this.url)\n      .pipe(map(({ baseSites }) => baseSites));\n  }\n}\n","import { DOCUMENT, isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport {\n  Inject,\n  Injectable,\n  isDevMode,\n  Optional,\n  PLATFORM_ID,\n} from '@angular/core';\nimport {\n  makeStateKey,\n  StateKey,\n  TransferState,\n} from '@angular/platform-browser';\nimport { Observable, of } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { deepMerge } from '../../config/utils/deep-merge';\nimport { I18nConfig } from '../../i18n/config/i18n-config';\nimport { SiteContextConfig } from '../../site-context/config/site-context-config';\nimport { SERVER_REQUEST_URL } from '../../util/ssr.tokens';\nimport { OccLoadedConfig } from './occ-loaded-config';\nimport { OccLoadedConfigConverter } from './occ-loaded-config-converter';\nimport { OccSitesConfigLoader } from './occ-sites-config-loader';\nimport { Config } from '../../config/config-tokens';\n\nexport const EXTERNAL_CONFIG_TRANSFER_ID: StateKey<string> = makeStateKey<\n  string\n>('cx-external-config');\n\n@Injectable({ providedIn: 'root' })\nexport class OccConfigLoaderService {\n  constructor(\n    @Inject(PLATFORM_ID) protected platform: any,\n    @Inject(DOCUMENT) protected document: any,\n    @Inject(Config) protected config: any,\n    protected sitesConfigLoader: OccSitesConfigLoader,\n    protected converter: OccLoadedConfigConverter,\n    @Optional() protected transferState: TransferState,\n\n    @Optional()\n    @Inject(SERVER_REQUEST_URL)\n    protected serverRequestUrl?: string\n  ) {}\n\n  private get currentUrl(): string {\n    if (isPlatformBrowser(this.platform)) {\n      return this.document.location.href;\n    }\n    if (this.serverRequestUrl) {\n      return this.serverRequestUrl;\n    }\n    if (isDevMode()) {\n      console.error(\n        `Please provide token 'SERVER_REQUEST_URL' with the requested URL for SSR`\n      );\n    }\n  }\n\n  /**\n   * Initializes the Spartacus config asynchronously basing on the external config\n   */\n  loadConfig(): Promise<I18nConfig | SiteContextConfig> {\n    return this.get()\n      .pipe(\n        tap((externalConfig) => this.transfer(externalConfig)),\n        map((externalConfig) =>\n          deepMerge({}, ...this.getConfigChunks(externalConfig))\n        )\n      )\n      .toPromise();\n  }\n\n  /**\n   * Returns the external config\n   */\n  protected get(): Observable<OccLoadedConfig> {\n    const rehydratedExternalConfig = this.rehydrate();\n\n    return rehydratedExternalConfig\n      ? of(rehydratedExternalConfig)\n      : this.load();\n  }\n\n  /**\n   * Loads the external config from backend\n   */\n  protected load(): Observable<OccLoadedConfig> {\n    return this.sitesConfigLoader\n      .load()\n      .pipe(\n        map((baseSites) =>\n          this.converter.fromOccBaseSites(baseSites, this.currentUrl)\n        )\n      );\n  }\n\n  /**\n   * Tries to rehydrate external config in the browser from SSR\n   */\n  protected rehydrate(): OccLoadedConfig {\n    if (this.transferState && isPlatformBrowser(this.platform)) {\n      return this.transferState.get(EXTERNAL_CONFIG_TRANSFER_ID, undefined);\n    }\n  }\n\n  /**\n   * Transfers the given external config in SSR to the browser\n   *\n   * @param externalConfig\n   */\n  protected transfer(externalConfig: OccLoadedConfig) {\n    if (\n      this.transferState &&\n      isPlatformServer(this.platform) &&\n      externalConfig\n    ) {\n      this.transferState.set(EXTERNAL_CONFIG_TRANSFER_ID, externalConfig);\n    }\n  }\n\n  protected getConfigChunks(\n    externalConfig: OccLoadedConfig\n  ): (I18nConfig | SiteContextConfig)[] {\n    const chunks: any[] = [this.converter.toSiteContextConfig(externalConfig)];\n\n    if (this.shouldReturnI18nChunk()) {\n      chunks.push(this.converter.toI18nConfig(externalConfig));\n    }\n\n    return chunks;\n  }\n\n  private shouldReturnI18nChunk(): boolean {\n    const fallbackLangExists =\n      typeof (\n        this.config &&\n        this.config.i18n &&\n        this.config.i18n.fallbackLang\n      ) !== 'undefined';\n    if (fallbackLangExists && isDevMode()) {\n      console.warn(\n        `There is an already provided static config for 'i18n.fallbackLang', so the value from OCC loaded config is ignored.`\n      );\n    }\n    return !fallbackLangExists;\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport {\n  ConfigInitializer,\n  CONFIG_INITIALIZER,\n} from '../../config/config-initializer/config-initializer';\nimport { SiteContextConfig } from '../../site-context/config/site-context-config';\nimport { BASE_SITE_CONTEXT_ID } from '../../site-context/providers/context-ids';\nimport { OccConfigLoaderService } from './occ-config-loader.service';\n\n/**\n * Initializes the Spartacus config asynchronously basing on the external config\n */\nexport function initConfig(\n  configLoader: OccConfigLoaderService,\n  config: SiteContextConfig\n): ConfigInitializer {\n  /**\n   * Load config for `context` from backend only when there is no static config for `context.baseSite`\n   */\n  if (!config.context || !config.context[BASE_SITE_CONTEXT_ID]) {\n    return {\n      scopes: ['context', 'i18n.fallbackLang'],\n      configFactory: () => configLoader.loadConfig(),\n    };\n  }\n  return null;\n}\n\n/**\n * Re-provides the external config chunk given before Angular bootstrap\n */\n@NgModule()\nexport class OccConfigLoaderModule {\n  static forRoot(): ModuleWithProviders<OccConfigLoaderModule> {\n    return {\n      ngModule: OccConfigLoaderModule,\n      providers: [\n        {\n          provide: CONFIG_INITIALIZER,\n          useFactory: initConfig,\n          deps: [OccConfigLoaderService, SiteContextConfig],\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import { Provider } from '@angular/core';\nimport { Meta } from '@angular/platform-browser';\nimport { OccConfig } from './occ-config';\nimport { provideConfigFactory } from '../../config/config-providers';\n\nexport const OCC_BASE_URL_META_TAG_NAME = 'occ-backend-base-url';\nexport const OCC_BASE_URL_META_TAG_PLACEHOLDER = 'OCC_BACKEND_BASE_URL_VALUE';\nexport const MEDIA_BASE_URL_META_TAG_NAME = 'media-backend-base-url';\nexport const MEDIA_BASE_URL_META_TAG_PLACEHOLDER =\n  'MEDIA_BACKEND_BASE_URL_VALUE';\n\nexport function occServerConfigFromMetaTagFactory(meta: Meta): OccConfig {\n  const baseUrl = getMetaTagContent(OCC_BASE_URL_META_TAG_NAME, meta);\n  return baseUrl && baseUrl !== OCC_BASE_URL_META_TAG_PLACEHOLDER\n    ? { backend: { occ: { baseUrl } } }\n    : {};\n}\n\nexport function mediaServerConfigFromMetaTagFactory(meta: Meta): OccConfig {\n  const baseUrl = getMetaTagContent(MEDIA_BASE_URL_META_TAG_NAME, meta);\n  return baseUrl && baseUrl !== MEDIA_BASE_URL_META_TAG_PLACEHOLDER\n    ? { backend: { media: { baseUrl } } }\n    : {};\n}\n\nfunction getMetaTagContent(name: string, meta: Meta) {\n  const metaTag = meta.getTag(`name=\"${name}\"`);\n  return metaTag && metaTag.content;\n}\n\nexport function provideConfigFromMetaTags(): Provider[] {\n  return [\n    provideConfigFactory(occServerConfigFromMetaTagFactory, [Meta]),\n    provideConfigFactory(mediaServerConfigFromMetaTagFactory, [Meta]),\n  ];\n}\n","import { OccConfig } from './occ-config';\n\nexport const defaultOccConfig: OccConfig = {\n  backend: {\n    occ: {\n      prefix: '/occ/v2/',\n    },\n    media: {},\n  },\n};\n","import { OccConfig } from './occ-config';\n\nexport function occConfigValidator(config: OccConfig) {\n  if (\n    config.backend === undefined ||\n    config.backend.occ === undefined ||\n    config.backend.occ.baseUrl === undefined\n  ) {\n    return 'Please configure backend.occ.baseUrl before using storefront library!';\n  }\n}\n","export namespace Occ {\n  /**\n   *\n   * An interface representing Country.\n   */\n  export interface Country {\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing Region.\n   */\n  export interface Region {\n    /**\n     * @member {string} [countryIso]\n     */\n    countryIso?: string;\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [isocodeShort]\n     */\n    isocodeShort?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing RegionList.\n   */\n  export interface RegionList {\n    /**\n     * @member {Region[]} [regions]\n     */\n    regions?: Region[];\n  }\n\n  export interface AddressList {\n    addresses?: Address[];\n  }\n\n  /**\n   *\n   * An interface representing Address.\n   */\n  export interface Address {\n    /**\n     * @member {string} [companyName]\n     */\n    companyName?: string;\n    /**\n     * @member {Country} [country]\n     */\n    country?: Country;\n    /**\n     * @member {boolean} [defaultAddress]\n     */\n    defaultAddress?: boolean;\n    /**\n     * @member {string} [email]\n     */\n    email?: string;\n    /**\n     * @member {string} [firstName]\n     */\n    firstName?: string;\n    /**\n     * @member {string} [formattedAddress]\n     */\n    formattedAddress?: string;\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {string} [lastName]\n     */\n    lastName?: string;\n    /**\n     * @member {string} [line1]\n     */\n    line1?: string;\n    /**\n     * @member {string} [line2]\n     */\n    line2?: string;\n    /**\n     * @member {string} [phone]\n     */\n    phone?: string;\n    /**\n     * @member {string} [town]\n     */\n    cellphone?: string;\n    /**\n     * @member {string} [postalCode]\n     */\n    postalCode?: string;\n    /**\n     * @member {Region} [region]\n     */\n    region?: Region;\n    /**\n     * @member {string} [town]\n     */\n    district?: string;\n    /**\n     * @member {boolean} [shippingAddress]\n     */\n    shippingAddress?: boolean;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n    /**\n     * @member {string} [titleCode]\n     */\n    titleCode?: string;\n    /**\n     * @member {string} [town]\n     */\n    town?: string;\n    /**\n     * @member {boolean} [visibleInAddressBook]\n     */\n    visibleInAddressBook?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing AddressList.\n   */\n  export interface AddressList {\n    /**\n     * @member {Address[]} [addresses]\n     */\n    addresses?: Address[];\n  }\n\n  /**\n   *\n   * An interface representing ErrorModel.\n   * Error message\n   *\n   */\n  export interface ErrorModel {\n    /**\n     * @member {string} [message] Descriptive, human readable error message.\n     */\n    message?: string;\n    /**\n     * @member {string} [reason] Additional classification specific for each\n     * error type e.g. 'noStock'.\n     */\n    reason?: string;\n    /**\n     * @member {string} [subject] Identifier of the related object e.g. '1'.\n     */\n    subject?: string;\n    /**\n     * @member {string} [subjectType] Type of the object related to the error\n     * e.g. 'entry'.\n     */\n    subjectType?: string;\n    /**\n     * @member {string} [type] Type of the error e.g. 'LowStockError'.\n     */\n    type?: string;\n  }\n\n  /**\n   *\n   * An interface representing ErrorList.\n   * List of errors\n   *\n   */\n  export interface ErrorList {\n    /**\n     * @member {ErrorModel[]} [errors]\n     */\n    errors?: ErrorModel[];\n  }\n\n  /**\n   *\n   * An interface representing AddressValidation.\n   */\n  export interface AddressValidation {\n    /**\n     * @member {string} [decision]\n     */\n    decision?: string;\n    /**\n     * @member {ErrorList} [errors]\n     */\n    errors?: ErrorList;\n    /**\n     * @member {Address[]} [suggestedAddresses]\n     */\n    suggestedAddresses?: Address[];\n  }\n\n  /**\n   *\n   * An interface representing Price.\n   */\n  export interface Price {\n    /**\n     * @member {string} [currencyIso]\n     */\n    currencyIso?: string;\n    /**\n     * @member {string} [formattedValue]\n     */\n    formattedValue?: string;\n    /**\n     * @member {number} [maxQuantity]\n     */\n    maxQuantity?: number;\n    /**\n     * @member {number} [minQuantity]\n     */\n    minQuantity?: number;\n    /**\n     * @member {PriceType} [priceType] Possible values include: 'BUY', 'FROM'\n     */\n    priceType?: PriceType;\n    /**\n     * @member {number} [value]\n     */\n    value?: number;\n  }\n\n  /**\n   *\n   * An interface representing Stock.\n   */\n  export interface Stock {\n    /**\n     * @member {number} [stockLevel]\n     */\n    stockLevel?: number;\n    /**\n     * @member {string} [stockLevelStatus]\n     */\n    stockLevelStatus?: string;\n  }\n\n  /**\n   *\n   * An interface representing Image.\n   */\n  export interface Image {\n    /**\n     * @member {string} [altText]\n     */\n    altText?: string;\n    /**\n     * @member {string} [format]\n     */\n    format?: string;\n    /**\n     * @member {number} [galleryIndex]\n     */\n    galleryIndex?: number;\n    /**\n     * @member {ImageType} [imageType] Possible values include: 'PRIMARY',\n     * 'GALLERY'\n     */\n    imageType?: ImageType;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing VariantOptionQualifier.\n   */\n  export interface VariantOptionQualifier {\n    /**\n     * @member {Image} [image]\n     */\n    image?: Image;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [qualifier]\n     */\n    qualifier?: string;\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing VariantOption.\n   */\n  export interface VariantOption {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Price} [priceData]\n     */\n    priceData?: Price;\n    /**\n     * @member {Stock} [stock]\n     */\n    stock?: Stock;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n    /**\n     * @member {VariantOptionQualifier[]} [variantOptionQualifiers]\n     */\n    variantOptionQualifiers?: VariantOptionQualifier[];\n  }\n\n  /**\n   *\n   * An interface representing BaseOption.\n   */\n  export interface BaseOption {\n    /**\n     * @member {VariantOption[]} [options]\n     */\n    options?: VariantOption[];\n    /**\n     * @member {VariantOption} [selected]\n     */\n    selected?: VariantOption;\n    /**\n     * @member {string} [variantType]\n     */\n    variantType?: string;\n  }\n\n  /**\n   *\n   * An interface representing SearchQuery.\n   */\n  export interface SearchQuery {\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing SearchState.\n   */\n  export interface SearchState {\n    /**\n     * @member {SearchQuery} [query]\n     */\n    query?: SearchQuery;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing Breadcrumb.\n   */\n  export interface Breadcrumb {\n    /**\n     * @member {string} [facetCode]\n     */\n    facetCode?: string;\n    /**\n     * @member {string} [facetName]\n     */\n    facetName?: string;\n    /**\n     * @member {string} [facetValueCode]\n     */\n    facetValueCode?: string;\n    /**\n     * @member {string} [facetValueName]\n     */\n    facetValueName?: string;\n    /**\n     * @member {SearchState} [removeQuery]\n     */\n    removeQuery?: SearchState;\n    /**\n     * @member {SearchState} [truncateQuery]\n     */\n    truncateQuery?: SearchState;\n  }\n\n  /**\n   *\n   * An interface representing Component.\n   */\n  export interface Component {\n    /**\n     * @member {Date} [modifiedTime]\n     */\n    modifiedTime?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {any} [otherProperties]\n     */\n    otherProperties?: any;\n    /**\n     * @member {string} [typeCode]\n     */\n    typeCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing ComponentList.\n   */\n  export interface ComponentList {\n    /**\n     * @member {Component[]} [component]\n     */\n    component?: Component[] | any[];\n  }\n\n  /**\n   *\n   * An interface representing ContentSlot.\n   */\n  export interface ContentSlot {\n    /**\n     * @member {ComponentList} [components]\n     */\n    components?: ComponentList;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [position]\n     */\n    position?: string;\n    /**\n     * @member {string} [slotId]\n     */\n    slotId?: string;\n    /**\n     * @member {boolean} [slotShared]\n     */\n    slotShared?: boolean;\n    /**\n     * @member {string} [slotStatus]\n     */\n    slotStatus?: string;\n    /**\n     * @member {any} [properties]\n     */\n    properties?: any;\n  }\n\n  /**\n   *\n   * An interface representing ContentSlotList.\n   */\n  export interface ContentSlotList {\n    /**\n     * @member {ContentSlot[]} [contentSlot]\n     */\n    contentSlot?: ContentSlot[];\n  }\n\n  /**\n   *\n   * An interface representing CMSPage.\n   */\n  export interface CMSPage {\n    /**\n     * @member {ContentSlotList} [contentSlots]\n     */\n    contentSlots?: ContentSlotList;\n    /**\n     * @member {boolean} [defaultPage]\n     */\n    defaultPage?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [template]\n     */\n    template?: string;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n    /**\n     * @member {string} [typeCode]\n     */\n    typeCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n    /**\n     * @member {string} [label]\n     */\n    label?: string;\n    /**\n     * @member {any} [properties]\n     */\n    properties?: any;\n  }\n\n  /**\n   *\n   * An interface representing CardType.\n   */\n  export interface CardType {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing CardTypeList.\n   */\n  export interface CardTypeList {\n    /**\n     * @member {CardType[]} [cardTypes]\n     */\n    cardTypes?: CardType[];\n  }\n\n  /**\n   *\n   * An interface representing PaymentType.\n   */\n  export interface PaymentType {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [displayName]\n     */\n    displayName?: string;\n  }\n\n  /**\n   *\n   * An interface representing PaymentTypeList.\n   */\n  export interface PaymentTypeList {\n    /**\n     * @member {PaymentType[]} [paymentTypes]\n     */\n    paymentTypes?: PaymentType[];\n  }\n\n  /**\n   *\n   * An interface representing PromotionOrderEntryConsumed.\n   */\n  export interface PromotionOrderEntryConsumed {\n    /**\n     * @member {number} [adjustedUnitPrice]\n     */\n    adjustedUnitPrice?: number;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {number} [orderEntryNumber]\n     */\n    orderEntryNumber?: number;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n  }\n\n  /**\n   *\n   * An interface representing PromotionRestriction.\n   */\n  export interface PromotionRestriction {\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [restrictionType]\n     */\n    restrictionType?: string;\n  }\n\n  /**\n   *\n   * An interface representing Promotion.\n   */\n  export interface Promotion {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string[]} [couldFireMessages]\n     */\n    couldFireMessages?: string[];\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [enabled]\n     */\n    enabled?: boolean;\n    /**\n     * @member {Date} [endDate]\n     */\n    endDate?: Date;\n    /**\n     * @member {string[]} [firedMessages]\n     */\n    firedMessages?: string[];\n    /**\n     * @member {number} [priority]\n     */\n    priority?: number;\n    /**\n     * @member {Image} [productBanner]\n     */\n    productBanner?: Image;\n    /**\n     * @member {string} [promotionGroup]\n     */\n    promotionGroup?: string;\n    /**\n     * @member {string} [promotionType]\n     */\n    promotionType?: string;\n    /**\n     * @member {PromotionRestriction[]} [restrictions]\n     */\n    restrictions?: PromotionRestriction[];\n    /**\n     * @member {Date} [startDate]\n     */\n    startDate?: Date;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n  }\n\n  /**\n   *\n   * An interface representing PromotionResult.\n   */\n  export interface PromotionResult {\n    /**\n     * @member {PromotionOrderEntryConsumed[]} [consumedEntries]\n     */\n    consumedEntries?: PromotionOrderEntryConsumed[];\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {Promotion} [promotion]\n     */\n    promotion?: Promotion;\n  }\n\n  /**\n   *\n   * An interface representing Currency.\n   */\n  export interface Currency {\n    /**\n     * @member {boolean} [active]\n     */\n    active?: boolean;\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [symbol]\n     */\n    symbol?: string;\n  }\n\n  /**\n   *\n   * An interface representing Voucher.\n   */\n  export interface Voucher {\n    /**\n     * @member {Price} [appliedValue]\n     */\n    appliedValue?: Price;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Currency} [currency]\n     */\n    currency?: Currency;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [freeShipping]\n     */\n    freeShipping?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [value]\n     */\n    value?: number;\n    /**\n     * @member {string} [valueFormatted]\n     */\n    valueFormatted?: string;\n    /**\n     * @member {string} [valueString]\n     */\n    valueString?: string;\n    /**\n     * @member {string} [voucherCode]\n     */\n    voucherCode?: string;\n  }\n\n  /**\n   *\n   * An interface representing DeliveryMode.\n   */\n  export interface DeliveryMode {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing GeoPoint.\n   */\n  export interface GeoPoint {\n    /**\n     * @member {number} [latitude]\n     */\n    latitude?: number;\n    /**\n     * @member {number} [longitude]\n     */\n    longitude?: number;\n  }\n\n  /**\n   *\n   * An interface representing Time.\n   */\n  export interface Time {\n    /**\n     * @member {string} [formattedHour]\n     */\n    formattedHour?: string;\n    /**\n     * @member {number} [hour]\n     */\n    hour?: number;\n    /**\n     * @member {number} [minute]\n     */\n    minute?: number;\n  }\n\n  /**\n   *\n   * An interface representing SpecialOpeningDay.\n   */\n  export interface SpecialOpeningDay {\n    /**\n     * @member {boolean} [closed]\n     */\n    closed?: boolean;\n    /**\n     * @member {Time} [closingTime]\n     */\n    closingTime?: Time;\n    /**\n     * @member {string} [comment]\n     */\n    comment?: string;\n    /**\n     * @member {Date} [date]\n     */\n    date?: Date;\n    /**\n     * @member {string} [formattedDate]\n     */\n    formattedDate?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {Time} [openingTime]\n     */\n    openingTime?: Time;\n  }\n\n  /**\n   *\n   * An interface representing WeekdayOpeningDay.\n   */\n  export interface WeekdayOpeningDay {\n    /**\n     * @member {boolean} [closed]\n     */\n    closed?: boolean;\n    /**\n     * @member {Time} [closingTime]\n     */\n    closingTime?: Time;\n    /**\n     * @member {Time} [openingTime]\n     */\n    openingTime?: Time;\n    /**\n     * @member {string} [weekDay]\n     */\n    weekDay?: string;\n  }\n\n  /**\n   *\n   * An interface representing OpeningSchedule.\n   */\n  export interface OpeningSchedule {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {SpecialOpeningDay[]} [specialDayOpeningList]\n     */\n    specialDayOpeningList?: SpecialOpeningDay[];\n    /**\n     * @member {WeekdayOpeningDay[]} [weekDayOpeningList]\n     */\n    weekDayOpeningList?: WeekdayOpeningDay[];\n  }\n\n  /**\n   *\n   * An interface representing PointOfService.\n   */\n  export interface PointOfService {\n    /**\n     * @member {Address} [address]\n     */\n    address?: Address;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [displayName]\n     */\n    displayName?: string;\n    /**\n     * @member {number} [distanceKm]\n     */\n    distanceKm?: number;\n    /**\n     * @member {{ [propertyName: string]: string }} [features]\n     */\n    features?: { [propertyName: string]: string };\n    /**\n     * @member {string} [formattedDistance]\n     */\n    formattedDistance?: string;\n    /**\n     * @member {GeoPoint} [geoPoint]\n     */\n    geoPoint?: GeoPoint;\n    /**\n     * @member {Image} [mapIcon]\n     */\n    mapIcon?: Image;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {OpeningSchedule} [openingHours]\n     */\n    openingHours?: OpeningSchedule;\n    /**\n     * @member {string} [storeContent]\n     */\n    storeContent?: string;\n    /**\n     * @member {Image[]} [storeImages]\n     */\n    storeImages?: Image[];\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing Category.\n   */\n  export interface Category {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [code]\n     */\n    name?: string;\n    /**\n     * @member {Image} [image]\n     */\n    image?: Image;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing FeatureUnit.\n   */\n  export interface FeatureUnit {\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [symbol]\n     */\n    symbol?: string;\n    /**\n     * @member {string} [unitType]\n     */\n    unitType?: string;\n  }\n\n  /**\n   *\n   * An interface representing FeatureValue.\n   */\n  export interface FeatureValue {\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing Feature.\n   */\n  export interface Feature {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {boolean} [comparable]\n     */\n    comparable?: boolean;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {FeatureUnit} [featureUnit]\n     */\n    featureUnit?: FeatureUnit;\n    /**\n     * @member {FeatureValue[]} [featureValues]\n     */\n    featureValues?: FeatureValue[];\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {boolean} [range]\n     */\n    range?: boolean;\n    /**\n     * @member {string} [type]\n     */\n    type?: string;\n  }\n\n  /**\n   *\n   * An interface representing Classification.\n   */\n  export interface Classification {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Feature[]} [features]\n     */\n    features?: Feature[];\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing FutureStock.\n   */\n  export interface FutureStock {\n    /**\n     * @member {Date} [date]\n     */\n    date?: Date;\n    /**\n     * @member {string} [formattedDate]\n     */\n    formattedDate?: string;\n    /**\n     * @member {Stock} [stock]\n     */\n    stock?: Stock;\n  }\n\n  /**\n   *\n   * An interface representing PriceRange.\n   */\n  export interface PriceRange {\n    /**\n     * @member {Price} [maxPrice]\n     */\n    maxPrice?: Price;\n    /**\n     * @member {Price} [minPrice]\n     */\n    minPrice?: Price;\n  }\n\n  /**\n   *\n   * An interface representing ProductReference.\n   */\n  export interface ProductReference {\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [preselected]\n     */\n    preselected?: boolean;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {string} [referenceType]\n     */\n    referenceType?: string;\n    /**\n     * @member {Product} [target]\n     */\n    target?: Product;\n  }\n\n  /**\n   *\n   * An interface representing Language.\n   */\n  export interface Language {\n    /**\n     * @member {boolean} [active]\n     */\n    active?: boolean;\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [nativeName]\n     */\n    nativeName?: string;\n  }\n\n  /**\n   *\n   * An interface representing User.\n   */\n  export interface User {\n    /**\n     * @member {Currency} [currency]\n     */\n    currency?: Currency;\n    /**\n     * @member {string} [customerId]\n     */\n    customerId?: string;\n    /**\n     * @member {Date} [deactivationDate]\n     */\n    deactivationDate?: Date;\n    /**\n     * @member {Address} [defaultAddress]\n     */\n    defaultAddress?: Address;\n    /**\n     * @member {string} [displayUid]\n     */\n    displayUid?: string;\n    /**\n     * @member {string} [firstName]\n     */\n    firstName?: string;\n    /**\n     * @member {Language} [language]\n     */\n    language?: Language;\n    /**\n     * @member {string} [lastName]\n     */\n    lastName?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n    /**\n     * @member {string} [titleCode]\n     */\n    titleCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing Review.\n   */\n  export interface Review {\n    /**\n     * @member {string} [alias]\n     */\n    alias?: string;\n    /**\n     * @member {string} [comment]\n     */\n    comment?: string;\n    /**\n     * @member {Date} [date]\n     */\n    date?: Date;\n    /**\n     * @member {string} [headline]\n     */\n    headline?: string;\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {User} [principal]\n     */\n    principal?: User;\n    /**\n     * @member {number} [rating]\n     */\n    rating?: number;\n  }\n\n  /**\n   *\n   * An interface representing VariantCategory.\n   */\n  export interface VariantCategory {\n    /**\n     * @member {boolean} [hasImage]\n     */\n    hasImage?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [priority]\n     */\n    priority?: number;\n  }\n\n  /**\n   *\n   * An interface representing VariantValueCategory.\n   */\n  export interface VariantValueCategory {\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [sequence]\n     */\n    sequence?: number;\n    /**\n     * @member {VariantCategory[]} [superCategories]\n     */\n    superCategories?: VariantCategory[];\n  }\n\n  /**\n   *\n   * An interface representing VariantMatrixElement.\n   */\n  export interface VariantMatrixElement {\n    /**\n     * @member {VariantMatrixElement[]} [elements]\n     */\n    elements?: VariantMatrixElement[];\n    /**\n     * @member {boolean} [isLeaf]\n     */\n    isLeaf?: boolean;\n    /**\n     * @member {VariantCategory} [parentVariantCategory]\n     */\n    parentVariantCategory?: VariantCategory;\n    /**\n     * @member {VariantOption} [variantOption]\n     */\n    variantOption?: VariantOption;\n    /**\n     * @member {VariantValueCategory} [variantValueCategory]\n     */\n    variantValueCategory?: VariantValueCategory;\n  }\n\n  /**\n   *\n   * An interface representing Product.\n   */\n  export interface Product {\n    /**\n     * @member {boolean} [availableForPickup]\n     */\n    availableForPickup?: boolean;\n    /**\n     * @member {number} [averageRating]\n     */\n    averageRating?: number;\n    /**\n     * @member {BaseOption[]} [baseOptions]\n     */\n    baseOptions?: BaseOption[];\n    /**\n     * @member {string} [baseProduct]\n     */\n    baseProduct?: string;\n    /**\n     * @member {Category[]} [categories]\n     */\n    categories?: Category[];\n    /**\n     * @member {Classification[]} [classifications]\n     */\n    classifications?: Classification[];\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {FutureStock[]} [futureStocks]\n     */\n    futureStocks?: FutureStock[];\n    /**\n     * @member {Image[]} [images]\n     */\n    images?: Image[];\n    /**\n     * @member {string} [manufacturer]\n     */\n    manufacturer?: string;\n    /**\n     * @member {boolean} [multidimensional]\n     */\n    multidimensional?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [numberOfReviews]\n     */\n    numberOfReviews?: number;\n    /**\n     * @member {Promotion[]} [potentialPromotions]\n     */\n    potentialPromotions?: Promotion[];\n    /**\n     * @member {Price} [price]\n     */\n    price?: Price;\n    /**\n     * @member {PriceRange} [priceRange]\n     */\n    priceRange?: PriceRange;\n    /**\n     * @member {ProductReference[]} [productReferences]\n     */\n    productReferences?: ProductReference[];\n    /**\n     * @member {boolean} [purchasable]\n     */\n    purchasable?: boolean;\n    /**\n     * @member {Review[]} [reviews]\n     */\n    reviews?: Review[];\n    /**\n     * @member {Stock} [stock]\n     */\n    stock?: Stock;\n    /**\n     * @member {string} [summary]\n     */\n    summary?: string;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n    /**\n     * @member {VariantMatrixElement[]} [variantMatrix]\n     */\n    variantMatrix?: VariantMatrixElement[];\n    /**\n     * @member {VariantOption[]} [variantOptions]\n     */\n    variantOptions?: VariantOption[];\n    /**\n     * @member {string} [variantType]\n     */\n    variantType?: string;\n    /**\n     * @member {Price[]} [volumePrices]\n     */\n    volumePrices?: Price[];\n    /**\n     * @member {boolean} [volumePricesFlag]\n     */\n    volumePricesFlag?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing OrderEntry.\n   */\n  export interface OrderEntry {\n    /**\n     * @member {Price} [basePrice]\n     */\n    basePrice?: Price;\n    /**\n     * @member {DeliveryMode} [deliveryMode]\n     */\n    deliveryMode?: DeliveryMode;\n    /**\n     * @member {PointOfService} [deliveryPointOfService]\n     */\n    deliveryPointOfService?: PointOfService;\n    /**\n     * @member {number} [entryNumber]\n     */\n    entryNumber?: number;\n    /**\n     * @member {Product} [product]\n     */\n    product?: Product;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n    /**\n     * @member {boolean} [updateable]\n     */\n    updateable?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing DeliveryOrderEntryGroup.\n   */\n  export interface DeliveryOrderEntryGroup {\n    /**\n     * @member {Address} [deliveryAddress]\n     */\n    deliveryAddress?: Address;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n  }\n\n  /**\n   *\n   * An interface representing PaymentDetails.\n   */\n  export interface PaymentDetails {\n    /**\n     * @member {string} [accountHolderName]\n     */\n    accountHolderName?: string;\n    /**\n     * @member {Address} [billingAddress]\n     */\n    billingAddress?: Address;\n    /**\n     * @member {string} [cardNumber]\n     */\n    cardNumber?: string;\n    /**\n     * @member {CardType} [cardType]\n     */\n    cardType?: CardType;\n    /**\n     * @member {string} [cvn]\n     */\n    cvn?: string;\n    /**\n     * @member {boolean} [defaultPayment]\n     */\n    defaultPayment?: boolean;\n    /**\n     * @member {string} [expiryMonth]\n     */\n    expiryMonth?: string;\n    /**\n     * @member {string} [expiryYear]\n     */\n    expiryYear?: string;\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {string} [issueNumber]\n     */\n    issueNumber?: string;\n    /**\n     * @member {boolean} [saved]\n     */\n    saved?: boolean;\n    /**\n     * @member {string} [startMonth]\n     */\n    startMonth?: string;\n    /**\n     * @member {string} [startYear]\n     */\n    startYear?: string;\n    /**\n     * @member {string} [subscriptionId]\n     */\n    subscriptionId?: string;\n  }\n\n  /**\n   *\n   * An interface representing PickupOrderEntryGroup.\n   */\n  export interface PickupOrderEntryGroup {\n    /**\n     * @member {PointOfService} [deliveryPointOfService]\n     */\n    deliveryPointOfService?: PointOfService;\n    /**\n     * @member {number} [distance]\n     */\n    distance?: number;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n  }\n\n  /**\n   *\n   * An interface representing Principal.\n   */\n  export interface Principal {\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing Cart.\n   */\n  export interface Cart {\n    /**\n     * @member {PromotionResult[]} [appliedOrderPromotions]\n     */\n    appliedOrderPromotions?: PromotionResult[];\n    /**\n     * @member {PromotionResult[]} [appliedProductPromotions]\n     */\n    appliedProductPromotions?: PromotionResult[];\n    /**\n     * @member {Voucher[]} [appliedVouchers]\n     */\n    appliedVouchers?: Voucher[];\n    /**\n     * @member {boolean} [calculated]\n     */\n    calculated?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Address} [deliveryAddress]\n     */\n    deliveryAddress?: Address;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {number} [deliveryItemsQuantity]\n     */\n    deliveryItemsQuantity?: number;\n    /**\n     * @member {DeliveryMode} [deliveryMode]\n     */\n    deliveryMode?: DeliveryMode;\n    /**\n     * @member {DeliveryOrderEntryGroup[]} [deliveryOrderGroups]\n     */\n    deliveryOrderGroups?: DeliveryOrderEntryGroup[];\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {Date} [expirationTime]\n     */\n    expirationTime?: Date;\n    /**\n     * @member {string} [guid]\n     */\n    guid?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {boolean} [net]\n     */\n    net?: boolean;\n    /**\n     * @member {Price} [orderDiscounts]\n     */\n    orderDiscounts?: Price;\n    /**\n     * @member {PaymentDetails} [paymentInfo]\n     */\n    paymentInfo?: PaymentDetails;\n    /**\n     * @member {number} [pickupItemsQuantity]\n     */\n    pickupItemsQuantity?: number;\n    /**\n     * @member {PickupOrderEntryGroup[]} [pickupOrderGroups]\n     */\n    pickupOrderGroups?: PickupOrderEntryGroup[];\n    /**\n     * @member {PromotionResult[]} [potentialOrderPromotions]\n     */\n    potentialOrderPromotions?: PromotionResult[];\n    /**\n     * @member {PromotionResult[]} [potentialProductPromotions]\n     */\n    potentialProductPromotions?: PromotionResult[];\n    /**\n     * @member {Price} [productDiscounts]\n     */\n    productDiscounts?: Price;\n    /**\n     * @member {Date} [saveTime]\n     */\n    saveTime?: Date;\n    /**\n     * @member {Principal} [savedBy]\n     */\n    savedBy?: Principal;\n    /**\n     * @member {string} [site]\n     */\n    site?: string;\n    /**\n     * @member {string} [store]\n     */\n    store?: string;\n    /**\n     * @member {Price} [subTotal]\n     */\n    subTotal?: Price;\n    /**\n     * @member {Price} [totalDiscounts]\n     */\n    totalDiscounts?: Price;\n    /**\n     * @member {number} [totalItems]\n     */\n    totalItems?: number;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n    /**\n     * @member {Price} [totalTax]\n     */\n    totalTax?: Price;\n    /**\n     * @member {number} [totalUnitCount]\n     */\n    totalUnitCount?: number;\n    /**\n     * @member {Principal} [user]\n     */\n    user?: Principal;\n  }\n\n  /**\n   *\n   * An interface representing CartList.\n   */\n  export interface CartList {\n    /**\n     * @member {Cart[]} [carts]\n     */\n    carts?: Cart[];\n  }\n\n  /**\n   *\n   * An interface representing CartModification.\n   */\n  export interface CartModification {\n    /**\n     * @member {boolean} [deliveryModeChanged]\n     */\n    deliveryModeChanged?: boolean;\n    /**\n     * @member {OrderEntry} [entry]\n     */\n    entry?: OrderEntry;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {number} [quantityAdded]\n     */\n    quantityAdded?: number;\n    /**\n     * @member {string} [statusCode]\n     */\n    statusCode?: string;\n    /**\n     * @member {string} [statusMessage]\n     */\n    statusMessage?: string;\n  }\n\n  /**\n   *\n   * An interface representing CategoryHierarchy.\n   */\n  export interface CategoryHierarchy {\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {Date} [lastModified]\n     */\n    lastModified?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {CategoryHierarchy[]} [subcategories]\n     */\n    subcategories?: CategoryHierarchy[];\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing CatalogVersion.\n   */\n  export interface CatalogVersion {\n    /**\n     * @member {CategoryHierarchy[]} [categories]\n     */\n    categories?: CategoryHierarchy[];\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {Date} [lastModified]\n     */\n    lastModified?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing Catalog.\n   */\n  export interface Catalog {\n    /**\n     * @member {CatalogVersion[]} [catalogVersions]\n     */\n    catalogVersions?: CatalogVersion[];\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {Date} [lastModified]\n     */\n    lastModified?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing CatalogList.\n   */\n  export interface CatalogList {\n    /**\n     * @member {Catalog[]} [catalogs]\n     */\n    catalogs?: Catalog[];\n  }\n\n  /**\n   *\n   * An interface representing ComponentIDList.\n   */\n  export interface ComponentIDList {\n    /**\n     * @member {string[]} [idList]\n     */\n    idList?: string[];\n  }\n\n  /**\n   *\n   * An interface representing ConsignmentEntry.\n   */\n  export interface ConsignmentEntry {\n    /**\n     * @member {OrderEntry} [orderEntry]\n     */\n    orderEntry?: OrderEntry;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {number} [shippedQuantity]\n     */\n    shippedQuantity?: number;\n  }\n\n  /**\n   *\n   * An interface representing Consignment.\n   */\n  export interface Consignment {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {PointOfService} [deliveryPointOfService]\n     */\n    deliveryPointOfService?: PointOfService;\n    /**\n     * @member {ConsignmentEntry[]} [entries]\n     */\n    entries?: ConsignmentEntry[];\n    /**\n     * @member {Address} [shippingAddress]\n     */\n    shippingAddress?: Address;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {Date} [statusDate]\n     */\n    statusDate?: Date;\n    /**\n     * @member {string} [trackingID]\n     */\n    trackingID?: string;\n  }\n\n  /**\n   *\n   * An interface representing CountryList.\n   */\n  export interface CountryList {\n    /**\n     * @member {Country[]} [countries]\n     */\n    countries?: Country[];\n  }\n\n  /**\n   *\n   * An interface representing CurrencyList.\n   */\n  export interface CurrencyList {\n    /**\n     * @member {Currency[]} [currencies]\n     */\n    currencies?: Currency[];\n  }\n\n  /**\n   * An interface representing CustomerCoupon\n   */\n  export interface CustomerCoupon {\n    /**\n     * @member {string} [couponId]\n     */\n    couponId?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [startDate]\n     */\n    startDate?: string;\n    /**\n     * @member {string} [endDate]\n     */\n    endDate?: string;\n    /**\n     * @member {string} [endDate]\n     */\n    status?: string;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [notificationOn]\n     */\n    notificationOn?: boolean;\n    /**\n     * @member {boolean} [allProductsApplicable]\n     */\n    allProductsApplicable?: boolean;\n  }\n\n  /**\n   * An interface representing CustomerCouponSearchResult\n   */\n  export interface CustomerCouponSearchResult {\n    /**\n     * @member {CustomerCoupon[]} [coupons]\n     */\n    coupons?: CustomerCoupon[];\n    /**\n     * @member {Sort[]} [sorts]\n     */\n    sorts?: Sort[];\n    /**\n     * @member {Pagination} [pagination]\n     */\n    pagination?: Pagination;\n  }\n\n  /**\n   *\n   * An interface representing DeliveryModeList.\n   */\n  export interface DeliveryModeList {\n    /**\n     * @member {DeliveryMode[]} [deliveryModes]\n     */\n    deliveryModes?: DeliveryMode[];\n  }\n\n  /**\n   *\n   * An interface representing FacetValue.\n   */\n  export interface FacetValue {\n    /**\n     * @member {number} [count]\n     */\n    count?: number;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {SearchState} [query]\n     */\n    query?: SearchState;\n    /**\n     * @member {boolean} [selected]\n     */\n    selected?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing Facet.\n   */\n  export interface Facet {\n    /**\n     * @member {boolean} [category]\n     */\n    category?: boolean;\n    /**\n     * @member {boolean} [multiSelect]\n     */\n    multiSelect?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [priority]\n     */\n    priority?: number;\n    /**\n     * @member {FacetValue[]} [topValues]\n     */\n    topValues?: FacetValue[];\n    /**\n     * @member {FacetValue[]} [values]\n     */\n    values?: FacetValue[];\n    /**\n     * @member {boolean} [visible]\n     */\n    visible?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing LanguageList.\n   */\n  export interface LanguageList {\n    /**\n     * @member {Language[]} [languages]\n     */\n    languages?: Language[];\n  }\n\n  /**\n   *\n   * An interface representing Pagination.\n   * Pagination info\n   *\n   */\n  export interface Pagination {\n    /**\n     * @member {number} [count] Number of elements on this page\n     */\n    count?: number;\n    /**\n     * @member {number} [page] Current page number\n     */\n    page?: number;\n    /**\n     * @member {number} [totalCount] Total number of elements\n     */\n    totalCount?: number;\n    /**\n     * @member {number} [totalPages] Total number of pages\n     */\n    totalPages?: number;\n  }\n\n  /**\n   *\n   * An interface representing Sort.\n   * Sort option\n   *\n   */\n  export interface Sort {\n    /**\n     * @member {boolean} [asc]\n     */\n    asc?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n  }\n\n  /**\n   *\n   * An interface representing ListAdaptedComponents.\n   */\n  export interface ListAdaptedComponents {\n    /**\n     * @member {any[]} [components]\n     */\n    components?: any[];\n    /**\n     * @member {Pagination} [pagination]\n     */\n    pagination?: Pagination;\n    /**\n     * @member {Sort[]} [sorts]\n     */\n    sorts?: Sort[];\n  }\n\n  /**\n   *\n   * An interface representing MemberList.\n   */\n  export interface MemberList {\n    /**\n     * @member {Principal[]} [members]\n     */\n    members?: Principal[];\n  }\n\n  /**\n   *\n   * An interface representing OrderEntryList.\n   */\n  export interface OrderEntryList {\n    /**\n     * @member {OrderEntry[]} [orderEntries]\n     */\n    orderEntries?: OrderEntry[];\n  }\n\n  /**\n   *\n   * An interface representing OrderHistory.\n   */\n  export interface OrderHistory {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [guid]\n     */\n    guid?: string;\n    /**\n     * @member {Date} [placed]\n     */\n    placed?: Date;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {string} [statusDisplay]\n     */\n    statusDisplay?: string;\n    /**\n     * @member {Price} [total]\n     */\n    total?: Price;\n  }\n\n  /**\n   *\n   * An interface representing PaginationModel.\n   */\n  export interface PaginationModel {\n    /**\n     * @member {number} [currentPage]\n     */\n    currentPage?: number;\n    /**\n     * @member {number} [pageSize]\n     */\n    pageSize?: number;\n    /**\n     * @member {string} [sort]\n     */\n    sort?: string;\n    /**\n     * @member {number} [totalPages]\n     */\n    totalPages?: number;\n    /**\n     * @member {number} [totalResults]\n     */\n    totalResults?: number;\n  }\n\n  /**\n   *\n   * An interface representing SortModel.\n   */\n  export interface SortModel {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {boolean} [selected]\n     */\n    selected?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing OrderHistoryList.\n   */\n  export interface OrderHistoryList {\n    /**\n     * @member {OrderHistory[]} [orders]\n     */\n    orders?: OrderHistory[];\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n  }\n\n  /**\n   *\n   * An interface representing OrderStatusUpdateElement.\n   */\n  export interface OrderStatusUpdateElement {\n    /**\n     * @member {string} [baseSiteId]\n     */\n    baseSiteId?: string;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n  }\n\n  /**\n   *\n   * An interface representing OrderStatusUpdateElementList.\n   */\n  export interface OrderStatusUpdateElementList {\n    /**\n     * @member {OrderStatusUpdateElement[]} [orderStatusUpdateElements]\n     */\n    orderStatusUpdateElements?: OrderStatusUpdateElement[];\n  }\n\n  /**\n   *\n   * An interface representing Order.\n   */\n  export interface Order {\n    /**\n     * @member {PromotionResult[]} [appliedOrderPromotions]\n     */\n    appliedOrderPromotions?: PromotionResult[];\n    /**\n     * @member {PromotionResult[]} [appliedProductPromotions]\n     */\n    appliedProductPromotions?: PromotionResult[];\n    /**\n     * @member {Voucher[]} [appliedVouchers]\n     */\n    appliedVouchers?: Voucher[];\n    /**\n     * @member {boolean} [calculated]\n     */\n    calculated?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Consignment[]} [consignments]\n     */\n    consignments?: Consignment[];\n    /**\n     * @member {Date} [created]\n     */\n    created?: Date;\n    /**\n     * @member {Address} [deliveryAddress]\n     */\n    deliveryAddress?: Address;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {number} [deliveryItemsQuantity]\n     */\n    deliveryItemsQuantity?: number;\n    /**\n     * @member {DeliveryMode} [deliveryMode]\n     */\n    deliveryMode?: DeliveryMode;\n    /**\n     * @member {DeliveryOrderEntryGroup[]} [deliveryOrderGroups]\n     */\n    deliveryOrderGroups?: DeliveryOrderEntryGroup[];\n    /**\n     * @member {string} [deliveryStatus]\n     */\n    deliveryStatus?: string;\n    /**\n     * @member {string} [deliveryStatusDisplay]\n     */\n    deliveryStatusDisplay?: string;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {boolean} [guestCustomer]\n     */\n    guestCustomer?: boolean;\n    /**\n     * @member {string} [guid]\n     */\n    guid?: string;\n    /**\n     * @member {boolean} [net]\n     */\n    net?: boolean;\n    /**\n     * @member {Price} [orderDiscounts]\n     */\n    orderDiscounts?: Price;\n    /**\n     * @member {PaymentDetails} [paymentInfo]\n     */\n    paymentInfo?: PaymentDetails;\n    /**\n     * @member {number} [pickupItemsQuantity]\n     */\n    pickupItemsQuantity?: number;\n    /**\n     * @member {PickupOrderEntryGroup[]} [pickupOrderGroups]\n     */\n    pickupOrderGroups?: PickupOrderEntryGroup[];\n    /**\n     * @member {Price} [productDiscounts]\n     */\n    productDiscounts?: Price;\n    /**\n     * @member {string} [site]\n     */\n    site?: string;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {string} [statusDisplay]\n     */\n    statusDisplay?: string;\n    /**\n     * @member {string} [store]\n     */\n    store?: string;\n    /**\n     * @member {Price} [subTotal]\n     */\n    subTotal?: Price;\n    /**\n     * @member {Price} [totalDiscounts]\n     */\n    totalDiscounts?: Price;\n    /**\n     * @member {number} [totalItems]\n     */\n    totalItems?: number;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n    /**\n     * @member {Price} [totalTax]\n     */\n    totalTax?: Price;\n    /**\n     * @member {OrderEntry[]} [unconsignedEntries]\n     */\n    unconsignedEntries?: OrderEntry[];\n    /**\n     * @member {Principal} [user]\n     */\n    user?: Principal;\n  }\n\n  /**\n   *\n   * An interface representing ReturnRequest.\n   */\n  export interface ReturnRequest {\n    /**\n     * @member {boolean} [cancellable]\n     */\n    cancellable?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Date} [creationTime]\n     */\n    creationTime?: Date;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {order} [order]\n     */\n    order?: Order;\n    /**\n     * @member {boolean} [refundDeliveryCost]\n     */\n    refundDeliveryCost?: boolean;\n    /**\n     * @member {ReturnRequestEntry[]} [returnEntries]\n     */\n    returnEntries?: ReturnRequestEntry[];\n    /**\n     * @member {string} [returnLabelDownloadUrl]\n     */\n    returnLabelDownloadUrl?: string;\n    /**\n     * @member {string} [rma]\n     */\n    rma?: string;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {Price} [subTotal]\n     */\n    subTotal?: Price;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n  }\n\n  /**\n   *\n   * An interface representing ReturnRequestEntry.\n   */\n  export interface ReturnRequestEntry {\n    /**\n     * @member {OrderEntry} [orderEntry]\n     */\n    orderEntry?: OrderEntry;\n    /**\n     * @member {number} [expectedQuantity]\n     */\n    expectedQuantity?: number;\n    /**\n     * @member {Price} [refundAmount]\n     */\n    refundAmount?: Price;\n  }\n\n  /**\n   *\n   * An interface representing PaymentDetailsList.\n   */\n  export interface PaymentDetailsList {\n    /**\n     * @member {PaymentDetails[]} [payments]\n     */\n    payments?: PaymentDetails[];\n  }\n\n  /**\n   *\n   * An interface representing PointOfServiceStock.\n   */\n  export interface PointOfServiceStock {\n    /**\n     * @member {Address} [address]\n     */\n    address?: Address;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [displayName]\n     */\n    displayName?: string;\n    /**\n     * @member {number} [distanceKm]\n     */\n    distanceKm?: number;\n    /**\n     * @member {{ [propertyName: string]: string }} [features]\n     */\n    features?: { [propertyName: string]: string };\n    /**\n     * @member {string} [formattedDistance]\n     */\n    formattedDistance?: string;\n    /**\n     * @member {GeoPoint} [geoPoint]\n     */\n    geoPoint?: GeoPoint;\n    /**\n     * @member {Image} [mapIcon]\n     */\n    mapIcon?: Image;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {OpeningSchedule} [openingHours]\n     */\n    openingHours?: OpeningSchedule;\n    /**\n     * @member {Stock} [stockInfo]\n     */\n    stockInfo?: Stock;\n    /**\n     * @member {string} [storeContent]\n     */\n    storeContent?: string;\n    /**\n     * @member {Image[]} [storeImages]\n     */\n    storeImages?: Image[];\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductExpressUpdateElement.\n   */\n  export interface ProductExpressUpdateElement {\n    /**\n     * @member {string} [catalogId]\n     */\n    catalogId?: string;\n    /**\n     * @member {string} [catalogVersion]\n     */\n    catalogVersion?: string;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductExpressUpdateElementList.\n   */\n  export interface ProductExpressUpdateElementList {\n    /**\n     * @member {ProductExpressUpdateElement[]} [productExpressUpdateElements]\n     */\n    productExpressUpdateElements?: ProductExpressUpdateElement[];\n  }\n\n  /**\n   *\n   * An interface representing ProductList.\n   */\n  export interface ProductList {\n    /**\n     * @member {string} [catalog]\n     */\n    catalog?: string;\n    /**\n     * @member {number} [currentPage]\n     */\n    currentPage?: number;\n    /**\n     * @member {Product[]} [products]\n     */\n    products?: Product[];\n    /**\n     * @member {number} [totalPageCount]\n     */\n    totalPageCount?: number;\n    /**\n     * @member {number} [totalProductCount]\n     */\n    totalProductCount?: number;\n    /**\n     * @member {string} [version]\n     */\n    version?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductReferenceList.\n   */\n  export interface ProductReferenceList {\n    /**\n     * @member {ProductReference[]} [references]\n     */\n    references?: ProductReference[];\n  }\n\n  /**\n   *\n   * An interface representing SpellingSuggestion.\n   */\n  export interface SpellingSuggestion {\n    /**\n     * @member {string} [query]\n     */\n    query?: string;\n    /**\n     * @member {string} [suggestion]\n     */\n    suggestion?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductSearchPage.\n   */\n  export interface ProductSearchPage {\n    /**\n     * @member {Breadcrumb[]} [breadcrumbs]\n     */\n    breadcrumbs?: Breadcrumb[];\n    /**\n     * @member {string} [categoryCode]\n     */\n    categoryCode?: string;\n    /**\n     * @member {SearchState} [currentQuery]\n     */\n    currentQuery?: SearchState;\n    /**\n     * @member {Facet[]} [facets]\n     */\n    facets?: Facet[];\n    /**\n     * @member {string} [freeTextSearch]\n     */\n    freeTextSearch?: string;\n    /**\n     * @member {string} [keywordRedirectUrl]\n     */\n    keywordRedirectUrl?: string;\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {Product[]} [products]\n     */\n    products?: Product[];\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n    /**\n     * @member {SpellingSuggestion} [spellingSuggestion]\n     */\n    spellingSuggestion?: SpellingSuggestion;\n  }\n\n  /**\n   *\n   * An interface representing PromotionList.\n   */\n  export interface PromotionList {\n    /**\n     * @member {Promotion[]} [promotions]\n     */\n    promotions?: Promotion[];\n  }\n\n  /**\n   *\n   * An interface representing PromotionResultList.\n   */\n  export interface PromotionResultList {\n    /**\n     * @member {PromotionResult[]} [promotions]\n     */\n    promotions?: PromotionResult[];\n  }\n\n  /**\n   *\n   * An interface representing ReviewList.\n   */\n  export interface ReviewList {\n    /**\n     * @member {Review[]} [reviews]\n     */\n    reviews?: Review[];\n  }\n\n  /**\n   *\n   * An interface representing SaveCartResult.\n   */\n  export interface SaveCartResult {\n    /**\n     * @member {Cart} [savedCartData]\n     */\n    savedCartData?: Cart;\n  }\n\n  /**\n   *\n   * An interface representing StoreFinderSearchPage.\n   */\n  export interface StoreFinderSearchPage {\n    /**\n     * @member {number} [boundEastLongitude]\n     */\n    boundEastLongitude?: number;\n    /**\n     * @member {number} [boundNorthLatitude]\n     */\n    boundNorthLatitude?: number;\n    /**\n     * @member {number} [boundSouthLatitude]\n     */\n    boundSouthLatitude?: number;\n    /**\n     * @member {number} [boundWestLongitude]\n     */\n    boundWestLongitude?: number;\n    /**\n     * @member {string} [locationText]\n     */\n    locationText?: string;\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n    /**\n     * @member {number} [sourceLatitude]\n     */\n    sourceLatitude?: number;\n    /**\n     * @member {number} [sourceLongitude]\n     */\n    sourceLongitude?: number;\n    /**\n     * @member {PointOfService[]} [stores]\n     */\n    stores?: PointOfService[];\n  }\n\n  /**\n   *\n   * An interface representing StoreFinderStockSearchPage.\n   */\n  export interface StoreFinderStockSearchPage {\n    /**\n     * @member {number} [boundEastLongitude]\n     */\n    boundEastLongitude?: number;\n    /**\n     * @member {number} [boundNorthLatitude]\n     */\n    boundNorthLatitude?: number;\n    /**\n     * @member {number} [boundSouthLatitude]\n     */\n    boundSouthLatitude?: number;\n    /**\n     * @member {number} [boundWestLongitude]\n     */\n    boundWestLongitude?: number;\n    /**\n     * @member {string} [locationText]\n     */\n    locationText?: string;\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {Product} [product]\n     */\n    product?: Product;\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n    /**\n     * @member {number} [sourceLatitude]\n     */\n    sourceLatitude?: number;\n    /**\n     * @member {number} [sourceLongitude]\n     */\n    sourceLongitude?: number;\n    /**\n     * @member {PointOfServiceStock[]} [stores]\n     */\n    stores?: PointOfServiceStock[];\n  }\n\n  /**\n   *\n   * An interface representing Suggestion.\n   */\n  export interface Suggestion {\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing SuggestionList.\n   */\n  export interface SuggestionList {\n    /**\n     * @member {Suggestion[]} [suggestions]\n     */\n    suggestions?: Suggestion[];\n  }\n\n  /**\n   *\n   * An interface representing Title.\n   */\n  export interface Title {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing TitleList.\n   */\n  export interface TitleList {\n    /**\n     * @member {Title[]} [titles]\n     */\n    titles?: Title[];\n  }\n\n  /**\n   *\n   * An interface representing UserGroup.\n   */\n  export interface UserGroup {\n    /**\n     * @member {Principal[]} [members]\n     */\n    members?: Principal[];\n    /**\n     * @member {number} [membersCount]\n     */\n    membersCount?: number;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {UserGroup[]} [subGroups]\n     */\n    subGroups?: UserGroup[];\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  export interface StoreCount {\n    count?: number;\n    isoCode?: string;\n    name?: string;\n    type?: string;\n  }\n\n  export interface StoreCountList {\n    countriesAndRegionsStoreCount?: StoreCount[];\n  }\n\n  /**\n   *\n   * An interface representing VoucherList.\n   */\n  export interface VoucherList {\n    /**\n     * @member {Voucher[]} [vouchers]\n     */\n    vouchers?: Voucher[];\n  }\n\n  /**\n   * Defines values for PriceType.\n   * Possible values include: 'BUY', 'FROM'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: PriceType = <PriceType>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum PriceType {\n    BUY = 'BUY',\n    FROM = 'FROM',\n  }\n\n  /**\n   * Defines values for ImageType.\n   * Possible values include: 'PRIMARY', 'GALLERY'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: ImageType = <ImageType>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum ImageType {\n    PRIMARY = 'PRIMARY',\n    GALLERY = 'GALLERY',\n  }\n\n  /**\n   * Defines values for Fields.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields = <Fields>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields1.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields1 = <Fields1>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields1 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields2.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields2 = <Fields2>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields2 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields3.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields3 = <Fields3>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields3 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields4.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields4 = <Fields4>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields4 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields5.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields5 = <Fields5>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields5 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields6.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields6 = <Fields6>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields6 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for PageType.\n   * Possible values include: 'ContentPage', 'ProductPage', 'CategoryPage',\n   * 'CatalogPage'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: PageType = <PageType>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum PageType {\n    CONTENT_PAGE = 'ContentPage',\n    PRODUCT_PAGE = 'ProductPage',\n    CATEGORY_PAGE = 'CategoryPage',\n    CATALOG_PAGE = 'CatalogPage',\n  }\n\n  /**\n   * Defines values for Fields7.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields7 = <Fields7>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields7 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields8.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields8 = <Fields8>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields8 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields9.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields9 = <Fields9>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields9 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields10.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields10 = <Fields10>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields10 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields11.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields11 = <Fields11>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields11 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields12.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields12 = <Fields12>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields12 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields13.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields13 = <Fields13>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields13 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields14.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields14 = <Fields14>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields14 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields15.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields15 = <Fields15>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields15 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields16.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields16 = <Fields16>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields16 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for SortEnum.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: SortEnum = <SortEnum>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum SortEnum {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields17.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields17 = <Fields17>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields17 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields18.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields18 = <Fields18>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields18 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields19.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields19 = <Fields19>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields19 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields20.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields20 = <Fields20>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields20 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields21.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields21 = <Fields21>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields21 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields22.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields22 = <Fields22>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields22 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields23.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields23 = <Fields23>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields23 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields24.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields24 = <Fields24>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields24 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields25.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields25 = <Fields25>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields25 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields26.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields26 = <Fields26>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields26 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields27.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields27 = <Fields27>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields27 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields28.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields28 = <Fields28>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields28 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields29.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields29 = <Fields29>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields29 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields30.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields30 = <Fields30>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields30 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields31.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields31 = <Fields31>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields31 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields32.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields32 = <Fields32>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields32 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields33.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields33 = <Fields33>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields33 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields34.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields34 = <Fields34>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields34 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields35.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields35 = <Fields35>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields35 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields36.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields36 = <Fields36>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields36 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields37.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields37 = <Fields37>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields37 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields38.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields38 = <Fields38>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields38 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields39.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields39 = <Fields39>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields39 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields40.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields40 = <Fields40>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields40 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields41.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields41 = <Fields41>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields41 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields42.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields42 = <Fields42>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields42 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields43.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields43 = <Fields43>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields43 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields44.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields44 = <Fields44>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields44 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields45.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields45 = <Fields45>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields45 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields46.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields46 = <Fields46>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields46 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields47.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields47 = <Fields47>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields47 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields48.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields48 = <Fields48>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields48 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields49.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields49 = <Fields49>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields49 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields50.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields50 = <Fields50>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields50 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields51.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields51 = <Fields51>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields51 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields52.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields52 = <Fields52>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields52 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields53.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields53 = <Fields53>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields53 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields54.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields54 = <Fields54>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields54 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields55.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields55 = <Fields55>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields55 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields56.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields56 = <Fields56>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields56 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields57.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields57 = <Fields57>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields57 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields58.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields58 = <Fields58>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields58 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields59.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields59 = <Fields59>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields59 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields60.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields60 = <Fields60>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields60 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields61.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields61 = <Fields61>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields61 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Type.\n   * Possible values include: 'all', 'product', 'order'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Type = <Type>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Type {\n    All = 'all',\n    Product = 'product',\n    Order = 'order',\n  }\n\n  export interface AnonymousConsent {\n    templateCode?: string;\n    version?: number;\n    consentState?: CONSENT_STATUS;\n  }\n\n  export enum CONSENT_STATUS {\n    ANONYMOUS_CONSENT_GIVEN = 'GIVEN',\n    ANONYMOUS_CONSENT_WITHDRAWN = 'WITHDRAWN',\n  }\n\n  export interface ConsentTemplate {\n    id?: string;\n    name?: string;\n    description?: string;\n    version?: number;\n    currentConsent?: Consent;\n  }\n\n  export interface Consent {\n    code?: string;\n    consentGivenDate?: Date;\n    consentWithdrawnDate?: Date;\n  }\n\n  export interface ConsentTemplateList {\n    consentTemplates?: ConsentTemplate[];\n  }\n\n  export interface BaseSites {\n    baseSites?: BaseSite[];\n  }\n\n  export interface BaseSite {\n    channel?: string;\n    defaultLanguage?: Language;\n    defaultPreviewCatalogId?: string;\n    defaultPreviewCategoryCode?: string;\n    defaultPreviewProductCode?: string;\n    locale?: string;\n    name?: string;\n    theme?: string;\n    uid?: string;\n    stores?: BaseStore[];\n    urlPatterns?: string[];\n    urlEncodingAttributes?: string[];\n  }\n\n  export interface BaseStore {\n    currencies?: Currency[];\n    defaultCurrency?: Currency;\n    languages?: Language[];\n    defaultLanguage?: Language;\n  }\n\n  export interface ProductInterestEntry {\n    interestType?: NotificationType;\n    dateAdded?: string;\n    expirationDate?: string;\n  }\n\n  export interface ProductInterestEntryRelation {\n    product?: Product;\n    productInterestEntry?: ProductInterestEntry[];\n  }\n\n  export interface ProductInterestSearchResult {\n    results?: ProductInterestEntryRelation[];\n    sorts?: Sort[];\n    pagination?: Pagination;\n  }\n\n  export enum NotificationType {\n    BACK_IN_STOCK = 'BACK_IN_STOCK',\n  }\n\n  export interface Budget {\n    active?: boolean;\n    budget?: number;\n    code?: string;\n    currency?: Currency;\n    endDate?: string;\n    startDate?: string;\n    name?: string;\n    orgUnit?: B2BUnit;\n    costCenters?: CostCenter[];\n  }\n\n  export interface BudgetsList {\n    budgets?: Budget[];\n    pagination?: PaginationModel;\n    sorts?: SortModel[];\n  }\n\n  export interface CostCenter {\n    active?: string;\n    activeFlag?: boolean;\n    code?: string;\n    currency?: Currency;\n    name?: string;\n    originalCode?: string;\n    unit?: B2BUnit;\n  }\n\n  export interface CostCentersList {\n    costCenters: CostCenter[];\n    pagination?: PaginationModel;\n    sorts?: SortModel[];\n  }\n\n  // TODO(#8878): Which models we can remove from here?\n  export interface OrgUnitUserGroup {\n    members?: B2BUser[];\n    membersCoun?: number;\n    name?: string;\n    orgUnit?: B2BUnit;\n    permissions?: Permission[];\n    roles?: any;\n    selected?: boolean;\n    subGroups?: any;\n    uid?: string;\n  }\n\n  export interface OrgUnitUserGroupList {\n    orgUnitUserGroups: OrgUnitUserGroup[];\n    pagination?: PaginationModel;\n    sorts?: SortModel[];\n  }\n\n  export interface B2BUnitNode {\n    active?: boolean;\n    children?: B2BUnitNode[];\n    id?: string;\n    name?: string;\n    parent?: string;\n  }\n\n  export interface B2BUnitNodeList {\n    unitNodes?: B2BUnitNode[];\n  }\n\n  export interface B2BUser extends User {\n    active?: boolean;\n    approvers?: [];\n    orgUnit?: B2BUnit;\n    roles?: string[];\n    selected?: boolean;\n  }\n\n  export interface OrgUnitUserList {\n    users: B2BUser[];\n    pagination?: PaginationModel;\n    sorts?: SortModel[];\n  }\n\n  export interface B2BApprovalProcess {\n    code?: string;\n    name?: string;\n  }\n\n  export interface B2BApprovalProcessList {\n    approvalProcesses?: B2BApprovalProcess[];\n  }\n\n  export interface B2BUnit {\n    active?: boolean;\n    addresses?: Address[];\n    uid?: string;\n    name?: string;\n    parentOrgUnit?: Partial<B2BUnit>;\n    approvalProcess?: B2BApprovalProcess;\n    administrators?: B2BUser[];\n    approvers?: B2BUser[];\n    customers?: B2BUser[];\n    managers?: B2BUser[];\n  }\n\n  export interface OrderApprovalPermissionType {\n    code?: string;\n    name?: string;\n  }\n\n  export interface OrderApprovalPermissionTypeList {\n    orderApprovalPermissionTypes?: OrderApprovalPermissionType[];\n  }\n\n  export enum Period {\n    DAY = 'DAY',\n    WEEK = 'WEEK',\n    MONTH = 'MONTH',\n    QUARTER = 'QUARTER',\n    YEAR = 'YEAR',\n  }\n\n  export interface Permission {\n    active?: boolean;\n    code?: string;\n    currency?: Currency;\n    orderApprovalPermissionType?: OrderApprovalPermissionType;\n    orgUnit?: B2BUnitNode;\n    periodRange?: Period;\n    selected?: boolean;\n    treshold?: number;\n  }\n\n  export interface PermissionsList {\n    orderApprovalPermissions?: Permission[];\n    pagination?: PaginationModel;\n    sorts?: SortModel[];\n  }\n\n  export interface ReplenishmentOrder {\n    active?: boolean;\n    appliedOrderPromotions?: PromotionResult[];\n    appliedProductPromotions?: PromotionResult[];\n    appliedVouchers?: Voucher[];\n    calculated?: boolean;\n    code?: string;\n    costCenter?: CostCenter;\n    deliveryAddress?: Address;\n    deliveryCost?: Price;\n    deliveryItemsQuantity?: number;\n    deliveryMode?: DeliveryMode;\n    deliveryOrderGroups?: DeliveryOrderEntryGroup[];\n    description?: string;\n    entries?: OrderEntry[];\n    expirationTime?: string;\n    firstDate?: string;\n    guid?: string;\n    name?: string;\n    net?: boolean;\n    orderDiscounts?: Price;\n    paymentInfo?: PaymentDetails;\n    paymentStatus?: string;\n    paymentType?: PaymentType;\n    pickupItemsQuantity?: number;\n    pickupOrderGroups?: PickupOrderEntryGroup[];\n    potentialOrderPromotions?: PromotionResult[];\n    potentialProductPromotions?: PromotionResult[];\n    productDiscounts?: Price;\n    purchaseOrderNumber?: string;\n    replenishmentOrderCode?: string;\n    saveTime?: string;\n    savedBy?: Principal;\n    site?: string;\n    store?: string;\n    subTotal?: Price;\n    totalDiscounts?: Price;\n    totalItems?: number;\n    totalPrice?: Price;\n    totalPriceWithTax?: Price;\n    totalTax?: Price;\n    totalUnitCount?: number;\n    trigger?: Trigger;\n    user?: Principal;\n  }\n\n  export interface ReplenishmentOrderList {\n    replenishmentOrders?: ReplenishmentOrder[];\n    pagination?: PaginationModel;\n    sorts?: SortModel[];\n  }\n\n  export interface Trigger {\n    activationTime?: string;\n    displayTimeTable?: string;\n  }\n\n  export interface ScheduleReplenishmentForm {\n    daysOfWeek?: DaysOfWeek[];\n    nthDayOfMonth?: string;\n    numberOfDays?: string;\n    numberOfWeeks?: string;\n    recurrencePeriod?: string;\n    replenishmentStartDate?: string;\n  }\n\n  export enum DaysOfWeek {\n    MONDAY = 'MONDAY',\n    TUESDAY = 'TUESDAY',\n    WEDNESDAY = 'WEDNESDAY',\n    THURSDAY = 'THURSDAY',\n    FRIDAY = 'FRIDAY',\n    SATURDAY = 'SATURDAY',\n    SUNDAY = 'SUNDAY',\n  }\n\n  export enum OrderApprovalDecisionValue {\n    APPROVE = 'APPROVE',\n    REJECT = 'REJECT',\n  }\n  export interface OrderApprovalDecision {\n    decision?: OrderApprovalDecisionValue;\n    comment?: string;\n  }\n\n  export interface OrderApprovalRecord {\n    approver?: Principal;\n    comments?: string;\n    permissionTypes?: OrderApprovalPermissionType[];\n    statusDisplay?: string;\n  }\n\n  export interface OrderApproval {\n    approvalDecisionRequired?: boolean;\n    code?: string;\n    customerOrderApprovalRecords?: OrderApprovalRecord[];\n    merchantOrderApprovalRecords?: OrderApprovalRecord[];\n    order?: Order;\n    trigger?: Trigger;\n  }\n\n  export interface OrderApprovalsList {\n    orderApprovals?: OrderApproval[];\n    pagination?: PaginationModel;\n    sorts?: SortModel[];\n  }\n}\n","import {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { OccConfig } from '../config/occ-config';\n\n/**\n * Http interceptor to add cookies to all cross-site requests.\n */\n@Injectable({ providedIn: 'root' })\nexport class WithCredentialsInterceptor implements HttpInterceptor {\n  constructor(protected config: OccConfig) {}\n\n  /**\n   * Intercepts each request and adds the `withCredential` flag to it\n   * if it hasn't been added already.\n   */\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (this.requiresWithCredentials(request)) {\n      request = request.clone({\n        withCredentials: true,\n      });\n    }\n    return next.handle(request);\n  }\n\n  /**\n   * indicates whether the request should use the WithCredentials flag.\n   */\n  protected requiresWithCredentials(request: HttpRequest<any>): boolean {\n    return (\n      this.occConfig?.useWithCredentials &&\n      request.url.indexOf(this.occConfig?.prefix) > -1\n    );\n  }\n\n  private get occConfig() {\n    return this.config.backend.occ;\n  }\n}\n","import { InjectionToken, Provider } from '@angular/core';\n\nexport const ConfigValidatorToken = new InjectionToken(\n  'ConfigurationValidator'\n);\n\n/**\n * ConfigValidator is used to validate config and display warning messages in development mode.\n *\n * In case of failed validation, should return a string with error message.\n */\nexport type ConfigValidator = (config: any) => string | void;\n\n/**\n * Use to probide config validation at app bootstrap (when all config chunks are merged)\n *\n * @param configValidator\n */\nexport function provideConfigValidator(\n  configValidator: ConfigValidator\n): Provider {\n  return {\n    provide: ConfigValidatorToken,\n    useValue: configValidator,\n    multi: true,\n  };\n}\n\nexport function validateConfig(\n  config: any,\n  configValidators: ConfigValidator[]\n) {\n  for (const validate of configValidators) {\n    const warning = validate(config);\n    if (warning) {\n      console.warn(warning);\n    }\n  }\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { ModuleWithProviders, NgModule } from '@angular/core';\nimport { provideConfigValidator } from '../config/config-validator/config-validator';\nimport { OccConfigLoaderModule } from './config-loader/occ-config-loader.module';\nimport { defaultOccConfig } from './config/default-occ-config';\nimport { occConfigValidator } from './config/occ-config-validator';\nimport { WithCredentialsInterceptor } from './interceptors/with-credentials.interceptor';\nimport { AsmOccModule } from './adapters/asm/asm-occ.module';\nimport { CmsOccModule } from './adapters/cms/cms-occ.module';\nimport { CartOccModule } from './adapters/cart/cart-occ.module';\nimport { CheckoutOccModule } from './adapters/checkout/checkout-occ.module';\nimport { ProductOccModule } from './adapters/product/product-occ.module';\nimport { SiteContextOccModule } from './adapters/site-context/site-context-occ.module';\nimport { UserOccModule } from './adapters/user/user-occ.module';\nimport { provideDefaultConfig } from '../config/config-providers';\nimport { CostCenterOccModule } from './adapters/cost-center/cost-center-occ.module';\n\n@NgModule({\n  imports: [\n    AsmOccModule,\n    CmsOccModule,\n    CartOccModule,\n    CheckoutOccModule,\n    ProductOccModule,\n    SiteContextOccModule,\n    UserOccModule,\n    OccConfigLoaderModule.forRoot(),\n    CostCenterOccModule,\n  ],\n})\nexport class OccModule {\n  static forRoot(): ModuleWithProviders<OccModule> {\n    return {\n      ngModule: OccModule,\n      providers: [\n        {\n          provide: HTTP_INTERCEPTORS,\n          useExisting: WithCredentialsInterceptor,\n          multi: true,\n        },\n        provideDefaultConfig(defaultOccConfig),\n        provideConfigValidator(occConfigValidator),\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { OccConfig } from '../config/occ-config';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class LoadingScopesService {\n  constructor(protected config: OccConfig) {}\n\n  /**\n   * Aims to expand scopes based on loading scopes config.\n   *\n   * I.e. if 'details' scope includes 'list' scope by configuration, it'll return ['details', 'list']\n   *\n   * If scope data overlaps with each other, the data should be merged in the order of scopes provided,\n   * i.e. the last scope is merged last, overwriting parts of the data already provided by preceding scope.\n   * It should apply also to implicit scopes (that are included by configuration).\n   *\n   * @param model\n   * @param scopes\n   */\n  expand(model: string, scopes: string[]): string[] {\n    const scopesConfig =\n      this.config &&\n      this.config.backend &&\n      this.config.backend.loadingScopes &&\n      this.config.backend.loadingScopes[model];\n\n    if (scopesConfig) {\n      const expandedScopes = [...scopes];\n      let i = expandedScopes.length;\n\n      while (i > 0) {\n        i--;\n        const includedScopes =\n          scopesConfig[expandedScopes[i]] &&\n          scopesConfig[expandedScopes[i]].include;\n        if (includedScopes) {\n          for (const includedScope of includedScopes) {\n            if (!expandedScopes.includes(includedScope)) {\n              expandedScopes.splice(i, 0, includedScope);\n              i++;\n            }\n          }\n        }\n      }\n\n      return expandedScopes;\n    }\n\n    return scopes;\n  }\n\n  /**\n   * Return maxAge for product scope in milliseconds\n   *\n   * @param model\n   * @param scope\n   */\n  getMaxAge(model: string, scope: string): number {\n    const scopesConfig =\n      this.config &&\n      this.config.backend &&\n      this.config.backend.loadingScopes &&\n      this.config.backend.loadingScopes[model];\n    return (scopesConfig[scope] && scopesConfig[scope].maxAge) * 1000 || 0;\n  }\n}\n","import { OccConfig } from '../../occ/config/occ-config';\nimport { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class AnonymousConsentsConfig extends OccConfig {\n  anonymousConsents?: {\n    /**\n     * Specify the consent template ID to be show on the registration page.\n     */\n    registerConsent?: string;\n    /**\n     * Show the legal description at the top of the anonymous consents dialog.\n     */\n    showLegalDescriptionInDialog?: boolean;\n    /**\n     * Specify the list of consent template IDs that are required and which can't be toggled off.\n     */\n    requiredConsents?: string[];\n    /**\n     * Consent management page configuration.\n     */\n    consentManagementPage?: {\n      /**\n       * Show all anonymous consents on the consent management page.\n       */\n      showAnonymousConsents?: boolean;\n      /**\n       * A list of consent template IDs that should be hidden on the consent management page.\n       */\n      hideConsents?: string[];\n    };\n  };\n}\n","import {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { switchMap, take, tap, withLatestFrom } from 'rxjs/operators';\nimport { AuthService } from '../../auth/index';\nimport {\n  AnonymousConsent,\n  ANONYMOUS_CONSENTS_HEADER,\n  ANONYMOUS_CONSENT_STATUS,\n} from '../../model/index';\nimport { OccEndpointsService } from '../../occ/index';\nimport { AnonymousConsentsConfig } from '../config/anonymous-consents-config';\nimport { AnonymousConsentsService } from '../facade/anonymous-consents.service';\n\n@Injectable({ providedIn: 'root' })\nexport class AnonymousConsentsInterceptor implements HttpInterceptor {\n  constructor(\n    private anonymousConsentsService: AnonymousConsentsService,\n    private authService: AuthService,\n    private occEndpoints: OccEndpointsService,\n    private config: AnonymousConsentsConfig\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return this.anonymousConsentsService.getConsents().pipe(\n      take(1),\n      withLatestFrom(this.authService.isUserLoggedIn()),\n      switchMap(([consents, isUserLoggedIn]) => {\n        if (!this.isOccUrl(request.url)) {\n          return next.handle(request);\n        }\n\n        const clonedRequest = this.handleRequest(consents, request);\n        return next.handle(clonedRequest).pipe(\n          tap((event) => {\n            if (\n              event instanceof HttpResponse &&\n              event.url.startsWith(\n                this.occEndpoints.getUrl('anonymousConsentTemplates')\n              )\n            ) {\n              this.handleResponse(\n                isUserLoggedIn,\n                event.headers.get(ANONYMOUS_CONSENTS_HEADER),\n                consents\n              );\n            }\n          })\n        );\n      })\n    );\n  }\n\n  private handleResponse(\n    isUserLoggedIn: boolean,\n    newRawConsents: string,\n    previousConsents: AnonymousConsent[]\n  ): void {\n    if (!isUserLoggedIn && newRawConsents) {\n      let newConsents: AnonymousConsent[] = [];\n      newConsents = this.anonymousConsentsService.decodeAndDeserialize(\n        newRawConsents\n      );\n      newConsents = this.giveRequiredConsents(newConsents);\n\n      if (\n        this.anonymousConsentsService.consentsUpdated(\n          newConsents,\n          previousConsents\n        )\n      ) {\n        this.anonymousConsentsService.setConsents(newConsents);\n      }\n    }\n  }\n\n  private handleRequest(\n    consents: AnonymousConsent[],\n    request: HttpRequest<any>\n  ): HttpRequest<any> {\n    if (!consents) {\n      return request;\n    }\n\n    const rawConsents = this.anonymousConsentsService.serializeAndEncode(\n      consents\n    );\n    return request.clone({\n      setHeaders: {\n        [ANONYMOUS_CONSENTS_HEADER]: rawConsents,\n      },\n    });\n  }\n\n  private isOccUrl(url: string): boolean {\n    return url.includes(this.occEndpoints.getBaseEndpoint());\n  }\n\n  private giveRequiredConsents(\n    consents: AnonymousConsent[]\n  ): AnonymousConsent[] {\n    const givenConsents = [...consents];\n\n    if (\n      Boolean(this.config.anonymousConsents) &&\n      Boolean(this.config.anonymousConsents.requiredConsents)\n    ) {\n      for (const consent of givenConsents) {\n        if (\n          this.config.anonymousConsents.requiredConsents.includes(\n            consent.templateCode\n          )\n        ) {\n          consent.consentState = ANONYMOUS_CONSENT_STATUS.GIVEN;\n        }\n      }\n    }\n    return givenConsents;\n  }\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Provider } from '@angular/core';\nimport { AnonymousConsentsInterceptor } from './anonymous-consents-interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: AnonymousConsentsInterceptor,\n    multi: true,\n  },\n];\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateWithUser, UserState, USER_FEATURE } from '../user-state';\n\nexport const getUserState: MemoizedSelector<\n  StateWithUser,\n  UserState\n> = createFeatureSelector<UserState>(USER_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Country } from '../../../model/address.model';\nimport {\n  BillingCountriesState,\n  BillingCountryEntities,\n  StateWithUser,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getBillingCountriesState: MemoizedSelector<\n  StateWithUser,\n  BillingCountriesState\n> = createSelector(getUserState, (state: UserState) => state.billingCountries);\n\nexport const getBillingCountriesEntites: MemoizedSelector<\n  StateWithUser,\n  BillingCountryEntities\n> = createSelector(\n  getBillingCountriesState,\n  (state: BillingCountriesState) => state.entities\n);\n\nexport const getAllBillingCountries: MemoizedSelector<\n  StateWithUser,\n  Country[]\n> = createSelector(getBillingCountriesEntites, (entites) =>\n  Object.keys(entites).map((isocode) => entites[isocode])\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ConsignmentTracking } from '../../../model/index';\nimport {\n  ConsignmentTrackingState,\n  StateWithUser,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getConsignmentTrackingState: MemoizedSelector<\n  StateWithUser,\n  ConsignmentTrackingState\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.consignmentTracking\n);\n\nexport const getConsignmentTracking: MemoizedSelector<\n  StateWithUser,\n  ConsignmentTracking\n> = createSelector(\n  getConsignmentTrackingState,\n  (state: ConsignmentTrackingState) => state.tracking\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\n\nimport { UserState, StateWithUser } from '../user-state';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderValueSelector,\n  loaderSuccessSelector,\n  loaderLoadingSelector,\n} from '../../../state/utils/loader/loader.selectors';\n\nimport { getUserState } from './feature.selector';\nimport { CustomerCouponSearchResult } from '../../../model/customer-coupon.model';\n\nexport const getCustomerCouponsState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<CustomerCouponSearchResult>\n> = createSelector(getUserState, (state: UserState) => state.customerCoupons);\n\nexport const getCustomerCouponsLoaded: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getCustomerCouponsState,\n  (state: LoaderState<CustomerCouponSearchResult>) =>\n    loaderSuccessSelector(state)\n);\n\nexport const getCustomerCouponsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getCustomerCouponsState,\n  (state: LoaderState<CustomerCouponSearchResult>) =>\n    loaderLoadingSelector(state)\n);\n\nexport const getCustomerCoupons: MemoizedSelector<\n  StateWithUser,\n  CustomerCouponSearchResult\n> = createSelector(\n  getCustomerCouponsState,\n  (state: LoaderState<CustomerCouponSearchResult>) => loaderValueSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Country } from '../../../model/address.model';\nimport {\n  DeliveryCountriesState,\n  DeliveryCountryEntities,\n  StateWithUser,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getDeliveryCountriesState: MemoizedSelector<\n  StateWithUser,\n  DeliveryCountriesState\n> = createSelector(getUserState, (state: UserState) => state.countries);\n\nexport const getDeliveryCountriesEntites: MemoizedSelector<\n  StateWithUser,\n  DeliveryCountryEntities\n> = createSelector(\n  getDeliveryCountriesState,\n  (state: DeliveryCountriesState) => state.entities\n);\n\nexport const getAllDeliveryCountries: MemoizedSelector<\n  StateWithUser,\n  Country[]\n> = createSelector(getDeliveryCountriesEntites, (entites) =>\n  Object.keys(entites).map((isocode) => entites[isocode])\n);\n\nexport const countrySelectorFactory = (\n  isocode: string\n): MemoizedSelector<StateWithUser, Country> =>\n  createSelector(getDeliveryCountriesEntites, (entities) =>\n    Object.keys(entities).length !== 0 ? entities[isocode] : null\n  );\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\nimport {\n  loaderValueSelector,\n  loaderLoadingSelector,\n} from '../../../state/utils/loader/loader.selectors';\n\nexport const getPreferencesLoaderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<NotificationPreference[]>\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.notificationPreferences\n);\n\nexport const getPreferences: MemoizedSelector<\n  StateWithUser,\n  NotificationPreference[]\n> = createSelector(\n  getPreferencesLoaderState,\n  (state: LoaderState<NotificationPreference[]>) => loaderValueSelector(state)\n);\n\nexport const getEnabledPreferences: MemoizedSelector<\n  StateWithUser,\n  NotificationPreference[]\n> = createSelector(\n  getPreferencesLoaderState,\n  (state: LoaderState<NotificationPreference[]>) =>\n    loaderValueSelector(state).filter((p) => p.enabled)\n);\n\nexport const getPreferencesLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getPreferencesLoaderState,\n  (state: LoaderState<NotificationPreference[]>) => loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Order } from '../../../model/order.model';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateUtils } from '../../../state/utils/index';\n\nexport const getOrderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<Order>\n> = createSelector(getUserState, (state: UserState) => state.order);\n\nexport const getOrderDetails: MemoizedSelector<\n  StateWithUser,\n  Order\n> = createSelector(getOrderState, (state: LoaderState<Order>) =>\n  StateUtils.loaderValueSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ReturnRequest, ReturnRequestList } from '../../../model/order.model';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateUtils } from '../../../state/utils/index';\n\nexport const getOrderReturnRequestState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ReturnRequest>\n> = createSelector(getUserState, (state: UserState) => state.orderReturn);\n\nexport const getOrderReturnRequest: MemoizedSelector<\n  StateWithUser,\n  ReturnRequest\n> = createSelector(\n  getOrderReturnRequestState,\n  (state: LoaderState<ReturnRequest>) => StateUtils.loaderValueSelector(state)\n);\n\nexport const getOrderReturnRequestLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getOrderReturnRequestState,\n  (state: LoaderState<ReturnRequest>) => StateUtils.loaderLoadingSelector(state)\n);\n\nexport const getOrderReturnRequestSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getOrderReturnRequestState,\n  (state: LoaderState<ReturnRequest>) =>\n    StateUtils.loaderSuccessSelector(state) &&\n    !StateUtils.loaderLoadingSelector(state)\n);\n\nexport const getOrderReturnRequestListState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ReturnRequestList>\n> = createSelector(getUserState, (state: UserState) => state.orderReturnList);\n\nexport const getOrderReturnRequestList: MemoizedSelector<\n  StateWithUser,\n  ReturnRequestList\n> = createSelector(\n  getOrderReturnRequestListState,\n  (state: LoaderState<ReturnRequestList>) =>\n    StateUtils.loaderValueSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getPaymentMethodsState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<PaymentDetails[]>\n> = createSelector(getUserState, (state: UserState) => state.payments);\n\nexport const getPaymentMethods: MemoizedSelector<\n  StateWithUser,\n  PaymentDetails[]\n> = createSelector(\n  getPaymentMethodsState,\n  (state: LoaderState<PaymentDetails[]>) =>\n    StateUtils.loaderValueSelector(state)\n);\n\nexport const getPaymentMethodsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getPaymentMethodsState,\n  (state: LoaderState<PaymentDetails[]>) =>\n    StateUtils.loaderLoadingSelector(state)\n);\n\nexport const getPaymentMethodsLoadedSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getPaymentMethodsState,\n  (state: LoaderState<PaymentDetails[]>) =>\n    StateUtils.loaderSuccessSelector(state) &&\n    !StateUtils.loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { UserState, StateWithUser } from '../user-state';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderValueSelector,\n  loaderLoadingSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { getUserState } from './feature.selector';\nimport { ProductInterestSearchResult } from '../../../model/product-interest.model';\n\nexport const getInterestsState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ProductInterestSearchResult>\n> = createSelector(getUserState, (state: UserState) => state.productInterests);\n\nexport const getInterests: MemoizedSelector<\n  StateWithUser,\n  ProductInterestSearchResult\n> = createSelector(\n  getInterestsState,\n  (state: LoaderState<ProductInterestSearchResult>) =>\n    loaderValueSelector(state)\n);\n\nexport const getInterestsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getInterestsState,\n  (state: LoaderState<ProductInterestSearchResult>) =>\n    loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Region } from '../../../model/address.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { RegionsState, StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getRegionsLoaderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<RegionsState>\n> = createSelector(getUserState, (state: UserState) => state.regions);\n\nexport const getAllRegions: MemoizedSelector<\n  StateWithUser,\n  Region[]\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) => {\n    return StateUtils.loaderValueSelector(state).entities;\n  }\n);\n\nexport const getRegionsDataAndLoading: MemoizedSelector<\n  StateWithUser,\n  {\n    loaded: boolean;\n    loading: boolean;\n    regions: Region[];\n    country: string;\n  }\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) => ({\n    loaded: StateUtils.loaderSuccessSelector(state),\n    loading: StateUtils.loaderLoadingSelector(state),\n    regions: StateUtils.loaderValueSelector(state).entities,\n    country: StateUtils.loaderValueSelector(state).country,\n  })\n);\n\nexport const getRegionsCountry: MemoizedSelector<\n  StateWithUser,\n  string\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) =>\n    StateUtils.loaderValueSelector(state).country\n);\n\nexport const getRegionsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getRegionsLoaderState, (state: LoaderState<RegionsState>) =>\n  StateUtils.loaderLoadingSelector(state)\n);\n\nexport const getRegionsLoaded: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getRegionsLoaderState, (state: LoaderState<RegionsState>) =>\n  StateUtils.loaderSuccessSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ReplenishmentOrder } from '../../../model/replenishment-order.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getReplenishmentOrderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ReplenishmentOrder>\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.replenishmentOrder\n);\n\nexport const getReplenishmentOrderDetailsValue: MemoizedSelector<\n  StateWithUser,\n  ReplenishmentOrder\n> = createSelector(\n  getReplenishmentOrderState,\n  (state: LoaderState<ReplenishmentOrder>) =>\n    StateUtils.loaderValueSelector(state)\n);\n\nexport const getReplenishmentOrderDetailsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getReplenishmentOrderState,\n  (state: LoaderState<ReplenishmentOrder>) =>\n    StateUtils.loaderLoadingSelector(state)\n);\n\nexport const getReplenishmentOrderDetailsSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getReplenishmentOrderState,\n  (state: LoaderState<ReplenishmentOrder>) =>\n    StateUtils.loaderSuccessSelector(state)\n);\n\nexport const getReplenishmentOrderDetailsError: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getReplenishmentOrderState,\n  (state: LoaderState<ReplenishmentOrder>) =>\n    StateUtils.loaderErrorSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getResetPassword: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getUserState, (state: UserState) => state.resetPassword);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Title } from '../../../model/misc.model';\nimport {\n  StateWithUser,\n  TitleEntities,\n  TitlesState,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getTitlesState: MemoizedSelector<\n  StateWithUser,\n  TitlesState\n> = createSelector(getUserState, (state: UserState) => state.titles);\n\nexport const getTitlesEntites: MemoizedSelector<\n  StateWithUser,\n  TitleEntities\n> = createSelector(getTitlesState, (state: TitlesState) => state.entities);\n\nexport const getAllTitles: MemoizedSelector<\n  StateWithUser,\n  Title[]\n> = createSelector(getTitlesEntites, (entites) =>\n  Object.keys(entites).map((code) => entites[code])\n);\n\nexport const titleSelectorFactory = (\n  code: string\n): MemoizedSelector<StateWithUser, Title> =>\n  createSelector(getTitlesEntites, (entities) =>\n    Object.keys(entities).length !== 0 ? entities[code] : null\n  );\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Address } from '../../../model/address.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getAddressesLoaderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<Address[]>\n> = createSelector(getUserState, (state: UserState) => state.addresses);\n\nexport const getAddresses: MemoizedSelector<\n  StateWithUser,\n  Address[]\n> = createSelector(getAddressesLoaderState, (state: LoaderState<Address[]>) =>\n  StateUtils.loaderValueSelector(state)\n);\n\nexport const getAddressesLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getAddressesLoaderState, (state: LoaderState<Address[]>) =>\n  StateUtils.loaderLoadingSelector(state)\n);\n\nexport const getAddressesLoadedSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getAddressesLoaderState,\n  (state: LoaderState<Address[]>) =>\n    StateUtils.loaderSuccessSelector(state) &&\n    !StateUtils.loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getConsentsState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ConsentTemplate[]>\n> = createSelector(getUserState, (state: UserState) => state.consents);\n\nexport const getConsentsValue: MemoizedSelector<\n  StateWithUser,\n  ConsentTemplate[]\n> = createSelector(getConsentsState, StateUtils.loaderValueSelector);\n\nexport const getConsentByTemplateId = (\n  templateId: string\n): MemoizedSelector<StateWithUser, ConsentTemplate> =>\n  createSelector(getConsentsValue, (templates) =>\n    templates.find((template) => template.id === templateId)\n  );\n\nexport const getConsentsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getConsentsState, StateUtils.loaderLoadingSelector);\n\nexport const getConsentsSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getConsentsState, StateUtils.loaderSuccessSelector);\n\nexport const getConsentsError: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getConsentsState, StateUtils.loaderErrorSelector);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { CostCenter } from '../../../model/org-unit.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getCostCentersState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<CostCenter[]>\n> = createSelector(getUserState, (state: UserState) => state.costCenters);\n\nexport const getCostCenters: MemoizedSelector<\n  StateWithUser,\n  CostCenter[]\n> = createSelector(getCostCentersState, (state: LoaderState<CostCenter[]>) =>\n  StateUtils.loaderValueSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { User } from '../../../model/misc.model';\nimport { StateWithUser, UserDetailsState, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getDetailsState: MemoizedSelector<\n  StateWithUser,\n  UserDetailsState\n> = createSelector(getUserState, (state: UserState) => state.account);\n\nexport const getDetails: MemoizedSelector<StateWithUser, User> = createSelector(\n  getDetailsState,\n  (state: UserDetailsState) => state.details\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { OrderHistoryList } from '../../../model/order.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getOrdersState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<OrderHistoryList>\n> = createSelector(getUserState, (state: UserState) => state.orders);\n\nexport const getOrdersLoaded: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getOrdersState, (state: LoaderState<OrderHistoryList>) =>\n  StateUtils.loaderSuccessSelector(state)\n);\n\nexport const getOrders: MemoizedSelector<\n  StateWithUser,\n  OrderHistoryList\n> = createSelector(getOrdersState, (state: LoaderState<OrderHistoryList>) =>\n  StateUtils.loaderValueSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ReplenishmentOrderList } from '../../../model/replenishment-order.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { StateWithUser, UserState } from '../user-state';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { getUserState } from './feature.selector';\n\nexport const getReplenishmentOrdersState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ReplenishmentOrderList>\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.replenishmentOrders\n);\n\nexport const getReplenishmentOrders: MemoizedSelector<\n  StateWithUser,\n  ReplenishmentOrderList\n> = createSelector(\n  getReplenishmentOrdersState,\n  (state: LoaderState<ReplenishmentOrderList>) =>\n    StateUtils.loaderValueSelector(state)\n);\n\nexport const getReplenishmentOrdersLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getReplenishmentOrdersState,\n  (state: LoaderState<ReplenishmentOrderList>) =>\n    StateUtils.loaderLoadingSelector(state)\n);\n\nexport const getReplenishmentOrdersError: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getReplenishmentOrdersState,\n  (state: LoaderState<ReplenishmentOrderList>) =>\n    StateUtils.loaderErrorSelector(state)\n);\n\nexport const getReplenishmentOrdersSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getReplenishmentOrdersState,\n  (state: LoaderState<ReplenishmentOrderList>) =>\n    StateUtils.loaderSuccessSelector(state)\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { iif, Observable } from 'rxjs';\nimport { filter, map, switchMap, tap, withLatestFrom } from 'rxjs/operators';\nimport { AuthService } from '../../auth/user-auth/facade/auth.service';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { Consent, ConsentTemplate } from '../../model/consent.model';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  GIVE_CONSENT_PROCESS_ID,\n  StateWithUser,\n  WITHDRAW_CONSENT_PROCESS_ID,\n} from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserConsentService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected authService: AuthService,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Retrieves all consents.\n   */\n  loadConsents(): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(new UserActions.LoadUserConsents(userId));\n    });\n  }\n\n  /**\n   * Returns all consent templates. If `loadIfMissing` parameter is set to `true`, the method triggers the load if consent templates.\n   * @param loadIfMissing is set to `true`, the method will load templates if those are not already present. The default value is `false`.\n   */\n  getConsents(loadIfMissing = false): Observable<ConsentTemplate[]> {\n    return iif(\n      () => loadIfMissing,\n      this.store.pipe(\n        select(UsersSelectors.getConsentsValue),\n        withLatestFrom(\n          this.getConsentsResultLoading(),\n          this.getConsentsResultSuccess()\n        ),\n        filter(([_templates, loading, _success]) => !loading),\n        tap(([templates, _loading, success]) => {\n          if (!templates || templates.length === 0) {\n            // avoid infite loop - if we've already attempted to load templates and we got an empty array as the response\n            if (!success) {\n              this.loadConsents();\n            }\n          }\n        }),\n        filter(([templates, _loading]) => Boolean(templates)),\n        map(([templates, _loading]) => templates)\n      ),\n      this.store.pipe(select(UsersSelectors.getConsentsValue))\n    );\n  }\n\n  /**\n   * Returns the consents loading flag\n   */\n  getConsentsResultLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getConsentsLoading));\n  }\n\n  /**\n   * Returns the consents success flag\n   */\n  getConsentsResultSuccess(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getConsentsSuccess));\n  }\n\n  /**\n   * Returns the consents error flag\n   */\n  getConsentsResultError(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getConsentsError));\n  }\n\n  /**\n   * Resets the processing state for consent retrieval\n   */\n  resetConsentsProcessState(): void {\n    this.store.dispatch(new UserActions.ResetLoadUserConsents());\n  }\n\n  /**\n   * Returns the registered consent for the given template ID.\n   *\n   * As a side-effect, the method will call `getConsents(true)` to load the templates if those are not present.\n   *\n   * @param templateId a template ID by which to filter the registered templates.\n   */\n  getConsent(templateId: string): Observable<Consent> {\n    return this.authService.isUserLoggedIn().pipe(\n      filter(Boolean),\n      tap(() => this.getConsents(true)),\n      switchMap(() =>\n        this.store.pipe(\n          select(UsersSelectors.getConsentByTemplateId(templateId))\n        )\n      ),\n      filter((template) => Boolean(template)),\n      map((template) => template.currentConsent)\n    );\n  }\n\n  /**\n   * Returns `true` if the consent is truthy and if `consentWithdrawnDate` doesn't exist.\n   * Otherwise, `false` is returned.\n   *\n   * @param consent to check\n   */\n  isConsentGiven(consent: Consent): boolean {\n    return (\n      Boolean(consent) &&\n      Boolean(consent.consentGivenDate) &&\n      !Boolean(consent.consentWithdrawnDate)\n    );\n  }\n\n  /**\n   * Returns `true` if the consent is either falsy or if `consentWithdrawnDate` is present.\n   * Otherwise, `false` is returned.\n   *\n   * @param consent to check\n   */\n  isConsentWithdrawn(consent: Consent): boolean {\n    if (Boolean(consent)) {\n      return Boolean(consent.consentWithdrawnDate);\n    }\n    return true;\n  }\n\n  /**\n   * Give consent for specified consent template ID and version.\n   * @param consentTemplateId a template ID for which to give a consent\n   * @param consentTemplateVersion a template version for which to give a consent\n   */\n  giveConsent(consentTemplateId: string, consentTemplateVersion: number): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.GiveUserConsent({\n          userId,\n          consentTemplateId,\n          consentTemplateVersion,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the give consent process loading flag\n   */\n  getGiveConsentResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(GIVE_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the give consent process success flag\n   */\n  getGiveConsentResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(GIVE_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the give consent process error flag\n   */\n  getGiveConsentResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(GIVE_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resents the give consent process flags\n   */\n  resetGiveConsentProcessState(): void {\n    return this.store.dispatch(new UserActions.ResetGiveUserConsentProcess());\n  }\n\n  /**\n   * Withdraw consent for the given `consentCode`\n   * @param consentCode for which to withdraw the consent\n   */\n  withdrawConsent(consentCode: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.WithdrawUserConsent({\n          userId,\n          consentCode,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the withdraw consent process loading flag\n   */\n  getWithdrawConsentResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(WITHDRAW_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the withdraw consent process success flag\n   */\n  getWithdrawConsentResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(WITHDRAW_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the withdraw consent process error flag\n   */\n  getWithdrawConsentResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(WITHDRAW_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the process flags for withdraw consent\n   */\n  resetWithdrawConsentProcessState(): void {\n    return this.store.dispatch(\n      new UserActions.ResetWithdrawUserConsentProcess()\n    );\n  }\n\n  /**\n   * Filters the provided `templateList`' templates by hiding the template IDs specified in `hideTemplateIds`.\n   * If the `hideTemplateIds` is empty, the provided `templateList` is returned.\n   *\n   * @param templateList a list of consent templates to filter\n   * @param hideTemplateIds template IDs to hide\n   */\n  filterConsentTemplates(\n    templateList: ConsentTemplate[],\n    hideTemplateIds: string[] = []\n  ): ConsentTemplate[] {\n    if (hideTemplateIds.length === 0) {\n      return templateList;\n    }\n\n    const updatedTemplateList: ConsentTemplate[] = [];\n    for (const template of templateList) {\n      const show = !hideTemplateIds.includes(template.id);\n      if (show) {\n        updatedTemplateList.push(template);\n      }\n    }\n\n    return updatedTemplateList;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { AnonymousConsent, ConsentTemplate } from '../../model/consent.model';\nimport { AnonymousConsentTemplatesAdapter } from './anonymous-consent-templates.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AnonymousConsentTemplatesConnector {\n  constructor(protected adapter: AnonymousConsentTemplatesAdapter) {}\n\n  loadAnonymousConsentTemplates(): Observable<ConsentTemplate[]> {\n    return this.adapter.loadAnonymousConsentTemplates();\n  }\n\n  loadAnonymousConsents(): Observable<AnonymousConsent[]> {\n    return this.adapter.loadAnonymousConsents();\n  }\n}\n","import { Injectable, isDevMode } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { EMPTY, Observable, of } from 'rxjs';\nimport {\n  catchError,\n  concatMap,\n  filter,\n  map,\n  mergeMap,\n  switchMap,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { AuthActions, AuthService, UserIdService } from '../../../auth/index';\nimport { UserConsentService } from '../../../user/facade/user-consent.service';\nimport { UserActions } from '../../../user/store/actions/index';\nimport { normalizeHttpError } from '../../../util/normalize-http-error';\nimport { AnonymousConsentsConfig } from '../../config/anonymous-consents-config';\nimport { AnonymousConsentTemplatesConnector } from '../../connectors/anonymous-consent-templates.connector';\nimport { AnonymousConsentsService } from '../../facade/index';\nimport { AnonymousConsentsActions } from '../actions/index';\n\n@Injectable()\nexport class AnonymousConsentsEffects {\n  @Effect()\n  checkConsentVersions$: Observable<\n    | AnonymousConsentsActions.LoadAnonymousConsentTemplates\n    | AnonymousConsentsActions.LoadAnonymousConsentTemplatesFail\n    | Observable<never>\n  > = this.actions$.pipe(\n    ofType(AnonymousConsentsActions.ANONYMOUS_CONSENT_CHECK_UPDATED_VERSIONS),\n    withLatestFrom(this.anonymousConsentService.getConsents()),\n    concatMap(([_, currentConsents]) => {\n      return this.anonymousConsentTemplatesConnector\n        .loadAnonymousConsents()\n        .pipe(\n          map((newConsents) => {\n            if (!newConsents) {\n              if (isDevMode()) {\n                console.warn(\n                  'No consents were loaded. Please check the Spartacus documentation as this could be a back-end configuration issue.'\n                );\n              }\n              return false;\n            }\n\n            const currentConsentVersions = currentConsents.map(\n              (consent) => consent.templateVersion\n            );\n            const newConsentVersions = newConsents.map(\n              (consent) => consent.templateVersion\n            );\n\n            return this.detectUpdatedVersion(\n              currentConsentVersions,\n              newConsentVersions\n            );\n          }),\n          switchMap((updated) =>\n            updated\n              ? of(new AnonymousConsentsActions.LoadAnonymousConsentTemplates())\n              : EMPTY\n          ),\n          catchError((error) =>\n            of(\n              new AnonymousConsentsActions.LoadAnonymousConsentTemplatesFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  loadAnonymousConsentTemplates$: Observable<\n    AnonymousConsentsActions.AnonymousConsentsActions\n  > = this.actions$.pipe(\n    ofType(AnonymousConsentsActions.LOAD_ANONYMOUS_CONSENT_TEMPLATES),\n    withLatestFrom(this.anonymousConsentService.getTemplates()),\n    concatMap(([_, currentConsentTemplates]) =>\n      this.anonymousConsentTemplatesConnector\n        .loadAnonymousConsentTemplates()\n        .pipe(\n          mergeMap((newConsentTemplates) => {\n            let updated = false;\n            if (\n              currentConsentTemplates &&\n              currentConsentTemplates.length !== 0\n            ) {\n              updated = this.anonymousConsentService.detectUpdatedTemplates(\n                currentConsentTemplates,\n                newConsentTemplates\n              );\n            }\n\n            return [\n              new AnonymousConsentsActions.LoadAnonymousConsentTemplatesSuccess(\n                newConsentTemplates\n              ),\n              new AnonymousConsentsActions.ToggleAnonymousConsentTemplatesUpdated(\n                updated\n              ),\n            ];\n          }),\n          catchError((error) =>\n            of(\n              new AnonymousConsentsActions.LoadAnonymousConsentTemplatesFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        )\n    )\n  );\n\n  // TODO(#9416): This won't work with flow different than `Resource Owner Password Flow` which involves redirect (maybe in popup in will work)\n  @Effect()\n  transferAnonymousConsentsToUser$: Observable<\n    UserActions.TransferAnonymousConsent | Observable<never>\n  > = this.actions$.pipe(\n    ofType<AuthActions.Login>(AuthActions.LOGIN),\n    filter(() => Boolean(this.anonymousConsentsConfig.anonymousConsents)),\n    withLatestFrom(\n      this.actions$.pipe(\n        ofType<UserActions.RegisterUserSuccess>(\n          UserActions.REGISTER_USER_SUCCESS\n        )\n      )\n    ),\n    filter(([, registerAction]) => Boolean(registerAction)),\n    switchMap(() =>\n      this.anonymousConsentService.getConsents().pipe(\n        withLatestFrom(\n          this.userIdService.getUserId(),\n          this.anonymousConsentService.getTemplates(),\n          this.authService.isUserLoggedIn()\n        ),\n        filter(([, , , loggedIn]) => loggedIn),\n        concatMap(([consents, userId, templates, _loggedIn]) => {\n          const actions: UserActions.TransferAnonymousConsent[] = [];\n          for (const consent of consents) {\n            if (\n              this.anonymousConsentService.isConsentGiven(consent) &&\n              (!this.anonymousConsentsConfig.anonymousConsents\n                .requiredConsents ||\n                !this.anonymousConsentsConfig.anonymousConsents.requiredConsents.includes(\n                  consent.templateCode\n                ))\n            ) {\n              for (const template of templates) {\n                if (template.id === consent.templateCode) {\n                  actions.push(\n                    new UserActions.TransferAnonymousConsent({\n                      userId,\n                      consentTemplateId: template.id,\n                      consentTemplateVersion: template.version,\n                    })\n                  );\n                  break;\n                }\n              }\n            }\n          }\n          if (actions.length > 0) {\n            return actions;\n          }\n          return EMPTY;\n        })\n      )\n    )\n  );\n\n  @Effect()\n  giveRequiredConsentsToUser$: Observable<\n    UserActions.GiveUserConsent | Observable<never>\n  > = this.actions$.pipe(\n    ofType<AuthActions.Login>(AuthActions.LOGIN),\n    filter(\n      (action) =>\n        Boolean(this.anonymousConsentsConfig.anonymousConsents) &&\n        Boolean(\n          this.anonymousConsentsConfig.anonymousConsents.requiredConsents\n        ) &&\n        Boolean(action)\n    ),\n    concatMap(() =>\n      this.userConsentService.getConsentsResultSuccess().pipe(\n        withLatestFrom(\n          this.userIdService.getUserId(),\n          this.userConsentService.getConsents(),\n          this.authService.isUserLoggedIn()\n        ),\n        filter(([, , , loggedIn]) => loggedIn),\n        tap(([loaded, _userId, _templates, _loggedIn]) => {\n          if (!loaded) {\n            this.userConsentService.loadConsents();\n          }\n        }),\n        map(([_loaded, userId, templates, _loggedIn]) => {\n          return { userId, templates };\n        }),\n        concatMap(({ userId, templates }) => {\n          const actions: UserActions.GiveUserConsent[] = [];\n          for (const template of templates) {\n            if (\n              this.userConsentService.isConsentWithdrawn(\n                template.currentConsent\n              ) &&\n              this.anonymousConsentsConfig.anonymousConsents.requiredConsents.includes(\n                template.id\n              )\n            ) {\n              actions.push(\n                new UserActions.GiveUserConsent({\n                  userId,\n                  consentTemplateId: template.id,\n                  consentTemplateVersion: template.version,\n                })\n              );\n            }\n          }\n          if (actions.length > 0) {\n            return actions;\n          }\n          return EMPTY;\n        })\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private anonymousConsentTemplatesConnector: AnonymousConsentTemplatesConnector,\n    private authService: AuthService,\n    private anonymousConsentsConfig: AnonymousConsentsConfig,\n    private anonymousConsentService: AnonymousConsentsService,\n    private userConsentService: UserConsentService,\n    private userIdService: UserIdService\n  ) {}\n\n  /**\n   * Compares the given versions and determines if there's a mismatch,\n   * in which case `true` is returned.\n   *\n   * @param currentVersions versions of the current consents\n   * @param newVersions versions of the new consents\n   */\n  private detectUpdatedVersion(\n    currentVersions: number[],\n    newVersions: number[]\n  ): boolean {\n    if (currentVersions.length !== newVersions.length) {\n      return true;\n    }\n\n    for (let i = 0; i < newVersions.length; i++) {\n      if (currentVersions[i] !== newVersions[i]) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n}\n","import { AnonymousConsentsEffects } from './anonymous-consents.effect';\n\nexport const effects: any[] = [AnonymousConsentsEffects];\n\nexport * from './anonymous-consents.effect';\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Country, CountryType, Region } from '../../model/address.model';\nimport { BaseSite, Currency, Language } from '../../model/misc.model';\nimport { SiteAdapter } from './site.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SiteConnector {\n  constructor(protected adapter: SiteAdapter) {}\n\n  getLanguages(): Observable<Language[]> {\n    return this.adapter.loadLanguages();\n  }\n\n  getCurrencies(): Observable<Currency[]> {\n    return this.adapter.loadCurrencies();\n  }\n\n  getCountries(type?: CountryType): Observable<Country[]> {\n    return this.adapter.loadCountries(type);\n  }\n\n  getRegions(countryIsoCode: string): Observable<Region[]> {\n    return this.adapter.loadRegions(countryIsoCode);\n  }\n\n  getBaseSite(siteUid?: string): Observable<BaseSite> {\n    return this.adapter.loadBaseSite(siteUid);\n  }\n\n  getBaseSites(): Observable<BaseSite[]> {\n    return this.adapter.loadBaseSites();\n  }\n}\n","import { Provider, Type } from '@angular/core';\nimport { BaseSiteService } from '../facade/base-site.service';\nimport { CurrencyService } from '../facade/currency.service';\nimport { LanguageService } from '../facade/language.service';\nimport { SiteContext } from '../facade/site-context.interface';\nimport {\n  BASE_SITE_CONTEXT_ID,\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from './context-ids';\n\nexport abstract class ContextServiceMap {\n  [context: string]: Type<SiteContext<any>>;\n}\n\nexport function serviceMapFactory() {\n  return {\n    [LANGUAGE_CONTEXT_ID]: LanguageService,\n    [CURRENCY_CONTEXT_ID]: CurrencyService,\n    [BASE_SITE_CONTEXT_ID]: BaseSiteService,\n  };\n}\n\nexport const contextServiceMapProvider: Provider = {\n  provide: ContextServiceMap,\n  useFactory: serviceMapFactory,\n};\n","import { SiteContextConfig } from './site-context-config';\nimport { getContextParameterDefault } from './context-config-utils';\nimport { BASE_SITE_CONTEXT_ID } from '../providers/context-ids';\n\nexport function baseSiteConfigValidator(config: SiteContextConfig) {\n  if (getContextParameterDefault(config, BASE_SITE_CONTEXT_ID) === undefined) {\n    return 'Please configure context.parameters.baseSite before using storefront library!';\n  }\n}\n","import { SiteContextConfig } from './site-context-config';\nimport {\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from '../providers/context-ids';\n\nexport function defaultSiteContextConfigFactory(): SiteContextConfig {\n  return {\n    context: {\n      [LANGUAGE_CONTEXT_ID]: [\n        'en',\n        'de',\n        'ja',\n        'zh',\n        'ru',\n        'fr',\n        'tr',\n        'it',\n        'es',\n        'uk',\n        'pl',\n        'nl',\n        'hi',\n        'ar',\n        'pt',\n        'bn',\n        'pa',\n      ],\n      [CURRENCY_CONTEXT_ID]: [\n        'USD',\n        'EUR',\n        'JPY',\n        'GBP',\n        'AUD',\n        'CAD',\n        'CHF',\n        'CNY',\n        'SEK',\n        'NZD',\n        'MXN',\n        'SGD',\n        'HKD',\n        'NOK',\n        'KRW',\n        'TRY',\n        'RUB',\n        'INR',\n        'BRL',\n        'ZAR',\n      ],\n    },\n  };\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { distinctUntilChanged, filter } from 'rxjs/operators';\nimport {\n  getContextParameterDefault,\n  getContextParameterValues,\n} from '../config/context-config-utils';\nimport { SiteContextConfig } from '../config/site-context-config';\nimport { SiteContext } from '../facade/site-context.interface';\nimport { ContextServiceMap } from '../providers/context-service-map';\n\n@Injectable()\nexport class SiteContextParamsService {\n  constructor(\n    private config: SiteContextConfig,\n    private injector: Injector,\n    private serviceMap: ContextServiceMap\n  ) {}\n\n  getContextParameters(): string[] {\n    if (this.config.context) {\n      return Object.keys(this.config.context).filter(\n        (param) => param !== 'urlParameters'\n      );\n    }\n    return [];\n  }\n\n  getUrlEncodingParameters(): string[] {\n    return (this.config.context && this.config.context.urlParameters) || [];\n  }\n\n  getParamValues(param: string): string[] {\n    return getContextParameterValues(this.config, param);\n  }\n\n  getParamDefaultValue(param: string): string {\n    return getContextParameterDefault(this.config, param);\n  }\n\n  getSiteContextService(param: string): SiteContext<any> {\n    if (this.serviceMap[param]) {\n      return this.injector.get<SiteContext<any>>(this.serviceMap[param], null);\n    }\n  }\n\n  getValue(param: string): string {\n    let value: string;\n\n    const service = this.getSiteContextService(param);\n    if (service) {\n      service\n        .getActive()\n        .subscribe((val) => (value = val))\n        .unsubscribe();\n    }\n\n    return value !== undefined ? value : this.getParamDefaultValue(param);\n  }\n\n  setValue(param: string, value: string) {\n    const service = this.getSiteContextService(param);\n    if (service) {\n      service.setActive(value);\n    }\n  }\n\n  /**\n   * Get active values for all provided context parameters\n   *\n   * @param params Context parameters\n   *\n   * @returns Observable emitting array of all passed active context values\n   */\n  getValues(params: string[]): Observable<Array<string>> {\n    if (params.length === 0) {\n      return of([]);\n    }\n\n    return combineLatest(\n      params.map((param) =>\n        this.getSiteContextService(param)\n          .getActive()\n          .pipe(distinctUntilChanged())\n      )\n    ).pipe(filter((value) => value.every((param) => !!param)));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { DefaultUrlSerializer, UrlTree } from '@angular/router';\nimport { SiteContextParamsService } from './site-context-params.service';\n\nexport interface ParamValuesMap {\n  [name: string]: string;\n}\n\nexport interface UrlTreeWithSiteContext extends UrlTree {\n  siteContext?: ParamValuesMap;\n}\n\nconst UrlSplit = /(^[^#?]*)(.*)/; // used to split url into path and query/fragment parts\n\n@Injectable()\nexport class SiteContextUrlSerializer extends DefaultUrlSerializer {\n  private get urlEncodingParameters(): string[] {\n    return this.siteContextParams.getUrlEncodingParameters();\n  }\n\n  get hasContextInRoutes() {\n    return this.urlEncodingParameters.length > 0;\n  }\n\n  constructor(private siteContextParams: SiteContextParamsService) {\n    super();\n  }\n\n  parse(url: string): UrlTreeWithSiteContext {\n    if (this.hasContextInRoutes) {\n      const urlWithParams = this.urlExtractContextParameters(url);\n      const parsed = super.parse(urlWithParams.url) as UrlTreeWithSiteContext;\n      this.urlTreeIncludeContextParameters(parsed, urlWithParams.params);\n      return parsed;\n    } else {\n      return super.parse(url);\n    }\n  }\n\n  urlExtractContextParameters(\n    url: string\n  ): { url: string; params: ParamValuesMap } {\n    const [, urlPart, queryPart] = url.match(UrlSplit);\n\n    const segments = urlPart.split('/');\n    if (segments[0] === '') {\n      segments.shift();\n    }\n    const params = {};\n\n    let paramId = 0;\n    let segmentId = 0;\n    while (\n      paramId < this.urlEncodingParameters.length &&\n      segmentId < segments.length\n    ) {\n      const paramName = this.urlEncodingParameters[paramId];\n      const paramValues = this.siteContextParams.getParamValues(paramName);\n\n      if (paramValues.includes(segments[segmentId])) {\n        params[paramName] = segments[segmentId];\n        segmentId++;\n      }\n      paramId++;\n    }\n\n    url = segments.slice(Object.keys(params).length).join('/') + queryPart;\n    return { url, params };\n  }\n\n  private urlTreeIncludeContextParameters(\n    urlTree: UrlTreeWithSiteContext,\n    params: ParamValuesMap\n  ) {\n    urlTree.siteContext = params;\n  }\n\n  serialize(tree: UrlTreeWithSiteContext): string {\n    const params = this.urlTreeExtractContextParameters(tree);\n    const url = super.serialize(tree);\n    const serialized = this.urlIncludeContextParameters(url, params);\n    return serialized;\n  }\n\n  urlTreeExtractContextParameters(\n    urlTree: UrlTreeWithSiteContext\n  ): ParamValuesMap {\n    return urlTree.siteContext ? urlTree.siteContext : {};\n  }\n\n  private urlIncludeContextParameters(url: string, params: ParamValuesMap) {\n    const contextRoutePart = this.urlEncodingParameters\n      .map((param) => {\n        return params[param]\n          ? params[param]\n          : this.siteContextParams.getValue(param);\n      })\n      .join('/');\n\n    return contextRoutePart + url;\n  }\n}\n","import { Location } from '@angular/common';\nimport { Injectable, Injector, OnDestroy } from '@angular/core';\nimport {\n  NavigationCancel,\n  NavigationEnd,\n  NavigationError,\n  NavigationStart,\n  Router,\n  RouterEvent,\n} from '@angular/router';\nimport { Subscription } from 'rxjs';\nimport { filter } from 'rxjs/operators';\nimport { SiteContextParamsService } from './site-context-params.service';\nimport { SiteContextUrlSerializer } from './site-context-url-serializer';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SiteContextRoutesHandler implements OnDestroy {\n  constructor(\n    private siteContextParams: SiteContextParamsService,\n    private serializer: SiteContextUrlSerializer,\n    private injector: Injector\n  ) {}\n\n  private subscription = new Subscription();\n\n  private contextValues: {\n    [param: string]: string;\n  } = {};\n\n  private router: Router;\n  private location: Location;\n\n  /**\n   * Tells whether there is a pending navigation at the moment, so we can avoid an infinite loop caused by the cyclic dependency:\n   * - `subscribeChanges` method triggers a navigation on update of site context state\n   * - `subscribeRouting` method updates the site context state on navigation\n   */\n  private isNavigating = false;\n\n  /**\n   * Initializes the two-way synchronization between the site context state and the URL.\n   */\n  init() {\n    this.router = this.injector.get<Router>(Router);\n\n    this.location = this.injector.get<Location>(Location);\n    const routingParams = this.siteContextParams.getUrlEncodingParameters();\n\n    if (routingParams.length) {\n      this.setContextParamsFromRoute(this.location.path(true));\n      this.subscribeChanges(routingParams);\n      this.subscribeRouting();\n    }\n  }\n\n  /**\n   * After each change of the site context state, it modifies the current URL in place.\n   * But it happens only for the parameters configured to be persisted in the URL.\n   */\n  private subscribeChanges(params: string[]) {\n    params.forEach((param) => {\n      const service = this.siteContextParams.getSiteContextService(param);\n      if (service) {\n        this.subscription.add(\n          service.getActive().subscribe((value) => {\n            if (\n              !this.isNavigating &&\n              this.contextValues[param] &&\n              this.contextValues[param] !== value\n            ) {\n              const parsed = this.router.parseUrl(this.router.url);\n              const serialized = this.router.serializeUrl(parsed);\n              this.location.replaceState(serialized);\n            }\n            this.contextValues[param] = value;\n          })\n        );\n      }\n    });\n  }\n\n  /**\n   * After each Angular NavigationStart event it updates the site context state based on\n   * site context params encoded in the anticipated URL.\n   */\n  private subscribeRouting() {\n    this.subscription.add(\n      this.router.events\n        .pipe(\n          filter(\n            (event) =>\n              event instanceof NavigationStart ||\n              event instanceof NavigationEnd ||\n              event instanceof NavigationError ||\n              event instanceof NavigationCancel\n          )\n        )\n        .subscribe((event: RouterEvent) => {\n          this.isNavigating = event instanceof NavigationStart;\n          if (this.isNavigating) {\n            this.setContextParamsFromRoute(event.url);\n          }\n        })\n    );\n  }\n\n  /**\n   * Updates the site context state based on the context params encoded in the given URL\n   *\n   * @param url URL with encoded context params\n   */\n  private setContextParamsFromRoute(url: string) {\n    const { params } = this.serializer.urlExtractContextParameters(url);\n    Object.keys(params).forEach((param) =>\n      this.siteContextParams.setValue(param, params[param])\n    );\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n}\n","import { APP_INITIALIZER, Provider } from '@angular/core';\nimport { ConfigInitializerService } from '../../config/config-initializer/config-initializer.service';\nimport { BaseSiteService } from '../facade/base-site.service';\nimport { CurrencyService } from '../facade/currency.service';\nimport { LanguageService } from '../facade/language.service';\nimport { SiteContextRoutesHandler } from '../services/site-context-routes-handler';\n\nexport function initializeContext(\n  baseSiteService: BaseSiteService,\n  langService: LanguageService,\n  currService: CurrencyService,\n  configInit: ConfigInitializerService,\n  siteContextRoutesHandler: SiteContextRoutesHandler\n) {\n  return async () => {\n    await configInit.getStableConfig('context');\n    siteContextRoutesHandler.init();\n    baseSiteService.initialize();\n    langService.initialize();\n    currService.initialize();\n  };\n}\n\nexport const contextServiceProviders: Provider[] = [\n  BaseSiteService,\n  LanguageService,\n  CurrencyService,\n  {\n    provide: APP_INITIALIZER,\n    useFactory: initializeContext,\n    deps: [\n      BaseSiteService,\n      LanguageService,\n      CurrencyService,\n      ConfigInitializerService,\n      SiteContextRoutesHandler,\n    ],\n    multi: true,\n  },\n];\n","import { Provider } from '@angular/core';\nimport { UrlSerializer } from '@angular/router';\nimport { SiteContextParamsService } from '../services/site-context-params.service';\nimport { SiteContextUrlSerializer } from '../services/site-context-url-serializer';\n\n// functions below should not be exposed in public API:\n\nexport const siteContextParamsProviders: Provider[] = [\n  SiteContextParamsService,\n  SiteContextUrlSerializer,\n  { provide: UrlSerializer, useExisting: SiteContextUrlSerializer },\n];\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { SiteConnector } from '../../connectors/site.connector';\nimport { SiteContextActions } from '../actions/index';\n\n@Injectable()\nexport class BaseSiteEffects {\n  @Effect()\n  loadBaseSite$: Observable<\n    SiteContextActions.LoadBaseSiteSuccess | SiteContextActions.LoadBaseSiteFail\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LOAD_BASE_SITE),\n    exhaustMap(() => {\n      return this.siteConnector.getBaseSite().pipe(\n        map((baseSite) => new SiteContextActions.LoadBaseSiteSuccess(baseSite)),\n        catchError((error) =>\n          of(\n            new SiteContextActions.LoadBaseSiteFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  loadBaseSites$: Observable<\n    | SiteContextActions.LoadBaseSitesSuccess\n    | SiteContextActions.LoadBaseSitesFail\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LOAD_BASE_SITES),\n    exhaustMap(() => {\n      return this.siteConnector.getBaseSites().pipe(\n        map(\n          (baseSites) => new SiteContextActions.LoadBaseSitesSuccess(baseSites)\n        ),\n        catchError((error) =>\n          of(\n            new SiteContextActions.LoadBaseSitesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Store } from '@ngrx/store';\nimport { NEVER, Observable, of } from 'rxjs';\nimport {\n  bufferCount,\n  catchError,\n  exhaustMap,\n  filter,\n  map,\n  switchMapTo,\n  tap,\n} from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { WindowRef } from '../../../window/window-ref';\nimport { SiteConnector } from '../../connectors/site.connector';\nimport { SiteContextActions } from '../actions/index';\nimport { getActiveCurrency } from '../selectors/currencies.selectors';\nimport { StateWithSiteContext } from '../state';\n\n@Injectable()\nexport class CurrenciesEffects {\n  @Effect()\n  loadCurrencies$: Observable<\n    | SiteContextActions.LoadCurrenciesSuccess\n    | SiteContextActions.LoadCurrenciesFail\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LOAD_CURRENCIES),\n    exhaustMap(() => {\n      return this.siteConnector.getCurrencies().pipe(\n        map(\n          (currencies) =>\n            new SiteContextActions.LoadCurrenciesSuccess(currencies)\n        ),\n        catchError((error) =>\n          of(\n            new SiteContextActions.LoadCurrenciesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  persist$: Observable<void> = this.actions$.pipe(\n    ofType(SiteContextActions.SET_ACTIVE_CURRENCY),\n    tap((action: SiteContextActions.SetActiveCurrency) => {\n      if (this.winRef.sessionStorage) {\n        this.winRef.sessionStorage.setItem('currency', action.payload);\n      }\n    }),\n    switchMapTo(NEVER)\n  );\n\n  @Effect()\n  activateCurrency$: Observable<\n    SiteContextActions.CurrencyChange\n  > = this.state.select(getActiveCurrency).pipe(\n    bufferCount(2, 1),\n\n    // avoid dispatching `change` action when we're just setting the initial value:\n    filter(([previous]) => !!previous),\n    map(\n      ([previous, current]) =>\n        new SiteContextActions.CurrencyChange({ previous, current })\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector,\n    private winRef: WindowRef,\n    private state: Store<StateWithSiteContext>\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Store } from '@ngrx/store';\nimport { NEVER, Observable, of } from 'rxjs';\nimport {\n  bufferCount,\n  catchError,\n  exhaustMap,\n  filter,\n  map,\n  switchMapTo,\n  tap,\n} from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { WindowRef } from '../../../window/window-ref';\nimport { SiteConnector } from '../../connectors/site.connector';\nimport { SiteContextActions } from '../actions/index';\nimport { getActiveLanguage } from '../selectors/languages.selectors';\nimport { StateWithSiteContext } from '../state';\n\n@Injectable()\nexport class LanguagesEffects {\n  @Effect()\n  loadLanguages$: Observable<\n    | SiteContextActions.LoadLanguagesSuccess\n    | SiteContextActions.LoadLanguagesFail\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LOAD_LANGUAGES),\n    exhaustMap(() => {\n      return this.siteConnector.getLanguages().pipe(\n        map(\n          (languages) => new SiteContextActions.LoadLanguagesSuccess(languages)\n        ),\n        catchError((error) =>\n          of(\n            new SiteContextActions.LoadLanguagesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  persist$: Observable<void> = this.actions$.pipe(\n    ofType(SiteContextActions.SET_ACTIVE_LANGUAGE),\n    tap((action: SiteContextActions.SetActiveLanguage) => {\n      if (this.winRef.sessionStorage) {\n        this.winRef.sessionStorage.setItem('language', action.payload);\n      }\n    }),\n    switchMapTo(NEVER)\n  );\n\n  @Effect()\n  activateLanguage$: Observable<\n    SiteContextActions.LanguageChange\n  > = this.state.select(getActiveLanguage).pipe(\n    bufferCount(2, 1),\n\n    // avoid dispatching `change` action when we're just setting the initial value:\n    filter(([previous]) => !!previous),\n    map(\n      ([previous, current]) =>\n        new SiteContextActions.LanguageChange({ previous, current })\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector,\n    private winRef: WindowRef,\n    private state: Store<StateWithSiteContext>\n  ) {}\n}\n","import { BaseSiteEffects } from './base-site.effect';\nimport { CurrenciesEffects } from './currencies.effect';\nimport { LanguagesEffects } from './languages.effect';\n\nexport const effects: any[] = [\n  LanguagesEffects,\n  CurrenciesEffects,\n  BaseSiteEffects,\n];\n\nexport * from './base-site.effect';\nexport * from './currencies.effect';\nexport * from './languages.effect';\n","import { BaseSite } from '../../../model/misc.model';\nimport { SiteContextActions } from '../actions/index';\nimport { BaseSiteState } from '../state';\n\nexport const initialState: BaseSiteState = {\n  entities: null,\n  details: {},\n  activeSite: '',\n};\n\nexport function reducer(\n  state = initialState,\n  action: SiteContextActions.BaseSiteAction\n): BaseSiteState {\n  switch (action.type) {\n    case SiteContextActions.LOAD_BASE_SITE_SUCCESS: {\n      return {\n        ...state,\n        details: action.payload,\n      };\n    }\n\n    case SiteContextActions.SET_ACTIVE_BASE_SITE: {\n      // if active base site is updated,\n      // the active base site details data should also be updated\n      let details = {};\n      if (state.entities) {\n        details = state.entities[action.payload];\n      }\n      return {\n        ...state,\n        details,\n        activeSite: action.payload,\n      };\n    }\n\n    case SiteContextActions.LOAD_BASE_SITES_SUCCESS: {\n      const sites: BaseSite[] = action.payload;\n      const entities = sites.reduce(\n        (siteEntities: { [uid: string]: BaseSite }, site: BaseSite) => {\n          return {\n            ...siteEntities,\n            [site.uid]: site,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n      // after base sites entities are populated,\n      // the active base site details data is also populated\n      const details = entities[state.activeSite];\n\n      return {\n        ...state,\n        details,\n        entities,\n      };\n    }\n  }\n\n  return state;\n}\n","import { Currency } from '../../../model/misc.model';\nimport { SiteContextActions } from '../actions/index';\nimport { CurrenciesState } from '../state';\n\nexport const initialState: CurrenciesState = {\n  entities: null,\n  activeCurrency: null,\n};\n\nexport function reducer(\n  state = initialState,\n  action: SiteContextActions.CurrenciesAction\n): CurrenciesState {\n  switch (action.type) {\n    case SiteContextActions.LOAD_CURRENCIES_SUCCESS: {\n      const currencies: Currency[] = action.payload;\n      const entities = currencies.reduce(\n        (currEntities: { [isocode: string]: Currency }, currency: Currency) => {\n          return {\n            ...currEntities,\n            [currency.isocode]: currency,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case SiteContextActions.SET_ACTIVE_CURRENCY: {\n      const isocode: string = action.payload;\n\n      return {\n        ...state,\n        activeCurrency: isocode,\n      };\n    }\n  }\n\n  return state;\n}\n","import { Language } from '../../../model/misc.model';\nimport { SiteContextActions } from '../actions/index';\nimport { LanguagesState } from '../state';\n\nexport const initialState: LanguagesState = {\n  entities: null,\n  activeLanguage: null,\n};\n\nexport function reducer(\n  state = initialState,\n  action: SiteContextActions.LanguagesAction\n): LanguagesState {\n  switch (action.type) {\n    case SiteContextActions.LOAD_LANGUAGES_SUCCESS: {\n      const languages: Language[] = action.payload;\n      const entities = languages.reduce(\n        (langEntities: { [isocode: string]: Language }, language: Language) => {\n          return {\n            ...langEntities,\n            [language.isocode]: language,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case SiteContextActions.SET_ACTIVE_LANGUAGE: {\n      const isocode = action.payload;\n\n      return {\n        ...state,\n        activeLanguage: isocode,\n      };\n    }\n  }\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducerMap } from '@ngrx/store';\nimport { SiteContextState } from '../state';\nimport * as fromBaseSite from './base-site.reducer';\nimport * as fromCurrencies from './currencies.reducer';\nimport * as fromLanguages from './languages.reducer';\n\nexport function getReducers(): ActionReducerMap<SiteContextState> {\n  return {\n    languages: fromLanguages.reducer,\n    currencies: fromCurrencies.reducer,\n    baseSite: fromBaseSite.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  SiteContextState\n>> = new InjectionToken<ActionReducerMap<SiteContextState>>(\n  'SiteContextReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport {\n  StateConfig,\n  StateTransferType,\n} from '../../state/config/state-config';\nimport { effects } from './effects/index';\nimport { reducerProvider, reducerToken } from './reducers/index';\nimport { SITE_CONTEXT_FEATURE } from './state';\nimport { provideDefaultConfigFactory } from '../../config/config-providers';\n\nexport function siteContextStoreConfigFactory(): StateConfig {\n  // if we want to reuse SITE_CONTEXT_FEATURE const in config, we have to use factory instead of plain object\n  const config: StateConfig = {\n    state: {\n      ssrTransfer: {\n        keys: { [SITE_CONTEXT_FEATURE]: StateTransferType.TRANSFER_STATE },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    StoreModule.forFeature(SITE_CONTEXT_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(siteContextStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class SiteContextStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { provideConfigValidator } from '../config/config-validator/config-validator';\nimport { StateModule } from '../state/index';\nimport { baseSiteConfigValidator } from './config/base-site-config-validator';\nimport { defaultSiteContextConfigFactory } from './config/default-site-context-config';\nimport { contextServiceMapProvider } from './providers/context-service-map';\nimport { contextServiceProviders } from './providers/context-service-providers';\nimport { siteContextParamsProviders } from './providers/site-context-params-providers';\nimport { SiteContextStoreModule } from './store/site-context-store.module';\nimport { provideDefaultConfigFactory } from '../config/config-providers';\n\n// @dynamic\n@NgModule({\n  imports: [StateModule, SiteContextStoreModule],\n})\nexport class SiteContextModule {\n  static forRoot(): ModuleWithProviders<SiteContextModule> {\n    return {\n      ngModule: SiteContextModule,\n      providers: [\n        provideDefaultConfigFactory(defaultSiteContextConfigFactory),\n        contextServiceMapProvider,\n        ...contextServiceProviders,\n        ...siteContextParamsProviders,\n        provideConfigValidator(baseSiteConfigValidator),\n      ],\n    };\n  }\n}\n","import { AnonymousConsentsActions } from '../actions/index';\n\nexport const initialState = false;\n\nexport function reducer(\n  state = initialState,\n  action: AnonymousConsentsActions.ToggleAnonymousConsentsBannerDissmissed\n): boolean {\n  switch (action.type) {\n    case AnonymousConsentsActions.TOGGLE_ANONYMOUS_CONSENTS_BANNER_DISMISSED: {\n      return action.dismissed;\n    }\n  }\n\n  return state;\n}\n","import { AnonymousConsentsActions } from '../actions/index';\n\nexport const initialState = false;\n\nexport function reducer(\n  state = initialState,\n  action: AnonymousConsentsActions.ToggleAnonymousConsentTemplatesUpdated\n): boolean {\n  switch (action.type) {\n    case AnonymousConsentsActions.TOGGLE_ANONYMOUS_CONSENT_TEMPLATES_UPDATED: {\n      return action.updated;\n    }\n  }\n\n  return state;\n}\n","import {\n  AnonymousConsent,\n  ANONYMOUS_CONSENT_STATUS,\n} from '../../../model/consent.model';\nimport { AnonymousConsentsActions } from '../actions/index';\n\nexport const initialState: AnonymousConsent[] = [];\n\nexport function toggleConsentStatus(\n  consents: AnonymousConsent[],\n  templateCode: string,\n  status: ANONYMOUS_CONSENT_STATUS\n): AnonymousConsent[] {\n  if (!consents) {\n    return [];\n  }\n\n  return consents.map((consent) => {\n    if (consent.templateCode === templateCode) {\n      consent = {\n        ...consent,\n        consentState: status,\n      };\n    }\n    return consent;\n  });\n}\n\nexport function reducer(\n  state = initialState,\n  action: AnonymousConsentsActions.AnonymousConsentsActions\n): AnonymousConsent[] {\n  switch (action.type) {\n    case AnonymousConsentsActions.GIVE_ANONYMOUS_CONSENT: {\n      return toggleConsentStatus(\n        state,\n        action.templateCode,\n        ANONYMOUS_CONSENT_STATUS.GIVEN\n      );\n    }\n\n    case AnonymousConsentsActions.WITHDRAW_ANONYMOUS_CONSENT: {\n      return toggleConsentStatus(\n        state,\n        action.templateCode,\n        ANONYMOUS_CONSENT_STATUS.WITHDRAWN\n      );\n    }\n\n    case AnonymousConsentsActions.SET_ANONYMOUS_CONSENTS: {\n      return action.payload;\n    }\n  }\n\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  Action,\n  ActionReducer,\n  ActionReducerMap,\n  combineReducers,\n  MetaReducer,\n} from '@ngrx/store';\nimport { AuthActions } from '../../../auth/index';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { SiteContextActions } from '../../../site-context/index';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport {\n  AnonymousConsentsState,\n  ANONYMOUS_CONSENTS,\n} from '../anonymous-consents-state';\nimport * as fromAnonymousConsentsBanner from './anonymous-consents-banner.reducer';\nimport * as fromAnonymousConsentsUpdate from './anonymous-consents-update.reducer';\nimport * as fromAnonymousConsents from './anonymous-consents.reducer';\n\nexport function getReducers(): ActionReducerMap<AnonymousConsentsState> {\n  return {\n    templates: loaderReducer<ConsentTemplate[]>(ANONYMOUS_CONSENTS),\n    consents: fromAnonymousConsents.reducer,\n    ui: combineReducers({\n      bannerDismissed: fromAnonymousConsentsBanner.reducer,\n      updated: fromAnonymousConsentsUpdate.reducer,\n    }),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  AnonymousConsentsState\n>> = new InjectionToken<ActionReducerMap<AnonymousConsentsState>>(\n  'AnonymousConsentsReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearAnonymousConsentTemplates(\n  reducer: ActionReducer<AnonymousConsentsState, Action>\n): ActionReducer<AnonymousConsentsState, Action> {\n  return function (state, action) {\n    if (\n      action.type === AuthActions.LOGOUT ||\n      action.type === SiteContextActions.LANGUAGE_CHANGE\n    ) {\n      state = {\n        ...state,\n        templates: undefined,\n      };\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [\n  clearAnonymousConsentTemplates,\n];\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport { Observable, Subscription } from 'rxjs';\nimport { StatePersistenceService } from '../../state/index';\nimport { AnonymousConsentsService } from '../facade/index';\nimport { LoadAnonymousConsentTemplatesSuccess } from '../store/actions/anonymous-consents-group';\nimport {\n  AnonymousConsentsState,\n  StateWithAnonymousConsents,\n} from '../store/index';\nimport { getAnonymousConsentState } from '../store/selectors/feature.selector';\n\n/**\n * Anonymous consents state synced to browser storage.\n */\nexport type SyncedAnonymousConsentsState = Partial<AnonymousConsentsState>;\n\n/**\n * Responsible for saving the anonymous consents data in browser storage.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AnonymousConsentsStatePersistenceService implements OnDestroy {\n  protected subscription = new Subscription();\n\n  constructor(\n    protected statePersistenceService: StatePersistenceService,\n    protected store: Store<StateWithAnonymousConsents>,\n    protected anonymousConsentsService: AnonymousConsentsService\n  ) {}\n\n  /**\n   * Identifier used for storage key.\n   */\n  protected key = 'anonymous-consents';\n\n  /**\n   * Initializes the synchronization between state and browser storage.\n   */\n  public initSync() {\n    this.subscription.add(\n      this.statePersistenceService.syncWithStorage({\n        key: this.key,\n        state$: this.getAuthState(),\n        onRead: (state) => this.onRead(state),\n      })\n    );\n  }\n\n  /**\n   * Gets and transforms state from different sources into the form that should\n   * be saved in storage.\n   */\n  protected getAuthState(): Observable<SyncedAnonymousConsentsState> {\n    return this.store.select(getAnonymousConsentState);\n  }\n\n  /**\n   * Function called on each browser storage read.\n   * Used to update state from browser -> state.\n   */\n  protected onRead(state: SyncedAnonymousConsentsState) {\n    const templates = state?.templates;\n    const consents = state?.consents;\n    const ui = state?.ui;\n\n    // templates\n    if (templates?.success) {\n      this.store.dispatch(\n        new LoadAnonymousConsentTemplatesSuccess(templates.value)\n      );\n    }\n\n    // consents\n    if (consents) {\n      this.anonymousConsentsService.setConsents(consents);\n    }\n\n    // ui\n    if (ui) {\n      this.anonymousConsentsService.toggleBannerDismissed(ui?.bannerDismissed);\n      this.anonymousConsentsService.toggleTemplatesUpdated(ui?.updated);\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { APP_INITIALIZER, NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { StateModule } from '../../state/state.module';\nimport { ANONYMOUS_CONSENTS_STORE_FEATURE } from './anonymous-consents-state';\nimport { effects } from './effects/index';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\nimport { AnonymousConsentsStatePersistenceService } from '../services/anonymous-consents-state-persistence.service';\n\nexport function anonymousConsentsStatePersistenceFactory(\n  anonymousConsentsStatePersistenceService: AnonymousConsentsStatePersistenceService\n): () => void {\n  const result = () => anonymousConsentsStatePersistenceService.initSync();\n  return result;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    StateModule,\n    StoreModule.forFeature(ANONYMOUS_CONSENTS_STORE_FEATURE, reducerToken, {\n      metaReducers,\n    }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    reducerProvider,\n    {\n      provide: APP_INITIALIZER,\n      useFactory: anonymousConsentsStatePersistenceFactory,\n      deps: [AnonymousConsentsStatePersistenceService],\n      multi: true,\n    },\n  ],\n})\nexport class AnonymousConsentsStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { provideDefaultConfig } from '../config/config-providers';\nimport { defaultAnonymousConsentsConfig } from './config/default-anonymous-consents-config';\nimport { AnonymousConsentsService } from './facade/anonymous-consents.service';\nimport { interceptors } from './http-interceptors/index';\nimport { AnonymousConsentsStoreModule } from './store/anonymous-consents-store.module';\n\n@NgModule({\n  imports: [AnonymousConsentsStoreModule],\n})\nexport class AnonymousConsentsModule {\n  static forRoot(): ModuleWithProviders<AnonymousConsentsModule> {\n    return {\n      ngModule: AnonymousConsentsModule,\n      providers: [\n        ...interceptors,\n        AnonymousConsentsService,\n        provideDefaultConfig(defaultAnonymousConsentsConfig),\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { AuthToken } from '../../auth/user-auth/models/auth-token.model';\nimport { AuthStorageService } from '../../auth/user-auth/services/auth-storage.service';\n\n/**\n * Indicates if auth token is for regular user or CS Agent.\n */\nexport enum TokenTarget {\n  CSAgent = 'CSAgent',\n  User = 'User',\n}\n\n/**\n * With AsmAuthStorageService apart from storing the token we also need to store\n * information for which user is the token (regular user or CS Agent).\n *\n * Overrides `AuthStorageService`.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AsmAuthStorageService extends AuthStorageService {\n  protected _tokenTarget$: Observable<TokenTarget> = new BehaviorSubject<\n    TokenTarget\n  >(TokenTarget.User);\n\n  /**\n   * When CS Agent logs in during regular user session we store the regular\n   * user token to restore the session after CS Agent logout.\n   *\n   * This supports in-store use case when CS Agent want's to quickly help\n   * customer and then give an option to customer to continue the process.\n   */\n  protected emulatedUserToken: AuthToken;\n\n  /**\n   * Get target user for current auth token.\n   *\n   * @return observable with TokenTarget\n   */\n  getTokenTarget(): Observable<TokenTarget> {\n    return this._tokenTarget$;\n  }\n\n  /**\n   * Set new token target.\n   *\n   * @param tokenTarget\n   */\n  setTokenTarget(tokenTarget: TokenTarget): void {\n    (this._tokenTarget$ as BehaviorSubject<TokenTarget>).next(tokenTarget);\n  }\n\n  /**\n   * Get token for previously user session, when it was interrupted by CS agent login.\n   *\n   * @return previously logged in user token.\n   */\n  getEmulatedUserToken(): AuthToken {\n    return this.emulatedUserToken;\n  }\n\n  /**\n   * Save user token on CS agent login.\n   *\n   * @param token\n   */\n  setEmulatedUserToken(token: AuthToken): void {\n    this.emulatedUserToken = token;\n  }\n\n  /**\n   * Change token target to CS Agent.\n   */\n  switchTokenTargetToCSAgent(): void {\n    (this._tokenTarget$ as BehaviorSubject<TokenTarget>).next(\n      TokenTarget.CSAgent\n    );\n  }\n\n  /**\n   * Change token target to user.\n   */\n  switchTokenTargetToUser(): void {\n    (this._tokenTarget$ as BehaviorSubject<TokenTarget>).next(TokenTarget.User);\n  }\n\n  /**\n   * When we start emulation from the UI (not by ASM login) we can't restore user session on cs agent logout.\n   * Only available solution is to drop session we could restore, to avoid account hijack.\n   */\n  clearEmulatedUserToken(): void {\n    this.emulatedUserToken = undefined;\n  }\n}\n","import { AsmConfig } from './asm-config';\n\nexport const defaultAsmConfig: AsmConfig = {\n  asm: {\n    agentSessionTimer: {\n      startingDelayInSeconds: 600,\n    },\n    customerSearch: {\n      maxResults: 20,\n    },\n  },\n};\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { Title, User, UserSignUp } from '../../model/misc.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/index';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  REGISTER_USER_PROCESS_ID,\n  REMOVE_USER_PROCESS_ID,\n  StateWithUser,\n  UPDATE_EMAIL_PROCESS_ID,\n  UPDATE_PASSWORD_PROCESS_ID,\n  UPDATE_USER_DETAILS_PROCESS_ID,\n} from '../store/user-state';\n\n@Injectable({ providedIn: 'root' })\nexport class UserService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Returns a user\n   */\n  get(): Observable<User> {\n    return this.store.pipe(\n      select(UsersSelectors.getDetails),\n      tap((details) => {\n        if (Object.keys(details).length === 0) {\n          this.load();\n        }\n      })\n    );\n  }\n\n  /**\n   * Loads the user's details\n   */\n  load(): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      if (userId !== OCC_USER_ID_ANONYMOUS) {\n        this.store.dispatch(new UserActions.LoadUserDetails(userId));\n      }\n    });\n  }\n\n  /**\n   * Register a new user\n   *\n   * @param submitFormData as UserRegisterFormData\n   */\n  register(userRegisterFormData: UserSignUp): void {\n    this.store.dispatch(new UserActions.RegisterUser(userRegisterFormData));\n  }\n\n  /**\n   * Register a new user from guest\n   *\n   * @param guid\n   * @param password\n   */\n  registerGuest(guid: string, password: string): void {\n    this.store.dispatch(new UserActions.RegisterGuest({ guid, password }));\n  }\n\n  /**\n   * Returns the register user process loading flag\n   */\n  getRegisterUserResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(REGISTER_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the register user process success flag\n   */\n  getRegisterUserResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(REGISTER_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the register user process error flag\n   */\n  getRegisterUserResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(REGISTER_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the register user process flags\n   */\n  resetRegisterUserProcessState(): void {\n    return this.store.dispatch(new UserActions.ResetRegisterUserProcess());\n  }\n\n  /**\n   * Remove user account, that's also called close user's account\n   */\n  remove(): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(new UserActions.RemoveUser(userId));\n    });\n  }\n\n  /**\n   * Returns the remove user loading flag\n   */\n  getRemoveUserResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(REMOVE_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the remove user failure outcome.\n   */\n  getRemoveUserResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(REMOVE_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the remove user process success outcome.\n   */\n  getRemoveUserResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(REMOVE_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the remove user process state. The state needs to be reset after the process\n   * concludes, regardless if it's a success or an error\n   */\n  resetRemoveUserProcessState(): void {\n    this.store.dispatch(new UserActions.RemoveUserReset());\n  }\n\n  /**\n   * Returns titles.\n   */\n  getTitles(): Observable<Title[]> {\n    return this.store.pipe(\n      select(UsersSelectors.getAllTitles),\n      tap((titles: Title[]) => {\n        if (Object.keys(titles).length === 0) {\n          this.loadTitles();\n        }\n      })\n    );\n  }\n\n  /**\n   * Retrieves titles\n   */\n  loadTitles(): void {\n    this.store.dispatch(new UserActions.LoadTitles());\n  }\n\n  /**\n   * Return whether user's password is successfully reset\n   */\n  isPasswordReset(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getResetPassword));\n  }\n\n  /**\n   * Updates the user's details\n   * @param userDetails to be updated\n   */\n  updatePersonalDetails(userDetails: User): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.UpdateUserDetails({\n          username: userId,\n          userDetails,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the update user's personal details loading flag\n   */\n  getUpdatePersonalDetailsResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(UPDATE_USER_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's personal details error flag\n   */\n  getUpdatePersonalDetailsResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(UPDATE_USER_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's personal details success flag\n   */\n  getUpdatePersonalDetailsResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(UPDATE_USER_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the update user details processing state\n   */\n  resetUpdatePersonalDetailsProcessingState(): void {\n    this.store.dispatch(new UserActions.ResetUpdateUserDetails());\n  }\n\n  /**\n   * Reset new password.  Part of the forgot password flow.\n   * @param token\n   * @param password\n   */\n  resetPassword(token: string, password: string): void {\n    this.store.dispatch(new UserActions.ResetPassword({ token, password }));\n  }\n\n  /*\n   * Request an email to reset a forgotten password.\n   */\n  requestForgotPasswordEmail(userEmailAddress: string): void {\n    this.store.dispatch(\n      new UserActions.ForgotPasswordEmailRequest(userEmailAddress)\n    );\n  }\n\n  /**\n   * Updates the user's email\n   */\n  updateEmail(password: string, newUid: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.UpdateEmailAction({\n          uid: userId,\n          password,\n          newUid,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the update user's email success flag\n   */\n  getUpdateEmailResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(UPDATE_EMAIL_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's email error flag\n   */\n  getUpdateEmailResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(UPDATE_EMAIL_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's email loading flag\n   */\n  getUpdateEmailResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(UPDATE_EMAIL_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the update user's email processing state\n   */\n  resetUpdateEmailResultState(): void {\n    this.store.dispatch(new UserActions.ResetUpdateEmailAction());\n  }\n\n  /**\n   * Updates the password for the user\n   * @param oldPassword the current password that will be changed\n   * @param newPassword the new password\n   */\n  updatePassword(oldPassword: string, newPassword: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.UpdatePassword({\n          userId,\n          oldPassword,\n          newPassword,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the update password loading flag\n   */\n  getUpdatePasswordResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(UPDATE_PASSWORD_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update password failure outcome.\n   */\n  getUpdatePasswordResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(UPDATE_PASSWORD_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update password process success outcome.\n   */\n  getUpdatePasswordResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(UPDATE_PASSWORD_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the update password process state. The state needs to be reset after the process\n   * concludes, regardless if it's a success or an error\n   */\n  resetUpdatePasswordProcessState(): void {\n    this.store.dispatch(new UserActions.UpdatePasswordReset());\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { AsmUi } from '../../models/asm.models';\n\nexport const ASM_UI_UPDATE = '[Asm] UI Update';\n\nexport class AsmUiUpdate implements Action {\n  readonly type = ASM_UI_UPDATE;\n  constructor(public payload: AsmUi) {}\n}\n// action types\nexport type AsmUiAction = AsmUiUpdate;\n","import { LoaderState } from '../../state/utils/loader/loader-state';\nimport { AsmUi, CustomerSearchPage } from '../models/asm.models';\n\nexport const ASM_FEATURE = 'asm';\nexport const CUSTOMER_SEARCH_DATA = '[asm] Customer search data';\n\nexport interface StateWithAsm {\n  [ASM_FEATURE]: AsmState;\n}\n\nexport interface AsmState {\n  customerSearchResult: LoaderState<CustomerSearchPage>;\n  asmUi: AsmUi;\n}\n","import { StateUtils } from '../../../state/utils/index';\nimport {\n  CustomerSearchOptions,\n  CustomerSearchPage,\n} from '../../models/asm.models';\nimport { CUSTOMER_SEARCH_DATA } from '../asm-state';\n\nexport const CUSTOMER_SEARCH = '[Asm] Customer Search';\nexport const CUSTOMER_SEARCH_FAIL = '[Asm] Customer Search Fail';\nexport const CUSTOMER_SEARCH_SUCCESS = '[Asm] Customer Search Success';\nexport const CUSTOMER_SEARCH_RESET = '[Asm] Customer Search Reset';\n\nexport class CustomerSearch extends StateUtils.LoaderLoadAction {\n  readonly type = CUSTOMER_SEARCH;\n  constructor(public payload: CustomerSearchOptions) {\n    super(CUSTOMER_SEARCH_DATA);\n  }\n}\n\nexport class CustomerSearchFail extends StateUtils.LoaderFailAction {\n  readonly type = CUSTOMER_SEARCH_FAIL;\n  constructor(public payload: any) {\n    super(CUSTOMER_SEARCH_DATA);\n  }\n}\n\nexport class CustomerSearchSuccess extends StateUtils.LoaderSuccessAction {\n  readonly type = CUSTOMER_SEARCH_SUCCESS;\n  constructor(public payload: CustomerSearchPage) {\n    super(CUSTOMER_SEARCH_DATA);\n  }\n}\n\nexport class CustomerSearchReset extends StateUtils.LoaderResetAction {\n  readonly type = CUSTOMER_SEARCH_RESET;\n  constructor() {\n    super(CUSTOMER_SEARCH_DATA);\n  }\n}\n\n// action types\nexport type CustomerAction =\n  | CustomerSearch\n  | CustomerSearchFail\n  | CustomerSearchSuccess\n  | CustomerSearchReset;\n","import { Action } from '@ngrx/store';\n\nexport const LOGOUT_CUSTOMER_SUPPORT_AGENT =\n  '[Auth] Logout Customer Support Agent';\n\n/**\n * Action dispatched after customer support agent logout. Used to clear store data (ui, search results)\n */\nexport class LogoutCustomerSupportAgent implements Action {\n  readonly type = LOGOUT_CUSTOMER_SUPPORT_AGENT;\n}\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { AuthService } from '../../auth/user-auth/facade/auth.service';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { OAuthLibWrapperService } from '../../auth/user-auth/services/oauth-lib-wrapper.service';\nimport { AuthActions } from '../../auth/user-auth/store/actions';\nimport {\n  OCC_USER_ID_ANONYMOUS,\n  OCC_USER_ID_CURRENT,\n} from '../../occ/utils/occ-constants';\nimport { UserService } from '../../user/facade/user.service';\nimport {\n  AsmAuthStorageService,\n  TokenTarget,\n} from '../services/asm-auth-storage.service';\nimport { AsmActions } from '../store/actions';\nimport { StateWithAsm } from '../store/asm-state';\n\n/**\n * Auth service for CS agent. Useful to login/logout agent, start emulation\n * or get information about the status of emulation.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class CsAgentAuthService {\n  constructor(\n    protected authService: AuthService,\n    protected authStorageService: AsmAuthStorageService,\n    protected userIdService: UserIdService,\n    protected oAuthLibWrapperService: OAuthLibWrapperService,\n    protected store: Store<StateWithAsm>,\n    protected userService: UserService\n  ) {}\n\n  /**\n   * Loads access token for a customer support agent.\n   * @param userId\n   * @param password\n   */\n  async authorizeCustomerSupportAgent(\n    userId: string,\n    password: string\n  ): Promise<void> {\n    let userToken;\n    this.authStorageService\n      .getToken()\n      .subscribe((token) => (userToken = token))\n      .unsubscribe();\n\n    this.authStorageService.switchTokenTargetToCSAgent();\n    try {\n      await this.oAuthLibWrapperService.authorizeWithPasswordFlow(\n        userId,\n        password\n      );\n      // Start emulation for currently logged in user\n      let customerId: string;\n      this.userService\n        .get()\n        .subscribe((user) => (customerId = user?.customerId))\n        .unsubscribe();\n      this.store.dispatch(new AuthActions.Logout());\n\n      if (Boolean(customerId)) {\n        // OCC specific user id handling. Customize when implementing different backend\n        this.userIdService.setUserId(customerId);\n        this.authStorageService.setEmulatedUserToken(userToken);\n        this.store.dispatch(new AuthActions.Login());\n      } else {\n        // When we can't get the customerId just end all current sessions\n        this.userIdService.setUserId(OCC_USER_ID_ANONYMOUS);\n        this.authStorageService.clearEmulatedUserToken();\n      }\n    } catch {\n      this.authStorageService.switchTokenTargetToUser();\n    }\n  }\n\n  /**\n   * Starts an ASM customer emulation session.\n   * A customer emulation session is stopped by calling logout().\n   * @param customerId\n   */\n  public startCustomerEmulationSession(customerId: string): void {\n    this.authStorageService.clearEmulatedUserToken();\n\n    // OCC specific user id handling. Customize when implementing different backend\n    this.store.dispatch(new AuthActions.Logout());\n    this.userIdService.setUserId(customerId);\n    this.store.dispatch(new AuthActions.Login());\n  }\n\n  /**\n   * Check if CS agent is currently logged in.\n   *\n   * @returns observable emitting true when CS agent is logged in or false when not.\n   */\n  public isCustomerSupportAgentLoggedIn(): Observable<boolean> {\n    return combineLatest([\n      this.authStorageService.getToken(),\n      this.authStorageService.getTokenTarget(),\n    ]).pipe(\n      map(([token, tokenTarget]) =>\n        Boolean(token?.access_token && tokenTarget === TokenTarget.CSAgent)\n      )\n    );\n  }\n\n  /**\n   * Utility function to determine if customer is emulated.\n   *\n   * @returns observable emitting true when there is active emulation session or false when not.\n   */\n  public isCustomerEmulated(): Observable<boolean> {\n    return this.userIdService.isEmulated();\n  }\n\n  /**\n   * Returns the customer support agent's token loading status\n   */\n  public getCustomerSupportAgentTokenLoading(): Observable<boolean> {\n    // TODO(#8248): Create new loading state outside of store\n    return of(false);\n  }\n\n  /**\n   * Logout a customer support agent.\n   */\n  async logoutCustomerSupportAgent(): Promise<void> {\n    const emulatedToken = this.authStorageService.getEmulatedUserToken();\n\n    let isCustomerEmulated;\n    this.userIdService\n      .isEmulated()\n      .subscribe((emulated) => (isCustomerEmulated = emulated))\n      .unsubscribe();\n\n    await this.oAuthLibWrapperService.revokeAndLogout();\n\n    this.store.dispatch(new AsmActions.LogoutCustomerSupportAgent());\n    this.authStorageService.setTokenTarget(TokenTarget.User);\n\n    if (isCustomerEmulated && emulatedToken) {\n      this.store.dispatch(new AuthActions.Logout());\n      this.authStorageService.setToken(emulatedToken);\n      this.userIdService.setUserId(OCC_USER_ID_CURRENT);\n      this.authStorageService.clearEmulatedUserToken();\n      this.store.dispatch(new AuthActions.Login());\n    } else {\n      this.authService.logout();\n    }\n  }\n}\n","import { HttpRequest } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { take } from 'rxjs/operators';\nimport { AuthService } from '../../auth/user-auth/facade/auth.service';\nimport { AuthHttpHeaderService } from '../../auth/user-auth/services/auth-http-header.service';\nimport { AuthStorageService } from '../../auth/user-auth/services/auth-storage.service';\nimport { OAuthLibWrapperService } from '../../auth/user-auth/services/oauth-lib-wrapper.service';\nimport { GlobalMessageService } from '../../global-message/facade/global-message.service';\nimport { GlobalMessageType } from '../../global-message/models/global-message.model';\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n} from '../../occ/utils/interceptor-util';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { CsAgentAuthService } from '../facade/csagent-auth.service';\n\n/**\n * Overrides `AuthHttpHeaderService` to handle asm calls as well (not only OCC)\n * in cases of normal user session and on customer emulation.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AsmAuthHttpHeaderService extends AuthHttpHeaderService {\n  constructor(\n    protected authService: AuthService,\n    protected authStorageService: AuthStorageService,\n    protected csAgentAuthService: CsAgentAuthService,\n    protected oAuthLibWrapperService: OAuthLibWrapperService,\n    protected routingService: RoutingService,\n    protected globalMessageService: GlobalMessageService,\n    protected occEndpointsService: OccEndpointsService\n  ) {\n    super(\n      authService,\n      authStorageService,\n      oAuthLibWrapperService,\n      routingService,\n      occEndpointsService,\n      globalMessageService\n    );\n  }\n\n  /**\n   * @override\n   *\n   * Checks if particular request should be handled by this service.\n   */\n  public shouldCatchError(request: HttpRequest<any>): boolean {\n    return (\n      super.shouldCatchError(request) || this.isCSAgentTokenRequest(request)\n    );\n  }\n\n  /**\n   * @override\n   *\n   * Adds `Authorization` header to occ and CS agent requests.\n   * For CS agent requests also removes the `cx-use-csagent-token` header (to avoid problems with CORS).\n   */\n  public alterRequest(request: HttpRequest<any>): HttpRequest<any> {\n    const hasAuthorizationHeader = !!this.getAuthorizationHeader(request);\n    const isCSAgentRequest = this.isCSAgentTokenRequest(request);\n\n    let req = super.alterRequest(request);\n\n    if (!hasAuthorizationHeader && isCSAgentRequest) {\n      req = request.clone({\n        setHeaders: {\n          ...this.createAuthorizationHeader(),\n        },\n      });\n      return InterceptorUtil.removeHeader(\n        USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n        req\n      );\n    }\n    return req;\n  }\n\n  protected isCSAgentTokenRequest(request: HttpRequest<any>): boolean {\n    const isRequestWithCSAgentToken = InterceptorUtil.getInterceptorParam(\n      USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n      request.headers\n    );\n    return Boolean(isRequestWithCSAgentToken);\n  }\n\n  /**\n   * @override\n   *\n   * On backend errors indicating expired `refresh_token` we need to logout\n   * currently logged in user and CS agent.\n   */\n  public handleExpiredRefreshToken(): void {\n    this.csAgentAuthService\n      .isCustomerSupportAgentLoggedIn()\n      .pipe(take(1))\n      .subscribe((csAgentLoggedIn) => {\n        if (csAgentLoggedIn) {\n          this.csAgentAuthService.logoutCustomerSupportAgent();\n          this.globalMessageService.add(\n            {\n              key: 'asm.csagentTokenExpired',\n            },\n            GlobalMessageType.MSG_TYPE_ERROR\n          );\n        } else {\n          super.handleExpiredRefreshToken();\n        }\n      });\n  }\n}\n","export enum HttpResponseStatus {\n  UNKNOWN = -1,\n  BAD_REQUEST = 400,\n  UNAUTHORIZED = 401,\n  FORBIDDEN = 403,\n  NOT_FOUND = 404,\n  CONFLICT = 409,\n  BAD_GATEWAY = 502,\n  GATEWAY_TIMEOUT = 504,\n  INTERNAL_SERVER_ERROR = 500,\n}\n","import { GlobalMessageType } from '../models/global-message.model';\nimport { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\n\nexport type GlobalMessageTypeConfig = {\n  timeout?: number;\n};\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class GlobalMessageConfig {\n  globalMessages: {\n    [GlobalMessageType.MSG_TYPE_CONFIRMATION]?: GlobalMessageTypeConfig;\n    [GlobalMessageType.MSG_TYPE_INFO]?: GlobalMessageTypeConfig;\n    [GlobalMessageType.MSG_TYPE_ERROR]?: GlobalMessageTypeConfig;\n    [GlobalMessageType.MSG_TYPE_WARNING]?: GlobalMessageTypeConfig;\n  };\n}\n","import { HttpErrorResponse, HttpRequest } from '@angular/common/http';\nimport { GlobalMessageService } from '../../facade/global-message.service';\nimport { Injectable } from '@angular/core';\nimport { Applicable, Priority } from '../../../util/applicable';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport abstract class HttpErrorHandler implements Applicable {\n  constructor(protected globalMessageService: GlobalMessageService) {}\n\n  /**\n   * The http response status number which is handled by this handler.\n   * Implementations can set the response status number, i.e. 404, so that\n   * the handler can be found by the error interceptor.\n   */\n  responseStatus?: number;\n\n  /**\n   * Handles the error response for the respose status that is register for the handler\n   * @param { HttpRequest<any> } request : http request\n   * @param { HttpErrorResponse } errorResponse : Http error response\n   */\n  abstract handleError(\n    request: HttpRequest<any>,\n    errorResponse: HttpErrorResponse\n  ): void;\n\n  /**\n   * Error handlers are matched by the error `responseStatus` (i.e. 404). On top of the matching status\n   * a priority can be added to distinguish multiple handles for the same response status.\n   */\n  hasMatch(errorResponse: HttpErrorResponse): boolean {\n    return errorResponse.status === this.responseStatus;\n  }\n\n  abstract getPriority?(): Priority;\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../../models/global-message.model';\nimport { HttpResponseStatus } from '../../../models/response-status.model';\nimport { HttpErrorHandler } from '../http-error.handler';\nimport { Priority } from '../../../../util/applicable';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class BadGatewayHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.BAD_GATEWAY;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.badGateway' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n\n  getPriority(): Priority {\n    return Priority.LOW;\n  }\n}\n","import { HttpErrorResponse, HttpRequest } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { isCartNotFoundError } from '../../../../cart/utils/utils';\nimport { ErrorModel } from '../../../../model/misc.model';\nimport { Priority } from '../../../../util/applicable';\nimport { GlobalMessageType } from '../../../models/global-message.model';\nimport { HttpResponseStatus } from '../../../models/response-status.model';\nimport { HttpErrorHandler } from '../http-error.handler';\n\nconst OAUTH_ENDPOINT = '/authorizationserver/oauth/token';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class BadRequestHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.BAD_REQUEST;\n\n  handleError(request: HttpRequest<any>, response: HttpErrorResponse): void {\n    this.handleBadPassword(request, response);\n    this.handleBadLoginResponse(request, response);\n    this.handleBadCartRequest(request, response);\n    this.handleValidationError(request, response);\n    this.handleVoucherOperationError(request, response);\n  }\n\n  protected handleBadPassword(\n    request: HttpRequest<any>,\n    response: HttpErrorResponse\n  ): void {\n    if (\n      response.url?.includes(OAUTH_ENDPOINT) &&\n      response.error?.error === 'invalid_grant' &&\n      request.body?.get('grant_type') === 'password'\n    ) {\n      this.globalMessageService.add(\n        {\n          key: 'httpHandlers.badRequestPleaseLoginAgain',\n          params: {\n            errorMessage:\n              response.error.error_description || response.message || '',\n          },\n        },\n        GlobalMessageType.MSG_TYPE_ERROR\n      );\n      this.globalMessageService.remove(GlobalMessageType.MSG_TYPE_CONFIRMATION);\n    }\n  }\n\n  protected handleBadLoginResponse(\n    _request: HttpRequest<any>,\n    response: HttpErrorResponse\n  ) {\n    this.getErrors(response)\n      .filter((error) => error.type === 'PasswordMismatchError')\n      .forEach(() => {\n        this.globalMessageService.add(\n          { key: 'httpHandlers.badRequestOldPasswordIncorrect' },\n          GlobalMessageType.MSG_TYPE_ERROR\n        );\n      });\n  }\n\n  protected handleValidationError(\n    _request: HttpRequest<any>,\n    response: HttpErrorResponse\n  ): void {\n    this.getErrors(response)\n      .filter((e) => e.type === 'ValidationError')\n      .forEach((error) => {\n        this.globalMessageService.add(\n          {\n            key: `httpHandlers.validationErrors.${error.reason}.${error.subject}`,\n          },\n          GlobalMessageType.MSG_TYPE_ERROR\n        );\n      });\n  }\n\n  protected handleBadCartRequest(\n    _request: HttpRequest<any>,\n    response: HttpErrorResponse\n  ): void {\n    this.getErrors(response)\n      .filter((e) => isCartNotFoundError(e))\n      .forEach(() => {\n        this.globalMessageService.add(\n          { key: 'httpHandlers.cartNotFound' },\n          GlobalMessageType.MSG_TYPE_ERROR\n        );\n      });\n  }\n\n  protected handleVoucherOperationError(\n    _request: HttpRequest<any>,\n    response: HttpErrorResponse\n  ): void {\n    this.getErrors(response)\n      .filter(\n        (e) =>\n          e.message === 'coupon.invalid.code.provided' &&\n          e.type === 'VoucherOperationError'\n      )\n      .forEach(() => {\n        this.globalMessageService.add(\n          { key: 'httpHandlers.invalidCodeProvided' },\n          GlobalMessageType.MSG_TYPE_ERROR\n        );\n      });\n  }\n\n  protected getErrors(response: HttpErrorResponse): ErrorModel[] {\n    return (response.error?.errors || []).filter(\n      (error) => error.type !== 'JaloObjectNoLongerValidError'\n    );\n  }\n\n  getPriority(): Priority {\n    return Priority.LOW;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../../models/global-message.model';\nimport { HttpResponseStatus } from '../../../models/response-status.model';\nimport { HttpErrorHandler } from '../http-error.handler';\nimport { Priority } from '../../../../util/applicable';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConflictHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.CONFLICT;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.conflict' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n\n  getPriority(): Priority {\n    return Priority.LOW;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AuthService } from '../../../../auth/user-auth/facade/auth.service';\nimport { OccEndpointsService } from '../../../../occ/services/occ-endpoints.service';\nimport { Priority } from '../../../../util/applicable';\nimport { GlobalMessageService } from '../../../facade/global-message.service';\nimport { GlobalMessageType } from '../../../models/global-message.model';\nimport { HttpResponseStatus } from '../../../models/response-status.model';\nimport { HttpErrorHandler } from '../http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ForbiddenHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.FORBIDDEN;\n\n  handleError(request) {\n    if (\n      request.url.endsWith(\n        this.occEndpoints.getUrl('user', { userId: 'current' })\n      )\n    ) {\n      this.authService.logout();\n    }\n    this.globalMessageService.add(\n      { key: 'httpHandlers.forbidden' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n\n  getPriority(): Priority {\n    return Priority.LOW;\n  }\n\n  constructor(\n    protected globalMessageService: GlobalMessageService,\n    protected authService: AuthService,\n    protected occEndpoints: OccEndpointsService\n  ) {\n    super(globalMessageService);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../../models/global-message.model';\nimport { HttpResponseStatus } from '../../../models/response-status.model';\nimport { HttpErrorHandler } from '../http-error.handler';\nimport { Priority } from '../../../../util/applicable';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class GatewayTimeoutHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.GATEWAY_TIMEOUT;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.gatewayTimeout' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n\n  getPriority(): Priority {\n    return Priority.LOW;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../../models/global-message.model';\nimport { HttpResponseStatus } from '../../../models/response-status.model';\nimport { HttpErrorHandler } from '../http-error.handler';\nimport { Priority } from '../../../../util/applicable';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class InternalServerErrorHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.INTERNAL_SERVER_ERROR;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.internalServerError' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n\n  getPriority(): Priority {\n    return Priority.LOW;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpResponseStatus } from '../../../models/response-status.model';\nimport { HttpErrorHandler } from '../http-error.handler';\nimport { Priority } from '../../../../util/applicable';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class NotFoundHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.NOT_FOUND;\n\n  // empty error handler to avoid we fallabck to the unknown error handler\n  handleError(): void {}\n\n  getPriority() {\n    return Priority.LOW;\n  }\n}\n","import { Injectable, isDevMode } from '@angular/core';\nimport { HttpResponseStatus } from '../../../models/response-status.model';\nimport { HttpErrorHandler } from '../http-error.handler';\nimport { Priority } from '../../../../util/applicable';\n\n/**\n * Unknown Error Handler works as an fallback, to handle errors that were\n * not handled by any other error handlers\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class UnknownErrorHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.UNKNOWN;\n\n  /**\n   * hasMatch always returns true, to mach all errors\n   */\n  hasMatch(_errorResponse): boolean {\n    return true;\n  }\n\n  handleError() {\n    if (isDevMode()) {\n      console.warn(`Unknown http response error: ${this.responseStatus}`);\n    }\n  }\n\n  /**\n   * Fallback priority assures that the handler is used as a last resort\n   */\n  getPriority() {\n    return Priority.FALLBACK;\n  }\n}\n","export const enum Priority {\n  /**\n   * Used as fallback, when there is no other matches\n   */\n  FALLBACK = -50,\n  /**\n   * Used mainly in libraries, easy overridable\n   */\n  LOW = -10,\n  /**\n   * Default priority\n   */\n  NORMAL = 0,\n  /**\n   * High priority for matches that should take precedence\n   */\n  HIGH = 10,\n}\n\n/**\n * Base interface for implementing applicables in a consistent way\n *\n * Applicables are mainly used to find best matching one from multi provided\n * classes, like handlers, resolvers, etc.\n */\nexport interface Applicable {\n  /**\n   * Returns true if applicable can be used to handle specified condition\n   */\n  hasMatch?(...params): boolean;\n\n  /**\n   * Returns priority or score for specified applicable.\n   *\n   * If multiple applicables can be applied to specified condition, the one\n   * with highest priority or score wins.\n   */\n  getPriority?(...params): Priority | number;\n}\n\n/**\n * Helper logic to resolve best matching Applicable\n *\n * Finding best match is a two step process:\n * 1. Find all matching applicables\n *    - all applicables for which hasMatch(...matchParams) will return true\n *    - all applicables without hasMatch method (implicit always match)\n * 2. Find the applicable with highest priority\n *    - applicable with highest getPriority(...priorityParams) will win\n *    - applicable without getPriority method is treated as Priority.NORMAL or 0\n *    - applicables with the same priority are sorted by order of providers, the applicable that was provided later wins\n *\n * @param applicables - array or applicable-like instances\n * @param matchParams - array of parameters passed for hasMatch calls\n * @param priorityParams - array of parameters passed for getPriority calls\n */\nexport function resolveApplicable<T extends Applicable>(\n  applicables: T[],\n  matchParams: any[] = [],\n  priorityParams: any[] = []\n): T | undefined {\n  const matchedApplicables = (applicables ?? []).filter(\n    (applicable) => !applicable.hasMatch || applicable.hasMatch(...matchParams)\n  );\n\n  if (matchedApplicables.length < 2) {\n    return matchedApplicables[0];\n  }\n\n  let lastPriority = -Infinity;\n  return matchedApplicables.reduce((acc, curr) => {\n    const currPriority = curr.getPriority\n      ? curr.getPriority(...priorityParams)\n      : Priority.NORMAL;\n    if (lastPriority > currPriority) {\n      return acc;\n    }\n    lastPriority = currPriority;\n    return curr;\n  }, undefined);\n}\n","import {\n  HttpErrorResponse,\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Inject, Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { HttpErrorHandler } from './handlers/http-error.handler';\nimport { resolveApplicable } from '../../util/applicable';\n\n@Injectable({ providedIn: 'root' })\nexport class HttpErrorInterceptor implements HttpInterceptor {\n  constructor(\n    @Inject(HttpErrorHandler) protected handlers: HttpErrorHandler[]\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return next.handle(request).pipe(\n      catchError((response: any) => {\n        if (response instanceof HttpErrorResponse) {\n          this.handleErrorResponse(request, response);\n          return throwError(response);\n        }\n      })\n    );\n  }\n\n  protected handleErrorResponse(\n    request: HttpRequest<any>,\n    response: HttpErrorResponse\n  ): void {\n    const handler = this.getResponseHandler(response);\n    if (handler) {\n      handler.handleError(request, response);\n    }\n  }\n\n  /**\n   * return the error handler that matches the `HttpResponseStatus` code.\n   * If no handler is available, the UNKNOWN handler is returned.\n   */\n  protected getResponseHandler(response: HttpErrorResponse): HttpErrorHandler {\n    return resolveApplicable(this.handlers, [response]);\n  }\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Provider } from '@angular/core';\nimport {\n  BadGatewayHandler,\n  BadRequestHandler,\n  ConflictHandler,\n  ForbiddenHandler,\n  GatewayTimeoutHandler,\n  HttpErrorHandler,\n  InternalServerErrorHandler,\n  NotFoundHandler,\n  UnknownErrorHandler,\n} from './handlers/index';\nimport { HttpErrorInterceptor } from './http-error.interceptor';\n\nexport const errorHandlers: Provider[] = [\n  {\n    provide: HttpErrorHandler,\n    useExisting: UnknownErrorHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: BadGatewayHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: BadRequestHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: ConflictHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: ForbiddenHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: GatewayTimeoutHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: InternalServerErrorHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: NotFoundHandler,\n    multi: true,\n  },\n];\n\nexport const httpErrorInterceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: HttpErrorInterceptor,\n    multi: true,\n  },\n];\n","import { Translatable } from '../../../i18n/translatable';\nimport {\n  GlobalMessage,\n  GlobalMessageType,\n} from '../../models/global-message.model';\nimport { GlobalMessageActions } from '../actions/index';\nimport { GlobalMessageState } from '../global-message-state';\n\nexport const initialState: GlobalMessageState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: GlobalMessageActions.GlobalMessageAction\n): GlobalMessageState {\n  switch (action.type) {\n    case GlobalMessageActions.ADD_MESSAGE: {\n      const message: GlobalMessage = action.payload;\n\n      if (state.entities[message.type] === undefined) {\n        return {\n          ...state,\n          entities: {\n            ...state.entities,\n            [message.type]: [message.text],\n          },\n        };\n      } else {\n        const currentMessages: Translatable[] = state.entities[message.type];\n        return {\n          ...state,\n          entities: {\n            ...state.entities,\n            [message.type]: [...currentMessages, message.text],\n          },\n        };\n      }\n    }\n\n    case GlobalMessageActions.REMOVE_MESSAGE: {\n      const msgType: GlobalMessageType = action.payload.type;\n      const msgIndex: number = action.payload.index;\n      if (\n        Object.keys(state.entities).length === 0 ||\n        !state.entities[msgType]\n      ) {\n        return state;\n      }\n\n      const messages = [...state.entities[msgType]];\n      messages.splice(msgIndex, 1);\n\n      return {\n        ...state,\n        entities: {\n          ...state.entities,\n          [msgType]: messages,\n        },\n      };\n    }\n\n    case GlobalMessageActions.REMOVE_MESSAGES_BY_TYPE: {\n      const entities = {\n        ...state.entities,\n        [action.payload]: [],\n      };\n      return {\n        ...state,\n        entities,\n      };\n    }\n  }\n\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport * as fromGlobalMessage from './global-message.reducer';\nimport { GlobalMessageState } from '../global-message-state';\nimport { ActionReducer } from '@ngrx/store';\n\nexport function getReducers(): ActionReducer<GlobalMessageState> {\n  return fromGlobalMessage.reducer;\n}\n\nexport const reducerToken: InjectionToken<ActionReducer<\n  GlobalMessageState\n>> = new InjectionToken<ActionReducer<GlobalMessageState>>(\n  'GlobalMessageReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { NgModule } from '@angular/core';\nimport { StoreModule } from '@ngrx/store';\n\nimport { reducerToken, reducerProvider } from './reducers/index';\nimport { GLOBAL_MESSAGE_FEATURE } from './global-message-state';\nimport { StateModule } from '../../state/state.module';\n\n@NgModule({\n  imports: [\n    StateModule,\n    StoreModule.forFeature(GLOBAL_MESSAGE_FEATURE, reducerToken),\n  ],\n  providers: [reducerProvider],\n})\nexport class GlobalMessageStoreModule {}\n","export function shallowEqualObjects(objA: object, objB: object): boolean {\n  if (objA === objB) {\n    return true;\n  }\n  if (!objA || !objB) {\n    return false;\n  }\n  const aKeys = Object.keys(objA);\n  const bKeys = Object.keys(objB);\n  const aKeysLen = aKeys.length;\n  const bKeysLen = bKeys.length;\n\n  if (aKeysLen !== bKeysLen) {\n    return false;\n  }\n  for (let i = 0; i < aKeysLen; i++) {\n    const key = aKeys[i];\n    if (objA[key] !== objB[key]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function deepEqualObjects(objA: object, objB: object): boolean {\n  if (objA === objB) {\n    return true; // if both objA and objB are null or undefined and exactly the same\n  } else if (!(objA instanceof Object) || !(objB instanceof Object)) {\n    return false; // if they are not strictly equal, they both need to be Objects\n  } else if (objA.constructor !== objB.constructor) {\n    // they must have the exact same prototype chain, the closest we can do is\n    // test their constructor.\n    return false;\n  } else {\n    for (const key in objA) {\n      if (!objA.hasOwnProperty(key)) {\n        continue; // other properties were tested using objA.constructor === y.constructor\n      }\n      if (!objB.hasOwnProperty(key)) {\n        return false; // allows to compare objA[ key ] and objB[ key ] when set to undefined\n      }\n      if (objA[key] === objB[key]) {\n        continue; // if they have the same strict value or identity then they are equal\n      }\n      if (typeof objA[key] !== 'object') {\n        return false; // Numbers, Strings, Functions, Booleans must be strictly equal\n      }\n      if (!deepEqualObjects(objA[key], objB[key])) {\n        return false;\n      }\n    }\n    for (const key in objB) {\n      if (objB.hasOwnProperty(key) && !objA.hasOwnProperty(key)) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\nexport function countOfDeepEqualObjects(obj: any, arr: Array<any>): number {\n  return arr.reduce((acc, curr) => {\n    if (deepEqualObjects(obj, curr)) {\n      acc++;\n    }\n    return acc;\n  }, 0);\n}\n\nexport function indexOfFirstOccurrence(\n  obj: any,\n  arr: Array<any>\n): number | undefined {\n  for (let index = 0; index < arr.length; index++) {\n    if (deepEqualObjects(arr[index], obj)) {\n      return index;\n    }\n  }\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { select, Store } from '@ngrx/store';\nimport { EMPTY, Observable, of } from 'rxjs';\nimport {\n  concatMap,\n  delay,\n  filter,\n  map,\n  pluck,\n  switchMap,\n  take,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { Translatable } from '../../../i18n/translatable';\nimport {\n  countOfDeepEqualObjects,\n  indexOfFirstOccurrence,\n} from '../../../util/compare-equal-objects';\nimport { GlobalMessageConfig } from '../../config/global-message-config';\nimport { GlobalMessage } from '../../models/global-message.model';\nimport { GlobalMessageActions } from '../actions/index';\nimport { StateWithGlobalMessage } from '../global-message-state';\nimport { GlobalMessageSelectors } from '../selectors/index';\n\n@Injectable()\nexport class GlobalMessageEffect {\n  @Effect()\n  removeDuplicated$: Observable<\n    GlobalMessageActions.RemoveMessage\n  > = this.actions$.pipe(\n    ofType(GlobalMessageActions.ADD_MESSAGE),\n    pluck('payload'),\n    switchMap((message: GlobalMessage) =>\n      of(message.text).pipe(\n        withLatestFrom(\n          this.store.pipe(\n            select(\n              GlobalMessageSelectors.getGlobalMessageEntitiesByType(\n                message.type\n              )\n            )\n          )\n        ),\n        filter(\n          ([text, messages]: [Translatable, Translatable[]]) =>\n            countOfDeepEqualObjects(text, messages) > 1\n        ),\n        map(\n          ([text, messages]: [Translatable, Translatable[]]) =>\n            new GlobalMessageActions.RemoveMessage({\n              type: message.type,\n              index: indexOfFirstOccurrence(text, messages),\n            })\n        )\n      )\n    )\n  );\n\n  @Effect()\n  hideAfterDelay$: Observable<\n    GlobalMessageActions.RemoveMessage\n  > = isPlatformBrowser(this.platformId) // we don't want to run this logic when doing SSR\n    ? this.actions$.pipe(\n        ofType(GlobalMessageActions.ADD_MESSAGE),\n        pluck('payload'),\n        concatMap((message: GlobalMessage) => {\n          const config = this.config.globalMessages[message.type];\n          return this.store.pipe(\n            select(\n              GlobalMessageSelectors.getGlobalMessageCountByType(message.type)\n            ),\n            take(1),\n            filter(\n              (count: number) =>\n                ((config && config.timeout !== undefined) || message.timeout) &&\n                count &&\n                count > 0\n            ),\n            delay(message.timeout || config.timeout),\n            switchMap(() =>\n              of(\n                new GlobalMessageActions.RemoveMessage({\n                  type: message.type,\n                  index: 0,\n                })\n              )\n            )\n          );\n        })\n      )\n    : EMPTY;\n\n  constructor(\n    private actions$: Actions,\n    private store: Store<StateWithGlobalMessage>,\n    private config: GlobalMessageConfig,\n    @Inject(PLATFORM_ID) private platformId: any\n  ) {}\n}\n","import { GlobalMessageType } from '../models/global-message.model';\nimport { GlobalMessageConfig } from './global-message-config';\n\nexport function defaultGlobalMessageConfigFactory(): GlobalMessageConfig {\n  return {\n    globalMessages: {\n      [GlobalMessageType.MSG_TYPE_CONFIRMATION]: {\n        timeout: 3000,\n      },\n      [GlobalMessageType.MSG_TYPE_INFO]: {\n        timeout: 3000,\n      },\n      [GlobalMessageType.MSG_TYPE_ERROR]: {\n        timeout: 7000,\n      },\n      [GlobalMessageType.MSG_TYPE_WARNING]: {\n        timeout: 7000,\n      },\n    },\n  };\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport {\n  errorHandlers,\n  httpErrorInterceptors,\n} from './http-interceptors/index';\nimport { GlobalMessageStoreModule } from './store/global-message-store.module';\nimport { GlobalMessageEffect } from './store/effects/global-message.effect';\n\nimport { defaultGlobalMessageConfigFactory } from './config/default-global-message-config';\nimport { provideDefaultConfigFactory } from '../config/config-providers';\n\n@NgModule({\n  imports: [\n    GlobalMessageStoreModule,\n    EffectsModule.forFeature([GlobalMessageEffect]),\n  ],\n  providers: [provideDefaultConfigFactory(defaultGlobalMessageConfigFactory)],\n})\nexport class GlobalMessageModule {\n  static forRoot(): ModuleWithProviders<GlobalMessageModule> {\n    return {\n      ngModule: GlobalMessageModule,\n      providers: [...errorHandlers, ...httpErrorInterceptors],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport { combineLatest, from, Observable, of } from 'rxjs';\nimport { map, switchMap, take } from 'rxjs/operators';\nimport { StateWithClientAuth } from '../../auth/client-auth/store/client-auth-state';\nimport { AuthService } from '../../auth/user-auth/facade/auth.service';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { AuthToken } from '../../auth/user-auth/models/auth-token.model';\nimport { AuthRedirectService } from '../../auth/user-auth/services/auth-redirect.service';\nimport { OAuthLibWrapperService } from '../../auth/user-auth/services/oauth-lib-wrapper.service';\nimport { AuthActions } from '../../auth/user-auth/store/actions/index';\nimport {\n  GlobalMessageService,\n  GlobalMessageType,\n} from '../../global-message/index';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { AsmAuthStorageService, TokenTarget } from './asm-auth-storage.service';\n\n/**\n * Version of AuthService that is working for both user na CS agent.\n * Overrides AuthService when ASM module is enabled.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AsmAuthService extends AuthService {\n  constructor(\n    protected store: Store<StateWithClientAuth>,\n    protected userIdService: UserIdService,\n    protected oAuthLibWrapperService: OAuthLibWrapperService,\n    protected authStorageService: AsmAuthStorageService,\n    protected authRedirectService: AuthRedirectService,\n    protected globalMessageService: GlobalMessageService,\n    protected routingService: RoutingService\n  ) {\n    super(\n      store,\n      userIdService,\n      oAuthLibWrapperService,\n      authStorageService,\n      authRedirectService,\n      routingService\n    );\n  }\n\n  protected canUserLogin(): boolean {\n    let tokenTarget: TokenTarget;\n    let token: AuthToken;\n\n    this.authStorageService\n      .getToken()\n      .subscribe((tok) => (token = tok))\n      .unsubscribe();\n    this.authStorageService\n      .getTokenTarget()\n      .subscribe((tokTarget) => (tokenTarget = tokTarget))\n      .unsubscribe();\n    return !(\n      Boolean(token?.access_token) && tokenTarget === TokenTarget.CSAgent\n    );\n  }\n\n  protected warnAboutLoggedCSAgent(): void {\n    this.globalMessageService.add(\n      {\n        key: 'asm.auth.agentLoggedInError',\n      },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n\n  /**\n   * Loads a new user token with Resource Owner Password Flow when CS agent is not logged in.\n   * @param userId\n   * @param password\n   */\n  async loginWithCredentials(userId: string, password: string): Promise<void> {\n    if (this.canUserLogin()) {\n      await super.loginWithCredentials(userId, password);\n    } else {\n      this.warnAboutLoggedCSAgent();\n    }\n  }\n\n  /**\n   * Initialize Implicit/Authorization Code flow by redirecting to OAuth server when CS agent is not logged in.\n   */\n  loginWithRedirect(): boolean {\n    if (this.canUserLogin()) {\n      super.loginWithRedirect();\n      return true;\n    } else {\n      this.warnAboutLoggedCSAgent();\n      return false;\n    }\n  }\n\n  /**\n   * Revokes tokens and clears state for logged user (tokens, userId).\n   * To perform logout it is best to use `logout` method. Use this method with caution.\n   */\n  coreLogout(): Promise<any> {\n    return this.userIdService\n      .isEmulated()\n      .pipe(\n        take(1),\n        switchMap((isEmulated) => {\n          if (isEmulated) {\n            this.authStorageService.clearEmulatedUserToken();\n            this.userIdService.clearUserId();\n            this.store.dispatch(new AuthActions.Logout());\n            return of(true);\n          } else {\n            return from(super.coreLogout());\n          }\n        })\n      )\n      .toPromise();\n  }\n\n  /**\n   * Returns `true` if user is logged in or being emulated.\n   */\n  isUserLoggedIn(): Observable<boolean> {\n    return combineLatest([\n      this.authStorageService.getToken(),\n      this.userIdService.isEmulated(),\n      this.authStorageService.getTokenTarget(),\n    ]).pipe(\n      map(\n        ([token, isEmulated, tokenTarget]) =>\n          Boolean(token?.access_token) &&\n          (tokenTarget === TokenTarget.User ||\n            (tokenTarget === TokenTarget.CSAgent && isEmulated))\n      )\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport {\n  CustomerSearchOptions,\n  CustomerSearchPage,\n} from '../models/asm.models';\nimport { AsmAdapter } from './asm.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AsmConnector {\n  constructor(protected asmAdapter: AsmAdapter) {}\n\n  customerSearch(\n    options: CustomerSearchOptions\n  ): Observable<CustomerSearchPage> {\n    return this.asmAdapter.customerSearch(options);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { normalizeHttpError } from '../../../util/normalize-http-error';\nimport { AsmConnector } from '../../connectors/asm.connector';\nimport { CustomerSearchPage } from '../../models/asm.models';\nimport { AsmActions } from '../actions/index';\n\n@Injectable()\nexport class CustomerEffects {\n  @Effect()\n  customerSearch$: Observable<AsmActions.CustomerAction> = this.actions$.pipe(\n    ofType(AsmActions.CUSTOMER_SEARCH),\n    map((action: AsmActions.CustomerSearch) => action.payload),\n    switchMap((options) =>\n      this.asmConnector.customerSearch(options).pipe(\n        map((customerSearchResults: CustomerSearchPage) => {\n          return new AsmActions.CustomerSearchSuccess(customerSearchResults);\n        }),\n        catchError((error) =>\n          of(new AsmActions.CustomerSearchFail(normalizeHttpError(error)))\n        )\n      )\n    )\n  );\n\n  constructor(private actions$: Actions, private asmConnector: AsmConnector) {}\n}\n","import { CustomerEffects } from './customer.effect';\n\nexport const effects: any[] = [CustomerEffects];\n\nexport * from './customer.effect';\n","import { AsmUi } from '../../models/asm.models';\nimport { AsmActions } from '../actions/index';\n\nexport const initialState: AsmUi = <AsmUi>{ collapsed: false };\n\nexport function reducer(\n  state = initialState,\n  action: AsmActions.AsmUiAction\n): AsmUi {\n  switch (action.type) {\n    case AsmActions.ASM_UI_UPDATE: {\n      return {\n        ...state,\n        ...action.payload,\n      };\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  Action,\n  ActionReducer,\n  ActionReducerMap,\n  MetaReducer,\n} from '@ngrx/store';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport { CustomerSearchPage } from '../../models/asm.models';\nimport { AsmActions } from '../actions';\nimport { AsmState, CUSTOMER_SEARCH_DATA } from '../asm-state';\nimport * as fromAsmUiReducer from './asm-ui.reducer';\n\nexport function getReducers(): ActionReducerMap<AsmState> {\n  return {\n    customerSearchResult: loaderReducer<CustomerSearchPage>(\n      CUSTOMER_SEARCH_DATA\n    ),\n    asmUi: fromAsmUiReducer.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  AsmState\n>> = new InjectionToken<ActionReducerMap<AsmState>>('AsmReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearCustomerSupportAgentAsmState(\n  reducer: ActionReducer<AsmState, Action>\n): ActionReducer<AsmState, Action> {\n  return function (state, action) {\n    if (action.type === AsmActions.LOGOUT_CUSTOMER_SUPPORT_AGENT) {\n      state = {\n        ...state,\n        customerSearchResult: undefined,\n      };\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [\n  clearCustomerSupportAgentAsmState,\n];\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { AsmState, ASM_FEATURE, StateWithAsm } from '../asm-state';\n\nexport const getAsmState: MemoizedSelector<\n  StateWithAsm,\n  AsmState\n> = createFeatureSelector<AsmState>(ASM_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { AsmUi } from '../../models/asm.models';\nimport { AsmState, StateWithAsm } from '../asm-state';\nimport { getAsmState } from './feature.selector';\n\nexport const getAsmUi: MemoizedSelector<StateWithAsm, AsmUi> = createSelector(\n  getAsmState,\n  (state: AsmState) => state.asmUi\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateUtils } from '../../../state/utils/index';\nimport { CustomerSearchPage } from '../../models/asm.models';\nimport { AsmState, StateWithAsm } from '../asm-state';\nimport { getAsmState } from './feature.selector';\n\nexport const getCustomerSearchResultsLoaderState: MemoizedSelector<\n  StateWithAsm,\n  StateUtils.LoaderState<CustomerSearchPage>\n> = createSelector(\n  getAsmState,\n  (state: AsmState) => state.customerSearchResult\n);\n\nexport const getCustomerSearchResults: MemoizedSelector<\n  StateWithAsm,\n  CustomerSearchPage\n> = createSelector(getCustomerSearchResultsLoaderState, (state) =>\n  StateUtils.loaderValueSelector(state)\n);\n\nexport const getCustomerSearchResultsLoading: MemoizedSelector<\n  StateWithAsm,\n  boolean\n> = createSelector(getCustomerSearchResultsLoaderState, (state) =>\n  StateUtils.loaderLoadingSelector(state)\n);\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, Observable, of, Subscription } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { AuthToken } from '../../auth/user-auth/models/auth-token.model';\nimport { StatePersistenceService } from '../../state/services/state-persistence.service';\nimport { AsmUi } from '../models/asm.models';\nimport { AsmActions, AsmSelectors, StateWithAsm } from '../store';\nimport { AsmAuthStorageService, TokenTarget } from './asm-auth-storage.service';\n\n/**\n * ASM state synced to browser storage.\n */\nexport interface SyncedAsmState {\n  ui?: AsmUi;\n  emulatedUserToken?: AuthToken;\n  tokenTarget?: TokenTarget;\n}\n\n/**\n * Responsible for storing ASM state in the browser storage.\n * Uses `StatePersistenceService` mechanism.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class AsmStatePersistenceService implements OnDestroy {\n  protected subscription = new Subscription();\n\n  constructor(\n    protected statePersistenceService: StatePersistenceService,\n    protected store: Store<StateWithAsm>,\n    protected authStorageService: AsmAuthStorageService\n  ) {}\n\n  /**\n   * Identifier used for storage key.\n   */\n  protected key = 'asm';\n\n  /**\n   * Initializes the synchronization between state and browser storage.\n   */\n  public initSync() {\n    this.subscription.add(\n      this.statePersistenceService.syncWithStorage({\n        key: this.key,\n        state$: this.getAsmState(),\n        onRead: (state) => this.onRead(state),\n      })\n    );\n  }\n\n  /**\n   * Gets and transforms state from different sources into the form that should\n   * be saved in storage.\n   */\n  protected getAsmState(): Observable<SyncedAsmState> {\n    return combineLatest([\n      this.store.pipe(select(AsmSelectors.getAsmUi)),\n      of(this.authStorageService.getEmulatedUserToken()),\n      this.authStorageService.getTokenTarget(),\n    ]).pipe(\n      map(([ui, emulatedUserToken, tokenTarget]) => {\n        let emulatedToken = emulatedUserToken;\n        if (emulatedToken) {\n          emulatedToken = { ...emulatedUserToken };\n          // To minimize risk of user account hijacking we don't persist emulated user refresh_token\n          delete emulatedToken.refresh_token;\n        }\n        return {\n          ui,\n          emulatedUserToken: emulatedToken,\n          tokenTarget,\n        };\n      })\n    );\n  }\n\n  /**\n   * Function called on each browser storage read.\n   * Used to update state from browser -> state.\n   */\n  protected onRead(state: SyncedAsmState) {\n    if (state) {\n      if (state.ui) {\n        this.store.dispatch(new AsmActions.AsmUiUpdate(state.ui));\n      }\n      if (state.emulatedUserToken) {\n        this.authStorageService.setEmulatedUserToken(state.emulatedUserToken);\n      }\n      if (state.tokenTarget) {\n        this.authStorageService.setTokenTarget(state.tokenTarget);\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { StateModule } from '../../state/state.module';\nimport { ASM_FEATURE } from './asm-state';\nimport { effects } from './effects/index';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    StateModule,\n    StoreModule.forFeature(ASM_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [reducerProvider],\n})\nexport class AsmStoreModule {}\n","import { CommonModule } from '@angular/common';\nimport { APP_INITIALIZER, ModuleWithProviders, NgModule } from '@angular/core';\nimport { AuthService } from '../auth/user-auth/facade/auth.service';\nimport { AuthHttpHeaderService } from '../auth/user-auth/services/auth-http-header.service';\nimport { AuthStorageService } from '../auth/user-auth/services/auth-storage.service';\nimport { provideDefaultConfig } from '../config/config-providers';\nimport { defaultAsmConfig } from './config/default-asm-config';\nimport { AsmAuthHttpHeaderService } from './services/asm-auth-http-header.service';\nimport { AsmAuthStorageService } from './services/asm-auth-storage.service';\nimport { AsmAuthService } from './services/asm-auth.service';\nimport { AsmStatePersistenceService } from './services/asm-state-persistence.service';\nimport { AsmStoreModule } from './store/asm-store.module';\n\nexport function asmStatePersistenceFactory(\n  asmStatePersistenceService: AsmStatePersistenceService\n) {\n  const result = () => asmStatePersistenceService.initSync();\n  return result;\n}\n\n@NgModule({\n  imports: [CommonModule, AsmStoreModule],\n})\nexport class AsmModule {\n  static forRoot(): ModuleWithProviders<AsmModule> {\n    return {\n      ngModule: AsmModule,\n      providers: [\n        provideDefaultConfig(defaultAsmConfig),\n        {\n          provide: AuthStorageService,\n          useExisting: AsmAuthStorageService,\n        },\n        {\n          provide: AuthService,\n          useExisting: AsmAuthService,\n        },\n        {\n          provide: AuthHttpHeaderService,\n          useExisting: AsmAuthHttpHeaderService,\n        },\n        {\n          provide: APP_INITIALIZER,\n          useFactory: asmStatePersistenceFactory,\n          deps: [AsmStatePersistenceService],\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport {\n  AsmUi,\n  CustomerSearchOptions,\n  CustomerSearchPage,\n} from '../models/asm.models';\nimport { AsmActions } from '../store/actions/index';\nimport { StateWithAsm } from '../store/asm-state';\nimport { AsmSelectors } from '../store/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AsmService {\n  constructor(protected store: Store<StateWithAsm>) {}\n\n  /**\n   * Search for customers\n   * @param options\n   */\n  customerSearch(options: CustomerSearchOptions): void {\n    this.store.dispatch(new AsmActions.CustomerSearch(options));\n  }\n\n  /**\n   * Reset the customer search result data to the initial state.\n   */\n  customerSearchReset(): void {\n    this.store.dispatch(new AsmActions.CustomerSearchReset());\n  }\n\n  /**\n   * Returns the customer search result data.\n   */\n  getCustomerSearchResults(): Observable<CustomerSearchPage> {\n    return this.store.pipe(select(AsmSelectors.getCustomerSearchResults));\n  }\n\n  /**\n   * Returns the customer search result loading status.\n   */\n  getCustomerSearchResultsLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(AsmSelectors.getCustomerSearchResultsLoading)\n    );\n  }\n\n  /**\n   * Updates the state of the ASM UI\n   */\n  updateAsmUiState(asmUi: AsmUi): void {\n    this.store.dispatch(new AsmActions.AsmUiUpdate(asmUi));\n  }\n\n  /**\n   * Get the state of the ASM UI\n   */\n  getAsmUiState(): Observable<AsmUi> {\n    return this.store.pipe(select(AsmSelectors.getAsmUi));\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { CartEntryAdapter } from './cart-entry.adapter';\nimport { CartModification } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartEntryConnector {\n  constructor(protected adapter: CartEntryAdapter) {}\n\n  public add(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity?: number\n  ): Observable<CartModification> {\n    return this.adapter.add(userId, cartId, productCode, quantity);\n  }\n\n  public update(\n    userId: string,\n    cartId: string,\n    entryNumber: string,\n    qty: number,\n    pickupStore?: string\n  ): Observable<CartModification> {\n    return this.adapter.update(userId, cartId, entryNumber, qty, pickupStore);\n  }\n\n  public remove(\n    userId: string,\n    cartId: string,\n    entryNumber: string\n  ): Observable<any> {\n    return this.adapter.remove(userId, cartId, entryNumber);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { from, Observable } from 'rxjs';\nimport { catchError, concatMap, map } from 'rxjs/operators';\nimport { CartModification } from '../../../model/cart.model';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { withdrawOn } from '../../../util/rxjs/withdraw-on';\nimport { CartEntryConnector } from '../../connectors/entry/cart-entry.connector';\nimport { CartActions } from '../actions/index';\n\n@Injectable()\nexport class CartEntryEffects {\n  private contextChange$ = this.actions$.pipe(\n    ofType(\n      SiteContextActions.CURRENCY_CHANGE,\n      SiteContextActions.LANGUAGE_CHANGE\n    )\n  );\n\n  @Effect()\n  addEntry$: Observable<\n    | CartActions.CartAddEntrySuccess\n    | CartActions.CartAddEntryFail\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_ADD_ENTRY),\n    map((action: CartActions.CartAddEntry) => action.payload),\n    concatMap((payload) => {\n      return this.cartEntryConnector\n        .add(\n          payload.userId,\n          payload.cartId,\n          payload.productCode,\n          payload.quantity\n        )\n        .pipe(\n          map(\n            (cartModification: CartModification) =>\n              new CartActions.CartAddEntrySuccess({\n                ...payload,\n                ...(cartModification as Required<CartModification>),\n              })\n          ),\n          catchError((error) =>\n            from([\n              new CartActions.CartAddEntryFail({\n                ...payload,\n                error: makeErrorSerializable(error),\n              }),\n              new CartActions.LoadCart({\n                cartId: payload.cartId,\n                userId: payload.userId,\n              }),\n            ])\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  removeEntry$: Observable<\n    | CartActions.CartRemoveEntrySuccess\n    | CartActions.CartRemoveEntryFail\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_REMOVE_ENTRY),\n    map((action: CartActions.CartRemoveEntry) => action.payload),\n    concatMap((payload) =>\n      this.cartEntryConnector\n        .remove(payload.userId, payload.cartId, payload.entryNumber)\n        .pipe(\n          map(() => {\n            return new CartActions.CartRemoveEntrySuccess({\n              ...payload,\n            });\n          }),\n          catchError((error) =>\n            from([\n              new CartActions.CartRemoveEntryFail({\n                ...payload,\n                error: makeErrorSerializable(error),\n              }),\n              new CartActions.LoadCart({\n                cartId: payload.cartId,\n                userId: payload.userId,\n              }),\n            ])\n          )\n        )\n    ),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  updateEntry$: Observable<\n    | CartActions.CartUpdateEntrySuccess\n    | CartActions.CartUpdateEntryFail\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_UPDATE_ENTRY),\n    map((action: CartActions.CartUpdateEntry) => action.payload),\n    concatMap((payload) =>\n      this.cartEntryConnector\n        .update(\n          payload.userId,\n          payload.cartId,\n          payload.entryNumber,\n          payload.quantity\n        )\n        .pipe(\n          map(() => {\n            return new CartActions.CartUpdateEntrySuccess({\n              ...payload,\n            });\n          }),\n          catchError((error) =>\n            from([\n              new CartActions.CartUpdateEntryFail({\n                ...payload,\n                error: makeErrorSerializable(error),\n              }),\n              new CartActions.LoadCart({\n                cartId: payload.cartId,\n                userId: payload.userId,\n              }),\n            ])\n          )\n        )\n    ),\n    withdrawOn(this.contextChange$)\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cartEntryConnector: CartEntryConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CartVoucherAdapter } from './cart-voucher.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartVoucherConnector {\n  constructor(protected adapter: CartVoucherAdapter) {}\n\n  public add(\n    userId: string,\n    cartId: string,\n    voucherId: string\n  ): Observable<{}> {\n    return this.adapter.add(userId, cartId, voucherId);\n  }\n\n  public remove(\n    userId: string,\n    cartId: string,\n    voucherId: string\n  ): Observable<{}> {\n    return this.adapter.remove(userId, cartId, voucherId);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { from, Observable } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { GlobalMessageService } from '../../../global-message/facade/global-message.service';\nimport { GlobalMessageType } from '../../../global-message/models/global-message.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CartVoucherConnector } from '../../connectors/voucher/cart-voucher.connector';\nimport { CartActions } from '../actions/index';\n\n@Injectable()\nexport class CartVoucherEffects {\n  constructor(\n    private actions$: Actions,\n    private cartVoucherConnector: CartVoucherConnector,\n    private messageService: GlobalMessageService\n  ) {}\n\n  @Effect()\n  addCartVoucher$: Observable<\n    | CartActions.CartVoucherAction\n    | CartActions.LoadCart\n    | CartActions.CartProcessesDecrement\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_ADD_VOUCHER),\n    map((action: CartActions.CartAddVoucher) => action.payload),\n    mergeMap((payload) => {\n      return this.cartVoucherConnector\n        .add(payload.userId, payload.cartId, payload.voucherId)\n        .pipe(\n          map(() => {\n            this.showGlobalMessage(\n              'voucher.applyVoucherSuccess',\n              payload.voucherId,\n              GlobalMessageType.MSG_TYPE_CONFIRMATION\n            );\n            return new CartActions.CartAddVoucherSuccess({\n              ...payload,\n            });\n          }),\n          catchError((error) =>\n            from([\n              new CartActions.CartAddVoucherFail({\n                ...payload,\n                error: makeErrorSerializable(error),\n              }),\n              new CartActions.CartProcessesDecrement(payload.cartId),\n              new CartActions.LoadCart({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ])\n          )\n        );\n    })\n  );\n\n  @Effect()\n  removeCartVoucher$: Observable<\n    CartActions.CartVoucherAction | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_REMOVE_VOUCHER),\n    map((action: CartActions.CartRemoveVoucher) => action.payload),\n    mergeMap((payload) => {\n      return this.cartVoucherConnector\n        .remove(payload.userId, payload.cartId, payload.voucherId)\n        .pipe(\n          map(() => {\n            this.showGlobalMessage(\n              'voucher.removeVoucherSuccess',\n              payload.voucherId,\n              GlobalMessageType.MSG_TYPE_INFO\n            );\n            return new CartActions.CartRemoveVoucherSuccess({\n              userId: payload.userId,\n              cartId: payload.cartId,\n              voucherId: payload.voucherId,\n            });\n          }),\n          catchError((error) =>\n            from([\n              new CartActions.CartRemoveVoucherFail({\n                error: makeErrorSerializable(error),\n                cartId: payload.cartId,\n                userId: payload.userId,\n                voucherId: payload.voucherId,\n              }),\n              new CartActions.LoadCart({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ])\n          )\n        );\n    })\n  );\n\n  private showGlobalMessage(\n    text: string,\n    param: string,\n    messageType: GlobalMessageType\n  ) {\n    this.messageService.add(\n      { key: text, params: { voucherCode: param } },\n      messageType\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Cart } from '../../../model/cart.model';\nimport { CartAdapter } from './cart.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartConnector {\n  constructor(protected adapter: CartAdapter) {}\n\n  public loadAll(userId: string): Observable<Cart[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  public load(userId: string, cartId: string): Observable<Cart> {\n    return this.adapter.load(userId, cartId);\n  }\n\n  public create(\n    userId: string,\n    oldCartId?: string,\n    toMergeCartGuid?: string\n  ): Observable<Cart> {\n    return this.adapter.create(userId, oldCartId, toMergeCartGuid);\n  }\n\n  public delete(userId: string, cartId: string): Observable<{}> {\n    return this.adapter.delete(userId, cartId);\n  }\n\n  public addEmail(\n    userId: string,\n    cartId: string,\n    email: string\n  ): Observable<{}> {\n    return this.adapter.addEmail(userId, cartId, email);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { select, Store } from '@ngrx/store';\nimport { from, Observable, of } from 'rxjs';\nimport {\n  catchError,\n  concatMap,\n  filter,\n  groupBy,\n  map,\n  mergeMap,\n  switchMap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { CheckoutActions } from '../../../checkout/store/actions';\nimport { Cart } from '../../../model/cart.model';\nimport { OCC_CART_ID_CURRENT } from '../../../occ/utils/occ-constants';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { withdrawOn } from '../../../util/rxjs/withdraw-on';\nimport { CartConnector } from '../../connectors/cart/cart.connector';\nimport { getCartIdByUserId, isCartNotFoundError } from '../../utils/utils';\nimport { CartActions } from '../actions/index';\nimport { StateWithMultiCart } from '../multi-cart-state';\nimport { getCartHasPendingProcessesSelectorFactory } from '../selectors/multi-cart.selector';\n\n@Injectable()\nexport class CartEffects {\n  private contextChange$ = this.actions$.pipe(\n    ofType(\n      SiteContextActions.CURRENCY_CHANGE,\n      SiteContextActions.LANGUAGE_CHANGE\n    )\n  );\n\n  @Effect()\n  loadCart$: Observable<\n    | CartActions.LoadCartFail\n    | CartActions.LoadCartSuccess\n    | CartActions.RemoveCart\n  > = this.actions$.pipe(\n    ofType(CartActions.LOAD_CART),\n    map((action: CartActions.LoadCart) => action.payload),\n    groupBy((payload) => payload.cartId),\n    mergeMap((group$) =>\n      group$.pipe(\n        switchMap((payload) => {\n          return of(payload).pipe(\n            withLatestFrom(\n              this.store.pipe(\n                select(\n                  getCartHasPendingProcessesSelectorFactory(payload.cartId)\n                )\n              )\n            )\n          );\n        }),\n        filter(([_, hasPendingProcesses]) => !hasPendingProcesses),\n        map(([payload]) => payload),\n        switchMap((payload) => {\n          return this.cartConnector.load(payload.userId, payload.cartId).pipe(\n            mergeMap((cart: Cart) => {\n              let actions = [];\n              if (cart) {\n                actions.push(\n                  new CartActions.LoadCartSuccess({\n                    ...payload,\n                    cart,\n                    cartId: getCartIdByUserId(cart, payload.userId),\n                  })\n                );\n\n                if (payload.cartId === OCC_CART_ID_CURRENT) {\n                  // Removing cart from entity object under `current` key as it is no longer needed.\n                  // Current cart is loaded under it's code entity.\n                  actions.push(\n                    new CartActions.RemoveCart({ cartId: OCC_CART_ID_CURRENT })\n                  );\n                }\n              } else {\n                actions = [\n                  new CartActions.LoadCartFail({\n                    ...payload,\n                    error: {},\n                  }),\n                ];\n              }\n              return actions;\n            }),\n            catchError((error) => {\n              if (error?.error?.errors) {\n                const couponExpiredErrors = error.error.errors.filter(\n                  (err) => err.reason === 'invalid'\n                );\n                if (couponExpiredErrors.length > 0) {\n                  // Reload in case of expired coupon.\n                  return of(new CartActions.LoadCart({ ...payload }));\n                }\n\n                const cartNotFoundErrors = error.error.errors.filter(\n                  (err) =>\n                    isCartNotFoundError(err) ||\n                    err.reason === 'UnknownResourceError'\n                );\n                if (cartNotFoundErrors.length > 0) {\n                  // Remove cart as it doesn't exist on backend (selective cart always exists).\n                  return of(\n                    new CartActions.RemoveCart({ cartId: payload.cartId })\n                  );\n                }\n              }\n              return of(\n                new CartActions.LoadCartFail({\n                  ...payload,\n                  error: makeErrorSerializable(error),\n                })\n              );\n            })\n          );\n        })\n      )\n    ),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  createCart$: Observable<\n    | CartActions.MergeCartSuccess\n    | CartActions.CreateCartSuccess\n    | CartActions.CreateCartFail\n    | CartActions.SetTempCart\n  > = this.actions$.pipe(\n    ofType(CartActions.CREATE_CART),\n    map((action: CartActions.CreateCart) => action.payload),\n    mergeMap((payload) => {\n      return this.cartConnector\n        .create(payload.userId, payload.oldCartId, payload.toMergeCartGuid)\n        .pipe(\n          switchMap((cart: Cart) => {\n            const conditionalActions = [];\n            if (payload.oldCartId) {\n              conditionalActions.push(\n                new CartActions.MergeCartSuccess({\n                  extraData: payload.extraData,\n                  userId: payload.userId,\n                  tempCartId: payload.tempCartId,\n                  cartId: getCartIdByUserId(cart, payload.userId),\n                  oldCartId: payload.oldCartId,\n                })\n              );\n            }\n            return [\n              new CartActions.CreateCartSuccess({\n                ...payload,\n                cart,\n                cartId: getCartIdByUserId(cart, payload.userId),\n              }),\n              new CartActions.SetTempCart({\n                cart,\n                tempCartId: payload.tempCartId,\n              }),\n              ...conditionalActions,\n            ];\n          }),\n          catchError((error) =>\n            of(\n              new CartActions.CreateCartFail({\n                ...payload,\n                error: makeErrorSerializable(error),\n              })\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  mergeCart$: Observable<CartActions.CreateCart> = this.actions$.pipe(\n    ofType(CartActions.MERGE_CART),\n    map((action: CartActions.MergeCart) => action.payload),\n    mergeMap((payload) => {\n      return this.cartConnector.load(payload.userId, OCC_CART_ID_CURRENT).pipe(\n        mergeMap((currentCart) => {\n          return [\n            new CartActions.CreateCart({\n              userId: payload.userId,\n              oldCartId: payload.cartId,\n              toMergeCartGuid: currentCart ? currentCart.guid : undefined,\n              extraData: payload.extraData,\n              tempCartId: payload.tempCartId,\n            }),\n          ];\n        })\n      );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  // TODO(#7241): Remove when AddVoucherSuccess actions will extend processes actions\n  @Effect()\n  refresh$: Observable<\n    CartActions.LoadCart | CartActions.CartProcessesDecrement\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_ADD_VOUCHER_SUCCESS),\n    map((action: CartActions.CartAddVoucherSuccess) => action.payload),\n    concatMap((payload) =>\n      from([\n        new CartActions.CartProcessesDecrement(payload.cartId),\n        new CartActions.LoadCart({\n          userId: payload.userId,\n          cartId: payload.cartId,\n        }),\n      ])\n    )\n  );\n\n  // TODO: Switch to automatic cart reload on processes count reaching 0 for cart entity\n  @Effect()\n  refreshWithoutProcesses$: Observable<\n    CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(\n      CartActions.CART_ADD_ENTRY_SUCCESS,\n      CartActions.CART_REMOVE_ENTRY_SUCCESS,\n      CartActions.CART_UPDATE_ENTRY_SUCCESS,\n      CartActions.CART_REMOVE_VOUCHER_SUCCESS,\n      CheckoutActions.CLEAR_CHECKOUT_DELIVERY_MODE_SUCCESS\n    ),\n    map(\n      (\n        action:\n          | CartActions.CartAddEntrySuccess\n          | CartActions.CartUpdateEntrySuccess\n          | CartActions.CartRemoveEntrySuccess\n          | CartActions.CartRemoveVoucherSuccess\n          | CheckoutActions.ClearCheckoutDeliveryModeSuccess\n      ) => action.payload\n    ),\n    map(\n      (payload) =>\n        new CartActions.LoadCart({\n          userId: payload.userId,\n          cartId: payload.cartId,\n        })\n    )\n  );\n\n  @Effect()\n  resetCartDetailsOnSiteContextChange$: Observable<\n    CartActions.ResetCartDetails\n  > = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      SiteContextActions.CURRENCY_CHANGE\n    ),\n    mergeMap(() => {\n      return [new CartActions.ResetCartDetails()];\n    })\n  );\n\n  @Effect()\n  addEmail$: Observable<\n    | CartActions.AddEmailToCartSuccess\n    | CartActions.AddEmailToCartFail\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CartActions.ADD_EMAIL_TO_CART),\n    map((action: CartActions.AddEmailToCart) => action.payload),\n    mergeMap((payload) =>\n      this.cartConnector\n        .addEmail(payload.userId, payload.cartId, payload.email)\n        .pipe(\n          mergeMap(() => {\n            return [\n              new CartActions.AddEmailToCartSuccess({\n                ...payload,\n              }),\n              new CartActions.LoadCart({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ];\n          }),\n          catchError((error) =>\n            from([\n              new CartActions.AddEmailToCartFail({\n                ...payload,\n                error: makeErrorSerializable(error),\n              }),\n              new CartActions.LoadCart({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ])\n          )\n        )\n    ),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  deleteCart$: Observable<\n    | CartActions.DeleteCartSuccess\n    | CartActions.DeleteCartFail\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CartActions.DELETE_CART),\n    map((action: CartActions.DeleteCart) => action.payload),\n    mergeMap((payload) =>\n      this.cartConnector.delete(payload.userId, payload.cartId).pipe(\n        map(() => {\n          return new CartActions.DeleteCartSuccess({ ...payload });\n        }),\n        catchError((error) =>\n          from([\n            new CartActions.DeleteCartFail({\n              ...payload,\n              error: makeErrorSerializable(error),\n            }),\n            // Error might happen in higher backend layer and cart could still be removed.\n            // When load fail with NotFound error then RemoveCart action will kick in and clear that cart in our state.\n            new CartActions.LoadCart({\n              ...payload,\n            }),\n          ])\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cartConnector: CartConnector,\n    private store: Store<StateWithMultiCart>\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { SaveCartResult } from '../../../model/cart.model';\nimport { SaveCartAdapter } from './save-cart.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SaveCartConnector {\n  constructor(protected adapter: SaveCartAdapter) {}\n\n  public saveCart(\n    userId: string,\n    cartId: string,\n    saveCartName?: string,\n    saveCartDescription?: string\n  ): Observable<SaveCartResult> {\n    return this.adapter.saveCart(\n      userId,\n      cartId,\n      saveCartName,\n      saveCartDescription\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { select, Store } from '@ngrx/store';\nimport { EMPTY, from, Observable } from 'rxjs';\nimport {\n  catchError,\n  concatMap,\n  map,\n  switchMap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { UserIdService } from '../../../auth/user-auth/facade/user-id.service';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CartConnector } from '../../connectors/cart/cart.connector';\nimport { SaveCartConnector } from '../../connectors/save-cart/save-cart.connecter';\nimport { getCartIdByUserId, getWishlistName } from '../../utils/utils';\nimport { CartActions } from '../actions';\nimport { StateWithMultiCart } from '../multi-cart-state';\nimport { MultiCartSelectors } from '../selectors';\n\n@Injectable()\nexport class WishListEffects {\n  @Effect()\n  createWishList$: Observable<\n    CartActions.CreateWishListSuccess | CartActions.CreateWishListFail\n  > = this.actions$.pipe(\n    ofType(CartActions.CREATE_WISH_LIST),\n    map((action: CartActions.CreateWishList) => action.payload),\n    switchMap((payload) => {\n      return this.cartConnector.create(payload.userId).pipe(\n        switchMap((cart) => {\n          return this.saveCartConnector\n            .saveCart(\n              payload.userId,\n              cart.code,\n              payload.name,\n              payload.description\n            )\n            .pipe(\n              switchMap((saveCartResult) => [\n                new CartActions.CreateWishListSuccess({\n                  cart: saveCartResult.savedCartData,\n                  userId: payload.userId,\n                }),\n              ]),\n              catchError((error) =>\n                from([\n                  new CartActions.CreateWishListFail({\n                    cartId: cart.code,\n                    error: makeErrorSerializable(error),\n                  }),\n                ])\n              )\n            );\n        })\n      );\n    })\n  );\n\n  @Effect()\n  loadWishList$: Observable<\n    | CartActions.LoadWishListSuccess\n    | CartActions.RemoveCart\n    | CartActions.CreateWishList\n    | CartActions.LoadWishListFail\n  > = this.actions$.pipe(\n    ofType(CartActions.LOAD_WISH_LIST),\n    map((action: CartActions.LoadWishList) => action.payload),\n    concatMap((payload) => {\n      const { userId, customerId, tempCartId } = payload;\n      return this.cartConnector.loadAll(userId).pipe(\n        switchMap((carts) => {\n          if (carts) {\n            const wishList = carts.find(\n              (cart) => cart.name === getWishlistName(customerId)\n            );\n            if (Boolean(wishList)) {\n              return [\n                new CartActions.LoadWishListSuccess({\n                  cart: wishList,\n                  userId,\n                  tempCartId,\n                  customerId,\n                  cartId: getCartIdByUserId(wishList, userId),\n                }),\n                new CartActions.RemoveCart({ cartId: tempCartId }),\n              ];\n            } else {\n              return [\n                new CartActions.CreateWishList({\n                  userId,\n                  name: getWishlistName(customerId),\n                }),\n              ];\n            }\n          }\n        }),\n        catchError((error) =>\n          from([\n            new CartActions.LoadWishListFail({\n              userId,\n              cartId: tempCartId,\n              customerId,\n              error: makeErrorSerializable(error),\n            }),\n          ])\n        )\n      );\n    })\n  );\n\n  @Effect()\n  resetWishList$: Observable<\n    CartActions.LoadWishListSuccess | CartActions.LoadWishListFail\n  > = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      SiteContextActions.CURRENCY_CHANGE\n    ),\n    withLatestFrom(\n      this.userIdService.getUserId(),\n      this.store.pipe(select(MultiCartSelectors.getWishListId))\n    ),\n    switchMap(([, userId, wishListId]) => {\n      if (Boolean(wishListId)) {\n        return this.cartConnector.load(userId, wishListId).pipe(\n          switchMap((wishList) => [\n            new CartActions.LoadWishListSuccess({\n              cart: wishList,\n              userId,\n              cartId: getCartIdByUserId(wishList, userId),\n            }),\n          ]),\n          catchError((error) =>\n            from([\n              new CartActions.LoadWishListFail({\n                userId,\n                cartId: wishListId,\n                error: makeErrorSerializable(error),\n              }),\n            ])\n          )\n        );\n      }\n      return EMPTY;\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cartConnector: CartConnector,\n    private saveCartConnector: SaveCartConnector,\n    private userIdService: UserIdService,\n    private store: Store<StateWithMultiCart>\n  ) {}\n}\n","import { Cart } from '../../../model/cart.model';\nimport { LoaderAction } from '../../../state/utils/loader/loader.action';\nimport { CartActions } from '../actions/index';\n\nexport const activeCartInitialState = '';\nexport const wishListInitialState = '';\n\nexport function activeCartReducer(\n  state = activeCartInitialState,\n  action: CartActions.CartAction | CartActions.MultiCartActions\n): string {\n  switch (action.type) {\n    case CartActions.LOAD_CART_SUCCESS:\n    case CartActions.CREATE_CART_SUCCESS:\n    // point to `temp-${uuid}` cart when we are creating/merging cart\n    case CartActions.CREATE_CART:\n      if (action?.payload?.extraData?.active) {\n        return action.meta.entityId as string;\n      } else {\n        return state;\n      }\n    case CartActions.SET_ACTIVE_CART_ID:\n      return action.payload;\n    case CartActions.REMOVE_CART:\n    case CartActions.DELETE_CART_SUCCESS:\n      if (action.payload?.cartId === state) {\n        return activeCartInitialState;\n      }\n      return state;\n    case CartActions.CLEAR_CART_STATE:\n      return activeCartInitialState;\n  }\n  return state;\n}\n\nexport const cartEntitiesInitialState = undefined;\n\nexport function cartEntitiesReducer(\n  state = cartEntitiesInitialState,\n  action: LoaderAction\n): Cart {\n  switch (action.type) {\n    case CartActions.LOAD_CART_SUCCESS:\n    case CartActions.CREATE_CART_SUCCESS:\n    case CartActions.CREATE_WISH_LIST_SUCCESS:\n    case CartActions.LOAD_WISH_LIST_SUCCESS:\n    case CartActions.SET_TEMP_CART:\n      return action.payload.cart;\n  }\n  return state;\n}\n\nexport function wishListReducer(\n  state = wishListInitialState,\n  action: CartActions.WishListActions | CartActions.ClearCartState\n): string {\n  switch (action.type) {\n    case CartActions.CREATE_WISH_LIST_SUCCESS:\n    case CartActions.LOAD_WISH_LIST_SUCCESS:\n      return action.meta.entityId as string;\n    case CartActions.CLEAR_CART_STATE:\n      return wishListInitialState;\n  }\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducer, ActionReducerMap, MetaReducer } from '@ngrx/store';\nimport { AuthActions } from '../../../auth/user-auth/store/actions/index';\nimport { Cart } from '../../../model/cart.model';\nimport { entityProcessesLoaderReducer } from '../../../state/utils/entity-processes-loader/entity-processes-loader.reducer';\nimport { MultiCartState, MULTI_CART_DATA } from '../multi-cart-state';\nimport {\n  activeCartReducer,\n  cartEntitiesReducer,\n  wishListReducer,\n} from './multi-cart.reducer';\n\nexport function clearMultiCartState(\n  reducer: ActionReducer<any>\n): ActionReducer<any> {\n  return function (state, action) {\n    if (action.type === AuthActions.LOGOUT) {\n      state = undefined;\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const multiCartMetaReducers: MetaReducer<any>[] = [clearMultiCartState];\n\nexport const multiCartReducerToken: InjectionToken<ActionReducerMap<\n  MultiCartState\n>> = new InjectionToken<ActionReducerMap<MultiCartState>>('MultiCartReducers');\n\nexport function getMultiCartReducers(): ActionReducerMap<MultiCartState> {\n  return {\n    carts: entityProcessesLoaderReducer<Cart>(\n      MULTI_CART_DATA,\n      cartEntitiesReducer\n    ),\n    active: activeCartReducer,\n    wishList: wishListReducer,\n  };\n}\n\nexport const multiCartReducerProvider: Provider = {\n  provide: multiCartReducerToken,\n  useFactory: getMultiCartReducers,\n};\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable, Subscription } from 'rxjs';\nimport { distinctUntilKeyChanged, filter, map } from 'rxjs/operators';\nimport { BASE_SITE_CONTEXT_ID } from '../../site-context';\nimport { SiteContextParamsService } from '../../site-context/services/site-context-params.service';\nimport { StatePersistenceService } from '../../state/services/state-persistence.service';\nimport { CartActions, MultiCartSelectors } from '../store';\nimport { StateWithMultiCart } from '../store/multi-cart-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class MultiCartStatePersistenceService implements OnDestroy {\n  protected subscription = new Subscription();\n\n  constructor(\n    protected statePersistenceService: StatePersistenceService,\n    protected store: Store<StateWithMultiCart>,\n    protected siteContextParamsService: SiteContextParamsService\n  ) {}\n\n  public initSync() {\n    this.subscription.add(\n      this.statePersistenceService.syncWithStorage({\n        key: 'cart',\n        state$: this.getCartState(),\n        context$: this.siteContextParamsService.getValues([\n          BASE_SITE_CONTEXT_ID,\n        ]),\n        onRead: (state) => this.onRead(state),\n      })\n    );\n  }\n\n  protected getCartState(): Observable<{ active: string }> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getMultiCartState),\n      filter((state) => !!state),\n      distinctUntilKeyChanged('active'),\n      map((state) => {\n        return {\n          active: state.active,\n        };\n      })\n    );\n  }\n\n  protected onRead(state: { active: string }) {\n    this.store.dispatch(new CartActions.ClearCartState());\n    if (state) {\n      this.store.dispatch(new CartActions.SetActiveCartId(state.active));\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n}\n","import { APP_INITIALIZER, ModuleWithProviders, NgModule } from '@angular/core';\nimport { ActionReducer, MetaReducer, META_REDUCERS } from '@ngrx/store';\nimport { ConfigInitializerService } from '../config/config-initializer/config-initializer.service';\nimport { MultiCartStatePersistenceService } from './services/multi-cart-state-persistence.service';\n\nexport function cartStatePersistenceFactory(\n  cartStatePersistenceService: MultiCartStatePersistenceService,\n  configInit: ConfigInitializerService\n) {\n  const result = () =>\n    configInit.getStableConfig('context').then(() => {\n      cartStatePersistenceService.initSync();\n    });\n  return result;\n}\n\n/**\n * Before `MultiCartStatePersistenceService` restores the active cart id `ActiveCartService`\n * will use `current` cart instead of the one saved in browser. This meta reducer\n * sets the value on store initialization to undefined cart which holds active cart loading\n * until the data from storage is restored.\n */\nexport function uninitializeActiveCartMetaReducerFactory(): MetaReducer<any> {\n  const metaReducer = (reducer: ActionReducer<any>) => (state, action) => {\n    const newState = { ...state };\n    if (action.type === '@ngrx/store/init') {\n      newState.cart = { ...newState.cart, ...{ active: undefined } };\n    }\n    return reducer(newState, action);\n  };\n  return metaReducer;\n}\n\n/**\n * Complimentary module for cart to store cart id in browser storage.\n * This makes it possible to work on the same anonymous cart even after page refresh.\n */\n@NgModule()\nexport class CartPersistenceModule {\n  static forRoot(): ModuleWithProviders<CartPersistenceModule> {\n    return {\n      ngModule: CartPersistenceModule,\n      providers: [\n        {\n          provide: APP_INITIALIZER,\n          useFactory: cartStatePersistenceFactory,\n          deps: [MultiCartStatePersistenceService, ConfigInitializerService],\n          multi: true,\n        },\n        {\n          provide: META_REDUCERS,\n          useFactory: uninitializeActiveCartMetaReducerFactory,\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import { OrderEntry } from '../../model/order.model';\n\n/**\n * Base cart event. Most cart events should have `cartId` and `userId`.\n */\nexport interface CartEvent {\n  cartId: string;\n  cartCode: string;\n  userId: string;\n}\n\n// =====================================================================\n\nexport class CartAddEntryEvent implements CartEvent {\n  cartId: string;\n  cartCode: string;\n  userId: string;\n  productCode: string;\n  quantity: number;\n}\n\nexport class CartAddEntrySuccessEvent implements CartEvent {\n  cartId: string;\n  cartCode: string;\n  userId: string;\n  productCode: string;\n  quantity: number;\n  entry: OrderEntry;\n  quantityAdded: number;\n  deliveryModeChanged: boolean;\n}\n\nexport class CartAddEntryFailEvent implements CartEvent {\n  cartId: string;\n  cartCode: string;\n  userId: string;\n  productCode: string;\n  quantity: number;\n}\n\nexport class CartRemoveEntrySuccessEvent implements CartEvent {\n  cartId: string;\n  cartCode: string;\n  userId: string;\n  entry: OrderEntry;\n}\n\nexport class CartUpdateEntrySuccessEvent implements CartEvent {\n  cartId: string;\n  cartCode: string;\n  userId: string;\n  quantity: number;\n  entry: OrderEntry;\n}\n","import { Injectable } from '@angular/core';\nimport { ofType } from '@ngrx/effects';\nimport { ActionsSubject } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, map, withLatestFrom } from 'rxjs/operators';\nimport { EventService } from '../../event/event.service';\nimport { ActionToEventMapping } from '../../state/event/action-to-event-mapping';\nimport { createFrom } from '../../util/create-from';\nimport { ActiveCartService } from '../facade/active-cart.service';\nimport { CartActions } from '../store/index';\nimport {\n  CartAddEntryEvent,\n  CartAddEntryFailEvent,\n  CartAddEntrySuccessEvent,\n  CartRemoveEntrySuccessEvent,\n  CartUpdateEntrySuccessEvent,\n} from './cart.events';\n\n/**\n * Registers events for the active cart\n */\n@Injectable({ providedIn: 'root' })\nexport class CartEventBuilder {\n  constructor(\n    protected actionsSubject: ActionsSubject,\n    protected event: EventService,\n    protected activeCartService: ActiveCartService\n  ) {\n    this.register();\n  }\n\n  /**\n   * Registers events for the active cart\n   */\n  protected register() {\n    this.registerAddEntry();\n    this.registerRemoveEntry();\n    this.registerUpdateEntry();\n  }\n\n  /**\n   * Register events for adding entry to the active cart\n   */\n  protected registerAddEntry(): void {\n    this.registerMapped({\n      action: CartActions.CART_ADD_ENTRY,\n      event: CartAddEntryEvent,\n    });\n    this.registerMapped({\n      action: CartActions.CART_ADD_ENTRY_SUCCESS,\n      event: CartAddEntrySuccessEvent,\n    });\n    this.registerMapped({\n      action: CartActions.CART_ADD_ENTRY_FAIL,\n      event: CartAddEntryFailEvent,\n    });\n  }\n\n  protected registerRemoveEntry(): void {\n    this.registerMapped({\n      action: CartActions.CART_REMOVE_ENTRY_SUCCESS,\n      event: CartRemoveEntrySuccessEvent,\n    });\n  }\n\n  protected registerUpdateEntry(): void {\n    this.registerMapped({\n      action: CartActions.CART_UPDATE_ENTRY_SUCCESS,\n      event: CartUpdateEntrySuccessEvent,\n    });\n  }\n\n  /**\n   * Registers a stream of target events mapped from the source actions that contain the cart id equal to the active cart id.\n   *\n   * @param mapping mapping declaration - from `action` string type to `event` class type\n   *   (an with optional `factory` function - by default `action.payload` will be assigned to the properties of the event instance).\n   */\n  protected registerMapped<T>(mapping: ActionToEventMapping<T>): () => void {\n    const eventStream$ = this.getAction(mapping.action).pipe(\n      withLatestFrom(\n        this.activeCartService.getActive(),\n        this.activeCartService.getActiveCartId()\n      ),\n      filter(\n        ([action, _activeCart, activeCartId]) =>\n          action.payload['cartId'] === activeCartId\n      ),\n      map(([action, activeCart]) =>\n        createFrom(mapping.event, {\n          ...action.payload,\n          cartCode: activeCart.code,\n          entry: action.payload.entry\n            ? action.payload.entry\n            : activeCart.entries[Number(action.payload.entryNumber)],\n        })\n      )\n    );\n    return this.event.register(mapping.event, eventStream$);\n  }\n\n  /**\n   * Returns a stream of actions only of a given type(s)\n   *\n   * @param actionType type(s) of actions\n   */\n  protected getAction(\n    actionType: string | string[]\n  ): Observable<{ type: string; payload?: any }> {\n    return this.actionsSubject.pipe(ofType(...[].concat(actionType)));\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CartEventBuilder } from './cart-event.builder';\n\n@NgModule({})\nexport class CartEventModule {\n  constructor(_CartEventBuilder: CartEventBuilder) {}\n}\n","import { CmsComponent } from '../../model';\nimport { StateUtils } from '../../state/index';\nimport { NodeItem } from '../model/node-item.model';\nimport { Page } from '../model/page.model';\n\nexport const CMS_FEATURE = 'cms';\nexport const NAVIGATION_DETAIL_ENTITY = '[Cms] Navigation Entity';\nexport const COMPONENT_ENTITY = '[Cms] Component Entity';\n\nexport interface StateWithCms {\n  [CMS_FEATURE]: CmsState;\n}\n\nexport type ComponentsState = StateUtils.EntityState<ComponentsContext>;\n\nexport interface ComponentsContext {\n  component: CmsComponent;\n  /**\n   * Page context stores an information for which context does the component exist.\n   * For example, if `SiteLogoComponent` was successfully loaded for a product page with an ID of 1776948, then this object will contain:\n   *\n   * ```ts\n   * ProductPage-1776948: {\n   *  success: true,\n   *  loading: false,\n   *  error: false,\n   *  // The `value` property indicates that the component exists for the given page context.\n   *  value: true\n   * }\n   * ```\n   *\n   * If the same `SiteLogoComponent` component was tried to be loaded on homepage (page context id is `homepage`),\n   * and it doesn't exist for some reason (maybe it has a restriction), then this object will contain:\n   *\n   * ```ts\n   * ProductPage-1776948: {\n   *  success: true,\n   *  loading: false,\n   *  error: false,\n   *  // The `value` property indicates that the component exists for the given page context.\n   *  value: true\n   * },\n   * ContentPage-homepage: {\n   *  success: true,\n   *  loading: false,\n   *  error: false,\n   *  // The `value` in this case is `false` indicating that the component was tried to be loaded, but it doesn't exist or has a restriction.\n   *  value: false\n   * }\n   * ```\n   *\n   */\n  pageContext: {\n    [context: string]: StateUtils.LoaderState<boolean>;\n  };\n}\n\nexport type IndexType = {\n  content: StateUtils.EntityLoaderState<string>;\n  product: StateUtils.EntityLoaderState<string>;\n  category: StateUtils.EntityLoaderState<string>;\n  catalog: StateUtils.EntityLoaderState<string>;\n};\n\nexport interface NavigationNodes {\n  [nodeId: string]: NodeItem;\n}\n\nexport interface PageState {\n  pageData: StateUtils.EntityState<Page>;\n  index: IndexType;\n}\n\nexport interface CmsState {\n  page: PageState;\n  components: ComponentsState;\n  navigation: StateUtils.EntityLoaderState<NodeItem>;\n}\n","import { CmsComponent } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing/index';\nimport { StateUtils } from '../../../state/utils/index';\nimport { COMPONENT_ENTITY } from '../cms-state';\n\nexport const LOAD_CMS_COMPONENT = '[Cms] Load Component';\nexport const LOAD_CMS_COMPONENT_FAIL = '[Cms] Load Component Fail';\nexport const LOAD_CMS_COMPONENT_SUCCESS = '[Cms] Load Component Success';\nexport const CMS_GET_COMPONENT_FROM_PAGE = '[Cms] Get Component from Page';\n\nexport class LoadCmsComponent extends StateUtils.EntityLoadAction {\n  readonly type = LOAD_CMS_COMPONENT;\n  constructor(\n    public payload: {\n      uid: string;\n      pageContext: PageContext;\n    }\n  ) {\n    super(COMPONENT_ENTITY, payload.uid);\n  }\n}\n\nexport class LoadCmsComponentFail extends StateUtils.EntityFailAction {\n  readonly type = LOAD_CMS_COMPONENT_FAIL;\n  constructor(\n    public payload: { uid: string; error?: any; pageContext: PageContext }\n  ) {\n    super(COMPONENT_ENTITY, payload.uid, payload.error);\n  }\n}\n\nexport class LoadCmsComponentSuccess<\n  T extends CmsComponent\n> extends StateUtils.EntitySuccessAction {\n  readonly type = LOAD_CMS_COMPONENT_SUCCESS;\n  constructor(\n    public payload: {\n      component: T;\n      uid?: string;\n      pageContext: PageContext;\n    }\n  ) {\n    super(COMPONENT_ENTITY, payload.uid || payload.component.uid || '');\n  }\n}\n\nexport class CmsGetComponentFromPage<\n  T extends CmsComponent\n> extends StateUtils.EntitySuccessAction {\n  readonly type = CMS_GET_COMPONENT_FROM_PAGE;\n  constructor(\n    public payload:\n      | { component: T; pageContext: PageContext }\n      | { component: T; pageContext: PageContext }[]\n  ) {\n    super(\n      COMPONENT_ENTITY,\n      [].concat(payload).map((cmp) => cmp.component.uid)\n    );\n  }\n}\n\n// action types\nexport type CmsComponentAction<T extends CmsComponent> =\n  | LoadCmsComponent\n  | LoadCmsComponentFail\n  | LoadCmsComponentSuccess<T>\n  | CmsGetComponentFromPage<T>;\n","import { StateUtils } from '../../../state/utils/index';\nimport { NAVIGATION_DETAIL_ENTITY } from '../cms-state';\n\nexport const LOAD_CMS_NAVIGATION_ITEMS = '[Cms] Load NavigationEntry items';\nexport const LOAD_CMS_NAVIGATION_ITEMS_FAIL =\n  '[Cms] Load NavigationEntry items Fail';\nexport const LOAD_CMS_NAVIGATION_ITEMS_SUCCESS =\n  '[Cms] Load NavigationEntry items Success';\n\nexport class LoadCmsNavigationItems extends StateUtils.EntityLoadAction {\n  readonly type = LOAD_CMS_NAVIGATION_ITEMS;\n  constructor(public payload: { nodeId: string; items: any[] }) {\n    super(NAVIGATION_DETAIL_ENTITY, payload.nodeId);\n  }\n}\n\nexport class LoadCmsNavigationItemsFail extends StateUtils.EntityFailAction {\n  readonly type = LOAD_CMS_NAVIGATION_ITEMS_FAIL;\n  constructor(nodeId: string, public payload: any) {\n    super(NAVIGATION_DETAIL_ENTITY, nodeId, payload);\n  }\n}\n\nexport class LoadCmsNavigationItemsSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = LOAD_CMS_NAVIGATION_ITEMS_SUCCESS;\n  constructor(public payload: { nodeId: string; components: any[] }) {\n    super(NAVIGATION_DETAIL_ENTITY, payload.nodeId);\n  }\n}\n\n// action types\nexport type CmsNavigationEntryItemAction =\n  | LoadCmsNavigationItems\n  | LoadCmsNavigationItemsFail\n  | LoadCmsNavigationItemsSuccess;\n","import { PageContext } from '../../../routing/index';\nimport { StateUtils } from '../../../state/utils/index';\nimport { Page } from '../../model/page.model';\n\nexport const LOAD_CMS_PAGE_DATA = '[Cms] Load Page Data';\nexport const LOAD_CMS_PAGE_DATA_FAIL = '[Cms] Load Page Data Fail';\nexport const LOAD_CMS_PAGE_DATA_SUCCESS = '[Cms] Load Page Data Success';\nexport const CMS_SET_PAGE_SUCCESS_INDEX = '[Cms] Set Page Success Index';\nexport const CMS_SET_PAGE_FAIL_INDEX = '[Cms] Set Page Fail Index';\n\nexport class LoadCmsPageData extends StateUtils.EntityLoadAction {\n  readonly type = LOAD_CMS_PAGE_DATA;\n  constructor(public payload: PageContext) {\n    super(payload.type, payload.id);\n  }\n}\n\nexport class LoadCmsPageDataFail extends StateUtils.EntityFailAction {\n  readonly type = LOAD_CMS_PAGE_DATA_FAIL;\n  constructor(pageContext: PageContext, error: any) {\n    super(pageContext.type, pageContext.id, error);\n  }\n}\n\nexport class LoadCmsPageDataSuccess extends StateUtils.EntitySuccessAction {\n  readonly type = LOAD_CMS_PAGE_DATA_SUCCESS;\n  constructor(pageContext: PageContext, payload: Page) {\n    super(pageContext.type, pageContext.id, payload);\n  }\n}\n\nexport class CmsSetPageSuccessIndex extends StateUtils.EntitySuccessAction {\n  readonly type = CMS_SET_PAGE_SUCCESS_INDEX;\n  constructor(pageContext: PageContext, payload: Page) {\n    super(pageContext.type, pageContext.id, payload);\n  }\n}\n\nexport class CmsSetPageFailIndex extends StateUtils.EntityFailAction {\n  readonly type = CMS_SET_PAGE_FAIL_INDEX;\n  constructor(pageContext: PageContext, public payload: string) {\n    super(pageContext.type, pageContext.id);\n  }\n}\n\n// action types\nexport type CmsPageAction =\n  | LoadCmsPageData\n  | LoadCmsPageDataFail\n  | LoadCmsPageDataSuccess\n  | CmsSetPageFailIndex;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { CmsState, CMS_FEATURE, StateWithCms } from '../cms-state';\n\nexport const getCmsState: MemoizedSelector<\n  StateWithCms,\n  CmsState\n> = createFeatureSelector<CmsState>(CMS_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { ComponentsContext, ComponentsState, StateWithCms } from '../cms-state';\nimport { getCmsState } from './feature.selectors';\n\nexport const getComponentsState: MemoizedSelector<\n  StateWithCms,\n  ComponentsState\n> = createSelector(getCmsState, (state) => state.components);\n\nexport const componentsContextSelectorFactory = (\n  uid: string\n): MemoizedSelector<StateWithCms, ComponentsContext> => {\n  return createSelector(getComponentsState, (componentsState) =>\n    StateUtils.entitySelector(componentsState, uid)\n  );\n};\n\nexport const componentsLoaderStateSelectorFactory = (\n  uid: string,\n  context: string\n): MemoizedSelector<StateWithCms, StateUtils.LoaderState<boolean>> => {\n  return createSelector(\n    componentsContextSelectorFactory(uid),\n    (componentsContext) =>\n      (componentsContext &&\n        componentsContext.pageContext &&\n        componentsContext.pageContext[context]) ||\n      StateUtils.initialLoaderState\n  );\n};\n\n/**\n * This selector will return:\n *   - true: component for this context exists\n *   - false: component for this context doesn't exist\n *   - undefined: if the exists status for component is unknown\n *\n * @param uid\n * @param context\n */\nexport const componentsContextExistsSelectorFactory = (\n  uid: string,\n  context: string\n): MemoizedSelector<StateWithCms, boolean | undefined> => {\n  return createSelector(\n    componentsLoaderStateSelectorFactory(uid, context),\n    (loaderState) => StateUtils.loaderValueSelector(loaderState)\n  );\n};\n\nexport const componentsDataSelectorFactory = (\n  uid: string\n): MemoizedSelector<StateWithCms, CmsComponent | undefined> => {\n  return createSelector(componentsContextSelectorFactory(uid), (state) =>\n    state ? state.component : undefined\n  );\n};\n\n/**\n * This selector will return:\n *   - CmsComponent instance: if we have component data for specified context\n *   - null: if there is no component data for specified context\n *   - undefined: if status of component data for specified context is unknown\n *\n * @param uid\n * @param context\n */\nexport const componentsSelectorFactory = (\n  uid: string,\n  context: string\n): MemoizedSelector<StateWithCms, CmsComponent | null | undefined> => {\n  return createSelector(\n    componentsDataSelectorFactory(uid),\n    componentsContextExistsSelectorFactory(uid, context),\n    (componentState, exists) => {\n      switch (exists) {\n        case true:\n          return componentState;\n        case false:\n          return null;\n        case undefined:\n          return undefined;\n      }\n    }\n  );\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateUtils } from '../../../state/utils/index';\nimport { NodeItem } from '../../model/node-item.model';\nimport { CmsState, StateWithCms } from '../cms-state';\nimport { getCmsState } from './feature.selectors';\n\nexport const getNavigationEntryItemState: MemoizedSelector<\n  StateWithCms,\n  StateUtils.EntityLoaderState<NodeItem>\n> = createSelector(getCmsState, (state: CmsState) => state.navigation);\n\nexport const getSelectedNavigationEntryItemState = (\n  nodeId: string\n): MemoizedSelector<StateWithCms, StateUtils.LoaderState<NodeItem>> => {\n  return createSelector(getNavigationEntryItemState, (nodes) =>\n    StateUtils.entityLoaderStateSelector(nodes, nodeId)\n  );\n};\n\nexport const getNavigationEntryItems = (\n  nodeId: string\n): MemoizedSelector<StateWithCms, NodeItem> => {\n  return createSelector(\n    getSelectedNavigationEntryItemState(nodeId),\n    (itemState) => StateUtils.loaderValueSelector(itemState)\n  );\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { PageType } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing';\nimport { StateUtils } from '../../../state/utils/index';\nimport { ContentSlotData } from '../../model/content-slot-data.model';\nimport { Page } from '../../model/page.model';\nimport { CmsState, IndexType, PageState, StateWithCms } from '../cms-state';\nimport { getCmsState } from './feature.selectors';\n\nconst getPageEntitiesSelector = (state: PageState) => state.pageData.entities;\nconst getIndexByType = (\n  index: IndexType,\n  type: PageType\n): StateUtils.EntityLoaderState<string> => {\n  switch (type) {\n    case PageType.CONTENT_PAGE: {\n      return index.content;\n    }\n    case PageType.PRODUCT_PAGE: {\n      return index.product;\n    }\n    case PageType.CATEGORY_PAGE: {\n      return index.category;\n    }\n    case PageType.CATALOG_PAGE: {\n      return index.catalog;\n    }\n  }\n  return { entities: {} };\n};\n\nconst getPageComponentTypesSelector: (page: Page) => string[] = (\n  page: Page\n) => {\n  const componentTypes = new Set<string>();\n  if (page && page.slots) {\n    for (const slot of Object.keys(page.slots)) {\n      for (const component of page.slots[slot].components || []) {\n        componentTypes.add(component.flexType);\n      }\n    }\n  }\n  return Array.from(componentTypes);\n};\n\nexport const getPageState: MemoizedSelector<\n  StateWithCms,\n  PageState\n> = createSelector(getCmsState, (state: CmsState) => state.page);\n\nexport const getPageStateIndex: MemoizedSelector<\n  StateWithCms,\n  IndexType\n> = createSelector(getPageState, (page: PageState) => page.index);\n\nexport const getPageStateIndexEntityLoaderState = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, StateUtils.EntityLoaderState<string>> =>\n  createSelector(getPageStateIndex, (index: IndexType) =>\n    getIndexByType(index, pageContext.type)\n  );\n\nexport const getPageStateIndexLoaderState = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, StateUtils.LoaderState<string>> =>\n  createSelector(\n    getPageStateIndexEntityLoaderState(pageContext),\n    (indexState) =>\n      StateUtils.entityLoaderStateSelector(indexState, pageContext.id)\n  );\n\nexport const getPageStateIndexValue = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, string> =>\n  createSelector(getPageStateIndexLoaderState(pageContext), (entity) =>\n    StateUtils.loaderValueSelector<string>(entity)\n  );\n\nexport const getPageEntities: MemoizedSelector<\n  StateWithCms,\n  { [id: string]: Page }\n> = createSelector(getPageState, getPageEntitiesSelector);\n\nexport const getPageData = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, Page> =>\n  createSelector(\n    getPageEntities,\n    getPageStateIndexValue(pageContext),\n    (entities: { [id: string]: Page }, indexValue: string) =>\n      entities[indexValue]\n  );\n\nexport const getPageComponentTypes = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, string[]> =>\n  createSelector(getPageData(pageContext), (pageData) =>\n    getPageComponentTypesSelector(pageData)\n  );\n\nexport const getCurrentSlotSelectorFactory = (\n  pageContext: PageContext,\n  position: string\n): MemoizedSelector<StateWithCms, ContentSlotData> => {\n  return createSelector(getPageData(pageContext), (entity) => {\n    if (entity) {\n      return entity.slots[position] || { components: [] };\n    }\n  });\n};\n","import { PageType } from '../../model/cms.model';\nimport { PageContext } from '../../routing/models/page-context.model';\n\nexport const CURRENT_CONTEXT_KEY = 'current';\n\n/**\n *\n * Serializes the provided page context.\n * The pattern used for serialization is: `pageContext.type-pageContext.id`.\n *\n * @param pageContext to serialize\n * @param ignoreContentPageId if set to true, and the PageType is of type ContentPage, then the serialized page context will not contain the ID.\n * Otherwise, the page context if fully serialized.\n */\nexport function serializePageContext(\n  pageContext: PageContext,\n  ignoreContentPageId?: boolean\n): string {\n  if (!pageContext) {\n    return CURRENT_CONTEXT_KEY;\n  }\n\n  if (ignoreContentPageId && pageContext.type === PageType.CONTENT_PAGE) {\n    return `${pageContext.type}`;\n  }\n\n  return `${pageContext.type}-${pageContext.id}`;\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, Observable, of, queueScheduler, using } from 'rxjs';\nimport {\n  catchError,\n  filter,\n  observeOn,\n  pluck,\n  shareReplay,\n  switchMap,\n  take,\n  tap,\n} from 'rxjs/operators';\nimport { CmsComponent } from '../../model/cms.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { PageContext } from '../../routing/models/page-context.model';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { ContentSlotData } from '../model/content-slot-data.model';\nimport { NodeItem } from '../model/node-item.model';\nimport { Page } from '../model/page.model';\nimport { CmsActions } from '../store/actions/index';\nimport { StateWithCms } from '../store/cms-state';\nimport { CmsSelectors } from '../store/selectors/index';\nimport { serializePageContext } from '../utils/cms-utils';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CmsService {\n  private components: {\n    [uid: string]: {\n      [pageContext: string]: Observable<CmsComponent>;\n    };\n  } = {};\n\n  constructor(\n    protected store: Store<StateWithCms>,\n    protected routingService: RoutingService\n  ) {}\n\n  /**\n   * Get current CMS page data\n   */\n  getCurrentPage(): Observable<Page> {\n    return this.routingService\n      .getPageContext()\n      .pipe(\n        switchMap((pageContext) =>\n          this.store.select(CmsSelectors.getPageData(pageContext))\n        )\n      );\n  }\n\n  /**\n   * Get CMS component data by uid\n   *\n   * This method can be safely and optimally used to load multiple components data at the same time.\n   * Calling getComponentData multiple times for different components will always result in optimized\n   * back-end request: all components requested at the same time (in one event loop) will be loaded in one network call.\n   *\n   * In case the component data is not present, the method will load it.\n   * Otherwise, if the page context is not provided, the current page context from the router state will be used instead.\n   *\n   * @param uid CMS component uid\n   * @param pageContext if provided, it will be used to lookup the component data.\n   */\n  getComponentData<T extends CmsComponent | null>(\n    uid: string,\n    pageContext?: PageContext\n  ): Observable<T> {\n    const context = serializePageContext(pageContext, true);\n    if (!this.components[uid]) {\n      // create the component data structure, if it doesn't already exist\n      this.components[uid] = {};\n    }\n\n    const component = this.components[uid];\n    if (!component[context]) {\n      // create the component data and assign it to the component's context\n      component[context] = this.createComponentData(uid, pageContext);\n    }\n\n    return component[context] as Observable<T>;\n  }\n\n  private createComponentData<T extends CmsComponent>(\n    uid: string,\n    pageContext?: PageContext\n  ): Observable<T> {\n    if (!pageContext) {\n      return this.routingService.getPageContext().pipe(\n        filter((currentContext) => !!currentContext),\n        switchMap((currentContext) =>\n          this.getComponentData<T>(uid, currentContext)\n        )\n      );\n    }\n\n    const context = serializePageContext(pageContext, true);\n\n    const loading$ = combineLatest([\n      this.routingService.getNextPageContext(),\n      this.store.pipe(\n        select(CmsSelectors.componentsLoaderStateSelectorFactory(uid, context))\n      ),\n    ]).pipe(\n      observeOn(queueScheduler),\n      tap(([nextContext, loadingState]) => {\n        const attemptedLoad =\n          loadingState.loading || loadingState.success || loadingState.error;\n        // if the requested context is the same as the one that's currently being navigated to\n        // (as it might already been triggered and might be available shortly from page data)\n        // TODO(issue:3649), TODO(issue:3668) - this optimization could be removed\n        const couldBeLoadedWithPageData = nextContext\n          ? serializePageContext(nextContext, true) === context\n          : false;\n\n        if (!attemptedLoad && !couldBeLoadedWithPageData) {\n          this.store.dispatch(\n            new CmsActions.LoadCmsComponent({ uid, pageContext })\n          );\n        }\n      })\n    );\n\n    const component$ = this.store.pipe(\n      select(CmsSelectors.componentsSelectorFactory(uid, context)),\n      filter((component) => component !== undefined)\n    ) as Observable<T | null>;\n\n    return using(\n      () => loading$.subscribe(),\n      () => component$\n    ).pipe(shareReplay({ bufferSize: 1, refCount: true }));\n  }\n\n  /**\n   * Given the position, get the content slot data\n   * @param position : content slot position\n   */\n  getContentSlot(position: string): Observable<ContentSlotData> {\n    return this.routingService\n      .getPageContext()\n      .pipe(\n        switchMap((pageContext) =>\n          this.store.pipe(\n            select(\n              CmsSelectors.getCurrentSlotSelectorFactory(pageContext, position)\n            ),\n            filter(Boolean)\n          )\n        )\n      );\n  }\n\n  /**\n   * Given navigation node uid, get items (with id and type) inside the navigation entries\n   * @param navigationNodeUid : uid of the navigation node\n   */\n  getNavigationEntryItems(navigationNodeUid: string): Observable<NodeItem> {\n    return this.store.pipe(\n      select(CmsSelectors.getNavigationEntryItems(navigationNodeUid))\n    );\n  }\n\n  /**\n   * Load navigation items data\n   * @param rootUid : the uid of the root navigation node\n   * @param itemList : list of items (with id and type)\n   */\n  loadNavigationItems(\n    rootUid: string,\n    itemList: { id: string; superType: string }[]\n  ): void {\n    this.store.dispatch(\n      new CmsActions.LoadCmsNavigationItems({\n        nodeId: rootUid,\n        items: itemList,\n      })\n    );\n  }\n\n  /**\n   * Refresh the content of the latest cms page\n   */\n  refreshLatestPage(): void {\n    this.routingService\n      .getPageContext()\n      .pipe(take(1))\n      .subscribe((pageContext) =>\n        this.store.dispatch(new CmsActions.LoadCmsPageData(pageContext))\n      );\n  }\n\n  /**\n   * Refresh the cms page content by page Id\n   * @param pageId\n   */\n  refreshPageById(pageId: string): void {\n    const pageContext: PageContext = { id: pageId };\n    this.store.dispatch(new CmsActions.LoadCmsPageData(pageContext));\n  }\n\n  /**\n   * Refresh cms component's content\n   * @param uid component uid\n   * @param pageContext an optional parameter that enables the caller to specify for which context the component should be refreshed.\n   * If not specified, 'current' page context is used.\n   */\n  refreshComponent(uid: string, pageContext?: PageContext): void {\n    this.store.dispatch(new CmsActions.LoadCmsComponent({ uid, pageContext }));\n  }\n\n  /**\n   * Given pageContext, return the CMS page data\n   * @param pageContext\n   */\n  getPageState(pageContext: PageContext): Observable<Page> {\n    return this.store.pipe(select(CmsSelectors.getPageData(pageContext)));\n  }\n\n  /**\n   * Given pageContext, return the CMS page data\n   * @param pageContext\n   */\n  getPageComponentTypes(pageContext: PageContext): Observable<string[]> {\n    return this.store.pipe(\n      select(CmsSelectors.getPageComponentTypes(pageContext))\n    );\n  }\n\n  /**\n   * Given pageContext, return whether the CMS page data exists or not\n   * @param pageContext\n   */\n  hasPage(pageContext: PageContext, forceReload = false): Observable<boolean> {\n    return this.store.pipe(\n      select(CmsSelectors.getPageStateIndexLoaderState(pageContext)),\n      tap((entity: LoaderState<string>) => {\n        const attemptedLoad = entity.loading || entity.success || entity.error;\n        const shouldReload = forceReload && !entity.loading;\n        if (!attemptedLoad || shouldReload) {\n          this.store.dispatch(new CmsActions.LoadCmsPageData(pageContext));\n          forceReload = false;\n        }\n      }),\n      filter((entity) => {\n        if (!entity.hasOwnProperty('value')) {\n          // if we have incomplete state from SSR failed load transfer state,\n          // we should wait for reload and actual value\n          return false;\n        }\n        return entity.success || (entity.error && !entity.loading);\n      }),\n      pluck('success'),\n      catchError(() => of(false))\n    );\n  }\n\n  /**\n   * Given pageContext, return the CMS page data\n   **/\n  getPage(pageContext: PageContext, forceReload = false): Observable<Page> {\n    return this.hasPage(pageContext, forceReload).pipe(\n      switchMap((hasPage) =>\n        hasPage ? this.getPageState(pageContext) : of(null)\n      )\n    );\n  }\n\n  getPageIndex(pageContext: PageContext): Observable<string> {\n    return this.store.pipe(\n      select(CmsSelectors.getPageStateIndexValue(pageContext))\n    );\n  }\n\n  setPageFailIndex(pageContext: PageContext, value: string): void {\n    this.store.dispatch(new CmsActions.CmsSetPageFailIndex(pageContext, value));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { filter, map } from 'rxjs/operators';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { Page, PageRobotsMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageRobotsResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { PageType } from '../../model/cms.model';\n\n/**\n * Resolves the page metadata for the Cart page (Using the `PageType.CONTENT_PAGE`\n * and the `CartPageTemplate`). If the cart page matches this template, the more\n * generic `ContentPageMetaResolver` is overridden by this resolver.\n *\n * The page title and robots are resolved in this implementation only.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartPageMetaResolver\n  extends PageMetaResolver\n  implements PageTitleResolver, PageRobotsResolver {\n  protected cms$: Observable<Page> = this.cms\n    .getCurrentPage()\n    .pipe(filter((page) => !!page));\n\n  constructor(protected cms: CmsService) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'CartPageTemplate';\n  }\n\n  /**\n   * Resolves the page title, which is driven by the backend.\n   */\n  resolveTitle(): Observable<string> {\n    return this.cms$.pipe(map((p) => p.title));\n  }\n\n  /**\n   * Returns robots for the cart pages, which default to NOINDEX and NOFOLLOW.\n   */\n  resolveRobots(): Observable<PageRobotsMeta[]> {\n    return of([PageRobotsMeta.NOFOLLOW, PageRobotsMeta.NOINDEX]);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { CartActions } from '../actions/index';\n\n@Injectable()\nexport class MultiCartEffects {\n  @Effect()\n  setTempCart$ = this.actions$.pipe(\n    ofType(CartActions.SET_TEMP_CART),\n    map((action: CartActions.SetTempCart) => {\n      return new CartActions.RemoveCart({ cartId: action.payload.tempCartId });\n    })\n  );\n\n  // TODO(#7241): Remove when we drop ADD_VOUCHER process and we sort out checkout and cart dependencies\n  @Effect()\n  processesIncrement$: Observable<\n    CartActions.CartProcessesIncrement\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_ADD_VOUCHER),\n    map((action: CartActions.CartAddVoucher) => action.payload),\n    map((payload) => new CartActions.CartProcessesIncrement(payload.cartId))\n  );\n\n  constructor(private actions$: Actions) {}\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { StateModule } from '../../state/state.module';\nimport { CartEntryEffects } from './effects/cart-entry.effect';\nimport { CartVoucherEffects } from './effects/cart-voucher.effect';\nimport { CartEffects } from './effects/cart.effect';\nimport { MultiCartEffects } from './effects/multi-cart.effect';\nimport { WishListEffects } from './effects/wish-list.effect';\nimport { MULTI_CART_FEATURE } from './multi-cart-state';\nimport {\n  multiCartMetaReducers,\n  multiCartReducerProvider,\n  multiCartReducerToken,\n} from './reducers/index';\n\nconst effects: any[] = [\n  CartEffects,\n  CartEntryEffects,\n  CartVoucherEffects,\n  WishListEffects,\n  MultiCartEffects,\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    StateModule,\n    StoreModule.forFeature(MULTI_CART_FEATURE, multiCartReducerToken, {\n      metaReducers: multiCartMetaReducers,\n    }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [multiCartReducerProvider],\n})\nexport class MultiCartStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { PageMetaResolver } from '../cms/page/page-meta.resolver';\nimport { CartPersistenceModule } from './cart-persistence.module';\nimport { CartEventModule } from './event/cart-event.module';\nimport { CartPageMetaResolver } from './services/cart-page-meta.resolver';\nimport { MultiCartStoreModule } from './store/multi-cart-store.module';\n\n@NgModule({\n  imports: [\n    MultiCartStoreModule,\n    CartEventModule,\n    CartPersistenceModule.forRoot(),\n  ],\n})\nexport class CartModule {\n  static forRoot(): ModuleWithProviders<CartModule> {\n    return {\n      ngModule: CartModule,\n      providers: [\n        {\n          provide: PageMetaResolver,\n          useExisting: CartPageMetaResolver,\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class CartConfig {\n  cart?: {\n    selectiveCart?: {\n      enabled?: boolean;\n    };\n  };\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, Observable } from 'rxjs';\nimport { map, take } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/index';\nimport * as fromProcessStore from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { CartActions } from '../store/actions/index';\nimport { ADD_VOUCHER_PROCESS_ID } from '../store/multi-cart-state';\nimport { ActiveCartService } from './active-cart.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartVoucherService {\n  constructor(\n    protected store: Store<fromProcessStore.StateWithProcess<void>>,\n    protected activeCartService: ActiveCartService,\n    protected userIdService: UserIdService\n  ) {}\n\n  addVoucher(voucherId: string, cartId?: string): void {\n    this.combineUserAndCartId(cartId).subscribe(([occUserId, cartIdentifier]) =>\n      this.store.dispatch(\n        new CartActions.CartAddVoucher({\n          userId: occUserId,\n          cartId: cartIdentifier,\n          voucherId: voucherId,\n        })\n      )\n    );\n  }\n\n  removeVoucher(voucherId: string, cartId?: string): void {\n    this.combineUserAndCartId(cartId).subscribe(([occUserId, cartIdentifier]) =>\n      this.store.dispatch(\n        new CartActions.CartRemoveVoucher({\n          userId: occUserId,\n          cartId: cartIdentifier,\n          voucherId: voucherId,\n        })\n      )\n    );\n  }\n\n  // TODO(#7241): Remove when switching to event system for add voucher\n  /**\n   * Get add voucher process error flag\n   * @deprecated since 2.0\n   */\n  getAddVoucherResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(ADD_VOUCHER_PROCESS_ID))\n    );\n  }\n\n  // TODO(#7241): Remove when switching to event system for add voucher\n  /**\n   * Get add voucher process success flag\n   * @deprecated since 2.0\n   */\n  getAddVoucherResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(ADD_VOUCHER_PROCESS_ID))\n    );\n  }\n\n  // TODO(#7241): Remove when switching to event system for add voucher\n  /**\n   * Get add voucher process loading flag\n   * @deprecated since 2.0\n   */\n  getAddVoucherResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(ADD_VOUCHER_PROCESS_ID))\n    );\n  }\n\n  // TODO(#7241): Remove when switching to event system for add voucher\n  /**\n   * Reset add voucher process\n   * @deprecated since 2.0\n   */\n  resetAddVoucherProcessingState(): void {\n    this.store.dispatch(new CartActions.CartResetAddVoucher());\n  }\n\n  private combineUserAndCartId(cartId: string): Observable<[string, string]> {\n    if (cartId) {\n      return this.userIdService.getUserId().pipe(\n        take(1),\n        map((userId) => [userId, cartId])\n      );\n    } else {\n      return combineLatest([\n        this.userIdService.getUserId(),\n        this.activeCartService.getActiveCartId(),\n      ]).pipe(take(1));\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CartConfig } from '../config/cart-config';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartConfigService {\n  constructor(protected config: CartConfig) {}\n\n  isSelectiveCartEnabled(): boolean {\n    return Boolean(this.config?.cart?.selectiveCart?.enabled);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport { BehaviorSubject, combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, shareReplay, switchMap, take, tap } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { Cart } from '../../model/cart.model';\nimport { OrderEntry } from '../../model/order.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { BaseSiteService } from '../../site-context/facade/base-site.service';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { UserService } from '../../user/facade/user.service';\nimport { CartConfigService } from '../services/cart-config.service';\nimport { StateWithMultiCart } from '../store/multi-cart-state';\nimport { MultiCartService } from './multi-cart.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SelectiveCartService {\n  private customerId: string;\n  private userId: string;\n  private cartId: string;\n  private selectiveCart$: Observable<Cart>;\n  private cartId$: BehaviorSubject<string> = new BehaviorSubject<string>(\n    undefined\n  );\n\n  private readonly PREVIOUS_USER_ID_INITIAL_VALUE =\n    'PREVIOUS_USER_ID_INITIAL_VALUE';\n  private previousUserId = this.PREVIOUS_USER_ID_INITIAL_VALUE;\n\n  private cartSelector$ = this.cartId$.pipe(\n    switchMap((cartId) => {\n      this.cartId = cartId;\n      return this.multiCartService.getCartEntity(cartId);\n    })\n  );\n\n  constructor(\n    protected store: Store<StateWithMultiCart>,\n    protected userService: UserService,\n    protected multiCartService: MultiCartService,\n    protected baseSiteService: BaseSiteService,\n    protected cartConfigService: CartConfigService,\n    protected userIdService: UserIdService\n  ) {\n    combineLatest([\n      this.userService.get(),\n      this.baseSiteService.getActive(),\n    ]).subscribe(([user, activeBaseSite]) => {\n      if (user && user.customerId && activeBaseSite) {\n        this.customerId = user.customerId;\n        this.cartId$.next(`selectivecart${activeBaseSite}${this.customerId}`);\n      } else if (user && !user.customerId) {\n        this.cartId$.next(undefined);\n      }\n    });\n\n    this.userIdService.getUserId().subscribe((userId) => {\n      this.userId = userId;\n\n      if (this.isJustLoggedIn(userId)) {\n        this.load();\n      }\n\n      this.previousUserId = userId;\n    });\n\n    this.selectiveCart$ = this.cartSelector$.pipe(\n      map((cartEntity: LoaderState<Cart>): {\n        cart: Cart;\n        loading: boolean;\n        loaded: boolean;\n      } => {\n        return {\n          cart: cartEntity.value,\n          loading: cartEntity.loading,\n          loaded:\n            (cartEntity.error || cartEntity.success) && !cartEntity.loading,\n        };\n      }),\n      filter(({ loading }) => !loading),\n      tap(({ cart, loaded }) => {\n        if (this.cartId && this.isEmpty(cart) && !loaded) {\n          this.load();\n        }\n      }),\n      map(({ cart }) => (cart ? cart : {})),\n      shareReplay({ bufferSize: 1, refCount: true })\n    );\n  }\n\n  getCart(): Observable<Cart> {\n    return this.selectiveCart$;\n  }\n\n  getEntries(): Observable<OrderEntry[]> {\n    return this.multiCartService.getEntries(this.cartId);\n  }\n\n  getLoaded(): Observable<boolean> {\n    return this.cartSelector$.pipe(\n      map((cart) => (cart.success || cart.error) && !cart.loading)\n    );\n  }\n\n  private load() {\n    if (this.isLoggedIn(this.userId) && this.cartId) {\n      this.multiCartService.loadCart({\n        userId: this.userId,\n        cartId: this.cartId,\n      });\n    }\n  }\n\n  addEntry(productCode: string, quantity: number): void {\n    let loadAttempted = false;\n    this.cartSelector$\n      .pipe(\n        filter(() => !loadAttempted),\n        switchMap((cartState) => {\n          if (this.isEmpty(cartState.value) && !cartState.loading) {\n            loadAttempted = true;\n            this.load();\n          }\n          return of(cartState);\n        }),\n        filter((cartState) => !this.isEmpty(cartState.value)),\n        take(1)\n      )\n      .subscribe(() => {\n        this.multiCartService.addEntry(\n          this.userId,\n          this.cartId,\n          productCode,\n          quantity\n        );\n      });\n  }\n\n  removeEntry(entry: OrderEntry): void {\n    this.multiCartService.removeEntry(\n      this.userId,\n      this.cartId,\n      entry.entryNumber\n    );\n  }\n\n  updateEntry(entryNumber: number, quantity: number): void {\n    this.multiCartService.updateEntry(\n      this.userId,\n      this.cartId,\n      entryNumber,\n      quantity\n    );\n  }\n\n  getEntry(productCode: string): Observable<OrderEntry> {\n    return this.multiCartService.getEntry(this.cartId, productCode);\n  }\n\n  /**\n   * Indicates if selectiveCart feature is enabled based on cart configuration.\n   */\n  isEnabled(): boolean {\n    return this.cartConfigService.isSelectiveCartEnabled();\n  }\n\n  private isEmpty(cart: Cart): boolean {\n    return (\n      !cart || (typeof cart === 'object' && Object.keys(cart).length === 0)\n    );\n  }\n\n  private isJustLoggedIn(userId: string): boolean {\n    return (\n      this.isLoggedIn(userId) &&\n      this.previousUserId !== userId && // *just* logged in\n      this.previousUserId !== this.PREVIOUS_USER_ID_INITIAL_VALUE // not app initialization\n    );\n  }\n\n  private isLoggedIn(userId: string): boolean {\n    return typeof userId !== 'undefined' && userId !== OCC_USER_ID_ANONYMOUS;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, Observable } from 'rxjs';\nimport {\n  distinctUntilChanged,\n  filter,\n  map,\n  switchMap,\n  take,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { Cart, OrderEntry } from '../../model/index';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { UserService } from '../../user/facade/user.service';\nimport { CartActions } from '../store/actions/index';\nimport { StateWithMultiCart } from '../store/multi-cart-state';\nimport { MultiCartSelectors } from '../store/selectors/index';\nimport { getWishlistName } from '../utils/utils';\nimport { MultiCartService } from './multi-cart.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class WishListService {\n  constructor(\n    protected store: Store<StateWithMultiCart>,\n    protected userService: UserService,\n    protected multiCartService: MultiCartService,\n    protected userIdService: UserIdService\n  ) {}\n\n  createWishList(userId: string, name?: string, description?: string): void {\n    this.store.dispatch(\n      new CartActions.CreateWishList({ userId, name, description })\n    );\n  }\n\n  getWishList(): Observable<Cart> {\n    return combineLatest([\n      this.getWishListId(),\n      this.userService.get(),\n      this.userIdService.getUserId(),\n    ]).pipe(\n      distinctUntilChanged(),\n      tap(([wishListId, user, userId]) => {\n        if (\n          !Boolean(wishListId) &&\n          userId !== OCC_USER_ID_ANONYMOUS &&\n          Boolean(user) &&\n          Boolean(user.customerId)\n        ) {\n          this.loadWishList(userId, user.customerId);\n        }\n      }),\n      filter(([wishListId]) => Boolean(wishListId)),\n      switchMap(([wishListId]) => this.multiCartService.getCart(wishListId))\n    );\n  }\n\n  loadWishList(userId: string, customerId: string): void {\n    this.store.dispatch(\n      new CartActions.LoadWishList({\n        userId,\n        customerId,\n        tempCartId: getWishlistName(customerId),\n      })\n    );\n  }\n\n  addEntry(productCode: string): void {\n    this.getWishListId()\n      .pipe(\n        distinctUntilChanged(),\n        withLatestFrom(this.userIdService.getUserId(), this.userService.get()),\n        tap(([wishListId, userId, user]) => {\n          if (\n            !Boolean(wishListId) &&\n            Boolean(user) &&\n            Boolean(user.customerId)\n          ) {\n            this.loadWishList(userId, user.customerId);\n          }\n        }),\n        filter(([wishListId]) => Boolean(wishListId)),\n        take(1)\n      )\n      .subscribe(([wishListId, userId]) =>\n        this.multiCartService.addEntry(userId, wishListId, productCode, 1)\n      );\n  }\n\n  removeEntry(entry: OrderEntry): void {\n    this.getWishListId()\n      .pipe(\n        distinctUntilChanged(),\n        withLatestFrom(this.userIdService.getUserId(), this.userService.get()),\n        tap(([wishListId, userId, user]) => {\n          if (\n            !Boolean(wishListId) &&\n            Boolean(user) &&\n            Boolean(user.customerId)\n          ) {\n            this.loadWishList(userId, user.customerId);\n          }\n        }),\n        filter(([wishListId]) => Boolean(wishListId)),\n        take(1)\n      )\n      .subscribe(([wishListId, userId]) =>\n        this.multiCartService.removeEntry(userId, wishListId, entry.entryNumber)\n      );\n  }\n\n  getWishListLoading(): Observable<boolean> {\n    return this.getWishListId().pipe(\n      switchMap((wishListId) =>\n        this.multiCartService\n          .isStable(wishListId)\n          .pipe(map((stable) => !stable))\n      )\n    );\n  }\n\n  protected getWishListId(): Observable<string> {\n    return this.store.pipe(select(MultiCartSelectors.getWishListId));\n  }\n}\n","import { CmsConfig } from './cms-config';\n\nexport const defaultCmsModuleConfig: CmsConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        component: 'cms/components/${id}',\n        components: 'cms/components',\n        pages: 'cms/pages',\n        page: 'cms/pages/${id}',\n      },\n    },\n  },\n  cmsComponents: {},\n};\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { TranslationService } from '../../../i18n/translation.service';\nimport { BreadcrumbMeta } from '../../model/page.model';\nimport {\n  RouteBreadcrumbConfig,\n  RouteBreadcrumbResolver,\n  RouteBreadcrumbResolverParams,\n} from './route-page-meta.model';\n\n/**\n * Resolves the breadcrumb for the Angular ActivatedRouteSnapshot\n */\n@Injectable({ providedIn: 'root' })\nexport abstract class DefaultRoutePageMetaResolver\n  implements RouteBreadcrumbResolver {\n  constructor(protected translation: TranslationService) {}\n\n  /**\n   * Resolves breadcrumb based on the given url and the breadcrumb config.\n   *\n   * - When breadcrumb config is empty, it returns an empty breadcrumb.\n   * - When breadcrumb config is a string or object with `i18n` property,\n   *    it translates it and use as a label of the returned breadcrumb.\n   * - When breadcrumb config is an object with property `raw`, then\n   *    it's used as a label of the returned breadcrumb.\n   */\n  resolveBreadcrumbs({\n    url,\n    pageMetaConfig,\n  }: RouteBreadcrumbResolverParams): Observable<BreadcrumbMeta[]> {\n    const breadcrumbConfig = pageMetaConfig?.breadcrumb;\n\n    if (!breadcrumbConfig) {\n      return of([]);\n    }\n\n    if (typeof breadcrumbConfig !== 'string' && breadcrumbConfig.raw) {\n      return of([{ link: url, label: breadcrumbConfig.raw }]);\n    }\n\n    return this.translateBreadcrumbLabel(breadcrumbConfig).pipe(\n      map((label) => [{ label, link: url }])\n    );\n  }\n\n  /**\n   * Translates the configured breadcrumb label\n   */\n  protected translateBreadcrumbLabel(\n    breadcrumbConfig: string | RouteBreadcrumbConfig\n  ): Observable<string> {\n    const i18nKey =\n      typeof breadcrumbConfig === 'string'\n        ? breadcrumbConfig\n        : breadcrumbConfig.i18n;\n\n    return this.getParams().pipe(\n      switchMap((params) => this.translation.translate(i18nKey, params ?? {}))\n    );\n  }\n\n  /**\n   * Resolves dynamic data for the whole resolver.\n   */\n  protected getParams(): Observable<{ [_: string]: any }> {\n    return of({});\n  }\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { ActivatedRouteSnapshot } from '@angular/router';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { map, shareReplay, switchMap } from 'rxjs/operators';\nimport { ActivatedRoutesService } from '../../../routing/services/activated-routes.service';\nimport { BreadcrumbMeta } from '../../model/page.model';\nimport { DefaultRoutePageMetaResolver } from './default-route-page-meta.resolver';\nimport {\n  ActivatedRouteSnapshotWithPageMeta,\n  RouteBreadcrumbResolver,\n  RoutePageMetaConfig,\n} from './route-page-meta.model';\n\n// PRIVATE\nexport interface RouteWithExtras {\n  route: ActivatedRouteSnapshotWithPageMeta;\n  resolver: any;\n  url: string;\n}\n\nexport interface RoutingResolveBreadcrumbsOptions {\n  /**\n   * Includes the current route in the breadcrumbs.\n   */\n  includeCurrentRoute?: boolean;\n}\n\n/**\n * Resolves the page meta based on the Angular Activated Routes\n */\n@Injectable({ providedIn: 'root' })\nexport class RoutingPageMetaResolver {\n  constructor(\n    protected activatedRoutesService: ActivatedRoutesService,\n    protected injector: Injector\n  ) {}\n\n  /**\n   * Array of activated routes, excluding the special Angular `root` route.\n   */\n  protected readonly routes$ = this.activatedRoutesService.routes$.pipe(\n    // drop the first route - the special `root` route:\n    map((routes) => (routes = routes.slice(1, routes.length)))\n  );\n\n  /**\n   * Array of activated routes together with precalculated extras:\n   *\n   * - route's page meta resolver\n   * - route's absolute string URL\n   *\n   * In case when there is no page meta resolver configured for a specific route,\n   * it inherits its parent's resolver.\n   *\n   * When there is no page meta resolver configured for the highest parent in the hierarchy,\n   * it uses the `DefaultRoutePageMetaResolver`.\n   */\n  protected readonly routesWithExtras$: Observable<\n    RouteWithExtras[]\n  > = this.routes$.pipe(\n    map((routes) =>\n      routes.reduce<RouteWithExtras[]>((results, route) => {\n        const parent = results.length\n          ? results[results.length - 1]\n          : {\n              route: null,\n              resolver: this.injector.get(DefaultRoutePageMetaResolver),\n              url: '',\n            };\n\n        const resolver = this.getResolver(route) ?? parent.resolver; // fallback to parent's resolver\n\n        const urlPart = this.getUrlPart(route);\n        const url = parent.url + (urlPart ? `/${urlPart}` : ''); // don't add slash for a route with path '', to avoid double slash ...//...\n\n        return results.concat({ route, resolver, url });\n      }, [])\n    ),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n\n  /**\n   * Array of breadcrumbs defined for all the activated routes (from the root route to the leaf route).\n   * It emits on every completed routing navigation.\n   */\n  resolveBreadcrumbs(\n    options?: RoutingResolveBreadcrumbsOptions\n  ): Observable<BreadcrumbMeta[]> {\n    return this.routesWithExtras$.pipe(\n      map((routesWithExtras) =>\n        options?.includeCurrentRoute\n          ? routesWithExtras\n          : this.trimCurrentRoute(routesWithExtras)\n      ),\n      switchMap((routesWithExtras) =>\n        routesWithExtras.length\n          ? combineLatest(\n              routesWithExtras.map((routeWithExtras) =>\n                this.resolveRouteBreadcrumb(routeWithExtras)\n              )\n            )\n          : of([])\n      ),\n      map((breadcrumbArrays) => breadcrumbArrays.flat())\n    );\n  }\n\n  /**\n   * Returns the instance of the RoutePageMetaResolver configured for the given activated route.\n   * Returns null in case there the resolver can't be injected or is undefined.\n   *\n   * @param route route to resolve\n   */\n  protected getResolver(route: ActivatedRouteSnapshotWithPageMeta): any {\n    const pageMetaConfig = this.getPageMetaConfig(route);\n\n    if (typeof pageMetaConfig !== 'string' && pageMetaConfig?.resolver) {\n      return this.injector.get(pageMetaConfig.resolver, null);\n    }\n    return null;\n  }\n\n  /**\n   * Resolvers breadcrumb for a specific route\n   */\n  protected resolveRouteBreadcrumb({\n    route,\n    resolver,\n    url,\n  }: RouteWithExtras): Observable<BreadcrumbMeta[]> {\n    const breadcrumbResolver = resolver as RouteBreadcrumbResolver;\n\n    if (typeof breadcrumbResolver.resolveBreadcrumbs === 'function') {\n      return breadcrumbResolver.resolveBreadcrumbs({\n        route,\n        url,\n        pageMetaConfig: this.getPageMetaConfig(route),\n      });\n    }\n    return of([]);\n  }\n\n  /**\n   * By default in breadcrumbs list we don't want to show a link to the current page, so this function\n   * trims the last breadcrumb (the breadcrumb of the current route).\n   *\n   * This function also handles special case when the current route has a configured empty path ('' route).\n   * The '' routes are often a _technical_ routes to organize other routes, assign common guards for its children, etc.\n   * It shouldn't happen that '' route has a defined breadcrumb config.\n   *\n   * In that case, we trim not only the last route ('' route), but also its parent route with non-empty path\n   * (which likely defines the breadcrumb config).\n   */\n  private trimCurrentRoute(\n    routesWithExtras: RouteWithExtras[]\n  ): RouteWithExtras[] {\n    // If the last route is '', we trim:\n    // - the '' route\n    // - all parent '' routes (until we meet route with non-empty path)\n\n    let i = routesWithExtras.length - 1;\n    while (routesWithExtras[i]?.route?.url.length === 0 && i >= 0) {\n      i--;\n    }\n\n    // Finally we trim the last route (the one with non-empty path)\n    return routesWithExtras.slice(0, i);\n  }\n\n  /**\n   * Returns the URL path for the given activated route in a string format.\n   * (ActivatedRouteSnapshot#url contains an array of `UrlSegment`s, not a string)\n   */\n  private getUrlPart(route: ActivatedRouteSnapshot): string {\n    return route.url.map((urlSegment) => urlSegment.path).join('/');\n  }\n\n  /**\n   * Returns the breadcrumb config placed in the route's `data` configuration.\n   */\n  protected getPageMetaConfig(\n    route: ActivatedRouteSnapshotWithPageMeta\n  ): RoutePageMetaConfig {\n    // Note: we use `route.routeConfig.data` (not `route.data`) to save us from\n    // an edge case bug. In Angular, by design the `data` of ActivatedRoute is inherited\n    // from the parent route, if only the child has an empty path ''.\n    // But in any case we don't want the page meta configs to be inherited, so we\n    // read data from the original `routeConfig` which is static.\n    //\n    // Note: we may inherit the parent's page meta resolver in case we don't define it,\n    // but we don't want to inherit parent's page meta config!\n    return route?.routeConfig?.data?.cxPageMeta;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, defer, Observable } from 'rxjs';\nimport { filter, map, shareReplay } from 'rxjs/operators';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { CmsService } from '../facade/cms.service';\nimport { BreadcrumbMeta, Page } from '../model/page.model';\nimport { PageMetaResolver } from './page-meta.resolver';\nimport { PageBreadcrumbResolver, PageTitleResolver } from './page.resolvers';\nimport { RoutingPageMetaResolver } from './routing/routing-page-meta.resolver';\n\n/**\n * Resolves the page data for all Content Pages based on the `PageType.CONTENT_PAGE`.\n * More specific resolvers for content pages can be implemented by making them more\n * specific, for example by using the page template (see `CartPageMetaResolver`).\n *\n * The page title, and breadcrumbs are resolved in this implementation only.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ContentPageMetaResolver\n  extends PageMetaResolver\n  implements PageTitleResolver, PageBreadcrumbResolver {\n  /** helper to provide access to the current CMS page */\n  protected cms$: Observable<Page> = this.cms\n    .getCurrentPage()\n    .pipe(filter((p) => Boolean(p)));\n\n  /**\n   * Breadcrumb for the home page.\n   */\n  protected homeBreadcrumb$: Observable<\n    BreadcrumbMeta[]\n  > = this.translation\n    .translate('common.home')\n    .pipe(map((label) => [{ label: label, link: '/' }] as BreadcrumbMeta[]));\n\n  /**\n   * All the resolved breadcrumbs (including those from Angular child routes).\n   */\n  private breadcrumbs$: Observable<BreadcrumbMeta[]> = combineLatest([\n    this.homeBreadcrumb$,\n    defer(() => this.routingPageMetaResolver.resolveBreadcrumbs()),\n  ]).pipe(\n    map(\n      (breadcrumbs) => breadcrumbs.flat(),\n      shareReplay({ bufferSize: 1, refCount: true })\n    )\n  );\n\n  constructor(\n    protected cms: CmsService,\n    protected translation: TranslationService,\n    protected routingPageMetaResolver: RoutingPageMetaResolver\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n  }\n\n  /**\n   * Resolves the page title for the ContentPage by taking the title\n   * from the backend data.\n   */\n  resolveTitle(): Observable<string> {\n    return this.cms$.pipe(map((p) => p.title));\n  }\n\n  /**\n   * Resolves a single breadcrumb item to the home page for each `ContentPage`.\n   * The home page label is resolved from the translation service.\n   */\n  resolveBreadcrumbs(): Observable<BreadcrumbMeta[]> {\n    return this.breadcrumbs$;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { PageMetaResolver } from './page-meta.resolver';\nimport { ContentPageMetaResolver } from './content-page-meta.resolver';\n\n@NgModule({\n  providers: [\n    {\n      provide: PageMetaResolver,\n      useExisting: ContentPageMetaResolver,\n      multi: true,\n    },\n  ],\n})\nexport class CmsPageTitleModule {}\n","import { Observable, OperatorFunction, SchedulerLike } from 'rxjs';\nimport { debounceTime, map, tap } from 'rxjs/operators';\n\nexport function bufferDebounceTime<T>(\n  time: number = 0,\n  scheduler?: SchedulerLike\n): OperatorFunction<T, T[]> {\n  return (source: Observable<T>) => {\n    let bufferedValues: T[] = [];\n\n    return source.pipe(\n      tap((value) => bufferedValues.push(value)),\n      debounceTime(time, scheduler),\n      map(() => bufferedValues),\n      tap(() => (bufferedValues = []))\n    );\n  };\n}\n","import { Injectable } from '@angular/core';\nimport { ContentSlotComponentData } from '../model/content-slot-component-data.model';\nimport { CmsConfig } from './cms-config';\nimport { Config } from '../../config/config-tokens';\n\n/**\n * The `CmsPageConfig` is used to build pages by configuration.\n * The interfaces are designed to have a clean configuration for\n * static CMS structure. Ordinary attributes that are not\n * required for configurable pages have been left out and\n * will not be serialized in the adapter logic.\n */\nexport interface CmsPageConfig {\n  /**\n   * When the `ignoreBackend` is set to true, the CMS backend\n   * will not be consumed. This saves network latency and is\n   * useful for commodity commerce pages.\n   * */\n  ignoreBackend?: boolean;\n\n  pageId?: string;\n\n  type?: string;\n\n  /**\n   * The page title is typically used to display the page heading\n   * as well as for the page title tag. The latter is used for browser\n   * navigation as well as SEO and social share platforms.\n   */\n  title?: string;\n\n  /**\n   * the template is used to bind to the layout\n   * configuration and css layout class\n   */\n  template?: string;\n\n  /**\n   * The page slots represent various sections on the page that\n   * can contain components.\n   */\n  slots: { [key: string]: CmsPageSlotConfig };\n}\n\n/**\n * The `CmsPageSlotsConfig` (plural) holds `CmsPageSlotConfig` objects.\n */\nexport interface CmsPageSlotsConfig {\n  [key: string]: CmsPageSlotConfig;\n}\n\n/**\n * The `CmsPageSlotConfig` is a simplified configuration model\n * that can be used to configure slots in static configuration,\n * rather than loading from a backend.\n */\nexport interface CmsPageSlotConfig {\n  componentIds?: string[];\n  properties?: any;\n}\n\n/**\n * The `CmsStructureConfig` is used to build pages in Spartacus by configuration\n * instead of using a backend CMS system. The configuration can be used to build\n * complete pages or parts of a page. The `CmsStructureConfig` is optimized to\n * only require the necessary properties. Adapter logic is applied to serialize\n * the `CmsStructureConfig` into the required UI model.\n */\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class CmsStructureConfig extends CmsConfig {\n  cmsStructure: {\n    components?: { [key: string]: ContentSlotComponentData | any };\n    pages?: CmsPageConfig[];\n    slots?: CmsPageSlotsConfig;\n  };\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport {\n  CmsPageConfig,\n  CmsPageSlotsConfig,\n  CmsStructureConfig,\n} from '../config/cms-structure.config';\nimport { ContentSlotComponentData } from '../model/content-slot-component-data.model';\nimport { CmsStructureModel } from '../model/page.model';\n\n/**\n * Service that provides access to CMS structure from a static\n * configuration or configuration file. This class uses static\n * configuration is designed in async fashion so that configurations\n * can be loaded from a file or stream.\n *\n * The intent of the `CmsStructureConfigService` however is to provide\n * fast loading pages and default cms structure for commodity commerce.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport abstract class CmsStructureConfigService {\n  constructor(protected cmsDataConfig: CmsStructureConfig) {}\n\n  /**\n   * Merge the cms structure to the pageStructure. The page structure\n   * can either hold complete page structures or global structures that\n   * might apply to all pages (such has header coponents).\n   */\n  mergePageStructure(\n    pageId: string,\n    pageStructure: CmsStructureModel\n  ): Observable<CmsStructureModel> {\n    return this.mergePage(pageId, pageStructure).pipe(\n      switchMap((page) => this.mergeSlots(page))\n    );\n  }\n\n  /**\n   *\n   * Returns boolean observable to indicate whether the page should not be\n   * loaded from the backend. This is useful for pages which are comoditized\n   * and follow best practice.\n   *\n   * By default, configurable pages are driven by static configuration,\n   * in order to allow for fast loading pages (preventing network delays).\n   */\n  shouldIgnoreBackend(pageId: string): Observable<boolean> {\n    return this.getPageFromConfig(pageId).pipe(\n      map((page) => !!page && !!page.ignoreBackend)\n    );\n  }\n\n  /**\n   * returns an Observable component data from the static configuration.\n   */\n  getComponentFromConfig(\n    componentId: string\n  ): Observable<ContentSlotComponentData | any> {\n    return of(this.getComponentById(componentId));\n  }\n\n  /**\n   * returns an Observable components data from the static configuration.\n   */\n  getComponentsFromConfig(\n    ids: string[]\n  ): Observable<ContentSlotComponentData[]> {\n    return of(ids.map((id) => this.getComponentById(id)));\n  }\n\n  /**\n   * returns an observable with the `PageConfig`.\n   */\n  protected getPageFromConfig(pageId: string): Observable<CmsPageConfig> {\n    return of(\n      this.cmsDataConfig.cmsStructure && this.cmsDataConfig.cmsStructure.pages\n        ? this.cmsDataConfig.cmsStructure.pages.find((p) => p.pageId === pageId)\n        : null\n    );\n  }\n\n  /**\n   * Merge page data from the configuration into the given structure, if any.\n   * If the given page structure is empty, a page is created and the page slots are\n   * are merged into the page.\n   */\n  protected mergePage(\n    pageId: string,\n    pageStructure: CmsStructureModel\n  ): Observable<CmsStructureModel> {\n    return this.getPageFromConfig(pageId).pipe(\n      switchMap((page) => {\n        if (page) {\n          // serialize page data\n          if (!pageStructure.page) {\n            pageStructure.page = {\n              ...page,\n            };\n            pageStructure.page.slots = {};\n          }\n          if (!pageStructure.page.slots) {\n            pageStructure.page.slots = {};\n          }\n          return this.mergeSlots(pageStructure, page.slots);\n        } else {\n          return of(pageStructure);\n        }\n      })\n    );\n  }\n\n  /**\n   * Adds any pre-configured slots for pages that do not use them.\n   * If pages have a slot for the given position, the configiuration\n   * is ingored. Even if the slot does not have inner structure (such as\n   * components), so that the cms structure is able to override the (static)\n   * configuration.\n   */\n  protected mergeSlots(\n    pageStructure: CmsStructureModel,\n    slots?: CmsPageSlotsConfig\n  ): Observable<CmsStructureModel> {\n    // if no slots have been given, we use the global configured slots\n    if (\n      !slots &&\n      this.cmsDataConfig.cmsStructure &&\n      this.cmsDataConfig.cmsStructure.slots\n    ) {\n      slots = this.cmsDataConfig.cmsStructure.slots;\n    }\n\n    if (!slots) {\n      return of(pageStructure);\n    }\n\n    for (const position of Object.keys(slots)) {\n      if (!Object.keys(pageStructure.page.slots).includes(position)) {\n        // the global slot isn't yet part of the page structure\n        pageStructure.page.slots[position] = {};\n\n        for (const component of this.getComponentsByPosition(slots, position)) {\n          if (!pageStructure.page.slots[position].components) {\n            pageStructure.page.slots[position].components = [];\n          }\n          pageStructure.page.slots[position].components.push({\n            uid: component.uid,\n            flexType: component.flexType,\n            typeCode: component.typeCode,\n          });\n          if (!pageStructure.components) {\n            pageStructure.components = [];\n          }\n\n          pageStructure.components.push(component);\n        }\n      }\n    }\n\n    return of(pageStructure);\n  }\n\n  protected getComponentsByPosition(\n    slots: CmsPageSlotsConfig,\n    position: string\n  ): ContentSlotComponentData[] {\n    const components = [];\n    if (slots[position] && slots[position].componentIds) {\n      for (const componentId of slots[position].componentIds) {\n        if (\n          this.cmsDataConfig.cmsStructure &&\n          this.cmsDataConfig.cmsStructure.components\n        ) {\n          const component = this.cmsDataConfig.cmsStructure.components[\n            componentId\n          ];\n          if (component) {\n            components.push({ uid: componentId, ...component });\n          }\n        }\n      }\n    }\n    return components;\n  }\n\n  protected getComponentById(componentId: string): ContentSlotComponentData {\n    return this.cmsDataConfig.cmsStructure &&\n      this.cmsDataConfig.cmsStructure.components\n      ? this.cmsDataConfig.cmsStructure.components[componentId]\n      : undefined;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { OccConfig } from '../../../occ/config/occ-config';\nimport { PageContext } from '../../../routing/models/page-context.model';\nimport { CmsStructureConfigService } from '../../services/cms-structure-config.service';\nimport { CmsComponentAdapter } from './cms-component.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CmsComponentConnector {\n  constructor(\n    protected cmsStructureConfigService: CmsStructureConfigService,\n    protected cmsComponentAdapter: CmsComponentAdapter,\n    protected config: OccConfig\n  ) {}\n\n  get<T extends CmsComponent>(\n    id: string,\n    pageContext: PageContext\n  ): Observable<T> {\n    return this.cmsStructureConfigService\n      .getComponentFromConfig(id)\n      .pipe(\n        switchMap((configuredComponent) =>\n          configuredComponent\n            ? of(configuredComponent)\n            : this.cmsComponentAdapter.load(id, pageContext)\n        )\n      );\n  }\n\n  getList(ids: string[], pageContext: PageContext): Observable<CmsComponent[]> {\n    return this.cmsStructureConfigService.getComponentsFromConfig(ids).pipe(\n      switchMap((configuredComponents) => {\n        // check if we have some components that are not loaded from configuration\n        const missingIds = configuredComponents.reduce(\n          (acc, component, index) => {\n            if (component === undefined) {\n              acc.push(ids[index]);\n            }\n            return acc;\n          },\n          []\n        );\n\n        if (missingIds.length > 0) {\n          return this.cmsComponentAdapter\n            .findComponentsByIds(missingIds, pageContext)\n            .pipe(\n              map((loadedComponents) => [\n                ...configuredComponents.filter(Boolean),\n                ...loadedComponents,\n              ])\n            );\n        } else {\n          return of(configuredComponents);\n        }\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, createEffect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { from, Observable } from 'rxjs';\nimport { catchError, groupBy, mergeMap, switchMap } from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/user-auth/store/actions/index';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing/index';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { bufferDebounceTime } from '../../../util/rxjs/buffer-debounce-time';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { withdrawOn } from '../../../util/rxjs/withdraw-on';\nimport { CmsComponentConnector } from '../../connectors/component/cms-component.connector';\nimport { serializePageContext } from '../../utils/cms-utils';\nimport { CmsActions } from '../actions/index';\n\n@Injectable()\nexport class ComponentsEffects {\n  constructor(\n    private actions$: Actions,\n    private cmsComponentConnector: CmsComponentConnector\n  ) {}\n\n  private contextChange$: Observable<Action> = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      AuthActions.LOGOUT,\n      AuthActions.LOGIN\n    )\n  );\n\n  loadComponent$ = createEffect(\n    () => ({ scheduler, debounce = 0 } = {}): Observable<\n      | CmsActions.LoadCmsComponentSuccess<CmsComponent>\n      | CmsActions.LoadCmsComponentFail\n    > =>\n      this.actions$.pipe(\n        ofType<CmsActions.LoadCmsComponent>(CmsActions.LOAD_CMS_COMPONENT),\n        groupBy((actions) => serializePageContext(actions.payload.pageContext)),\n        mergeMap((actionGroup) =>\n          actionGroup.pipe(\n            bufferDebounceTime(debounce, scheduler),\n            mergeMap((actions) =>\n              this.loadComponentsEffect(\n                actions.map((action) => action.payload.uid),\n                actions[0].payload.pageContext\n              )\n            )\n          )\n        ),\n        withdrawOn(this.contextChange$)\n      )\n  );\n\n  private loadComponentsEffect(\n    componentUids: string[],\n    pageContext: PageContext\n  ): Observable<\n    | CmsActions.LoadCmsComponentSuccess<CmsComponent>\n    | CmsActions.LoadCmsComponentFail\n  > {\n    return this.cmsComponentConnector.getList(componentUids, pageContext).pipe(\n      switchMap((components) => {\n        const actions: (\n          | CmsActions.LoadCmsComponentSuccess<CmsComponent>\n          | CmsActions.LoadCmsComponentFail\n        )[] = [];\n        const uidsLeft = new Set<string>(componentUids);\n        for (const component of components) {\n          actions.push(\n            new CmsActions.LoadCmsComponentSuccess({\n              component,\n              uid: component.uid,\n              pageContext,\n            })\n          );\n          uidsLeft.delete(component.uid);\n        }\n        // we have to emit LoadCmsComponentFail for all component's uids that\n        // are missing from the response\n        uidsLeft.forEach((uid) => {\n          actions.push(\n            new CmsActions.LoadCmsComponentFail({\n              uid,\n              pageContext,\n            })\n          );\n        });\n        return from(actions);\n      }),\n      catchError((error) =>\n        from(\n          componentUids.map(\n            (uid) =>\n              new CmsActions.LoadCmsComponentFail({\n                uid,\n                error: makeErrorSerializable(error),\n                pageContext,\n              })\n          )\n        )\n      )\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, filter, map, mergeMap, take } from 'rxjs/operators';\nimport { RoutingService } from '../../../routing/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CmsComponentConnector } from '../../connectors/component/cms-component.connector';\nimport { CmsActions } from '../actions/index';\n\n@Injectable()\nexport class NavigationEntryItemEffects {\n  @Effect()\n  loadNavigationItems$: Observable<\n    | CmsActions.LoadCmsNavigationItemsSuccess\n    | CmsActions.LoadCmsNavigationItemsFail\n  > = this.actions$.pipe(\n    ofType(CmsActions.LOAD_CMS_NAVIGATION_ITEMS),\n    map((action: CmsActions.LoadCmsNavigationItems) => action.payload),\n    map((payload) => {\n      return {\n        ids: this.getIdListByItemType(payload.items),\n        nodeId: payload.nodeId,\n      };\n    }),\n    mergeMap((data) => {\n      if (data.ids.componentIds.length > 0) {\n        return this.routingService.getRouterState().pipe(\n          filter((routerState) => routerState !== undefined),\n          map((routerState) => routerState.state.context),\n          take(1),\n          mergeMap((pageContext) =>\n            // download all items in one request\n            this.cmsComponentConnector\n              .getList(data.ids.componentIds, pageContext)\n              .pipe(\n                map(\n                  (components) =>\n                    new CmsActions.LoadCmsNavigationItemsSuccess({\n                      nodeId: data.nodeId,\n                      components: components,\n                    })\n                ),\n                catchError((error) =>\n                  of(\n                    new CmsActions.LoadCmsNavigationItemsFail(\n                      data.nodeId,\n                      makeErrorSerializable(error)\n                    )\n                  )\n                )\n              )\n          )\n        );\n      } else if (data.ids.pageIds.length > 0) {\n        // TODO: future work\n        // dispatch action to load cms page one by one\n      } else if (data.ids.mediaIds.length > 0) {\n        // TODO: future work\n        // send request to get list of media\n      } else {\n        return of(\n          new CmsActions.LoadCmsNavigationItemsFail(\n            data.nodeId,\n            'navigation nodes are empty'\n          )\n        );\n      }\n    })\n  );\n\n  // We only consider 3 item types: cms page, cms component, and media.\n  getIdListByItemType(\n    itemList: any[]\n  ): { pageIds: string[]; componentIds: string[]; mediaIds: string[] } {\n    const pageIds: string[] = [];\n    const componentIds: string[] = [];\n    const mediaIds: string[] = [];\n\n    itemList.forEach((item) => {\n      if (item.superType === 'AbstractCMSComponent') {\n        componentIds.push(item.id);\n      } else if (item.superType === 'AbstractPage') {\n        pageIds.push(item.id);\n      } else if (item.superType === 'AbstractMedia') {\n        mediaIds.push(item.id);\n      }\n    });\n    return { pageIds: pageIds, componentIds: componentIds, mediaIds: mediaIds };\n  }\n\n  constructor(\n    private actions$: Actions,\n    private cmsComponentConnector: CmsComponentConnector,\n    private routingService: RoutingService\n  ) {}\n}\n","import { HttpErrorResponse } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError, switchMap } from 'rxjs/operators';\nimport { PageContext } from '../../../routing/models/page-context.model';\nimport { CmsStructureModel } from '../../model/page.model';\nimport { CmsStructureConfigService } from '../../services/cms-structure-config.service';\nimport { CmsPageAdapter } from './cms-page.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CmsPageConnector {\n  constructor(\n    protected cmsPageAdapter: CmsPageAdapter,\n    protected cmsStructureConfigService: CmsStructureConfigService\n  ) {}\n\n  /**\n   * Returns an observable with the page structure. The page structure is\n   * typically loaded from a backend, but can also be returned from static\n   * configuration (see `CmsStructureConfigService`).\n   */\n  get(pageContext: PageContext): Observable<CmsStructureModel> {\n    return this.cmsStructureConfigService\n      .shouldIgnoreBackend(pageContext.id)\n      .pipe(\n        switchMap((loadFromConfig) => {\n          if (!loadFromConfig) {\n            return this.cmsPageAdapter.load(pageContext).pipe(\n              catchError((error) => {\n                if (\n                  error instanceof HttpErrorResponse &&\n                  error.status === 400\n                ) {\n                  return of({});\n                } else {\n                  return throwError(error);\n                }\n              })\n            );\n          } else {\n            return of({});\n          }\n        }),\n        switchMap((page) => this.mergeDefaultPageStructure(pageContext, page))\n      );\n  }\n\n  /**\n   *\n   * Merge default page structure to the given `CmsStructureModel`.\n   * This is beneficial for a fast setup of the UI without necessary\n   * fine-grained CMS setup.\n   */\n  private mergeDefaultPageStructure(\n    pageContext: PageContext,\n    pageStructure: CmsStructureModel\n  ): Observable<CmsStructureModel> {\n    return this.cmsStructureConfigService.mergePageStructure(\n      pageContext.id,\n      pageStructure\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport {\n  catchError,\n  filter,\n  groupBy,\n  map,\n  mergeMap,\n  switchMap,\n  take,\n} from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/user-auth/store/actions/index';\nimport { RoutingService } from '../../../routing/index';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CmsPageConnector } from '../../connectors/page/cms-page.connector';\nimport { CmsStructureModel } from '../../model/page.model';\nimport { serializePageContext } from '../../utils/cms-utils';\nimport { CmsActions } from '../actions/index';\n\n@Injectable()\nexport class PageEffects {\n  @Effect()\n  refreshPage$: Observable<Action> = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      AuthActions.LOGOUT,\n      AuthActions.LOGIN\n    ),\n    switchMap(() =>\n      this.routingService.getRouterState().pipe(\n        filter(\n          (routerState) =>\n            routerState &&\n            routerState.state &&\n            routerState.state.cmsRequired &&\n            !routerState.nextState\n        ),\n        take(1),\n        map((routerState) => routerState.state.context),\n        mergeMap((context) => of(new CmsActions.LoadCmsPageData(context)))\n      )\n    )\n  );\n\n  @Effect()\n  loadPageData$: Observable<Action> = this.actions$.pipe(\n    ofType(CmsActions.LOAD_CMS_PAGE_DATA),\n    map((action: CmsActions.LoadCmsPageData) => action.payload),\n    groupBy((pageContext) => serializePageContext(pageContext)),\n    mergeMap((group) =>\n      group.pipe(\n        switchMap((pageContext) =>\n          this.cmsPageConnector.get(pageContext).pipe(\n            mergeMap((cmsStructure: CmsStructureModel) => {\n              const actions: Action[] = [\n                new CmsActions.CmsGetComponentFromPage(\n                  cmsStructure.components.map((component) => ({\n                    component,\n                    pageContext,\n                  }))\n                ),\n                new CmsActions.LoadCmsPageDataSuccess(\n                  pageContext,\n                  cmsStructure.page\n                ),\n              ];\n\n              const pageLabel = cmsStructure.page.label;\n              // For content pages the page label returned from backend can be different than page ID initially assumed from route.\n              // In such a case let's save the success response not only for initially assumed page ID, but also for correct page label.\n              if (pageLabel && pageLabel !== pageContext.id) {\n                actions.unshift(\n                  new CmsActions.CmsSetPageSuccessIndex(\n                    { id: pageLabel, type: pageContext.type },\n                    cmsStructure.page\n                  )\n                );\n              }\n\n              return actions;\n            }),\n            catchError((error) =>\n              of(\n                new CmsActions.LoadCmsPageDataFail(\n                  pageContext,\n                  makeErrorSerializable(error)\n                )\n              )\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cmsPageConnector: CmsPageConnector,\n    private routingService: RoutingService\n  ) {}\n}\n","import { ComponentsEffects } from './components.effect';\nimport { NavigationEntryItemEffects } from './navigation-entry-item.effect';\nimport { PageEffects } from './page.effect';\n\nexport const effects: any[] = [\n  PageEffects,\n  ComponentsEffects,\n  NavigationEntryItemEffects,\n];\n\nexport * from './components.effect';\nexport * from './navigation-entry-item.effect';\nexport * from './page.effect';\n","import { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport { serializePageContext } from '../../utils/cms-utils';\nimport { CmsActions } from '../actions/index';\nimport { ComponentsContext } from '../cms-state';\n\nexport const initialState: ComponentsContext = {\n  component: undefined,\n  pageContext: {},\n};\n\nfunction componentExistsReducer<T>(\n  state: boolean | undefined,\n  action: CmsActions.CmsComponentAction<T>\n): boolean {\n  switch (action.type) {\n    case CmsActions.LOAD_CMS_COMPONENT_FAIL:\n      return false;\n\n    case CmsActions.CMS_GET_COMPONENT_FROM_PAGE:\n    case CmsActions.LOAD_CMS_COMPONENT_SUCCESS:\n      return true;\n  }\n  return state;\n}\n\nexport function reducer<T>(\n  state = initialState,\n  action: CmsActions.CmsComponentAction<T>\n): ComponentsContext {\n  switch (action.type) {\n    case CmsActions.LOAD_CMS_COMPONENT: {\n      const pageContextReducer = loaderReducer<boolean>(\n        action.meta.entityType,\n        componentExistsReducer\n      );\n      const context = serializePageContext(action.payload.pageContext, true);\n      return {\n        ...state,\n        pageContext: {\n          ...state.pageContext,\n          [context]: pageContextReducer(state.pageContext[context], action),\n        },\n      };\n    }\n    case CmsActions.LOAD_CMS_COMPONENT_FAIL: {\n      const pageContextReducer = loaderReducer<boolean>(\n        action.meta.entityType,\n        componentExistsReducer\n      );\n      const context = serializePageContext(action.payload.pageContext, true);\n      return {\n        ...state,\n        pageContext: {\n          ...state.pageContext,\n          [context]: pageContextReducer(state.pageContext[context], action),\n        },\n      };\n    }\n    case CmsActions.LOAD_CMS_COMPONENT_SUCCESS: {\n      const pageContextReducer = loaderReducer<boolean>(\n        action.meta.entityType,\n        componentExistsReducer\n      );\n      const context = serializePageContext(action.payload.pageContext, true);\n      return {\n        ...state,\n        component: action.payload.component as T,\n        pageContext: {\n          ...state.pageContext,\n          [context]: pageContextReducer(state.pageContext[context], action),\n        },\n      };\n    }\n    case CmsActions.CMS_GET_COMPONENT_FROM_PAGE: {\n      const pageContextReducer = loaderReducer<boolean>(\n        action.meta.entityType,\n        componentExistsReducer\n      );\n      if (!Array.isArray(action.payload)) {\n        const context = serializePageContext(action.payload.pageContext, true);\n        return {\n          ...state,\n          component: action.payload.component as T,\n          pageContext: {\n            ...state.pageContext,\n            [context]: pageContextReducer(state.pageContext[context], action),\n          },\n        };\n      }\n    }\n  }\n  return state;\n}\n","import { NodeItem } from '../../model/node-item.model';\nimport { CmsActions } from '../actions/index';\n\nexport const initialState: NodeItem = undefined;\n\nexport function reducer(\n  state = initialState,\n  action: CmsActions.CmsNavigationEntryItemAction\n): NodeItem {\n  switch (action.type) {\n    case CmsActions.LOAD_CMS_NAVIGATION_ITEMS_SUCCESS: {\n      if (action.payload.components) {\n        const components = action.payload.components;\n        const newItem: NodeItem = components.reduce(\n          (compItems: { [uid_type: string]: any }, component: any) => {\n            return {\n              ...compItems,\n              [`${component.uid}_AbstractCMSComponent`]: component,\n            };\n          },\n          {\n            ...{},\n          }\n        );\n\n        return {\n          ...state,\n          ...newItem,\n        };\n      }\n    }\n  }\n\n  return state;\n}\n","import { EntityState } from '../../../state/utils/entity/entity-state';\nimport { Page } from '../../model/page.model';\nimport { CmsActions } from '../actions/index';\n\nexport const initialState: EntityState<Page> = { entities: {} };\n\nexport function reducer(\n  state = initialState,\n  action: CmsActions.LoadCmsPageDataSuccess\n): EntityState<Page> {\n  switch (action.type) {\n    case CmsActions.LOAD_CMS_PAGE_DATA_SUCCESS: {\n      const page: Page = action.payload;\n      return { ...state, entities: { ...state.entities, [page.pageId]: page } };\n    }\n  }\n  return state;\n}\n","import { CmsActions } from '../actions/index';\n\nexport const initialState = undefined;\n\nexport function reducer(\n  entityType: string\n): (\n  state: string,\n  action:\n    | CmsActions.LoadCmsPageDataSuccess\n    | CmsActions.LoadCmsPageDataFail\n    | CmsActions.CmsSetPageFailIndex\n) => string {\n  return (\n    state = initialState,\n    action:\n      | CmsActions.LoadCmsPageDataSuccess\n      | CmsActions.LoadCmsPageDataFail\n      | CmsActions.CmsSetPageSuccessIndex\n      | CmsActions.CmsSetPageFailIndex\n  ): string => {\n    if (action.meta && action.meta.entityType === entityType) {\n      switch (action.type) {\n        case CmsActions.LOAD_CMS_PAGE_DATA_SUCCESS: {\n          return action.payload.pageId;\n        }\n\n        case CmsActions.LOAD_CMS_PAGE_DATA_FAIL: {\n          return initialState;\n        }\n\n        case CmsActions.CMS_SET_PAGE_FAIL_INDEX: {\n          return action.payload;\n        }\n\n        case CmsActions.CMS_SET_PAGE_SUCCESS_INDEX: {\n          return action.payload.pageId;\n        }\n      }\n    }\n    return state;\n  };\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  Action,\n  ActionReducer,\n  ActionReducerMap,\n  combineReducers,\n  MetaReducer,\n} from '@ngrx/store';\nimport { AuthActions } from '../../../auth/user-auth/store/actions/index';\nimport { PageType } from '../../../model/cms.model';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { entityLoaderReducer } from '../../../state/utils/entity-loader/entity-loader.reducer';\nimport { entityReducer } from '../../../state/utils/entity/entity.reducer';\nimport { NodeItem } from '../../model/node-item.model';\nimport {\n  CmsState,\n  COMPONENT_ENTITY,\n  NAVIGATION_DETAIL_ENTITY,\n  StateWithCms,\n} from '../cms-state';\nimport * as fromComponentsReducer from './components.reducer';\nimport * as fromNavigation from './navigation-entry-item.reducer';\nimport * as fromPageReducer from './page-data.reducer';\nimport * as fromPageIndexReducer from './page-index.reducer';\n\nexport function getReducers(): ActionReducerMap<CmsState> {\n  return {\n    page: combineReducers({\n      pageData: fromPageReducer.reducer,\n      index: combineReducers({\n        content: entityLoaderReducer<string>(\n          PageType.CONTENT_PAGE,\n          fromPageIndexReducer.reducer(PageType.CONTENT_PAGE)\n        ),\n        product: entityLoaderReducer<string>(\n          PageType.PRODUCT_PAGE,\n          fromPageIndexReducer.reducer(PageType.PRODUCT_PAGE)\n        ),\n        category: entityLoaderReducer<string>(\n          PageType.CATEGORY_PAGE,\n          fromPageIndexReducer.reducer(PageType.CATEGORY_PAGE)\n        ),\n        catalog: entityLoaderReducer<string>(\n          PageType.CATALOG_PAGE,\n          fromPageIndexReducer.reducer(PageType.CATALOG_PAGE)\n        ),\n      }),\n    }),\n    components: entityReducer(COMPONENT_ENTITY, fromComponentsReducer.reducer),\n    navigation: entityLoaderReducer<NodeItem>(\n      NAVIGATION_DETAIL_ENTITY,\n      fromNavigation.reducer\n    ),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  CmsState\n>> = new InjectionToken<ActionReducerMap<CmsState>>('CmsReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearCmsState(\n  reducer: ActionReducer<StateWithCms, Action>\n): ActionReducer<StateWithCms, Action> {\n  return function (state, action) {\n    if (\n      action.type === SiteContextActions.LANGUAGE_CHANGE ||\n      action.type === AuthActions.LOGOUT ||\n      action.type === AuthActions.LOGIN\n    ) {\n      state = undefined;\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<StateWithCms>[] = [clearCmsState];\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport {\n  StateConfig,\n  StateTransferType,\n} from '../../state/config/state-config';\nimport { StateModule } from '../../state/state.module';\nimport { CMS_FEATURE } from './cms-state';\nimport { effects } from './effects/index';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\nimport { provideDefaultConfigFactory } from '../../config/config-providers';\n\nexport function cmsStoreConfigFactory(): StateConfig {\n  // if we want to reuse CMS_FEATURE const in config, we have to use factory instead of plain object\n  const config: StateConfig = {\n    state: {\n      ssrTransfer: {\n        keys: { [CMS_FEATURE]: StateTransferType.TRANSFER_STATE },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    StateModule,\n    StoreModule.forFeature(CMS_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(cmsStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class CmsStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { defaultCmsModuleConfig } from './config/default-cms-config';\nimport { CmsService } from './facade/cms.service';\nimport { CmsPageTitleModule } from './page/page.module';\nimport { CmsStoreModule } from './store/cms-store.module';\nimport { provideDefaultConfig } from '../config/config-providers';\n\n@NgModule({\n  imports: [CmsStoreModule, CmsPageTitleModule],\n})\nexport class CmsModule {\n  static forRoot(): ModuleWithProviders<CmsModule> {\n    return {\n      ngModule: CmsModule,\n      providers: [CmsService, provideDefaultConfig(defaultCmsModuleConfig)],\n    };\n  }\n}\n","import { asapScheduler, combineLatest, defer, Observable } from 'rxjs';\nimport { audit } from 'rxjs/operators';\n\ntype ReturnTypes<T extends Observable<any>[]> = {\n  [P in keyof T]: T[P] extends Observable<infer R> ? R : never;\n};\ntype Observables = [Observable<any>] | Observable<any>[];\n\n/**\n * uniteLatest is an alternative to combineLatest. The first emission is\n * emitted synchronously (just like combineLatest) and all following emissions\n * are audited and emitted using asapScheduler.\n *\n * It effectively smooths out emissions when multiple sources will emit at the\n * same time: uniteLatest will have only one emission, where combine latest will\n * have more than one (one per source changed).\n *\n * @param sources\n */\nexport function uniteLatest<R extends Observables>(\n  sources: R\n): Observable<ReturnTypes<R>> {\n  return defer(() => {\n    let subNo = 0;\n    const trigger = new Observable((subscriber) => {\n      const action = () => {\n        subscriber.next();\n        subscriber.complete();\n      };\n\n      if (subNo) {\n        asapScheduler.schedule(action);\n      } else {\n        action();\n      }\n      subNo++;\n    });\n\n    return combineLatest(sources).pipe(audit(() => trigger));\n  }) as any;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { filter, map, shareReplay, switchMap } from 'rxjs/operators';\nimport { resolveApplicable } from '../../util/applicable';\nimport { Page, PageMeta } from '../model/page.model';\nimport { PageMetaResolver } from '../page/page-meta.resolver';\nimport { CmsService } from './cms.service';\nimport { UnifiedInjector } from '../../lazy-loading/unified-injector';\nimport { uniteLatest } from '../../util/rxjs/unite-latest';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class PageMetaService {\n  private resolvers$: Observable<\n    PageMetaResolver[]\n  > = this.unifiedInjector\n    .getMulti(PageMetaResolver)\n    .pipe(shareReplay({ bufferSize: 1, refCount: true })) as Observable<\n    PageMetaResolver[]\n  >;\n\n  constructor(\n    protected cms: CmsService,\n    protected unifiedInjector?: UnifiedInjector\n  ) {}\n  /**\n   * The list of resolver interfaces will be evaluated for the pageResolvers.\n   *\n   * TOOD: optimize browser vs SSR resolvers; image, robots and description\n   *       aren't needed during browsing.\n   * TODO: we can make the list of resolver types configurable\n   */\n  protected resolverMethods: { [key: string]: string } = {\n    title: 'resolveTitle',\n    heading: 'resolveHeading',\n    description: 'resolveDescription',\n    breadcrumbs: 'resolveBreadcrumbs',\n    image: 'resolveImage',\n    robots: 'resolveRobots',\n  };\n\n  getMeta(): Observable<PageMeta | null> {\n    return this.cms.getCurrentPage().pipe(\n      filter(Boolean),\n      switchMap((page: Page) => this.getMetaResolver(page)),\n      switchMap((metaResolver: PageMetaResolver) =>\n        metaResolver ? this.resolve(metaResolver) : of(null)\n      )\n    );\n  }\n\n  /**\n   * If a `PageResolver` has implemented a resolver interface, the resolved data\n   * is merged into the `PageMeta` object.\n   * @param metaResolver\n   */\n  protected resolve(metaResolver: PageMetaResolver): Observable<PageMeta> {\n    const resolveMethods: Observable<PageMeta>[] = Object.keys(\n      this.resolverMethods\n    )\n      .filter((key) => metaResolver[this.resolverMethods[key]])\n      .map((key) =>\n        metaResolver[this.resolverMethods[key]]().pipe(\n          map((data) => ({\n            [key]: data,\n          }))\n        )\n      );\n\n    return uniteLatest(resolveMethods).pipe(\n      map((data) => Object.assign({}, ...data))\n    );\n  }\n\n  /**\n   * Return the resolver with the best match, based on a score\n   * generated by the resolver.\n   *\n   * Resolvers match by default on `PageType` and `page.template`.\n   */\n  protected getMetaResolver(page: Page): Observable<PageMetaResolver> {\n    return this.resolvers$.pipe(\n      map((resolvers) => resolveApplicable(resolvers, [page], [page]))\n    );\n  }\n}\n","import { Injectable, NgZone } from '@angular/core';\nimport { combineLatest } from 'rxjs';\nimport { filter, take, takeWhile } from 'rxjs/operators';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { Page } from '../../cms/model/page.model';\nimport { BaseSite } from '../../model';\nimport { PageType } from '../../model/cms.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { BaseSiteService } from '../../site-context/facade/base-site.service';\nimport { WindowRef } from '../../window/window-ref';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SmartEditService {\n  private _cmsTicketId: string;\n  private isPreviewPage = false;\n  private _currentPageId: string;\n  private _launchedInSmartEdit = false;\n\n  private defaultPreviewProductCode: string;\n  private defaultPreviewCategoryCode: string;\n\n  constructor(\n    protected cmsService: CmsService,\n    protected routingService: RoutingService,\n    protected baseSiteService: BaseSiteService,\n    protected zone: NgZone,\n    protected winRef: WindowRef\n  ) {\n    this.getCmsTicket();\n\n    if (winRef.nativeWindow) {\n      const window = winRef.nativeWindow as any;\n      // rerender components and slots after editing\n      window.smartedit = window.smartedit || {};\n      window.smartedit.renderComponent = (\n        componentId,\n        componentType,\n        parentId\n      ) => {\n        return this.renderComponent(componentId, componentType, parentId);\n      };\n\n      // reprocess page\n      window.smartedit.reprocessPage = this.reprocessPage;\n    }\n  }\n\n  get cmsTicketId(): string {\n    return this._cmsTicketId;\n  }\n\n  protected getCmsTicket() {\n    combineLatest([\n      this.cmsService.getCurrentPage(),\n      this.routingService.getRouterState(),\n    ])\n      .pipe(\n        takeWhile(([cmsPage]) => cmsPage === undefined),\n        filter(([, routerState]) => {\n          if (routerState.nextState && !this._cmsTicketId) {\n            this._cmsTicketId =\n              routerState.nextState.queryParams['cmsTicketId'];\n            if (this._cmsTicketId) {\n              return true;\n            }\n          }\n          return false;\n        }),\n        take(1)\n      )\n      .subscribe(() => {\n        this._launchedInSmartEdit = true;\n        this.getDefaultPreviewCode();\n      });\n  }\n\n  protected getDefaultPreviewCode() {\n    this.baseSiteService\n      .get()\n      .pipe(filter(Boolean), take(1))\n      .subscribe((site: BaseSite) => {\n        this.defaultPreviewCategoryCode = site.defaultPreviewCategoryCode;\n        this.defaultPreviewProductCode = site.defaultPreviewProductCode;\n\n        this.addPageContract();\n      });\n  }\n\n  protected addPageContract() {\n    this.cmsService.getCurrentPage().subscribe((cmsPage) => {\n      if (cmsPage && this._cmsTicketId) {\n        this._currentPageId = cmsPage.pageId;\n\n        // before adding contract to page, we need redirect to that page\n        this.goToPreviewPage(cmsPage);\n\n        // remove old page contract\n        const previousContract = [];\n        Array.from(this.winRef.document.body.classList).forEach((attr) =>\n          previousContract.push(attr)\n        );\n        previousContract.forEach((attr) =>\n          this.winRef.document.body.classList.remove(attr)\n        );\n\n        // add new page contract\n        if (cmsPage.properties && cmsPage.properties.smartedit) {\n          const seClasses = cmsPage.properties.smartedit.classes.split(' ');\n          seClasses.forEach((classItem) => {\n            this.winRef.document.body.classList.add(classItem);\n          });\n        }\n      }\n    });\n  }\n\n  protected goToPreviewPage(cmsPage: Page) {\n    // only the first page is the smartedit preview page\n    if (!this.isPreviewPage) {\n      this.isPreviewPage = true;\n      if (\n        cmsPage.type === PageType.PRODUCT_PAGE &&\n        this.defaultPreviewProductCode\n      ) {\n        this.routingService.go({\n          cxRoute: 'product',\n          params: { code: this.defaultPreviewProductCode, name: '' },\n        });\n      } else if (\n        cmsPage.type === PageType.CATEGORY_PAGE &&\n        this.defaultPreviewCategoryCode\n      ) {\n        this.routingService.go({\n          cxRoute: 'category',\n          params: { code: this.defaultPreviewCategoryCode },\n        });\n      }\n    }\n  }\n\n  protected renderComponent(\n    componentId: string,\n    componentType?: string,\n    parentId?: string\n  ): boolean {\n    if (componentId) {\n      this.zone.run(() => {\n        // without parentId, it is slot\n        if (!parentId) {\n          if (this._currentPageId) {\n            this.cmsService.refreshPageById(this._currentPageId);\n          } else {\n            this.cmsService.refreshLatestPage();\n          }\n        } else if (componentType) {\n          this.cmsService.refreshComponent(componentId);\n        }\n      });\n    }\n\n    return true;\n  }\n\n  protected reprocessPage() {\n    // TODO: reprocess page API\n  }\n\n  /**\n   * Whether the app launched in smart edit\n   */\n  isLaunchedInSmartEdit(): boolean {\n    return this._launchedInSmartEdit;\n  }\n}\n","import { Injectable, Renderer2 } from '@angular/core';\nimport { SmartEditService } from '../../smart-edit/services/smart-edit.service';\nimport { ContentSlotComponentData } from '../model/content-slot-component-data.model';\nimport { ContentSlotData } from '../model/content-slot-data.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class DynamicAttributeService {\n  constructor(protected smartEditService: SmartEditService) {}\n\n  /**\n   * Add dynamic attributes to DOM. These attributes are extracted from the properties of cms items received from backend.\n   * There can by many different groups of properties, one of them is smartedit. But EC allows addons to create different groups.\n   * For example, personalization may add 'script' group etc.\n   * @param element: slot or cms component element\n   * @param renderer\n   * @param cmsRenderingContext: an object containing properties in each cms item response data\n   */\n  addDynamicAttributes(\n    element: Element,\n    renderer: Renderer2,\n    cmsRenderingContext: {\n      componentData?: ContentSlotComponentData;\n      slotData?: ContentSlotData;\n    }\n  ): void {\n    const properties =\n      cmsRenderingContext.componentData?.properties ||\n      cmsRenderingContext.slotData?.properties;\n\n    if (properties && this.smartEditService.isLaunchedInSmartEdit()) {\n      // check each group of properties, e.g. smartedit\n      Object.keys(properties).forEach((group) => {\n        const name = 'data-' + group + '-';\n        const groupProps = properties[group];\n\n        // check each property in the group\n        Object.keys(groupProps).forEach((propName) => {\n          const propValue = groupProps[propName];\n          if (propName === 'classes') {\n            const classes = propValue.split(' ');\n            classes.forEach((classItem) => {\n              element.classList.add(classItem);\n            });\n          } else {\n            renderer.setAttribute(\n              element,\n              name +\n                propName\n                  .split(/(?=[A-Z])/)\n                  .join('-')\n                  .toLowerCase(),\n              propValue\n            );\n          }\n        });\n      });\n    }\n  }\n}\n","import {\n  APP_INITIALIZER,\n  ModuleWithProviders,\n  NgModule,\n  Optional,\n} from '@angular/core';\nimport { ConfigInitializerService } from './config-initializer.service';\nimport {\n  CONFIG_INITIALIZER,\n  CONFIG_INITIALIZER_FORROOT_GUARD,\n  ConfigInitializer,\n} from './config-initializer';\nimport { LOCATION_INITIALIZED } from '@angular/common';\n\nexport function configInitializerFactory(\n  configInitializer: ConfigInitializerService,\n  initializers: ConfigInitializer[]\n) {\n  const isReady = () => configInitializer.initialize(initializers);\n  return isReady;\n}\n\nexport function locationInitializedFactory(\n  configInitializer: ConfigInitializerService\n) {\n  return configInitializer.getStableConfig();\n}\n\n@NgModule({})\nexport class ConfigInitializerModule {\n  static forRoot(): ModuleWithProviders<ConfigInitializerModule> {\n    return {\n      ngModule: ConfigInitializerModule,\n      providers: [\n        {\n          provide: CONFIG_INITIALIZER_FORROOT_GUARD,\n          useValue: true,\n        },\n        {\n          provide: APP_INITIALIZER,\n          multi: true,\n          useFactory: configInitializerFactory,\n          deps: [\n            ConfigInitializerService,\n            [new Optional(), CONFIG_INITIALIZER],\n          ],\n        },\n        {\n          // Hold on the initial navigation until the Spartacus configuration is stable\n          provide: LOCATION_INITIALIZED,\n          useFactory: locationInitializedFactory,\n          deps: [ConfigInitializerService],\n        },\n      ],\n    };\n  }\n}\n","import {\n  APP_INITIALIZER,\n  isDevMode,\n  ModuleWithProviders,\n  NgModule,\n  Optional,\n} from '@angular/core';\nimport { ConfigInitializerService } from '../config-initializer/config-initializer.service';\nimport {\n  ConfigValidator,\n  ConfigValidatorToken,\n  validateConfig,\n} from './config-validator';\n\nexport function configValidatorFactory(\n  configInitializer: ConfigInitializerService,\n  validators: ConfigValidator[]\n) {\n  const validate = () => {\n    if (isDevMode()) {\n      configInitializer\n        .getStableConfig()\n        .then((config) => validateConfig(config, validators || []));\n    }\n  };\n  return validate;\n}\n\n/**\n * Should stay private in 1.x\n * as forRoot() is used internally by ConfigInitializerModule\n *\n * issue: #5279\n */\n@NgModule()\nexport class ConfigValidatorModule {\n  static forRoot(): ModuleWithProviders<ConfigValidatorModule> {\n    return {\n      ngModule: ConfigValidatorModule,\n      providers: [\n        {\n          provide: APP_INITIALIZER,\n          multi: true,\n          useFactory: configValidatorFactory,\n          deps: [\n            ConfigInitializerService,\n            [new Optional(), ConfigValidatorToken],\n          ],\n        },\n      ],\n    };\n  }\n}\n","import { DOCUMENT, isPlatformBrowser } from '@angular/common';\nimport {\n  InjectionToken,\n  ModuleWithProviders,\n  NgModule,\n  PLATFORM_ID,\n} from '@angular/core';\nimport { getCookie } from './utils/get-cookie';\nimport { provideConfigFactory } from './config-providers';\n\nexport const TEST_CONFIG_COOKIE_NAME = new InjectionToken<string>(\n  'TEST_CONFIG_COOKIE_NAME'\n);\n\nexport function parseConfigJSON(config: string) {\n  try {\n    return JSON.parse(decodeURIComponent(config));\n  } catch (_) {\n    return {};\n  }\n}\n\nexport function configFromCookieFactory(\n  cookieName: string,\n  platform: any,\n  document: Document\n) {\n  if (isPlatformBrowser(platform) && cookieName) {\n    const config = getCookie(document.cookie, cookieName);\n    return parseConfigJSON(config);\n  }\n  return {};\n}\n\nexport interface TestConfigModuleOptions {\n  cookie: string;\n}\n\n/**\n * Designed/intended to provide dynamic configuration for testing scenarios ONLY (e.g. e2e tests).\n *\n * CAUTION: DON'T USE IT IN PRODUCTION! IT HASN'T BEEN REVIEWED FOR SECURITY ISSUES.\n */\n@NgModule({})\nexport class TestConfigModule {\n  /**\n   * Injects JSON config from the cookie of the given name.\n   *\n   * Be aware of the cookie limitations (4096 bytes).\n   *\n   * CAUTION: DON'T USE IT IN PRODUCTION! IT HASN'T BEEN REVIEWED FOR SECURITY ISSUES.\n   */\n  static forRoot(\n    options: TestConfigModuleOptions\n  ): ModuleWithProviders<TestConfigModule> {\n    return {\n      ngModule: TestConfigModule,\n      providers: [\n        {\n          provide: TEST_CONFIG_COOKIE_NAME,\n          useValue: options && options.cookie,\n        },\n        provideConfigFactory(configFromCookieFactory, [\n          TEST_CONFIG_COOKIE_NAME,\n          PLATFORM_ID,\n          DOCUMENT,\n        ]),\n      ],\n    };\n  }\n}\n","export function getCookie(cookie: string, name: string) {\n  const regExp = new RegExp('(?:^|;\\\\s*)' + name + '=([^;]*)', 'g');\n  const result: RegExpExecArray = regExp.exec(cookie);\n\n  return (result && decodeURIComponent(result[1])) || '';\n}\n","import { DatePipe, getLocaleId } from '@angular/common';\nimport { isDevMode, Pipe, PipeTransform } from '@angular/core';\nimport { LanguageService } from '../site-context/facade/language.service';\n\n// type CxDatePipe, not DatePipe, due to conflict with Angular's DatePipe - problem occurs for the backward compatibility compiler of Ivy\n@Pipe({ name: 'cxDate' })\nexport class CxDatePipe extends DatePipe implements PipeTransform {\n  constructor(protected language: LanguageService) {\n    super(null);\n  }\n\n  // TODO: Replace `any` to match strict types from angular in 4.0\n  // Overload to support stricter type check from angular 11 onwards\n  transform(value: any, format?: string, timezone?: string): string | null;\n  transform(value: null | undefined, format?: string, timezone?: string): null;\n  transform(value: any, format?: string, timezone?: string): string | null {\n    return super.transform(value, format, timezone, this.getLang());\n  }\n\n  private getLang() {\n    const lang = this.getActiveLang();\n    try {\n      getLocaleId(lang);\n      return lang;\n    } catch {\n      this.reportMissingLocaleData(lang);\n      return 'en';\n    }\n  }\n\n  private getActiveLang(): string {\n    let result;\n    this.language\n      .getActive()\n      .subscribe((lang) => (result = lang))\n      .unsubscribe();\n    return result;\n  }\n\n  private reportMissingLocaleData(lang: string) {\n    if (isDevMode()) {\n      console.warn(\n        `cxDate pipe: No locale data registered for '${lang}' (see https://angular.io/api/common/registerLocaleData).`\n      );\n    }\n  }\n}\n","import {\n  ChangeDetectorRef,\n  isDevMode,\n  OnDestroy,\n  Pipe,\n  PipeTransform,\n} from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { shallowEqualObjects } from '../util/compare-equal-objects';\nimport { Translatable, TranslatableParams } from './translatable';\nimport { TranslationService } from './translation.service';\n\n@Pipe({ name: 'cxTranslate', pure: false })\nexport class TranslatePipe implements PipeTransform, OnDestroy {\n  private lastKey: string;\n  private lastOptions: object;\n  private translatedValue: string;\n  private sub: Subscription;\n\n  constructor(\n    protected service: TranslationService,\n    protected cd: ChangeDetectorRef\n  ) {}\n\n  transform(\n    input: Translatable | string,\n    options: TranslatableParams = {}\n  ): string {\n    if (!input) {\n      if (isDevMode()) {\n        console.error(\n          `The given input for the cxTranslate pipe (${input}) is invalid and cannot be translated`\n        );\n      }\n      return;\n    }\n\n    if ((input as Translatable).raw) {\n      return (input as Translatable).raw;\n    }\n\n    const key = typeof input === 'string' ? input : input.key;\n    if (typeof input !== 'string') {\n      options = { ...options, ...input.params };\n    }\n\n    this.translate(key, options);\n    return this.translatedValue;\n  }\n\n  private translate(key: any, options: object) {\n    if (\n      key !== this.lastKey ||\n      !shallowEqualObjects(options, this.lastOptions)\n    ) {\n      this.lastKey = key;\n      this.lastOptions = options;\n\n      if (this.sub) {\n        this.sub.unsubscribe();\n      }\n      this.sub = this.service\n        .translate(key, options, true)\n        .subscribe((val) => this.markForCheck(val));\n    }\n  }\n\n  private markForCheck(value: string) {\n    this.translatedValue = value;\n    this.cd.markForCheck();\n  }\n\n  ngOnDestroy(): void {\n    if (this.sub) {\n      this.sub.unsubscribe();\n    }\n  }\n}\n","import { TranslationResources } from '../translation-resources';\nimport { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class I18nConfig {\n  i18n?: {\n    /**\n     * When there are missing translation resources for the active language, the fallback language will be used.\n     */\n    fallbackLang?: string | false;\n\n    /**\n     * Configuration for lazy loading of translation files.\n     * For eager loading of translations please use config option `i18n.resources`\n     */\n\n    backend?: {\n      /**\n       * The path to JSON translations. It should contain placeholders:\n       * - `{{lng}}` for language\n       * - `{{ns}}` for the name of chunk.\n       *\n       * Example:\n       * `assets/i18n-assets/{{lng}}/{{ns}}.json`\n       */\n\n      loadPath?: string;\n    };\n\n    /**\n     * Reference to translation resources that are eagerly bundled with JS app.\n     * For lazy loading of translations please use config option `i18n.backend` instead.\n     */\n    resources?: TranslationResources;\n\n    /**\n     * Logs i18n events (like loading translation resources) to the console. Don't use in production!\n     */\n    debug?: boolean;\n\n    /**\n     * Mapping that assigns keys' namespaces to specific chunks. The main purpose of chunks is to lazy load them.\n     */\n    chunks?: {\n      [chunk: string]: string[];\n    };\n  };\n}\n","import { Injectable, isDevMode } from '@angular/core';\nimport { I18nConfig } from './config/i18n-config';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class TranslationChunkService {\n  protected duplicates: { [key: string]: string[] } = {};\n  protected chunks: { [key: string]: string } = {};\n  constructor(protected config: I18nConfig) {\n    const chunks = (config.i18n && config.i18n.chunks) || {};\n    Object.keys(chunks).forEach((chunk) => {\n      chunks[chunk].forEach((key) => {\n        if (this.chunks.hasOwnProperty(key)) {\n          if (!this.duplicates[key]) {\n            this.duplicates[key] = [this.chunks[key]];\n          }\n          this.duplicates[key].push(chunk);\n        } else {\n          this.chunks[key] = chunk;\n        }\n      });\n    });\n    if (Object.keys(this.duplicates).length > 0 && isDevMode()) {\n      this.warnDuplicates(this.duplicates);\n    }\n  }\n\n  protected readonly KEY_SEPARATOR = '.';\n\n  getChunkNameForKey(key: string): string {\n    const mainKey = (key || '').split(this.KEY_SEPARATOR)[0];\n    const chunk = this.chunks && this.chunks[mainKey];\n\n    if (!chunk) {\n      return mainKey; // fallback to main key as a chunk\n    }\n    return chunk;\n  }\n\n  private warnDuplicates(items: { [key: string]: string[] }): void {\n    const dupes: string[] = [];\n    Object.keys(items).forEach((key) => {\n      dupes.push(\n        `* '${key}' found in chunks: ${items[key].join(', ')}. Used '${\n          this.chunks[key]\n        }.${key}'.`\n      );\n    });\n    console.warn(\n      `Duplicated keys has been found in the config of i18n chunks:\\n${dupes.join(\n        '\\n'\n      )}`\n    );\n  }\n}\n","import { I18nConfig } from './i18n-config';\n\nexport const defaultI18nConfig: I18nConfig = {\n  i18n: {\n    fallbackLang: false,\n    debug: false,\n  },\n};\n","import { HttpClient } from '@angular/common/http';\nimport i18next, { InitOptions } from 'i18next';\nimport i18nextXhrBackend from 'i18next-xhr-backend';\nimport { ConfigInitializerService } from '../../config/config-initializer/config-initializer.service';\nimport { LanguageService } from '../../site-context/facade/language.service';\nimport { TranslationResources } from '../translation-resources';\n\nexport function i18nextInit(\n  configInit: ConfigInitializerService,\n  languageService: LanguageService,\n  httpClient: HttpClient,\n  serverRequestOrigin: string\n): () => Promise<any> {\n  return () =>\n    configInit.getStableConfig('i18n').then((config) => {\n      let i18nextConfig: InitOptions = {\n        ns: [], // don't preload any namespaces\n        fallbackLng: config.i18n.fallbackLang,\n        debug: config.i18n.debug,\n        interpolation: {\n          escapeValue: false,\n        },\n      };\n      if (config.i18n.backend) {\n        i18next.use(i18nextXhrBackend);\n        const loadPath = getLoadPath(\n          config.i18n.backend.loadPath,\n          serverRequestOrigin\n        );\n        const backend = {\n          loadPath,\n          ajax: i18nextGetHttpClient(httpClient),\n        };\n        i18nextConfig = { ...i18nextConfig, backend };\n      }\n\n      return i18next.init(i18nextConfig, () => {\n        // Don't use i18next's 'resources' config key for adding static translations,\n        // because it will disable loading chunks from backend. We add resources here, in the init's callback.\n        i18nextAddTranslations(config.i18n.resources);\n        syncI18nextWithSiteContext(languageService);\n      });\n    });\n}\n\nexport function i18nextAddTranslations(resources: TranslationResources = {}) {\n  Object.keys(resources).forEach((lang) => {\n    Object.keys(resources[lang]).forEach((chunkName) => {\n      i18next.addResourceBundle(\n        lang,\n        chunkName,\n        resources[lang][chunkName],\n        true,\n        true\n      );\n    });\n  });\n}\n\nexport function syncI18nextWithSiteContext(language: LanguageService) {\n  // always update language of i18next on site context (language) change\n  language.getActive().subscribe((lang) => i18next.changeLanguage(lang));\n}\n\n/**\n * Returns a function appropriate for i18next to make http calls for JSON files.\n * See docs for `i18next-xhr-backend`: https://github.com/i18next/i18next-xhr-backend#backend-options\n *\n * It uses Angular HttpClient under the hood, so it works in SSR.\n * @param httpClient Angular http client\n */\nexport function i18nextGetHttpClient(\n  httpClient: HttpClient\n): (url: string, options: object, callback: Function, data: object) => void {\n  return (url: string, _options: object, callback: Function, _data: object) => {\n    httpClient.get(url, { responseType: 'text' }).subscribe(\n      (data) => callback(data, { status: 200 }),\n      (error) => callback(null, { status: error.status })\n    );\n  };\n}\n\n/**\n * Resolves the relative path to the absolute one in SSR, using the server request's origin.\n * It's needed, because Angular Universal doesn't support relative URLs in HttpClient. See Angular issues:\n * - https://github.com/angular/angular/issues/19224\n * - https://github.com/angular/universal/issues/858\n */\nexport function getLoadPath(path: string, serverRequestOrigin: string): string {\n  if (!path) {\n    return undefined;\n  }\n  if (serverRequestOrigin && !path.match(/^http(s)?:\\/\\//)) {\n    if (path.startsWith('/')) {\n      path = path.slice(1);\n    }\n    if (path.startsWith('./')) {\n      path = path.slice(2);\n    }\n    const result = `${serverRequestOrigin}/${path}`;\n    return result;\n  }\n  return path;\n}\n","import { HttpClient } from '@angular/common/http';\nimport { APP_INITIALIZER, Optional, Provider } from '@angular/core';\nimport { ConfigInitializerService } from '../../config/config-initializer/config-initializer.service';\nimport { LanguageService } from '../../site-context/facade/language.service';\nimport { SERVER_REQUEST_ORIGIN } from '../../util/ssr.tokens';\nimport { i18nextInit } from './i18next-init';\n\nexport const i18nextProviders: Provider[] = [\n  {\n    provide: APP_INITIALIZER,\n    useFactory: i18nextInit,\n    deps: [\n      ConfigInitializerService,\n      LanguageService,\n      HttpClient,\n      [new Optional(), SERVER_REQUEST_ORIGIN],\n    ],\n    multi: true,\n  },\n];\n","import { Injectable, isDevMode } from '@angular/core';\nimport i18next from 'i18next';\nimport { Observable } from 'rxjs';\nimport { I18nConfig } from '../config/i18n-config';\nimport { TranslationChunkService } from '../translation-chunk.service';\nimport { TranslationService } from '../translation.service';\n\n@Injectable({ providedIn: 'root' })\nexport class I18nextTranslationService implements TranslationService {\n  private readonly NON_BREAKING_SPACE = String.fromCharCode(160);\n  protected readonly NAMESPACE_SEPARATOR = ':';\n\n  constructor(\n    protected config: I18nConfig,\n    protected translationChunk: TranslationChunkService\n  ) {}\n\n  translate(\n    key: string,\n    options: any = {},\n    whitespaceUntilLoaded: boolean = false\n  ): Observable<string> {\n    // If we've already loaded the chunk (or failed to load), we should immediately emit the value\n    // (or the fallback value in case the key is missing).\n\n    // Moreover, we SHOULD emit a value (or a fallback value) synchronously (not in a promise/setTimeout).\n    // Otherwise, we the will trigger additional deferred change detection in a view that consumes the returned observable,\n    // which together with `switchMap` operator may lead to an infinite loop.\n\n    const chunkName = this.translationChunk.getChunkNameForKey(key);\n    const namespacedKey = this.getNamespacedKey(key, chunkName);\n\n    return new Observable<string>((subscriber) => {\n      const translate = () => {\n        if (!i18next.isInitialized) {\n          return;\n        }\n        if (i18next.exists(namespacedKey, options)) {\n          subscriber.next(i18next.t(namespacedKey, options));\n        } else {\n          if (whitespaceUntilLoaded) {\n            subscriber.next(this.NON_BREAKING_SPACE);\n          }\n          i18next.loadNamespaces(chunkName, () => {\n            if (!i18next.exists(namespacedKey, options)) {\n              this.reportMissingKey(key, chunkName);\n              subscriber.next(this.getFallbackValue(namespacedKey));\n            } else {\n              subscriber.next(i18next.t(namespacedKey, options));\n            }\n          });\n        }\n      };\n\n      translate();\n      i18next.on('languageChanged', translate);\n      return () => i18next.off('languageChanged', translate);\n    });\n  }\n\n  loadChunks(chunkNames: string | string[]): Promise<any> {\n    return i18next.loadNamespaces(chunkNames);\n  }\n\n  /**\n   * Returns a fallback value in case when the given key is missing\n   * @param key\n   */\n  protected getFallbackValue(key: string): string {\n    return isDevMode() ? `[${key}]` : this.NON_BREAKING_SPACE;\n  }\n\n  private reportMissingKey(key: string, chunkName: string) {\n    if (isDevMode()) {\n      console.warn(\n        `Translation key missing '${key}' in the chunk '${chunkName}'`\n      );\n    }\n  }\n\n  private getNamespacedKey(key: string, chunk: string): string {\n    return chunk + this.NAMESPACE_SEPARATOR + key;\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { defaultI18nConfig } from './config/default-i18n-config';\nimport { CxDatePipe } from './date.pipe';\nimport { i18nextProviders } from './i18next/i18next-providers';\nimport { I18nextTranslationService } from './i18next/i18next-translation.service';\nimport { TranslatePipe } from './translate.pipe';\nimport { TranslationService } from './translation.service';\nimport { provideDefaultConfig } from '../config/config-providers';\n\n@NgModule({\n  declarations: [TranslatePipe, CxDatePipe],\n  exports: [TranslatePipe, CxDatePipe],\n})\nexport class I18nModule {\n  static forRoot(): ModuleWithProviders<I18nModule> {\n    return {\n      ngModule: I18nModule,\n      providers: [\n        provideDefaultConfig(defaultI18nConfig),\n        { provide: TranslationService, useExisting: I18nextTranslationService },\n        ...i18nextProviders,\n      ],\n    };\n  }\n}\n","export function mockTranslate(key: string, options: any = {}) {\n  const optionsString = Object.keys(options)\n    .sort()\n    .map((optionName) => `${optionName}:${options[optionName]}`)\n    .join(' ');\n  return optionsString ? `${key} ${optionsString}` : key;\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { mockTranslate } from './mock-translate';\nimport { Translatable } from '../translatable';\n\n@Pipe({ name: 'cxTranslate' })\nexport class MockTranslatePipe implements PipeTransform {\n  transform(input: Translatable | string, options: object = {}): string {\n    if ((input as Translatable).raw) {\n      return (input as Translatable).raw;\n    }\n\n    const key = typeof input === 'string' ? input : input.key;\n    if (typeof input !== 'string') {\n      options = { ...options, ...input.params };\n    }\n    return mockTranslate(key, options);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { TranslationService } from '../translation.service';\nimport { mockTranslate } from './mock-translate';\n\n@Injectable()\nexport class MockTranslationService implements TranslationService {\n  translate(\n    key: string,\n    options: any = {},\n    _whitespaceUntilLoaded: boolean = false\n  ): Observable<string> {\n    return new Observable<string>((subscriber) => {\n      const value = mockTranslate(key, options);\n      subscriber.next(value);\n      subscriber.complete();\n    });\n  }\n\n  loadChunks(_chunks: string | string[]): Promise<any> {\n    return Promise.resolve();\n  }\n}\n","import { DatePipe } from '@angular/common';\nimport { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({ name: 'cxDate' })\nexport class MockDatePipe extends DatePipe implements PipeTransform {\n  // Overload to support stricter type check from angular 11 onwards\n  transform(value: null | undefined, args?: string): null;\n  transform(value: any, format?: string, timezone?: string): string | null {\n    return super.transform(value, format, timezone, 'en');\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { MockTranslatePipe } from './mock-translate.pipe';\nimport { TranslationService } from '../translation.service';\nimport { MockTranslationService } from './mock-translation.service';\nimport { MockDatePipe } from './mock-date.pipe';\n\n@NgModule({\n  declarations: [MockTranslatePipe, MockDatePipe],\n  exports: [MockTranslatePipe, MockDatePipe],\n  providers: [\n    { provide: TranslationService, useClass: MockTranslationService },\n  ],\n})\nexport class I18nTestingModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\n\n@NgModule({})\nexport class CostCenterModule {\n  static forRoot(): ModuleWithProviders<CostCenterModule> {\n    return {\n      ngModule: CostCenterModule,\n      providers: [],\n    };\n  }\n}\n","import { PersonalizationConfig } from './personalization-config';\n\nexport const defaultPersonalizationConfig: PersonalizationConfig = {\n  personalization: {\n    enabled: false,\n    httpHeaderName: {\n      id: 'Occ-Personalization-Id',\n      timestamp: 'Occ-Personalization-Time',\n    },\n    context: {\n      slotPosition: 'PlaceholderContentSlot',\n      componentId: 'PersonalizationScriptComponent',\n    },\n  },\n};\n","import { Injectable } from '@angular/core';\nimport { Config } from '../../config/config-tokens';\n\n@Injectable({\n  providedIn: 'root',\n  useExisting: Config,\n})\nexport abstract class PersonalizationConfig {\n  personalization: {\n    enabled?: boolean;\n    httpHeaderName?: {\n      id: string;\n      timestamp: string;\n    };\n    context?: {\n      slotPosition?: string;\n      componentId?: string;\n    };\n  };\n}\n","import { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\n\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\nimport { PersonalizationConfig } from '../config/personalization-config';\nimport { WindowRef } from '../../window/window-ref';\nimport { isPlatformBrowser } from '@angular/common';\n\nconst PERSONALIZATION_ID_KEY = 'personalization-id';\n\n@Injectable({ providedIn: 'root' })\nexport class OccPersonalizationIdInterceptor implements HttpInterceptor {\n  private personalizationId: string;\n  private requestHeader: string;\n  private enabled = false;\n\n  constructor(\n    private config: PersonalizationConfig,\n    private occEndpoints: OccEndpointsService,\n    private winRef: WindowRef,\n    @Inject(PLATFORM_ID) private platform: any\n  ) {\n    if (isPlatformBrowser(this.platform)) {\n      this.enabled =\n        (this.winRef.localStorage && this.config.personalization.enabled) ||\n        false;\n\n      if (this.enabled) {\n        this.requestHeader = this.config.personalization.httpHeaderName.id.toLowerCase();\n        this.personalizationId = this.winRef.localStorage.getItem(\n          PERSONALIZATION_ID_KEY\n        );\n      } else if (this.winRef.localStorage.getItem(PERSONALIZATION_ID_KEY)) {\n        this.winRef.localStorage.removeItem(PERSONALIZATION_ID_KEY);\n      }\n    }\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (!this.enabled) {\n      return next.handle(request);\n    }\n\n    if (\n      this.personalizationId &&\n      request.url.includes(this.occEndpoints.getBaseEndpoint())\n    ) {\n      request = request.clone({\n        setHeaders: {\n          [this.requestHeader]: this.personalizationId,\n        },\n      });\n    }\n\n    return next.handle(request).pipe(\n      tap((event) => {\n        if (event instanceof HttpResponse) {\n          if (event.headers.keys().includes(this.requestHeader)) {\n            const receivedId = event.headers.get(this.requestHeader);\n            if (this.personalizationId !== receivedId) {\n              this.personalizationId = receivedId;\n              this.winRef.localStorage.setItem(\n                PERSONALIZATION_ID_KEY,\n                this.personalizationId\n              );\n            }\n          }\n        }\n      })\n    );\n  }\n}\n","import { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\n\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\nimport { PersonalizationConfig } from '../config/personalization-config';\nimport { WindowRef } from '../../window/window-ref';\nimport { isPlatformBrowser } from '@angular/common';\n\nconst PERSONALIZATION_TIME_KEY = 'personalization-time';\n\n@Injectable({ providedIn: 'root' })\nexport class OccPersonalizationTimeInterceptor implements HttpInterceptor {\n  private timestamp: string;\n  private requestHeader: string;\n  private enabled = false;\n\n  constructor(\n    private config: PersonalizationConfig,\n    private occEndpoints: OccEndpointsService,\n    private winRef: WindowRef,\n    @Inject(PLATFORM_ID) private platform: any\n  ) {\n    if (isPlatformBrowser(this.platform)) {\n      this.enabled =\n        (this.winRef.localStorage && this.config.personalization.enabled) ||\n        false;\n\n      if (this.enabled) {\n        this.requestHeader = this.config.personalization.httpHeaderName.timestamp.toLowerCase();\n        this.timestamp = this.winRef.localStorage.getItem(\n          PERSONALIZATION_TIME_KEY\n        );\n      } else if (this.winRef.localStorage.getItem(PERSONALIZATION_TIME_KEY)) {\n        this.winRef.localStorage.removeItem(PERSONALIZATION_TIME_KEY);\n      }\n    }\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (!this.enabled) {\n      return next.handle(request);\n    }\n\n    if (\n      this.timestamp &&\n      request.url.includes(this.occEndpoints.getBaseEndpoint())\n    ) {\n      request = request.clone({\n        setHeaders: {\n          [this.requestHeader]: this.timestamp,\n        },\n      });\n    }\n\n    return next.handle(request).pipe(\n      tap((event) => {\n        if (event instanceof HttpResponse) {\n          if (event.headers.keys().includes(this.requestHeader)) {\n            const receivedTimestamp = event.headers.get(this.requestHeader);\n            if (this.timestamp !== receivedTimestamp) {\n              this.timestamp = receivedTimestamp;\n              this.winRef.localStorage.setItem(\n                PERSONALIZATION_TIME_KEY,\n                this.timestamp\n              );\n            }\n          }\n        }\n      })\n    );\n  }\n}\n","import { Provider } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\n\nimport { OccPersonalizationIdInterceptor } from './occ-personalization-id.interceptor';\nimport { OccPersonalizationTimeInterceptor } from './occ-personalization-time.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: OccPersonalizationIdInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: OccPersonalizationTimeInterceptor,\n    multi: true,\n  },\n];\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { defaultPersonalizationConfig } from './config/default-personalization-config';\n\nimport { interceptors } from './http-interceptors/index';\nimport { provideDefaultConfig } from '../config/config-providers';\n\n@NgModule({})\nexport class PersonalizationModule {\n  static forRoot(): ModuleWithProviders<PersonalizationModule> {\n    return {\n      ngModule: PersonalizationModule,\n      providers: [\n        provideDefaultConfig(defaultPersonalizationConfig),\n        ...interceptors,\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { filter, map } from 'rxjs/operators';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { ContentSlotComponentData } from '../../cms/model/content-slot-component-data.model';\nimport { ContentSlotData } from '../../cms/model/content-slot-data.model';\nimport { Page } from '../../cms/model/page.model';\nimport { PersonalizationConfig } from '../config/personalization-config';\nimport { PersonalizationContext } from '../model/personalization-context.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class PersonalizationContextService {\n  constructor(\n    protected config: PersonalizationConfig,\n    protected cmsService: CmsService\n  ) {}\n\n  getPersonalizationContext(): Observable<PersonalizationContext> {\n    return this.cmsService.getCurrentPage().pipe(\n      filter(Boolean),\n      map(\n        (page: Page) =>\n          page.slots[this.config.personalization.context.slotPosition]\n      ),\n      filter(Boolean),\n      map((slot: ContentSlotData) =>\n        slot.components.find(\n          (i) => i.uid === this.config.personalization.context.componentId\n        )\n      ),\n      filter(Boolean),\n      map((component: ContentSlotComponentData) =>\n        this.buildPersonalizationContext(component.properties.script.data)\n      )\n    );\n  }\n\n  private buildPersonalizationContext(data: string): PersonalizationContext {\n    const context = JSON.parse(atob(data));\n    context.actions.forEach((action) => {\n      Object.keys(action).forEach((key) => {\n        action[key] = atob(action[key]);\n      });\n    });\n    for (let i = 0; i < context.segments.length; i++) {\n      context.segments[i] = atob(context.segments[i]);\n    }\n    return context;\n  }\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducer, ActionReducerMap } from '@ngrx/store';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\nimport { entityLoaderReducer } from '../../../state/utils/entity-loader/entity-loader.reducer';\nimport { PROCESS_FEATURE } from '../process-state';\n\nexport function getReducers<T>(): ActionReducer<EntityLoaderState<T>> {\n  return entityLoaderReducer(PROCESS_FEATURE);\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  EntityLoaderState<any>\n>> = new InjectionToken<ActionReducerMap<EntityLoaderState<any>>>(\n  'ProcessReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { NgModule } from '@angular/core';\nimport { StoreModule } from '@ngrx/store';\nimport { StateModule } from '../../state/state.module';\nimport { PROCESS_FEATURE } from './process-state';\nimport { reducerProvider, reducerToken } from './reducers/index';\n\n@NgModule({\n  imports: [StateModule, StoreModule.forFeature(PROCESS_FEATURE, reducerToken)],\n  providers: [reducerProvider],\n})\nexport class ProcessStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { ProcessStoreModule } from './store/process-store.module';\n\n@NgModule({\n  imports: [ProcessStoreModule],\n})\nexport class ProcessModule {\n  static forRoot(): ModuleWithProviders<ProcessModule> {\n    return {\n      ngModule: ProcessModule,\n      providers: [],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Product } from '../../../model/product.model';\nimport { ProductAdapter } from './product.adapter';\nimport { ScopedProductData } from './scoped-product-data';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductConnector {\n  constructor(protected adapter: ProductAdapter) {}\n\n  get(productCode: string, scope = ''): Observable<Product> {\n    return this.adapter.load(productCode, scope);\n  }\n\n  getMany(products: ScopedProductData[]): ScopedProductData[] {\n    if (!this.adapter.loadMany) {\n      return products.map((product) => ({\n        ...product,\n        data$: this.adapter.load(product.code, product.scope),\n      }));\n    }\n\n    return this.adapter.loadMany(products);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ProductReference } from '../../../model/product.model';\nimport { ProductReferencesAdapter } from './product-references.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductReferencesConnector {\n  constructor(protected adapter: ProductReferencesAdapter) {}\n\n  get(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]> {\n    return this.adapter.load(productCode, referenceType, pageSize);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ProductReviewsAdapter } from './product-reviews.adapter';\nimport { Review } from '../../../model/product.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductReviewsConnector {\n  constructor(protected adapter: ProductReviewsAdapter) {}\n\n  get(productCode: string, maxCount?: number): Observable<Review[]> {\n    return this.adapter.load(productCode, maxCount);\n  }\n\n  add(productCode: string, review: any): Observable<Review> {\n    return this.adapter.post(productCode, review);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ProductSearchAdapter } from './product-search.adapter';\nimport { SearchConfig } from '../../model/search-config';\nimport { Observable } from 'rxjs';\nimport {\n  Suggestion,\n  ProductSearchPage,\n} from '../../../model/product-search.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductSearchConnector {\n  constructor(protected adapter: ProductSearchAdapter) {}\n\n  search(\n    query: string,\n    searchConfig?: SearchConfig\n  ): Observable<ProductSearchPage> {\n    return this.adapter.search(query, searchConfig);\n  }\n\n  getSuggestions(term: string, pageSize?: number): Observable<Suggestion[]> {\n    return this.adapter.loadSuggestions(term, pageSize);\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { ProductReference } from '../../../model/product.model';\n\nexport const LOAD_PRODUCT_REFERENCES = '[Product] Load Product References Data';\nexport const LOAD_PRODUCT_REFERENCES_FAIL =\n  '[Product] Load Product References Data Fail';\nexport const LOAD_PRODUCT_REFERENCES_SUCCESS =\n  '[Product] Load Product References Data Success';\nexport const CLEAN_PRODUCT_REFERENCES = '[Product] Clean Product References';\n\nexport class LoadProductReferences implements Action {\n  readonly type = LOAD_PRODUCT_REFERENCES;\n  constructor(\n    public payload: {\n      productCode: string;\n      referenceType?: string;\n      pageSize?: number;\n    }\n  ) {}\n}\n\nexport class LoadProductReferencesFail implements Action {\n  readonly type = LOAD_PRODUCT_REFERENCES_FAIL;\n  constructor(public payload: ErrorModel) {}\n}\n\nexport class LoadProductReferencesSuccess implements Action {\n  readonly type = LOAD_PRODUCT_REFERENCES_SUCCESS;\n  constructor(\n    public payload: {\n      productCode: string;\n      list: ProductReference[];\n    }\n  ) {}\n}\n\nexport class CleanProductReferences implements Action {\n  readonly type = CLEAN_PRODUCT_REFERENCES;\n}\n\n// action types\nexport type ProductReferencesAction =\n  | LoadProductReferences\n  | LoadProductReferencesFail\n  | LoadProductReferencesSuccess\n  | CleanProductReferences;\n","import {\n  ENTITY_FAIL_ACTION,\n  ENTITY_LOAD_ACTION,\n  ENTITY_RESET_ACTION,\n  ENTITY_SUCCESS_ACTION,\n  entityFailMeta,\n  EntityLoaderMeta,\n  entityLoadMeta,\n  entityResetMeta,\n  entitySuccessMeta,\n} from '../entity-loader/entity-loader.action';\nimport { Action } from '@ngrx/store';\n\nexport namespace EntityScopedLoaderActions {\n  export interface EntityScopedLoaderMeta extends EntityLoaderMeta {\n    scope?: string;\n  }\n\n  export interface EntityScopedLoaderAction extends Action {\n    readonly payload?: any;\n    readonly meta?: EntityScopedLoaderMeta;\n  }\n\n  export function entityScopedLoadMeta(\n    entityType: string,\n    id: string | string[],\n    scope?: string\n  ): EntityScopedLoaderMeta {\n    return {\n      ...entityLoadMeta(entityType, id),\n      scope,\n    };\n  }\n\n  export function entityScopedFailMeta(\n    entityType: string,\n    id: string | string[],\n    scope?: string,\n    error?: any\n  ): EntityScopedLoaderMeta {\n    return {\n      ...entityFailMeta(entityType, id, error),\n      scope,\n    };\n  }\n\n  export function entityScopedSuccessMeta(\n    entityType: string,\n    id: string | string[],\n    scope?: string\n  ): EntityScopedLoaderMeta {\n    return {\n      ...entitySuccessMeta(entityType, id),\n      scope,\n    };\n  }\n\n  export function entityScopedResetMeta(\n    entityType: string,\n    id: string | string[],\n    scope?: string\n  ): EntityScopedLoaderMeta {\n    return {\n      ...entityResetMeta(entityType, id),\n      scope,\n    };\n  }\n\n  export class EntityScopedLoadAction implements EntityScopedLoaderAction {\n    type = ENTITY_LOAD_ACTION;\n    readonly meta: EntityScopedLoaderMeta;\n    constructor(entityType: string, id: string | string[], scope?: string) {\n      this.meta = entityScopedLoadMeta(entityType, id, scope);\n    }\n  }\n\n  export class EntityScopedFailAction implements EntityScopedLoaderAction {\n    type = ENTITY_FAIL_ACTION;\n    readonly meta: EntityScopedLoaderMeta;\n    constructor(\n      entityType: string,\n      id: string | string[],\n      scope?: string,\n      error?: any\n    ) {\n      this.meta = entityScopedFailMeta(entityType, id, scope, error);\n    }\n  }\n\n  export class EntityScopedSuccessAction implements EntityScopedLoaderAction {\n    type = ENTITY_SUCCESS_ACTION;\n    readonly meta: EntityScopedLoaderMeta;\n    constructor(\n      entityType: string,\n      id: string | string[],\n      scope?: string,\n      public payload?: any\n    ) {\n      this.meta = entityScopedSuccessMeta(entityType, id, scope);\n    }\n  }\n\n  export class EntityScopedResetAction implements EntityScopedLoaderAction {\n    type = ENTITY_RESET_ACTION;\n    readonly meta: EntityScopedLoaderMeta;\n    constructor(entityType: string, id: string | string[], scope?: string) {\n      this.meta = entityScopedResetMeta(entityType, id, scope);\n    }\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { Review } from '../../../model/product.model';\n\nexport const LOAD_PRODUCT_REVIEWS = '[Product] Load Product Reviews Data';\nexport const LOAD_PRODUCT_REVIEWS_FAIL =\n  '[Product] Load Product Reviews Data Fail';\nexport const LOAD_PRODUCT_REVIEWS_SUCCESS =\n  '[Product] Load Product Reviews Data Success';\nexport const POST_PRODUCT_REVIEW = '[Product] Post Product Review';\nexport const POST_PRODUCT_REVIEW_FAIL = '[Product] Post Product Review Fail';\nexport const POST_PRODUCT_REVIEW_SUCCESS =\n  '[Product] Post Product Review Success';\n\nexport class LoadProductReviews implements Action {\n  readonly type = LOAD_PRODUCT_REVIEWS;\n  constructor(public payload: string) {}\n}\n\nexport class LoadProductReviewsFail implements Action {\n  readonly type = LOAD_PRODUCT_REVIEWS_FAIL;\n  constructor(public payload: ErrorModel) {}\n}\n\nexport class LoadProductReviewsSuccess implements Action {\n  readonly type = LOAD_PRODUCT_REVIEWS_SUCCESS;\n  constructor(public payload: { productCode: string; list: Review[] }) {}\n}\n\nexport class PostProductReview implements Action {\n  readonly type = POST_PRODUCT_REVIEW;\n  constructor(public payload: { productCode: string; review: Review }) {}\n}\n\nexport class PostProductReviewFail implements Action {\n  readonly type = POST_PRODUCT_REVIEW_FAIL;\n  constructor(public payload: string) {}\n}\n\nexport class PostProductReviewSuccess implements Action {\n  readonly type = POST_PRODUCT_REVIEW_SUCCESS;\n  constructor(public payload: Review) {}\n}\n\n// action types\nexport type ProductReviewsAction =\n  | LoadProductReviews\n  | LoadProductReviewsFail\n  | LoadProductReviewsSuccess\n  | PostProductReview\n  | PostProductReviewFail\n  | PostProductReviewSuccess;\n","import { Action } from '@ngrx/store';\nimport { ErrorModel } from '../../../model/misc.model';\nimport {\n  ClearSearch,\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport { SearchConfig } from '../../model/search-config';\n\nexport const SEARCH_PRODUCTS = '[Product] Search Products';\nexport const SEARCH_PRODUCTS_FAIL = '[Product] Search Products Fail';\nexport const SEARCH_PRODUCTS_SUCCESS = '[Product] Search Products Success';\nexport const GET_PRODUCT_SUGGESTIONS = '[Product] Get Product Suggestions';\nexport const GET_PRODUCT_SUGGESTIONS_SUCCESS =\n  '[Product] Get Product Suggestions Success';\nexport const GET_PRODUCT_SUGGESTIONS_FAIL =\n  '[Product] Get Product Suggestions Fail';\nexport const CLEAR_PRODUCT_SEARCH_RESULT =\n  '[Product] Clear Product Search Result';\n\nexport class SearchProducts implements Action {\n  readonly type = SEARCH_PRODUCTS;\n  constructor(\n    public payload: { queryText: string; searchConfig: SearchConfig },\n    public auxiliary?: boolean\n  ) {}\n}\n\nexport class SearchProductsFail implements Action {\n  readonly type = SEARCH_PRODUCTS_FAIL;\n  constructor(public payload: ErrorModel, public auxiliary?: boolean) {}\n}\n\nexport class SearchProductsSuccess implements Action {\n  readonly type = SEARCH_PRODUCTS_SUCCESS;\n  constructor(public payload: ProductSearchPage, public auxiliary?: boolean) {}\n}\n\nexport class GetProductSuggestions implements Action {\n  readonly type = GET_PRODUCT_SUGGESTIONS;\n  constructor(public payload: { term: string; searchConfig: SearchConfig }) {}\n}\n\nexport class GetProductSuggestionsSuccess implements Action {\n  readonly type = GET_PRODUCT_SUGGESTIONS_SUCCESS;\n  constructor(public payload: Suggestion[]) {}\n}\n\nexport class GetProductSuggestionsFail implements Action {\n  readonly type = GET_PRODUCT_SUGGESTIONS_FAIL;\n  constructor(public payload: ErrorModel) {}\n}\n\nexport class ClearProductSearchResult implements Action {\n  readonly type = CLEAR_PRODUCT_SEARCH_RESULT;\n  constructor(\n    public payload: ClearSearch = {\n      clearPageResults: false,\n      clearSearchboxResults: false,\n    }\n  ) {}\n}\n\n// action types\nexport type ProductSearchAction =\n  | SearchProducts\n  | SearchProductsFail\n  | SearchProductsSuccess\n  | GetProductSuggestions\n  | GetProductSuggestionsSuccess\n  | GetProductSuggestionsFail\n  | ClearProductSearchResult;\n","import {\n  ProductSearchPage,\n  Suggestion,\n} from '../../model/product-search.model';\nimport { Product, ProductReference, Review } from '../../model/product.model';\nimport { EntityScopedLoaderState } from '../../state/utils/scoped-loader/scoped-loader.state';\n\nexport const PRODUCT_FEATURE = 'product';\nexport const PRODUCT_DETAIL_ENTITY = '[Product] Detail Entity';\n\nexport interface StateWithProduct {\n  [PRODUCT_FEATURE]: ProductsState;\n}\n\nexport interface ProductsState {\n  details: EntityScopedLoaderState<Product>;\n  search: ProductsSearchState;\n  reviews: ProductReviewsState;\n  references: ProductReferencesState;\n}\n\nexport interface ProductsSearchState {\n  results: ProductSearchPage;\n  suggestions: Suggestion[];\n  auxResults: ProductSearchPage;\n}\n\nexport interface ProductReviewsState {\n  productCode: string;\n  list: Review[];\n}\n\nexport interface ProductReferencesState {\n  productCode: string;\n  list: ProductReference[];\n}\n","import { Product } from '../../../model/product.model';\nimport { PRODUCT_DETAIL_ENTITY } from '../product-state';\nimport { EntityLoaderMeta } from '../../../state/utils/entity-loader/entity-loader.action';\nimport { Action } from '@ngrx/store';\nimport { EntityScopedLoaderActions } from '../../../state/utils/scoped-loader/entity-scoped-loader.actions';\n\nexport const LOAD_PRODUCT = '[Product] Load Product Data';\nexport const LOAD_PRODUCT_FAIL = '[Product] Load Product Data Fail';\nexport const LOAD_PRODUCT_SUCCESS = '[Product] Load Product Data Success';\n\nexport interface ProductMeta extends EntityLoaderMeta {\n  scope?: string;\n}\n\nexport interface EntityScopedLoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: ProductMeta;\n}\n\nexport class LoadProduct extends EntityScopedLoaderActions.EntityScopedLoadAction {\n  readonly type = LOAD_PRODUCT;\n  constructor(public payload: string, scope = '') {\n    super(PRODUCT_DETAIL_ENTITY, payload, scope);\n  }\n}\n\nexport class LoadProductFail extends EntityScopedLoaderActions.EntityScopedFailAction {\n  readonly type = LOAD_PRODUCT_FAIL;\n  constructor(productCode: string, public payload: any, scope = '') {\n    super(PRODUCT_DETAIL_ENTITY, productCode, scope, payload);\n  }\n}\n\nexport class LoadProductSuccess extends EntityScopedLoaderActions.EntityScopedSuccessAction {\n  readonly type = LOAD_PRODUCT_SUCCESS;\n  constructor(public payload: Product, scope = '') {\n    super(PRODUCT_DETAIL_ENTITY, payload.code, scope);\n  }\n}\n\n// action types\nexport type ProductAction = LoadProduct | LoadProductFail | LoadProductSuccess;\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { ProductReferencesConnector } from '../../connectors/references/product-references.connector';\nimport { ProductActions } from '../actions/index';\n\n@Injectable()\nexport class ProductReferencesEffects {\n  @Effect()\n  loadProductReferences$: Observable<\n    | ProductActions.LoadProductReferencesSuccess\n    | ProductActions.LoadProductReferencesFail\n  > = this.actions$.pipe(\n    ofType(ProductActions.LOAD_PRODUCT_REFERENCES),\n    map((action: ProductActions.LoadProductReferences) => action.payload),\n    mergeMap((payload) => {\n      return this.productReferencesConnector\n        .get(payload.productCode, payload.referenceType, payload.pageSize)\n        .pipe(\n          map((data) => {\n            return new ProductActions.LoadProductReferencesSuccess({\n              productCode: payload.productCode,\n              list: data,\n            });\n          }),\n          catchError((_error) =>\n            of(\n              new ProductActions.LoadProductReferencesFail({\n                message: payload.productCode,\n              } as ErrorModel)\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private productReferencesConnector: ProductReferencesConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, tap } from 'rxjs/operators';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { ProductReviewsConnector } from '../../connectors/reviews/product-reviews.connector';\nimport { ProductActions } from '../actions/index';\nimport {\n  GlobalMessageService,\n  GlobalMessageType,\n} from '../../../global-message/index';\n\n@Injectable()\nexport class ProductReviewsEffects {\n  @Effect()\n  loadProductReviews$: Observable<\n    | ProductActions.LoadProductReviewsSuccess\n    | ProductActions.LoadProductReviewsFail\n  > = this.actions$.pipe(\n    ofType(ProductActions.LOAD_PRODUCT_REVIEWS),\n    map((action: ProductActions.LoadProductReviews) => action.payload),\n    mergeMap((productCode) => {\n      return this.productReviewsConnector.get(productCode).pipe(\n        map((data) => {\n          return new ProductActions.LoadProductReviewsSuccess({\n            productCode,\n            list: data,\n          });\n        }),\n        catchError((_error) =>\n          of(\n            new ProductActions.LoadProductReviewsFail({\n              message: productCode,\n            } as ErrorModel)\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  postProductReview: Observable<\n    | ProductActions.PostProductReviewSuccess\n    | ProductActions.PostProductReviewFail\n  > = this.actions$.pipe(\n    ofType(ProductActions.POST_PRODUCT_REVIEW),\n    map((action: ProductActions.PostProductReview) => action.payload),\n    mergeMap((payload) => {\n      return this.productReviewsConnector\n        .add(payload.productCode, payload.review)\n        .pipe(\n          map((reviewResponse) => {\n            return new ProductActions.PostProductReviewSuccess(reviewResponse);\n          }),\n          catchError((_error) =>\n            of(new ProductActions.PostProductReviewFail(payload.productCode))\n          )\n        );\n    })\n  );\n\n  @Effect({ dispatch: false })\n  showGlobalMessageOnPostProductReviewSuccess$ = this.actions$.pipe(\n    ofType(ProductActions.POST_PRODUCT_REVIEW_SUCCESS),\n    tap(() => {\n      this.globalMessageService.add(\n        { key: 'productReview.thankYouForReview' },\n        GlobalMessageType.MSG_TYPE_CONFIRMATION\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private productReviewsConnector: ProductReviewsConnector,\n    private globalMessageService: GlobalMessageService\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, groupBy, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { ProductSearchConnector } from '../../connectors/search/product-search.connector';\nimport { ProductActions } from '../actions/index';\n\n@Injectable()\nexport class ProductsSearchEffects {\n  @Effect()\n  searchProducts$: Observable<\n    ProductActions.SearchProductsSuccess | ProductActions.SearchProductsFail\n  > = this.actions$.pipe(\n    ofType(ProductActions.SEARCH_PRODUCTS),\n    groupBy((action: ProductActions.SearchProducts) => action.auxiliary),\n    mergeMap((group) =>\n      group.pipe(\n        switchMap((action: ProductActions.SearchProducts) => {\n          return this.productSearchConnector\n            .search(action.payload.queryText, action.payload.searchConfig)\n            .pipe(\n              map((data) => {\n                return new ProductActions.SearchProductsSuccess(\n                  data,\n                  action.auxiliary\n                );\n              }),\n              catchError((error) =>\n                of(\n                  new ProductActions.SearchProductsFail(\n                    makeErrorSerializable(error),\n                    action.auxiliary\n                  )\n                )\n              )\n            );\n        })\n      )\n    )\n  );\n\n  @Effect()\n  getProductSuggestions$: Observable<\n    | ProductActions.GetProductSuggestionsSuccess\n    | ProductActions.GetProductSuggestionsFail\n  > = this.actions$.pipe(\n    ofType(ProductActions.GET_PRODUCT_SUGGESTIONS),\n    map((action: ProductActions.GetProductSuggestions) => action.payload),\n    switchMap((payload) => {\n      return this.productSearchConnector\n        .getSuggestions(payload.term, payload.searchConfig.pageSize)\n        .pipe(\n          map((suggestions) => {\n            if (suggestions === undefined) {\n              return new ProductActions.GetProductSuggestionsSuccess([]);\n            }\n            return new ProductActions.GetProductSuggestionsSuccess(suggestions);\n          }),\n          catchError((error) =>\n            of(\n              new ProductActions.GetProductSuggestionsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private productSearchConnector: ProductSearchConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, createEffect, ofType } from '@ngrx/effects';\nimport { merge, Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { ProductConnector } from '../../connectors/product/product.connector';\nimport { ProductActions } from '../actions/index';\nimport { ScopedProductData } from '../../connectors/product/scoped-product-data';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { bufferDebounceTime } from '../../../util/rxjs/buffer-debounce-time';\nimport { Action } from '@ngrx/store';\nimport { withdrawOn } from '../../../util/rxjs/withdraw-on';\n\n@Injectable()\nexport class ProductEffects {\n  // we want to cancel all ongoing requests when currency or language changes,\n  private contextChange$: Observable<Action> = this.actions$.pipe(\n    ofType(\n      SiteContextActions.CURRENCY_CHANGE,\n      SiteContextActions.LANGUAGE_CHANGE\n    )\n  );\n\n  loadProduct$ = createEffect(\n    () => ({ scheduler, debounce = 0 } = {}): Observable<\n      ProductActions.LoadProductSuccess | ProductActions.LoadProductFail\n    > =>\n      this.actions$.pipe(\n        ofType(ProductActions.LOAD_PRODUCT),\n        map((action: ProductActions.LoadProduct) => ({\n          code: action.payload,\n          scope: action.meta.scope,\n        })),\n        // we are grouping all load actions that happens at the same time\n        // to optimize loading and pass them all to productConnector.getMany\n        bufferDebounceTime(debounce, scheduler),\n        mergeMap((products) =>\n          merge(\n            ...this.productConnector\n              .getMany(products)\n              .map(this.productLoadEffect)\n          )\n        ),\n        withdrawOn(this.contextChange$)\n      )\n  );\n\n  private productLoadEffect(\n    productLoad: ScopedProductData\n  ): Observable<\n    ProductActions.LoadProductSuccess | ProductActions.LoadProductFail\n  > {\n    return productLoad.data$.pipe(\n      map(\n        (data) =>\n          new ProductActions.LoadProductSuccess(\n            { code: productLoad.code, ...data },\n            productLoad.scope\n          )\n      ),\n      catchError((error) => {\n        return of(\n          new ProductActions.LoadProductFail(\n            productLoad.code,\n            makeErrorSerializable(error),\n            productLoad.scope\n          )\n        );\n      })\n    );\n  }\n\n  constructor(\n    private actions$: Actions,\n    private productConnector: ProductConnector\n  ) {}\n}\n","import { ProductReferencesEffects } from './product-references.effect';\nimport { ProductReviewsEffects } from './product-reviews.effect';\nimport { ProductsSearchEffects } from './product-search.effect';\nimport { ProductEffects } from './product.effect';\n\nexport const effects: any[] = [\n  ProductsSearchEffects,\n  ProductEffects,\n  ProductReviewsEffects,\n  ProductReferencesEffects,\n];\n\nexport * from './product-references.effect';\nexport * from './product-reviews.effect';\nexport * from './product-search.effect';\nexport * from './product.effect';\n","import { ProductReference } from '../../../model/product.model';\nimport { ProductActions } from '../actions/index';\nimport { ProductReferencesState } from '../product-state';\n\nexport const initialState: ProductReferencesState = {\n  productCode: '',\n  list: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: ProductActions.ProductReferencesAction\n): ProductReferencesState {\n  switch (action.type) {\n    case ProductActions.LOAD_PRODUCT_REFERENCES_SUCCESS: {\n      const productCode = action.payload.productCode;\n      const list = action.payload.list;\n\n      return {\n        ...state,\n        list: [...state.list, ...(list ? list : [])].reduce(\n          (\n            productReferences: ProductReference[],\n            productReference: ProductReference\n          ) => {\n            if (\n              !productReferences.some(\n                (obj) =>\n                  obj.referenceType === productReference.referenceType &&\n                  obj.target.code === productReference.target.code\n              )\n            ) {\n              productReferences.push(productReference);\n            }\n            return productReferences;\n          },\n          []\n        ),\n        productCode,\n      };\n    }\n\n    case ProductActions.CLEAN_PRODUCT_REFERENCES: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n\nexport const getProductReferenceList = (\n  state: ProductReferencesState\n): ProductReference[] => state.list;\nexport const getProductReferenceProductCode = (\n  state: ProductReferencesState\n): string => state.productCode;\n","import { Review } from '../../../model/product.model';\nimport { ProductActions } from '../actions/index';\nimport { ProductReviewsState } from '../product-state';\n\nexport const initialState: ProductReviewsState = {\n  productCode: '',\n  list: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: ProductActions.ProductReviewsAction\n): ProductReviewsState {\n  switch (action.type) {\n    case ProductActions.LOAD_PRODUCT_REVIEWS_SUCCESS: {\n      const productCode = action.payload.productCode;\n      const list = action.payload.list;\n\n      return {\n        ...state,\n        productCode,\n        list,\n      };\n    }\n  }\n\n  return state;\n}\n\nexport const getReviewList = (state: ProductReviewsState): Review[] =>\n  state.list;\nexport const getReviewProductCode = (state: ProductReviewsState): string =>\n  state.productCode;\n","import {\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport { ProductActions } from '../actions/index';\nimport { ProductsSearchState } from '../product-state';\n\nexport const initialState: ProductsSearchState = {\n  results: {},\n  suggestions: [],\n  auxResults: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: ProductActions.ProductSearchAction\n): ProductsSearchState {\n  switch (action.type) {\n    case ProductActions.SEARCH_PRODUCTS_SUCCESS: {\n      const results = action.payload;\n      const res = action.auxiliary ? { auxResults: results } : { results };\n      return {\n        ...state,\n        ...res,\n      };\n    }\n\n    case ProductActions.GET_PRODUCT_SUGGESTIONS_SUCCESS: {\n      const suggestions: Suggestion[] = action.payload;\n\n      return {\n        ...state,\n        suggestions,\n      };\n    }\n\n    case ProductActions.CLEAR_PRODUCT_SEARCH_RESULT: {\n      return {\n        ...state,\n        results: action.payload.clearPageResults ? {} : state.results,\n        suggestions: action.payload.clearSearchboxResults\n          ? []\n          : state.suggestions,\n        auxResults: action.payload.clearSearchboxResults\n          ? {}\n          : state.auxResults,\n      };\n    }\n  }\n  return state;\n}\n\nexport const getSearchResults = (\n  state: ProductsSearchState\n): ProductSearchPage => state.results;\nexport const getAuxSearchResults = (\n  state: ProductsSearchState\n): ProductSearchPage => state.auxResults;\nexport const getProductSuggestions = (\n  state: ProductsSearchState\n): Suggestion[] => state.suggestions;\n","import { loaderReducer } from '../loader/loader.reducer';\nimport { EntityScopedLoaderAction } from '../../../product/store/actions/product.action';\nimport { ScopedLoaderState } from './scoped-loader.state';\nimport { Action } from '@ngrx/store';\n\nexport const initialScopedLoaderState: ScopedLoaderState<any> = {};\n\n/**\n * Higher order reducer designed to add scope support for loader reducer\n *\n * @param entityType\n * @param reducer\n */\nexport function scopedLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: Action) => T\n): (\n  state: ScopedLoaderState<T>,\n  action: EntityScopedLoaderAction\n) => ScopedLoaderState<T> {\n  const loader = loaderReducer<T>(entityType, reducer);\n\n  return (\n    state: ScopedLoaderState<T> = initialScopedLoaderState,\n    action: EntityScopedLoaderAction\n  ): ScopedLoaderState<T> => {\n    if (action && action.meta && action.meta.entityType === entityType) {\n      return {\n        ...state,\n        [action.meta.scope ?? '']: loader(state[action.meta.scope], action),\n      };\n    }\n    return state;\n  };\n}\n","import {\n  EntityScopedLoaderState,\n  ScopedLoaderState,\n} from './scoped-loader.state';\nimport { scopedLoaderReducer } from './scoped-loader.reducer';\n\nimport { entityReducer } from '../entity/entity.reducer';\nimport { LoaderAction } from '../loader/loader.action';\nimport { EntityScopedLoaderActions } from './entity-scoped-loader.actions';\n\n/**\n * Higher order reducer that wraps scopedLoaderReducer and EntityReducer enhancing\n * single state reducer to support multiple entities with generic loading flags and scopes\n */\nexport function entityScopedLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: LoaderAction) => T\n): (\n  state: EntityScopedLoaderState<T>,\n  action: EntityScopedLoaderActions.EntityScopedLoaderAction\n) => EntityScopedLoaderState<T> {\n  return entityReducer<ScopedLoaderState<T>>(\n    entityType,\n    scopedLoaderReducer<T>(entityType, reducer)\n  );\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducer, ActionReducerMap, MetaReducer } from '@ngrx/store';\nimport { Product } from '../../../model/product.model';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { PRODUCT_DETAIL_ENTITY, ProductsState } from '../product-state';\nimport * as fromProductReferences from './product-references.reducer';\nimport * as fromProductReviews from './product-reviews.reducer';\nimport * as fromProductsSearch from './product-search.reducer';\nimport { entityScopedLoaderReducer } from '../../../state/utils/scoped-loader/entity-scoped-loader.reducer';\n\nexport function getReducers(): ActionReducerMap<ProductsState> {\n  return {\n    search: fromProductsSearch.reducer,\n    details: entityScopedLoaderReducer<Product>(PRODUCT_DETAIL_ENTITY),\n    reviews: fromProductReviews.reducer,\n    references: fromProductReferences.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  ProductsState\n>> = new InjectionToken<ActionReducerMap<ProductsState>>('ProductReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearProductsState(\n  reducer: ActionReducer<any>\n): ActionReducer<any> {\n  return function (state, action) {\n    if (\n      action.type === SiteContextActions.CURRENCY_CHANGE ||\n      action.type === SiteContextActions.LANGUAGE_CHANGE\n    ) {\n      state = undefined;\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearProductsState];\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  ProductsState,\n  PRODUCT_FEATURE,\n  StateWithProduct,\n} from '../product-state';\n\nexport const getProductsState: MemoizedSelector<\n  StateWithProduct,\n  ProductsState\n> = createFeatureSelector<ProductsState>(PRODUCT_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ProductReference } from '../../../model/product.model';\nimport {\n  ProductReferencesState,\n  ProductsState,\n  StateWithProduct,\n} from '../product-state';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductReferencesState: MemoizedSelector<\n  StateWithProduct,\n  ProductReferencesState\n> = createSelector(\n  getProductsState,\n  (state: ProductsState) => state.references\n);\n\nexport const getSelectedProductReferencesFactory = (\n  productCode: string,\n  referenceType: string\n): MemoizedSelector<StateWithProduct, ProductReference[]> => {\n  return createSelector(getProductReferencesState, (referenceTypeData) => {\n    if (referenceTypeData.productCode === productCode) {\n      if (!!referenceTypeData.list) {\n        if (referenceType) {\n          return referenceTypeData.list.filter(\n            (item) => item.referenceType === referenceType\n          );\n        }\n\n        return referenceTypeData.list;\n      } else {\n        return [];\n      }\n    }\n  });\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Review } from '../../../model/product.model';\nimport {\n  ProductReviewsState,\n  ProductsState,\n  StateWithProduct,\n} from '../product-state';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductReviewsState: MemoizedSelector<\n  StateWithProduct,\n  ProductReviewsState\n> = createSelector(getProductsState, (state: ProductsState) => state.reviews);\n\nexport const getSelectedProductReviewsFactory = (\n  productCode\n): MemoizedSelector<StateWithProduct, Review[]> => {\n  return createSelector(getProductReviewsState, (reviewData) => {\n    if (reviewData.productCode === productCode) {\n      return reviewData.list;\n    }\n  });\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport {\n  ProductsSearchState,\n  ProductsState,\n  StateWithProduct,\n} from '../product-state';\nimport * as fromProductSearch from '../reducers/product-search.reducer';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductsSearchState: MemoizedSelector<\n  StateWithProduct,\n  ProductsSearchState\n> = createSelector(getProductsState, (state: ProductsState) => state.search);\n\nexport const getSearchResults: MemoizedSelector<\n  StateWithProduct,\n  ProductSearchPage\n> = createSelector(getProductsSearchState, fromProductSearch.getSearchResults);\n\nexport const getAuxSearchResults: MemoizedSelector<\n  StateWithProduct,\n  ProductSearchPage\n> = createSelector(\n  getProductsSearchState,\n  fromProductSearch.getAuxSearchResults\n);\n\nexport const getProductSuggestions: MemoizedSelector<\n  StateWithProduct,\n  Suggestion[]\n> = createSelector(\n  getProductsSearchState,\n  fromProductSearch.getProductSuggestions\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Product } from '../../../model/product.model';\nimport { StateUtils } from '../../../state/utils/index';\nimport { ProductsState, StateWithProduct } from '../product-state';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductState: MemoizedSelector<\n  StateWithProduct,\n  StateUtils.EntityLoaderState<Product>\n> = createSelector(getProductsState, (state: ProductsState) => state.details);\n\nexport const getSelectedProductStateFactory = (\n  code: string,\n  scope = ''\n): MemoizedSelector<StateWithProduct, StateUtils.LoaderState<Product>> => {\n  return createSelector(\n    getProductState,\n    (details) =>\n      StateUtils.entityLoaderStateSelector(details, code)[scope] ||\n      StateUtils.initialLoaderState\n  );\n};\n\nexport const getSelectedProductFactory = (\n  code: string,\n  scope = ''\n): MemoizedSelector<StateWithProduct, Product> => {\n  return createSelector(\n    getSelectedProductStateFactory(code, scope),\n    (productState) => StateUtils.loaderValueSelector(productState)\n  );\n};\n\nexport const getSelectedProductLoadingFactory = (\n  code: string,\n  scope = ''\n): MemoizedSelector<StateWithProduct, boolean> => {\n  return createSelector(\n    getSelectedProductStateFactory(code, scope),\n    (productState) => StateUtils.loaderLoadingSelector(productState)\n  );\n};\n\nexport const getSelectedProductSuccessFactory = (\n  code: string,\n  scope = ''\n): MemoizedSelector<StateWithProduct, boolean> => {\n  return createSelector(\n    getSelectedProductStateFactory(code, scope),\n    (productState) => StateUtils.loaderSuccessSelector(productState)\n  );\n};\n\nexport const getSelectedProductErrorFactory = (\n  code: string,\n  scope = ''\n): MemoizedSelector<StateWithProduct, boolean> => {\n  return createSelector(\n    getSelectedProductStateFactory(code, scope),\n    (productState) => StateUtils.loaderErrorSelector(productState)\n  );\n};\n\nexport const getAllProductCodes: MemoizedSelector<\n  StateWithProduct,\n  string[]\n> = createSelector(getProductState, (details) => {\n  return Object.keys(details.entities);\n});\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { ProductReference } from '../../model/product.model';\nimport { ProductSelectors } from '../store';\nimport { ProductActions } from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductReferenceService {\n  constructor(protected store: Store<StateWithProduct>) {}\n\n  loadProductReferences(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): void {\n    this.store.dispatch(\n      new ProductActions.LoadProductReferences({\n        productCode,\n        referenceType,\n        pageSize,\n      })\n    );\n  }\n\n  getProductReferences(\n    productCode: string,\n    referenceType: string\n  ): Observable<ProductReference[]> {\n    return this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductReferencesFactory(\n          productCode,\n          referenceType\n        )\n      )\n    );\n  }\n\n  cleanReferences(): void {\n    this.store.dispatch(new ProductActions.CleanProductReferences());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { Review } from '../../model/product.model';\nimport { ProductActions } from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductReviewService {\n  constructor(protected store: Store<StateWithProduct>) {}\n\n  getByProductCode(productCode: string): Observable<Review[]> {\n    return this.store.pipe(\n      select(ProductSelectors.getSelectedProductReviewsFactory(productCode)),\n      tap((reviews) => {\n        if (reviews === undefined && productCode !== undefined) {\n          this.store.dispatch(\n            new ProductActions.LoadProductReviews(productCode)\n          );\n        }\n      })\n    );\n  }\n\n  add(productCode: string, review: Review): void {\n    this.store.dispatch(\n      new ProductActions.PostProductReview({\n        productCode: productCode,\n        review,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { ProductSearchPage } from '../../model/product-search.model';\nimport { SearchConfig } from '../model/search-config';\nimport { ProductActions } from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductSearchService {\n  constructor(protected store: Store<StateWithProduct>) {}\n\n  search(query: string, searchConfig?: SearchConfig): void {\n    this.store.dispatch(\n      new ProductActions.SearchProducts({\n        queryText: query,\n        searchConfig: searchConfig,\n      })\n    );\n  }\n\n  getResults(): Observable<ProductSearchPage> {\n    return this.store.pipe(select(ProductSelectors.getSearchResults));\n  }\n\n  clearResults(): void {\n    this.store.dispatch(\n      new ProductActions.ClearProductSearchResult({\n        clearPageResults: true,\n      })\n    );\n  }\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { Actions, ofType } from '@ngrx/effects';\nimport { select, Store } from '@ngrx/store';\nimport { defer, merge, Observable, of, SchedulerLike, using } from 'rxjs';\nimport {\n  debounceTime,\n  delay,\n  distinctUntilChanged,\n  filter,\n  map,\n  mapTo,\n  shareReplay,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { deepMerge } from '../../config/utils/deep-merge';\nimport { Product } from '../../model/product.model';\nimport { LoadingScopesService } from '../../occ/services/loading-scopes.service';\nimport { withdrawOn } from '../../util/rxjs/withdraw-on';\nimport { ProductActions } from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\nimport { ProductSelectors } from '../store/selectors/index';\nimport { uniteLatest } from '../../util/rxjs/unite-latest';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductLoadingService {\n  protected products: {\n    [code: string]: { [scope: string]: Observable<Product> };\n  } = {};\n\n  constructor(\n    protected store: Store<StateWithProduct>,\n    protected loadingScopes: LoadingScopesService,\n    protected actions$: Actions,\n    @Inject(PLATFORM_ID) protected platformId: any\n  ) {}\n\n  get(productCode: string, scopes: string[]): Observable<Product> {\n    scopes = this.loadingScopes.expand('product', scopes);\n\n    this.initProductScopes(productCode, scopes);\n    return this.products[productCode][this.getScopesIndex(scopes)];\n  }\n\n  protected initProductScopes(productCode: string, scopes: string[]): void {\n    if (!this.products[productCode]) {\n      this.products[productCode] = {};\n    }\n\n    for (const scope of scopes) {\n      if (!this.products[productCode][scope]) {\n        this.products[productCode][scope] = this.getProductForScope(\n          productCode,\n          scope\n        );\n      }\n    }\n\n    if (scopes.length > 1) {\n      this.products[productCode][this.getScopesIndex(scopes)] = uniteLatest(\n        scopes.map((scope) => this.products[productCode][scope])\n      ).pipe(\n        map((productParts) =>\n          productParts.every(Boolean)\n            ? deepMerge({}, ...productParts)\n            : undefined\n        ),\n        distinctUntilChanged()\n      );\n    }\n  }\n\n  protected getScopesIndex(scopes: string[]): string {\n    return scopes.join('ɵ');\n  }\n\n  /**\n   * Creates observable for providing specified product data for the scope\n   *\n   * @param productCode\n   * @param scope\n   */\n  protected getProductForScope(\n    productCode: string,\n    scope: string\n  ): Observable<Product> {\n    const shouldLoad$ = this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductStateFactory(productCode, scope)\n      ),\n      map(\n        (productState) =>\n          !productState.loading && !productState.success && !productState.error\n      ),\n      distinctUntilChanged(),\n      filter((x) => x)\n    );\n\n    const isLoading$ = this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductLoadingFactory(productCode, scope)\n      )\n    );\n\n    const productLoadLogic$ = merge(\n      shouldLoad$,\n      ...this.getProductReloadTriggers(productCode, scope)\n    ).pipe(\n      debounceTime(0),\n      withLatestFrom(isLoading$),\n      tap(([, isLoading]) => {\n        if (!isLoading) {\n          this.store.dispatch(\n            new ProductActions.LoadProduct(productCode, scope)\n          );\n        }\n      })\n    );\n\n    const productData$ = this.store.pipe(\n      select(ProductSelectors.getSelectedProductFactory(productCode, scope))\n    );\n\n    return using(\n      () => productLoadLogic$.subscribe(),\n      () => productData$\n    ).pipe(shareReplay({ bufferSize: 1, refCount: true }));\n  }\n\n  /**\n   * Returns reload triggers for product per scope\n   *\n   * @param productCode\n   * @param scope\n   */\n  protected getProductReloadTriggers(\n    productCode: string,\n    scope: string\n  ): Observable<boolean>[] {\n    const triggers = [];\n\n    // max age trigger add\n    const maxAge = this.loadingScopes.getMaxAge('product', scope);\n    if (maxAge && isPlatformBrowser(this.platformId)) {\n      // we want to grab load product success and load product fail for this product and scope\n      const loadFinish$ = this.actions$.pipe(\n        filter(\n          (\n            action:\n              | ProductActions.LoadProductSuccess\n              | ProductActions.LoadProductFail\n          ) =>\n            (action.type === ProductActions.LOAD_PRODUCT_SUCCESS ||\n              action.type === ProductActions.LOAD_PRODUCT_FAIL) &&\n            action.meta.entityId === productCode &&\n            action.meta.scope === scope\n        )\n      );\n\n      const loadStart$ = this.actions$.pipe(\n        ofType(ProductActions.LOAD_PRODUCT),\n        filter(\n          (action: ProductActions.LoadProduct) =>\n            action.payload === productCode && action.meta.scope === scope\n        )\n      );\n\n      triggers.push(this.getMaxAgeTrigger(loadStart$, loadFinish$, maxAge));\n    }\n\n    return triggers;\n  }\n\n  /**\n   * Generic method that returns stream triggering reload by maxAge\n   *\n   * Could be refactored to separate service in future to use in other\n   * max age reload implementations\n   *\n   * @param loadStart$ Stream that emits on load start\n   * @param loadFinish$ Stream that emits on load finish\n   * @param maxAge max age\n   */\n  private getMaxAgeTrigger(\n    loadStart$: Observable<any>,\n    loadFinish$: Observable<any>,\n    maxAge: number,\n    scheduler?: SchedulerLike\n  ): Observable<boolean> {\n    let timestamp = 0;\n\n    const now = () => (scheduler ? scheduler.now() : Date.now());\n\n    const timestamp$ = loadFinish$.pipe(tap(() => (timestamp = now())));\n\n    const shouldReload$: Observable<boolean> = defer(() => {\n      const age = now() - timestamp;\n\n      const timestampRefresh$ = timestamp$.pipe(\n        delay(maxAge, scheduler),\n        mapTo(true),\n        withdrawOn(loadStart$)\n      );\n\n      if (age > maxAge) {\n        // we should emit first value immediately\n        return merge(of(true), timestampRefresh$);\n      } else if (age === 0) {\n        // edge case, we should emit max age timeout after next load success\n        // could happen with artificial schedulers\n        return timestampRefresh$;\n      } else {\n        // we should emit first value when age will expire\n        return merge(\n          of(true).pipe(delay(maxAge - age, scheduler)),\n          timestampRefresh$\n        );\n      }\n    });\n\n    return shouldReload$;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { Product } from '../../model/product.model';\nimport { DEFAULT_SCOPE } from '../../occ/occ-models/occ-endpoints.model';\nimport { ProductScope } from '../model/product-scope';\nimport { ProductLoadingService } from '../services/product-loading.service';\nimport { ProductActions } from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductService {\n  constructor(\n    protected store: Store<StateWithProduct>,\n    protected productLoading: ProductLoadingService\n  ) {}\n\n  /**\n   * Returns the product observable. The product will be loaded\n   * whenever there's no value observed.\n   *\n   * The underlying product loader ensures that the product is\n   * only loaded once, even in case of parallel observers.\n   *\n   * You should provide product data scope you are interested in to not load all\n   * the data if not needed. You can provide more than one scope.\n   *\n   * @param productCode Product code to load\n   * @param scopes Scope or scopes of the product data\n   */\n  get(\n    productCode: string,\n    scopes: (ProductScope | string)[] | ProductScope | string = DEFAULT_SCOPE\n  ): Observable<Product> {\n    return productCode\n      ? this.productLoading.get(productCode, [].concat(scopes))\n      : of(undefined);\n  }\n\n  /**\n   * Returns boolean observable for product's loading state\n   */\n  isLoading(\n    productCode: string,\n    scope: ProductScope | string = ''\n  ): Observable<boolean> {\n    return this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductLoadingFactory(productCode, scope)\n      )\n    );\n  }\n\n  /**\n   * Returns boolean observable for product's load success state\n   */\n  isSuccess(\n    productCode: string,\n    scope: ProductScope | string = ''\n  ): Observable<boolean> {\n    return this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductSuccessFactory(productCode, scope)\n      )\n    );\n  }\n\n  /**\n   * Returns boolean observable for product's load error state\n   */\n  hasError(\n    productCode: string,\n    scope: ProductScope | string = ''\n  ): Observable<boolean> {\n    return this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductErrorFactory(productCode, scope)\n      )\n    );\n  }\n\n  /**\n   * Reloads the product. The product is loaded implicetly\n   * whenever selected by the `get`, but in some cases an\n   * explicit reload might be needed.\n   */\n  reload(productCode: string, scope: ProductScope | string = ''): void {\n    this.store.dispatch(new ProductActions.LoadProduct(productCode, scope));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { ProductSearchPage, Suggestion } from '../../model/index';\nimport { SearchConfig } from '../model/index';\nimport { ProductActions } from '../store/actions/index';\nimport { ProductSelectors } from '../store/selectors/index';\nimport { ProductSearchService } from './product-search.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SearchboxService extends ProductSearchService {\n  /**\n   * dispatch the search for the search box\n   */\n  search(query: string, searchConfig?: SearchConfig): void {\n    this.store.dispatch(\n      new ProductActions.SearchProducts(\n        {\n          queryText: query,\n          searchConfig: searchConfig,\n        },\n        true\n      )\n    );\n  }\n\n  getResults(): Observable<ProductSearchPage> {\n    return this.store.pipe(select(ProductSelectors.getAuxSearchResults));\n  }\n\n  /**\n   * clears the products and suggestions\n   */\n  clearResults(): void {\n    this.store.dispatch(\n      new ProductActions.ClearProductSearchResult({\n        clearSearchboxResults: true,\n      })\n    );\n  }\n\n  getSuggestionResults(): Observable<Suggestion[]> {\n    return this.store.pipe(select(ProductSelectors.getProductSuggestions));\n  }\n\n  searchSuggestions(query: string, searchConfig?: SearchConfig): void {\n    this.store.dispatch(\n      new ProductActions.GetProductSuggestions({\n        term: query,\n        searchConfig: searchConfig,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { BreadcrumbMeta, Page } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageBreadcrumbResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { ProductSearchPage } from '../../model/product-search.model';\nimport { ProductSearchService } from '../facade/product-search.service';\n\n/**\n * Resolves the page data for the Product Listing Page.\n *\n * The page title, and breadcrumbs are resolved in this implementation only.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class CategoryPageMetaResolver\n  extends PageMetaResolver\n  implements PageTitleResolver, PageBreadcrumbResolver {\n  // reusable observable for search page data\n  protected searchPage$: Observable<\n    ProductSearchPage | Page\n  > = this.cms.getCurrentPage().pipe(\n    filter(Boolean),\n    switchMap((page: Page) =>\n      // only the existence of a plp component tells us if products\n      // are rendered or if this is an ordinary content page\n      this.hasProductListComponent(page)\n        ? this.productSearchService.getResults().pipe(filter(Boolean))\n        : of(page)\n    )\n  );\n\n  constructor(\n    protected productSearchService: ProductSearchService,\n    protected cms: CmsService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.CATEGORY_PAGE;\n  }\n\n  resolveTitle(): Observable<string> {\n    return this.searchPage$.pipe(\n      filter((page: ProductSearchPage) => !!page.pagination),\n      switchMap((p: ProductSearchPage) =>\n        this.translation.translate('pageMetaResolver.category.title', {\n          count: p.pagination.totalResults,\n          query: p.breadcrumbs?.length\n            ? p.breadcrumbs[0].facetValueName\n            : undefined,\n        })\n      )\n    );\n  }\n\n  resolveBreadcrumbs(): Observable<BreadcrumbMeta[]> {\n    return combineLatest([\n      this.searchPage$.pipe(),\n      this.translation.translate('common.home'),\n    ]).pipe(\n      map(([p, label]: [ProductSearchPage, string]) =>\n        p.breadcrumbs\n          ? this.resolveBreadcrumbData(<ProductSearchPage>p, label)\n          : null\n      )\n    );\n  }\n\n  protected resolveBreadcrumbData(\n    page: ProductSearchPage,\n    label: string\n  ): BreadcrumbMeta[] {\n    const breadcrumbs: BreadcrumbMeta[] = [];\n    breadcrumbs.push({ label: label, link: '/' });\n\n    for (const br of page.breadcrumbs) {\n      if (br.facetCode === 'category' || br.facetCode === 'allCategories') {\n        breadcrumbs.push({\n          label: br.facetValueName,\n          link: `/c/${br.facetValueCode}`,\n        });\n      }\n      if (br.facetCode === 'brand') {\n        breadcrumbs.push({\n          label: br.facetValueName,\n          link: `/Brands/${br.facetValueName}/c/${br.facetValueCode}`,\n        });\n      }\n    }\n    return breadcrumbs;\n  }\n\n  protected hasProductListComponent(page: Page): boolean {\n    return !!Object.keys(page.slots).find(\n      (key) =>\n        !!page.slots[key].components?.find(\n          (comp) =>\n            comp.typeCode === 'CMSProductListComponent' ||\n            comp.typeCode === 'ProductGridComponent'\n        )\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { combineLatest, Observable } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { AuthService } from '../../auth/user-auth/facade/auth.service';\nimport { BreadcrumbMeta, Page } from '../../cms/model/page.model';\nimport {\n  PageBreadcrumbResolver,\n  PageMetaResolver,\n  PageTitleResolver,\n} from '../../cms/page';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { ProductSearchService } from '../../product/facade/product-search.service';\nimport { SemanticPathService } from '../../routing/configurable-routes/url-translation/semantic-path.service';\n\n/**\n * Resolves page meta data for the search result page, in case it's used\n * to query coupons. This is done by adding a `couponcode` query parameter\n * to the search page route.\n *\n * The page resolves an alternative page title and breadcrumb.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class CouponSearchPageResolver\n  extends PageMetaResolver\n  implements PageTitleResolver, PageBreadcrumbResolver {\n  protected total$: Observable<\n    number\n  > = this.productSearchService.getResults().pipe(\n    filter((data) => !!data?.pagination),\n    map((results) => results.pagination.totalResults)\n  );\n\n  constructor(\n    protected productSearchService: ProductSearchService,\n    protected translation: TranslationService,\n    protected authService: AuthService,\n    protected route: ActivatedRoute,\n    protected semanticPathService: SemanticPathService\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'SearchResultsListPageTemplate';\n  }\n\n  resolveBreadcrumbs(): Observable<BreadcrumbMeta[]> {\n    return combineLatest([\n      this.translation.translate('common.home'),\n      this.translation.translate('myCoupons.myCoupons'),\n      this.authService.isUserLoggedIn(),\n    ]).pipe(\n      map(([homeLabel, couponLabel, isLoggedIn]: [string, string, boolean]) => {\n        const breadcrumbs = [];\n        breadcrumbs.push({ label: homeLabel, link: '/' });\n        if (isLoggedIn) {\n          breadcrumbs.push({\n            label: couponLabel,\n            link: this.semanticPathService.transform({\n              cxRoute: 'coupons',\n            }),\n          });\n        }\n        return breadcrumbs;\n      })\n    );\n  }\n\n  resolveTitle(): Observable<string> {\n    return this.total$.pipe(\n      switchMap((total: number) =>\n        this.translation.translate('pageMetaResolver.search.findProductTitle', {\n          count: total,\n          coupon: this.couponCode,\n        })\n      )\n    );\n  }\n\n  getScore(page: Page): number {\n    return super.getScore(page) + (this.couponCode ? 1 : -1);\n  }\n\n  protected get couponCode(): string {\n    return this.route.snapshot?.queryParams?.couponcode;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { BreadcrumbMeta, PageRobotsMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageBreadcrumbResolver,\n  PageDescriptionResolver,\n  PageHeadingResolver,\n  PageImageResolver,\n  PageRobotsResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { Product } from '../../model/product.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { ProductService } from '../facade/product.service';\nimport { ProductScope } from '../model/product-scope';\n\n/**\n * Resolves the page data for the Product Detail Page\n * based on the `PageType.PRODUCT_PAGE`.\n *\n * The page title, heading, description, breadcrumbs and\n * first GALLERY image are resolved if available in the data.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductPageMetaResolver\n  extends PageMetaResolver\n  implements\n    PageHeadingResolver,\n    PageTitleResolver,\n    PageDescriptionResolver,\n    PageBreadcrumbResolver,\n    PageImageResolver,\n    PageRobotsResolver {\n  // reusable observable for product data based on the current page\n  protected product$ = this.routingService.getRouterState().pipe(\n    map((state) => state.state.params['productCode']),\n    filter((code) => !!code),\n    switchMap((code) => this.productService.get(code, ProductScope.DETAILS)),\n    filter(Boolean)\n  );\n\n  constructor(\n    protected routingService: RoutingService,\n    protected productService: ProductService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.PRODUCT_PAGE;\n  }\n\n  /**\n   * Resolves the page heading for the Product Detail Page.\n   * The page heading is used in the UI (`<h1>`), where as the page\n   * title is used by the browser and crawlers.\n   */\n  resolveHeading(): Observable<string> {\n    return this.product$.pipe(\n      switchMap((p: Product) =>\n        this.translation.translate('pageMetaResolver.product.heading', {\n          heading: p.name,\n        })\n      )\n    );\n  }\n\n  /**\n   * Resolves the page title for the Product Detail Page. The page title\n   * is resolved with the product name, the first category and the manufactorer.\n   * The page title used by the browser (history, tabs) and crawlers.\n   */\n  resolveTitle(): Observable<string> {\n    return this.product$.pipe(\n      switchMap((p: Product) => {\n        let title = p.name;\n        title += this.resolveFirstCategory(p);\n        title += this.resolveManufacturer(p);\n        return this.translation.translate('pageMetaResolver.product.title', {\n          title: title,\n        });\n      })\n    );\n  }\n\n  /**\n   * Resolves the page description for the Product Detail Page. The description\n   * is based on the `product.summary`.\n   */\n  resolveDescription(): Observable<string> {\n    return this.product$.pipe(\n      switchMap((p: Product) =>\n        this.translation.translate('pageMetaResolver.product.description', {\n          description: p.summary,\n        })\n      )\n    );\n  }\n\n  /**\n   * Resolves breadcrumbs for the Product Detail Page. The breadcrumbs are driven by\n   * a static home page crum and a crumb for each category.\n   */\n  resolveBreadcrumbs(): Observable<BreadcrumbMeta[]> {\n    return combineLatest([\n      this.product$.pipe(),\n      this.translation.translate('common.home'),\n    ]).pipe(\n      map(([p, label]: [Product, string]) => {\n        const breadcrumbs = [];\n        breadcrumbs.push({ label: label, link: '/' });\n        for (const { name, code, url } of p.categories || []) {\n          breadcrumbs.push({\n            label: name || code,\n            link: url,\n          });\n        }\n        return breadcrumbs;\n      })\n    );\n  }\n\n  /**\n   * Resolves the main page image for the Product Detail Page. The product image\n   * is based on the PRIMARY product image. The zoom format is used by default.\n   */\n  resolveImage(): Observable<string> {\n    return this.product$.pipe(\n      map((p: Product) =>\n        (<any>p.images?.PRIMARY)?.zoom?.url\n          ? (<any>p.images.PRIMARY).zoom.url\n          : null\n      )\n    );\n  }\n\n  protected resolveFirstCategory(product: Product): string {\n    let firstCategory;\n    if (product.categories?.length > 0) {\n      firstCategory = product.categories[0];\n    }\n    return firstCategory\n      ? ` | ${firstCategory.name || firstCategory.code}`\n      : '';\n  }\n\n  protected resolveManufacturer(product: Product): string {\n    return product.manufacturer ? ` | ${product.manufacturer}` : '';\n  }\n\n  /**\n   * Resolves the robot information for the Product Detail Page. The\n   * robot instruction defaults to FOLLOW and INDEX for all product pages,\n   * regardless of whether they're purchasable or not.\n   */\n  resolveRobots(): Observable<PageRobotsMeta[]> {\n    return of([PageRobotsMeta.FOLLOW, PageRobotsMeta.INDEX]);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { PageMetaResolver } from '../../cms';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { ProductSearchService } from '../facade/product-search.service';\n\n/**\n * Resolves the page data for the Search Result Page based on the\n * `PageType.CATEGORY_PAGE` and the `SearchResultsListPageTemplate` template.\n *\n * Only the page title is resolved in the standard implemenation.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class SearchPageMetaResolver\n  extends PageMetaResolver\n  implements PageMetaResolver {\n  protected total$: Observable<\n    number\n  > = this.productSearchService.getResults().pipe(\n    filter((data) => !!data?.pagination),\n    map((results) => results.pagination.totalResults)\n  );\n\n  protected query$: Observable<\n    string\n  > = this.routingService\n    .getRouterState()\n    .pipe(map((state) => state.state.params['query']));\n\n  constructor(\n    protected routingService: RoutingService,\n    protected productSearchService: ProductSearchService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'SearchResultsListPageTemplate';\n  }\n\n  resolveTitle(): Observable<string> {\n    const sources = [this.total$, this.query$];\n    return combineLatest(sources).pipe(\n      switchMap(([t, q]: [number, string]) =>\n        this.translation.translate('pageMetaResolver.search.title', {\n          count: t,\n          query: q,\n        })\n      )\n    );\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport {\n  StateConfig,\n  StateTransferType,\n} from '../../state/config/state-config';\nimport { effects } from './effects/index';\nimport { PRODUCT_FEATURE } from './product-state';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\nimport { provideDefaultConfigFactory } from '../../config/config-providers';\n\nexport function productStoreConfigFactory(): StateConfig {\n  // if we want to reuse PRODUCT_FEATURE const in config, we have to use factory instead of plain object\n  const config: StateConfig = {\n    state: {\n      ssrTransfer: {\n        keys: { [PRODUCT_FEATURE]: StateTransferType.TRANSFER_STATE },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    StoreModule.forFeature(PRODUCT_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(productStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class ProductStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { PageMetaResolver } from '../cms/page/page-meta.resolver';\nimport { CategoryPageMetaResolver } from './services/category-page-meta.resolver';\nimport { CouponSearchPageResolver } from './services/coupon-search-page-meta.resolver';\nimport { ProductPageMetaResolver } from './services/product-page-meta.resolver';\nimport { SearchPageMetaResolver } from './services/search-page-meta.resolver';\nimport { ProductStoreModule } from './store/product-store.module';\n\nconst pageTitleResolvers = [\n  {\n    provide: PageMetaResolver,\n    useExisting: ProductPageMetaResolver,\n    multi: true,\n  },\n  {\n    provide: PageMetaResolver,\n    useExisting: CategoryPageMetaResolver,\n    multi: true,\n  },\n  {\n    provide: PageMetaResolver,\n    useExisting: SearchPageMetaResolver,\n    multi: true,\n  },\n  {\n    provide: PageMetaResolver,\n    useExisting: CouponSearchPageResolver,\n    multi: true,\n  },\n];\n\n@NgModule({\n  imports: [ProductStoreModule],\n})\nexport class ProductModule {\n  static forRoot(): ModuleWithProviders<ProductModule> {\n    return {\n      ngModule: ProductModule,\n      providers: [...pageTitleResolvers],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  HttpRequest,\n  HttpHandler,\n  HttpEvent,\n  HttpInterceptor,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\nimport { SmartEditService } from '../services/smart-edit.service';\n\n@Injectable({ providedIn: 'root' })\nexport class CmsTicketInterceptor implements HttpInterceptor {\n  constructor(private service: SmartEditService) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (request.url.includes('/cms/') && this.service.cmsTicketId) {\n      request = request.clone({\n        setParams: {\n          cmsTicketId: this.service.cmsTicketId,\n        },\n      });\n    }\n\n    return next.handle(request);\n  }\n}\n","import { Provider } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\n\nimport { CmsTicketInterceptor } from './cms-ticket.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: CmsTicketInterceptor,\n    multi: true,\n  },\n];\n","import { NgModule, ModuleWithProviders } from '@angular/core';\n\nimport { interceptors } from './http-interceptors/index';\n\n@NgModule({})\nexport class SmartEditModule {\n  static forRoot(): ModuleWithProviders<SmartEditModule> {\n    return {\n      ngModule: SmartEditModule,\n      providers: [...interceptors],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { UserConsentAdapter } from './user-consent.adapter';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserConsentConnector {\n  constructor(protected adapter: UserConsentAdapter) {}\n\n  loadConsents(userId: string): Observable<ConsentTemplate[]> {\n    return this.adapter.loadConsents(userId);\n  }\n\n  giveConsent(\n    userId: string,\n    consentTemplateId: string,\n    consentTemplateVersion: number\n  ): Observable<ConsentTemplate> {\n    return this.adapter.giveConsent(\n      userId,\n      consentTemplateId,\n      consentTemplateVersion\n    );\n  }\n\n  withdrawConsent(userId: string, consentCode: string): Observable<{}> {\n    return this.adapter.withdrawConsent(userId, consentCode);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CostCenter } from '../../../model/org-unit.model';\nimport { UserCostCenterAdapter } from './user-cost-center.adapter';\nimport { EntitiesModel } from '../../../model/misc.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserCostCenterConnector {\n  constructor(protected adapter: UserCostCenterAdapter) {}\n\n  getActiveList(userId: string): Observable<EntitiesModel<CostCenter>> {\n    return this.adapter.loadActiveList(userId);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport {\n  CustomerCouponSearchResult,\n  CustomerCouponNotification,\n  CustomerCoupon2Customer,\n} from '../../../model/customer-coupon.model';\nimport { CustomerCouponAdapter } from './customer-coupon.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CustomerCouponConnector {\n  constructor(protected adapter: CustomerCouponAdapter) {}\n\n  getCustomerCoupons(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<CustomerCouponSearchResult> {\n    return this.adapter.getCustomerCoupons(userId, pageSize, currentPage, sort);\n  }\n\n  turnOnNotification(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCouponNotification> {\n    return this.adapter.turnOnNotification(userId, couponCode);\n  }\n\n  turnOffNotification(userId: string, couponCode: string): Observable<{}> {\n    return this.adapter.turnOffNotification(userId, couponCode);\n  }\n\n  claimCustomerCoupon(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCoupon2Customer> {\n    return this.adapter.claimCustomerCoupon(userId, couponCode);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { UserInterestsAdapter } from './user-interests.adapter';\nimport { Observable } from 'rxjs';\nimport {\n  ProductInterestSearchResult,\n  ProductInterestEntryRelation,\n  NotificationType,\n} from '../../../model/product-interest.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserInterestsConnector {\n  constructor(protected adapter: UserInterestsAdapter) {}\n  getInterests(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string,\n    productCode?: string,\n    notificationType?: NotificationType\n  ): Observable<ProductInterestSearchResult> {\n    return this.adapter.getInterests(\n      userId,\n      pageSize,\n      currentPage,\n      sort,\n      productCode,\n      notificationType\n    );\n  }\n\n  removeInterest(\n    userId: string,\n    item: ProductInterestEntryRelation\n  ): Observable<any[]> {\n    return this.adapter.removeInterest(userId, item);\n  }\n\n  addInterest(\n    userId: string,\n    productCode: string,\n    notificationType: NotificationType\n  ): Observable<any> {\n    return this.adapter.addInterest(userId, productCode, notificationType);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ConsignmentTracking } from '../../../model/consignment-tracking.model';\nimport {\n  CancellationRequestEntryInputList,\n  Order,\n  OrderHistoryList,\n  ReturnRequest,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequestModification,\n} from '../../../model/order.model';\nimport { UserOrderAdapter } from './user-order.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserOrderConnector {\n  constructor(protected adapter: UserOrderAdapter) {}\n\n  public get(userId: string, orderCode: string): Observable<Order> {\n    return this.adapter.load(userId, orderCode);\n  }\n\n  public getHistory(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<OrderHistoryList> {\n    return this.adapter.loadHistory(userId, pageSize, currentPage, sort);\n  }\n\n  public getConsignmentTracking(\n    orderCode: string,\n    consignmentCode: string,\n    userId?: string\n  ): Observable<ConsignmentTracking> {\n    return this.adapter.getConsignmentTracking(\n      orderCode,\n      consignmentCode,\n      userId\n    );\n  }\n\n  public cancel(\n    userId: string,\n    orderCode: string,\n    cancelRequestInput: CancellationRequestEntryInputList\n  ): Observable<{}> {\n    return this.adapter.cancel(userId, orderCode, cancelRequestInput);\n  }\n\n  public return(\n    userId: string,\n    returnRequestInput: ReturnRequestEntryInputList\n  ): Observable<ReturnRequest> {\n    return this.adapter.createReturnRequest(userId, returnRequestInput);\n  }\n\n  public getReturnRequestDetail(\n    userId: string,\n    returnRequestCode: string\n  ): Observable<ReturnRequest> {\n    return this.adapter.loadReturnRequestDetail(userId, returnRequestCode);\n  }\n\n  public getReturnRequestList(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<ReturnRequestList> {\n    return this.adapter.loadReturnRequestList(\n      userId,\n      pageSize,\n      currentPage,\n      sort\n    );\n  }\n\n  public cancelReturnRequest(\n    userId: string,\n    returnRequestCode: string,\n    returnRequestModification: ReturnRequestModification\n  ): Observable<{}> {\n    return this.adapter.cancelReturnRequest(\n      userId,\n      returnRequestCode,\n      returnRequestModification\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { UserPaymentAdapter } from './user-payment.adapter';\nimport { Observable } from 'rxjs';\nimport { PaymentDetails } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserPaymentConnector {\n  constructor(protected adapter: UserPaymentAdapter) {}\n\n  getAll(userId: string): Observable<PaymentDetails[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  delete(userId: string, paymentMethodID: string): Observable<{}> {\n    return this.adapter.delete(userId, paymentMethodID);\n  }\n\n  setDefault(userId: string, paymentMethodID: string): Observable<{}> {\n    return this.adapter.setDefault(userId, paymentMethodID);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\nimport { UserAdapter } from './user.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserConnector {\n  constructor(protected adapter: UserAdapter) {}\n\n  get(userId: string): Observable<User> {\n    return this.adapter.load(userId);\n  }\n\n  update(username: string, user: User): Observable<{}> {\n    return this.adapter.update(username, user);\n  }\n\n  register(user: UserSignUp): Observable<User> {\n    return this.adapter.register(user);\n  }\n\n  registerGuest(guid: string, password: string): Observable<User> {\n    return this.adapter.registerGuest(guid, password);\n  }\n\n  requestForgotPasswordEmail(userEmailAddress: string): Observable<{}> {\n    return this.adapter.requestForgotPasswordEmail(userEmailAddress);\n  }\n\n  resetPassword(token: string, newPassword: string): Observable<{}> {\n    return this.adapter.resetPassword(token, newPassword);\n  }\n\n  updateEmail(\n    userId: string,\n    currentPassword: string,\n    newUserId: string\n  ): Observable<{}> {\n    return this.adapter.updateEmail(userId, currentPassword, newUserId);\n  }\n\n  updatePassword(\n    userId: string,\n    oldPassword: string,\n    newPassword: string\n  ): Observable<{}> {\n    return this.adapter.updatePassword(userId, oldPassword, newPassword);\n  }\n\n  remove(userId: string): Observable<{}> {\n    return this.adapter.remove(userId);\n  }\n\n  getTitles(): Observable<Title[]> {\n    return this.adapter.loadTitles();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { merge, Observable } from 'rxjs';\nimport { distinctUntilChanged, map } from 'rxjs/operators';\nimport { AnonymousConsentsService } from '../../anonymous-consents/index';\nimport { AnonymousConsent, Consent } from '../../model/index';\nimport { UserConsentService } from './user-consent.service';\n\n/**\n * Unified facade for both anonymous and registered user consents.\n */\n@Injectable({ providedIn: 'root' })\nexport class ConsentService {\n  constructor(\n    protected anonymousConsentsService: AnonymousConsentsService,\n    protected userConsentService: UserConsentService\n  ) {}\n\n  /**\n   * Returns either anonymous consent or registered consent as they are emmited.\n   * @param templateCode for which to return either anonymous or registered consent.\n   */\n  getConsent(templateCode: string): Observable<AnonymousConsent | Consent> {\n    return merge(\n      this.userConsentService.getConsent(templateCode),\n      this.anonymousConsentsService.getConsent(templateCode)\n    );\n  }\n\n  /**\n   * Checks if the `templateId`'s template has a given consent.\n   * The method returns `false` if the consent doesn't exist or if it's withdrawn. Otherwise, `true` is returned.\n   *\n   * @param templateId of a template which's consent should be checked\n   */\n  checkConsentGivenByTemplateId(templateId: string): Observable<boolean> {\n    return this.getConsent(templateId).pipe(\n      map((consent) => {\n        if (!consent) {\n          return false;\n        }\n\n        return this.isAnonymousConsentType(consent)\n          ? this.anonymousConsentsService.isConsentGiven(consent)\n          : this.userConsentService.isConsentGiven(consent);\n      }),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Checks if the `templateId`'s template has a withdrawn consent.\n   * The method returns `true` if the consent doesn't exist or if it's withdrawn. Otherwise, `false` is returned.\n   *\n   * @param templateId of a template which's consent should be checked\n   */\n  checkConsentWithdrawnByTemplateId(templateId: string): Observable<boolean> {\n    return this.getConsent(templateId).pipe(\n      map((consent) => {\n        if (!consent) {\n          return true;\n        }\n\n        return this.isAnonymousConsentType(consent)\n          ? this.anonymousConsentsService.isConsentWithdrawn(consent)\n          : this.userConsentService.isConsentWithdrawn(consent);\n      }),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   *\n   * Checks the provided `consent`'s type and delegates to an appropriate method - `anonymousConsentsService.isConsentGiven(consent)` or `this.userConsentService.isConsentGiven`\n   *\n   * @param consent a consent to check\n   */\n  isConsentGiven(consent: AnonymousConsent | Consent): boolean {\n    return this.isAnonymousConsentType(consent)\n      ? this.anonymousConsentsService.isConsentGiven(consent)\n      : this.userConsentService.isConsentGiven(consent);\n  }\n\n  /**\n   *\n   * Checks the provided `consent`'s type and delegates to an appropriate method - `anonymousConsentsService.isConsentWithdrawn(consent)` or `this.userConsentService.isConsentWithdrawn`\n   *\n   * @param consent a consent to check\n   */\n  isConsentWithdrawn(consent: AnonymousConsent | Consent): boolean {\n    return this.isAnonymousConsentType(consent)\n      ? this.anonymousConsentsService.isConsentWithdrawn(consent)\n      : this.userConsentService.isConsentWithdrawn(consent);\n  }\n\n  /**\n   * Returns `true` if the provided consent is of type `AnonymousConsent`. Otherwise, `false` is returned.\n   */\n  isAnonymousConsentType(\n    consent: AnonymousConsent | Consent\n  ): consent is AnonymousConsent {\n    if (!consent) {\n      return false;\n    }\n\n    return (consent as AnonymousConsent).templateCode !== undefined;\n  }\n\n  /**\n   * Returns `true` if the provided consent is of type `Consent`. Otherwise, `false` is returned.\n   */\n  isConsentType(consent: AnonymousConsent | Consent): consent is Consent {\n    if (!consent) {\n      return false;\n    }\n\n    return (consent as Consent).code !== undefined;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, Observable } from 'rxjs';\nimport { filter, map, tap } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { CustomerCouponSearchResult } from '../../model/customer-coupon.model';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  CLAIM_CUSTOMER_COUPON_PROCESS_ID,\n  StateWithUser,\n  SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID,\n  UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID,\n} from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CustomerCouponService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Retrieves customer's coupons\n   * @param pageSize page size\n   * @param currentPage current page\n   * @param sort sort\n   */\n  loadCustomerCoupons(\n    pageSize: number,\n    currentPage?: number,\n    sort?: string\n  ): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.LoadCustomerCoupons({\n          userId,\n          pageSize: pageSize,\n          currentPage: currentPage,\n          sort: sort,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns customer coupon search result\n   * @param pageSize page size\n   */\n  getCustomerCoupons(pageSize: number): Observable<CustomerCouponSearchResult> {\n    return combineLatest([\n      this.store.pipe(select(UsersSelectors.getCustomerCouponsState)),\n      this.getClaimCustomerCouponResultLoading(),\n    ]).pipe(\n      filter(([, loading]) => !loading),\n      tap(([customerCouponsState]) => {\n        const attemptedLoad =\n          customerCouponsState.loading ||\n          customerCouponsState.success ||\n          customerCouponsState.error;\n        if (!attemptedLoad) {\n          this.loadCustomerCoupons(pageSize);\n        }\n      }),\n      map(([customerCouponsState]) => customerCouponsState.value)\n    );\n  }\n\n  /**\n   * Returns a loaded flag for customer coupons\n   */\n  getCustomerCouponsLoaded(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getCustomerCouponsLoaded));\n  }\n\n  /**\n   * Returns a loading flag for customer coupons\n   */\n  getCustomerCouponsLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getCustomerCouponsLoading));\n  }\n\n  /**\n   * Subscribe a CustomerCoupon Notification\n   * @param couponCode a customer coupon code\n   */\n  subscribeCustomerCoupon(couponCode: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.SubscribeCustomerCoupon({\n          userId,\n          couponCode: couponCode,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the subscribe customer coupon notification process loading flag\n   */\n  getSubscribeCustomerCouponResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the subscribe customer coupon notification process success flag\n   */\n  getSubscribeCustomerCouponResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the subscribe customer coupon notification process error flag\n   */\n  getSubscribeCustomerCouponResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Unsubscribe a CustomerCoupon Notification\n   * @param couponCode a customer coupon code\n   */\n  unsubscribeCustomerCoupon(couponCode: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.UnsubscribeCustomerCoupon({\n          userId,\n          couponCode: couponCode,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the unsubscribe customer coupon notification process loading flag\n   */\n  getUnsubscribeCustomerCouponResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the unsubscribe customer coupon notification process success flag\n   */\n  getUnsubscribeCustomerCouponResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the unsubscribe customer coupon notification process error flag\n   */\n  getUnsubscribeCustomerCouponResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Claim a CustomerCoupon\n   * @param couponCode a customer coupon code\n   */\n  claimCustomerCoupon(couponCode: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.ClaimCustomerCoupon({\n          userId,\n          couponCode,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the claim customer coupon notification process success flag\n   */\n  getClaimCustomerCouponResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(CLAIM_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the claim customer coupon notification process loading flag\n   */\n  getClaimCustomerCouponResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(CLAIM_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport {\n  ReturnRequest,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequestModification,\n} from '../../model/order.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport { CANCEL_RETURN_PROCESS_ID, StateWithUser } from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OrderReturnRequestService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Create order return request\n   * @param orderCode an order code\n   * @param returnRequestInput order return request entry input\n   */\n  createOrderReturnRequest(\n    returnRequestInput: ReturnRequestEntryInputList\n  ): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.CreateOrderReturnRequest({\n          userId,\n          returnRequestInput,\n        })\n      );\n    });\n  }\n\n  /**\n   * Return an order return request\n   */\n  getOrderReturnRequest(): Observable<ReturnRequest> {\n    return this.store.pipe(select(UsersSelectors.getOrderReturnRequest));\n  }\n\n  /**\n   * Gets order return request list\n   */\n  getOrderReturnRequestList(pageSize: number): Observable<ReturnRequestList> {\n    return this.store.pipe(\n      select(UsersSelectors.getOrderReturnRequestListState),\n      tap((returnListState) => {\n        const attemptedLoad =\n          returnListState.loading ||\n          returnListState.success ||\n          returnListState.error;\n        if (!attemptedLoad) {\n          this.loadOrderReturnRequestList(pageSize);\n        }\n      }),\n      map((returnListState) => returnListState.value)\n    );\n  }\n\n  /**\n   * Loads order return request detail\n   * @param returnRequestCode\n   */\n  loadOrderReturnRequestDetail(returnRequestCode: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.LoadOrderReturnRequest({\n          userId,\n          returnRequestCode,\n        })\n      );\n    });\n  }\n\n  /**\n   * Loads order return request list\n   * @param pageSize page size\n   * @param currentPage current page\n   * @param sort sort\n   */\n  loadOrderReturnRequestList(\n    pageSize: number,\n    currentPage?: number,\n    sort?: string\n  ): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      if (userId !== OCC_USER_ID_ANONYMOUS) {\n        this.store.dispatch(\n          new UserActions.LoadOrderReturnRequestList({\n            userId,\n            pageSize,\n            currentPage,\n            sort,\n          })\n        );\n      }\n    });\n  }\n\n  /**\n   * Cleaning order return request list\n   */\n  clearOrderReturnRequestList(): void {\n    this.store.dispatch(new UserActions.ClearOrderReturnRequestList());\n  }\n\n  /**\n   * Get the order return request loading flag\n   */\n  getReturnRequestLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getOrderReturnRequestLoading));\n  }\n\n  /**\n   * Get the order return request success flag\n   */\n  getReturnRequestSuccess(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getOrderReturnRequestSuccess));\n  }\n\n  /**\n   * Cleaning order return request details\n   */\n  clearOrderReturnRequestDetail(): void {\n    this.store.dispatch(new UserActions.ClearOrderReturnRequest());\n  }\n\n  /*\n   * Cancel order return request\n   */\n  cancelOrderReturnRequest(\n    returnRequestCode: string,\n    returnRequestModification: ReturnRequestModification\n  ): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.CancelOrderReturnRequest({\n          userId,\n          returnRequestCode,\n          returnRequestModification,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the cancel return request loading flag\n   */\n  getCancelReturnRequestLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(CANCEL_RETURN_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the cancel return request success flag\n   */\n  getCancelReturnRequestSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(CANCEL_RETURN_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the cancel return request process flags\n   */\n  resetCancelReturnRequestProcessState(): void {\n    return this.store.dispatch(new UserActions.ResetCancelReturnProcess());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { Address, Country, Region } from '../../model/address.model';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport { StateWithUser } from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserAddressService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Retrieves user's addresses\n   */\n  loadAddresses(): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(new UserActions.LoadUserAddresses(userId));\n    });\n  }\n\n  /**\n   * Adds user address\n   * @param address a user address\n   */\n  addUserAddress(address: Address): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.AddUserAddress({\n          userId,\n          address,\n        })\n      );\n    });\n  }\n\n  /**\n   * Sets user address as default\n   * @param addressId a user address ID\n   */\n  setAddressAsDefault(addressId: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.UpdateUserAddress({\n          userId,\n          addressId,\n          address: { defaultAddress: true },\n        })\n      );\n    });\n  }\n\n  /**\n   * Updates existing user address\n   * @param addressId a user address ID\n   * @param address a user address\n   */\n  updateUserAddress(addressId: string, address: Address): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.UpdateUserAddress({\n          userId,\n          addressId,\n          address,\n        })\n      );\n    });\n  }\n\n  /**\n   * Deletes existing user address\n   * @param addressId a user address ID\n   */\n  deleteUserAddress(addressId: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.DeleteUserAddress({\n          userId,\n          addressId,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns addresses\n   */\n  getAddresses(): Observable<Address[]> {\n    return this.store.pipe(select(UsersSelectors.getAddresses));\n  }\n\n  /**\n   * Returns a loading flag for addresses\n   */\n  getAddressesLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getAddressesLoading));\n  }\n\n  getAddressesLoadedSuccess(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getAddressesLoadedSuccess));\n  }\n  /**\n   * Retrieves delivery countries\n   */\n  loadDeliveryCountries(): void {\n    this.store.dispatch(new UserActions.LoadDeliveryCountries());\n  }\n\n  /**\n   * Returns all delivery countries\n   */\n  getDeliveryCountries(): Observable<Country[]> {\n    return this.store.pipe(select(UsersSelectors.getAllDeliveryCountries));\n  }\n\n  /**\n   * Returns a country based on the provided `isocode`\n   * @param isocode an isocode for a country\n   */\n  getCountry(isocode: string): Observable<Country> {\n    return this.store.pipe(\n      select(UsersSelectors.countrySelectorFactory(isocode))\n    );\n  }\n\n  /**\n   * Retrieves regions for specified country by `countryIsoCode`\n   * @param countryIsoCode\n   */\n  loadRegions(countryIsoCode: string): void {\n    this.store.dispatch(new UserActions.LoadRegions(countryIsoCode));\n  }\n\n  /**\n   * Clear regions in store - useful when changing country\n   */\n  clearRegions(): void {\n    this.store.dispatch(new UserActions.ClearRegions());\n  }\n\n  /**\n   * Returns all regions\n   */\n  getRegions(countryIsoCode: string): Observable<Region[]> {\n    return this.store.pipe(\n      select(UsersSelectors.getRegionsDataAndLoading),\n      map(({ regions, country, loading, loaded }) => {\n        if (!countryIsoCode && (loading || loaded)) {\n          this.clearRegions();\n          return [];\n        } else if (loading && !loaded) {\n          // don't interrupt loading\n          return [];\n        } else if (!loading && countryIsoCode !== country && countryIsoCode) {\n          // country changed - clear store and load new regions\n          if (country) {\n            this.clearRegions();\n          }\n          this.loadRegions(countryIsoCode);\n          return [];\n        }\n        return regions;\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport { Observable, queueScheduler } from 'rxjs';\nimport { filter, map, observeOn, tap } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { Address } from '../../model/address.model';\nimport { CostCenter } from '../../model/org-unit.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport { StateWithUser } from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserCostCenterService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Load all visible active cost centers for the currently login user\n   */\n  loadActiveCostCenters(): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      if (userId && userId !== OCC_USER_ID_ANONYMOUS) {\n        this.store.dispatch(new UserActions.LoadActiveCostCenters(userId));\n      }\n    });\n  }\n\n  private getCostCentersState(): Observable<LoaderState<CostCenter[]>> {\n    return this.store.select(UsersSelectors.getCostCentersState);\n  }\n\n  /**\n   * Get all visible active cost centers\n   */\n  getActiveCostCenters(): Observable<CostCenter[]> {\n    return this.getCostCentersState().pipe(\n      observeOn(queueScheduler),\n      tap((process: LoaderState<CostCenter[]>) => {\n        if (!(process.loading || process.success || process.error)) {\n          this.loadActiveCostCenters();\n        }\n      }),\n      filter(\n        (process: LoaderState<CostCenter[]>) => process.success || process.error\n      ),\n      map((result) => result.value)\n    );\n  }\n\n  /**\n   * Get the addresses of the cost center's unit based on cost center id\n   * @param costCenterId cost center id\n   */\n  getCostCenterAddresses(costCenterId: string): Observable<Address[]> {\n    return this.getActiveCostCenters().pipe(\n      map((costCenters) => {\n        const costCenter = costCenters.find((cc) => cc.code === costCenterId);\n        if (costCenter && costCenter.unit) {\n          return costCenter.unit.addresses;\n        } else {\n          return [];\n        }\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport {\n  NotificationType,\n  ProductInterestEntryRelation,\n  ProductInterestSearchResult,\n} from '../../model/product-interest.model';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  ADD_PRODUCT_INTEREST_PROCESS_ID,\n  REMOVE_PRODUCT_INTERESTS_PROCESS_ID,\n  StateWithUser,\n} from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserInterestsService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Retrieves an product interest list\n   * @param pageSize page size\n   * @param currentPage current page\n   * @param sort sort\n   */\n  loadProductInterests(\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string,\n    productCode?: string,\n    notificationType?: NotificationType\n  ): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.LoadProductInterests({\n          userId,\n          pageSize: pageSize,\n          currentPage: currentPage,\n          sort: sort,\n          productCode: productCode,\n          notificationType: notificationType,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns product interests\n   */\n  getProductInterests(): Observable<ProductInterestSearchResult> {\n    return this.store.pipe(select(UsersSelectors.getInterests));\n  }\n\n  /**\n   * Returns product interests\n   * @param pageSize the page size\n   */\n  getAndLoadProductInterests(\n    pageSize?: number\n  ): Observable<ProductInterestSearchResult> {\n    return this.store.pipe(\n      select(UsersSelectors.getInterestsState),\n      tap((interestListState) => {\n        const attemptedLoad =\n          interestListState.loading ||\n          interestListState.success ||\n          interestListState.error;\n        if (!attemptedLoad) {\n          this.loadProductInterests(pageSize);\n        }\n      }),\n      map((interestListState) => interestListState.value)\n    );\n  }\n\n  /**\n   * Returns a loading flag for product interests\n   */\n  getProdutInterestsLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getInterestsLoading));\n  }\n\n  /**\n   * Removes a ProductInterestRelation\n   * @param item product interest relation item\n   * @param singleDelete flag to delete only one interest\n   */\n  removeProdutInterest(\n    item: ProductInterestEntryRelation,\n    singleDelete?: boolean\n  ): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.RemoveProductInterest({\n          userId,\n          item: item,\n          singleDelete: singleDelete,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns a loading flag for removing product interests.\n   */\n  getRemoveProdutInterestLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(REMOVE_PRODUCT_INTERESTS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns a success flag for removing a product interests.\n   */\n  getRemoveProdutInterestSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(REMOVE_PRODUCT_INTERESTS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Add a new product interest.\n   *\n   * @param productCode the product code\n   * @param notificationType the notification type\n   */\n  addProductInterest(\n    productCode: string,\n    notificationType: NotificationType\n  ): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.AddProductInterest({\n          userId,\n          productCode: productCode,\n          notificationType: notificationType,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns a success flag for adding a product interest.\n   */\n  getAddProductInterestSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(ADD_PRODUCT_INTEREST_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns a error flag for adding a product interest.\n   */\n  getAddProductInterestError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(ADD_PRODUCT_INTEREST_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Reset product interest adding state.\n   */\n  resetAddInterestState(): void {\n    this.store.dispatch(new UserActions.ResetAddInterestState());\n  }\n\n  /**\n   * Reset product interest removing state.\n   */\n  resetRemoveInterestState(): void {\n    this.store.dispatch(new UserActions.ResetRemoveInterestState());\n  }\n\n  /**\n   * Clears product interests\n   */\n  clearProductInterests(): void {\n    this.store.dispatch(new UserActions.ClearProductInterests());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { NotificationPreference } from '../../model/notification-preference.model';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { getProcessLoadingFactory } from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  StateWithUser,\n  UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID,\n} from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserNotificationPreferenceService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Returns all notification preferences.\n   */\n  getPreferences(): Observable<NotificationPreference[]> {\n    return this.store.pipe(select(UsersSelectors.getPreferences));\n  }\n\n  /**\n   * Returns all enabled notification preferences.\n   */\n  getEnabledPreferences(): Observable<NotificationPreference[]> {\n    return this.store.pipe(select(UsersSelectors.getEnabledPreferences));\n  }\n\n  /**\n   * Loads all notification preferences.\n   */\n  loadPreferences(): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(new UserActions.LoadNotificationPreferences(userId));\n    });\n  }\n\n  /**\n   * Clear all notification preferences.\n   */\n  clearPreferences(): void {\n    this.store.dispatch(new UserActions.ClearNotificationPreferences());\n  }\n\n  /**\n   * Returns a loading flag for notification preferences.\n   */\n  getPreferencesLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getPreferencesLoading));\n  }\n\n  /**\n   * Updating notification preferences.\n   * @param preferences a preference list\n   */\n  updatePreferences(preferences: NotificationPreference[]): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.UpdateNotificationPreferences({\n          userId,\n          preferences: preferences,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns a loading flag for updating preferences.\n   */\n  getUpdatePreferencesResultLoading(): Observable<boolean> {\n    return this.store.select(\n      getProcessLoadingFactory(UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID)\n    );\n  }\n\n  /**\n   * Resets the update notification preferences process state. The state needs to be\n   * reset after the process concludes, regardless if it's a success or an error.\n   */\n  resetNotificationPreferences(): void {\n    this.store.dispatch(new UserActions.ResetNotificationPreferences());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, take, tap } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { ConsignmentTracking } from '../../model/consignment-tracking.model';\nimport {\n  CancellationRequestEntryInputList,\n  Order,\n  OrderHistoryList,\n} from '../../model/order.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport { CANCEL_ORDER_PROCESS_ID, StateWithUser } from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserOrderService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected userIdService: UserIdService,\n    protected routingService: RoutingService\n  ) {}\n\n  /**\n   * Returns an order's detail\n   */\n  getOrderDetails(): Observable<Order> {\n    return this.store.pipe(select(UsersSelectors.getOrderDetails));\n  }\n\n  /**\n   * Retrieves order's details\n   *\n   * @param orderCode an order code\n   */\n  loadOrderDetails(orderCode: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.LoadOrderDetails({\n          userId,\n          orderCode,\n        })\n      );\n    });\n  }\n\n  /**\n   * Clears order's details\n   */\n  clearOrderDetails(): void {\n    this.store.dispatch(new UserActions.ClearOrderDetails());\n  }\n\n  /**\n   * Returns order history list\n   */\n  getOrderHistoryList(pageSize: number): Observable<OrderHistoryList> {\n    return this.store.pipe(\n      select(UsersSelectors.getOrdersState),\n      tap((orderListState) => {\n        const attemptedLoad =\n          orderListState.loading ||\n          orderListState.success ||\n          orderListState.error;\n        if (!attemptedLoad) {\n          this.loadOrderList(pageSize);\n        }\n      }),\n      map((orderListState) => orderListState.value)\n    );\n  }\n\n  /**\n   * Returns a loaded flag for order history list\n   */\n  getOrderHistoryListLoaded(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getOrdersLoaded));\n  }\n\n  /**\n   * Retrieves an order list\n   * @param pageSize page size\n   * @param currentPage current page\n   * @param sort sort\n   */\n  loadOrderList(pageSize: number, currentPage?: number, sort?: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      if (userId !== OCC_USER_ID_ANONYMOUS) {\n        let replenishmentOrderCode: string;\n\n        this.routingService\n          .getRouterState()\n          .pipe(take(1))\n          .subscribe((data) => {\n            replenishmentOrderCode =\n              data?.state?.params?.replenishmentOrderCode;\n          })\n          .unsubscribe();\n\n        this.store.dispatch(\n          new UserActions.LoadUserOrders({\n            userId,\n            pageSize,\n            currentPage,\n            sort,\n            replenishmentOrderCode,\n          })\n        );\n      }\n    });\n  }\n\n  /**\n   * Cleaning order list\n   */\n  clearOrderList(): void {\n    this.store.dispatch(new UserActions.ClearUserOrders());\n  }\n\n  /**\n   *  Returns a consignment tracking detail\n   */\n  getConsignmentTracking(): Observable<ConsignmentTracking> {\n    return this.store.pipe(select(UsersSelectors.getConsignmentTracking));\n  }\n\n  /**\n   * Retrieves consignment tracking details\n   * @param orderCode an order code\n   * @param consignmentCode a consignment code\n   */\n  loadConsignmentTracking(orderCode: string, consignmentCode: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.LoadConsignmentTracking({\n          userId,\n          orderCode,\n          consignmentCode,\n        })\n      );\n    });\n  }\n\n  /**\n   * Cleaning consignment tracking\n   */\n  clearConsignmentTracking(): void {\n    this.store.dispatch(new UserActions.ClearConsignmentTracking());\n  }\n\n  /*\n   * Cancel an order\n   */\n  cancelOrder(\n    orderCode: string,\n    cancelRequestInput: CancellationRequestEntryInputList\n  ): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.CancelOrder({\n          userId,\n          orderCode,\n          cancelRequestInput,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the cancel order loading flag\n   */\n  getCancelOrderLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(CANCEL_ORDER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the cancel order success flag\n   */\n  getCancelOrderSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(CANCEL_ORDER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the cancel order process flags\n   */\n  resetCancelOrderProcessState(): void {\n    return this.store.dispatch(new UserActions.ResetCancelOrderProcess());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport { Country } from '../../model/address.model';\nimport { PaymentDetails } from '../../model/cart.model';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport { StateWithUser } from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserPaymentService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Loads all user's payment methods.\n   */\n  loadPaymentMethods(): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(new UserActions.LoadUserPaymentMethods(userId));\n    });\n  }\n\n  /**\n   * Returns all user's payment methods\n   */\n  getPaymentMethods(): Observable<PaymentDetails[]> {\n    return this.store.pipe(select(UsersSelectors.getPaymentMethods));\n  }\n\n  /**\n   * Returns a loading flag for payment methods\n   */\n  getPaymentMethodsLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getPaymentMethodsLoading));\n  }\n\n  getPaymentMethodsLoadedSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(UsersSelectors.getPaymentMethodsLoadedSuccess)\n    );\n  }\n  /**\n   * Sets the payment as a default one\n   * @param paymentMethodId a payment method ID\n   */\n  setPaymentMethodAsDefault(paymentMethodId: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.SetDefaultUserPaymentMethod({\n          userId,\n          paymentMethodId,\n        })\n      );\n    });\n  }\n\n  /**\n   * Deletes the payment method\n   *\n   * @param paymentMethodId a payment method ID\n   */\n  deletePaymentMethod(paymentMethodId: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      this.store.dispatch(\n        new UserActions.DeleteUserPaymentMethod({\n          userId,\n          paymentMethodId,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns all billing countries\n   */\n  getAllBillingCountries(): Observable<Country[]> {\n    return this.store.pipe(select(UsersSelectors.getAllBillingCountries));\n  }\n\n  /**\n   * Retrieves billing countries\n   */\n  loadBillingCountries(): void {\n    this.store.dispatch(new UserActions.LoadBillingCountries());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { UserIdService } from '../../auth/user-auth/facade/user-id.service';\nimport {\n  ReplenishmentOrder,\n  ReplenishmentOrderList,\n} from '../../model/replenishment-order.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  CANCEL_REPLENISHMENT_ORDER_PROCESS_ID,\n  StateWithUser,\n} from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserReplenishmentOrderService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected userIdService: UserIdService\n  ) {}\n\n  /**\n   * Returns replenishment order details for a given 'current' user\n   *\n   * @param replenishmentOrderCode a replenishment order code\n   */\n  loadReplenishmentOrderDetails(replenishmentOrderCode: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      if (userId !== OCC_USER_ID_ANONYMOUS) {\n        this.store.dispatch(\n          new UserActions.LoadReplenishmentOrderDetails({\n            userId,\n            replenishmentOrderCode,\n          })\n        );\n      }\n    });\n  }\n\n  /**\n   * Returns a replenishment order details\n   */\n  getReplenishmentOrderDetails(): Observable<ReplenishmentOrder> {\n    return this.store.pipe(\n      select(UsersSelectors.getReplenishmentOrderDetailsValue)\n    );\n  }\n\n  /**\n   * Returns a replenishment order details loading flag\n   */\n  getReplenishmentOrderDetailsLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(UsersSelectors.getReplenishmentOrderDetailsLoading)\n    );\n  }\n\n  /**\n   * Returns a replenishment order details success flag\n   */\n  getReplenishmentOrderDetailsSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(UsersSelectors.getReplenishmentOrderDetailsSuccess)\n    );\n  }\n\n  /**\n   * Returns a replenishment order details error flag\n   */\n  getReplenishmentOrderDetailsError(): Observable<boolean> {\n    return this.store.pipe(\n      select(UsersSelectors.getReplenishmentOrderDetailsError)\n    );\n  }\n\n  /**\n   * Clears the replenishment orders details state\n   */\n  clearReplenishmentOrderDetails(): void {\n    this.store.dispatch(new UserActions.ClearReplenishmentOrderDetails());\n  }\n\n  /**\n   * Cancels a specific replenishment order for a given 'current' user\n   *\n   * @param replenishmentOrderCode a replenishment order code\n   */\n  cancelReplenishmentOrder(replenishmentOrderCode: string): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      if (userId !== OCC_USER_ID_ANONYMOUS) {\n        this.store.dispatch(\n          new UserActions.CancelReplenishmentOrder({\n            userId,\n            replenishmentOrderCode,\n          })\n        );\n      }\n    });\n  }\n\n  /**\n   * Returns the cancel replenishment order loading flag\n   */\n  getCancelReplenishmentOrderLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(CANCEL_REPLENISHMENT_ORDER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the cancel replenishment order success flag\n   */\n  getCancelReplenishmentOrderSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(CANCEL_REPLENISHMENT_ORDER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the cancel replenishment order error flag\n   */\n  getCancelReplenishmentOrderError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(CANCEL_REPLENISHMENT_ORDER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Clears the cancel replenishment order processing state\n   */\n  clearCancelReplenishmentOrderProcessState(): void {\n    this.store.dispatch(new UserActions.ClearCancelReplenishmentOrder());\n  }\n\n  /**\n   * Returns replenishment order history list\n   */\n  getReplenishmentOrderHistoryList(\n    pageSize: number\n  ): Observable<ReplenishmentOrderList> {\n    return this.store.pipe(\n      select(UsersSelectors.getReplenishmentOrdersState),\n      tap((replenishmentOrderListState) => {\n        const attemptedLoad =\n          replenishmentOrderListState.loading ||\n          replenishmentOrderListState.success ||\n          replenishmentOrderListState.error;\n        if (!attemptedLoad) {\n          this.loadReplenishmentOrderList(pageSize);\n        }\n      }),\n      map((replenishmentOrderListState) => replenishmentOrderListState.value)\n    );\n  }\n\n  /**\n   * Returns a loading flag for replenishment order history list\n   */\n  getReplenishmentOrderHistoryListLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(UsersSelectors.getReplenishmentOrdersLoading)\n    );\n  }\n\n  /**\n   * Returns a error flag for replenishment order history list\n   */\n  getReplenishmentOrderHistoryListError(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getReplenishmentOrdersError));\n  }\n\n  /**\n   * Returns a success flag for replenishment order history list\n   */\n  getReplenishmentOrderHistoryListSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(UsersSelectors.getReplenishmentOrdersSuccess)\n    );\n  }\n\n  /**\n   * Retrieves a replenishment order list\n   * @param pageSize page size\n   * @param currentPage current page\n   * @param sort sort\n   */\n  loadReplenishmentOrderList(\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): void {\n    this.userIdService.invokeWithUserId((userId) => {\n      if (userId !== OCC_USER_ID_ANONYMOUS) {\n        this.store.dispatch(\n          new UserActions.LoadUserReplenishmentOrders({\n            userId,\n            pageSize,\n            currentPage,\n            sort,\n          })\n        );\n      }\n    });\n  }\n\n  /**\n   * Cleaning replenishment order list\n   */\n  clearReplenishmentOrderList(): void {\n    this.store.dispatch(new UserActions.ClearUserReplenishmentOrders());\n  }\n}\n","import { UserActions } from '../actions/index';\nimport { BillingCountriesState } from '../user-state';\n\nexport const initialState: BillingCountriesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.BillingCountriesAction | UserActions.ClearUserMiscsData\n): BillingCountriesState {\n  switch (action.type) {\n    case UserActions.LOAD_BILLING_COUNTRIES_SUCCESS: {\n      const billingCountries = action.payload;\n      const entities = billingCountries.reduce(\n        (countryEntities: { [isocode: string]: any }, name: any) => {\n          return {\n            ...countryEntities,\n            [name.isocode]: name,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case UserActions.CLEAR_USER_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { ConsignmentTracking } from '../../../model/index';\nimport { UserActions } from '../actions/index';\nimport { ConsignmentTrackingState } from '../user-state';\n\nexport const initialState: ConsignmentTrackingState = {};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.ConsignmentTrackingAction\n): ConsignmentTrackingState {\n  switch (action.type) {\n    case UserActions.LOAD_CONSIGNMENT_TRACKING_SUCCESS: {\n      const tracking: ConsignmentTracking = action.payload;\n      return {\n        tracking,\n      };\n    }\n    case UserActions.CLEAR_CONSIGNMENT_TRACKING: {\n      return initialState;\n    }\n  }\n  return state;\n}\n","import * as fromActions from '../actions/customer-coupon.action';\nimport {\n  CustomerCoupon,\n  CustomerCouponSearchResult,\n} from '../../../model/customer-coupon.model';\n\nexport const initialState: CustomerCouponSearchResult = {\n  coupons: [],\n  sorts: [],\n  pagination: {},\n};\nexport function reducer(\n  state = initialState,\n  action: fromActions.CustomerCouponAction\n): CustomerCouponSearchResult {\n  switch (action.type) {\n    case fromActions.LOAD_CUSTOMER_COUPONS_SUCCESS: {\n      return action.payload;\n    }\n\n    case fromActions.SUBSCRIBE_CUSTOMER_COUPON_SUCCESS: {\n      const updatedCustomerCoupon = action.payload.coupon;\n      const customerCoupons = new Array<CustomerCoupon>(state.coupons.length);\n      state.coupons.forEach((customerCoupon: CustomerCoupon, index) =>\n        customerCoupon.couponId === updatedCustomerCoupon.couponId\n          ? (customerCoupons[index] = updatedCustomerCoupon)\n          : (customerCoupons[index] = customerCoupon)\n      );\n      return { ...state, coupons: customerCoupons };\n    }\n\n    case fromActions.UNSUBSCRIBE_CUSTOMER_COUPON_SUCCESS: {\n      const updatedCouponCode = action.payload;\n      const customerCoupons = new Array<CustomerCoupon>(state.coupons.length);\n      state.coupons.forEach((customerCoupon: CustomerCoupon, index) =>\n        customerCoupon.couponId === updatedCouponCode\n          ? (customerCoupons[index] = {\n              ...customerCoupon,\n              notificationOn: false,\n            })\n          : (customerCoupons[index] = customerCoupon)\n      );\n      return { ...state, coupons: customerCoupons };\n    }\n  }\n  return state;\n}\n","import { Country } from '../../../model/address.model';\nimport { UserActions } from '../actions/index';\nimport { DeliveryCountriesState } from '../user-state';\n\nexport const initialState: DeliveryCountriesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.DeliveryCountriesAction | UserActions.ClearUserMiscsData\n): DeliveryCountriesState {\n  switch (action.type) {\n    case UserActions.LOAD_DELIVERY_COUNTRIES_SUCCESS: {\n      const deliveryCountries = action.payload;\n      const entities = deliveryCountries.reduce(\n        (countryEntities: { [isocode: string]: Country }, country: Country) => {\n          return {\n            ...countryEntities,\n            [country.isocode]: country,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case UserActions.CLEAR_USER_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { NotificationPreference } from '../../../model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: NotificationPreference[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.NotificationPreferenceAction\n): NotificationPreference[] {\n  switch (action.type) {\n    case UserActions.LOAD_NOTIFICATION_PREFERENCES_FAIL: {\n      return initialState;\n    }\n\n    case UserActions.LOAD_NOTIFICATION_PREFERENCES_SUCCESS:\n    case UserActions.UPDATE_NOTIFICATION_PREFERENCES_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n  }\n\n  return state;\n}\n","import { Order } from '../../../model/order.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: Order = {};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.OrderDetailsAction\n): Order {\n  switch (action.type) {\n    case UserActions.LOAD_ORDER_DETAILS_SUCCESS: {\n      const order: Order = action.payload;\n      return order;\n    }\n  }\n  return state;\n}\n","import { ReturnRequestList } from '../../../model/order.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: ReturnRequestList = {\n  returnRequests: [],\n  pagination: {},\n  sorts: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.OrderReturnRequestAction\n): ReturnRequestList {\n  switch (action.type) {\n    case UserActions.LOAD_ORDER_RETURN_REQUEST_LIST_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n  }\n\n  return state;\n}\n","import { PaymentDetails } from '../../../model/cart.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: PaymentDetails[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserPaymentMethodsAction\n): PaymentDetails[] {\n  switch (action.type) {\n    case UserActions.LOAD_USER_PAYMENT_METHODS_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n\n    case UserActions.LOAD_USER_PAYMENT_METHODS_FAIL: {\n      return initialState;\n    }\n  }\n  return state;\n}\n","import { UserActions } from '../actions/index';\nimport { ProductInterestSearchResult } from '../../../model/product-interest.model';\n\nexport const initialState: ProductInterestSearchResult = {\n  results: [],\n  pagination: {},\n  sorts: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.ProductInterestsAction\n): ProductInterestSearchResult {\n  switch (action.type) {\n    case UserActions.LOAD_PRODUCT_INTERESTS_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n    case UserActions.LOAD_PRODUCT_INTERESTS_FAIL: {\n      return initialState;\n    }\n  }\n  return state;\n}\n","import { Region } from '../../../model/address.model';\nimport { UserActions } from '../actions/index';\nimport { RegionsState } from '../user-state';\n\nexport const initialState: RegionsState = {\n  entities: [],\n  country: null,\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.RegionsAction | UserActions.ClearUserMiscsData\n): RegionsState {\n  switch (action.type) {\n    case UserActions.LOAD_REGIONS_SUCCESS: {\n      const entities: Region[] = action.payload.entities;\n      const country: string = action.payload.country;\n      if (entities || country) {\n        return {\n          ...state,\n          entities,\n          country,\n        };\n      }\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { ReplenishmentOrder } from '../../../model/replenishment-order.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: ReplenishmentOrder = {};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.ReplenishmentOrderDetailsAction\n): ReplenishmentOrder {\n  switch (action.type) {\n    case UserActions.LOAD_REPLENISHMENT_ORDER_DETAILS_SUCCESS:\n    case UserActions.CANCEL_REPLENISHMENT_ORDER_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n\n    default: {\n      return state;\n    }\n  }\n}\n","import { UserActions } from '../actions/index';\n\nexport const initialState = false;\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.ResetPasswordAction\n): boolean {\n  switch (action.type) {\n    case UserActions.RESET_PASSWORD_SUCCESS: {\n      return true;\n    }\n  }\n  return state;\n}\n","import { Title } from '../../../model/misc.model';\nimport { UserActions } from '../actions/index';\nimport { TitlesState } from '../user-state';\n\nexport const initialState: TitlesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.TitlesAction | UserActions.ClearUserMiscsData\n): TitlesState {\n  switch (action.type) {\n    case UserActions.LOAD_TITLES_SUCCESS: {\n      const titles = action.payload;\n      const entities = titles.reduce(\n        (titleEntities: { [code: string]: Title }, name: Title) => {\n          return {\n            ...titleEntities,\n            [name.code]: name,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case UserActions.CLEAR_USER_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { Address } from '../../../model/address.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: Address[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserAddressesAction\n): Address[] {\n  switch (action.type) {\n    case UserActions.LOAD_USER_ADDRESSES_FAIL: {\n      return initialState;\n    }\n\n    case UserActions.LOAD_USER_ADDRESSES_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n  }\n  return state;\n}\n","import { ConsentTemplate } from '../../../model/consent.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: ConsentTemplate[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserConsentsAction\n): ConsentTemplate[] {\n  switch (action.type) {\n    case UserActions.LOAD_USER_CONSENTS_SUCCESS: {\n      const consents = action.payload;\n      return consents ? consents : initialState;\n    }\n\n    case UserActions.GIVE_USER_CONSENT_SUCCESS: {\n      const updatedConsentTemplate = action.consentTemplate;\n      return state.map((consentTemplate) =>\n        consentTemplate.id === updatedConsentTemplate.id\n          ? updatedConsentTemplate\n          : consentTemplate\n      );\n    }\n  }\n\n  return state;\n}\n","import { CostCenter } from '../../../model/org-unit.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: CostCenter[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserCostCenterAction\n): CostCenter[] {\n  switch (action.type) {\n    case UserActions.LOAD_ACTIVE_COST_CENTERS_FAIL: {\n      return initialState;\n    }\n\n    case UserActions.LOAD_ACTIVE_COST_CENTERS_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n  }\n  return state;\n}\n","import { User } from '../../../model/misc.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: User = <User>{};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserDetailsAction | UserActions.EmailActions\n): User {\n  switch (action.type) {\n    case UserActions.LOAD_USER_DETAILS_SUCCESS: {\n      return action.payload;\n    }\n\n    case UserActions.UPDATE_USER_DETAILS_SUCCESS: {\n      const updatedDetails: User = {\n        ...state,\n        ...action.userUpdates,\n      };\n      return {\n        ...updatedDetails,\n        name: `${updatedDetails.firstName} ${updatedDetails.lastName}`,\n      };\n    }\n  }\n\n  return state;\n}\n","import { OrderHistoryList } from '../../../model/order.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: OrderHistoryList = {\n  orders: [],\n  pagination: {},\n  sorts: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserOrdersAction\n): OrderHistoryList {\n  switch (action.type) {\n    case UserActions.LOAD_USER_ORDERS_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n    case UserActions.LOAD_USER_ORDERS_FAIL: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import {\n  ReplenishmentOrder,\n  ReplenishmentOrderList,\n} from '../../../model/replenishment-order.model';\nimport { UserActions } from '../actions/index';\nexport const initialState: ReplenishmentOrderList = {\n  replenishmentOrders: [],\n  pagination: {},\n  sorts: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action:\n    | UserActions.UserReplenishmentOrdersAction\n    | UserActions.ReplenishmentOrderDetailsAction\n): ReplenishmentOrderList {\n  switch (action.type) {\n    case UserActions.LOAD_USER_REPLENISHMENT_ORDERS_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n\n    case UserActions.CANCEL_REPLENISHMENT_ORDER_SUCCESS: {\n      const cancelledReplenishmentOrder = action.payload;\n      const userReplenishmentOrders = [...state.replenishmentOrders];\n\n      const index = userReplenishmentOrders.findIndex(\n        (replenishmentOrder: ReplenishmentOrder) =>\n          replenishmentOrder.replenishmentOrderCode ===\n          cancelledReplenishmentOrder.replenishmentOrderCode\n      );\n\n      if (index === -1) {\n        return initialState;\n      } else {\n        userReplenishmentOrders[index] = {\n          ...cancelledReplenishmentOrder,\n        };\n      }\n\n      return { ...state, replenishmentOrders: userReplenishmentOrders };\n    }\n  }\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  ActionReducer,\n  ActionReducerMap,\n  combineReducers,\n  MetaReducer,\n} from '@ngrx/store';\nimport { AuthActions } from '../../../auth/user-auth/store/actions/index';\nimport { Address } from '../../../model/address.model';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { CustomerCouponSearchResult } from '../../../model/customer-coupon.model';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\nimport {\n  Order,\n  OrderHistoryList,\n  ReturnRequest,\n  ReturnRequestList,\n} from '../../../model/order.model';\nimport { CostCenter } from '../../../model/org-unit.model';\nimport { ProductInterestSearchResult } from '../../../model/product-interest.model';\nimport {\n  ReplenishmentOrder,\n  ReplenishmentOrderList,\n} from '../../../model/replenishment-order.model';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport {\n  CUSTOMER_COUPONS,\n  NOTIFICATION_PREFERENCES,\n  PRODUCT_INTERESTS,\n  REGIONS,\n  RegionsState,\n  UserState,\n  USER_ADDRESSES,\n  USER_CONSENTS,\n  USER_COST_CENTERS,\n  USER_ORDERS,\n  USER_ORDER_DETAILS,\n  USER_PAYMENT_METHODS,\n  USER_REPLENISHMENT_ORDERS,\n  USER_REPLENISHMENT_ORDER_DETAILS,\n  USER_RETURN_REQUESTS,\n  USER_RETURN_REQUEST_DETAILS,\n} from '../user-state';\nimport * as fromBillingCountriesReducer from './billing-countries.reducer';\nimport * as fromConsignmentTrackingReducer from './consignment-tracking.reducer';\nimport * as fromCustomerCouponReducer from './customer-coupon.reducer';\nimport * as fromDeliveryCountries from './delivery-countries.reducer';\nimport * as fromNotificationPreferenceReducer from './notification-preference.reducer';\nimport * as fromOrderDetailsReducer from './order-details.reducer';\nimport * as fromOrderReturnRequestReducer from './order-return-request.reducer';\nimport * as fromPaymentReducer from './payment-methods.reducer';\nimport * as fromInterestsReducer from './product-interests.reducer';\nimport * as fromRegionsReducer from './regions.reducer';\nimport * as fromReplenishmentOrderDetailsReducer from './replenishment-order-details.reducer';\nimport * as fromResetPasswordReducer from './reset-password.reducer';\nimport * as fromTitlesReducer from './titles.reducer';\nimport * as fromAddressesReducer from './user-addresses.reducer';\nimport * as fromUserConsentsReducer from './user-consents.reducer';\nimport * as fromCostCenterReducer from './user-cost-center.reducer';\nimport * as fromUserDetailsReducer from './user-details.reducer';\nimport * as fromUserOrdersReducer from './user-orders.reducer';\nimport * as fromUserReplenishmentOrdersReducer from './user-replenishment-orders.reducer';\n\nexport function getReducers(): ActionReducerMap<UserState> {\n  return {\n    account: combineReducers({\n      details: fromUserDetailsReducer.reducer,\n    }),\n    addresses: loaderReducer<Address[]>(\n      USER_ADDRESSES,\n      fromAddressesReducer.reducer\n    ),\n    billingCountries: fromBillingCountriesReducer.reducer,\n    consents: loaderReducer<ConsentTemplate[]>(\n      USER_CONSENTS,\n      fromUserConsentsReducer.reducer\n    ),\n    payments: loaderReducer<PaymentDetails[]>(\n      USER_PAYMENT_METHODS,\n      fromPaymentReducer.reducer\n    ),\n    orders: loaderReducer<OrderHistoryList>(\n      USER_ORDERS,\n      fromUserOrdersReducer.reducer\n    ),\n    order: loaderReducer<Order>(\n      USER_ORDER_DETAILS,\n      fromOrderDetailsReducer.reducer\n    ),\n    replenishmentOrders: loaderReducer<ReplenishmentOrderList>(\n      USER_REPLENISHMENT_ORDERS,\n      fromUserReplenishmentOrdersReducer.reducer\n    ),\n    orderReturn: loaderReducer<ReturnRequest>(USER_RETURN_REQUEST_DETAILS),\n    orderReturnList: loaderReducer<ReturnRequestList>(\n      USER_RETURN_REQUESTS,\n      fromOrderReturnRequestReducer.reducer\n    ),\n    countries: fromDeliveryCountries.reducer,\n    titles: fromTitlesReducer.reducer,\n    regions: loaderReducer<RegionsState>(REGIONS, fromRegionsReducer.reducer),\n    resetPassword: fromResetPasswordReducer.reducer,\n    consignmentTracking: fromConsignmentTrackingReducer.reducer,\n    customerCoupons: loaderReducer<CustomerCouponSearchResult>(\n      CUSTOMER_COUPONS,\n      fromCustomerCouponReducer.reducer\n    ),\n    notificationPreferences: loaderReducer<NotificationPreference[]>(\n      NOTIFICATION_PREFERENCES,\n      fromNotificationPreferenceReducer.reducer\n    ),\n    productInterests: loaderReducer<ProductInterestSearchResult>(\n      PRODUCT_INTERESTS,\n      fromInterestsReducer.reducer\n    ),\n    costCenters: loaderReducer<CostCenter[]>(\n      USER_COST_CENTERS,\n      fromCostCenterReducer.reducer\n    ),\n    replenishmentOrder: loaderReducer<ReplenishmentOrder>(\n      USER_REPLENISHMENT_ORDER_DETAILS,\n      fromReplenishmentOrderDetailsReducer.reducer\n    ),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  UserState\n>> = new InjectionToken<ActionReducerMap<UserState>>('UserReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearUserState(\n  reducer: ActionReducer<any>\n): ActionReducer<any> {\n  return function (state, action) {\n    if (action.type === AuthActions.LOGOUT) {\n      state = undefined;\n    }\n\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearUserState];\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { CountryType } from '../../../model/address.model';\nimport { SiteConnector } from '../../../site-context/connectors/site.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class BillingCountriesEffect {\n  @Effect()\n  loadBillingCountries$: Observable<\n    UserActions.BillingCountriesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_BILLING_COUNTRIES),\n    switchMap(() => {\n      return this.siteConnector.getCountries(CountryType.BILLING).pipe(\n        map(\n          (countries) => new UserActions.LoadBillingCountriesSuccess(countries)\n        ),\n        catchError((error) =>\n          of(\n            new UserActions.LoadBillingCountriesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class ClearMiscsDataEffect {\n  @Effect()\n  clearMiscsData$: Observable<Action> = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      SiteContextActions.CURRENCY_CHANGE\n    ),\n    map(() => {\n      return new UserActions.ClearUserMiscsData();\n    })\n  );\n\n  constructor(private actions$: Actions) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { ConsignmentTracking } from '../../../model/consignment-tracking.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserOrderConnector } from '../../connectors/order/user-order.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class ConsignmentTrackingEffects {\n  @Effect()\n  loadConsignmentTracking$: Observable<\n    UserActions.ConsignmentTrackingAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_CONSIGNMENT_TRACKING),\n    map((action: UserActions.LoadConsignmentTracking) => action.payload),\n    switchMap((payload) => {\n      return this.userOrderConnector\n        .getConsignmentTracking(\n          payload.orderCode,\n          payload.consignmentCode,\n          payload.userId\n        )\n        .pipe(\n          map(\n            (tracking: ConsignmentTracking) =>\n              new UserActions.LoadConsignmentTrackingSuccess(tracking)\n          ),\n          catchError((error) =>\n            of(\n              new UserActions.LoadConsignmentTrackingFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userOrderConnector: UserOrderConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport * as fromCustomerCouponsAction from '../actions/customer-coupon.action';\nimport { CustomerCouponConnector } from '../../connectors/customer-coupon/customer-coupon.connector';\nimport { CustomerCouponSearchResult } from '../../../model/customer-coupon.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\n\n@Injectable()\nexport class CustomerCouponEffects {\n  @Effect()\n  loadCustomerCoupons$: Observable<\n    fromCustomerCouponsAction.CustomerCouponAction\n  > = this.actions$.pipe(\n    ofType(fromCustomerCouponsAction.LOAD_CUSTOMER_COUPONS),\n    map(\n      (action: fromCustomerCouponsAction.LoadCustomerCoupons) => action.payload\n    ),\n    mergeMap((payload) => {\n      return this.customerCouponConnector\n        .getCustomerCoupons(\n          payload.userId,\n          payload.pageSize,\n          payload.currentPage,\n          payload.sort\n        )\n        .pipe(\n          map((coupons: CustomerCouponSearchResult) => {\n            return new fromCustomerCouponsAction.LoadCustomerCouponsSuccess(\n              coupons\n            );\n          }),\n          catchError((error) =>\n            of(\n              new fromCustomerCouponsAction.LoadCustomerCouponsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  subscribeCustomerCoupon$: Observable<\n    fromCustomerCouponsAction.CustomerCouponAction\n  > = this.actions$.pipe(\n    ofType(fromCustomerCouponsAction.SUBSCRIBE_CUSTOMER_COUPON),\n    map(\n      (action: fromCustomerCouponsAction.SubscribeCustomerCoupon) =>\n        action.payload\n    ),\n    mergeMap((payload) => {\n      return this.customerCouponConnector\n        .turnOnNotification(payload.userId, payload.couponCode)\n        .pipe(\n          map((data: any) => {\n            return new fromCustomerCouponsAction.SubscribeCustomerCouponSuccess(\n              data\n            );\n          }),\n          catchError((error) =>\n            of(\n              new fromCustomerCouponsAction.SubscribeCustomerCouponFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  unsubscribeCustomerCoupon$: Observable<\n    fromCustomerCouponsAction.CustomerCouponAction\n  > = this.actions$.pipe(\n    ofType(fromCustomerCouponsAction.UNSUBSCRIBE_CUSTOMER_COUPON),\n    map(\n      (action: fromCustomerCouponsAction.UnsubscribeCustomerCoupon) =>\n        action.payload\n    ),\n    mergeMap((payload) => {\n      return this.customerCouponConnector\n        .turnOffNotification(payload.userId, payload.couponCode)\n        .pipe(\n          map(() => {\n            return new fromCustomerCouponsAction.UnsubscribeCustomerCouponSuccess(\n              payload.couponCode\n            );\n          }),\n          catchError((error) =>\n            of(\n              new fromCustomerCouponsAction.UnsubscribeCustomerCouponFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  claimCustomerCoupon$: Observable<\n    fromCustomerCouponsAction.CustomerCouponAction\n  > = this.actions$.pipe(\n    ofType(fromCustomerCouponsAction.CLAIM_CUSTOMER_COUPON),\n    map(\n      (action: fromCustomerCouponsAction.ClaimCustomerCoupon) => action.payload\n    ),\n    mergeMap((payload) => {\n      return this.customerCouponConnector\n        .claimCustomerCoupon(payload.userId, payload.couponCode)\n        .pipe(\n          map((data) => {\n            return new fromCustomerCouponsAction.ClaimCustomerCouponSuccess(\n              data\n            );\n          }),\n          catchError((error) =>\n            of(\n              new fromCustomerCouponsAction.ClaimCustomerCouponFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private customerCouponConnector: CustomerCouponConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { CountryType } from '../../../model/address.model';\nimport { SiteConnector } from '../../../site-context/connectors/site.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class DeliveryCountriesEffects {\n  @Effect()\n  loadDeliveryCountries$: Observable<\n    UserActions.DeliveryCountriesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_DELIVERY_COUNTRIES),\n    switchMap(() => {\n      return this.siteConnector.getCountries(CountryType.SHIPPING).pipe(\n        map(\n          (countries) => new UserActions.LoadDeliveryCountriesSuccess(countries)\n        ),\n        catchError((error) =>\n          of(\n            new UserActions.LoadDeliveryCountriesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map, switchMap } from 'rxjs/operators';\nimport { GlobalMessageType } from '../../../global-message/models/global-message.model';\nimport { GlobalMessageActions } from '../../../global-message/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class ForgotPasswordEffects {\n  @Effect()\n  requestForgotPasswordEmail$: Observable<\n    | UserActions.ForgotPasswordEmailRequestSuccess\n    | GlobalMessageActions.AddMessage\n    | UserActions.ForgotPasswordEmailRequestFail\n  > = this.actions$.pipe(\n    ofType(UserActions.FORGOT_PASSWORD_EMAIL_REQUEST),\n    map((action: UserActions.ForgotPasswordEmailRequest) => {\n      return action.payload;\n    }),\n    concatMap((userEmailAddress) => {\n      return this.userAccountConnector\n        .requestForgotPasswordEmail(userEmailAddress)\n        .pipe(\n          switchMap(() => [\n            new UserActions.ForgotPasswordEmailRequestSuccess(),\n            new GlobalMessageActions.AddMessage({\n              text: { key: 'forgottenPassword.passwordResetEmailSent' },\n              type: GlobalMessageType.MSG_TYPE_CONFIRMATION,\n            }),\n          ]),\n          catchError((error) =>\n            of(\n              new UserActions.ForgotPasswordEmailRequestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserNotificationPreferenceConnector } from '../../connectors/notification-preference/user-notification-preference.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class NotificationPreferenceEffects {\n  @Effect()\n  loadPreferences$: Observable<\n    UserActions.NotificationPreferenceAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_NOTIFICATION_PREFERENCES),\n    map((action: UserActions.LoadNotificationPreferences) => action.payload),\n    switchMap((payload) =>\n      this.connector.loadAll(payload).pipe(\n        map(\n          (preferences) =>\n            new UserActions.LoadNotificationPreferencesSuccess(preferences)\n        ),\n        catchError((error) =>\n          of(\n            new UserActions.LoadNotificationPreferencesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n\n  @Effect()\n  updatePreferences$: Observable<\n    UserActions.NotificationPreferenceAction\n  > = this.actions$.pipe(\n    ofType(UserActions.UPDATE_NOTIFICATION_PREFERENCES),\n    map((action: UserActions.UpdateNotificationPreferences) => action.payload),\n    mergeMap((payload) =>\n      this.connector.update(payload.userId, payload.preferences).pipe(\n        map(\n          () =>\n            new UserActions.UpdateNotificationPreferencesSuccess(\n              payload.preferences\n            )\n        ),\n        catchError((error) =>\n          of(\n            new UserActions.UpdateNotificationPreferencesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private connector: UserNotificationPreferenceConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { Order } from '../../../model/order.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserOrderConnector } from '../../connectors/order/user-order.connector';\nimport { UserActions } from '../actions/index';\nimport {\n  GlobalMessageService,\n  GlobalMessageType,\n} from '../../../global-message/index';\n\n@Injectable()\nexport class OrderDetailsEffect {\n  @Effect()\n  loadOrderDetails$: Observable<\n    UserActions.OrderDetailsAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_ORDER_DETAILS),\n    map((action: UserActions.LoadOrderDetails) => action.payload),\n    switchMap((payload) => {\n      return this.orderConnector.get(payload.userId, payload.orderCode).pipe(\n        map((order: Order) => {\n          return new UserActions.LoadOrderDetailsSuccess(order);\n        }),\n        catchError((error) =>\n          of(new UserActions.LoadOrderDetailsFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  @Effect()\n  cancelOrder$: Observable<UserActions.OrderDetailsAction> = this.actions$.pipe(\n    ofType(UserActions.CANCEL_ORDER),\n    map((action: UserActions.CancelOrder) => action.payload),\n    switchMap((payload) => {\n      return this.orderConnector\n        .cancel(payload.userId, payload.orderCode, payload.cancelRequestInput)\n        .pipe(\n          map(() => new UserActions.CancelOrderSuccess()),\n          catchError((error) => {\n            error.error?.errors.forEach((err) =>\n              this.globalMessageService.add(\n                err.message,\n                GlobalMessageType.MSG_TYPE_ERROR\n              )\n            );\n\n            return of(\n              new UserActions.CancelOrderFail(makeErrorSerializable(error))\n            );\n          })\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private orderConnector: UserOrderConnector,\n    private globalMessageService: GlobalMessageService\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { ReturnRequest, ReturnRequestList } from '../../../model/order.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserOrderConnector } from '../../connectors/order/user-order.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class OrderReturnRequestEffect {\n  @Effect()\n  createReturnRequest$: Observable<\n    UserActions.OrderReturnRequestAction\n  > = this.actions$.pipe(\n    ofType(UserActions.CREATE_ORDER_RETURN_REQUEST),\n    map((action: UserActions.CreateOrderReturnRequest) => action.payload),\n    switchMap((payload) => {\n      return this.orderConnector\n        .return(payload.userId, payload.returnRequestInput)\n        .pipe(\n          map(\n            (returnRequest: ReturnRequest) =>\n              new UserActions.CreateOrderReturnRequestSuccess(returnRequest)\n          ),\n          catchError((error) =>\n            of(\n              new UserActions.CreateOrderReturnRequestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  loadReturnRequest$: Observable<\n    UserActions.OrderReturnRequestAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_ORDER_RETURN_REQUEST),\n    map((action: UserActions.LoadOrderReturnRequest) => action.payload),\n    switchMap((payload) => {\n      return this.orderConnector\n        .getReturnRequestDetail(payload.userId, payload.returnRequestCode)\n        .pipe(\n          map(\n            (returnRequest: ReturnRequest) =>\n              new UserActions.LoadOrderReturnRequestSuccess(returnRequest)\n          ),\n          catchError((error) =>\n            of(\n              new UserActions.LoadOrderReturnRequestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  cancelReturnRequest$: Observable<\n    UserActions.OrderReturnRequestAction\n  > = this.actions$.pipe(\n    ofType(UserActions.CANCEL_ORDER_RETURN_REQUEST),\n    map((action: UserActions.CancelOrderReturnRequest) => action.payload),\n    switchMap((payload) => {\n      return this.orderConnector\n        .cancelReturnRequest(\n          payload.userId,\n          payload.returnRequestCode,\n          payload.returnRequestModification\n        )\n        .pipe(\n          map(() => new UserActions.CancelOrderReturnRequestSuccess()),\n          catchError((error) =>\n            of(\n              new UserActions.CancelOrderReturnRequestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  loadReturnRequestList$: Observable<\n    UserActions.OrderReturnRequestAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_ORDER_RETURN_REQUEST_LIST),\n    map((action: UserActions.LoadOrderReturnRequestList) => action.payload),\n    switchMap((payload) => {\n      return this.orderConnector\n        .getReturnRequestList(\n          payload.userId,\n          payload.pageSize,\n          payload.currentPage,\n          payload.sort\n        )\n        .pipe(\n          map(\n            (returnRequestList: ReturnRequestList) =>\n              new UserActions.LoadOrderReturnRequestListSuccess(\n                returnRequestList\n              )\n          ),\n          catchError((error) =>\n            of(\n              new UserActions.LoadOrderReturnRequestListFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private orderConnector: UserOrderConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserPaymentConnector } from '../../connectors/payment/user-payment.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserPaymentMethodsEffects {\n  @Effect()\n  loadUserPaymentMethods$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_PAYMENT_METHODS),\n    map((action: UserActions.LoadUserPaymentMethods) => action.payload),\n    mergeMap((payload) => {\n      return this.userPaymentMethodConnector.getAll(payload).pipe(\n        map((payments: PaymentDetails[]) => {\n          return new UserActions.LoadUserPaymentMethodsSuccess(payments);\n        }),\n        catchError((error) =>\n          of(\n            new UserActions.LoadUserPaymentMethodsFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  setDefaultUserPaymentMethod$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.SET_DEFAULT_USER_PAYMENT_METHOD),\n    map((action: UserActions.SetDefaultUserPaymentMethod) => action.payload),\n    mergeMap((payload) => {\n      return this.userPaymentMethodConnector\n        .setDefault(payload.userId, payload.paymentMethodId)\n        .pipe(\n          switchMap((data) => [\n            new UserActions.SetDefaultUserPaymentMethodSuccess(data),\n            new UserActions.LoadUserPaymentMethods(payload.userId),\n          ]),\n          catchError((error) =>\n            of(\n              new UserActions.SetDefaultUserPaymentMethodFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n  @Effect()\n  deleteUserPaymentMethod$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.DELETE_USER_PAYMENT_METHOD),\n    map((action: UserActions.DeleteUserPaymentMethod) => action.payload),\n    mergeMap((payload) => {\n      return this.userPaymentMethodConnector\n        .delete(payload.userId, payload.paymentMethodId)\n        .pipe(\n          switchMap((data) => [\n            new UserActions.DeleteUserPaymentMethodSuccess(data),\n            new UserActions.LoadUserPaymentMethods(payload.userId),\n          ]),\n          catchError((error) =>\n            of(\n              new UserActions.DeleteUserPaymentMethodFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userPaymentMethodConnector: UserPaymentConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\n\nimport { Effect, Actions, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap, catchError } from 'rxjs/operators';\nimport { UserActions } from '../actions/index';\nimport { ProductInterestSearchResult } from '../../../model/product-interest.model';\nimport { UserInterestsConnector } from '../../connectors/interests/user-interests.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\n\n@Injectable()\nexport class ProductInterestsEffect {\n  constructor(\n    private actions$: Actions,\n    private userInterestsConnector: UserInterestsConnector\n  ) {}\n\n  @Effect()\n  loadProductInteres$: Observable<\n    UserActions.ProductInterestsAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_PRODUCT_INTERESTS),\n    map((action: UserActions.LoadProductInterests) => action.payload),\n    switchMap((payload) => {\n      return this.userInterestsConnector\n        .getInterests(\n          payload.userId,\n          payload.pageSize,\n          payload.currentPage,\n          payload.sort,\n          payload.productCode,\n          payload.notificationType\n        )\n        .pipe(\n          map((interests: ProductInterestSearchResult) => {\n            return new UserActions.LoadProductInterestsSuccess(interests);\n          }),\n          catchError((error) =>\n            of(\n              new UserActions.LoadProductInterestsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  removeProductInterest$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.REMOVE_PRODUCT_INTEREST),\n    map((action: UserActions.RemoveProductInterest) => action.payload),\n    switchMap((payload) =>\n      this.userInterestsConnector\n        .removeInterest(payload.userId, payload.item)\n        .pipe(\n          switchMap((data) => [\n            new UserActions.LoadProductInterests(\n              payload.singleDelete\n                ? {\n                    userId: payload.userId,\n                    productCode: payload.item.product.code,\n                    notificationType:\n                      payload.item.productInterestEntry[0].interestType,\n                  }\n                : { userId: payload.userId }\n            ),\n            new UserActions.RemoveProductInterestSuccess(data),\n          ]),\n          catchError((error) =>\n            of(\n              new UserActions.RemoveProductInterestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    )\n  );\n\n  @Effect()\n  addProductInterest$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.ADD_PRODUCT_INTEREST),\n    map((action: UserActions.AddProductInterest) => action.payload),\n    switchMap((payload) =>\n      this.userInterestsConnector\n        .addInterest(\n          payload.userId,\n          payload.productCode,\n          payload.notificationType\n        )\n        .pipe(\n          switchMap((res: any) => [\n            new UserActions.LoadProductInterests({\n              userId: payload.userId,\n              productCode: payload.productCode,\n              notificationType: payload.notificationType,\n            }),\n            new UserActions.AddProductInterestSuccess(res),\n          ]),\n          catchError((error) =>\n            of(\n              new UserActions.AddProductInterestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    )\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { SiteConnector } from '../../../site-context/connectors/site.connector';\nimport { StateUtils } from '../../../state/utils/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserActions } from '../actions/index';\nimport { REGIONS } from '../user-state';\n\n@Injectable()\nexport class RegionsEffects {\n  @Effect()\n  loadRegions$: Observable<UserActions.RegionsAction> = this.actions$.pipe(\n    ofType(UserActions.LOAD_REGIONS),\n    map((action: UserActions.LoadRegions) => {\n      return action.payload;\n    }),\n    switchMap((countryCode: string) => {\n      return this.siteConnector.getRegions(countryCode).pipe(\n        map(\n          (regions) =>\n            new UserActions.LoadRegionsSuccess({\n              entities: regions,\n              country: countryCode,\n            })\n        ),\n        catchError((error) =>\n          of(new UserActions.LoadRegionsFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  @Effect()\n  resetRegions$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.CLEAR_USER_MISCS_DATA, UserActions.CLEAR_REGIONS),\n    map(() => {\n      return new StateUtils.LoaderResetAction(REGIONS);\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport {\n  GlobalMessageService,\n  GlobalMessageType,\n} from '../../../global-message/index';\nimport { ReplenishmentOrder } from '../../../model/replenishment-order.model';\nimport { normalizeHttpError } from '../../../util/normalize-http-error';\nimport { UserReplenishmentOrderConnector } from '../../connectors/replenishment-order/user-replenishment-order.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class ReplenishmentOrderDetailsEffect {\n  @Effect()\n  loadReplenishmentOrderDetails$: Observable<\n    UserActions.ReplenishmentOrderDetailsAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_REPLENISHMENT_ORDER_DETAILS),\n    map((action: UserActions.LoadReplenishmentOrderDetails) => action.payload),\n    switchMap((payload) => {\n      return this.replenishmentOrderConnector\n        .load(payload.userId, payload.replenishmentOrderCode)\n        .pipe(\n          map((replenishmentOrder: ReplenishmentOrder) => {\n            return new UserActions.LoadReplenishmentOrderDetailsSuccess(\n              replenishmentOrder\n            );\n          }),\n          catchError((error) =>\n            of(\n              new UserActions.LoadReplenishmentOrderDetailsFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  cancelReplenishmentOrder$: Observable<\n    UserActions.ReplenishmentOrderDetailsAction\n  > = this.actions$.pipe(\n    ofType(UserActions.CANCEL_REPLENISHMENT_ORDER),\n    map((action: UserActions.CancelReplenishmentOrder) => action.payload),\n    switchMap((payload) => {\n      return this.replenishmentOrderConnector\n        .cancelReplenishmentOrder(\n          payload.userId,\n          payload.replenishmentOrderCode\n        )\n        .pipe(\n          map(\n            (replenishmentOrder: ReplenishmentOrder) =>\n              new UserActions.CancelReplenishmentOrderSuccess(\n                replenishmentOrder\n              )\n          ),\n          catchError((error) => {\n            error?.error?.errors.forEach((err) =>\n              this.globalMessageService.add(\n                err.message,\n                GlobalMessageType.MSG_TYPE_ERROR\n              )\n            );\n\n            return of(\n              new UserActions.CancelReplenishmentOrderFail(\n                normalizeHttpError(error)\n              )\n            );\n          })\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private replenishmentOrderConnector: UserReplenishmentOrderConnector,\n    private globalMessageService: GlobalMessageService\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { from, Observable } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { GlobalMessageType } from '../../../global-message/models/global-message.model';\nimport { GlobalMessageActions } from '../../../global-message/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class ResetPasswordEffects {\n  @Effect()\n  resetPassword$: Observable<\n    | UserActions.ResetPasswordSuccess\n    | GlobalMessageActions.AddMessage\n    | UserActions.ResetPasswordFail\n  > = this.actions$.pipe(\n    ofType(UserActions.RESET_PASSWORD),\n    map((action: UserActions.ResetPassword) => action.payload),\n    switchMap(({ token, password }) => {\n      return this.userAccountConnector.resetPassword(token, password).pipe(\n        switchMap(() => [\n          new UserActions.ResetPasswordSuccess(),\n          new GlobalMessageActions.AddMessage({\n            text: { key: 'forgottenPassword.passwordResetSuccess' },\n            type: GlobalMessageType.MSG_TYPE_CONFIRMATION,\n          }),\n        ]),\n        catchError((error) => {\n          const actions: Array<\n            UserActions.ResetPasswordFail | GlobalMessageActions.AddMessage\n          > = [new UserActions.ResetPasswordFail(makeErrorSerializable(error))];\n          if (error?.error?.errors) {\n            error.error.errors.forEach((err) => {\n              if (err.message) {\n                actions.push(\n                  new GlobalMessageActions.AddMessage({\n                    text: { raw: err.message },\n                    type: GlobalMessageType.MSG_TYPE_ERROR,\n                  })\n                );\n              }\n            });\n          }\n          return from(actions);\n        })\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class TitlesEffects {\n  @Effect()\n  loadTitles$: Observable<UserActions.TitlesAction> = this.actions$.pipe(\n    ofType(UserActions.LOAD_TITLES),\n    switchMap(() => {\n      return this.userAccountConnector.getTitles().pipe(\n        map((titles) => {\n          return new UserActions.LoadTitlesSuccess(titles);\n        }),\n        catchError((error) =>\n          of(new UserActions.LoadTitlesFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UpdateEmailEffects {\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n\n  @Effect()\n  updateEmail$: Observable<\n    UserActions.UpdateEmailSuccessAction | UserActions.UpdateEmailErrorAction\n  > = this.actions$.pipe(\n    ofType(UserActions.UPDATE_EMAIL),\n    map((action: UserActions.UpdateEmailAction) => action.payload),\n    concatMap((payload) =>\n      this.userAccountConnector\n        .updateEmail(payload.uid, payload.password, payload.newUid)\n        .pipe(\n          map(() => new UserActions.UpdateEmailSuccessAction(payload.newUid)),\n          catchError((error) =>\n            of(\n              new UserActions.UpdateEmailErrorAction(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    )\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UpdatePasswordEffects {\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n\n  @Effect()\n  updatePassword$: Observable<\n    UserActions.UpdatePasswordSuccess | UserActions.UpdatePasswordFail\n  > = this.actions$.pipe(\n    ofType(UserActions.UPDATE_PASSWORD),\n    map((action: UserActions.UpdatePassword) => action.payload),\n    concatMap((payload) =>\n      this.userAccountConnector\n        .updatePassword(\n          payload.userId,\n          payload.oldPassword,\n          payload.newPassword\n        )\n        .pipe(\n          map(() => new UserActions.UpdatePasswordSuccess()),\n          catchError((error) =>\n            of(new UserActions.UpdatePasswordFail(makeErrorSerializable(error)))\n          )\n        )\n    )\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, tap } from 'rxjs/operators';\nimport {\n  GlobalMessageService,\n  GlobalMessageType,\n} from '../../../global-message/index';\nimport { Address } from '../../../model/address.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserAddressConnector } from '../../connectors/address/user-address.connector';\nimport { UserAddressService } from '../../facade/user-address.service';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserAddressesEffects {\n  @Effect()\n  loadUserAddresses$: Observable<\n    UserActions.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_ADDRESSES),\n    map((action: UserActions.LoadUserAddresses) => action.payload),\n    mergeMap((payload) => {\n      return this.userAddressConnector.getAll(payload).pipe(\n        map((addresses: Address[]) => {\n          return new UserActions.LoadUserAddressesSuccess(addresses);\n        }),\n        catchError((error) =>\n          of(\n            new UserActions.LoadUserAddressesFail(makeErrorSerializable(error))\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  addUserAddress$: Observable<\n    UserActions.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.ADD_USER_ADDRESS),\n    map((action: UserActions.AddUserAddress) => action.payload),\n    mergeMap((payload) => {\n      return this.userAddressConnector\n        .add(payload.userId, payload.address)\n        .pipe(\n          map((data: any) => {\n            return new UserActions.AddUserAddressSuccess(data);\n          }),\n          catchError((error) =>\n            of(new UserActions.AddUserAddressFail(makeErrorSerializable(error)))\n          )\n        );\n    })\n  );\n\n  @Effect()\n  updateUserAddress$: Observable<\n    UserActions.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.UPDATE_USER_ADDRESS),\n    map((action: UserActions.UpdateUserAddress) => action.payload),\n    mergeMap((payload) => {\n      return this.userAddressConnector\n        .update(payload.userId, payload.addressId, payload.address)\n        .pipe(\n          map((data) => {\n            // don't show the message if just setting address as default\n            if (\n              payload.address &&\n              Object.keys(payload.address).length === 1 &&\n              payload.address.defaultAddress\n            ) {\n              return new UserActions.LoadUserAddresses(payload.userId);\n            } else {\n              return new UserActions.UpdateUserAddressSuccess(data);\n            }\n          }),\n          catchError((error) =>\n            of(\n              new UserActions.UpdateUserAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  deleteUserAddress$: Observable<\n    UserActions.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.DELETE_USER_ADDRESS),\n    map((action: UserActions.DeleteUserAddress) => action.payload),\n    mergeMap((payload) => {\n      return this.userAddressConnector\n        .delete(payload.userId, payload.addressId)\n        .pipe(\n          map((data) => {\n            return new UserActions.DeleteUserAddressSuccess(data);\n          }),\n          catchError((error) =>\n            of(\n              new UserActions.DeleteUserAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  /**\n   *  Reload addresses and notify about add success\n   */\n  @Effect({ dispatch: false })\n  showGlobalMessageOnAddSuccess$ = this.actions$.pipe(\n    ofType(UserActions.ADD_USER_ADDRESS_SUCCESS),\n    tap(() => {\n      this.loadAddresses();\n      this.showGlobalMessage('addressForm.userAddressAddSuccess');\n    })\n  );\n\n  /**\n   *  Reload addresses and notify about update success\n   */\n  @Effect({ dispatch: false })\n  showGlobalMessageOnUpdateSuccess$ = this.actions$.pipe(\n    ofType(UserActions.UPDATE_USER_ADDRESS_SUCCESS),\n    tap(() => {\n      this.loadAddresses();\n      this.showGlobalMessage('addressForm.userAddressUpdateSuccess');\n    })\n  );\n\n  /**\n   *  Reload addresses and notify about delete success\n   */\n  @Effect({ dispatch: false })\n  showGlobalMessageOnDeleteSuccess$ = this.actions$.pipe(\n    ofType(UserActions.DELETE_USER_ADDRESS_SUCCESS),\n    tap(() => {\n      this.loadAddresses();\n      this.showGlobalMessage('addressForm.userAddressDeleteSuccess');\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAddressConnector: UserAddressConnector,\n    private userAddressService: UserAddressService,\n    private messageService: GlobalMessageService\n  ) {}\n\n  /**\n   * Show global confirmation message with provided text\n   */\n  private showGlobalMessage(text: string) {\n    this.messageService.add(\n      { key: text },\n      GlobalMessageType.MSG_TYPE_CONFIRMATION\n    );\n  }\n\n  private loadAddresses() {\n    this.userAddressService.loadAddresses();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map } from 'rxjs/operators';\nimport { GlobalMessageType } from '../../../global-message/models/global-message.model';\nimport { GlobalMessageActions } from '../../../global-message/store/actions';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConsentConnector } from '../../connectors/consent/user-consent.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserConsentsEffect {\n  @Effect()\n  resetConsents$: Observable<\n    UserActions.ResetLoadUserConsents\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LANGUAGE_CHANGE),\n    map(() => new UserActions.ResetLoadUserConsents())\n  );\n\n  @Effect()\n  getConsents$: Observable<UserActions.UserConsentsAction> = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_CONSENTS),\n    map((action: UserActions.LoadUserConsents) => action.payload),\n    concatMap((userId) =>\n      this.userConsentConnector.loadConsents(userId).pipe(\n        map((consents) => new UserActions.LoadUserConsentsSuccess(consents)),\n        catchError((error) =>\n          of(new UserActions.LoadUserConsentsFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  @Effect()\n  giveConsent$: Observable<\n    UserActions.UserConsentsAction | GlobalMessageActions.RemoveMessagesByType\n  > = this.actions$.pipe(\n    ofType<UserActions.GiveUserConsent | UserActions.TransferAnonymousConsent>(\n      UserActions.GIVE_USER_CONSENT,\n      UserActions.TRANSFER_ANONYMOUS_CONSENT\n    ),\n    concatMap((action) =>\n      this.userConsentConnector\n        .giveConsent(\n          action.payload.userId,\n          action.payload.consentTemplateId,\n          action.payload.consentTemplateVersion\n        )\n        .pipe(\n          map((consent) => new UserActions.GiveUserConsentSuccess(consent)),\n          catchError((error) => {\n            const errors: Array<\n              | UserActions.UserConsentsAction\n              | GlobalMessageActions.RemoveMessagesByType\n            > = [\n              new UserActions.GiveUserConsentFail(makeErrorSerializable(error)),\n            ];\n            if (\n              action.type === UserActions.TRANSFER_ANONYMOUS_CONSENT &&\n              error.status === 409\n            ) {\n              errors.push(\n                new GlobalMessageActions.RemoveMessagesByType(\n                  GlobalMessageType.MSG_TYPE_ERROR\n                )\n              );\n            }\n            return of(...errors);\n          })\n        )\n    )\n  );\n\n  @Effect()\n  withdrawConsent$: Observable<\n    UserActions.UserConsentsAction\n  > = this.actions$.pipe(\n    ofType(UserActions.WITHDRAW_USER_CONSENT),\n    map((action: UserActions.WithdrawUserConsent) => action.payload),\n    concatMap(({ userId, consentCode }) =>\n      this.userConsentConnector.withdrawConsent(userId, consentCode).pipe(\n        map(() => new UserActions.WithdrawUserConsentSuccess()),\n        catchError((error) =>\n          of(\n            new UserActions.WithdrawUserConsentFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userConsentConnector: UserConsentConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { EntitiesModel } from '../../../model/misc.model';\nimport { CostCenter } from '../../../model/org-unit.model';\nimport { normalizeHttpError } from '../../../util/normalize-http-error';\nimport { UserCostCenterConnector } from '../../connectors/cost-center/user-cost-center.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserCostCenterEffects {\n  @Effect()\n  loadActiveCostCenters$: Observable<\n    UserActions.UserCostCenterAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_ACTIVE_COST_CENTERS),\n    map((action: UserActions.LoadActiveCostCenters) => action.payload),\n    switchMap((payload) =>\n      this.userCostCenterConnector.getActiveList(payload).pipe(\n        // TODO(#8875): Should we use here serialize utils?\n        map(\n          (data: EntitiesModel<CostCenter>) =>\n            new UserActions.LoadActiveCostCentersSuccess(data.values)\n        ),\n        catchError((error) =>\n          of(\n            new UserActions.LoadActiveCostCentersFail(normalizeHttpError(error))\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userCostCenterConnector: UserCostCenterConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map, mergeMap } from 'rxjs/operators';\nimport { User } from '../../../model/misc.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserDetailsEffects {\n  @Effect()\n  loadUserDetails$: Observable<\n    UserActions.UserDetailsAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_DETAILS),\n    map((action: UserActions.LoadUserDetails) => action.payload),\n    mergeMap((userId) => {\n      return this.userConnector.get(userId).pipe(\n        map((user: User) => {\n          return new UserActions.LoadUserDetailsSuccess(user);\n        }),\n        catchError((error) =>\n          of(new UserActions.LoadUserDetailsFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  @Effect()\n  updateUserDetails$: Observable<\n    UserActions.UpdateUserDetailsSuccess | UserActions.UpdateUserDetailsFail\n  > = this.actions$.pipe(\n    ofType(UserActions.UPDATE_USER_DETAILS),\n    map((action: UserActions.UpdateUserDetails) => action.payload),\n    concatMap((payload) =>\n      this.userConnector.update(payload.username, payload.userDetails).pipe(\n        map(\n          () => new UserActions.UpdateUserDetailsSuccess(payload.userDetails)\n        ),\n        catchError((error) =>\n          of(\n            new UserActions.UpdateUserDetailsFail(makeErrorSerializable(error))\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { OrderHistoryList } from '../../../model/order.model';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { normalizeHttpError } from '../../../util/normalize-http-error';\nimport {\n  UserOrderConnector,\n  UserReplenishmentOrderConnector,\n} from '../../connectors/index';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserOrdersEffect {\n  constructor(\n    private actions$: Actions,\n    private orderConnector: UserOrderConnector,\n    private replenishmentOrderConnector: UserReplenishmentOrderConnector\n  ) {}\n\n  @Effect()\n  loadUserOrders$: Observable<\n    UserActions.UserOrdersAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_ORDERS),\n    map((action: UserActions.LoadUserOrders) => action.payload),\n    switchMap((payload) => {\n      return (Boolean(payload.replenishmentOrderCode)\n        ? this.replenishmentOrderConnector.loadReplenishmentDetailsHistory(\n            payload.userId,\n            payload.replenishmentOrderCode,\n            payload.pageSize,\n            payload.currentPage,\n            payload.sort\n          )\n        : this.orderConnector.getHistory(\n            payload.userId,\n            payload.pageSize,\n            payload.currentPage,\n            payload.sort\n          )\n      ).pipe(\n        map((orders: OrderHistoryList) => {\n          return new UserActions.LoadUserOrdersSuccess(orders);\n        }),\n        catchError((error) =>\n          of(new UserActions.LoadUserOrdersFail(normalizeHttpError(error)))\n        )\n      );\n    })\n  );\n\n  @Effect()\n  resetUserOrders$: Observable<\n    UserActions.ClearUserOrders\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LANGUAGE_CHANGE),\n    map(() => {\n      return new UserActions.ClearUserOrders();\n    })\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { AuthService } from '../../../auth/user-auth/facade/auth.service';\nimport { UserSignUp } from '../../../model/misc.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserRegisterEffects {\n  @Effect()\n  registerUser$: Observable<\n    UserActions.UserRegisterOrRemoveAction\n  > = this.actions$.pipe(\n    ofType(UserActions.REGISTER_USER),\n    map((action: UserActions.RegisterUser) => action.payload),\n    mergeMap((user: UserSignUp) =>\n      this.userConnector.register(user).pipe(\n        map(() => new UserActions.RegisterUserSuccess()),\n        catchError((error) =>\n          of(new UserActions.RegisterUserFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  @Effect()\n  registerGuest$: Observable<\n    UserActions.UserRegisterOrRemoveAction\n  > = this.actions$.pipe(\n    ofType(UserActions.REGISTER_GUEST),\n    map((action: UserActions.RegisterGuest) => action.payload),\n    mergeMap(({ guid, password }) =>\n      this.userConnector.registerGuest(guid, password).pipe(\n        switchMap((user) => {\n          this.authService.loginWithCredentials(user.uid, password);\n          return [new UserActions.RegisterGuestSuccess()];\n        }),\n        catchError((error) =>\n          of(new UserActions.RegisterGuestFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  @Effect()\n  removeUser$: Observable<\n    UserActions.UserRegisterOrRemoveAction\n  > = this.actions$.pipe(\n    ofType(UserActions.REMOVE_USER),\n    map((action: UserActions.RemoveUser) => action.payload),\n    mergeMap((userId: string) => {\n      return this.userConnector.remove(userId).pipe(\n        switchMap(() => {\n          this.authService.logout();\n          return [new UserActions.RemoveUserSuccess()];\n        }),\n        catchError((error) =>\n          of(new UserActions.RemoveUserFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userConnector: UserConnector,\n    private authService: AuthService\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { ReplenishmentOrderList } from '../../../model/replenishment-order.model';\nimport { normalizeHttpError } from '../../../util/normalize-http-error';\nimport { UserReplenishmentOrderConnector } from '../../connectors/replenishment-order/user-replenishment-order.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserReplenishmentOrdersEffect {\n  @Effect()\n  loadUserReplenishmentOrders$: Observable<\n    UserActions.UserReplenishmentOrdersAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_REPLENISHMENT_ORDERS),\n    map((action: UserActions.LoadUserReplenishmentOrders) => action.payload),\n    switchMap((payload) => {\n      return this.replenishmentOrderConnector\n        .loadHistory(\n          payload.userId,\n          payload.pageSize,\n          payload.currentPage,\n          payload.sort\n        )\n        .pipe(\n          map((orders: ReplenishmentOrderList) => {\n            return new UserActions.LoadUserReplenishmentOrdersSuccess(orders);\n          }),\n          catchError((error) =>\n            of(\n              new UserActions.LoadUserReplenishmentOrdersFail(\n                normalizeHttpError(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private replenishmentOrderConnector: UserReplenishmentOrderConnector\n  ) {}\n}\n","import { BillingCountriesEffect } from './billing-countries.effect';\nimport { ClearMiscsDataEffect } from './clear-miscs-data.effect';\nimport { ConsignmentTrackingEffects } from './consignment-tracking.effect';\nimport { CustomerCouponEffects } from './customer-coupon.effect';\nimport { DeliveryCountriesEffects } from './delivery-countries.effect';\nimport { ForgotPasswordEffects } from './forgot-password.effect';\nimport { NotificationPreferenceEffects } from './notification-preference.effect';\nimport { OrderDetailsEffect } from './order-details.effect';\nimport { OrderReturnRequestEffect } from './order-return-request.effect';\nimport { UserPaymentMethodsEffects } from './payment-methods.effect';\nimport { ProductInterestsEffect } from './product-interests.effect';\nimport { RegionsEffects } from './regions.effect';\nimport { ReplenishmentOrderDetailsEffect } from './replenishment-order-details.effect';\nimport { ResetPasswordEffects } from './reset-password.effect';\nimport { TitlesEffects } from './titles.effect';\nimport { UpdateEmailEffects } from './update-email.effect';\nimport { UpdatePasswordEffects } from './update-password.effect';\nimport { UserAddressesEffects } from './user-addresses.effect';\nimport { UserConsentsEffect } from './user-consents.effect';\nimport { UserCostCenterEffects } from './user-cost-center.effect';\nimport { UserDetailsEffects } from './user-details.effect';\nimport { UserOrdersEffect } from './user-orders.effect';\nimport { UserRegisterEffects } from './user-register.effect';\nimport { UserReplenishmentOrdersEffect } from './user-replenishment-orders.effect';\n\nexport const effects: any[] = [\n  ClearMiscsDataEffect,\n  DeliveryCountriesEffects,\n  RegionsEffects,\n  TitlesEffects,\n  UserDetailsEffects,\n  UserAddressesEffects,\n  UserPaymentMethodsEffects,\n  UserRegisterEffects,\n  UserOrdersEffect,\n  OrderDetailsEffect,\n  BillingCountriesEffect,\n  ResetPasswordEffects,\n  ForgotPasswordEffects,\n  UpdateEmailEffects,\n  UpdatePasswordEffects,\n  UserConsentsEffect,\n  ConsignmentTrackingEffects,\n  CustomerCouponEffects,\n  NotificationPreferenceEffects,\n  ProductInterestsEffect,\n  OrderReturnRequestEffect,\n  UserCostCenterEffects,\n  ReplenishmentOrderDetailsEffect,\n  UserReplenishmentOrdersEffect,\n];\n\nexport * from './billing-countries.effect';\nexport * from './clear-miscs-data.effect';\nexport * from './consignment-tracking.effect';\nexport * from './customer-coupon.effect';\nexport * from './delivery-countries.effect';\nexport * from './notification-preference.effect';\nexport * from './order-details.effect';\nexport * from './order-return-request.effect';\nexport * from './payment-methods.effect';\nexport * from './product-interests.effect';\nexport * from './regions.effect';\nexport * from './replenishment-order-details.effect';\nexport * from './reset-password.effect';\nexport * from './titles.effect';\nexport * from './user-addresses.effect';\nexport * from './user-consents.effect';\nexport * from './user-details.effect';\nexport * from './user-orders.effect';\nexport * from './user-register.effect';\nexport * from './user-replenishment-orders.effect';\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { RouterModule } from '@angular/router';\n\nimport { metaReducers, reducerToken, reducerProvider } from './reducers/index';\nimport { effects } from './effects/index';\nimport { USER_FEATURE } from './user-state';\nimport { StateModule } from '../../state/state.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    StateModule,\n    StoreModule.forFeature(USER_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n    RouterModule,\n  ],\n  providers: [reducerProvider],\n})\nexport class UserStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { UserStoreModule } from './store/user-store.module';\n\n@NgModule({\n  imports: [UserStoreModule],\n})\nexport class UserModule {\n  static forRoot(): ModuleWithProviders<UserModule> {\n    return {\n      ngModule: UserModule,\n    };\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ExternalJsFileLoader {\n  constructor(@Inject(DOCUMENT) protected document: any) {}\n\n  /**\n   * Loads a javascript from an external URL\n   * @param src URL for the script to be loaded\n   * @param params additional parameters to be attached to the given URL\n   * @param callback a function to be invoked after the script has been loaded\n   * @param errorCallback function to be invoked after error during script loading\n   */\n  public load(\n    src: string,\n    params?: Object,\n    callback?: EventListener,\n    errorCallback?: EventListener\n  ): void {\n    const script: HTMLScriptElement = this.document.createElement('script');\n    script.type = 'text/javascript';\n    if (params) {\n      script.src = src + this.parseParams(params);\n    } else {\n      script.src = src;\n    }\n\n    script.async = true;\n    script.defer = true;\n    if (callback) {\n      script.addEventListener('load', callback);\n    }\n    if (errorCallback) {\n      script.addEventListener('error', errorCallback);\n    }\n\n    document.head.appendChild(script);\n  }\n\n  /**\n   * Parses the given object with parameters to a string \"param1=value1&param2=value2\"\n   * @param params object containing parameters\n   */\n  private parseParams(params: Object): string {\n    let result = '';\n    const keysArray = Object.keys(params);\n    if (keysArray.length > 0) {\n      result =\n        '?' +\n        keysArray\n          .map((key) => encodeURI(key) + '=' + encodeURI(params[key]))\n          .join('&');\n    }\n    return result;\n  }\n}\n"]}