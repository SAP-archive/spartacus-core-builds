{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","ng://@spartacus/core/src/config/server-config/server-config.ts","ng://@spartacus/core/src/config/utils/deep-merge.ts","ng://@spartacus/core/src/config/utils/config-validator.ts","ng://@spartacus/core/src/config/config.module.ts","ng://@spartacus/core/src/site-context/config/site-context-config.ts","ng://@spartacus/core/src/occ/config/occ-config.ts","ng://@spartacus/core/src/auth/config/auth-config.ts","ng://@spartacus/core/src/auth/config/default-auth-config.ts","ng://@spartacus/core/src/state/utils/loader/loader.action.ts","ng://@spartacus/core/src/auth/store/auth-state.ts","ng://@spartacus/core/src/auth/store/actions/client-token.action.ts","ng://@spartacus/core/src/auth/store/actions/login-logout.action.ts","ng://@spartacus/core/src/auth/store/actions/user-token.action.ts","ng://@spartacus/core/src/auth/store/selectors/feature.selector.ts","ng://@spartacus/core/src/auth/store/selectors/client-token.selectors.ts","ng://@spartacus/core/src/auth/store/selectors/user-token.selectors.ts","ng://@spartacus/core/src/auth/facade/auth.service.ts","ng://@spartacus/core/src/auth/services/client-error/client-error-handling.service.ts","ng://@spartacus/core/src/window/window-ref.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/url-parsing.service.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/path-utils.ts","ng://@spartacus/core/src/routing/configurable-routes/config/routing-config.ts","ng://@spartacus/core/src/routing/configurable-routes/routing-config.service.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/semantic-path.service.ts","ng://@spartacus/core/src/routing/store/actions/router.action.ts","ng://@spartacus/core/src/site-context/store/actions/languages.action.ts","ng://@spartacus/core/src/routing/store/effects/router.effect.ts","ng://@spartacus/core/src/routing/store/effects/index.ts","ng://@spartacus/core/src/model/cms.model.ts","ng://@spartacus/core/src/routing/store/reducers/router.reducer.ts","ng://@spartacus/core/src/routing/store/selectors/routing.selector.ts","ng://@spartacus/core/src/routing/store/routing-state.ts","ng://@spartacus/core/src/routing/facade/routing.service.ts","ng://@spartacus/core/src/auth/services/user-error/user-error-handling.service.ts","ng://@spartacus/core/src/occ/utils/interceptor-util.ts","ng://@spartacus/core/src/auth/http-interceptors/auth-error.interceptor.ts","ng://@spartacus/core/src/site-context/store/state.ts","ng://@spartacus/core/src/site-context/store/selectors/site-context.selector.ts","ng://@spartacus/core/src/site-context/store/selectors/base-site.selectors.ts","ng://@spartacus/core/src/site-context/store/actions/base-site.action.ts","ng://@spartacus/core/src/site-context/facade/base-site.service.ts","ng://@spartacus/core/src/config/utils/dynamic-template.ts","ng://@spartacus/core/src/site-context/config/context-config-utils.ts","ng://@spartacus/core/src/site-context/store/reducers/languages.reducer.ts","ng://@spartacus/core/src/site-context/store/actions/currencies.action.ts","ng://@spartacus/core/src/site-context/store/reducers/currencies.reducer.ts","ng://@spartacus/core/src/site-context/store/reducers/base-site.reducer.ts","ng://@spartacus/core/src/site-context/store/reducers/index.ts","ng://@spartacus/core/src/util/serialization-utils.ts","ng://@spartacus/core/src/site-context/connectors/site.adapter.ts","ng://@spartacus/core/src/site-context/connectors/site.connector.ts","ng://@spartacus/core/src/site-context/store/effects/languages.effect.ts","ng://@spartacus/core/src/site-context/store/effects/currencies.effect.ts","ng://@spartacus/core/src/site-context/store/effects/base-site.effect.ts","ng://@spartacus/core/src/site-context/store/effects/index.ts","ng://@spartacus/core/src/site-context/store/selectors/currencies.selectors.ts","ng://@spartacus/core/src/site-context/store/selectors/languages.selectors.ts","ng://@spartacus/core/src/site-context/facade/language.service.ts","ng://@spartacus/core/src/site-context/facade/currency.service.ts","ng://@spartacus/core/src/site-context/providers/context-service-map.ts","ng://@spartacus/core/src/occ/services/occ-endpoints.service.ts","ng://@spartacus/core/src/auth/http-interceptors/client-token.interceptor.ts","ng://@spartacus/core/src/auth/http-interceptors/user-token.interceptor.ts","ng://@spartacus/core/src/auth/http-interceptors/index.ts","ng://@spartacus/core/src/auth/services/client-authentication/client-authentication-token.service.ts","ng://@spartacus/core/src/auth/services/user-authentication/user-authentication-token.service.ts","ng://@spartacus/core/src/auth/services/index.ts","ng://@spartacus/core/src/state/config/state-config.ts","ng://@spartacus/core/src/state/config/default-state-config.ts","ng://@spartacus/core/src/state/utils/get-state-slice.ts","ng://@spartacus/core/src/state/reducers/storage-sync.reducer.ts","ng://@spartacus/core/src/state/reducers/transfer-state.reducer.ts","ng://@spartacus/core/src/state/reducers/index.ts","ng://@spartacus/core/src/state/state.module.ts","ng://@spartacus/core/src/auth/store/effects/client-token.effect.ts","ng://@spartacus/core/src/occ/utils/occ-constants.ts","ng://@spartacus/core/src/auth/store/effects/user-token.effect.ts","ng://@spartacus/core/src/auth/store/effects/index.ts","ng://@spartacus/core/src/state/utils/loader/loader.reducer.ts","ng://@spartacus/core/src/auth/store/reducers/user-token.reducer.ts","ng://@spartacus/core/src/auth/store/reducers/index.ts","ng://@spartacus/core/src/auth/store/auth-store.module.ts","ng://@spartacus/core/src/auth/auth.module.ts","ng://@spartacus/core/src/auth/guards/auth-redirect.service.ts","ng://@spartacus/core/src/auth/guards/auth.guard.ts","ng://@spartacus/core/src/auth/guards/not-auth.guard.ts","ng://@spartacus/core/src/state/utils/loader/loader.selectors.ts","ng://@spartacus/core/src/cart/store/cart-state.ts","ng://@spartacus/core/src/cart/store/selectors/cart.selector.ts","ng://@spartacus/core/src/cart/facade/cart-data.service.ts","ng://@spartacus/core/src/cart/store/actions/cart-entry.action.ts","ng://@spartacus/core/src/cart/store/actions/cart.action.ts","ng://@spartacus/core/src/cart/facade/cart.service.ts","ng://@spartacus/core/src/cart/connectors/cart/cart.adapter.ts","ng://@spartacus/core/src/cart/connectors/cart/cart.connector.ts","ng://@spartacus/core/src/cart/store/effects/cart.effect.ts","ng://@spartacus/core/src/cart/connectors/entry/cart-entry.adapter.ts","ng://@spartacus/core/src/cart/connectors/entry/cart-entry.connector.ts","ng://@spartacus/core/src/cart/store/effects/cart-entry.effect.ts","ng://@spartacus/core/src/cart/store/effects/index.ts","ng://@spartacus/core/src/checkout/store/checkout-state.ts","ng://@spartacus/core/src/checkout/store/actions/checkout.action.ts","ng://@spartacus/core/src/cart/store/reducers/cart.reducer.ts","ng://@spartacus/core/src/cart/store/reducers/index.ts","ng://@spartacus/core/src/cart/store/cart-store.module.ts","ng://@spartacus/core/src/cart/cart.module.ts","ng://@spartacus/core/src/cart/connectors/cart/converters.ts","ng://@spartacus/core/src/cart/connectors/entry/converters.ts","ng://@spartacus/core/src/cms/config/cms-config.ts","ng://@spartacus/core/src/cms/config/cms-structure.config.ts","ng://@spartacus/core/src/cms/config/default-cms-config.ts","ng://@spartacus/core/src/state/utils/entity/entity.action.ts","ng://@spartacus/core/src/state/utils/entity-loader/entity-loader.action.ts","ng://@spartacus/core/src/state/utils/entity/entity.reducer.ts","ng://@spartacus/core/src/state/utils/entity-loader/entity-loader.reducer.ts","ng://@spartacus/core/src/state/utils/entity-loader/entity-loader.selectors.ts","ng://@spartacus/core/src/cms/store/actions/page.action.ts","ng://@spartacus/core/src/cms/store/cms-state.ts","ng://@spartacus/core/src/cms/store/actions/component.action.ts","ng://@spartacus/core/src/cms/store/actions/navigation-entry-item.action.ts","ng://@spartacus/core/src/cms/store/selectors/feature.selectors.ts","ng://@spartacus/core/src/cms/store/selectors/component.selectors.ts","ng://@spartacus/core/src/cms/store/selectors/navigation-entry-item.selectors.ts","ng://@spartacus/core/src/cms/store/selectors/page.selectors.ts","ng://@spartacus/core/src/cms/facade/cms.service.ts","ng://@spartacus/core/src/cms/page/page-meta.resolver.ts","ng://@spartacus/core/src/cms/facade/page-meta.service.ts","ng://@spartacus/core/src/i18n/translation.service.ts","ng://@spartacus/core/src/cms/page/content-page-meta.resolver.ts","ng://@spartacus/core/src/cms/page/page.module.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/url.pipe.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/url.module.ts","ng://@spartacus/core/src/routing/configurable-routes/url-matcher-factory.service.ts","ng://@spartacus/core/src/routing/configurable-routes/configurable-routes.service.ts","ng://@spartacus/core/src/routing/configurable-routes/configurable-routes.module.ts","ng://@spartacus/core/src/routing/models/page-context.model.ts","ng://@spartacus/core/src/routing/routing.module.ts","ng://@spartacus/core/src/cms/connectors/page/cms-page.adapter.ts","ng://@spartacus/core/src/cms/services/cms-structure-config.service.ts","ng://@spartacus/core/src/cms/connectors/page/cms-page.connector.ts","ng://@spartacus/core/src/cms/store/effects/page.effect.ts","ng://@spartacus/core/src/cms/connectors/component/cms-component.adapter.ts","ng://@spartacus/core/src/cms/connectors/component/cms-component.connector.ts","ng://@spartacus/core/src/cms/store/effects/component.effect.ts","ng://@spartacus/core/src/cms/store/effects/navigation-entry-item.effect.ts","ng://@spartacus/core/src/cms/store/effects/index.ts","ng://@spartacus/core/src/cms/store/reducers/navigation-entry-item.reducer.ts","ng://@spartacus/core/src/cms/store/reducers/page-data.reducer.ts","ng://@spartacus/core/src/cms/store/reducers/page-index.reducer.ts","ng://@spartacus/core/src/cms/store/reducers/index.ts","ng://@spartacus/core/src/cms/store/cms-store.module.ts","ng://@spartacus/core/src/cms/cms.module.ts","ng://@spartacus/core/src/cms/connectors/page/converters.ts","ng://@spartacus/core/src/cms/connectors/component/converters.ts","ng://@spartacus/core/src/cms/model/page.model.ts","ng://@spartacus/core/src/cms/services/dynamic-attribute.service.ts","ng://@spartacus/core/src/checkout/store/actions/card-types.action.ts","ng://@spartacus/core/src/checkout/store/actions/address-verification.action.ts","ng://@spartacus/core/src/checkout/store/actions/index.ts","ng://@spartacus/core/src/checkout/store/reducers/address-verification.reducer.ts","ng://@spartacus/core/src/checkout/store/selectors/checkout.selectors.ts","ng://@spartacus/core/src/checkout/store/selectors/address-verification.selectors.ts","ng://@spartacus/core/src/checkout/store/reducers/card-types.reducer.ts","ng://@spartacus/core/src/checkout/store/selectors/card-types.selectors.ts","ng://@spartacus/core/src/checkout/facade/checkout.service.ts","ng://@spartacus/core/src/checkout/facade/checkout-delivery.service.ts","ng://@spartacus/core/src/checkout/facade/checkout-payment.service.ts","ng://@spartacus/core/src/checkout/services/cart-page-meta.resolver.ts","ng://@spartacus/core/src/checkout/services/checkout-page-meta.resolver.ts","ng://@spartacus/core/src/checkout/store/reducers/checkout.reducer.ts","ng://@spartacus/core/src/checkout/store/reducers/index.ts","ng://@spartacus/core/src/user/store/actions/billing-countries.action.ts","ng://@spartacus/core/src/user/store/actions/delivery-countries.action.ts","ng://@spartacus/core/src/user/store/actions/forgot-password.action.ts","ng://@spartacus/core/src/user/store/actions/order-details.action.ts","ng://@spartacus/core/src/user/store/user-state.ts","ng://@spartacus/core/src/user/store/actions/payment-methods.action.ts","ng://@spartacus/core/src/user/store/actions/regions.action.ts","ng://@spartacus/core/src/user/store/actions/reset-password.action.ts","ng://@spartacus/core/src/user/store/actions/titles.action.ts","ng://@spartacus/core/src/process/store/process-state.ts","ng://@spartacus/core/src/user/store/actions/update-email.action.ts","ng://@spartacus/core/src/user/store/actions/update-password.action.ts","ng://@spartacus/core/src/user/store/actions/user-addresses.action.ts","ng://@spartacus/core/src/user/store/actions/user-consents.action.ts","ng://@spartacus/core/src/user/store/actions/user-details.action.ts","ng://@spartacus/core/src/user/store/actions/user-orders.action.ts","ng://@spartacus/core/src/user/store/actions/user-register.action.ts","ng://@spartacus/core/src/user/store/actions/index.ts","ng://@spartacus/core/src/checkout/connectors/checkout/checkout.adapter.ts","ng://@spartacus/core/src/checkout/connectors/checkout/checkout.connector.ts","ng://@spartacus/core/src/checkout/connectors/delivery/checkout-delivery.adapter.ts","ng://@spartacus/core/src/checkout/connectors/delivery/checkout-delivery.connector.ts","ng://@spartacus/core/src/checkout/connectors/payment/checkout-payment.adapter.ts","ng://@spartacus/core/src/checkout/connectors/payment/checkout-payment.connector.ts","ng://@spartacus/core/src/checkout/store/effects/checkout.effect.ts","ng://@spartacus/core/src/checkout/store/effects/card-types.effect.ts","ng://@spartacus/core/src/user/connectors/address/user-address.adapter.ts","ng://@spartacus/core/src/user/connectors/address/user-address.connector.ts","ng://@spartacus/core/src/checkout/store/effects/address-verification.effect.ts","ng://@spartacus/core/src/checkout/store/effects/index.ts","ng://@spartacus/core/src/checkout/store/checkout-store.module.ts","ng://@spartacus/core/src/checkout/checkout.module.ts","ng://@spartacus/core/src/checkout/connectors/checkout/converters.ts","ng://@spartacus/core/src/checkout/connectors/delivery/converters.ts","ng://@spartacus/core/src/checkout/connectors/payment/converters.ts","ng://@spartacus/core/src/cx-api/cx-api.module.ts","ng://@spartacus/core/src/site-context/connectors/converters.ts","ng://@spartacus/core/src/site-context/providers/context-service-providers.ts","ng://@spartacus/core/src/site-context/services/site-context-params.service.ts","ng://@spartacus/core/src/site-context/services/site-context-url-serializer.ts","ng://@spartacus/core/src/site-context/services/site-context-routes-handler.ts","ng://@spartacus/core/src/site-context/providers/site-context-params-providers.ts","ng://@spartacus/core/src/site-context/config/default-site-context-config.ts","ng://@spartacus/core/src/site-context/store/site-context-store.module.ts","ng://@spartacus/core/src/site-context/config/base-site-config-validator.ts","ng://@spartacus/core/src/site-context/site-context.module.ts","ng://@spartacus/core/src/product/connectors/product/product.adapter.ts","ng://@spartacus/core/src/product/connectors/product/product.connector.ts","ng://@spartacus/core/src/product/connectors/product/converters.ts","ng://@spartacus/core/src/product/connectors/references/converters.ts","ng://@spartacus/core/src/product/connectors/references/product-references.adapter.ts","ng://@spartacus/core/src/product/connectors/references/product-references.connector.ts","ng://@spartacus/core/src/product/connectors/reviews/product-reviews.adapter.ts","ng://@spartacus/core/src/product/connectors/reviews/product-reviews.connector.ts","ng://@spartacus/core/src/product/connectors/reviews/converters.ts","ng://@spartacus/core/src/product/connectors/search/product-search.adapter.ts","ng://@spartacus/core/src/product/connectors/search/product-search.connector.ts","ng://@spartacus/core/src/product/connectors/search/converters.ts","ng://@spartacus/core/src/product/store/actions/product-references.action.ts","ng://@spartacus/core/src/product/store/actions/product-reviews.action.ts","ng://@spartacus/core/src/product/store/actions/product-search.action.ts","ng://@spartacus/core/src/product/store/product-state.ts","ng://@spartacus/core/src/product/store/actions/product.action.ts","ng://@spartacus/core/src/product/store/selectors/feature.selector.ts","ng://@spartacus/core/src/product/store/selectors/product-references.selectors.ts","ng://@spartacus/core/src/product/store/selectors/product-reviews.selectors.ts","ng://@spartacus/core/src/product/store/reducers/product-search.reducer.ts","ng://@spartacus/core/src/product/store/selectors/product-search.selectors.ts","ng://@spartacus/core/src/product/store/selectors/product.selectors.ts","ng://@spartacus/core/src/product/facade/product-reference.service.ts","ng://@spartacus/core/src/product/store/effects/product-references.effect.ts","ng://@spartacus/core/src/product/store/effects/product-reviews.effect.ts","ng://@spartacus/core/src/product/store/effects/product-search.effect.ts","ng://@spartacus/core/src/product/store/effects/product.effect.ts","ng://@spartacus/core/src/product/store/effects/index.ts","ng://@spartacus/core/src/product/store/reducers/product-references.reducer.ts","ng://@spartacus/core/src/product/store/reducers/product-reviews.reducer.ts","ng://@spartacus/core/src/product/store/reducers/index.ts","ng://@spartacus/core/src/product/facade/product-review.service.ts","ng://@spartacus/core/src/product/facade/product-search.service.ts","ng://@spartacus/core/src/product/facade/product.service.ts","ng://@spartacus/core/src/product/facade/searchbox.service.ts","ng://@spartacus/core/src/product/services/category-page-meta.resolver.ts","ng://@spartacus/core/src/product/services/product-page-meta.resolver.ts","ng://@spartacus/core/src/product/services/search-page-meta.resolver.ts","ng://@spartacus/core/src/product/store/product-store.module.ts","ng://@spartacus/core/src/product/product.module.ts","ng://@spartacus/core/src/user/connectors/user/user.adapter.ts","ng://@spartacus/core/src/user/connectors/user/user.connector.ts","ng://@spartacus/core/src/user/connectors/user/converters.ts","ng://@spartacus/core/src/user/connectors/address/converters.ts","ng://@spartacus/core/src/user/connectors/consent/user-consent.adapter.ts","ng://@spartacus/core/src/user/connectors/consent/user-consent.connector.ts","ng://@spartacus/core/src/user/connectors/consent/converters.ts","ng://@spartacus/core/src/user/connectors/payment/user-payment.adapter.ts","ng://@spartacus/core/src/user/connectors/payment/user-payment.connector.ts","ng://@spartacus/core/src/user/connectors/order/user-order.adapter.ts","ng://@spartacus/core/src/user/connectors/order/user-order.connector.ts","ng://@spartacus/core/src/user/connectors/order/converters.ts","ng://@spartacus/core/src/process/store/selectors/process.selectors.ts","ng://@spartacus/core/src/process/store/selectors/feature.selector.ts","ng://@spartacus/core/src/user/store/reducers/billing-countries.reducer.ts","ng://@spartacus/core/src/user/store/reducers/delivery-countries.reducer.ts","ng://@spartacus/core/src/user/store/reducers/order-details.reducer.ts","ng://@spartacus/core/src/user/store/reducers/payment-methods.reducer.ts","ng://@spartacus/core/src/user/store/reducers/regions.reducer.ts","ng://@spartacus/core/src/user/store/reducers/reset-password.reducer.ts","ng://@spartacus/core/src/user/store/reducers/titles.reducer.ts","ng://@spartacus/core/src/user/store/reducers/user-addresses.reducer.ts","ng://@spartacus/core/src/user/store/reducers/user-consents.reducer.ts","ng://@spartacus/core/src/user/store/reducers/user-details.reducer.ts","ng://@spartacus/core/src/user/store/reducers/user-orders.reducer.ts","ng://@spartacus/core/src/user/store/reducers/index.ts","ng://@spartacus/core/src/user/store/selectors/feature.selector.ts","ng://@spartacus/core/src/user/store/selectors/billing-countries.selectors.ts","ng://@spartacus/core/src/user/store/selectors/delivery-countries.selectors.ts","ng://@spartacus/core/src/user/store/selectors/order-details.selectors.ts","ng://@spartacus/core/src/user/store/selectors/payment-methods.selectors.ts","ng://@spartacus/core/src/user/store/selectors/regions.selectors.ts","ng://@spartacus/core/src/user/store/selectors/reset-password.selectors.ts","ng://@spartacus/core/src/user/store/selectors/titles.selectors.ts","ng://@spartacus/core/src/user/store/selectors/user-addresses.selectors.ts","ng://@spartacus/core/src/user/store/selectors/user-consents.selectors.ts","ng://@spartacus/core/src/user/store/selectors/user-details.selectors.ts","ng://@spartacus/core/src/user/store/selectors/user-orders.selectors.ts","ng://@spartacus/core/src/user/facade/user.service.ts","ng://@spartacus/core/src/user/facade/user-address.service.ts","ng://@spartacus/core/src/user/facade/user-consent.service.ts","ng://@spartacus/core/src/user/facade/user-payment.service.ts","ng://@spartacus/core/src/user/facade/user-order.service.ts","ng://@spartacus/core/src/process/store/reducers/index.ts","ng://@spartacus/core/src/process/store/process-store.module.ts","ng://@spartacus/core/src/process/process.module.ts","ng://@spartacus/core/src/model/address.model.ts","ng://@spartacus/core/src/user/store/effects/billing-countries.effect.ts","ng://@spartacus/core/src/user/store/effects/clear-miscs-data.effect.ts","ng://@spartacus/core/src/user/store/effects/delivery-countries.effect.ts","ng://@spartacus/core/src/global-message/models/global-message.model.ts","ng://@spartacus/core/src/global-message/config/global-message-config.ts","ng://@spartacus/core/src/global-message/store/actions/global-message.actions.ts","ng://@spartacus/core/src/global-message/store/selectors/feature.selector.ts","ng://@spartacus/core/src/global-message/store/global-message-state.ts","ng://@spartacus/core/src/global-message/store/selectors/global-message.selectors.ts","ng://@spartacus/core/src/global-message/facade/global-message.service.ts","ng://@spartacus/core/src/global-message/models/response-status.model.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/http-error.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/http-error.interceptor.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/unknown-error.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/bad-gateway.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/bad-request.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/conflict.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/forbidden.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/gateway-timeout.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/not-found.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/index.ts","ng://@spartacus/core/src/global-message/store/reducers/global-message.reducer.ts","ng://@spartacus/core/src/util/compare-equal-objects.ts","ng://@spartacus/core/src/global-message/store/reducers/index.ts","ng://@spartacus/core/src/global-message/store/global-message-store.module.ts","ng://@spartacus/core/src/global-message/store/effects/global-message.effect.ts","ng://@spartacus/core/src/global-message/config/default-global-message-config.ts","ng://@spartacus/core/src/global-message/global-message.module.ts","ng://@spartacus/core/src/user/store/effects/forgot-password.effect.ts","ng://@spartacus/core/src/user/store/effects/order-details.effect.ts","ng://@spartacus/core/src/user/store/effects/payment-methods.effect.ts","ng://@spartacus/core/src/user/store/effects/regions.effect.ts","ng://@spartacus/core/src/user/store/effects/reset-password.effect.ts","ng://@spartacus/core/src/user/store/effects/titles.effect.ts","ng://@spartacus/core/src/user/store/effects/update-email.effect.ts","ng://@spartacus/core/src/user/store/effects/update-password.effect.ts","ng://@spartacus/core/src/user/store/effects/user-addresses.effect.ts","ng://@spartacus/core/src/user/store/effects/user-consents.effect.ts","ng://@spartacus/core/src/user/store/effects/user-details.effect.ts","ng://@spartacus/core/src/user/store/effects/user-orders.effect.ts","ng://@spartacus/core/src/user/store/effects/user-register.effect.ts","ng://@spartacus/core/src/user/store/effects/index.ts","ng://@spartacus/core/src/user/store/user-store.module.ts","ng://@spartacus/core/src/user/user.module.ts","ng://@spartacus/core/src/i18n/config/i18n-config.ts","ng://@spartacus/core/src/i18n/date.pipe.ts","ng://@spartacus/core/src/i18n/translate.pipe.ts","ng://@spartacus/core/src/i18n/translation-chunk.service.ts","ng://@spartacus/core/src/i18n/i18next/i18next-init.ts","ng://@spartacus/core/src/i18n/i18next/i18next-providers.ts","ng://@spartacus/core/src/i18n/config/default-i18n-config.ts","ng://@spartacus/core/src/i18n/i18next/i18next-translation.service.ts","ng://@spartacus/core/src/i18n/i18n.module.ts","ng://@spartacus/core/src/i18n/testing/mock-translate.ts","ng://@spartacus/core/src/i18n/testing/mock-translate.pipe.ts","ng://@spartacus/core/src/i18n/testing/mock-translation.service.ts","ng://@spartacus/core/src/i18n/testing/mock-date.pipe.ts","ng://@spartacus/core/src/i18n/testing/i18n-testing.module.ts","ng://@spartacus/core/src/cx-api/cx-api.service.ts","ng://@spartacus/core/src/kyma/config/kyma-config.ts","ng://@spartacus/core/src/kyma/store/kyma-state.ts","ng://@spartacus/core/src/kyma/store/actions/open-id-token.action.ts","ng://@spartacus/core/src/kyma/store/selectors/feature.selector.ts","ng://@spartacus/core/src/kyma/store/selectors/open-id-token.selectors.ts","ng://@spartacus/core/src/kyma/facade/kyma.service.ts","ng://@spartacus/core/src/kyma/config/default-kyma-config.ts","ng://@spartacus/core/src/kyma/services/open-id-token/open-id-token.service.ts","ng://@spartacus/core/src/kyma/services/index.ts","ng://@spartacus/core/src/kyma/store/effects/open-id-token.effect.ts","ng://@spartacus/core/src/kyma/store/effects/index.ts","ng://@spartacus/core/src/kyma/store/reducers/index.ts","ng://@spartacus/core/src/kyma/store/kyma-store.module.ts","ng://@spartacus/core/src/kyma/kyma.module.ts","ng://@spartacus/core/src/occ/config/config-from-meta-tag-factory.ts","ng://@spartacus/core/src/occ/config/default-occ-config.ts","ng://@spartacus/core/src/occ/config/occ-config-validator.ts","ng://@spartacus/core/src/occ/occ-models/occ.models.ts","ng://@spartacus/core/src/util/converter.service.ts","ng://@spartacus/core/src/occ/adapters/cms/occ-cms-component.adapter.ts","ng://@spartacus/core/src/occ/adapters/cms/converters/occ-cms-page-normalizer.ts","ng://@spartacus/core/src/occ/adapters/cms/occ-cms-page.adapter.ts","ng://@spartacus/core/src/occ/adapters/cms/cms-occ.module.ts","ng://@spartacus/core/src/occ/adapters/cart/occ-cart.adapter.ts","ng://@spartacus/core/src/occ/adapters/cart/occ-cart-entry.adapter.ts","ng://@spartacus/core/src/occ/adapters/cart/converters/occ-cart-normalizer.ts","ng://@spartacus/core/src/occ/adapters/cart/cart-occ.module.ts","ng://@spartacus/core/src/occ/adapters/product/converters/occ-product-references-list-normalizer.ts","ng://@spartacus/core/src/occ/adapters/product/converters/occ-product-search-page-normalizer.ts","ng://@spartacus/core/src/occ/adapters/product/converters/product-image-normalizer.ts","ng://@spartacus/core/src/occ/adapters/product/occ-product-references.adapter.ts","ng://@spartacus/core/src/occ/adapters/product/occ-product-reviews.adapter.ts","ng://@spartacus/core/src/occ/adapters/product/occ-product-search.adapter.ts","ng://@spartacus/core/src/occ/adapters/product/occ-product.adapter.ts","ng://@spartacus/core/src/occ/adapters/product/converters/product-name-normalizer.ts","ng://@spartacus/core/src/occ/adapters/product/default-occ-product-config.ts","ng://@spartacus/core/src/occ/adapters/product/product-occ.module.ts","ng://@spartacus/core/src/occ/adapters/site-context/occ-site.adapter.ts","ng://@spartacus/core/src/occ/adapters/site-context/site-context.interceptor.ts","ng://@spartacus/core/src/occ/adapters/site-context/site-context-occ.module.ts","ng://@spartacus/core/src/store-finder/connectors/store-finder.adapter.ts","ng://@spartacus/core/src/store-finder/connectors/store-finder.connector.ts","ng://@spartacus/core/src/store-finder/connectors/converters.ts","ng://@spartacus/core/src/occ/adapters/store-finder/occ-store-finder.adapter.ts","ng://@spartacus/core/src/occ/adapters/store-finder/store-finder-occ.module.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user-order.adapter.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user-address.adapter.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user.adapter.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user-payment.adapter.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user-consent.adapter.ts","ng://@spartacus/core/src/occ/adapters/user/user-occ.module.ts","ng://@spartacus/core/src/occ/adapters/checkout/occ-checkout.adapter.ts","ng://@spartacus/core/src/occ/adapters/checkout/converters/occ-order-normalizer.ts","ng://@spartacus/core/src/occ/adapters/checkout/occ-checkout-delivery.adapter.ts","ng://@spartacus/core/src/occ/adapters/cart/custom.encoder.ts","ng://@spartacus/core/src/occ/adapters/checkout/occ-checkout-payment.adapter.ts","ng://@spartacus/core/src/occ/adapters/checkout/checkout-occ.module.ts","ng://@spartacus/core/src/occ/occ.module.ts","ng://@spartacus/core/src/occ/adapters/product/converters/product-reference-normalizer.ts","ng://@spartacus/core/src/personalization/config/personalization-config.ts","ng://@spartacus/core/src/personalization/config/default-personalization-config.ts","ng://@spartacus/core/src/personalization/http-interceptors/occ-personalization-id.interceptor.ts","ng://@spartacus/core/src/personalization/http-interceptors/occ-personalization-time.interceptor.ts","ng://@spartacus/core/src/personalization/http-interceptors/index.ts","ng://@spartacus/core/src/personalization/personalization.module.ts","ng://@spartacus/core/src/smart-edit/services/smart-edit.service.ts","ng://@spartacus/core/src/smart-edit/http-interceptors/cms-ticket.interceptor.ts","ng://@spartacus/core/src/smart-edit/http-interceptors/index.ts","ng://@spartacus/core/src/smart-edit/smart-edit.module.ts","ng://@spartacus/core/src/store-finder/config/store-finder-config.ts","ng://@spartacus/core/src/store-finder/store/store-finder-state.ts","ng://@spartacus/core/src/store-finder/store/actions/find-stores.action.ts","ng://@spartacus/core/src/store-finder/store/actions/view-all-stores.action.ts","ng://@spartacus/core/src/store-finder/store/effects/find-stores.effect.ts","ng://@spartacus/core/src/store-finder/store/effects/view-all-stores.effect.ts","ng://@spartacus/core/src/store-finder/store/effects/index.ts","ng://@spartacus/core/src/store-finder/store/reducers/index.ts","ng://@spartacus/core/src/store-finder/store/selectors/feature.selector.ts","ng://@spartacus/core/src/store-finder/store/selectors/find-stores.selectors.ts","ng://@spartacus/core/src/store-finder/store/selectors/view-all-stores.selectors.ts","ng://@spartacus/core/src/store-finder/facade/store-finder.service.ts","ng://@spartacus/core/src/store-finder/facade/store-data.service.ts","ng://@spartacus/core/src/store-finder/service/external-js-file-loader.service.ts","ng://@spartacus/core/src/store-finder/service/google-map-renderer.service.ts","ng://@spartacus/core/src/store-finder/config/default-store-finder-config.ts","ng://@spartacus/core/src/store-finder/store/store-finder-store.module.ts","ng://@spartacus/core/src/store-finder/store-finder.module.ts","ng://@spartacus/core/src/model/image.model.ts","ng://@spartacus/core/src/model/product.model.ts","ng://@spartacus/core/src/state/utils/entity/entity.selectors.ts","ng://@spartacus/core/src/state/utils/loader/loader.helpers.ts","ng://@spartacus/core/src/model/shared.model.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__metadata","metadataKey","metadataValue","metadata","__values","o","m","Symbol","iterator","next","value","done","__read","e","ar","push","error","__spread","concat","defaultServerConfig","isObject","item","isArray","deepMerge","sources","_i","source","shift","Date","_a","_b","_c","ConfigValidatorToken","InjectionToken","provideConfigValidator","configValidator","provide","useValue","multi","validateConfig","config","configValidators","configValidators_1","tslib_1.__values","configValidators_1_1","warning","validate","console","warn","Config","ConfigChunk","provideConfig","provideConfigFactory","configFactory","deps","useFactory","configurationFactory","configChunks","production","ConfigModule","withConfig","ngModule","providers","withConfigFactory","forRoot","ServerConfig","useExisting","Optional","NgModule","args","imports","CommonModule","declarations","NONE","ROUTE","OccConfig","tslib_1.__extends","SiteContextConfig","AuthConfig","defaultAuthConfig","authentication","client_id","client_secret","LOADER_LOAD_ACTION","LOADER_FAIL_ACTION","LOADER_SUCCESS_ACTION","LOADER_RESET_ACTION","loadMeta","entityType","loader","load","failMeta","successMeta","success","resetMeta","LoaderLoadAction","type","meta","AUTH_FEATURE","CLIENT_TOKEN_DATA","LOAD_CLIENT_TOKEN","LOAD_CLIENT_TOKEN_FAIL","LOAD_CLIENT_TOKEN_SUCCESS","LoadClientToken","_super","_this","LoadClientTokenFail","payload","LoaderFailAction","LoadClientTokenSuccess","LoaderSuccessAction","LOGIN","LOGOUT","Login","Logout","LOAD_USER_TOKEN","LOAD_USER_TOKEN_FAIL","LOAD_USER_TOKEN_SUCCESS","REFRESH_USER_TOKEN","REFRESH_USER_TOKEN_FAIL","REFRESH_USER_TOKEN_SUCCESS","LoadUserToken","LoadUserTokenFail","LoadUserTokenSuccess","RefreshUserToken","RefreshUserTokenSuccess","RefreshUserTokenFail","getAuthState","createFeatureSelector","getClientTokenState","createSelector","state","clientToken","getUserTokenState","userToken","getUserToken","token","AuthService","store","authorize","userId","password","dispatch","AuthActions.LoadUserToken","pipe","select","AuthSelectors.getUserToken","refreshUserToken","AuthActions.RefreshUserToken","refreshToken","refresh_token","authorizeWithToken","AuthActions.LoadUserTokenSuccess","logout","AuthActions.Logout","getClientToken","AuthSelectors.getClientTokenState","filter","isClientTokenLoaded","loading","AuthActions.LoadClientToken","map","refreshClientToken","Injectable","providedIn","Store","ClientErrorHandlingService","authService","handleExpiredClientToken","request","take","switchMap","handle","createNewRequestWithNewToken","clone","setHeaders","Authorization","token_type","access_token","WindowRef","document","window","undefined","nativeWindow","sessionStorage","localStorage","Inject","DOCUMENT","UrlParsingService","router","getPrimarySegments","url","urlTree","parseUrl","_getPrimarySegmentsFromUrlTree","root","tree","segments","path","childrenSegments","children","PRIMARY_OUTLET","Router","isParam","segment","startsWith","getParamName","slice","RoutingConfig","RoutingConfigService","getRouteConfig","routeName","routeConfig","routing","routes","result","SemanticPathService","routingConfigService","urlParser","ROOT_URL","get","paths","transform","commands","commands_1","commands_1_1","command","isRouteCommand","partialResult","generateUrlPart","shouldOutputAbsolute","unshift","Boolean","cxRoute","standarizeRouteCommand","findPathWithFillableParams","params","provideParamsValues","paramsMapping","paramName","mappedParamName","getMappedParamName","foundPath","find","getParams","every","GO","GO_BY_URL","BACK","FORWARD","Go","LOAD_LANGUAGES","LOAD_LANGUAGES_FAIL","LOAD_LANGUAGES_SUCCESS","SET_ACTIVE_LANGUAGE","LANGUAGE_CHANGE","LoadLanguages","RouterEffects","actions$","location","navigate$","ofType","RouterActions.GO","action","tap","queryParams","query","extras","navigate","navigateBuUrl$","RouterActions.GO_BY_URL","navigateByUrl","clearCmsRoutes$","_","filteredConfig","route","data","cxCmsRouteContext","resetConfig","navigateBack$","RouterActions.BACK","back","navigateForward$","RouterActions.FORWARD","forward","Actions","Location","tslib_1.__decorate","Effect","Observable","effects","CONTENT_PAGE","PRODUCT_PAGE","CATEGORY_PAGE","CATALOG_PAGE","initialState","navigationId","context","id","cmsRequired","nextState","getReducers","reducer","fromNgrxRouter.ROUTER_NAVIGATION","routerState","event","fromNgrxRouter.ROUTER_ERROR","fromNgrxRouter.ROUTER_CANCEL","fromNgrxRouter.ROUTER_NAVIGATED","reducerToken","reducerProvider","CustomSerializer","serialize","firstChild","canActivate","x","guardName","PageType","pageLabel","urlSegment","join","getRouterFeatureState","getRouterState","getPageContext","routingState","getNextPageContext","isNavigating","RoutingService","winRef","semanticPathService","RoutingSelector.getRouterState","RoutingSelector.getPageContext","RoutingSelector.getNextPageContext","RoutingSelector.isNavigating","go","goByUrl","fromStore.GoByUrl","referrer","includes","origin","fromStore.Back","fromStore.Forward","fromStore.Go","UserErrorHandlingService","routingService","handleExpiredUserToken","handleExpiredToken","handleExpiredRefreshToken","oldToken","InterceptorUtil","createHeader","headerName","interceptorParam","headers","append","JSON","stringify","HttpHeaders","set","removeHeader","updatedHeaders","delete","getInterceptorParam","rawValue","parse","AuthErrorInterceptor","userErrorHandlingService","clientErrorHandlingService","intercept","isClientTokenRequest","catchError","errResponse","HttpErrorResponse","status","isExpiredToken","of","body","throwError","isRequestMapping","resp","errors","SITE_CONTEXT_FEATURE","getSiteContextState","getActiveBaseSite","baseSite","activeSite","getBaseSiteData","details","LOAD_BASE_SITE","LOAD_BASE_SITE_FAIL","LOAD_BASE_SITE_SUCCESS","SET_ACTIVE_BASE_SITE","BASE_SITE_CHANGE","LoadBaseSite","BaseSiteService","getActive","getAll","setActive","subscribe","activeBaseSite","SetActiveBaseSite","initialize","defaultBaseSite","keys","DynamicTemplate","resolve","templateString","templateVariables","values","Function","bind","getContextParameter","parameter","parameters","getContextParameterDefault","param","default","entities","activeLanguage","initialState$1","fromLanguages.LOAD_LANGUAGES_SUCCESS","reduce","langEntities","language","isocode","fromLanguages.SET_ACTIVE_LANGUAGE","LOAD_CURRENCIES","LOAD_CURRENCIES_FAIL","LOAD_CURRENCIES_SUCCESS","SET_ACTIVE_CURRENCY","CURRENCY_CHANGE","LoadCurrencies","activeCurrency","initialState$2","fromCurrencies.LOAD_CURRENCIES_SUCCESS","currEntities","currency","fromCurrencies.SET_ACTIVE_CURRENCY","initialState$3","fromBaseSite.LOAD_BASE_SITE_SUCCESS","fromBaseSite.SET_ACTIVE_BASE_SITE","languages","fromLanguages.reducer","currencies","fromCurrencies.reducer","fromBaseSite.reducer","makeErrorSerializable","Error","message","name","reason","stack","statusText","SiteConnector","adapter","getLanguages","loadLanguages","getCurrencies","loadCurrencies","getCountries","loadCountries","getRegions","countryIsoCode","loadRegions","getBaseSite","loadBaseSite","SiteAdapter","LanguagesEffects","siteConnector","loadLanguages$","actions.LOAD_LANGUAGES","exhaustMap","actions.LoadLanguagesSuccess","actions.LoadLanguagesFail","activateLanguage$","actions.SET_ACTIVE_LANGUAGE","setItem","actions.LanguageChange","CurrenciesEffects","loadCurrencies$","actions.LOAD_CURRENCIES","actions.LoadCurrenciesSuccess","actions.LoadCurrenciesFail","activateCurrency$","actions.SET_ACTIVE_CURRENCY","actions.CurrencyChange","BaseSiteEffects","loadBaseSite$","actions.LOAD_BASE_SITE","actions.LoadBaseSiteSuccess","actions.LoadBaseSiteFail","getCurrenciesState","getCurrenciesEntities","getActiveCurrency","getAllCurrencies","getLanguagesState","getLanguagesEntities","getActiveLanguage","getAllLanguages","LanguageService","SiteContextSelectors.getAllLanguages","fromStore.LoadLanguages","SiteContextSelectors.getActiveLanguage","active","fromStore.SetActiveLanguage","defaultLanguage","getItem","CurrencyService","SiteContextSelectors.getAllCurrencies","fromStore.LoadCurrencies","currenies","SiteContextSelectors.getActiveCurrency","fromStore.SetActiveCurrency","defaultCurrency","LANGUAGE_CONTEXT_ID","CURRENCY_CONTEXT_ID","BASE_SITE_CONTEXT_ID","serviceMapFactory","contextServiceMapProvider","ContextServiceMap","OccEndpointsService","baseSiteService","getBaseEndpoint","backend","occ","baseUrl","prefix","getEndpoint","endpoint","getUrl","urlParams","endpoints","httpParamsOptions","split","fromString","httpParams_1","HttpParams","forEach","toString","ClientTokenInterceptor","occEndpoints","UserTokenInterceptor","isOccUrl","interceptors","HTTP_INTERCEPTORS","useClass","ClientAuthenticationTokenService","http","loadClientAuthenticationToken","getOAuthEndpoint","encodeURIComponent","Content-Type","post","HttpClient","UserAuthenticationTokenService","loadToken","encodeURI","AuthServices","NO_STORAGE","LOCAL_STORAGE","SESSION_STORAGE","TRANSFER_STATE","defaultStateConfig","storageSync","localStorageKeyName","sessionStorageKeyName","getStateSliceValue","previous","current","createShellObject","keySplit","newObject","tempNewObject","currentKey","getStateSlice","stateSlices","keys_1","keys_1_1","getStorageSyncReducer","storageSyncConfig","newState","INIT","UPDATE","rehydratedState","localStorageValue","readFromStorage","sessionStorageValue","rehydrate","localStorageStateSlices","getKeysForStorage","StorageSyncType","persistToStorage","sessionStorageStateSlices","storageType","configKey","storage","isSsr","storageValue","CX_KEY","makeStateKey","getTransferStateReducer","platformId","transferState","ssrTransfer","isPlatformBrowser","authState","isLoggedIn","hasKey","cxKey","transferredStateSlice","getBrowserTransferStateReducer","isPlatformServer","stateSlice","getServerTransferStateReducer","ɵ0$3","ɵ1$3","stateMetaReducers","META_REDUCERS","PLATFORM_ID","TransferState","StateModule","ClientTokenEffect","clientAuthenticationTokenService","loadClientToken$","AuthActions.LOAD_CLIENT_TOKEN","AuthActions.LoadClientTokenSuccess","AuthActions.LoadClientTokenFail","USERID_CURRENT","UserTokenEffects","userTokenService","loadUserToken$","AuthActions.LOAD_USER_TOKEN","mergeMap","date","setSeconds","getSeconds","expires_in","expiration_time","toJSON","AuthActions.LoadUserTokenFail","login$","AuthActions.LOAD_USER_TOKEN_SUCCESS","AuthActions.Login","refreshUserToken$","AuthActions.REFRESH_USER_TOKEN","AuthActions.RefreshUserTokenSuccess","AuthActions.RefreshUserTokenFail","initialLoaderState","loaderReducer","loadActionType","entity","newValue","initialState$4","AuthActions.REFRESH_USER_TOKEN_SUCCESS","AuthActions.LOAD_USER_TOKEN_FAIL","AuthActions.REFRESH_USER_TOKEN_FAIL","combineReducers","fromUserTokenReducer.reducer","clearAuthState","AuthActions.LOGOUT","metaReducers","authStoreConfigFactory","auth.userToken.token","AuthStoreModule","HttpClientModule","StoreModule","forFeature","EffectsModule","AuthModule","AuthRedirectService","ignoredUrls","Set","redirect","redirectUrl","lastAuthGuardNavigation","reportAuthGuard","getCurrentNavigation","reportNotAuthGuard","initialUrl","add","has","navigation","serializeUrl","finalUrl","AuthGuard","authRedirectService","NotAuthGuard","loaderValueSelector","loaderLoadingSelector","loaderErrorSelector","loaderSuccessSelector","CART_FEATURE","CART_DATA","getCartsState","getActiveCartState","cartsState","getCartState","getCartContent","content","getCartRefresh","refresh","getCartLoaded","getCartLoading","getCartMergeComplete","cartMergeComplete","getCartEntriesMap","entries","getCartEntrySelectorFactory","productCode","getCartEntries","code","ANONYMOUS_USERID","CartDataService","_userId","CartSelectors.getCartContent","cart","_cart","hasCart","guid","CART_ADD_ENTRY","CART_ADD_ENTRY_SUCCESS","CART_ADD_ENTRY_FAIL","CART_REMOVE_ENTRY","CART_REMOVE_ENTRY_SUCCESS","CART_REMOVE_ENTRY_FAIL","CART_UPDATE_ENTRY","CART_UPDATE_ENTRY_SUCCESS","CART_UPDATE_ENTRY_FAIL","CartAddEntry","CartAddEntrySuccess","CartAddEntryFail","CartRemoveEntry","CartRemoveEntrySuccess","CartRemoveEntryFail","CartUpdateEntry","CartUpdateEntrySuccess","CartUpdateEntryFail","CREATE_CART","CREATE_CART_FAIL","CREATE_CART_SUCCESS","LOAD_CART","LOAD_CART_FAIL","LOAD_CART_SUCCESS","MERGE_CART","MERGE_CART_SUCCESS","RESET_CART_DETAILS","CreateCart","CreateCartFail","CreateCartSuccess","LoadCart","LoadCartFail","LoadCartSuccess","MergeCart","MergeCartSuccess","ResetCartDetails","CartService","cartData","PREVIOUS_USER_ID_INITIAL_VALUE","previousUserId","_activeCart$","combineLatest","CartSelectors.getCartLoading","debounceTime","asyncScheduler","isJustLoggedIn","loadOrMerge","isCreated","isIncomplete","shareReplay","bufferSize","refCount","getEntries","CartSelectors.getCartEntries","CartSelectors.getCartMergeComplete","getLoaded","CartSelectors.getCartLoaded","CartActions.MergeCart","cartId","CartActions.LoadCart","addEntry","quantity","CartSelectors.getActiveCartState","cartState","CartActions.CreateCart","CartActions.CartAddEntry","removeEntry","entry","CartActions.CartRemoveEntry","entryNumber","updateEntry","CartActions.CartUpdateEntry","qty","getEntry","CartSelectors.getCartEntrySelectorFactory","CartConnector","loadAll","oldCartId","toMergeCartGuid","CartAdapter","CartEffects","cartConnector","loadCart$","CartActions.LOAD_CART","loadCartParams","isMissingData","CartActions.LoadCartFail","CartActions.LoadCartSuccess","createCart$","CartActions.CREATE_CART","CartActions.CreateCartSuccess","CartActions.MergeCartSuccess","CartActions.CreateCartFail","mergeCart$","CartActions.MERGE_CART","currentCart","refresh$","CartActions.MERGE_CART_SUCCESS","CartActions.CART_ADD_ENTRY_SUCCESS","CartActions.CART_UPDATE_ENTRY_SUCCESS","CartActions.CART_REMOVE_ENTRY_SUCCESS","resetCartDetailsOnSiteContextChange$","fromSiteContextActions.LANGUAGE_CHANGE","fromSiteContextActions.CURRENCY_CHANGE","CartActions.ResetCartDetails","CartEntryConnector","update","pickupStore","remove","CartEntryAdapter","CartEntryEffects","cartEntryConnector","addEntry$","CartActions.CART_ADD_ENTRY","CartActions.CartAddEntrySuccess","CartActions.CartAddEntryFail","removeEntry$","CartActions.CART_REMOVE_ENTRY","CartActions.CartRemoveEntrySuccess","CartActions.CartRemoveEntryFail","updateEntry$","CartActions.CART_UPDATE_ENTRY","CartActions.CartUpdateEntrySuccess","CartActions.CartUpdateEntryFail","CHECKOUT_DETAILS","ADD_DELIVERY_ADDRESS","ADD_DELIVERY_ADDRESS_FAIL","ADD_DELIVERY_ADDRESS_SUCCESS","SET_DELIVERY_ADDRESS","SET_DELIVERY_ADDRESS_FAIL","SET_DELIVERY_ADDRESS_SUCCESS","LOAD_SUPPORTED_DELIVERY_MODES","LOAD_SUPPORTED_DELIVERY_MODES_FAIL","LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS","CLEAR_SUPPORTED_DELIVERY_MODES","SET_DELIVERY_MODE","SET_DELIVERY_MODE_FAIL","SET_DELIVERY_MODE_SUCCESS","CREATE_PAYMENT_DETAILS","CREATE_PAYMENT_DETAILS_FAIL","CREATE_PAYMENT_DETAILS_SUCCESS","SET_PAYMENT_DETAILS","SET_PAYMENT_DETAILS_FAIL","SET_PAYMENT_DETAILS_SUCCESS","PLACE_ORDER","PLACE_ORDER_FAIL","PLACE_ORDER_SUCCESS","CLEAR_CHECKOUT_STEP","CLEAR_CHECKOUT_DATA","LOAD_CHECKOUT_DETAILS","LOAD_CHECKOUT_DETAILS_FAIL","LOAD_CHECKOUT_DETAILS_SUCCESS","AddDeliveryAddress","LoadCheckoutDetails","LoadCheckoutDetailsFail","LoadCheckoutDetailsSuccess","initialState$5","CartActions.LOAD_CART_SUCCESS","CartActions.CREATE_CART_SUCCESS","entryMap","product","CartActions.RESET_CART_DETAILS","cartReducer","clearCartState","cartStoreConfigFactory","CartStoreModule","metaReducers$1","CartModule","CART_NORMALIZER","CART_MODIFICATION_NORMALIZER","CmsConfig","CmsStructureConfig","defaultCmsModuleConfig","component","components","pages","page","legacy","ENTITY_REMOVE_ACTION","ENTITY_REMOVE_ALL_ACTION","entityMeta","entityId","entityRemoveMeta","entityRemove","entityRemoveAllMeta","ENTITY_LOAD_ACTION","ENTITY_FAIL_ACTION","ENTITY_SUCCESS_ACTION","ENTITY_RESET_ACTION","entityLoadMeta","entityFailMeta","entitySuccessMeta","entityResetMeta","EntityLoadAction","initialEntityState","entityReducer","ids","partitionPayload","removed_1","newEntities","acc","cur","entityUpdates","subAction","entityLoaderReducer","entityStateSelector","LOAD_PAGE_DATA","LOAD_PAGE_DATA_FAIL","LOAD_PAGE_DATA_SUCCESS","SET_PAGE_FAIL_INDEX","LoadPageData","LoadPageDataFail","pageContext","EntityFailAction","SetPageFailIndex","LoadPageDataSuccess","EntitySuccessAction","CMS_FEATURE","NAVIGATION_DETAIL_ENTITY","COMPONENT_ENTITY","LOAD_COMPONENT","LOAD_COMPONENT_FAIL","LOAD_COMPONENT_SUCCESS","GET_COMPONENET_FROM_PAGE","LoadComponent","LoadComponentFail","uid","LoadComponentSuccess","GetComponentFromPage","cmp","LOAD_NAVIGATION_ITEMS","LOAD_NAVIGATION_ITEMS_FAIL","LOAD_NAVIGATION_ITEMS_SUCCESS","LoadNavigationItems","nodeId","LoadNavigationItemsFail","LoadNavigationItemsSuccess","getCmsState","getComponentState","getComponentEntities","componentStateSelectorFactory","getNavigationEntryItemState","getSelectedNavigationEntryItemState","nodes","getNavigationEntryItems","itemState","getPageState","getPageStateIndex","index","getPageStateIndexEntityLoaderState","category","catalog","getIndexByType","getPageStateIndexLoaderState","indexState","getPageStateIndexValue","getPageEntities","pageData","getPageData","indexValue","getPageComponentTypes","componentTypes","slots","_d","slot","_e","_f","flexType","from","getPageComponentTypesSelector","getCurrentSlotSelectorFactory","position","CmsService","_launchInSmartEdit","isLaunchInSmartEdit","getCurrentPage","CmsSelectors.getPageData","getComponentData","CmsSelectors.componentStateSelectorFactory","componentState","fromCmsActions.LoadComponent","pluck","getContentSlot","CmsSelectors.getCurrentSlotSelectorFactory","navigationNodeUid","CmsSelectors.getNavigationEntryItems","loadNavigationItems","rootUid","itemList","fromCmsActions.LoadNavigationItems","items","refreshLatestPage","fromCmsActions.LoadPageData","refreshPageById","pageId","refreshComponent","CmsSelectors.getPageComponentTypes","hasPage","forceReload","CmsSelectors.getPageStateIndexLoaderState","attemptedLoad","shouldReload","getPageIndex","CmsSelectors.getPageStateIndexValue","setPageFailIndex","fromCmsActions.SetPageFailIndex","PageMetaResolver","getScore","score","pageType","pageTemplate","template","PageMetaService","resolvers","cms","getMeta","metaResolver","getMetaResolver","matchingResolvers","resolver","sort","a","ContentPageMetaResolver","translation","resolveTitle","resolveBreadcrumbLabel","label","resolveBreadcrumbs","title","breadcrumbs","translate","_page","breadcrumbLabel","link","TranslationService","CmsPageTitleModule","UrlPipe","urlService","Pipe","UrlModule","exports","UrlMatcherFactoryService","getFalsyUrlMatcher","getMultiplePathsUrlMatcher","self","matcher","segmentGroup","getPathUrlMatcher","parts","pathMatch","hasChildren","posParams","part","substring","consumed","ConfigurableRoutesService","injector","urlMatcherFactory","initCalled","init","configureRouter","configuredRoutes","configureRoutes","configuredRoute","configureRoute","getRouteName","getConfiguredPaths","Injector","initConfigurableRoutes","service","ConfigurableRoutesModule","APP_INITIALIZER","PageContext","RoutingModule","StoreRouterConnectingModule","stateKey","RouterStateSerializer","CmsStructureConfigService","cmsDataConfig","mergePageStructure","pageStructure","mergePage","mergeSlots","shouldIgnoreBackend","getPageFromConfig","ignoreBackend","getComponentFromConfig","componentId","getComponentById","getComponentsFromConfig","cmsStructure","getComponentsByPosition","typeCode","componentIds","CmsPageConnector","cmsPageAdapter","cmsStructureConfigService","loadFromConfig","mergeDefaultPageStructure","CmsPageAdapter","PageEffects","cmsPageConnector","refreshPage$","pageActions.LoadPageData","loadPageData$","pageActions.LOAD_PAGE_DATA","groupBy","group","componentActions.GetComponentFromPage","pageActions.LoadPageDataSuccess","pageActions.LoadPageDataFail","CmsComponentConnector","configuredComponent","getList","configuredComponents","missingIds","findComponentsByIdsLegacy","findComponentsByIds","loadedComponents","CmsComponentAdapter","ComponentEffects","cmsComponentLoader","loadComponent$","componentActions.LOAD_COMPONENT","componentActions.LoadComponentSuccess","componentActions.LoadComponentFail","NavigationEntryItemEffects","cmsComponentConnector","loadNavigationItems$","navigationItemActions.LOAD_NAVIGATION_ITEMS","getIdListByItemType","navigationItemActions.LoadNavigationItemsSuccess","navigationItemActions.LoadNavigationItemsFail","pageIds","mediaIds","superType","initialState$6","fromNavigationItem.LOAD_NAVIGATION_ITEMS_SUCCESS","newItem","compItems","initialState$7","fromAction.LOAD_PAGE_DATA_SUCCESS","initialState$8","fromAction.LOAD_PAGE_DATA_FAIL","fromAction.SET_PAGE_FAIL_INDEX","fromPageReducer.reducer","fromPageIndexReducer.reducer","fromNavigation.reducer","clearCmsState","cmsStoreConfigFactory","StateTransferType","CmsStoreModule","metaReducers$2","CmsModule","CMS_PAGE_NORMALIZER","CMS_COMPONENT_NORMALIZER","INDEX","NOINDEX","FOLLOW","NOFOLLOW","DynamicAttributeService","addDynamicAttributes","properties","element","renderer","groupProps","propName","propValue","classItem","classList","setAttribute","toLowerCase","LOAD_CARD_TYPES","LOAD_CARD_TYPES_FAIL","LOAD_CARD_TYPES_SUCCESS","LoadCardTypes","VERIFY_ADDRESS","VERIFY_ADDRESS_FAIL","VERIFY_ADDRESS_SUCCESS","CLEAR_ADDRESS_VERIFICATION_RESULTS","VerifyAddress","CHECKOUT_CLEAR_MISCS_DATA","CheckoutClearMiscsData","results","initialState$9","fromAction.VERIFY_ADDRESS_SUCCESS","fromAction.VERIFY_ADDRESS_FAIL","fromAction.CLEAR_ADDRESS_VERIFICATION_RESULTS","getCheckoutState","getCheckoutStepsState","checkoutState","steps","getCheckoutSteps","getDeliveryAddress","address","getDeliveryMode","deliveryMode","getSupportedDeliveryModes","supported","getSelectedDeliveryModeCode","selected","getSelectedDeliveryMode","getPaymentDetails","paymentDetails","getCheckoutOrderDetails","orderDetails","getCheckoutDetailsLoaded","getAddressVerificationResultsState","addressVerification","getAddressVerificationResults","initialState$a","fromAction.LOAD_CARD_TYPES_SUCCESS","cardTypesEntities","fromAction.CHECKOUT_CLEAR_MISCS_DATA","getCardTypesState","cardTypes","getCardTypesEntites","getAllCardTypes","entites","CheckoutService","checkoutStore","placeOrder","actionAllowed","fromCheckoutActions.PlaceOrder","clearCheckoutData","fromCheckoutActions.ClearCheckoutData","clearCheckoutStep","stepNumber","fromCheckoutActions.ClearCheckoutStep","loadCheckoutDetails","fromCheckoutActions.LoadCheckoutDetails","CheckoutSelectors.getCheckoutDetailsLoaded","getOrderDetails","CheckoutSelectors.getCheckoutOrderDetails","CheckoutDeliveryService","CheckoutSelectors.getSupportedDeliveryModes","deliveryModes","loadSupportedDeliveryModes","CheckoutSelectors.getSelectedDeliveryMode","CheckoutSelectors.getSelectedDeliveryModeCode","CheckoutSelectors.getDeliveryAddress","CheckoutSelectors.getAddressVerificationResults","createAndSetAddress","fromCheckoutActions.AddDeliveryAddress","fromCheckoutActions.LoadSupportedDeliveryModes","setDeliveryMode","mode","fromCheckoutActions.SetDeliveryMode","selectedModeId","verifyAddress","fromCheckoutActions.VerifyAddress","setDeliveryAddress","fromCheckoutActions.SetDeliveryAddress","clearAddressVerificationResults","fromCheckoutActions.ClearAddressVerificationResults","CheckoutPaymentService","getCardTypes","CheckoutSelectors.getAllCardTypes","CheckoutSelectors.getPaymentDetails","loadSupportedCardTypes","fromCheckoutActions.LoadCardTypes","createPaymentDetails","fromCheckoutActions.CreatePaymentDetails","setPaymentDetails","fromCheckoutActions.SetPaymentDetails","CartPageMetaResolver","resolveRobots","robots","PageRobotsMeta","CheckoutPageMetaResolver","cartService","count","totalItems","initialState$b","fromAction.ADD_DELIVERY_ADDRESS_SUCCESS","fromAction.SET_DELIVERY_ADDRESS_SUCCESS","fromAction.LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS","supportedModes","modes","fromAction.SET_DELIVERY_MODE_SUCCESS","fromAction.CREATE_PAYMENT_DETAILS_SUCCESS","fromAction.SET_PAYMENT_DETAILS_SUCCESS","fromAction.CREATE_PAYMENT_DETAILS_FAIL","fromAction.PLACE_ORDER_SUCCESS","fromAction.CLEAR_CHECKOUT_DATA","fromAction.CLEAR_CHECKOUT_STEP","fromAction.CLEAR_SUPPORTED_DELIVERY_MODES","fromAction.LOAD_CHECKOUT_DETAILS_SUCCESS","deliveryAddress","paymentInfo","fromCheckout.reducer","fromCardTypes.reducer","fromAddressVerification.reducer","LOAD_BILLING_COUNTRIES","LOAD_BILLING_COUNTRIES_FAIL","LOAD_BILLING_COUNTRIES_SUCCESS","LoadBillingCountries","LOAD_DELIVERY_COUNTRIES","LOAD_DELIVERY_COUNTRIES_FAIL","LOAD_DELIVERY_COUNTRIES_SUCCESS","LoadDeliveryCountries","FORGOT_PASSWORD_EMAIL_REQUEST","FORGOT_PASSWORD_EMAIL_REQUEST_SUCCESS","FORGOT_PASSWORD_EMAIL_REQUEST_FAIL","ForgotPasswordEmailRequest","LOAD_ORDER_DETAILS","LOAD_ORDER_DETAILS_FAIL","LOAD_ORDER_DETAILS_SUCCESS","CLEAR_ORDER_DETAILS","LoadOrderDetails","UPDATE_EMAIL_PROCESS_ID","UPDATE_PASSWORD_PROCESS_ID","UPDATE_USER_DETAILS_PROCESS_ID","REMOVE_USER_PROCESS_ID","GIVE_CONSENT_PROCESS_ID","WITHDRAW_CONSENT_PROCESS_ID","USER_CONSENTS","USER_PAYMENT_METHODS","USER_ORDERS","USER_ADDRESSES","REGIONS","LOAD_USER_PAYMENT_METHODS","LOAD_USER_PAYMENT_METHODS_FAIL","LOAD_USER_PAYMENT_METHODS_SUCCESS","SET_DEFAULT_USER_PAYMENT_METHOD","SET_DEFAULT_USER_PAYMENT_METHOD_FAIL","SET_DEFAULT_USER_PAYMENT_METHOD_SUCCESS","DELETE_USER_PAYMENT_METHOD","DELETE_USER_PAYMENT_METHOD_FAIL","DELETE_USER_PAYMENT_METHOD_SUCCESS","LoadUserPaymentMethods","LoadUserPaymentMethodsFail","LoadUserPaymentMethodsSuccess","SetDefaultUserPaymentMethod","SetDefaultUserPaymentMethodFail","SetDefaultUserPaymentMethodSuccess","DeleteUserPaymentMethod","DeleteUserPaymentMethodFail","DeleteUserPaymentMethodSuccess","LOAD_REGIONS","LOAD_REGIONS_SUCCESS","LOAD_REGIONS_FAIL","CLEAR_REGIONS","LoadRegions","LoadRegionsFail","LoadRegionsSuccess","RESET_PASSWORD","RESET_PASSWORD_SUCCESS","RESET_PASSWORD_FAIL","ResetPassword","LOAD_TITLES","LOAD_TITLES_FAIL","LOAD_TITLES_SUCCESS","LoadTitles","PROCESS_FEATURE","UPDATE_EMAIL","UPDATE_EMAIL_ERROR","UPDATE_EMAIL_SUCCESS","RESET_EMAIL","UpdateEmailAction","UpdateEmailSuccessAction","newUid","UpdateEmailErrorAction","ResetUpdateEmailAction","EntityResetAction","UPDATE_PASSWORD","UPDATE_PASSWORD_FAIL","UPDATE_PASSWORD_SUCCESS","UPDATE_PASSWORD_RESET","UpdatePassword","UpdatePasswordFail","UpdatePasswordSuccess","UpdatePasswordReset","LOAD_USER_ADDRESSES","LOAD_USER_ADDRESSES_FAIL","LOAD_USER_ADDRESSES_SUCCESS","ADD_USER_ADDRESS","ADD_USER_ADDRESS_FAIL","ADD_USER_ADDRESS_SUCCESS","UPDATE_USER_ADDRESS","UPDATE_USER_ADDRESS_FAIL","UPDATE_USER_ADDRESS_SUCCESS","DELETE_USER_ADDRESS","DELETE_USER_ADDRESS_FAIL","DELETE_USER_ADDRESS_SUCCESS","LoadUserAddresses","LoadUserAddressesFail","LoadUserAddressesSuccess","AddUserAddress","AddUserAddressFail","AddUserAddressSuccess","UpdateUserAddress","UpdateUserAddressFail","UpdateUserAddressSuccess","DeleteUserAddress","DeleteUserAddressFail","DeleteUserAddressSuccess","LOAD_USER_CONSENTS","LOAD_USER_CONSENTS_SUCCESS","LOAD_USER_CONSENTS_FAIL","RESET_LOAD_USER_CONSENTS","GIVE_USER_CONSENT","GIVE_USER_CONSENT_FAIL","GIVE_USER_CONSENT_SUCCESS","RESET_GIVE_USER_CONSENT_PROCESS","WITHDRAW_USER_CONSENT","WITHDRAW_USER_CONSENT_FAIL","WITHDRAW_USER_CONSENT_SUCCESS","RESET_WITHDRAW_USER_CONSENT_PROCESS","LoadUserConsents","LoadUserConsentsFail","LoadUserConsentsSuccess","ResetLoadUserConsents","LoaderResetAction","GiveUserConsent","GiveUserConsentFail","GiveUserConsentSuccess","consentTemplate","ResetGiveUserConsentProcess","WithdrawUserConsent","WithdrawUserConsentFail","WithdrawUserConsentSuccess","ResetWithdrawUserConsentProcess","LOAD_USER_DETAILS","LOAD_USER_DETAILS_FAIL","LOAD_USER_DETAILS_SUCCESS","UPDATE_USER_DETAILS","UPDATE_USER_DETAILS_FAIL","UPDATE_USER_DETAILS_SUCCESS","RESET_USER_DETAILS","LoadUserDetails","UpdateUserDetails","UpdateUserDetailsFail","UpdateUserDetailsSuccess","userUpdates","ResetUpdateUserDetails","LOAD_USER_ORDERS","LOAD_USER_ORDERS_FAIL","LOAD_USER_ORDERS_SUCCESS","CLEAR_USER_ORDERS","LoadUserOrders","LoadUserOrdersFail","LoadUserOrdersSuccess","REGISTER_USER","REGISTER_USER_FAIL","REGISTER_USER_SUCCESS","REMOVE_USER","REMOVE_USER_FAIL","REMOVE_USER_SUCCESS","REMOVE_USER_RESET","RegisterUser","RemoveUser","RemoveUserFail","RemoveUserSuccess","RemoveUserReset","CLEAR_MISCS_DATA","ClearMiscsData","CheckoutConnector","CheckoutAdapter","CheckoutDeliveryConnector","createAddress","setAddress","addressId","setMode","deliveryModeId","getMode","getSupportedModes","CheckoutDeliveryAdapter","CheckoutPaymentConnector","paymentDetailsId","loadCardTypes","CheckoutPaymentAdapter","CheckoutEffects","checkoutDeliveryConnector","checkoutPaymentConnector","checkoutConnector","addDeliveryAddress$","fromActions.ADD_DELIVERY_ADDRESS","titleCode","fromUserActions.LoadUserAddresses","fromActions.SetDeliveryAddress","fromActions.AddDeliveryAddressFail","setDeliveryAddress$","fromActions.SET_DELIVERY_ADDRESS","fromActions.SetDeliveryAddressSuccess","fromActions.LoadSupportedDeliveryModes","fromActions.SetDeliveryAddressFail","loadSupportedDeliveryModes$","fromActions.LOAD_SUPPORTED_DELIVERY_MODES","fromActions.LoadSupportedDeliveryModesSuccess","fromActions.LoadSupportedDeliveryModesFail","clearCheckoutMiscsDataOnLanguageChange$","fromActions.CheckoutClearMiscsData","clearDeliveryModesOnCurrencyChange$","fromActions.ClearSupportedDeliveryModes","clearCheckoutDataOnLogout$","fromActions.ClearCheckoutData","setDeliveryMode$","fromActions.SET_DELIVERY_MODE","fromActions.SetDeliveryModeSuccess","fromActions.SetDeliveryModeFail","createPaymentDetails$","fromActions.CREATE_PAYMENT_DETAILS","fromUserActions.LoadUserPaymentMethods","fromActions.CreatePaymentDetailsSuccess","fromActions.CreatePaymentDetailsFail","setPaymentDetails$","fromActions.SET_PAYMENT_DETAILS","fromActions.SetPaymentDetailsSuccess","fromActions.SetPaymentDetailsFail","placeOrder$","fromActions.PLACE_ORDER","fromActions.PlaceOrderSuccess","fromActions.PlaceOrderFail","loadCheckoutDetails$","fromActions.LOAD_CHECKOUT_DETAILS","fromActions.LoadCheckoutDetailsSuccess","fromActions.LoadCheckoutDetailsFail","reloadDetailsOnMergeCart$","fromActions.LoadCheckoutDetails","CardTypesEffects","loadCardTypes$","fromAction.LOAD_CARD_TYPES","fromAction.LoadCardTypesSuccess","fromAction.LoadCardTypesFail","UserAddressConnector","verify","UserAddressAdapter","AddressVerificationEffect","userAddressConnector","verifyAddress$","fromAction.VERIFY_ADDRESS","fromAction.VerifyAddressSuccess","fromAction.VerifyAddressFail","CheckoutStoreModule","CheckoutModule","ORDER_NORMALIZER","DELIVERY_MODE_NORMALIZER","PAYMENT_DETAILS_NORMALIZER","PAYMENT_DETAILS_SERIALIZER","CARD_TYPE_NORMALIZER","CxApiModule","LANGUAGE_NORMALIZER","CURRENCY_NORMALIZER","COUNTRY_NORMALIZER","REGION_NORMALIZER","inititializeContext","langService","currService","contextServiceProviders","SiteContextParamsService","serviceMap","getContextParameters","persistence","contextConfig","getParameter","getParamValues","getParamDefaultValue","getSiteContextService","getValue","val","unsubscribe","setValue","SiteContextUrlSerializer","siteContextParams","urlEncodingParameters","hasContextInRoutes","urlWithParams","urlExtractContextParameters","parsed","urlTreeIncludeContextParameters","paramId","segmentId","siteContext","urlTreeExtractContextParameters","urlIncludeContextParameters","DefaultUrlSerializer","SiteContextRoutesHandler","serializer","subscription","Subscription","contextValues","routingParams","ContextPersistence","setContextParamsFromRoute","subscribeChanges","subscribeRouting","serialized","replaceState","events","NavigationStart","NavigationEnd","NavigationError","NavigationCancel","ngOnDestroy","initSiteContextRoutesHandler","siteContextRoutesHandler","siteContextParamsProviders","UrlSerializer","defaultSiteContextConfigFactory","siteContextStoreConfigFactory","SiteContextStoreModule","baseSiteConfigValidator","SiteContextModule","ProductConnector","ProductAdapter","PRODUCT_NORMALIZER","PRODUCT_REFERENCES_NORMALIZER","ProductReferencesConnector","referenceType","pageSize","ProductReferencesAdapter","ProductReviewsConnector","maxCount","review","ProductReviewsAdapter","PRODUCT_REVIEW_NORMALIZER","PRODUCT_REVIEW_SERIALIZER","ProductSearchConnector","search","searchConfig","getSuggestions","term","loadSuggestions","ProductSearchAdapter","PRODUCT_SEARCH_PAGE_NORMALIZER","PRODUCT_SUGGESTION_NORMALIZER","LOAD_PRODUCT_REFERENCES","LOAD_PRODUCT_REFERENCES_FAIL","LOAD_PRODUCT_REFERENCES_SUCCESS","LoadProductReferences","LOAD_PRODUCT_REVIEWS","LOAD_PRODUCT_REVIEWS_FAIL","LOAD_PRODUCT_REVIEWS_SUCCESS","POST_PRODUCT_REVIEW","POST_PRODUCT_REVIEW_FAIL","POST_PRODUCT_REVIEW_SUCCESS","LoadProductReviews","SEARCH_PRODUCTS","SEARCH_PRODUCTS_FAIL","SEARCH_PRODUCTS_SUCCESS","GET_PRODUCT_SUGGESTIONS","GET_PRODUCT_SUGGESTIONS_SUCCESS","GET_PRODUCT_SUGGESTIONS_FAIL","CLEAR_PRODUCT_SEARCH_RESULT","SearchProducts","auxiliary","clearPageResults","clearSearchboxResults","PRODUCT_FEATURE","PRODUCT_DETAIL_ENTITY","LOAD_PRODUCT","LOAD_PRODUCT_FAIL","LOAD_PRODUCT_SUCCESS","LoadProduct","LoadProductFail","LoadProductSuccess","getProductsState","getProductReferencesState","references","getSelectedProductReferencesFactory","referenceTypeData","list","getProductReviewsState","reviews","getSelectedProductReviewsFactory","reviewData","suggestions","auxResults","initialState$c","fromProductsSearch.SEARCH_PRODUCTS_SUCCESS","res","fromProductsSearch.GET_PRODUCT_SUGGESTIONS_SUCCESS","fromProductsSearch.CLEAR_PRODUCT_SEARCH_RESULT","getProductsSearchState","getSearchResults","getAuxSearchResults","getProductSuggestions","getProductState","getSelectedProductStateFactory","getSelectedProductLoadingFactory","productState","getSelectedProductSuccessFactory","getSelectedProductErrorFactory","getAllProductCodes","codes","ProductReferenceService","ProductSelectors.getSelectedProductReferencesFactory","fromProductActions.LoadProductReferences","ProductReferencesEffects","productReferencesConnector","loadProductReferences$","productReferencesActions.LOAD_PRODUCT_REFERENCES","productReferencesActions.LoadProductReferencesSuccess","_error","productReferencesActions.LoadProductReferencesFail","ProductReviewsEffects","productReviewsConnector","loadProductReviews$","productReviewsActions.LOAD_PRODUCT_REVIEWS","productReviewsActions.LoadProductReviewsSuccess","productReviewsActions.LoadProductReviewsFail","postProductReview","productReviewsActions.POST_PRODUCT_REVIEW","reviewResponse","productReviewsActions.PostProductReviewSuccess","productReviewsActions.PostProductReviewFail","ProductsSearchEffects","productSearchConnector","searchProducts$","productsSearchActions.SEARCH_PRODUCTS","queryText","productsSearchActions.SearchProductsSuccess","productsSearchActions.SearchProductsFail","getProductSuggestions$","productsSearchActions.GET_PRODUCT_SUGGESTIONS","productsSearchActions.GetProductSuggestionsSuccess","productsSearchActions.GetProductSuggestionsFail","ProductEffects","productConnector","loadProduct$","actions.LOAD_PRODUCT","actions.LoadProductSuccess","actions.LoadProductFail","initialState$d","fromProductReferences.LOAD_PRODUCT_REFERENCES_SUCCESS","initialState$e","fromProductReviews.LOAD_PRODUCT_REVIEWS_SUCCESS","fromProductsSearch.reducer","fromProductReviews.reducer","fromProductReferences.reducer","clearProductsState","ProductReviewService","getByProductCode","ProductSelectors.getSelectedProductReviewsFactory","fromStore.LoadProductReviews","fromStore.PostProductReview","ProductSearchService","fromStore.SearchProducts","getResults","ProductSelectors.getSearchResults","clearResults","fromStore.ClearProductSearchResult","ProductService","products","ProductSelectors.getSelectedProductStateFactory","fromStore.LoadProduct","isLoading","ProductSelectors.getSelectedProductLoadingFactory","isSuccess","ProductSelectors.getSelectedProductSuccessFactory","hasError","ProductSelectors.getSelectedProductErrorFactory","reload","SearchboxService","ProductSelectors.getAuxSearchResults","getSuggestionResults","ProductSelectors.getProductSuggestions","searchSuggestions","fromStore.GetProductSuggestions","CategoryPageMetaResolver","productSearchService","hasProductListComponent","pagination","totalResults","facetValueName","br","facetCode","facetValueCode","comp","ProductPageMetaResolver","productService","resolveHeading","resolveDescription","resolveImage","heading","description","image","resolveFirstCategory","resolveManufacturer","summary","categories","name_1","images","PRIMARY","zoom","firstCategory","manufacturer","SearchPageMetaResolver","total$","query$","total","productStoreConfigFactory","ProductStoreModule","metaReducers$3","pageTitleResolvers","ProductModule","UserConnector","username","user","register","requestForgotPasswordEmail","userEmailAddress","resetPassword","newPassword","updateEmail","currentPassword","newUserId","updatePassword","oldPassword","getTitles","loadTitles","UserAdapter","USER_NORMALIZER","USER_SERIALIZER","USER_SIGN_UP_SERIALIZER","TITLE_NORMALIZER","ADDRESS_NORMALIZER","ADDRESS_SERIALIZER","ADDRESS_VALIDATION_NORMALIZER","UserConsentConnector","loadConsents","giveConsent","consentTemplateId","consentTemplateVersion","withdrawConsent","consentCode","UserConsentAdapter","CONSENT_TEMPLATE_NORMALIZER","UserPaymentConnector","paymentMethodID","setDefault","UserPaymentAdapter","UserOrderConnector","orderCode","getHistory","currentPage","loadHistory","UserOrderAdapter","ORDER_HISTORY_NORMALIZER","getProcessStateFactory","processId","entityState","getProcessLoadingFactory","loaderState","getProcessSuccessFactory","getProcessErrorFactory","initialState$f","fromAction.LOAD_BILLING_COUNTRIES_SUCCESS","countryEntities","initialState$g","fromAction.LOAD_DELIVERY_COUNTRIES_SUCCESS","country","fromAction.CLEAR_MISCS_DATA","order","initialState$h","fromOrderDetailsAction.LOAD_ORDER_DETAILS_SUCCESS","fromOrderDetailsAction.CLEAR_ORDER_DETAILS","initialState$i","fromPaymentMethodsAction.LOAD_USER_PAYMENT_METHODS_SUCCESS","fromPaymentMethodsAction.LOAD_USER_PAYMENT_METHODS_FAIL","initialState$j","fromAction.LOAD_REGIONS_SUCCESS","initialState$k","fromAction.RESET_PASSWORD_SUCCESS","initialState$l","fromAction.LOAD_TITLES_SUCCESS","titleEntities","initialState$m","fromActions.LOAD_USER_ADDRESSES_FAIL","fromActions.LOAD_USER_ADDRESSES_SUCCESS","initialState$n","fromActions.LOAD_USER_CONSENTS_SUCCESS","consents","fromActions.GIVE_USER_CONSENT_SUCCESS","updatedConsentTemplate_1","initialState$o","fromUserDetailsAction.LOAD_USER_DETAILS_SUCCESS","fromUserDetailsAction.UPDATE_USER_DETAILS_SUCCESS","updatedDetails","firstName","lastName","orders","sorts","initialState$p","fromUserOrdersAction.LOAD_USER_ORDERS_SUCCESS","fromUserOrdersAction.LOAD_USER_ORDERS_FAIL","account","fromUserDetailsReducer.reducer","addresses","fromAddressesReducer.reducer","billingCountries","fromBillingCountriesReducer.reducer","fromUserConsentsReducer.reducer","payments","fromPaymentReducer.reducer","fromUserOrdersReducer.reducer","fromOrderDetailsReducer.reducer","countries","fromDeliveryCountries.reducer","titles","fromTitlesReducer.reducer","regions","fromRegionsReducer.reducer","fromResetPasswordReducer.reducer","clearUserState","getUserState","getBillingCountriesState","getBillingCountriesEntites","getAllBillingCountries","getDeliveryCountriesState","getDeliveryCountriesEntites","getAllDeliveryCountries","countrySelectorFactory","getOrderState","getPaymentMethodsState","getPaymentMethods","getPaymentMethodsLoading","getRegionsLoaderState","getAllRegions","getRegionsDataAndLoading","loaded","getRegionsCountry","getRegionsLoading","getRegionsLoaded","getResetPassword","getTitlesState","getTitlesEntites","getAllTitles","getAddressesLoaderState","getAddresses","getAddressesLoading","getConsentsState","getConsentsValue","getConsentsLoading","getConsentsSuccess","getConsentsError","getDetailsState","getDetails","getOrdersState","getOrdersLoaded","getOrders","UserService","UsersSelectors.getDetails","fromStore.LoadUserDetails","userRegisterFormData","fromStore.RegisterUser","fromStore.RemoveUser","getRemoveUserResultLoading","fromStore.REMOVE_USER_PROCESS_ID","getRemoveUserResultError","getRemoveUserResultSuccess","resetRemoveUserProcessState","fromStore.RemoveUserReset","UsersSelectors.getAllTitles","fromStore.LoadTitles","isPasswordReset","UsersSelectors.getResetPassword","updatePersonalDetails","userDetails","fromStore.UpdateUserDetails","getUpdatePersonalDetailsResultLoading","getUpdatePersonalDetailsResultError","getUpdatePersonalDetailsResultSuccess","resetUpdatePersonalDetailsProcessingState","fromStore.ResetUpdateUserDetails","fromStore.ResetPassword","fromStore.ForgotPasswordEmailRequest","fromStore.UpdateEmailAction","getUpdateEmailResultSuccess","getUpdateEmailResultError","getUpdateEmailResultLoading","resetUpdateEmailResultState","fromStore.ResetUpdateEmailAction","fromStore.UpdatePassword","getUpdatePasswordResultLoading","fromStore.UPDATE_PASSWORD_PROCESS_ID","getUpdatePasswordResultError","getUpdatePasswordResultSuccess","resetUpdatePasswordProcessState","fromStore.UpdatePasswordReset","UserAddressService","loadAddresses","fromStore.LoadUserAddresses","addUserAddress","fromStore.AddUserAddress","setAddressAsDefault","fromStore.UpdateUserAddress","defaultAddress","updateUserAddress","deleteUserAddress","fromStore.DeleteUserAddress","UsersSelectors.getAddresses","UsersSelectors.getAddressesLoading","loadDeliveryCountries","fromStore.LoadDeliveryCountries","getDeliveryCountries","UsersSelectors.getAllDeliveryCountries","getCountry","UsersSelectors.countrySelectorFactory","fromStore.LoadRegions","clearRegions","fromStore.ClearRegions","UsersSelectors.getRegionsDataAndLoading","UserConsentService","fromStore.LoadUserConsents","getConsents","UsersSelectors.getConsentsValue","getConsentsResultLoading","UsersSelectors.getConsentsLoading","getConsentsResultSuccess","UsersSelectors.getConsentsSuccess","getConsentsResultError","UsersSelectors.getConsentsError","resetConsentsProcessState","fromStore.ResetLoadUserConsents","fromStore.GiveUserConsent","getGiveConsentResultLoading","getGiveConsentResultSuccess","getGiveConsentResultError","resetGiveConsentProcessState","fromStore.ResetGiveUserConsentProcess","fromStore.WithdrawUserConsent","getWithdrawConsentResultLoading","getWithdrawConsentResultSuccess","getWithdrawConsentResultError","resetWithdrawConsentProcessState","fromStore.ResetWithdrawUserConsentProcess","UserPaymentService","loadPaymentMethods","fromStore.LoadUserPaymentMethods","UsersSelectors.getPaymentMethods","UsersSelectors.getPaymentMethodsLoading","setPaymentMethodAsDefault","paymentMethodId","fromStore.SetDefaultUserPaymentMethod","deletePaymentMethod","fromStore.DeleteUserPaymentMethod","UsersSelectors.getAllBillingCountries","loadBillingCountries","fromStore.LoadBillingCountries","UserOrderService","UsersSelectors.getOrderDetails","loadOrderDetails","fromStore.LoadOrderDetails","clearOrderDetails","fromStore.ClearOrderDetails","getOrderHistoryList","UsersSelectors.getOrdersState","orderListState","loadOrderList","getOrderHistoryListLoaded","UsersSelectors.getOrdersLoaded","fromStore.LoadUserOrders","clearOrderList","fromStore.ClearUserOrders","ProcessStoreModule","ProcessModule","BILLING","SHIPPING","BillingCountriesEffect","loadBillingCountries$","fromAction.LOAD_BILLING_COUNTRIES","CountryType","fromAction.LoadBillingCountriesSuccess","fromAction.LoadBillingCountriesFail","ClearMiscsDataEffect","clearMiscsData$","DeliveryCountriesEffects","loadDeliveryCountries$","fromAction.LOAD_DELIVERY_COUNTRIES","fromAction.LoadDeliveryCountriesSuccess","fromAction.LoadDeliveryCountriesFail","MSG_TYPE_CONFIRMATION","MSG_TYPE_ERROR","MSG_TYPE_INFO","GlobalMessageConfig","ADD_MESSAGE","REMOVE_MESSAGE","REMOVE_MESSAGES_BY_TYPE","AddMessage","getGlobalMessageState","getGlobalMessageEntities","getGlobalMessageEntitiesByType","getGlobalMessageCountByType","GlobalMessageService","GlobalMessageSelectors.getGlobalMessageEntities","text","fromGlobalMessageActions.AddMessage","raw","fromGlobalMessageActions.RemoveMessage","fromGlobalMessageActions.RemoveMessagesByType","UNKNOWN","BAD_REQUEST","FORBIDDEN","NOT_FOUND","CONFLICT","BAD_GATEWAY","GATEWAY_TIMEOUT","HttpErrorHandler","globalMessageService","HttpErrorInterceptor","handlers","reverse","response","handleErrorResponse","handler","getResponseHandler","handleError","h","responseStatus","HttpResponseStatus","UnknownErrorHandler","BadGatewayHandler","GlobalMessageType","BadRequestHandler","errorMessage","error_description","subjectType","subject","ConflictHandler","ForbiddenHandler","GatewayTimeoutHandler","NotFoundHandler","errorHandlers","httpErrorInterceptors","initialState$q","fromAction.ADD_MESSAGE","message_1","messages","some","msg","deepEqualObjects","objA","objB","fromAction.REMOVE_MESSAGE","msgType","msgIndex","splice","fromAction.REMOVE_MESSAGES_BY_TYPE","fromGlobalMessage.reducer","GlobalMessageStoreModule","GlobalMessageEffect","hideAfterDelay$","GlobalMessageActions.ADD_MESSAGE","globalMessages","GlobalMessageSelectors.getGlobalMessageCountByType","timeout","GlobalMessageActions.RemoveMessage","delay","defaultGlobalMessageConfigFactory","GlobalMessageModule","ForgotPasswordEffects","userAccountConnector","requestForgotPasswordEmail$","fromActions.FORGOT_PASSWORD_EMAIL_REQUEST","concatMap","fromActions.ForgotPasswordEmailRequestSuccess","fromActions.ForgotPasswordEmailRequestFail","OrderDetailsEffect","orderConnector","loadOrderDetails$","fromOrderDetailsAction.LOAD_ORDER_DETAILS","fromOrderDetailsAction.LoadOrderDetailsSuccess","fromOrderDetailsAction.LoadOrderDetailsFail","UserPaymentMethodsEffects","userPaymentMethodConnector","loadUserPaymentMethods$","fromUserPaymentMethodsAction.LOAD_USER_PAYMENT_METHODS","fromUserPaymentMethodsAction.LoadUserPaymentMethodsSuccess","fromUserPaymentMethodsAction.LoadUserPaymentMethodsFail","setDefaultUserPaymentMethod$","fromUserPaymentMethodsAction.SET_DEFAULT_USER_PAYMENT_METHOD","fromUserPaymentMethodsAction.SetDefaultUserPaymentMethodSuccess","fromUserPaymentMethodsAction.LoadUserPaymentMethods","fromUserPaymentMethodsAction.SetDefaultUserPaymentMethodFail","deleteUserPaymentMethod$","fromUserPaymentMethodsAction.DELETE_USER_PAYMENT_METHOD","fromUserPaymentMethodsAction.DeleteUserPaymentMethodSuccess","fromUserPaymentMethodsAction.DeleteUserPaymentMethodFail","RegionsEffects","loadRegions$","fromActions.LOAD_REGIONS","countryCode","fromActions.LoadRegionsSuccess","fromActions.LoadRegionsFail","resetRegions$","fromActions.CLEAR_REGIONS","ResetPasswordEffects","resetPassword$","fromActions.RESET_PASSWORD","fromActions.ResetPasswordSuccess","fromActions.ResetPasswordFail","TitlesEffects","loadTitles$","fromAction.LOAD_TITLES","sortedTitles","sortTitles","fromAction.LoadTitlesSuccess","fromAction.LoadTitlesFail","UpdateEmailEffects","updateEmail$","fromUpdateEmailAction.UPDATE_EMAIL","fromUpdateEmailAction.UpdateEmailSuccessAction","fromUpdateEmailAction.UpdateEmailErrorAction","UpdatePasswordEffects","updatePassword$","fromActions.UPDATE_PASSWORD","fromActions.UpdatePasswordSuccess","fromActions.UpdatePasswordFail","UserAddressesEffects","userAddressService","messageService","loadUserAddresses$","fromUserAddressesAction.LOAD_USER_ADDRESSES","fromUserAddressesAction.LoadUserAddressesSuccess","fromUserAddressesAction.LoadUserAddressesFail","addUserAddress$","fromUserAddressesAction.ADD_USER_ADDRESS","fromUserAddressesAction.AddUserAddressSuccess","fromUserAddressesAction.AddUserAddressFail","updateUserAddress$","fromUserAddressesAction.UPDATE_USER_ADDRESS","fromUserAddressesAction.LoadUserAddresses","fromUserAddressesAction.UpdateUserAddressSuccess","fromUserAddressesAction.UpdateUserAddressFail","deleteUserAddress$","fromUserAddressesAction.DELETE_USER_ADDRESS","fromUserAddressesAction.DeleteUserAddressSuccess","fromUserAddressesAction.DeleteUserAddressFail","showGlobalMessageOnAddSuccess$","fromUserAddressesAction.ADD_USER_ADDRESS_SUCCESS","showGlobalMessage","showGlobalMessageOnUpdateSuccess$","fromUserAddressesAction.UPDATE_USER_ADDRESS_SUCCESS","showGlobalMessageOnDeleteSuccess$","fromUserAddressesAction.DELETE_USER_ADDRESS_SUCCESS","UserConsentsEffect","userConsentConnector","resetConsents$","fromActions.ResetLoadUserConsents","getConsents$","fromActions.LOAD_USER_CONSENTS","fromActions.LoadUserConsentsSuccess","fromActions.LoadUserConsentsFail","giveConsent$","fromActions.GIVE_USER_CONSENT","consent","fromActions.GiveUserConsentSuccess","fromActions.GiveUserConsentFail","withdrawConsent$","fromActions.WITHDRAW_USER_CONSENT","fromActions.WithdrawUserConsentSuccess","fromActions.WithdrawUserConsentFail","UserDetailsEffects","userConnector","loadUserDetails$","fromUserDetailsAction.LOAD_USER_DETAILS","fromUserDetailsAction.LoadUserDetailsSuccess","fromUserDetailsAction.LoadUserDetailsFail","updateUserDetails$","fromUserDetailsAction.UPDATE_USER_DETAILS","fromUserDetailsAction.UpdateUserDetailsSuccess","fromUserDetailsAction.UpdateUserDetailsFail","UserOrdersEffect","loadUserOrders$","fromUserOrdersAction.LOAD_USER_ORDERS","fromUserOrdersAction.LoadUserOrdersSuccess","fromUserOrdersAction.LoadUserOrdersFail","resetUserOrders$","fromUserOrdersAction.CLEAR_USER_ORDERS","UserRegisterEffects","registerUser$","fromActions.REGISTER_USER","_result","fromActions.RegisterUserSuccess","fromActions.RegisterUserFail","removeUser$","fromActions.REMOVE_USER","fromActions.RemoveUserSuccess","fromActions.RemoveUserFail","UserStoreModule","ReactiveFormsModule","metaReducers$4","RouterModule","UserModule","I18nConfig","CxDatePipe","format","timezone","getLang","lang","getActiveLang","getLocaleId","reportMissingLocaleData","DatePipe","TranslatePipe","cd","input","options","translatedValue","lastKey","aKeys","bKeys","aKeysLen","shallowEqualObjects","lastOptions","sub","markForCheck","pure","ChangeDetectorRef","TranslationChunkService","duplicates","chunks","KEY_SEPARATOR","i18n","chunk","warnDuplicates","getChunkNameForKey","mainKey","dupes","i18nextInit","languageService","i18nextConfig","ns","fallbackLng","fallbackLang","debug","interpolation","escapeValue","i18next","use","i18nextXhrBackend","resources","chunkName","addResourceBundle","i18nextAddTranslations","changeLanguage","ɵ0$n","i18nextProviders","defaultI18nConfig","I18nextTranslationService","translationChunk","NON_BREAKING_SPACE","String","fromCharCode","NAMESPACE_SEPARATOR","whitespaceUntilLoaded","namespacedKey","getNamespacedKey","subscriber","exists","loadNamespaces","reportMissingKey","getFallbackValue","on","off","loadChunks","chunkNames","I18nModule","mockTranslate","optionsString","optionName","MockTranslatePipe","MockTranslationService","_whitespaceUntilLoaded","complete","_chunks","Promise","MockDatePipe","I18nTestingModule","CxApiService","auth","productSearch","productReview","KymaConfig","OPEN_ID_TOKEN_DATA","LOAD_OPEN_ID_TOKEN","LOAD_OPEN_ID_TOKEN_FAIL","LOAD_OPEN_ID_TOKEN_SUCCESS","LoadOpenIdToken","LoadOpenIdTokenFail","LoadOpenIdTokenSuccess","getKymaState","getOpenIdTokenState","openIdToken","getOpenIdTokenValue","getOpenIdTokenLoading","getOpenIdTokenSuccess","getOpenIdTokenError","KymaService","authorizeOpenId","fromKymaActions.LoadOpenIdToken","getOpenIdToken","KymaSelectors.getOpenIdTokenValue","defaultKymaConfig","kyma_enabled","kyma_client_id","kyma_client_secret","OpenIdAuthenticationTokenService","loadOpenIdAuthenticationToken","KymaServices","OpenIdTokenEffect","openIdTokenService","triggerOpenIdTokenLoading$","iif","withLatestFrom","loginAction","fromActions.LoadOpenIdToken","loadOpenIdToken$","fromActions.LOAD_OPEN_ID_TOKEN","fromActions.LoadOpenIdTokenSuccess","fromActions.LoadOpenIdTokenFail","clearKymaState","kymaStoreConfigFactory","kyma.openIdToken.value","KymaStoreModule","metaReducers$5","KymaModule","OCC_BASE_URL_META_TAG_NAME","OCC_BASE_URL_META_TAG_PLACEHOLDER","MEDIA_BASE_URL_META_TAG_NAME","MEDIA_BASE_URL_META_TAG_PLACEHOLDER","occServerConfigFromMetaTagFactory","getMetaTagContent","mediaServerConfigFromMetaTagFactory","media","metaTag","getTag","defaultOccConfig","occConfigValidator","Occ","PriceType","ImageType","Fields","Fields1","Fields2","Fields3","Fields4","Fields5","Fields6","Fields7","Fields8","Fields9","Fields10","Fields11","Fields12","Fields13","Fields14","Fields15","Fields16","SortEnum","Fields17","Fields18","Fields19","Fields20","Fields21","Fields22","Fields23","Fields24","Fields25","Fields26","Fields27","Fields28","Fields29","Fields30","Fields31","Fields32","Fields33","Fields34","Fields35","Fields36","Fields37","Fields38","Fields39","Fields40","Fields41","Fields42","Fields43","Fields44","Fields45","Fields46","Fields47","Fields48","Fields49","Fields50","Fields51","Fields52","Fields53","Fields54","Fields55","Fields56","Fields57","Fields58","Fields59","Fields60","Fields61","Type","ConverterService","converters","Map","getConverters","injectionToken","hasConverters","pipeable","model","convertSource","observable","pipeableMany","convertMany","convert","converter","OccCmsComponentAdapter","getComponentEndPoint","fields","requestParams","getContextParams","getPaginationParams","getComponentsEndpoint","idList","categoryCode","catalogCode","OccCmsPageNormalizer","normalizePageData","normalizePageSlotData","normalizePageComponentData","normalizeComponentData","loadTime","now","contentSlots","contentSlot","OccCmsPageAdapter","httpParams","getPagesRequestParams","getPagesEndpoint","CmsOccModule","DETAILS_PARAMS","OccCartAdapter","getCartEndpoint","cartEndpoint","carts","toAdd","queryString","OccCartEntryAdapter","patch","OccCartNormalizer","CartOccModule","OccProductReferencesListNormalizer","reference","OccProductSearchPageNormalizer","converterService","ProductImageNormalizer","normalize","source_1","source_1_1","isList","imageType","imageContainer","galleryIndex","OccProductReferencesAdapter","OccProductReviewsAdapter","URLSearchParams","headline","comment","rating","alias","DEFAULT_SEARCH_CONFIG","OccProductSearchAdapter","getSearchEndpoint","getSuggestionEndpoint","sortCode","max","OccProductAdapter","ProductNameNormalizer","nameHtml","replace","defaultOccProductConfig","productReviews","productReferences","productSuggestions","ProductOccModule","OccSiteAdapter","languageList","currencyList","countryList","regionsEndpoint","COUNTRIES_ENDPOINT","regionList","urlSplits","pop","siteList","baseSites","site","SiteContextInterceptor","currencyService","activeLang","activeCurr","setParams","curr","SiteContextOccModule","StoreFinderConnector","longitudeLatitude","getCounts","loadCounts","storeId","StoreFinderAdapter","POINT_OF_SERVICE_NORMALIZER","STORE_FINDER_SEARCH_PAGE_NORMALIZER","STORE_COUNT_NORMALIZER","OccStoreFinderAdapter","callOccFindStores","storeCountUrl","getStoresEndpoint","countriesAndRegionsStoreCount","storeDetailsUrl","longitude","latitude","StoreFinderOccModule","OccUserOrderAdapter","getOrderEndpoint","orderEndpoint","orderUrl","OccUserAddressAdapter","getUserEndpoint","addressList","OccUserAdapter","put","titleList","OccUserPaymentAdapter","getPaymentDetailsEndpoint","methodList","billingAddress","defaultPayment","OccUserConsentAdapter","Cache-Control","consentList","consentTemplates","UserOccModule","OccCheckoutAdapter","subEndpoint","OccOrderNormalizer","convertOrderEntry","consignments","consignment","orderEntry","unconsignedEntries","OccCheckoutDeliveryAdapter","CustomEncoder","encodeKey","encodeValue","decodeKey","decodeURIComponent","decodeValue","OccCheckoutPaymentAdapter","DOMParser","domparser","getProviderSubInfo","labelsMap","convertToMap","mappingLabels","postUrl","getParamsForPaymentProvider","createSubWithProvider","extractPaymentDetailsFromHtml","fromPaymentProvider","createDetailsWithParameters","cardTypeList","Accept","encoder","responseType","accountHolderName","cardType","cardNumber","expiryMonth","expiryYear","cvn","line1","line2","town","region","isocodeShort","postalCode","html","inputs","parseFromString","getElementsByTagName","getAttribute","paramList","CheckoutOccModule","OccModule","ProductReferenceNormalizer","defaultPersonalizationConfig","personalization","enabled","httpHeaderName","timestamp","PERSONALIZATION_ID_KEY","OccPersonalizationIdInterceptor","platform","requestHeader","personalizationId","removeItem","HttpResponse","receivedId","PersonalizationConfig","PERSONALIZATION_TIME_KEY","OccPersonalizationTimeInterceptor","receivedTimestamp","PersonalizationModule","SmartEditService","cmsService","zone","isPreviewPage","getCmsTicket","addPageContract","window_1","smartedit","renderComponent","componentType","parentId","reprocessPage","_cmsTicketId","takeWhile","launchInSmartEdit","getDefaultPreviewCode","defaultPreviewCategoryCode","defaultPreviewProductCode","cmsPage","_currentPageId","goToPreviewPage","previousContract_1","attr","classes","run","NgZone","CmsTicketInterceptor","cmsTicketId","SmartEditModule","STORE_FINDER_DATA","ON_HOLD","FIND_STORES","FIND_STORES_FAIL","FIND_STORES_SUCCESS","FIND_STORE_BY_ID","FIND_STORE_BY_ID_FAIL","FIND_STORE_BY_ID_SUCCESS","OnHold","FindStores","FindStoresFail","FindStoresSuccess","FindStoreById","FindStoreByIdFail","FindStoreByIdSuccess","VIEW_ALL_STORES","VIEW_ALL_STORES_FAIL","VIEW_ALL_STORES_SUCCESS","ViewAllStores","ViewAllStoresFail","ViewAllStoresSuccess","FindStoresEffect","storeFinderConnector","findStores$","fromAction.FIND_STORES","stores","fromAction.FindStoresSuccess","fromAction.FindStoresFail","findStoreById$","fromAction.FIND_STORE_BY_ID","fromAction.FindStoreByIdSuccess","fromAction.FindStoreByIdFail","ViewAllStoresEffect","viewAllStores$","fromAction.VIEW_ALL_STORES","fromAction.ViewAllStoresSuccess","fromAction.ViewAllStoresFail","findStores","viewAllStores","getStoreFinderState","getFindStoresState","storesState","getFindStoresEntities","getStoresLoading","getViewAllStoresState","getViewAllStoresEntities","getViewAllStoresLoading","StoreFinderService","geolocationWatchId","StoreFinderSelectors.getStoresLoading","StoreFinderSelectors.getFindStoresEntities","StoreFinderSelectors.getViewAllStoresLoading","StoreFinderSelectors.getViewAllStoresEntities","findStoresAction","fromStore.FindStores","clearWatchGeolocation","fromStore.ViewAllStores","viewStoreById","fromStore.FindStoreById","useMyLocation","fromStore.OnHold","navigator","geolocation","watchPosition","pos","coords","callbackAction","clearWatch","StoreDataService","weekDays","0","1","2","3","4","5","6","getStoreLatitude","geoPoint","getStoreLongitude","getStoreClosingTime","requestedDaySchedule","getSchedule","closed","closingHour","closingTime","formattedHour","closingMinute","minute","valueOf","setHours","setMinutes","getStoreOpeningTime","openingHour","openingTime","openingMinutes","isStoreOpen","openingDate","closingDate","weekday","getDay","openingHours","weekDayOpeningList","weekDayOpeningListItem","weekDay","ExternalJsFileLoader","src","callback","script","createElement","parseParams","async","defer","addEventListener","head","appendChild","keysArray","GoogleMapRendererService","externalJsFileLoader","storeDataService","googleMap","renderMap","mapElement","locations","selectMarkerHandler","googleMaps","apiUrl","apiKey","drawMap","centerMap","latitute","panTo","lat","lng","setZoom","selectedMarkerScale","defineMapCenter","google","maps","LatLng","initMap","mapCenter","mapProp","center","scale","mapTypeId","MapTypeId","ROADMAP","createMarkers","markers","marker","Marker","setMap","addListener","setAnimation","Animation","BOUNCE","StoreFinderConfig","defaultStoreFinderConfig","StoreFinderStoreModule","StoreFinderCoreModule","GALLERY","BUY","FROM","Meta"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export abstract class ServerConfig {\n  production?: boolean;\n}\n\nexport const defaultServerConfig: ServerConfig = {};\n","function isObject(item: any): boolean {\n  return item && typeof item === 'object' && !Array.isArray(item);\n}\n\nexport function deepMerge(target = {}, ...sources: any[]): any {\n  if (!sources.length) {\n    return target;\n  }\n  const source = sources.shift() || {};\n\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (source[key] instanceof Date) {\n        Object.assign(target, { [key]: source[key] });\n      } else if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        deepMerge(target[key], source[key]);\n      } else {\n        Object.assign(target, { [key]: source[key] });\n      }\n    }\n  }\n\n  return deepMerge(target, ...sources);\n}\n","import { InjectionToken, Provider } from '@angular/core';\n\nexport const ConfigValidatorToken = new InjectionToken(\n  'ConfigurationValidator'\n);\n\n/**\n * ConfigValidator is used to validate config and display warning messages in development mode.\n *\n * In case of failed validation, should return a string with error message.\n */\nexport type ConfigValidator = (config: any) => string | void;\n\n/**\n * Use to probide config validation at app bootstrap (when all config chunks are merged)\n *\n * @param configValidator\n */\nexport function provideConfigValidator(\n  configValidator: ConfigValidator\n): Provider {\n  return {\n    provide: ConfigValidatorToken,\n    useValue: configValidator,\n    multi: true,\n  };\n}\n\nexport function validateConfig(\n  config: any,\n  configValidators: ConfigValidator[]\n) {\n  for (const validate of configValidators) {\n    const warning = validate(config);\n    if (warning) {\n      console.warn(warning);\n    }\n  }\n}\n","import {\n  InjectionToken,\n  ModuleWithProviders,\n  NgModule,\n  Provider,\n  Optional,\n} from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport {\n  defaultServerConfig,\n  ServerConfig,\n} from './server-config/server-config';\nimport { deepMerge } from './utils/deep-merge';\nimport {\n  ConfigValidator,\n  ConfigValidatorToken,\n  validateConfig,\n} from './utils/config-validator';\n\n/**\n * Global Configuration injection token, can be used to inject configuration to any part of the app\n */\nexport const Config = new InjectionToken('Configuration');\n\n/**\n * Config chunk token, can be used to provide configuration chunk and contribute to the global configuration object.\n * Should not be used directly, use `provideConfig` or import `ConfigModule.withConfig` instead.\n */\nexport const ConfigChunk = new InjectionToken('ConfigurationChunk');\n\n/**\n * Helper function to provide configuration chunk using ConfigChunk token\n *\n * @param config Config object to merge with the global configuration\n */\nexport function provideConfig(config: any = {}): Provider {\n  return { provide: ConfigChunk, useValue: config, multi: true };\n}\n\n/**\n * Helper function to provide configuration with factory function, using ConfigChunk token\n *\n * @param configFactory Factory Function that will generate config object\n * @param deps Optional dependencies to a factory function\n */\nexport function provideConfigFactory(\n  configFactory: Function,\n  deps?: any[]\n): Provider {\n  return {\n    provide: ConfigChunk,\n    useFactory: configFactory,\n    multi: true,\n    deps: deps,\n  };\n}\n\n/**\n * Factory function that merges all configurations chunks. Should not be used directly without explicit reason.\n *\n */\nexport function configurationFactory(\n  configChunks: any[],\n  configValidators: ConfigValidator[]\n) {\n  const config = deepMerge({}, ...configChunks);\n  if (!config.production) {\n    validateConfig(config, configValidators || []);\n  }\n  return config;\n}\n\n@NgModule({\n  imports: [CommonModule],\n  declarations: [],\n})\nexport class ConfigModule {\n  /**\n   * Import ConfigModule and contribute config to the global configuration\n   *\n   * @param config Config object to merge with the global configuration\n   */\n  static withConfig(config: object): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule,\n      providers: [provideConfig(config)],\n    };\n  }\n\n  /**\n   * Import ConfigModule and contribute config to the global configuration using factory function\n   *\n   * @param configFactory Factory function that will generate configuration\n   * @param deps Optional dependencies to factory function\n   */\n  static withConfigFactory(\n    configFactory: Function,\n    deps?: any[]\n  ): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule,\n      providers: [provideConfigFactory(configFactory, deps)],\n    };\n  }\n\n  /**\n   * Module with providers, should be imported only once, if possible, at the root of the app.\n   *\n   * @param config\n   */\n  static forRoot(config: any = {}): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule,\n      providers: [\n        { provide: ServerConfig, useExisting: Config },\n        provideConfig(defaultServerConfig),\n        provideConfig(config),\n        {\n          provide: Config,\n          useFactory: configurationFactory,\n          deps: [ConfigChunk, [new Optional(), ConfigValidatorToken]],\n        },\n      ],\n    };\n  }\n}\n","export enum ContextPersistence {\n  NONE = 'none',\n  ROUTE = 'route',\n  // possible future values:\n  // SESSION = 'session',\n  // DOMAIN = 'domain',\n  // COOKIE = 'cookie'\n}\n\nexport interface ContextParameter {\n  persistence?: ContextPersistence | string;\n  default?: string;\n  values?: string[];\n}\n\nexport abstract class SiteContextConfig {\n  context?: {\n    parameters?: {\n      [contextName: string]: ContextParameter;\n    };\n    urlEncodingParameters?: string[];\n  };\n}\n","import { SiteContextConfig } from '../../site-context/config/site-context-config';\n\nexport abstract class OccConfig extends SiteContextConfig {\n  backend?: {\n    occ?: {\n      baseUrl?: string;\n      prefix?: string;\n      endpoints?: {\n        [endpoint: string]: string;\n      };\n      legacy?: boolean;\n    };\n    media?: {\n      /**\n       * Media URLs are typically relative, so that the host can be configured.\n       * Configurable media baseURLs are useful for SEO, multi-site,\n       * switching environments, etc.\n       */\n      baseUrl?: string;\n    };\n  };\n}\n","import { OccConfig } from '../../occ/config/occ-config';\n\nexport abstract class AuthConfig extends OccConfig {\n  authentication?: {\n    client_id?: string;\n    client_secret?: string;\n  };\n}\n","import { AuthConfig } from './auth-config';\n\nexport const defaultAuthConfig: AuthConfig = {\n  authentication: {\n    client_id: 'mobile_android',\n    client_secret: 'secret',\n  },\n};\n","import { Action } from '@ngrx/store';\n\nexport const LOADER_LOAD_ACTION = '[LOADER] LOAD';\nexport const LOADER_FAIL_ACTION = '[LOADER] FAIL';\nexport const LOADER_SUCCESS_ACTION = '[LOADER] SUCCESS';\nexport const LOADER_RESET_ACTION = '[LOADER] RESET';\n\nexport interface LoaderMeta {\n  entityType: string;\n  loader: {\n    load?: boolean;\n    error?: any;\n    success?: boolean;\n  };\n}\n\nexport interface LoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: LoaderMeta;\n}\n\nexport function loadMeta(entityType: string): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {\n      load: true,\n    },\n  };\n}\n\nexport function failMeta(entityType: string, error?: any): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {\n      error: error ? error : true,\n    },\n  };\n}\n\nexport function successMeta(entityType: string): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {\n      success: true,\n    },\n  };\n}\n\nexport function resetMeta(entityType: string): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {},\n  };\n}\n\nexport class LoaderLoadAction implements LoaderAction {\n  type = LOADER_LOAD_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string) {\n    this.meta = loadMeta(entityType);\n  }\n}\n\nexport class LoaderFailAction implements LoaderAction {\n  type = LOADER_FAIL_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string, error?: any) {\n    this.meta = failMeta(entityType, error);\n  }\n}\n\nexport class LoaderSuccessAction implements LoaderAction {\n  type = LOADER_SUCCESS_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string) {\n    this.meta = successMeta(entityType);\n  }\n}\n\nexport class LoaderResetAction implements LoaderAction {\n  type = LOADER_RESET_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string) {\n    this.meta = resetMeta(entityType);\n  }\n}\n","import { LoaderState } from '../../state/utils/loader/loader-state';\nimport { ClientToken, UserToken } from '../models/token-types.model';\n\nexport const AUTH_FEATURE = 'auth';\nexport const CLIENT_TOKEN_DATA = '[Auth] Client Token Data';\n\nexport interface StateWithAuth {\n  [AUTH_FEATURE]: AuthState;\n}\n\nexport interface AuthState {\n  userToken: UserTokenState;\n  clientToken: LoaderState<ClientToken>;\n}\n\nexport interface UserTokenState {\n  token: UserToken;\n}\n","import {\n  LoaderFailAction,\n  LoaderLoadAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { ClientToken } from '../../models/token-types.model';\nimport { CLIENT_TOKEN_DATA } from '../auth-state';\n\nexport const LOAD_CLIENT_TOKEN = '[Token] Load Client Token';\nexport const LOAD_CLIENT_TOKEN_FAIL = '[Token] Load Client Token Fail';\nexport const LOAD_CLIENT_TOKEN_SUCCESS = '[Token] Load Client Token Success';\n\nexport class LoadClientToken extends LoaderLoadAction {\n  readonly type = LOAD_CLIENT_TOKEN;\n  constructor() {\n    super(CLIENT_TOKEN_DATA);\n  }\n}\n\nexport class LoadClientTokenFail extends LoaderFailAction {\n  readonly type = LOAD_CLIENT_TOKEN_FAIL;\n  constructor(public payload: any) {\n    super(CLIENT_TOKEN_DATA, payload);\n  }\n}\n\nexport class LoadClientTokenSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_CLIENT_TOKEN_SUCCESS;\n  constructor(public payload: ClientToken) {\n    super(CLIENT_TOKEN_DATA);\n  }\n}\n\nexport type ClientTokenAction =\n  | LoadClientToken\n  | LoadClientTokenFail\n  | LoadClientTokenSuccess;\n","import { Action } from '@ngrx/store';\n\nexport const LOGIN = '[Auth] Login';\nexport const LOGOUT = '[Auth] Logout';\n\nexport class Login implements Action {\n  readonly type = LOGIN;\n}\n\nexport class Logout implements Action {\n  readonly type = LOGOUT;\n}\n\n// action types\nexport type LoginLogoutAction = Login | Logout;\n","import { Action } from '@ngrx/store';\nimport { UserToken } from '../../models/token-types.model';\n\nexport const LOAD_USER_TOKEN = '[Auth] Load User Token';\nexport const LOAD_USER_TOKEN_FAIL = '[Auth] Load User Token Fail';\nexport const LOAD_USER_TOKEN_SUCCESS = '[Auth] Load User Token Success';\nexport const REFRESH_USER_TOKEN = '[Auth] Refresh User Token';\nexport const REFRESH_USER_TOKEN_FAIL = '[Auth] Refresh User Token Fail';\nexport const REFRESH_USER_TOKEN_SUCCESS = '[Auth] Refresh User Token Success';\n\nexport class LoadUserToken implements Action {\n  readonly type = LOAD_USER_TOKEN;\n  constructor(public payload: { userId: string; password: string }) {}\n}\n\nexport class LoadUserTokenFail implements Action {\n  readonly type = LOAD_USER_TOKEN_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadUserTokenSuccess implements Action {\n  readonly type = LOAD_USER_TOKEN_SUCCESS;\n  constructor(public payload: UserToken) {}\n}\n\nexport class RefreshUserToken implements Action {\n  readonly type = REFRESH_USER_TOKEN;\n  constructor(public payload: { refreshToken: string }) {}\n}\n\nexport class RefreshUserTokenSuccess implements Action {\n  readonly type = REFRESH_USER_TOKEN_SUCCESS;\n  constructor(public payload: UserToken) {}\n}\n\nexport class RefreshUserTokenFail implements Action {\n  readonly type = REFRESH_USER_TOKEN_FAIL;\n  constructor(public payload: any) {}\n}\n\n// action types\nexport type UserTokenAction =\n  | LoadUserToken\n  | LoadUserTokenFail\n  | LoadUserTokenSuccess\n  | RefreshUserToken\n  | RefreshUserTokenFail\n  | RefreshUserTokenSuccess;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { AuthState, AUTH_FEATURE, StateWithAuth } from '../auth-state';\n\nexport const getAuthState: MemoizedSelector<\n  StateWithAuth,\n  AuthState\n> = createFeatureSelector<AuthState>(AUTH_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { ClientToken } from '../../models/token-types.model';\nimport { AuthState, StateWithAuth } from '../auth-state';\nimport { getAuthState } from './feature.selector';\n\nexport const getClientTokenState: MemoizedSelector<\n  StateWithAuth,\n  LoaderState<ClientToken>\n> = createSelector(\n  getAuthState,\n  (state: AuthState) => state.clientToken\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { UserToken } from '../../models/token-types.model';\nimport { AuthState, StateWithAuth, UserTokenState } from '../auth-state';\nimport { getAuthState } from './feature.selector';\n\nconst getUserTokenSelector = (state: UserTokenState) => state.token;\n\nexport const getUserTokenState: MemoizedSelector<\n  StateWithAuth,\n  UserTokenState\n> = createSelector(\n  getAuthState,\n  (state: AuthState) => state.userToken\n);\n\nexport const getUserToken: MemoizedSelector<\n  StateWithAuth,\n  UserToken\n> = createSelector(\n  getUserTokenState,\n  getUserTokenSelector\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, map } from 'rxjs/operators';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { ClientToken, UserToken } from '../models/token-types.model';\nimport { AuthActions } from '../store/actions/index';\nimport { StateWithAuth } from '../store/auth-state';\nimport { AuthSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthService {\n  constructor(protected store: Store<StateWithAuth>) {}\n\n  /**\n   * Loads a new user token\n   * @param userId\n   * @param password\n   */\n  authorize(userId: string, password: string): void {\n    this.store.dispatch(\n      new AuthActions.LoadUserToken({\n        userId: userId,\n        password: password,\n      })\n    );\n  }\n\n  /**\n   * Returns the user's token\n   */\n  getUserToken(): Observable<UserToken> {\n    return this.store.pipe(select(AuthSelectors.getUserToken));\n  }\n\n  /**\n   * Refreshes the user token\n   * @param token a user token to refresh\n   */\n  refreshUserToken(token: UserToken): void {\n    this.store.dispatch(\n      new AuthActions.RefreshUserToken({\n        refreshToken: token.refresh_token,\n      })\n    );\n  }\n\n  /**\n   * Store the provided token\n   */\n  authorizeWithToken(token: UserToken): void {\n    this.store.dispatch(new AuthActions.LoadUserTokenSuccess(token));\n  }\n\n  /**\n   * Logout\n   */\n  logout(): void {\n    this.store.dispatch(new AuthActions.Logout());\n  }\n\n  /**\n   * Returns a client token.  The client token from the store is returned if there is one.\n   * Otherwise, an new token is fetched from the backend and saved in the store.\n   */\n  getClientToken(): Observable<ClientToken> {\n    return this.store.pipe(\n      select(AuthSelectors.getClientTokenState),\n      filter((state: LoaderState<ClientToken>) => {\n        if (this.isClientTokenLoaded(state)) {\n          return true;\n        } else {\n          if (!state.loading) {\n            this.store.dispatch(new AuthActions.LoadClientToken());\n          }\n          return false;\n        }\n      }),\n      map((state: LoaderState<ClientToken>) => state.value)\n    );\n  }\n\n  /**\n   * Fetches a clientToken from the backend ans saves it in the store where getClientToken can use it.\n   * The new clientToken is returned.\n   */\n  refreshClientToken(): Observable<ClientToken> {\n    this.store.dispatch(new AuthActions.LoadClientToken());\n\n    return this.store.pipe(\n      select(AuthSelectors.getClientTokenState),\n      filter((state: LoaderState<ClientToken>) =>\n        this.isClientTokenLoaded(state)\n      ),\n      map((state: LoaderState<ClientToken>) => state.value)\n    );\n  }\n\n  protected isClientTokenLoaded(state: LoaderState<ClientToken>): boolean {\n    return (state.success || state.error) && !state.loading;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpRequest, HttpHandler } from '@angular/common/http';\n\nimport { Observable } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\n\nimport { AuthService } from '../../facade/auth.service';\nimport { ClientToken } from '../../models/token-types.model';\n\n@Injectable()\nexport class ClientErrorHandlingService {\n  constructor(protected authService: AuthService) {}\n\n  public handleExpiredClientToken(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<any> {\n    return this.authService.refreshClientToken().pipe(\n      take(1),\n      switchMap((token: ClientToken) => {\n        return next.handle(this.createNewRequestWithNewToken(request, token));\n      })\n    );\n  }\n\n  protected createNewRequestWithNewToken(\n    request: HttpRequest<any>,\n    token: ClientToken\n  ): HttpRequest<any> {\n    request = request.clone({\n      setHeaders: {\n        Authorization: `${token.token_type} ${token.access_token}`,\n      },\n    });\n    return request;\n  }\n}\n","import { Inject, Injectable } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class WindowRef {\n  readonly document: Document;\n\n  constructor(@Inject(DOCUMENT) document) {\n    // it's a workaround to have document property properly typed\n    // see: https://github.com/angular/angular/issues/15640\n    this.document = document;\n  }\n\n  get nativeWindow(): Window {\n    return typeof window !== 'undefined' ? window : undefined;\n  }\n\n  get sessionStorage(): Storage {\n    return this.nativeWindow ? this.nativeWindow.sessionStorage : undefined;\n  }\n\n  get localStorage(): Storage {\n    return this.nativeWindow ? this.nativeWindow.localStorage : undefined;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { UrlSegmentGroup, PRIMARY_OUTLET } from '@angular/router';\n\n@Injectable({ providedIn: 'root' })\nexport class UrlParsingService {\n  constructor(private router: Router) {}\n\n  getPrimarySegments(url: string): string[] {\n    const urlTree = this.router.parseUrl(url);\n    return this._getPrimarySegmentsFromUrlTree(urlTree.root);\n  }\n\n  private _getPrimarySegmentsFromUrlTree(tree: UrlSegmentGroup): string[] {\n    const segments = tree.segments.map(s => s.path);\n    const childrenSegments = tree.children[PRIMARY_OUTLET]\n      ? this._getPrimarySegmentsFromUrlTree(tree.children[PRIMARY_OUTLET])\n      : [];\n    return segments.concat(childrenSegments);\n  }\n}\n","export const isParam = (segment: string): boolean => segment.startsWith(':');\n\nexport const getParamName = (segment: string): string => segment.slice(1); // it just removes leading ':'\n\nexport const ensureLeadingSlash = (path: string): string =>\n  path.startsWith('/') ? path : '/' + path;\n\nexport const removeLeadingSlash = (path: string): string =>\n  path.startsWith('/') ? path.slice(1) : path;\n","import { RoutesConfig } from '../routes-config';\nimport { ServerConfig } from '../../../config/server-config/server-config';\n\nexport abstract class RoutingConfig extends ServerConfig {\n  routing?: {\n    routes: RoutesConfig;\n  };\n}\n","import { Injectable } from '@angular/core';\nimport { RouteConfig } from './routes-config';\nimport { RoutingConfig } from './config/routing-config';\n\n@Injectable({ providedIn: 'root' })\nexport class RoutingConfigService {\n  constructor(protected config: RoutingConfig) {}\n\n  getRouteConfig(routeName: string): RouteConfig {\n    const routeConfig =\n      this.config && this.config.routing && this.config.routing.routes;\n\n    const result = routeConfig && routeConfig[routeName];\n    if (!routeConfig || result === undefined) {\n      this.warn(`No path was configured for the named route '${routeName}'!`);\n    }\n    return result;\n  }\n\n  private warn(...args) {\n    if (!this.config.production) {\n      console.warn(...args);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { UrlParsingService } from './url-parsing.service';\nimport { ServerConfig } from '../../../config/server-config/server-config';\nimport { RouteConfig, ParamsMapping } from '../routes-config';\nimport { getParamName, isParam } from './path-utils';\nimport { UrlCommandRoute, UrlCommands, UrlCommand } from './url-command';\nimport { RoutingConfigService } from '../routing-config.service';\n\n@Injectable({ providedIn: 'root' })\nexport class SemanticPathService {\n  readonly ROOT_URL = ['/'];\n\n  constructor(\n    protected routingConfigService: RoutingConfigService,\n    protected urlParser: UrlParsingService,\n    protected config: ServerConfig\n  ) {}\n\n  /**\n   * Returns the first path alias configured for a given route name. It adds `/` at the beginning.\n   */\n  get(routeName: string): string {\n    const routeConfig = this.routingConfigService.getRouteConfig(routeName);\n    return routeConfig && Array.isArray(routeConfig.paths)\n      ? '/' + routeConfig.paths[0]\n      : undefined;\n  }\n\n  /**\n   * Transforms the array of url commands. Each command can be:\n   * a) string - will be left untouched\n   * b) object { cxRoute: <route name> } - will be replaced with semantic path\n   * c) object { cxRoute: <route name>, params: { ... } } - same as above, but with passed params\n   *\n   * If the first command is the object with the `cxRoute` property, returns an absolute url (with the first element of the array `'/'`)\n   */\n  transform(commands: UrlCommands): any[] {\n    if (!Array.isArray(commands)) {\n      commands = [commands];\n    }\n\n    const result: string[] = [];\n    for (const command of commands) {\n      if (!this.isRouteCommand(command)) {\n        // don't modify segment that is not route command:\n        result.push(command);\n      } else {\n        // generate array with url segments for given route command:\n        const partialResult = this.generateUrlPart(command);\n\n        if (partialResult === null) {\n          return this.ROOT_URL;\n        }\n\n        result.push(...partialResult);\n      }\n    }\n\n    if (this.shouldOutputAbsolute(commands)) {\n      result.unshift('/');\n    }\n\n    return result;\n  }\n\n  private isRouteCommand(command: UrlCommand): boolean {\n    return command && Boolean(command.cxRoute);\n  }\n\n  private shouldOutputAbsolute(commands: UrlCommands): boolean {\n    return this.isRouteCommand(commands[0]);\n  }\n\n  private generateUrlPart(command: UrlCommandRoute): string[] | null {\n    this.standarizeRouteCommand(command);\n\n    if (!command.cxRoute) {\n      return null;\n    }\n\n    const routeConfig = this.routingConfigService.getRouteConfig(\n      command.cxRoute\n    );\n\n    // if no route translation was configured, return null:\n    if (!routeConfig || !routeConfig.paths) {\n      return null;\n    }\n\n    // find first path that can satisfy it's parameters with given parameters\n    const path = this.findPathWithFillableParams(routeConfig, command.params);\n\n    // if there is no configured path that can be satisfied with given params, return null\n    if (!path) {\n      return null;\n    }\n\n    const result = this.provideParamsValues(\n      path,\n      command.params,\n      routeConfig.paramsMapping\n    );\n\n    return result;\n  }\n\n  private standarizeRouteCommand(command: UrlCommandRoute): void {\n    command.params = command.params || {};\n  }\n\n  private provideParamsValues(\n    path: string,\n    params: object,\n    paramsMapping: ParamsMapping\n  ): string[] {\n    return this.urlParser.getPrimarySegments(path).map(segment => {\n      if (isParam(segment)) {\n        const paramName = getParamName(segment);\n        const mappedParamName = this.getMappedParamName(\n          paramName,\n          paramsMapping\n        );\n        return params[mappedParamName];\n      }\n      return segment;\n    });\n  }\n\n  private findPathWithFillableParams(\n    routeConfig: RouteConfig,\n    params: object\n  ): string {\n    const foundPath = routeConfig.paths.find(path =>\n      this.getParams(path).every(paramName => {\n        const mappedParamName = this.getMappedParamName(\n          paramName,\n          routeConfig.paramsMapping\n        );\n\n        return params[mappedParamName] !== undefined;\n      })\n    );\n\n    if (foundPath === undefined || foundPath === null) {\n      this.warn(\n        `No configured path matches all its params to given object. `,\n        `Route config: `,\n        routeConfig,\n        `Params object: `,\n        params\n      );\n      return null;\n    }\n    return foundPath;\n  }\n\n  private getParams(path: string) {\n    return this.urlParser\n      .getPrimarySegments(path)\n      .filter(isParam)\n      .map(getParamName);\n  }\n\n  private getMappedParamName(paramName: string, paramsMapping: object): string {\n    if (paramsMapping) {\n      return paramsMapping[paramName] || paramName;\n    }\n    return paramName;\n  }\n\n  private warn(...args) {\n    if (!this.config.production) {\n      console.warn(...args);\n    }\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { NavigationExtras } from '@angular/router';\n\nexport const GO = '[Router] Go';\nexport const GO_BY_URL = '[Router] Go By Url';\nexport const BACK = '[Router] Back';\nexport const FORWARD = '[Router] Forward';\n\nexport class Go implements Action {\n  readonly type = GO;\n  constructor(\n    public payload: {\n      path: string[];\n      query?: object;\n      extras?: NavigationExtras;\n    }\n  ) {}\n}\n\nexport class GoByUrl implements Action {\n  readonly type = GO_BY_URL;\n  constructor(public payload: string) {}\n}\n\nexport class Back implements Action {\n  readonly type = BACK;\n}\n\nexport class Forward implements Action {\n  readonly type = FORWARD;\n}\n\nexport type Actions = Go | GoByUrl | Back | Forward;\n","import { Action } from '@ngrx/store';\nimport { Language } from '../../../model/misc.model';\n\nexport const LOAD_LANGUAGES = '[Site-context] Load Languages';\nexport const LOAD_LANGUAGES_FAIL = '[Site-context] Load Languages Fail';\nexport const LOAD_LANGUAGES_SUCCESS = '[Site-context] Load Languages Success';\nexport const SET_ACTIVE_LANGUAGE = '[Site-context] Set Active Language';\nexport const LANGUAGE_CHANGE = '[Site-context] Language Change';\n\nexport class LoadLanguages implements Action {\n  readonly type = LOAD_LANGUAGES;\n}\n\nexport class LoadLanguagesFail implements Action {\n  readonly type = LOAD_LANGUAGES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadLanguagesSuccess implements Action {\n  readonly type = LOAD_LANGUAGES_SUCCESS;\n  constructor(public payload: Language[]) {}\n}\n\nexport class SetActiveLanguage implements Action {\n  readonly type = SET_ACTIVE_LANGUAGE;\n  constructor(public payload: string) {}\n}\n\nexport class LanguageChange implements Action {\n  readonly type = LANGUAGE_CHANGE;\n}\n\n// action types\nexport type LanguagesAction =\n  | LoadLanguages\n  | LoadLanguagesFail\n  | LoadLanguagesSuccess\n  | SetActiveLanguage\n  | LanguageChange;\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Location } from '@angular/common';\n\nimport { Effect, Actions, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport * as RouterActions from '../actions/router.action';\nimport { Observable } from 'rxjs';\nimport { tap, map } from 'rxjs/operators';\nimport { LOGIN, LOGOUT } from '../../../auth/store/actions/login-logout.action';\nimport { LANGUAGE_CHANGE } from '../../../site-context/store/actions/languages.action';\nimport { CmsRoute } from '../../models/cms-route';\n\n@Injectable()\nexport class RouterEffects {\n  @Effect({ dispatch: false })\n  navigate$: Observable<any> = this.actions$.pipe(\n    ofType(RouterActions.GO),\n    map((action: RouterActions.Go) => action.payload),\n    tap(({ path, query: queryParams, extras }) => {\n      this.router.navigate(path, { queryParams, ...extras });\n    })\n  );\n\n  @Effect({ dispatch: false })\n  navigateBuUrl$: Observable<any> = this.actions$.pipe(\n    ofType(RouterActions.GO_BY_URL),\n    map((action: RouterActions.Go) => action.payload),\n    tap(url => {\n      this.router.navigateByUrl(url);\n    })\n  );\n\n  @Effect({ dispatch: false })\n  clearCmsRoutes$: Observable<Action> = this.actions$.pipe(\n    ofType(LANGUAGE_CHANGE, LOGOUT, LOGIN),\n    tap(_ => {\n      const filteredConfig = this.router.config.filter(\n        (route: CmsRoute) => !(route.data && route.data.cxCmsRouteContext)\n      );\n      if (filteredConfig.length !== this.router.config.length) {\n        this.router.resetConfig(filteredConfig);\n      }\n    })\n  );\n\n  @Effect({ dispatch: false })\n  navigateBack$: Observable<Action> = this.actions$.pipe(\n    ofType(RouterActions.BACK),\n    tap(() => this.location.back())\n  );\n\n  @Effect({ dispatch: false })\n  navigateForward$: Observable<Action> = this.actions$.pipe(\n    ofType(RouterActions.FORWARD),\n    tap(() => this.location.forward())\n  );\n\n  constructor(\n    private actions$: Actions,\n    private router: Router,\n    private location: Location\n  ) {}\n}\n","import { RouterEffects } from './router.effect';\n\nexport const effects: any[] = [RouterEffects];\n\nexport * from './router.effect';\n","export interface CmsComponent {\n  modifiedTime?: Date;\n  name?: string;\n  otherProperties?: any;\n  typeCode?: string;\n  uid?: string;\n}\n\nexport enum PageType {\n  CONTENT_PAGE = 'ContentPage',\n  PRODUCT_PAGE = 'ProductPage',\n  CATEGORY_PAGE = 'CategoryPage',\n  CATALOG_PAGE = 'CatalogPage',\n}\n\nexport interface CmsLinkComponent extends CmsComponent {\n  url?: string;\n  container?: boolean;\n  external?: boolean;\n  contentPage?: string;\n  contentPageLabelOrId?: string;\n  linkName?: string;\n  target?: boolean;\n}\n\nexport interface CmsSiteContextSelectorComponent extends CmsComponent {\n  context?: string;\n}\n\nexport interface CmsSearchBoxComponent extends CmsComponent {\n  container?: boolean;\n  maxSuggestions?: number;\n  maxProducts?: number;\n  displaySuggestions?: boolean;\n  displayProducts?: boolean;\n  displayProductImages?: boolean;\n  waitTimeBeforeRequest?: number;\n  minCharactersBeforeRequest?: number;\n}\n\nexport interface CmsParagraphComponent extends CmsComponent {\n  content?: string;\n  container?: string;\n  title?: string;\n}\n\nexport interface CMSTabParagraphContainer extends CmsComponent {\n  container?: string;\n  components?: string;\n}\n\nexport interface CmsBannerComponentMedia {\n  altText?: string;\n  code?: string;\n  mime?: string;\n  url?: string;\n}\n\nexport interface CmsResponsiveBannerComponentMedia {\n  desktop?: CmsBannerComponentMedia;\n  mobile?: CmsBannerComponentMedia;\n  tablet?: CmsBannerComponentMedia;\n  widescreen?: CmsBannerComponentMedia;\n}\n\nexport interface CmsBannerComponent extends CmsComponent {\n  headline?: string;\n  content?: string;\n  container?: string;\n  media?: CmsBannerComponentMedia | CmsResponsiveBannerComponentMedia;\n  urlLink?: string;\n  external?: string;\n}\n\nexport interface CmsProductCarouselComponent extends CmsComponent {\n  title?: string;\n  productCodes?: string;\n  container?: string;\n  popup?: string;\n  scroll?: string;\n}\n\nexport interface CmsProductReferencesComponent extends CmsComponent {\n  title?: string;\n  displayProductTitles?: string;\n  displayProductPrices?: string;\n  maximumNumberProducts?: number;\n  productReferenceTypes?: string;\n  container?: string;\n}\n\nexport interface CmsMiniCartComponent extends CmsComponent {\n  container?: string;\n  shownProductCount?: string;\n  title?: string;\n  totalDisplay?: string;\n  lightboxBannerComponent?: CmsBannerComponent;\n}\n\n// TODO: Upgrade model when Breadcrumbs will be finally used in project\nexport interface CmsBreadcrumbsComponent extends CmsComponent {\n  container?: string;\n}\n\nexport interface CmsNavigationNode {\n  uid?: string;\n  title?: string;\n  children?: Array<CmsNavigationNode>;\n  entries?: Array<CmsNavigationEntry>;\n}\n\nexport interface CmsNavigationEntry {\n  itemId?: string;\n  itemSuperType?: string;\n  itemType?: string;\n}\n\nexport interface CmsNavigationComponent extends CmsComponent {\n  container?: string;\n  styleClass?: string;\n  wrapAfter?: string;\n  notice?: string;\n  showLanguageCurrency?: string;\n  navigationNode?: CmsNavigationNode;\n}\n\nexport interface CmsProductFacetNavigationComponent extends CmsComponent {\n  container?: string;\n  activeFacetValueCode?: string;\n  searchResult?: string;\n  minPerFacet?: string;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { RouterStateSnapshot } from '@angular/router';\nimport * as fromNgrxRouter from '@ngrx/router-store';\nimport { ActionReducerMap } from '@ngrx/store';\nimport { PageType } from '../../../model/cms.model';\nimport { CmsActivatedRouteSnapshot } from '../../models/cms-route';\nimport { PageContext } from '../../models/page-context.model';\nimport {\n  ActivatedRouterStateSnapshot,\n  RouterState,\n  State,\n} from '../routing-state';\n\nexport const initialState: RouterState = {\n  navigationId: 0,\n  state: {\n    url: '',\n    queryParams: {},\n    params: {},\n    context: {\n      id: '',\n    },\n    cmsRequired: false,\n  },\n  nextState: undefined,\n};\n\nexport function getReducers(): ActionReducerMap<State> {\n  return {\n    router: reducer,\n  };\n}\n\nexport function reducer(\n  state: RouterState = initialState,\n  action: any\n): RouterState {\n  switch (action.type) {\n    case fromNgrxRouter.ROUTER_NAVIGATION: {\n      return {\n        ...state,\n        nextState: action.payload.routerState,\n        navigationId: action.payload.event.id,\n      };\n    }\n\n    case fromNgrxRouter.ROUTER_ERROR:\n    case fromNgrxRouter.ROUTER_CANCEL: {\n      return {\n        ...state,\n        nextState: undefined,\n      };\n    }\n\n    case fromNgrxRouter.ROUTER_NAVIGATED: {\n      return {\n        state: action.payload.routerState,\n        navigationId: action.payload.event.id,\n        nextState: undefined,\n      };\n    }\n\n    default: {\n      return state;\n    }\n  }\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<State>\n> = new InjectionToken<ActionReducerMap<State>>('RouterReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\n/* The serializer is there to parse the RouterStateSnapshot,\nand to reduce the amount of properties to be passed to the reducer.\n */\nexport class CustomSerializer\n  implements\n    fromNgrxRouter.RouterStateSerializer<ActivatedRouterStateSnapshot> {\n  serialize(routerState: RouterStateSnapshot): ActivatedRouterStateSnapshot {\n    const { url } = routerState;\n    const { queryParams } = routerState.root;\n\n    let state: CmsActivatedRouteSnapshot = routerState.root as CmsActivatedRouteSnapshot;\n    let cmsRequired = false;\n    let context: PageContext;\n\n    while (state.firstChild) {\n      state = state.firstChild as CmsActivatedRouteSnapshot;\n\n      // we use context information embedded in Cms driven routes from any parent route\n      if (state.data && state.data.cxCmsRouteContext) {\n        context = state.data.cxCmsRouteContext;\n      }\n\n      // we assume, that any route that has CmsPageGuard or it's child\n      // is cmsRequired\n      if (\n        !cmsRequired &&\n        (context ||\n          (state.routeConfig &&\n            state.routeConfig.canActivate &&\n            state.routeConfig.canActivate.find(\n              x => x && x.guardName === 'CmsPageGuard'\n            )))\n      ) {\n        cmsRequired = true;\n      }\n    }\n    const { params } = state;\n\n    // we give smartedit preview page a PageContext\n    if (state.url.length > 0 && state.url[0].path === 'cx-preview') {\n      context = {\n        id: 'smartedit-preview',\n        type: PageType.CONTENT_PAGE,\n      };\n    } else {\n      if (params['productCode']) {\n        context = { id: params['productCode'], type: PageType.PRODUCT_PAGE };\n      } else if (params['categoryCode']) {\n        context = { id: params['categoryCode'], type: PageType.CATEGORY_PAGE };\n      } else if (params['brandCode']) {\n        context = { id: params['brandCode'], type: PageType.CATEGORY_PAGE };\n      } else if (state.data.pageLabel !== undefined) {\n        context = { id: state.data.pageLabel, type: PageType.CONTENT_PAGE };\n      } else if (!context) {\n        if (state.url.length > 0) {\n          const pageLabel =\n            '/' + state.url.map(urlSegment => urlSegment.path).join('/');\n          context = {\n            id: pageLabel,\n            type: PageType.CONTENT_PAGE,\n          };\n        } else {\n          context = {\n            id: 'homepage',\n            type: PageType.CONTENT_PAGE,\n          };\n        }\n      }\n    }\n\n    return { url, queryParams, params, context, cmsRequired };\n  }\n}\n","import {\n  createFeatureSelector,\n  createSelector,\n  MemoizedSelector,\n} from '@ngrx/store';\nimport { PageContext } from '../../models/page-context.model';\nimport { RouterState, ROUTING_FEATURE, State } from '../routing-state';\n\nexport const getRouterFeatureState: MemoizedSelector<\n  any,\n  State\n> = createFeatureSelector<State>(ROUTING_FEATURE);\n\nexport const getRouterState: MemoizedSelector<\n  any,\n  RouterState\n> = createSelector(\n  getRouterFeatureState,\n  state => state.router\n);\n\nexport const getPageContext: MemoizedSelector<\n  any,\n  PageContext\n> = createSelector(\n  getRouterState,\n  (routingState: RouterState) =>\n    (routingState.state && routingState.state.context) || { id: '' }\n);\n\nexport const getNextPageContext: MemoizedSelector<\n  any,\n  PageContext\n> = createSelector(\n  getRouterState,\n  (routingState: RouterState) =>\n    routingState.nextState && routingState.nextState.context\n);\n\nexport const isNavigating: MemoizedSelector<any, boolean> = createSelector(\n  getNextPageContext,\n  context => !!context\n);\n","import { Params } from '@angular/router';\nimport * as fromNgrxRouter from '@ngrx/router-store';\nimport { PageContext } from '../models/page-context.model';\n\nexport const ROUTING_FEATURE = 'router';\n\nexport interface RouterState\n  extends fromNgrxRouter.RouterReducerState<ActivatedRouterStateSnapshot> {\n  nextState?: ActivatedRouterStateSnapshot;\n}\n\nexport interface ActivatedRouterStateSnapshot {\n  url: string;\n  queryParams: Params;\n  params: Params;\n  context: PageContext;\n  cmsRequired: boolean;\n}\n\nexport interface State {\n  [ROUTING_FEATURE]: RouterState;\n}\n","import { Injectable } from '@angular/core';\nimport { NavigationExtras } from '@angular/router';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { WindowRef } from '../../window/window-ref';\nimport { SemanticPathService } from '../configurable-routes/url-translation/semantic-path.service';\nimport { UrlCommands } from '../configurable-routes/url-translation/url-command';\nimport { PageContext } from '../models/page-context.model';\nimport * as fromStore from '../store';\nimport { RouterState } from '../store/routing-state';\nimport { RoutingSelector } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class RoutingService {\n  constructor(\n    protected store: Store<fromStore.RouterState>,\n    protected winRef: WindowRef,\n    protected semanticPathService: SemanticPathService\n  ) {}\n\n  /**\n   * Get the current router state\n   */\n  getRouterState(): Observable<RouterState> {\n    return this.store.pipe(select(RoutingSelector.getRouterState));\n  }\n\n  /**\n   * Get the `PageContext` from the state\n   */\n  getPageContext(): Observable<PageContext> {\n    return this.store.pipe(select(RoutingSelector.getPageContext));\n  }\n\n  /**\n   * Get the next `PageContext` from the state\n   */\n  getNextPageContext(): Observable<PageContext> {\n    return this.store.pipe(select(RoutingSelector.getNextPageContext));\n  }\n\n  /**\n   * Get the `isNavigating` info from the state\n   */\n  isNavigating(): Observable<boolean> {\n    return this.store.pipe(select(RoutingSelector.isNavigating));\n  }\n\n  /**\n   * Navigation with a new state into history\n   * @param commands: url commands\n   * @param query\n   * @param extras: Represents the extra options used during navigation.\n   */\n  go(commands: UrlCommands, query?: object, extras?: NavigationExtras): void {\n    const path = this.semanticPathService.transform(commands);\n\n    return this.navigate(path, query, extras);\n  }\n\n  /**\n   * Navigation using URL\n   * @param url\n   */\n  goByUrl(url: string) {\n    this.store.dispatch(new fromStore.GoByUrl(url));\n  }\n\n  /**\n   * Navigating back\n   */\n  back(): void {\n    const isLastPageInApp = this.winRef.document.referrer.includes(\n      this.winRef.nativeWindow.location.origin\n    );\n    if (isLastPageInApp) {\n      this.store.dispatch(new fromStore.Back());\n      return;\n    }\n    this.go(['/']);\n    return;\n  }\n\n  /**\n   * Navigating forward\n   */\n  forward(): void {\n    this.store.dispatch(new fromStore.Forward());\n  }\n\n  /**\n   * Navigation with a new state into history\n   * @param path\n   * @param query\n   * @param extras: Represents the extra options used during navigation.\n   */\n  protected navigate(\n    path: any[],\n    query?: object,\n    extras?: NavigationExtras\n  ): void {\n    this.store.dispatch(\n      new fromStore.Go({\n        path,\n        query,\n        extras,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpRequest, HttpHandler, HttpEvent } from '@angular/common/http';\n\nimport { Observable } from 'rxjs';\nimport { tap, filter, take, switchMap } from 'rxjs/operators';\n\nimport { AuthService } from '../../facade/auth.service';\nimport { UserToken } from '../../models/token-types.model';\nimport { RoutingService } from '../../../routing/facade/routing.service';\n\n@Injectable()\nexport class UserErrorHandlingService {\n  constructor(\n    protected authService: AuthService,\n    protected routingService: RoutingService\n  ) {}\n\n  public handleExpiredUserToken(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<UserToken>> {\n    return this.handleExpiredToken().pipe(\n      switchMap((token: UserToken) => {\n        return next.handle(this.createNewRequestWithNewToken(request, token));\n      })\n    );\n  }\n\n  public handleExpiredRefreshToken(): void {\n    // Logout user\n    this.authService.logout();\n  }\n\n  protected handleExpiredToken(): Observable<UserToken> {\n    let oldToken: UserToken;\n    return this.authService.getUserToken().pipe(\n      tap((token: UserToken) => {\n        if (token.access_token && token.refresh_token && !oldToken) {\n          this.authService.refreshUserToken(token);\n        } else if (!token.access_token && !token.refresh_token) {\n          this.routingService.go({ cxRoute: 'login' });\n        }\n        oldToken = oldToken || token;\n      }),\n      filter(\n        (token: UserToken) => oldToken.access_token !== token.access_token\n      ),\n      take(1)\n    );\n  }\n\n  protected createNewRequestWithNewToken(\n    request: HttpRequest<any>,\n    token: UserToken\n  ): HttpRequest<any> {\n    request = request.clone({\n      setHeaders: {\n        Authorization: `${token.token_type} ${token.access_token}`,\n      },\n    });\n    return request;\n  }\n}\n","import { HttpHeaders, HttpRequest } from '@angular/common/http';\n\nexport const USE_CLIENT_TOKEN = 'cx-use-client-token';\n\nexport class InterceptorUtil {\n  static createHeader<T>(\n    headerName: string,\n    interceptorParam: T,\n    headers?: HttpHeaders\n  ): HttpHeaders {\n    if (headers) {\n      return headers.append(headerName, JSON.stringify(interceptorParam));\n    }\n    headers = new HttpHeaders().set(\n      headerName,\n      JSON.stringify(interceptorParam)\n    );\n    return headers;\n  }\n\n  static removeHeader(\n    headerName: string,\n    request: HttpRequest<any>\n  ): HttpRequest<any> {\n    const updatedHeaders = request.headers.delete(headerName);\n    return request.clone({ headers: updatedHeaders });\n  }\n\n  static getInterceptorParam<T>(headerName: string, headers: HttpHeaders): T {\n    const rawValue = headers.get(headerName);\n    if (rawValue) {\n      return JSON.parse(rawValue);\n    }\n    return undefined;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  HttpInterceptor,\n  HttpHandler,\n  HttpEvent,\n  HttpErrorResponse,\n} from '@angular/common/http';\nimport { HttpRequest } from '@angular/common/http';\n\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\n\nimport { AuthService } from '../facade/auth.service';\nimport { ClientErrorHandlingService } from '../services/client-error/client-error-handling.service';\nimport { UserErrorHandlingService } from '../services/user-error/user-error-handling.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../occ/utils/interceptor-util';\n\nconst OAUTH_ENDPOINT = '/authorizationserver/oauth/token';\n\n@Injectable()\nexport class AuthErrorInterceptor implements HttpInterceptor {\n  constructor(\n    private userErrorHandlingService: UserErrorHandlingService,\n    private clientErrorHandlingService: ClientErrorHandlingService,\n    private authService: AuthService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    const isClientTokenRequest = this.isClientTokenRequest(request);\n    if (isClientTokenRequest) {\n      request = InterceptorUtil.removeHeader(USE_CLIENT_TOKEN, request);\n    }\n\n    return next.handle(request).pipe(\n      catchError((errResponse: any) => {\n        if (errResponse instanceof HttpErrorResponse) {\n          switch (errResponse.status) {\n            case 401: // Unauthorized\n              if (isClientTokenRequest) {\n                if (this.isExpiredToken(errResponse)) {\n                  return this.clientErrorHandlingService.handleExpiredClientToken(\n                    request,\n                    next\n                  );\n                }\n                // user token request\n              } else {\n                if (this.isExpiredToken(errResponse)) {\n                  return this.userErrorHandlingService.handleExpiredUserToken(\n                    request,\n                    next\n                  );\n                } else if (\n                  // Refresh expired token\n                  // Check that the OAUTH endpoint was called and the error is for refresh token is expired\n                  errResponse.url.includes(OAUTH_ENDPOINT) &&\n                  errResponse.error.error === 'invalid_token'\n                ) {\n                  this.userErrorHandlingService.handleExpiredRefreshToken();\n                  return of();\n                }\n              }\n              break;\n            case 400: // Bad Request\n              if (\n                errResponse.url.includes(OAUTH_ENDPOINT) &&\n                errResponse.error.error === 'invalid_grant'\n              ) {\n                if (request.body.get('grant_type') === 'refresh_token') {\n                  // refresh token fail, force user logout\n                  this.authService.logout();\n                }\n              }\n              break;\n          }\n        }\n        return throwError(errResponse);\n      })\n    );\n  }\n\n  private isClientTokenRequest(request: HttpRequest<any>): boolean {\n    const isRequestMapping = InterceptorUtil.getInterceptorParam(\n      USE_CLIENT_TOKEN,\n      request.headers\n    );\n    return Boolean(isRequestMapping);\n  }\n\n  private isExpiredToken(resp: HttpErrorResponse): boolean {\n    if (\n      resp.error &&\n      resp.error.errors &&\n      resp.error.errors instanceof Array &&\n      resp.error.errors[0]\n    ) {\n      return resp.error.errors[0].type === 'InvalidTokenError';\n    }\n    return false;\n  }\n}\n","import { Currency, Language, BaseSite } from '../../model/misc.model';\nexport const SITE_CONTEXT_FEATURE = 'siteContext';\n\nexport interface StateWithSiteContext {\n  [SITE_CONTEXT_FEATURE]: SiteContextState;\n}\n\nexport interface SiteContextState {\n  languages: LanguagesState;\n  currencies: CurrenciesState;\n  baseSite: BaseSiteState;\n}\n\nexport interface CurrencyEntities {\n  [isocode: string]: Currency;\n}\n\nexport interface CurrenciesState {\n  entities: CurrencyEntities;\n  activeCurrency: string;\n}\nexport interface LanguagesEntities {\n  [isocode: string]: Language;\n}\n\nexport interface LanguagesState {\n  entities: LanguagesEntities;\n  activeLanguage: string;\n}\n\nexport interface BaseSiteState {\n  activeSite: string;\n  details: BaseSite;\n}\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  SiteContextState,\n  SITE_CONTEXT_FEATURE,\n  StateWithSiteContext,\n} from '../state';\n\nexport const getSiteContextState: MemoizedSelector<\n  StateWithSiteContext,\n  SiteContextState\n> = createFeatureSelector<SiteContextState>(SITE_CONTEXT_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { BaseSite } from '../../../model/misc.model';\nimport { SiteContextState, StateWithSiteContext } from '../state';\nimport { getSiteContextState } from './site-context.selector';\n\nexport const getActiveBaseSite: MemoizedSelector<\n  StateWithSiteContext,\n  string\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) =>\n    state && state.baseSite && state.baseSite.activeSite\n);\n\nexport const getBaseSiteData: MemoizedSelector<\n  StateWithSiteContext,\n  BaseSite\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) => state && state.baseSite && state.baseSite.details\n);\n","import { Action } from '@ngrx/store';\nimport { BaseSite } from '../../../model/misc.model';\n\nexport const LOAD_BASE_SITE = '[Site-context] Load BaseSite';\nexport const LOAD_BASE_SITE_FAIL = '[Site-context] Load BaseSite Fail';\nexport const LOAD_BASE_SITE_SUCCESS = '[Site-context] Load BaseSite Success';\nexport const SET_ACTIVE_BASE_SITE = '[Site-context] Set Active BaseSite';\nexport const BASE_SITE_CHANGE = '[Site-context] BaseSite Change';\n\nexport class LoadBaseSite implements Action {\n  readonly type = LOAD_BASE_SITE;\n}\n\nexport class LoadBaseSiteFail implements Action {\n  readonly type = LOAD_BASE_SITE_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadBaseSiteSuccess implements Action {\n  readonly type = LOAD_BASE_SITE_SUCCESS;\n  constructor(public payload: BaseSite) {}\n}\n\nexport class SetActiveBaseSite implements Action {\n  readonly type = SET_ACTIVE_BASE_SITE;\n  constructor(public payload: string) {}\n}\n\nexport class BaseSiteChange implements Action {\n  readonly type = BASE_SITE_CHANGE;\n}\n\n// action types\nexport type BaseSiteAction =\n  | LoadBaseSite\n  | LoadBaseSiteFail\n  | LoadBaseSiteSuccess\n  | SetActiveBaseSite\n  | BaseSiteChange;\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { SiteContext } from './site-context.interface';\nimport { select, Store } from '@ngrx/store';\nimport { filter, map, take, tap } from 'rxjs/operators';\nimport {\n  getActiveBaseSite,\n  getBaseSiteData,\n} from '../store/selectors/base-site.selectors';\nimport { StateWithSiteContext } from '../store/state';\nimport {\n  SetActiveBaseSite,\n  LoadBaseSite,\n} from '../store/actions/base-site.action';\nimport { BaseSite } from '../../model/misc.model';\n\n@Injectable()\nexport class BaseSiteService implements SiteContext<string> {\n  constructor(protected store: Store<StateWithSiteContext>) {}\n\n  /**\n   * Represents the current baseSite uid.\n   */\n  getActive(): Observable<string> {\n    return this.store.pipe(\n      select(getActiveBaseSite),\n      filter(Boolean)\n    );\n  }\n\n  /**\n   * We currently don't support switching baseSite at run time\n   */\n  getAll(): Observable<string[]> {\n    return this.getActive().pipe(map(baseSite => [baseSite]));\n  }\n\n  setActive(baseSite: string) {\n    return this.store\n      .pipe(\n        select(getActiveBaseSite),\n        take(1)\n      )\n      .subscribe(activeBaseSite => {\n        if (baseSite && activeBaseSite !== baseSite) {\n          this.store.dispatch(new SetActiveBaseSite(baseSite));\n        }\n      });\n  }\n\n  /**\n   * Initializes the active baseSite.\n   */\n  initialize(defaultBaseSite: string) {\n    this.setActive(defaultBaseSite);\n  }\n\n  /**\n   * Get the base site details data\n   */\n  getBaseSiteData(): Observable<BaseSite> {\n    return this.store.pipe(\n      select(getBaseSiteData),\n      tap(baseSite => {\n        if (Object.keys(baseSite).length === 0) {\n          this.store.dispatch(new LoadBaseSite());\n        }\n      })\n    );\n  }\n}\n","export class DynamicTemplate {\n  static resolve(templateString: string, templateVariables: Object) {\n    const keys = Object.keys(templateVariables);\n    // Can't use Object.values as the compilation settings are to es2015 not es2017\n    const values = keys.map(key => templateVariables[key]);\n\n    const templateFunction = new Function(\n      ...keys,\n      `return \\`${templateString}\\`;`\n    );\n    return templateFunction(...values);\n  }\n}\n","import { ContextParameter, SiteContextConfig } from './site-context-config';\n\n/**\n * Helper function for safely getting context parameter config\n *\n * @param config\n * @param parameter\n */\nexport function getContextParameter(\n  config: SiteContextConfig,\n  parameter: string\n): ContextParameter {\n  return (\n    (config.context &&\n      config.context.parameters &&\n      config.context.parameters[parameter]) ||\n    {}\n  );\n}\n\n/**\n * Helper function for calculating default value for context parameter from config\n *\n * @param config\n * @param parameter\n */\nexport function getContextParameterDefault(\n  config: SiteContextConfig,\n  parameter: string\n): string {\n  const param = getContextParameter(config, parameter);\n  if (param.default !== undefined) {\n    return param.default;\n  }\n  return param.values && param.values.length ? param.values[0] : undefined;\n}\n","import * as fromLanguages from '../actions/languages.action';\nimport { LanguagesState } from '../state';\nimport { Language } from '../../../model/misc.model';\n\nexport const initialState: LanguagesState = {\n  entities: null,\n  activeLanguage: null,\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromLanguages.LanguagesAction\n): LanguagesState {\n  switch (action.type) {\n    case fromLanguages.LOAD_LANGUAGES_SUCCESS: {\n      const languages: Language[] = action.payload;\n      const entities = languages.reduce(\n        (langEntities: { [isocode: string]: Language }, language: Language) => {\n          return {\n            ...langEntities,\n            [language.isocode]: language,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case fromLanguages.SET_ACTIVE_LANGUAGE: {\n      const isocode = action.payload;\n\n      return {\n        ...state,\n        activeLanguage: isocode,\n      };\n    }\n  }\n  return state;\n}\n","import { Action } from '@ngrx/store';\nimport { Currency } from '../../../model/misc.model';\n\nexport const LOAD_CURRENCIES = '[Site-context] Load Currencies';\nexport const LOAD_CURRENCIES_FAIL = '[Site-context] Load Currencies Fail';\nexport const LOAD_CURRENCIES_SUCCESS = '[Site-context] Load Currencies Success';\nexport const SET_ACTIVE_CURRENCY = '[Site-context] Set Active Currency';\nexport const CURRENCY_CHANGE = '[Site-context] Currency Change';\n\nexport class LoadCurrencies implements Action {\n  readonly type = LOAD_CURRENCIES;\n}\n\nexport class LoadCurrenciesFail implements Action {\n  readonly type = LOAD_CURRENCIES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadCurrenciesSuccess implements Action {\n  readonly type = LOAD_CURRENCIES_SUCCESS;\n  constructor(public payload: Currency[]) {}\n}\n\nexport class SetActiveCurrency implements Action {\n  readonly type = SET_ACTIVE_CURRENCY;\n  constructor(public payload: string) {}\n}\n\nexport class CurrencyChange implements Action {\n  readonly type = CURRENCY_CHANGE;\n}\n\n// action types\nexport type CurrenciesAction =\n  | LoadCurrencies\n  | LoadCurrenciesFail\n  | LoadCurrenciesSuccess\n  | SetActiveCurrency\n  | CurrencyChange;\n","import * as fromCurrencies from '../actions/currencies.action';\nimport { CurrenciesState } from '../state';\nimport { Currency } from '../../../model/misc.model';\n\nexport const initialState: CurrenciesState = {\n  entities: null,\n  activeCurrency: null,\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromCurrencies.CurrenciesAction\n): CurrenciesState {\n  switch (action.type) {\n    case fromCurrencies.LOAD_CURRENCIES_SUCCESS: {\n      const currencies: Currency[] = action.payload;\n      const entities = currencies.reduce(\n        (currEntities: { [isocode: string]: Currency }, currency: Currency) => {\n          return {\n            ...currEntities,\n            [currency.isocode]: currency,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case fromCurrencies.SET_ACTIVE_CURRENCY: {\n      const isocode: string = action.payload;\n\n      return {\n        ...state,\n        activeCurrency: isocode,\n      };\n    }\n  }\n\n  return state;\n}\n","import * as fromBaseSite from '../actions/base-site.action';\nimport { BaseSiteState } from '../state';\n\nexport const initialState: BaseSiteState = {\n  details: {},\n  activeSite: '',\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromBaseSite.BaseSiteAction\n): BaseSiteState {\n  switch (action.type) {\n    case fromBaseSite.LOAD_BASE_SITE_SUCCESS: {\n      return {\n        ...state,\n        details: action.payload,\n      };\n    }\n\n    case fromBaseSite.SET_ACTIVE_BASE_SITE: {\n      return {\n        ...state,\n        activeSite: action.payload,\n      };\n    }\n  }\n\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducerMap } from '@ngrx/store';\n\nimport * as fromLanguages from './languages.reducer';\nimport * as fromCurrencies from './currencies.reducer';\nimport * as fromBaseSite from './base-site.reducer';\nimport { SiteContextState } from '../state';\n\nexport function getReducers(): ActionReducerMap<SiteContextState> {\n  return {\n    languages: fromLanguages.reducer,\n    currencies: fromCurrencies.reducer,\n    baseSite: fromBaseSite.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<SiteContextState>\n> = new InjectionToken<ActionReducerMap<SiteContextState>>(\n  'SiteContextReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { HttpErrorResponse } from '@angular/common/http';\nimport { ErrorModel, HttpErrorModel } from '../model/misc.model';\n\nexport function makeErrorSerializable(\n  error: HttpErrorResponse | ErrorModel | any\n): HttpErrorModel | Error | any {\n  if (error instanceof Error) {\n    return {\n      message: error.message,\n      type: error.name,\n      reason: error.stack,\n    } as ErrorModel;\n  }\n\n  if (error instanceof HttpErrorResponse) {\n    return {\n      message: error.message,\n      error: error.error,\n      status: error.status,\n      statusText: error.statusText,\n      url: error.url,\n    } as HttpErrorModel;\n  }\n\n  return error;\n}\n","import { Observable } from 'rxjs';\nimport { Currency, Language, BaseSite } from '../../model/misc.model';\nimport { Country, CountryType, Region } from '../../model/address.model';\n\nexport abstract class SiteAdapter {\n  /**\n   * Abstract method used to load languages.\n   */\n  abstract loadLanguages(): Observable<Language[]>;\n\n  /**\n   * Abstract method used to load currencies.\n   */\n  abstract loadCurrencies(): Observable<Currency[]>;\n\n  /**\n   * Abstract method used to get countries with optional type.\n   */\n  abstract loadCountries(type?: CountryType): Observable<Country[]>;\n\n  /**\n   * Abstract method used to get regions for a country.\n   */\n  abstract loadRegions(countryIsoCode: string): Observable<Region[]>;\n\n  /**\n   * Abstract method used to get base site data.\n   */\n  abstract loadBaseSite(): Observable<BaseSite>;\n}\n","import { Injectable } from '@angular/core';\nimport { SiteAdapter } from './site.adapter';\nimport { Observable } from 'rxjs';\nimport { Currency, Language, BaseSite } from '../../model/misc.model';\nimport { Country, CountryType, Region } from '../../model/address.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SiteConnector {\n  constructor(protected adapter: SiteAdapter) {}\n\n  getLanguages(): Observable<Language[]> {\n    return this.adapter.loadLanguages();\n  }\n\n  getCurrencies(): Observable<Currency[]> {\n    return this.adapter.loadCurrencies();\n  }\n\n  getCountries(type?: CountryType): Observable<Country[]> {\n    return this.adapter.loadCountries(type);\n  }\n\n  getRegions(countryIsoCode: string): Observable<Region[]> {\n    return this.adapter.loadRegions(countryIsoCode);\n  }\n\n  getBaseSite(): Observable<BaseSite> {\n    return this.adapter.loadBaseSite();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map, tap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { WindowRef } from '../../../window/window-ref';\nimport { SiteConnector } from '../../connectors/site.connector';\nimport * as actions from '../actions/languages.action';\n\n@Injectable()\nexport class LanguagesEffects {\n  @Effect()\n  loadLanguages$: Observable<\n    actions.LoadLanguagesSuccess | actions.LoadLanguagesFail\n  > = this.actions$.pipe(\n    ofType(actions.LOAD_LANGUAGES),\n    exhaustMap(() => {\n      return this.siteConnector.getLanguages().pipe(\n        map(languages => new actions.LoadLanguagesSuccess(languages)),\n        catchError(error =>\n          of(new actions.LoadLanguagesFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  @Effect()\n  activateLanguage$: Observable<actions.LanguageChange> = this.actions$.pipe(\n    ofType(actions.SET_ACTIVE_LANGUAGE),\n    tap((action: actions.SetActiveLanguage) => {\n      if (this.winRef.sessionStorage) {\n        this.winRef.sessionStorage.setItem('language', action.payload);\n      }\n    }),\n    map(() => new actions.LanguageChange())\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector,\n    private winRef: WindowRef\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map, tap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { WindowRef } from '../../../window/window-ref';\nimport { SiteConnector } from '../../connectors/site.connector';\nimport * as actions from '../actions/currencies.action';\n\n@Injectable()\nexport class CurrenciesEffects {\n  @Effect()\n  loadCurrencies$: Observable<\n    actions.LoadCurrenciesSuccess | actions.LoadCurrenciesFail\n  > = this.actions$.pipe(\n    ofType(actions.LOAD_CURRENCIES),\n    exhaustMap(() => {\n      return this.siteConnector.getCurrencies().pipe(\n        map(currencies => new actions.LoadCurrenciesSuccess(currencies)),\n        catchError(error =>\n          of(new actions.LoadCurrenciesFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  @Effect()\n  activateCurrency$: Observable<actions.CurrencyChange> = this.actions$.pipe(\n    ofType(actions.SET_ACTIVE_CURRENCY),\n    tap((action: actions.SetActiveCurrency) => {\n      if (this.winRef.sessionStorage) {\n        this.winRef.sessionStorage.setItem('currency', action.payload);\n      }\n    }),\n    map(() => new actions.CurrencyChange())\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector,\n    private winRef: WindowRef\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { SiteConnector } from '../../connectors/site.connector';\nimport * as actions from '../actions/base-site.action';\n\n@Injectable()\nexport class BaseSiteEffects {\n  @Effect()\n  loadBaseSite$: Observable<\n    actions.LoadBaseSiteSuccess | actions.LoadBaseSiteFail\n  > = this.actions$.pipe(\n    ofType(actions.LOAD_BASE_SITE),\n    exhaustMap(() => {\n      return this.siteConnector.getBaseSite().pipe(\n        map(baseSite => new actions.LoadBaseSiteSuccess(baseSite)),\n        catchError(error =>\n          of(new actions.LoadBaseSiteFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { LanguagesEffects } from './languages.effect';\nimport { CurrenciesEffects } from './currencies.effect';\nimport { BaseSiteEffects } from './base-site.effect';\n\nexport const effects: any[] = [\n  LanguagesEffects,\n  CurrenciesEffects,\n  BaseSiteEffects,\n];\n\nexport * from './languages.effect';\nexport * from './currencies.effect';\nexport * from './base-site.effect';\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Currency } from '../../../model/misc.model';\nimport {\n  CurrenciesState,\n  CurrencyEntities,\n  SiteContextState,\n  StateWithSiteContext,\n} from '../state';\nimport { getSiteContextState } from './site-context.selector';\n\nconst currenciesEntitiesSelector = (state: CurrenciesState) => state.entities;\nconst activeCurrencySelector = (state: CurrenciesState) => state.activeCurrency;\n\nexport const getCurrenciesState: MemoizedSelector<\n  StateWithSiteContext,\n  CurrenciesState\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) => state.currencies\n);\n\nexport const getCurrenciesEntities: MemoizedSelector<\n  StateWithSiteContext,\n  CurrencyEntities\n> = createSelector(\n  getCurrenciesState,\n  currenciesEntitiesSelector\n);\n\nexport const getActiveCurrency: MemoizedSelector<\n  StateWithSiteContext,\n  string\n> = createSelector(\n  getCurrenciesState,\n  activeCurrencySelector\n);\n\nexport const getAllCurrencies: MemoizedSelector<\n  StateWithSiteContext,\n  Currency[]\n> = createSelector(\n  getCurrenciesEntities,\n  entities => {\n    return entities\n      ? Object.keys(entities).map(isocode => entities[isocode])\n      : null;\n  }\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Language } from '../../../model/misc.model';\nimport {\n  LanguagesEntities,\n  LanguagesState,\n  SiteContextState,\n  StateWithSiteContext,\n} from '../state';\nimport { getSiteContextState } from './site-context.selector';\n\nconst activeLanguageSelector = (state: LanguagesState) => state.activeLanguage;\nconst languagesEntitiesSelector = (state: LanguagesState) => state.entities;\n\nexport const getLanguagesState: MemoizedSelector<\n  StateWithSiteContext,\n  LanguagesState\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) => state.languages\n);\n\nexport const getLanguagesEntities: MemoizedSelector<\n  StateWithSiteContext,\n  LanguagesEntities\n> = createSelector(\n  getLanguagesState,\n  languagesEntitiesSelector\n);\n\nexport const getActiveLanguage: MemoizedSelector<\n  StateWithSiteContext,\n  string\n> = createSelector(\n  getLanguagesState,\n  activeLanguageSelector\n);\n\nexport const getAllLanguages: MemoizedSelector<\n  StateWithSiteContext,\n  Language[]\n> = createSelector(\n  getLanguagesEntities,\n  entities => {\n    return entities\n      ? Object.keys(entities).map(isocode => entities[isocode])\n      : null;\n  }\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, take, tap } from 'rxjs/operators';\nimport { Language } from '../../model/misc.model';\nimport { WindowRef } from '../../window/window-ref';\nimport * as fromStore from '../store/index';\nimport { SiteContextSelectors } from '../store/selectors/index';\nimport { SiteContext } from './site-context.interface';\n\n/**\n * Facade that provides easy access to language state, actions and selectors.\n */\n@Injectable()\nexport class LanguageService implements SiteContext<Language> {\n  private sessionStorage: Storage;\n\n  constructor(\n    protected store: Store<fromStore.StateWithSiteContext>,\n    winRef: WindowRef\n  ) {\n    this.sessionStorage = winRef.sessionStorage;\n  }\n\n  /**\n   * Represents all the languages supported by the current store.\n   */\n  getAll(): Observable<Language[]> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getAllLanguages),\n      tap(languages => {\n        if (!languages) {\n          this.store.dispatch(new fromStore.LoadLanguages());\n        }\n      }),\n      filter(languages => Boolean(languages))\n    );\n  }\n\n  /**\n   * Represents the isocode of the active language.\n   */\n  getActive(): Observable<string> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getActiveLanguage),\n      filter(active => Boolean(active))\n    );\n  }\n\n  /**\n   * Sets the active language.\n   */\n  setActive(isocode: string) {\n    return this.store\n      .pipe(\n        select(SiteContextSelectors.getActiveLanguage),\n        take(1)\n      )\n      .subscribe(activeLanguage => {\n        if (activeLanguage !== isocode) {\n          this.store.dispatch(new fromStore.SetActiveLanguage(isocode));\n        }\n      });\n  }\n\n  /**\n   * Initials the active language. The active language is either given\n   * by the last visit (stored in session storage) or by the\n   * default session language of the store.\n   */\n  initialize(defaultLanguage: string) {\n    if (this.sessionStorage && !!this.sessionStorage.getItem('language')) {\n      this.setActive(this.sessionStorage.getItem('language'));\n    } else {\n      this.setActive(defaultLanguage);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, take, tap } from 'rxjs/operators';\nimport { Currency } from '../../model/misc.model';\nimport { WindowRef } from '../../window/window-ref';\nimport * as fromStore from '../store/index';\nimport { SiteContextSelectors } from '../store/selectors/index';\nimport { SiteContext } from './site-context.interface';\n\n/**\n * Facade that provides easy access to curreny state, actions and selectors.\n */\n@Injectable()\nexport class CurrencyService implements SiteContext<Currency> {\n  private sessionStorage: Storage;\n\n  constructor(\n    protected store: Store<fromStore.StateWithSiteContext>,\n    winRef: WindowRef\n  ) {\n    this.sessionStorage = winRef.sessionStorage;\n  }\n\n  /**\n   * Represents all the currencies supported by the current store.\n   */\n  getAll(): Observable<Currency[]> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getAllCurrencies),\n      tap(currencies => {\n        if (!currencies) {\n          this.store.dispatch(new fromStore.LoadCurrencies());\n        }\n      }),\n      filter(currenies => Boolean(currenies))\n    );\n  }\n\n  /**\n   * Represents the isocode of the active currency.\n   */\n  getActive(): Observable<string> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getActiveCurrency),\n      filter(active => Boolean(active))\n    );\n  }\n\n  /**\n   * Sets the active language.\n   */\n  setActive(isocode: string) {\n    return this.store\n      .pipe(\n        select(SiteContextSelectors.getActiveCurrency),\n        take(1)\n      )\n      .subscribe(activeCurrency => {\n        if (activeCurrency !== isocode) {\n          this.store.dispatch(new fromStore.SetActiveCurrency(isocode));\n        }\n      });\n  }\n\n  /**\n   * Initials the active currency. The active currency is either given\n   * by the last visit (stored in session storage) or by the\n   * default session currency of the store.\n   */\n  initialize(defaultCurrency: string) {\n    if (this.sessionStorage && !!this.sessionStorage.getItem('currency')) {\n      this.setActive(this.sessionStorage.getItem('currency'));\n    } else {\n      this.setActive(defaultCurrency);\n    }\n  }\n}\n","import { Provider, Type } from '@angular/core';\nimport { LanguageService } from '../facade/language.service';\nimport { CurrencyService } from '../facade/currency.service';\nimport { SiteContext } from '../facade/site-context.interface';\nimport { BaseSiteService } from '../facade/base-site.service';\n\nexport abstract class ContextServiceMap {\n  [context: string]: Type<SiteContext<any>>;\n}\n\nexport const LANGUAGE_CONTEXT_ID = 'language';\nexport const CURRENCY_CONTEXT_ID = 'currency';\nexport const BASE_SITE_CONTEXT_ID = 'baseSite';\n\nexport function serviceMapFactory() {\n  return {\n    [LANGUAGE_CONTEXT_ID]: LanguageService,\n    [CURRENCY_CONTEXT_ID]: CurrencyService,\n    [BASE_SITE_CONTEXT_ID]: BaseSiteService,\n  };\n}\n\nexport const contextServiceMapProvider: Provider = {\n  provide: ContextServiceMap,\n  useFactory: serviceMapFactory,\n};\n","import { Injectable, Optional } from '@angular/core';\nimport { BaseSiteService } from '../../site-context/facade/base-site.service';\nimport { OccConfig } from '../config/occ-config';\nimport { DynamicTemplate } from '../../config/utils/dynamic-template';\nimport { HttpParams } from '@angular/common/http';\nimport { getContextParameterDefault } from '../../site-context/config/context-config-utils';\nimport { BASE_SITE_CONTEXT_ID } from '../../site-context/providers/context-service-map';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccEndpointsService {\n  private activeBaseSite: string;\n\n  constructor(\n    private config: OccConfig,\n    @Optional() private baseSiteService: BaseSiteService\n  ) {\n    this.activeBaseSite =\n      getContextParameterDefault(this.config, BASE_SITE_CONTEXT_ID) || '';\n\n    if (this.baseSiteService) {\n      this.baseSiteService\n        .getActive()\n        .subscribe(value => (this.activeBaseSite = value));\n    }\n  }\n\n  getBaseEndpoint(): string {\n    if (!this.config || !this.config.backend || !this.config.backend.occ) {\n      return '';\n    }\n\n    return (\n      (this.config.backend.occ.baseUrl || '') +\n      this.config.backend.occ.prefix +\n      this.activeBaseSite\n    );\n  }\n\n  getEndpoint(endpoint: string): string {\n    if (!endpoint.startsWith('/')) {\n      endpoint = '/' + endpoint;\n    }\n    return this.getBaseEndpoint() + endpoint;\n  }\n\n  getUrl(endpoint: string, urlParams?: object, queryParams?: object): string {\n    if (\n      this.config.backend &&\n      this.config.backend.occ &&\n      this.config.backend.occ.endpoints[endpoint]\n    ) {\n      endpoint = this.config.backend.occ.endpoints[endpoint];\n    }\n\n    if (urlParams) {\n      endpoint = DynamicTemplate.resolve(endpoint, urlParams);\n    }\n\n    if (queryParams) {\n      let httpParamsOptions;\n\n      if (endpoint.includes('?')) {\n        let queryParamsFromEndpoint;\n        [endpoint, queryParamsFromEndpoint] = endpoint.split('?');\n\n        httpParamsOptions = { fromString: queryParamsFromEndpoint };\n      }\n\n      let httpParams = new HttpParams(httpParamsOptions);\n      Object.keys(queryParams).forEach(key => {\n        const value = queryParams[key];\n        if (value !== undefined) {\n          if (value === null) {\n            httpParams = httpParams.delete(key);\n          } else {\n            httpParams = httpParams.set(key, value);\n          }\n        }\n      });\n\n      const params = httpParams.toString();\n      if (params.length) {\n        endpoint += '?' + params;\n      }\n    }\n\n    return this.getEndpoint(endpoint);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  HttpInterceptor,\n  HttpRequest,\n  HttpHandler,\n  HttpEvent,\n} from '@angular/common/http';\n\nimport { Observable, of } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\n\nimport { AuthService } from '../facade/auth.service';\nimport {\n  USE_CLIENT_TOKEN,\n  InterceptorUtil,\n} from '../../occ/utils/interceptor-util';\nimport { ClientToken } from '../models/token-types.model';\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\n\n@Injectable()\nexport class ClientTokenInterceptor implements HttpInterceptor {\n  constructor(\n    private authService: AuthService,\n    private occEndpoints: OccEndpointsService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return this.getClientToken(request).pipe(\n      take(1),\n      switchMap((token: ClientToken) => {\n        if (\n          token &&\n          request.url.includes(this.occEndpoints.getBaseEndpoint())\n        ) {\n          request = request.clone({\n            setHeaders: {\n              Authorization: `${token.token_type} ${token.access_token}`,\n            },\n          });\n        }\n        return next.handle(request);\n      })\n    );\n  }\n\n  private getClientToken(request: HttpRequest<any>): Observable<ClientToken> {\n    if (\n      InterceptorUtil.getInterceptorParam(USE_CLIENT_TOKEN, request.headers)\n    ) {\n      return this.authService.getClientToken();\n    }\n    return of(null);\n  }\n}\n","import {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\nimport { AuthService } from '../facade/auth.service';\n\n@Injectable()\nexport class UserTokenInterceptor implements HttpInterceptor {\n  constructor(\n    private authService: AuthService,\n    private occEndpoints: OccEndpointsService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return this.authService.getUserToken().pipe(\n      take(1),\n      switchMap(token => {\n        if (\n          token &&\n          this.isOccUrl(request.url) &&\n          !request.headers.get('Authorization')\n        ) {\n          request = request.clone({\n            setHeaders: {\n              Authorization: `${token.token_type} ${token.access_token}`,\n            },\n          });\n        }\n\n        return next.handle(request);\n      })\n    );\n  }\n\n  private isOccUrl(url: string): boolean {\n    return url.includes(this.occEndpoints.getBaseEndpoint());\n  }\n}\n","import { Provider } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\n\nimport { AuthErrorInterceptor } from './auth-error.interceptor';\nimport { ClientTokenInterceptor } from './client-token.interceptor';\nimport { UserTokenInterceptor } from './user-token.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useClass: ClientTokenInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useClass: UserTokenInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useClass: AuthErrorInterceptor,\n    multi: true,\n  },\n];\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { AuthConfig } from '../../config/auth-config';\nimport { ClientToken } from '../../models/token-types.model';\n\nconst OAUTH_ENDPOINT = '/authorizationserver/oauth/token';\n\n@Injectable()\nexport class ClientAuthenticationTokenService {\n  constructor(protected config: AuthConfig, protected http: HttpClient) {}\n\n  loadClientAuthenticationToken(): Observable<ClientToken> {\n    const url: string = this.getOAuthEndpoint();\n    const params = new HttpParams()\n      .set(\n        'client_id',\n        encodeURIComponent(this.config.authentication.client_id)\n      )\n      .set(\n        'client_secret',\n        encodeURIComponent(this.config.authentication.client_secret)\n      )\n      .set('grant_type', 'client_credentials');\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http.post<ClientToken>(url, params, { headers });\n  }\n\n  protected getOAuthEndpoint(): string {\n    return (this.config.backend.occ.baseUrl || '') + OAUTH_ENDPOINT;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { throwError, Observable } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { AuthConfig } from '../../config/auth-config';\n\nimport { UserToken } from '../../models/token-types.model';\n\nconst OAUTH_ENDPOINT = '/authorizationserver/oauth/token';\n\n@Injectable()\nexport class UserAuthenticationTokenService {\n  constructor(protected http: HttpClient, protected config: AuthConfig) {}\n\n  loadToken(userId: string, password: string): Observable<UserToken> {\n    const url = this.getOAuthEndpoint();\n    const params = new HttpParams()\n      .set('client_id', this.config.authentication.client_id)\n      .set('client_secret', this.config.authentication.client_secret)\n      .set('grant_type', 'password') // authorization_code, client_credentials, password\n      .set('username', userId)\n      .set('password', password);\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .post<UserToken>(url, params, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  refreshToken(refreshToken: string): Observable<UserToken> {\n    const url = this.getOAuthEndpoint();\n    const params = new HttpParams()\n      .set(\n        'client_id',\n        encodeURIComponent(this.config.authentication.client_id)\n      )\n      .set(\n        'client_secret',\n        encodeURIComponent(this.config.authentication.client_secret)\n      )\n      .set('refresh_token', encodeURI(refreshToken))\n      .set('grant_type', 'refresh_token');\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .post<UserToken>(url, params, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  protected getOAuthEndpoint() {\n    return (this.config.backend.occ.baseUrl || '') + OAUTH_ENDPOINT;\n  }\n}\n","import { ClientAuthenticationTokenService } from './client-authentication/client-authentication-token.service';\nimport { ClientErrorHandlingService } from './client-error/client-error-handling.service';\nimport { UserAuthenticationTokenService } from './user-authentication/user-authentication-token.service';\nimport { UserErrorHandlingService } from './user-error/user-error-handling.service';\n\nexport const AuthServices: any[] = [\n  ClientAuthenticationTokenService,\n  ClientErrorHandlingService,\n  UserAuthenticationTokenService,\n  UserErrorHandlingService,\n];\n","export enum StorageSyncType {\n  NO_STORAGE = 'NO_STORAGE',\n  LOCAL_STORAGE = 'LOCAL_STORAGE',\n  SESSION_STORAGE = 'SESSION_STORAGE',\n}\n\nexport enum StateTransferType {\n  TRANSFER_STATE = 'SSR',\n}\n\nexport abstract class StateConfig {\n  state?: {\n    storageSync?: {\n      /**\n       * A key name for the data stored in `localStorage`.\n       * Default is `DEFAULT_LOCAL_STORAGE_KEY`.\n       */\n      localStorageKeyName?: string;\n      /**\n       * A key name for the data stored in `sessionStorage`.\n       * Default is `DEFAULT_SESSION_STORAGE_KEY`.\n       */\n      sessionStorageKeyName?: string;\n      /**\n       * A set of state keys that should be synced with the specified browser's storage.\n       */\n      keys?: {\n        [key: string]: StorageSyncType;\n      };\n    };\n    ssrTransfer?: {\n      keys?: {\n        /**\n         * A set of state keys that should be transferred from server.\n         */\n        [key: string]: StateTransferType;\n      };\n    };\n  };\n}\n","import { StateConfig } from './state-config';\n\nexport const DEFAULT_LOCAL_STORAGE_KEY = 'spartacus-local-data';\nexport const DEFAULT_SESSION_STORAGE_KEY = 'spartacus-session-data';\n\nexport const defaultStateConfig: StateConfig = {\n  state: {\n    storageSync: {\n      localStorageKeyName: DEFAULT_LOCAL_STORAGE_KEY,\n      sessionStorageKeyName: DEFAULT_SESSION_STORAGE_KEY,\n      keys: {},\n    },\n  },\n};\n","import { deepMerge } from '../../config/utils/deep-merge';\n\nexport function getStateSliceValue<T, E>(keys: string, state: T): E {\n  return keys\n    .split('.')\n    .reduce(\n      (previous, current) => (previous ? previous[current] : undefined),\n      state\n    );\n}\n\nexport function createShellObject<T, E>(key: string, value: T): E {\n  if (!key || !value || Object.keys(value).length === 0) {\n    return {} as E;\n  }\n\n  const keySplit = key.split('.');\n  const newObject = {};\n  let tempNewObject = newObject;\n\n  for (let i = 0; i < keySplit.length; i++) {\n    const currentKey = keySplit[i];\n    // last iteration\n    if (i === keySplit.length - 1) {\n      tempNewObject = tempNewObject[currentKey] = value;\n    } else {\n      tempNewObject = tempNewObject[currentKey] = {};\n    }\n  }\n\n  return newObject as E;\n}\n\nexport function getStateSlice<T, E>(keys: string[], state: T): E {\n  if (keys && keys.length === 0) {\n    return {} as E;\n  }\n\n  let stateSlices = {};\n  for (const currentKey of keys) {\n    const stateValue = getStateSliceValue(currentKey, state);\n    const shell = createShellObject(currentKey, stateValue);\n    stateSlices = deepMerge(stateSlices, shell);\n  }\n\n  return stateSlices as E;\n}\n","import { Action, ActionReducer, INIT, MetaReducer, UPDATE } from '@ngrx/store';\nimport { deepMerge } from '../../config/utils/deep-merge';\nimport { WindowRef } from '../../window/window-ref';\nimport { StateConfig, StorageSyncType } from '../config/state-config';\nimport { getStateSlice } from '../utils/get-state-slice';\n\nexport function getStorageSyncReducer<T>(\n  winRef: WindowRef,\n  config?: StateConfig\n): MetaReducer<T, Action> {\n  if (\n    !winRef.nativeWindow ||\n    !config ||\n    !config.state ||\n    !config.state.storageSync ||\n    !config.state.storageSync.keys\n  ) {\n    return reducer => reducer;\n  }\n\n  const storageSyncConfig = config.state.storageSync;\n\n  return (reducer: ActionReducer<T, Action>): ActionReducer<T, Action> => {\n    return (state, action): T => {\n      const newState = reducer(state, action);\n\n      if (action.type === INIT || action.type === UPDATE) {\n        const rehydratedState = rehydrate(config, winRef);\n        return deepMerge({}, newState, rehydratedState);\n      }\n\n      if (action.type !== INIT) {\n        // handle local storage\n        const localStorageKeys = getKeysForStorage(\n          storageSyncConfig.keys,\n          StorageSyncType.LOCAL_STORAGE\n        );\n        const localStorageStateSlices = getStateSlice(localStorageKeys, state);\n        persistToStorage(\n          config.state.storageSync.localStorageKeyName,\n          localStorageStateSlices,\n          winRef.localStorage\n        );\n\n        // handle session storage\n        const sessionStorageKeys = getKeysForStorage(\n          storageSyncConfig.keys,\n          StorageSyncType.SESSION_STORAGE\n        );\n        const sessionStorageStateSlices = getStateSlice(\n          sessionStorageKeys,\n          state\n        );\n        persistToStorage(\n          config.state.storageSync.sessionStorageKeyName,\n          sessionStorageStateSlices,\n          winRef.sessionStorage\n        );\n      }\n\n      return newState;\n    };\n  };\n}\n\nexport function getKeysForStorage(\n  keys: { [key: string]: StorageSyncType },\n  storageType: StorageSyncType\n): string[] {\n  return Object.keys(keys).filter(key => keys[key] === storageType);\n}\n\nexport function rehydrate<T>(config: StateConfig, winRef: WindowRef): T {\n  const localStorageValue = readFromStorage(\n    winRef.localStorage,\n    config.state.storageSync.localStorageKeyName\n  );\n  const sessionStorageValue = readFromStorage(\n    winRef.sessionStorage,\n    config.state.storageSync.sessionStorageKeyName\n  );\n\n  return deepMerge(localStorageValue, sessionStorageValue);\n}\n\nexport function exists(value: Object): boolean {\n  if (value != null) {\n    if (typeof value === 'object') {\n      return Object.keys(value).length !== 0;\n    } else if (value === '') {\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function getStorage(\n  storageType: StorageSyncType,\n  winRef: WindowRef\n): Storage {\n  let storage: Storage;\n\n  switch (storageType) {\n    case StorageSyncType.LOCAL_STORAGE: {\n      storage = winRef.localStorage;\n      break;\n    }\n    case StorageSyncType.SESSION_STORAGE: {\n      storage = winRef.sessionStorage;\n      break;\n    }\n    case StorageSyncType.NO_STORAGE: {\n      storage = undefined;\n      break;\n    }\n\n    default: {\n      storage = winRef.sessionStorage;\n    }\n  }\n\n  return storage;\n}\n\nexport function persistToStorage(\n  configKey: string,\n  value: Object,\n  storage: Storage\n): void {\n  if (!isSsr(storage) && value) {\n    storage.setItem(configKey, JSON.stringify(value));\n  }\n}\n\nexport function readFromStorage(storage: Storage, key: string): Object {\n  if (isSsr(storage)) {\n    return;\n  }\n\n  const storageValue = storage.getItem(key);\n  if (!storageValue) {\n    return;\n  }\n\n  return JSON.parse(storageValue);\n}\n\nexport function isSsr(storage: Storage): boolean {\n  return !Boolean(storage);\n}\n","import { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport {\n  makeStateKey,\n  StateKey,\n  TransferState,\n} from '@angular/platform-browser';\nimport { INIT } from '@ngrx/store';\nimport { AUTH_FEATURE, StateWithAuth } from '../../auth/store/auth-state';\nimport { deepMerge } from '../../config/utils/deep-merge';\nimport { StateConfig, StateTransferType } from '../config/state-config';\nimport { getStateSlice } from '../utils/get-state-slice';\n\nexport const CX_KEY: StateKey<string> = makeStateKey<string>('cx-state');\n\nexport function getTransferStateReducer(\n  platformId,\n  transferState?: TransferState,\n  config?: StateConfig\n) {\n  if (\n    transferState &&\n    config &&\n    config.state &&\n    config.state.ssrTransfer &&\n    config.state.ssrTransfer.keys\n  ) {\n    if (isPlatformBrowser(platformId)) {\n      return getBrowserTransferStateReducer(\n        transferState,\n        config.state.ssrTransfer.keys\n      );\n    } else if (isPlatformServer(platformId)) {\n      return getServerTransferStateReducer(\n        transferState,\n        config.state.ssrTransfer.keys\n      );\n    }\n  }\n\n  return reducer => reducer;\n}\n\nexport function getServerTransferStateReducer(\n  transferState: TransferState,\n  keys: { [key: string]: StateTransferType }\n) {\n  return function(reducer) {\n    return function(state, action: any) {\n      const newState = reducer(state, action);\n      if (newState) {\n        const stateSlice = getStateSlice(Object.keys(keys), newState);\n        transferState.set(CX_KEY, stateSlice);\n      }\n\n      return newState;\n    };\n  };\n}\n\nexport function getBrowserTransferStateReducer(\n  transferState: TransferState,\n  keys: { [key: string]: StateTransferType }\n) {\n  return function(reducer) {\n    return function(state, action: any) {\n      if (action.type === INIT) {\n        if (!state) {\n          state = reducer(state, action);\n        }\n\n        // we should not utilize transfer state if user is logged in\n        const authState = (state as StateWithAuth)[AUTH_FEATURE];\n        const isLoggedIn =\n          authState && authState.userToken && authState.userToken.token;\n\n        if (!isLoggedIn && transferState.hasKey(CX_KEY)) {\n          const cxKey = transferState.get(CX_KEY, {});\n          const transferredStateSlice = getStateSlice(Object.keys(keys), cxKey);\n\n          state = deepMerge({}, state, transferredStateSlice);\n        }\n        return state;\n      }\n      return reducer(state, action);\n    };\n  };\n}\n","import { Optional, PLATFORM_ID, Provider } from '@angular/core';\nimport { TransferState } from '@angular/platform-browser';\nimport { META_REDUCERS } from '@ngrx/store';\nimport { Config } from '../../config/config.module';\nimport { WindowRef } from '../../window/window-ref';\nimport { getStorageSyncReducer } from './storage-sync.reducer';\nimport { getTransferStateReducer } from './transfer-state.reducer';\n\nexport { getStateSlice } from '../utils/get-state-slice';\nexport { getStorageSyncReducer } from './storage-sync.reducer';\nexport * from './transfer-state.reducer';\n\nexport const stateMetaReducers: Provider[] = [\n  {\n    provide: META_REDUCERS,\n    useFactory: getTransferStateReducer,\n    deps: [\n      PLATFORM_ID,\n      [new Optional(), TransferState],\n      [new Optional(), Config],\n    ],\n    multi: true,\n  },\n  {\n    provide: META_REDUCERS,\n    useFactory: getStorageSyncReducer,\n    deps: [WindowRef, [new Optional(), Config]],\n    multi: true,\n  },\n];\n","import { NgModule } from '@angular/core';\nimport { ConfigModule } from '../config/config.module';\nimport { defaultStateConfig } from './config/default-state-config';\nimport { stateMetaReducers } from './reducers/index';\n\n@NgModule({\n  imports: [ConfigModule.withConfig(defaultStateConfig)],\n  providers: [...stateMetaReducers],\n})\nexport class StateModule {}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { ClientToken } from '../../models/token-types.model';\nimport { ClientAuthenticationTokenService } from '../../services/client-authentication/client-authentication-token.service';\nimport { AuthActions } from '../actions/index';\n\n@Injectable()\nexport class ClientTokenEffect {\n  @Effect()\n  loadClientToken$: Observable<\n    AuthActions.ClientTokenAction\n  > = this.actions$.pipe(\n    ofType(AuthActions.LOAD_CLIENT_TOKEN),\n    exhaustMap(() => {\n      return this.clientAuthenticationTokenService\n        .loadClientAuthenticationToken()\n        .pipe(\n          map((token: ClientToken) => {\n            return new AuthActions.LoadClientTokenSuccess(token);\n          }),\n          catchError(error =>\n            of(\n              new AuthActions.LoadClientTokenFail(makeErrorSerializable(error))\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private clientAuthenticationTokenService: ClientAuthenticationTokenService\n  ) {}\n}\n","export const USERID_CURRENT = 'current';\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { USERID_CURRENT } from '../../../occ/utils/occ-constants';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserToken } from '../../models/token-types.model';\nimport { UserAuthenticationTokenService } from '../../services/user-authentication/user-authentication-token.service';\nimport { AuthActions } from '../actions/index';\n\n@Injectable()\nexport class UserTokenEffects {\n  @Effect()\n  loadUserToken$: Observable<AuthActions.UserTokenAction> = this.actions$.pipe(\n    ofType(AuthActions.LOAD_USER_TOKEN),\n    map((action: AuthActions.LoadUserToken) => action.payload),\n    mergeMap(({ userId, password }) =>\n      this.userTokenService.loadToken(userId, password).pipe(\n        map((token: UserToken) => {\n          const date = new Date();\n          date.setSeconds(date.getSeconds() + token.expires_in);\n          token.expiration_time = date.toJSON();\n          token.userId = USERID_CURRENT;\n          return new AuthActions.LoadUserTokenSuccess(token);\n        }),\n        catchError(error =>\n          of(new AuthActions.LoadUserTokenFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  @Effect()\n  login$: Observable<AuthActions.Login> = this.actions$.pipe(\n    ofType(AuthActions.LOAD_USER_TOKEN_SUCCESS),\n    map(() => new AuthActions.Login())\n  );\n\n  @Effect()\n  refreshUserToken$: Observable<\n    AuthActions.UserTokenAction\n  > = this.actions$.pipe(\n    ofType(AuthActions.REFRESH_USER_TOKEN),\n    map((action: AuthActions.RefreshUserToken) => action.payload),\n    switchMap(({ refreshToken }) => {\n      return this.userTokenService.refreshToken(refreshToken).pipe(\n        map((token: UserToken) => {\n          const date = new Date();\n          date.setSeconds(date.getSeconds() + token.expires_in);\n          token.expiration_time = date.toJSON();\n          token.userId = USERID_CURRENT;\n          return new AuthActions.RefreshUserTokenSuccess(token);\n        }, catchError(error => of(new AuthActions.RefreshUserTokenFail(makeErrorSerializable(error)))))\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userTokenService: UserAuthenticationTokenService\n  ) {}\n}\n","import { ClientTokenEffect } from './client-token.effect';\nimport { UserTokenEffects } from './user-token.effect';\n\nexport const effects: any[] = [UserTokenEffects, ClientTokenEffect];\n\nexport * from './client-token.effect';\nexport * from './user-token.effect';\n","import { Action } from '@ngrx/store';\n\nimport { LoaderState } from './loader-state';\nimport { LoaderAction } from './loader.action';\n\nexport const initialLoaderState: LoaderState<any> = {\n  loading: false,\n  error: false,\n  success: false,\n  value: undefined,\n};\n\n/**\n * Higher order reducer that adds generic loading flag to chunk of the state\n *\n * Utilizes \"loader\" meta field of actions to set specific flags for specific\n * action (LOAD, SUCCESS, FAIL, RESET)\n */\nexport function loaderReducer<T>(\n  loadActionType: string,\n  reducer?: (state: T, action: Action) => T\n): (state: LoaderState<T>, action: LoaderAction) => LoaderState<T> {\n  return (\n    state: LoaderState<T> = initialLoaderState,\n    action: LoaderAction\n  ): LoaderState<T> => {\n    if (\n      action.meta &&\n      action.meta.loader &&\n      action.meta.entityType === loadActionType\n    ) {\n      const entity = action.meta.loader;\n\n      if (entity.load) {\n        return {\n          ...state,\n          loading: true,\n          value: reducer ? reducer(state.value, action) : state.value,\n        };\n      } else if (entity.error) {\n        return {\n          ...state,\n          loading: false,\n          error: true,\n          success: false,\n          value: reducer ? reducer(state.value, action) : undefined,\n        };\n      } else if (entity.success) {\n        return {\n          ...state,\n          value: reducer ? reducer(state.value, action) : action.payload,\n          loading: false,\n          error: false,\n          success: true,\n        };\n      } else {\n        // reset state action\n        return {\n          ...initialLoaderState,\n          value: reducer\n            ? reducer(initialLoaderState.value, action)\n            : initialLoaderState.value,\n        };\n      }\n    }\n\n    if (reducer) {\n      const newValue = reducer(state.value, action);\n      if (newValue !== state.value) {\n        return { ...state, value: newValue };\n      }\n    }\n    return state;\n  };\n}\n","import * as fromUpdateEmailAction from '../../../user/store/actions/update-email.action';\nimport { UserToken } from '../../models/token-types.model';\nimport { AuthActions } from '../actions/index';\n\nexport const initialState: UserToken = <UserToken>{};\n\nexport function reducer(\n  state = initialState,\n  action:\n    | AuthActions.UserTokenAction\n    | fromUpdateEmailAction.UpdateEmailSuccessAction\n): UserToken {\n  switch (action.type) {\n    case AuthActions.LOAD_USER_TOKEN:\n    case AuthActions.REFRESH_USER_TOKEN: {\n      return {\n        ...state,\n      };\n    }\n\n    case AuthActions.LOAD_USER_TOKEN_SUCCESS:\n    case AuthActions.REFRESH_USER_TOKEN_SUCCESS: {\n      return {\n        ...state,\n        ...action.payload,\n      };\n    }\n\n    case AuthActions.LOAD_USER_TOKEN_FAIL:\n    case AuthActions.REFRESH_USER_TOKEN_FAIL: {\n      return {\n        ...state,\n      };\n    }\n  }\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  Action,\n  ActionReducer,\n  ActionReducerMap,\n  combineReducers,\n  MetaReducer,\n} from '@ngrx/store';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport { ClientToken } from '../../models/token-types.model';\nimport { AuthActions } from '../actions/index';\nimport { AuthState, CLIENT_TOKEN_DATA } from '../auth-state';\nimport * as fromUserTokenReducer from './user-token.reducer';\n\nexport function getReducers(): ActionReducerMap<AuthState> {\n  return {\n    userToken: combineReducers({ token: fromUserTokenReducer.reducer }),\n    clientToken: loaderReducer<ClientToken>(CLIENT_TOKEN_DATA),\n  };\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<AuthState>\n> = new InjectionToken<ActionReducerMap<AuthState>>('AuthReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearAuthState(\n  reducer: ActionReducer<AuthState, Action>\n): ActionReducer<AuthState, Action> {\n  return function(state, action) {\n    if (action.type === AuthActions.LOGOUT) {\n      state = {\n        ...state,\n        userToken: undefined,\n      };\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearAuthState];\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { ConfigModule } from '../../config/config.module';\nimport { StateConfig, StorageSyncType } from '../../state/config/state-config';\nimport { StateModule } from '../../state/state.module';\nimport { AUTH_FEATURE } from './auth-state';\nimport { effects } from './effects/index';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function authStoreConfigFactory(): StateConfig {\n  // if we want to reuse AUTH_FEATURE const in config, we have to use factory instead of plain object\n  const config: StateConfig = {\n    state: {\n      storageSync: {\n        keys: {\n          'auth.userToken.token': StorageSyncType.LOCAL_STORAGE,\n        },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StateModule,\n    StoreModule.forFeature(AUTH_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n    ConfigModule.withConfigFactory(authStoreConfigFactory),\n  ],\n  providers: [reducerProvider],\n})\nexport class AuthStoreModule {}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config, ConfigModule } from '../config/config.module';\nimport { AuthConfig } from './config/auth-config';\nimport { defaultAuthConfig } from './config/default-auth-config';\nimport { interceptors } from './http-interceptors/index';\nimport { AuthServices } from './services/index';\nimport { AuthStoreModule } from './store/auth-store.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    AuthStoreModule,\n    ConfigModule.withConfig(defaultAuthConfig),\n  ],\n  providers: [...AuthServices, { provide: AuthConfig, useExisting: Config }],\n})\nexport class AuthModule {\n  static forRoot(): ModuleWithProviders<AuthModule> {\n    return {\n      ngModule: AuthModule,\n      providers: [...interceptors],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\n\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { Router } from '@angular/router';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthRedirectService {\n  /**\n   * This service is responsible for redirecting to the last page before authorization. \"The last page\" can be:\n   * 1. Just the previously opened page; or\n   * 2. The page that we just tried to open, but AuthGuard cancelled it\n   *\n   * For example:\n   * 1. The user opens the product page, then clicks /login link and signs in\n   *    -> Then we should redirect to the product page; or\n   * 2. The user opens the product page, then he clicks /my-account link,\n   *    but is automatically redirected to the login page by the AuthGuard, and he signs in\n   *    -> Then we should redirect to the my-account page, not the product page\n   */\n  constructor(private routing: RoutingService, private router: Router) {}\n\n  private redirectUrl: string;\n  private ignoredUrls = new Set<string>();\n  private lastAuthGuardNavigation: {\n    url: string;\n    navigationId: number;\n  };\n\n  redirect() {\n    if (this.redirectUrl === undefined) {\n      this.routing.go('/');\n    } else {\n      this.routing.goByUrl(this.redirectUrl);\n    }\n    this.redirectUrl = undefined;\n    this.lastAuthGuardNavigation = undefined;\n  }\n\n  reportAuthGuard() {\n    const { url, navigationId } = this.getCurrentNavigation();\n    this.lastAuthGuardNavigation = { url, navigationId };\n    this.redirectUrl = url;\n  }\n\n  reportNotAuthGuard() {\n    const { url, initialUrl, navigationId } = this.getCurrentNavigation();\n\n    this.ignoredUrls.add(url);\n\n    // Don't save redirect url if you've already come from page with NotAuthGuard (i.e. user has come from login to register)\n    if (!this.ignoredUrls.has(initialUrl)) {\n      // We compare the navigation id to find out if the url cancelled by AuthGuard (i.e. my-account) is more recent\n      // than the last opened page\n      if (\n        !this.lastAuthGuardNavigation ||\n        this.lastAuthGuardNavigation.navigationId < navigationId - 1\n      ) {\n        this.redirectUrl = initialUrl;\n        this.lastAuthGuardNavigation = undefined;\n      }\n    }\n  }\n\n  private getCurrentNavigation(): {\n    navigationId: number;\n    url: string;\n    initialUrl: string;\n  } {\n    const initialUrl = this.router.url;\n    const navigation = this.router.getCurrentNavigation();\n    const url = this.router.serializeUrl(navigation.finalUrl);\n    return {\n      navigationId: navigation.id,\n      url,\n      initialUrl,\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CanActivate, Router } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { AuthService } from '../facade/auth.service';\nimport { UserToken } from '../models/token-types.model';\nimport { AuthRedirectService } from './auth-redirect.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthGuard implements CanActivate {\n  constructor(\n    protected routingService: RoutingService,\n    protected authService: AuthService,\n    protected authRedirectService: AuthRedirectService,\n    protected router: Router\n  ) {}\n\n  canActivate(): Observable<boolean> {\n    return this.authService.getUserToken().pipe(\n      map((token: UserToken) => {\n        if (!token.access_token) {\n          this.routingService.go({ cxRoute: 'login' });\n          this.authRedirectService.reportAuthGuard();\n        }\n        return !!token.access_token;\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CanActivate } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { AuthService } from '../facade/auth.service';\nimport { AuthRedirectService } from './auth-redirect.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class NotAuthGuard implements CanActivate {\n  constructor(\n    protected routingService: RoutingService,\n    protected authService: AuthService,\n    private authRedirectService: AuthRedirectService\n  ) {}\n\n  canActivate(): Observable<boolean> {\n    this.authRedirectService.reportNotAuthGuard();\n\n    // redirect, if user is already logged in:\n    return this.authService.getUserToken().pipe(\n      map(token => {\n        if (token.access_token) {\n          this.routingService.go({ cxRoute: 'home' });\n        }\n        return !token.access_token;\n      })\n    );\n  }\n}\n","import { LoaderState } from './loader-state';\n\nexport function loaderValueSelector<T>(state: LoaderState<T>): T {\n  return state.value;\n}\n\nexport function loaderLoadingSelector<T>(state: LoaderState<T>): boolean {\n  return state.loading;\n}\n\nexport function loaderErrorSelector<T>(state: LoaderState<T>): boolean {\n  return state.error;\n}\n\nexport function loaderSuccessSelector<T>(state: LoaderState<T>): boolean {\n  return state.success;\n}\n","import { Cart } from '../../model/cart.model';\nimport { OrderEntry } from '../../model/order.model';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\n\nexport const CART_FEATURE = 'cart';\nexport const CART_DATA = '[Cart] Cart Data';\n\nexport interface StateWithCart {\n  [CART_FEATURE]: CartsState;\n}\n\nexport interface CartsState {\n  active: LoaderState<CartState>;\n}\n\nexport interface CartState {\n  content: Cart;\n  entries: { [code: string]: OrderEntry };\n  refresh: boolean;\n  cartMergeComplete: boolean;\n}\n","import {\n  createFeatureSelector,\n  createSelector,\n  MemoizedSelector,\n} from '@ngrx/store';\nimport { Cart } from '../../../model/cart.model';\nimport { OrderEntry } from '../../../model/order.model';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderLoadingSelector,\n  loaderSuccessSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport {\n  CartsState,\n  CartState,\n  CART_FEATURE,\n  StateWithCart,\n} from '../cart-state';\n\nconst getCartContentSelector = (state: CartState) => state.content;\nconst getCartRefreshSelector = (state: CartState) => state.refresh;\nconst getCartEntriesSelector = (state: CartState) => state.entries;\nconst getCartMergeCompleteSelector = (state: CartState) =>\n  state.cartMergeComplete;\n\nexport const getCartsState: MemoizedSelector<\n  StateWithCart,\n  CartsState\n> = createFeatureSelector<CartsState>(CART_FEATURE);\n\nexport const getActiveCartState: MemoizedSelector<\n  StateWithCart,\n  LoaderState<CartState>\n> = createSelector(\n  getCartsState,\n  (cartsState: CartsState) => cartsState.active\n);\n\nexport const getCartState: MemoizedSelector<\n  StateWithCart,\n  CartState\n> = createSelector(\n  getActiveCartState,\n  state => loaderValueSelector(state)\n);\n\nexport const getCartContent: MemoizedSelector<\n  StateWithCart,\n  Cart\n> = createSelector(\n  getCartState,\n  getCartContentSelector\n);\n\nexport const getCartRefresh: MemoizedSelector<\n  StateWithCart,\n  boolean\n> = createSelector(\n  getCartState,\n  getCartRefreshSelector\n);\n\nexport const getCartLoaded: MemoizedSelector<\n  StateWithCart,\n  boolean\n> = createSelector(\n  getActiveCartState,\n  state =>\n    loaderSuccessSelector(state) &&\n    !loaderLoadingSelector(state) &&\n    !loaderValueSelector(state).refresh\n);\n\nexport const getCartLoading: MemoizedSelector<any, boolean> = createSelector(\n  getActiveCartState,\n  state => loaderLoadingSelector(state)\n);\n\nexport const getCartMergeComplete: MemoizedSelector<\n  StateWithCart,\n  boolean\n> = createSelector(\n  getCartState,\n  getCartMergeCompleteSelector\n);\n\nexport const getCartEntriesMap: MemoizedSelector<\n  StateWithCart,\n  { [code: string]: OrderEntry }\n> = createSelector(\n  getCartState,\n  getCartEntriesSelector\n);\n\nexport const getCartEntrySelectorFactory = (\n  productCode: string\n): MemoizedSelector<StateWithCart, OrderEntry> => {\n  return createSelector(\n    getCartEntriesMap,\n    entries => {\n      if (entries) {\n        return entries[productCode];\n      }\n    }\n  );\n};\n\nexport const getCartEntries: MemoizedSelector<\n  StateWithCart,\n  OrderEntry[]\n> = createSelector(\n  getCartEntriesMap,\n  entities => {\n    return Object.keys(entities).map(code => entities[code]);\n  }\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { filter } from 'rxjs/operators';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { Cart } from '../../model/cart.model';\nimport { StateWithCart } from '../store/cart-state';\nimport { CartSelectors } from '../store/selectors/index';\n\nexport const ANONYMOUS_USERID = 'anonymous';\n\n@Injectable()\nexport class CartDataService {\n  private _userId = ANONYMOUS_USERID;\n  private _cart: Cart;\n\n  constructor(\n    protected store: Store<StateWithCart>,\n    protected authService: AuthService\n  ) {\n    this.authService\n      .getUserToken()\n      .pipe(filter(userToken => this.userId !== userToken.userId))\n      .subscribe(userToken => {\n        if (Object.keys(userToken).length !== 0) {\n          this._userId = userToken.userId;\n        } else {\n          this._userId = ANONYMOUS_USERID;\n        }\n      });\n\n    this.store.pipe(select(CartSelectors.getCartContent)).subscribe(cart => {\n      this._cart = cart;\n    });\n  }\n\n  get hasCart(): boolean {\n    return !!this._cart;\n  }\n\n  get userId(): string {\n    return this._userId;\n  }\n\n  get cart(): Cart {\n    return this._cart;\n  }\n\n  get cartId(): string {\n    if (this.hasCart) {\n      return this.userId === ANONYMOUS_USERID ? this.cart.guid : this.cart.code;\n    }\n  }\n}\n","import {\n  LoaderFailAction,\n  LoaderLoadAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { CART_DATA } from '../cart-state';\n\nexport const CART_ADD_ENTRY = '[Cart-entry] Add Entry';\nexport const CART_ADD_ENTRY_SUCCESS = '[Cart-entry] Add Entry Success';\nexport const CART_ADD_ENTRY_FAIL = '[Cart-entry] Add Entry Fail';\n\nexport const CART_REMOVE_ENTRY = '[Cart-entry] Remove Entry';\nexport const CART_REMOVE_ENTRY_SUCCESS = '[Cart-entry] Remove Entry Success';\nexport const CART_REMOVE_ENTRY_FAIL = '[Cart-entry] Remove Entry Fail';\n\nexport const CART_UPDATE_ENTRY = '[Cart-entry] Update Entry';\nexport const CART_UPDATE_ENTRY_SUCCESS = '[Cart-entry] Update Entry Success';\nexport const CART_UPDATE_ENTRY_FAIL = '[Cart-entry] Update Entry Fail';\n\nexport class CartAddEntry extends LoaderLoadAction {\n  readonly type = CART_ADD_ENTRY;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartAddEntrySuccess extends LoaderSuccessAction {\n  readonly type = CART_ADD_ENTRY_SUCCESS;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartAddEntryFail extends LoaderFailAction {\n  readonly type = CART_ADD_ENTRY_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport class CartRemoveEntry extends LoaderLoadAction {\n  readonly type = CART_REMOVE_ENTRY;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartRemoveEntrySuccess extends LoaderSuccessAction {\n  readonly type = CART_REMOVE_ENTRY_SUCCESS;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartRemoveEntryFail extends LoaderFailAction {\n  readonly type = CART_REMOVE_ENTRY_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport class CartUpdateEntry extends LoaderLoadAction {\n  readonly type = CART_UPDATE_ENTRY;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartUpdateEntrySuccess extends LoaderSuccessAction {\n  readonly type = CART_UPDATE_ENTRY_SUCCESS;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartUpdateEntryFail extends LoaderFailAction {\n  readonly type = CART_UPDATE_ENTRY_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport type CartEntryAction =\n  | CartAddEntry\n  | CartAddEntrySuccess\n  | CartAddEntryFail\n  | CartRemoveEntry\n  | CartRemoveEntrySuccess\n  | CartRemoveEntryFail\n  | CartUpdateEntry\n  | CartUpdateEntrySuccess\n  | CartUpdateEntryFail;\n","import { Action } from '@ngrx/store';\nimport {\n  LoaderFailAction,\n  LoaderLoadAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { CART_DATA } from '../cart-state';\n\nexport const CREATE_CART = '[Cart] Create Cart';\nexport const CREATE_CART_FAIL = '[Cart] Create Cart Fail';\nexport const CREATE_CART_SUCCESS = '[Cart] Create Cart Success';\n\nexport const LOAD_CART = '[Cart] Load Cart';\nexport const LOAD_CART_FAIL = '[Cart] Load Cart Fail';\nexport const LOAD_CART_SUCCESS = '[Cart] Load Cart Success';\n\nexport const MERGE_CART = '[Cart] Merge Cart';\nexport const MERGE_CART_SUCCESS = '[Cart] Merge Cart Success';\n\nexport const RESET_CART_DETAILS = '[Cart] Reset Cart Details';\n\nexport class CreateCart extends LoaderLoadAction {\n  readonly type = CREATE_CART;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class CreateCartFail extends LoaderFailAction {\n  readonly type = CREATE_CART_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport class CreateCartSuccess extends LoaderSuccessAction {\n  readonly type = CREATE_CART_SUCCESS;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class LoadCart extends LoaderLoadAction {\n  readonly type = LOAD_CART;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(CART_DATA);\n  }\n}\n\nexport class LoadCartFail extends LoaderFailAction {\n  readonly type = LOAD_CART_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport class LoadCartSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_CART_SUCCESS;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class MergeCart implements Action {\n  readonly type = MERGE_CART;\n  constructor(public payload: any) {}\n}\n\nexport class MergeCartSuccess implements Action {\n  readonly type = MERGE_CART_SUCCESS;\n  constructor(public payload: any) {}\n}\n\nexport class ResetCartDetails implements Action {\n  readonly type = RESET_CART_DETAILS;\n  constructor() {}\n}\n\nexport type CartAction =\n  | CreateCart\n  | CreateCartFail\n  | CreateCartSuccess\n  | LoadCart\n  | LoadCartFail\n  | LoadCartSuccess\n  | MergeCart\n  | MergeCartSuccess\n  | ResetCartDetails;\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { asyncScheduler, combineLatest, Observable } from 'rxjs';\nimport {\n  debounceTime,\n  filter,\n  map,\n  shareReplay,\n  take,\n  tap,\n} from 'rxjs/operators';\nimport { AuthService } from '../../auth/index';\nimport { Cart } from '../../model/cart.model';\nimport { OrderEntry } from '../../model/order.model';\nimport { CartActions } from '../store/actions/index';\nimport { StateWithCart } from '../store/cart-state';\nimport { CartSelectors } from '../store/selectors/index';\nimport { ANONYMOUS_USERID, CartDataService } from './cart-data.service';\n\n@Injectable()\nexport class CartService {\n  private readonly PREVIOUS_USER_ID_INITIAL_VALUE =\n    'PREVIOUS_USER_ID_INITIAL_VALUE';\n  private previousUserId = this.PREVIOUS_USER_ID_INITIAL_VALUE;\n  private _activeCart$: Observable<Cart>;\n\n  constructor(\n    protected store: Store<StateWithCart>,\n    protected cartData: CartDataService,\n    protected authService: AuthService\n  ) {\n    this._activeCart$ = combineLatest([\n      this.store.select(CartSelectors.getCartContent),\n      this.store.select(CartSelectors.getCartLoading),\n      this.authService.getUserToken(),\n    ]).pipe(\n      // combineLatest emits multiple times on each property update instead of one emit\n      // additionally dispatching actions that changes selectors used here needs to happen in order\n      // for this asyncScheduler is used here\n      debounceTime(1, asyncScheduler),\n      filter(([, loading]) => !loading),\n      tap(([cart, , userToken]) => {\n        if (this.isJustLoggedIn(userToken.userId)) {\n          this.loadOrMerge();\n        } else if (this.isCreated(cart) && this.isIncomplete(cart)) {\n          this.load();\n        }\n\n        this.previousUserId = userToken.userId;\n      }),\n      filter(\n        ([cart]) =>\n          !this.isCreated(cart) ||\n          (this.isCreated(cart) && !this.isIncomplete(cart))\n      ),\n      map(([cart]) => cart),\n      shareReplay({ bufferSize: 1, refCount: true })\n    );\n  }\n\n  getActive(): Observable<Cart> {\n    return this._activeCart$;\n  }\n\n  getEntries(): Observable<OrderEntry[]> {\n    return this.store.pipe(select(CartSelectors.getCartEntries));\n  }\n\n  getCartMergeComplete(): Observable<boolean> {\n    return this.store.pipe(select(CartSelectors.getCartMergeComplete));\n  }\n\n  getLoaded(): Observable<boolean> {\n    return this.store.pipe(select(CartSelectors.getCartLoaded));\n  }\n\n  private loadOrMerge(): void {\n    // for login user, whenever there's an existing cart, we will load the user\n    // current cart and merge it into the existing cart\n    if (!this.isCreated(this.cartData.cart)) {\n      this.store.dispatch(\n        new CartActions.LoadCart({\n          userId: this.cartData.userId,\n          cartId: 'current',\n        })\n      );\n    } else {\n      this.store.dispatch(\n        new CartActions.MergeCart({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cart.guid,\n        })\n      );\n    }\n  }\n\n  private load(): void {\n    if (this.cartData.userId !== ANONYMOUS_USERID) {\n      this.store.dispatch(\n        new CartActions.LoadCart({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cartId ? this.cartData.cartId : 'current',\n        })\n      );\n    } else {\n      this.store.dispatch(\n        new CartActions.LoadCart({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cartId,\n        })\n      );\n    }\n  }\n\n  addEntry(productCode: string, quantity: number): void {\n    this.store\n      .pipe(\n        select(CartSelectors.getActiveCartState),\n        tap(cartState => {\n          if (!this.isCreated(cartState.value.content) && !cartState.loading) {\n            this.store.dispatch(\n              new CartActions.CreateCart({ userId: this.cartData.userId })\n            );\n          }\n        }),\n        filter(cartState => this.isCreated(cartState.value.content)),\n        take(1)\n      )\n      .subscribe(_ => {\n        this.store.dispatch(\n          new CartActions.CartAddEntry({\n            userId: this.cartData.userId,\n            cartId: this.cartData.cartId,\n            productCode: productCode,\n            quantity: quantity,\n          })\n        );\n      });\n  }\n\n  removeEntry(entry: OrderEntry): void {\n    this.store.dispatch(\n      new CartActions.CartRemoveEntry({\n        userId: this.cartData.userId,\n        cartId: this.cartData.cartId,\n        entry: entry.entryNumber,\n      })\n    );\n  }\n\n  updateEntry(entryNumber: string, quantity: number): void {\n    if (quantity > 0) {\n      this.store.dispatch(\n        new CartActions.CartUpdateEntry({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cartId,\n          entry: entryNumber,\n          qty: quantity,\n        })\n      );\n    } else {\n      this.store.dispatch(\n        new CartActions.CartRemoveEntry({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cartId,\n          entry: entryNumber,\n        })\n      );\n    }\n  }\n\n  getEntry(productCode: string): Observable<OrderEntry> {\n    return this.store.pipe(\n      select(CartSelectors.getCartEntrySelectorFactory(productCode))\n    );\n  }\n\n  private isCreated(cart: Cart): boolean {\n    return cart && typeof cart.guid !== 'undefined';\n  }\n\n  /**\n   * Cart is incomplete if it contains only `guid` and `code` properties, which come from local storage.\n   * To get cart content, we need to load cart from backend.\n   */\n  private isIncomplete(cart: Cart): boolean {\n    return cart && Object.keys(cart).length <= 2;\n  }\n\n  private isJustLoggedIn(userId: string): boolean {\n    return (\n      typeof userId !== 'undefined' && // logged in user\n      this.previousUserId !== userId && // *just* logged in\n      this.previousUserId !== this.PREVIOUS_USER_ID_INITIAL_VALUE // not app initialization\n    );\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Cart } from '../../../model/cart.model';\n\nexport abstract class CartAdapter {\n  /**\n   * Abstract method used to load all carts\n   *\n   * @param userId\n   */\n  abstract loadAll(userId: string): Observable<Cart[]>;\n\n  /**\n   * Abstract method used to load cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract load(userId: string, cartId: string): Observable<Cart>;\n\n  /**\n   * Abstract method used to create cart. If toMergeCartGuid is specified, cart will be merged with existing one\n   *\n   * @param userId\n   * @param oldCartId\n   * @param toMergeCartGuid\n   */\n  abstract create(\n    userId: string,\n    oldCartId?: string,\n    toMergeCartGuid?: string\n  ): Observable<Cart>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Cart } from '../../../model/cart.model';\nimport { CartAdapter } from './cart.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartConnector {\n  constructor(protected adapter: CartAdapter) {}\n\n  public loadAll(userId: string): Observable<Cart[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  public load(userId: string, cartId: string): Observable<Cart> {\n    return this.adapter.load(userId, cartId);\n  }\n\n  public create(\n    userId: string,\n    oldCartId?: string,\n    toMergeCartGuid?: string\n  ): Observable<Cart> {\n    return this.adapter.create(userId, oldCartId, toMergeCartGuid);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { Cart } from '../../../model/cart.model';\nimport * as fromSiteContextActions from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CartConnector } from '../../connectors/cart/cart.connector';\nimport { CartDataService } from '../../facade/cart-data.service';\nimport { CartActions } from '../actions/index';\n\n@Injectable()\nexport class CartEffects {\n  @Effect()\n  loadCart$: Observable<\n    CartActions.LoadCartFail | CartActions.LoadCartSuccess\n  > = this.actions$.pipe(\n    ofType(CartActions.LOAD_CART),\n    map(\n      (action: {\n        type: string;\n        payload?: { userId: string; cartId: string };\n      }) => action.payload\n    ),\n    mergeMap(payload => {\n      const loadCartParams = {\n        userId: (payload && payload.userId) || this.cartData.userId,\n        cartId: (payload && payload.cartId) || this.cartData.cartId,\n      };\n\n      if (this.isMissingData(loadCartParams)) {\n        return of(new CartActions.LoadCartFail({}));\n      }\n      return this.cartConnector\n        .load(loadCartParams.userId, loadCartParams.cartId)\n        .pipe(\n          map((cart: Cart) => {\n            return new CartActions.LoadCartSuccess(cart);\n          }),\n          catchError(error =>\n            of(new CartActions.LoadCartFail(makeErrorSerializable(error)))\n          )\n        );\n    })\n  );\n\n  @Effect()\n  createCart$: Observable<\n    | CartActions.MergeCartSuccess\n    | CartActions.CreateCartSuccess\n    | CartActions.CreateCartFail\n  > = this.actions$.pipe(\n    ofType(CartActions.CREATE_CART),\n    map((action: CartActions.CreateCart) => action.payload),\n    mergeMap(payload => {\n      return this.cartConnector\n        .create(payload.userId, payload.oldCartId, payload.toMergeCartGuid)\n        .pipe(\n          switchMap((cart: Cart) => {\n            if (payload.oldCartId) {\n              return [\n                new CartActions.CreateCartSuccess(cart),\n                new CartActions.MergeCartSuccess({\n                  userId: payload.userId,\n                  cartId: cart.code,\n                }),\n              ];\n            }\n            return [new CartActions.CreateCartSuccess(cart)];\n          }),\n          catchError(error =>\n            of(new CartActions.CreateCartFail(makeErrorSerializable(error)))\n          )\n        );\n    })\n  );\n\n  @Effect()\n  mergeCart$: Observable<CartActions.CreateCart> = this.actions$.pipe(\n    ofType(CartActions.MERGE_CART),\n    map((action: CartActions.MergeCart) => action.payload),\n    mergeMap(payload => {\n      return this.cartConnector.load(payload.userId, 'current').pipe(\n        map(currentCart => {\n          return new CartActions.CreateCart({\n            userId: payload.userId,\n            oldCartId: payload.cartId,\n            toMergeCartGuid: currentCart ? currentCart.guid : undefined,\n          });\n        })\n      );\n    })\n  );\n\n  @Effect()\n  refresh$: Observable<CartActions.LoadCart> = this.actions$.pipe(\n    ofType(\n      CartActions.MERGE_CART_SUCCESS,\n      CartActions.CART_ADD_ENTRY_SUCCESS,\n      CartActions.CART_UPDATE_ENTRY_SUCCESS,\n      CartActions.CART_REMOVE_ENTRY_SUCCESS\n    ),\n    map(\n      (\n        action:\n          | CartActions.MergeCartSuccess\n          | CartActions.CartAddEntrySuccess\n          | CartActions.CartUpdateEntrySuccess\n          | CartActions.CartRemoveEntrySuccess\n      ) => action.payload\n    ),\n    map(\n      payload =>\n        new CartActions.LoadCart({\n          userId: payload.userId,\n          cartId: payload.cartId,\n        })\n    )\n  );\n\n  @Effect()\n  resetCartDetailsOnSiteContextChange$: Observable<\n    CartActions.ResetCartDetails\n  > = this.actions$.pipe(\n    ofType(\n      fromSiteContextActions.LANGUAGE_CHANGE,\n      fromSiteContextActions.CURRENCY_CHANGE\n    ),\n    map(() => new CartActions.ResetCartDetails())\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cartConnector: CartConnector,\n    private cartData: CartDataService\n  ) {}\n\n  private isMissingData(payload: { userId: string; cartId: string }) {\n    return payload.userId === undefined || payload.cartId === undefined;\n  }\n}\n","import { Observable } from 'rxjs';\nimport { CartModification } from '../../../model/cart.model';\n\nexport abstract class CartEntryAdapter {\n  /**\n   * Abstract method used to add entry to cart\n   *\n   * @param userId\n   * @param cartId\n   * @param productCode\n   * @param quantity\n   */\n  abstract add(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity?: number\n  ): Observable<CartModification>;\n\n  /**\n   * Abstract method used to update entry in cart\n   * @param userId\n   * @param cartId\n   * @param entryNumber\n   * @param qty\n   * @param pickupStore\n   */\n  abstract update(\n    userId: string,\n    cartId: string,\n    entryNumber: string,\n    qty: number,\n    pickupStore?: string\n  ): Observable<CartModification>;\n\n  /**\n   * Abstract method used to remove entry from cart\n   *\n   * @param userId\n   * @param cartId\n   * @param entryNumber\n   */\n  abstract remove(\n    userId: string,\n    cartId: string,\n    entryNumber: string\n  ): Observable<any>;\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { CartEntryAdapter } from './cart-entry.adapter';\nimport { CartModification } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartEntryConnector {\n  constructor(protected adapter: CartEntryAdapter) {}\n\n  public add(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity?: number\n  ): Observable<CartModification> {\n    return this.adapter.add(userId, cartId, productCode, quantity);\n  }\n\n  public update(\n    userId: string,\n    cartId: string,\n    entryNumber: string,\n    qty: number,\n    pickupStore?: string\n  ): Observable<CartModification> {\n    return this.adapter.update(userId, cartId, entryNumber, qty, pickupStore);\n  }\n\n  public remove(\n    userId: string,\n    cartId: string,\n    entryNumber: string\n  ): Observable<any> {\n    return this.adapter.remove(userId, cartId, entryNumber);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CartEntryConnector } from '../../connectors/entry/cart-entry.connector';\nimport { CartActions } from '../actions/index';\n\n@Injectable()\nexport class CartEntryEffects {\n  @Effect()\n  addEntry$: Observable<\n    CartActions.CartAddEntrySuccess | CartActions.CartAddEntryFail\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_ADD_ENTRY),\n    map((action: CartActions.CartAddEntry) => action.payload),\n    mergeMap(payload =>\n      this.cartEntryConnector\n        .add(\n          payload.userId,\n          payload.cartId,\n          payload.productCode,\n          payload.quantity\n        )\n        .pipe(\n          map(\n            (entry: any) =>\n              new CartActions.CartAddEntrySuccess({\n                ...entry,\n                userId: payload.userId,\n                cartId: payload.cartId,\n              })\n          ),\n          catchError(error =>\n            of(new CartActions.CartAddEntryFail(makeErrorSerializable(error)))\n          )\n        )\n    )\n  );\n\n  @Effect()\n  removeEntry$: Observable<\n    CartActions.CartRemoveEntrySuccess | CartActions.CartRemoveEntryFail\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_REMOVE_ENTRY),\n    map((action: CartActions.CartAddEntry) => action.payload),\n    mergeMap(payload =>\n      this.cartEntryConnector\n        .remove(payload.userId, payload.cartId, payload.entry)\n        .pipe(\n          map(() => {\n            return new CartActions.CartRemoveEntrySuccess({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            });\n          }),\n          catchError(error =>\n            of(\n              new CartActions.CartRemoveEntryFail(makeErrorSerializable(error))\n            )\n          )\n        )\n    )\n  );\n\n  @Effect()\n  updateEntry$: Observable<\n    CartActions.CartUpdateEntrySuccess | CartActions.CartUpdateEntryFail\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_UPDATE_ENTRY),\n    map((action: CartActions.CartAddEntry) => action.payload),\n    mergeMap(payload =>\n      this.cartEntryConnector\n        .update(payload.userId, payload.cartId, payload.entry, payload.qty)\n        .pipe(\n          map(() => {\n            return new CartActions.CartUpdateEntrySuccess({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            });\n          }),\n          catchError(error =>\n            of(\n              new CartActions.CartUpdateEntryFail(makeErrorSerializable(error))\n            )\n          )\n        )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cartEntryConnector: CartEntryConnector\n  ) {}\n}\n","import { CartEffects } from './cart.effect';\nimport { CartEntryEffects } from './cart-entry.effect';\n\nexport const effects: any[] = [CartEffects, CartEntryEffects];\n\nexport * from './cart.effect';\nexport * from './cart-entry.effect';\n","import { LoaderState } from '../../state/utils/loader/loader-state';\nimport { CardType, PaymentDetails } from '../../model/cart.model';\nimport { Address, AddressValidation } from '../../model/address.model';\nimport { DeliveryMode, Order } from '../../model/order.model';\n\nexport const CHECKOUT_FEATURE = 'checkout';\nexport const CHECKOUT_DETAILS = '[Checkout] Checkout Details';\n\nexport interface StateWithCheckout {\n  [CHECKOUT_FEATURE]: CheckoutState;\n}\n\nexport interface AddressVerificationState {\n  results: AddressValidation | string;\n}\n\nexport interface CardTypesState {\n  entities: { [code: string]: CardType };\n}\n\nexport interface CheckoutStepsState {\n  address: Address;\n  deliveryMode: {\n    supported: { [code: string]: DeliveryMode };\n    selected: string;\n  };\n  paymentDetails: PaymentDetails;\n  orderDetails: Order;\n}\n\nexport interface CheckoutState {\n  steps: LoaderState<CheckoutStepsState>;\n  cardTypes: CardTypesState;\n  addressVerification: AddressVerificationState;\n}\n","import { Action } from '@ngrx/store';\n\nimport {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { CHECKOUT_DETAILS } from '../checkout-state';\nimport { CheckoutDetails } from '../../models/checkout.model';\nimport { Address } from '../../../model/address.model';\nimport { DeliveryMode, Order } from '../../../model/order.model';\nimport { PaymentDetails } from '../../../model/cart.model';\n\nexport const ADD_DELIVERY_ADDRESS = '[Checkout] Add Delivery Address';\nexport const ADD_DELIVERY_ADDRESS_FAIL = '[Checkout] Add Delivery Address Fail';\nexport const ADD_DELIVERY_ADDRESS_SUCCESS =\n  '[Checkout] Add Delivery Address Success';\n\nexport const SET_DELIVERY_ADDRESS = '[Checkout] Set Delivery Address';\nexport const SET_DELIVERY_ADDRESS_FAIL = '[Checkout] Set Delivery Address Fail';\nexport const SET_DELIVERY_ADDRESS_SUCCESS =\n  '[Checkout] Set Delivery Address Success';\n\nexport const LOAD_SUPPORTED_DELIVERY_MODES =\n  '[Checkout] Load Supported Delivery Modes';\nexport const LOAD_SUPPORTED_DELIVERY_MODES_FAIL =\n  '[Checkout] Load Supported Delivery Modes Fail';\nexport const LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS =\n  '[Checkout] Load Supported Delivery Modes Success';\nexport const CLEAR_SUPPORTED_DELIVERY_MODES =\n  '[Checkout] Clear Supported Delivery Modes';\n\nexport const SET_DELIVERY_MODE = '[Checkout] Set Delivery Mode';\nexport const SET_DELIVERY_MODE_FAIL = '[Checkout] Set Delivery Mode Fail';\nexport const SET_DELIVERY_MODE_SUCCESS = '[Checkout] Set Delivery Mode Success';\n\nexport const CREATE_PAYMENT_DETAILS = '[Checkout] Create Payment Details';\nexport const CREATE_PAYMENT_DETAILS_FAIL =\n  '[Checkout] Create Payment Details Fail';\nexport const CREATE_PAYMENT_DETAILS_SUCCESS =\n  '[Checkout] Create Payment Details Success';\n\nexport const SET_PAYMENT_DETAILS = '[Checkout] Set Payment Details';\nexport const SET_PAYMENT_DETAILS_FAIL = '[Checkout] Set Payment Details Fail';\nexport const SET_PAYMENT_DETAILS_SUCCESS =\n  '[Checkout] Set Payment Details Success';\n\nexport const PLACE_ORDER = '[Checkout] Place Order';\nexport const PLACE_ORDER_FAIL = '[Checkout] Place Order Fail';\nexport const PLACE_ORDER_SUCCESS = '[Checkout] Place Order Success';\n\nexport const CLEAR_CHECKOUT_STEP = '[Checkout] Clear One Checkout Step';\nexport const CLEAR_CHECKOUT_DATA = '[Checkout] Clear Checkout Data';\n\nexport const LOAD_CHECKOUT_DETAILS = '[Checkout] Load Checkout Details';\nexport const LOAD_CHECKOUT_DETAILS_FAIL =\n  '[Checkout] Load Checkout Details Fail';\nexport const LOAD_CHECKOUT_DETAILS_SUCCESS =\n  '[Checkout] Load Checkout Details Success';\n\nexport class AddDeliveryAddress implements Action {\n  readonly type = ADD_DELIVERY_ADDRESS;\n  constructor(\n    public payload: { userId: string; cartId: string; address: Address }\n  ) {}\n}\n\nexport class AddDeliveryAddressFail implements Action {\n  readonly type = ADD_DELIVERY_ADDRESS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class AddDeliveryAddressSuccess implements Action {\n  readonly type = ADD_DELIVERY_ADDRESS_SUCCESS;\n  constructor(public payload: Address) {}\n}\n\nexport class SetDeliveryAddress implements Action {\n  readonly type = SET_DELIVERY_ADDRESS;\n  constructor(\n    public payload: { userId: string; cartId: string; address: Address }\n  ) {}\n}\n\nexport class SetDeliveryAddressFail implements Action {\n  readonly type = SET_DELIVERY_ADDRESS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class SetDeliveryAddressSuccess implements Action {\n  readonly type = SET_DELIVERY_ADDRESS_SUCCESS;\n  constructor(public payload: Address) {}\n}\n\nexport class LoadSupportedDeliveryModes implements Action {\n  readonly type = LOAD_SUPPORTED_DELIVERY_MODES;\n  constructor(public payload: { userId: string; cartId: string }) {}\n}\n\nexport class LoadSupportedDeliveryModesFail implements Action {\n  readonly type = LOAD_SUPPORTED_DELIVERY_MODES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadSupportedDeliveryModesSuccess implements Action {\n  readonly type = LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS;\n  constructor(public payload: DeliveryMode[]) {}\n}\n\nexport class SetDeliveryMode implements Action {\n  readonly type = SET_DELIVERY_MODE;\n  constructor(\n    public payload: { userId: string; cartId: string; selectedModeId: string }\n  ) {}\n}\n\nexport class SetDeliveryModeFail implements Action {\n  readonly type = SET_DELIVERY_MODE_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class SetDeliveryModeSuccess implements Action {\n  readonly type = SET_DELIVERY_MODE_SUCCESS;\n  constructor(public payload: string) {}\n}\n\nexport class CreatePaymentDetails implements Action {\n  readonly type = CREATE_PAYMENT_DETAILS;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      paymentDetails: PaymentDetails;\n    }\n  ) {}\n}\n\nexport class CreatePaymentDetailsFail implements Action {\n  readonly type = CREATE_PAYMENT_DETAILS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class CreatePaymentDetailsSuccess implements Action {\n  readonly type = CREATE_PAYMENT_DETAILS_SUCCESS;\n  constructor(public payload: PaymentDetails) {}\n}\n\nexport class SetPaymentDetails implements Action {\n  readonly type = SET_PAYMENT_DETAILS;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      paymentDetails: PaymentDetails;\n    }\n  ) {}\n}\n\nexport class SetPaymentDetailsFail implements Action {\n  readonly type = SET_PAYMENT_DETAILS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class SetPaymentDetailsSuccess implements Action {\n  readonly type = SET_PAYMENT_DETAILS_SUCCESS;\n  constructor(public payload: PaymentDetails) {}\n}\n\nexport class PlaceOrder implements Action {\n  readonly type = PLACE_ORDER;\n  constructor(public payload: { userId: string; cartId: string }) {}\n}\n\nexport class PlaceOrderFail implements Action {\n  readonly type = PLACE_ORDER_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class PlaceOrderSuccess implements Action {\n  readonly type = PLACE_ORDER_SUCCESS;\n  constructor(public payload: Order) {}\n}\n\nexport class ClearSupportedDeliveryModes implements Action {\n  readonly type = CLEAR_SUPPORTED_DELIVERY_MODES;\n}\n\nexport class ClearCheckoutStep implements Action {\n  readonly type = CLEAR_CHECKOUT_STEP;\n  constructor(public payload: number) {}\n}\n\nexport class ClearCheckoutData implements Action {\n  readonly type = CLEAR_CHECKOUT_DATA;\n}\n\nexport class LoadCheckoutDetails extends LoaderLoadAction {\n  readonly type = LOAD_CHECKOUT_DETAILS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(CHECKOUT_DETAILS);\n  }\n}\n\nexport class LoadCheckoutDetailsFail extends LoaderFailAction {\n  readonly type = LOAD_CHECKOUT_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(CHECKOUT_DETAILS, payload);\n  }\n}\n\nexport class LoadCheckoutDetailsSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_CHECKOUT_DETAILS_SUCCESS;\n  constructor(public payload: CheckoutDetails) {\n    super(CHECKOUT_DETAILS);\n  }\n}\n\nexport type CheckoutAction =\n  | AddDeliveryAddress\n  | AddDeliveryAddressFail\n  | AddDeliveryAddressSuccess\n  | SetDeliveryAddress\n  | SetDeliveryAddressFail\n  | SetDeliveryAddressSuccess\n  | LoadSupportedDeliveryModes\n  | LoadSupportedDeliveryModesFail\n  | LoadSupportedDeliveryModesSuccess\n  | SetDeliveryMode\n  | SetDeliveryModeFail\n  | SetDeliveryModeSuccess\n  | ClearSupportedDeliveryModes\n  | CreatePaymentDetails\n  | CreatePaymentDetailsFail\n  | CreatePaymentDetailsSuccess\n  | SetPaymentDetails\n  | SetPaymentDetailsFail\n  | SetPaymentDetailsSuccess\n  | PlaceOrder\n  | PlaceOrderFail\n  | PlaceOrderSuccess\n  | ClearCheckoutStep\n  | ClearCheckoutData\n  | LoadCheckoutDetails\n  | LoadCheckoutDetailsFail\n  | LoadCheckoutDetailsSuccess;\n","import { OrderEntry } from '../../../model/order.model';\nimport { CartActions } from '../actions/index';\nimport { CartState } from '../cart-state';\n\nexport const initialState: CartState = {\n  content: {},\n  entries: {},\n  refresh: false,\n  cartMergeComplete: false,\n};\n\nexport function reducer(\n  state = initialState,\n  action: CartActions.CartAction | CartActions.CartEntryAction\n): CartState {\n  switch (action.type) {\n    case CartActions.MERGE_CART: {\n      return {\n        ...state,\n        cartMergeComplete: false,\n      };\n    }\n\n    case CartActions.MERGE_CART_SUCCESS: {\n      return {\n        ...state,\n        cartMergeComplete: true,\n        refresh: true,\n      };\n    }\n\n    case CartActions.LOAD_CART_SUCCESS:\n    case CartActions.CREATE_CART_SUCCESS: {\n      const content = { ...action.payload };\n      let entries = {};\n      if (content.entries) {\n        entries = content.entries.reduce(\n          (entryMap: { [code: string]: any }, entry: OrderEntry) => {\n            return {\n              ...entryMap,\n              /*\n              If we refresh the page from cart details page, 2 load cart\n              Actions gets dispatched. One is non-detail, and the second is detailed.\n              In the case where the detailed once get resolved first, we merge the existing\n              data with the new data from the response (to not delete existing detailed data).\n              */\n              [entry.product.code]:\n                state.entries && state.entries[entry.product.code]\n                  ? {\n                      ...state.entries[entry.product.code],\n                      ...entry,\n                    }\n                  : entry,\n            };\n          },\n          {\n            ...entries,\n          }\n        );\n        delete content['entries'];\n      }\n      return {\n        ...state,\n        content,\n        entries,\n        refresh: false,\n      };\n    }\n\n    case CartActions.CART_REMOVE_ENTRY_SUCCESS:\n    case CartActions.CART_UPDATE_ENTRY_SUCCESS:\n    case CartActions.CART_ADD_ENTRY_SUCCESS: {\n      return {\n        ...state,\n        refresh: true,\n      };\n    }\n\n    case CartActions.RESET_CART_DETAILS: {\n      return {\n        content: {\n          guid: state.content.guid,\n          code: state.content.code,\n        },\n        entries: {},\n        refresh: false,\n        cartMergeComplete: false,\n      };\n    }\n  }\n\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducer, ActionReducerMap, MetaReducer } from '@ngrx/store';\nimport { LOGOUT } from '../../../auth/store/actions/login-logout.action';\nimport { PLACE_ORDER_SUCCESS } from '../../../checkout/store/actions/checkout.action';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport { CartsState, CartState, CART_DATA } from './../cart-state';\nimport { reducer as cartReducer } from './cart.reducer';\n\nexport function getReducers(): ActionReducerMap<CartsState> {\n  return {\n    active: loaderReducer<CartState>(CART_DATA, cartReducer),\n  };\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<CartsState>\n> = new InjectionToken<ActionReducerMap<CartsState>>('CartReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearCartState(\n  reducer: ActionReducer<any>\n): ActionReducer<any> {\n  return function(state, action) {\n    if (action.type === LOGOUT || action.type === PLACE_ORDER_SUCCESS) {\n      state = undefined;\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearCartState];\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { ConfigModule } from '../../config';\nimport { StateConfig, StorageSyncType } from '../../state/config/state-config';\nimport { CART_FEATURE } from './cart-state';\nimport { effects } from './effects/index';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function cartStoreConfigFactory(): StateConfig {\n  const config: StateConfig = {\n    state: {\n      storageSync: {\n        keys: {\n          [`${CART_FEATURE}.active.value.content.guid`]: StorageSyncType.LOCAL_STORAGE,\n          [`${CART_FEATURE}.active.value.content.code`]: StorageSyncType.LOCAL_STORAGE,\n        },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StoreModule.forFeature(CART_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n    ConfigModule.withConfigFactory(cartStoreConfigFactory),\n  ],\n  providers: [reducerProvider],\n})\nexport class CartStoreModule {}\n","import { NgModule } from '@angular/core';\nimport { CartDataService } from './facade/cart-data.service';\nimport { CartService } from './facade/index';\nimport { CartStoreModule } from './store/cart-store.module';\n\n@NgModule({\n  imports: [CartStoreModule],\n  providers: [CartDataService, CartService],\n})\nexport class CartModule {}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Cart } from '../../../model/cart.model';\n\nexport const CART_NORMALIZER = new InjectionToken<Converter<any, Cart>>(\n  'CartNormalizer'\n);\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { CartModification } from '../../../model/cart.model';\n\nexport const CART_MODIFICATION_NORMALIZER = new InjectionToken<\n  Converter<any, CartModification>\n>('CartModificationNormalizer');\n","import { StaticProvider } from '@angular/core';\nimport { Routes } from '@angular/router';\nimport { AuthConfig } from '../../auth/config/auth-config';\nimport { KymaConfig } from '../../kyma/config/kyma-config';\nimport { OccConfig } from '../../occ/config/occ-config';\n\nexport interface StandardCmsComponentConfig {\n  CMSSiteContextComponent?: CmsComponentMapping;\n  CMSLinkComponent?: CmsComponentMapping;\n  SimpleResponsiveBannerComponent?: CmsComponentMapping;\n  SimpleBannerComponent?: CmsComponentMapping;\n  BannerComponent?: CmsComponentMapping;\n  CMSParagraphComponent?: CmsComponentMapping;\n  BreadcrumbComponent?: CmsComponentMapping;\n  NavigationComponent?: CmsComponentMapping;\n  FooterNavigationComponent?: CmsComponentMapping;\n  CategoryNavigationComponent?: CmsComponentMapping;\n  ProductAddToCartComponent?: CmsComponentMapping;\n  MiniCartComponent?: CmsComponentMapping;\n  ProductCarouselComponent?: CmsComponentMapping;\n  SearchBoxComponent?: CmsComponentMapping;\n  ProductReferencesComponent?: CmsComponentMapping;\n  CMSTabParagraphComponent?: CmsComponentMapping;\n  LoginComponent?: CmsComponentMapping;\n}\n\nexport interface JspIncludeCmsComponentConfig {\n  AccountAddressBookComponent?: CmsComponentMapping;\n  ForgotPasswordComponent?: CmsComponentMapping;\n  ResetPasswordComponent?: CmsComponentMapping;\n  ProductDetailsTabComponent?: CmsComponentMapping;\n  ProductSpecsTabComponent?: CmsComponentMapping;\n  ProductReviewsTabComponent?: CmsComponentMapping;\n}\n\nexport const JSP_INCLUDE_CMS_COMPONENT_TYPE = 'JspIncludeComponent';\nexport const CMS_FLEX_COMPONENT_TYPE = 'CMSFlexComponent';\n\nexport interface CmsComponentMapping {\n  component?: any;\n  providers?: StaticProvider[];\n  childRoutes?: Routes;\n  disableSSR?: boolean;\n  i18nKeys?: string[];\n  guards?: any[];\n}\n\nexport interface CMSComponentConfig\n  extends StandardCmsComponentConfig,\n    JspIncludeCmsComponentConfig {\n  [_: string]: CmsComponentMapping;\n}\n\nexport abstract class CmsConfig extends OccConfig\n  implements AuthConfig, KymaConfig {\n  authentication?: {\n    client_id?: string;\n    client_secret?: string;\n\n    kyma_enabled?: boolean;\n    kyma_client_id?: string;\n    kyma_client_secret?: string;\n  };\n\n  cmsComponents?: CMSComponentConfig;\n}\n","import { ContentSlotComponentData } from '../model/content-slot-component-data.model';\nimport { CmsConfig } from './cms-config';\n\n/**\n * The `CmsPageConfig` is used to build pages by configuration.\n * The interfaces are designed to have a clean configuration for\n * static CMS structure. Ordinary attributes that are not\n * required for configurable pages have been left out and\n * will not be serialized in the adapter logic.\n */\nexport interface CmsPageConfig {\n  /**\n   * When the `ignoreBackend` is set to true, the CMS backend\n   * will not be consumed. This saves network latency and is\n   * useful for commodity commerce pages.\n   * */\n  ignoreBackend?: boolean;\n\n  pageId?: string;\n\n  type?: string;\n\n  /**\n   * The page title is typically used to display the page heading\n   * as well as for the page title tag. The latter is used for browser\n   * navigation as well as SEO and social share platforms.\n   */\n  title?: string;\n\n  /**\n   * the template is used to bind to the layout\n   * configuration and css layout class\n   */\n  template?: string;\n\n  /**\n   * The page slots represent various sections on the page that\n   * can contain components.\n   */\n  slots: { [key: string]: CmsPageSlotConfig };\n}\n\n/**\n * The `CmsPageSlotsConfig` (plural) holds `CmsPageSlotConfig` objects.\n */\nexport interface CmsPageSlotsConfig {\n  [key: string]: CmsPageSlotConfig;\n}\n\n/**\n * The `CmsPageSlotConfig` is a simplified configuration model\n * that can be used to configure slots in static configuration,\n * rather than loading from a backend.\n */\nexport interface CmsPageSlotConfig {\n  componentIds?: string[];\n  properties?: any;\n}\n\n/**\n * The `CmsStructureConfig` is used to build pages in Spartacus by configuration\n * instead of using a backend CMS system. The configuration can be used to build\n * complete pages or parts of a page. The `CmsStructureConfig` is optimized to\n * only require the necessary properties. Adapter logic is applied to serialize\n * the `CmsStructureConfig` into the required UI model.\n */\nexport abstract class CmsStructureConfig extends CmsConfig {\n  cmsStructure: {\n    components?: { [key: string]: ContentSlotComponentData | any };\n    pages?: CmsPageConfig[];\n    slots?: CmsPageSlotsConfig;\n  };\n}\n","import { CmsConfig } from './cms-config';\n\nexport const defaultCmsModuleConfig: CmsConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        component: 'cms/components/${id}',\n        components: 'cms/components?fields=${fields}',\n        pages: 'cms/pages?fields=${fields}',\n        page: 'cms/pages/${id}?fields=${fields}',\n      },\n      legacy: false,\n    },\n  },\n};\n","import { Action } from '@ngrx/store';\n\nexport const ENTITY_REMOVE_ACTION = '[ENTITY] REMOVE';\nexport const ENTITY_REMOVE_ALL_ACTION = '[ENTITY] REMOVE ALL';\n\nexport interface EntityMeta {\n  entityType: string;\n  entityId: string | string[];\n  entityRemove?: boolean;\n}\n\nexport function entityMeta(type: string, id: string | string[]): EntityMeta {\n  return {\n    entityType: type,\n    entityId: id,\n  };\n}\n\nexport function entityRemoveMeta(\n  type: string,\n  id: string | string[]\n): EntityMeta {\n  return {\n    entityId: id,\n    entityType: type,\n    entityRemove: true,\n  };\n}\n\nexport function entityRemoveAllMeta(type: string): EntityMeta {\n  return {\n    entityId: null,\n    entityType: type,\n    entityRemove: true,\n  };\n}\n\nexport interface EntityAction extends Action {\n  readonly payload?: any;\n  readonly meta?: EntityMeta;\n}\n\nexport class EntityRemoveAction implements EntityAction {\n  type = ENTITY_REMOVE_ACTION;\n  readonly meta: EntityMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityRemoveMeta(entityType, id);\n  }\n}\n\nexport class EntityRemoveAllAction implements EntityAction {\n  type = ENTITY_REMOVE_ALL_ACTION;\n  readonly meta: EntityMeta;\n  constructor(entityType: string) {\n    this.meta = entityRemoveAllMeta(entityType);\n  }\n}\n","import { Action } from '@ngrx/store';\n\nimport { entityMeta, EntityMeta } from '../entity/entity.action';\nimport {\n  failMeta,\n  LoaderMeta,\n  loadMeta,\n  resetMeta,\n  successMeta,\n} from '../loader/loader.action';\n\nexport const ENTITY_LOAD_ACTION = '[ENTITY] LOAD';\nexport const ENTITY_FAIL_ACTION = '[ENTITY] LOAD FAIL';\nexport const ENTITY_SUCCESS_ACTION = '[ENTITY] LOAD SUCCESS';\nexport const ENTITY_RESET_ACTION = '[ENTITY] RESET';\n\nexport interface EntityLoaderMeta extends EntityMeta, LoaderMeta {}\n\nexport interface EntityLoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: EntityLoaderMeta;\n}\n\nexport function entityLoadMeta(\n  entityType: string,\n  id: string | string[]\n): EntityLoaderMeta {\n  return {\n    ...loadMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entityFailMeta(\n  entityType: string,\n  id: string | string[],\n  error?: any\n): EntityLoaderMeta {\n  return {\n    ...failMeta(entityType, error),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entitySuccessMeta(\n  entityType: string,\n  id: string | string[]\n): EntityLoaderMeta {\n  return {\n    ...successMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entityResetMeta(\n  entityType: string,\n  id: string | string[]\n): EntityLoaderMeta {\n  return {\n    ...resetMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport class EntityLoadAction implements EntityLoaderAction {\n  type = ENTITY_LOAD_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityLoadMeta(entityType, id);\n  }\n}\n\nexport class EntityFailAction implements EntityLoaderAction {\n  type = ENTITY_FAIL_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[], error?: any) {\n    this.meta = entityFailMeta(entityType, id, error);\n  }\n}\n\nexport class EntitySuccessAction implements EntityLoaderAction {\n  type = ENTITY_SUCCESS_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[], public payload?: any) {\n    this.meta = entitySuccessMeta(entityType, id);\n  }\n}\n\nexport class EntityResetAction implements EntityLoaderAction {\n  type = ENTITY_RESET_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityResetMeta(entityType, id);\n  }\n}\n","import { Action } from '@ngrx/store';\n\nimport { EntityState } from './entity-state';\nimport { EntityAction } from './entity.action';\n\nexport const initialEntityState: EntityState<any> = { entities: {} };\n\n/**\n * Higher order reducer for reusing reducer logic for multiple entities\n *\n * Utilizes entityId meta field to target entity by id in actions\n */\nexport function entityReducer<T>(\n  entityType: string,\n  reducer: (state: T, action: Action) => T\n) {\n  return (\n    state: EntityState<T> = initialEntityState,\n    action: EntityAction\n  ): EntityState<T> => {\n    let ids: string[];\n    let partitionPayload = false;\n    if (\n      action.meta &&\n      action.meta.entityType === entityType &&\n      action.meta.entityId !== undefined\n    ) {\n      ids = [].concat(action.meta.entityId);\n\n      // remove selected entities\n      if (action.meta.entityRemove) {\n        if (action.meta.entityId === null) {\n          return initialEntityState;\n        } else {\n          let removed = false;\n          const newEntities = Object.keys(state.entities).reduce((acc, cur) => {\n            if (ids.includes(cur)) {\n              removed = true;\n            } else {\n              acc[cur] = state.entities[cur];\n            }\n            return acc;\n          }, {});\n\n          return removed ? { entities: newEntities } : state;\n        }\n      }\n\n      partitionPayload =\n        Array.isArray(action.meta.entityId) && Array.isArray(action.payload);\n    } else {\n      ids = Object.keys(state.entities);\n    }\n\n    const entityUpdates: { [id: string]: T } = {};\n\n    for (let i = 0; i < ids.length; i++) {\n      const id = ids[i];\n      const subAction = partitionPayload\n        ? { ...action, payload: action.payload[i] }\n        : action;\n      const newState = reducer(state.entities[id], subAction);\n      if (newState) {\n        entityUpdates[id] = newState;\n      }\n    }\n\n    if (Object.keys(entityUpdates).length > 0) {\n      return {\n        ...state,\n        entities: { ...state.entities, ...entityUpdates },\n      };\n    }\n\n    return state;\n  };\n}\n","import { entityReducer } from '../entity/entity.reducer';\nimport { loaderReducer } from '../loader/loader.reducer';\nimport { LoaderAction } from '../loader/loader.action';\nimport { EntityLoaderState } from './entity-loader-state';\nimport { EntityLoaderAction } from './entity-loader.action';\n\n/**\n * Higher order reducer that wraps LoaderReducer and EntityReducer enhancing\n * single state reducer to support multiple entities with generic loading flags\n */\nexport function entityLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: LoaderAction) => T\n): (\n  state: EntityLoaderState<T>,\n  action: EntityLoaderAction\n) => EntityLoaderState<T> {\n  return entityReducer(entityType, loaderReducer(entityType, reducer));\n}\n","import { EntityLoaderState } from './entity-loader-state';\nimport { LoaderState } from '../loader/loader-state';\nimport { initialLoaderState } from '../loader/loader.reducer';\n\nexport function entityStateSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): LoaderState<T> {\n  return state.entities[id] || initialLoaderState;\n}\n\nexport function entityValueSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): T {\n  const entityState = entityStateSelector(state, id);\n  return entityState.value;\n}\n\nexport function entityLoadingSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityStateSelector(state, id);\n  return entityState.loading;\n}\n\nexport function entityErrorSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityStateSelector(state, id);\n  return entityState.error;\n}\n\nexport function entitySuccessSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityStateSelector(state, id);\n  return entityState.success;\n}\n","import {\n  EntityFailAction,\n  EntityLoadAction,\n  EntitySuccessAction,\n} from '../../../state';\nimport { Page } from '../../model/page.model';\nimport { PageContext } from '../../../routing/index';\n\nexport const LOAD_PAGE_DATA = '[Cms] Load Page Data';\nexport const LOAD_PAGE_DATA_FAIL = '[Cms] Load Page Data Fail';\nexport const LOAD_PAGE_DATA_SUCCESS = '[Cms] Load Page Data Success';\nexport const SET_PAGE_FAIL_INDEX = '[Cms] Set Page Fail Index';\n\nexport class LoadPageData extends EntityLoadAction {\n  readonly type = LOAD_PAGE_DATA;\n  constructor(public payload: PageContext) {\n    super(payload.type, payload.id);\n  }\n}\n\nexport class LoadPageDataFail extends EntityFailAction {\n  readonly type = LOAD_PAGE_DATA_FAIL;\n  constructor(pageContext: PageContext, error: any) {\n    super(pageContext.type, pageContext.id, error);\n  }\n}\n\nexport class SetPageFailIndex extends EntityFailAction {\n  readonly type = SET_PAGE_FAIL_INDEX;\n  constructor(pageContext: PageContext, public payload: string) {\n    super(pageContext.type, pageContext.id);\n  }\n}\n\nexport class LoadPageDataSuccess extends EntitySuccessAction {\n  readonly type = LOAD_PAGE_DATA_SUCCESS;\n  constructor(pageContext: PageContext, payload: Page) {\n    super(pageContext.type, pageContext.id, payload);\n  }\n}\n\n// action types\nexport type PageAction =\n  | LoadPageData\n  | LoadPageDataFail\n  | LoadPageDataSuccess\n  | SetPageFailIndex;\n","import { EntityState } from '../../state';\nimport { NodeItem } from '../model/node-item.model';\nimport { Page } from '../model/page.model';\nimport { EntityLoaderState } from '../../state/utils/entity-loader/entity-loader-state';\n\nexport const CMS_FEATURE = 'cms';\nexport const NAVIGATION_DETAIL_ENTITY = '[Cms] Navigation Entity';\nexport const COMPONENT_ENTITY = '[Cms[ Component Entity';\n\nexport interface StateWithCms {\n  [CMS_FEATURE]: CmsState;\n}\n\nexport type ComponentState = EntityLoaderState<any>;\n\nexport type IndexType = {\n  content: EntityLoaderState<string>;\n  product: EntityLoaderState<string>;\n  category: EntityLoaderState<string>;\n  catalog: EntityLoaderState<string>;\n};\n\nexport interface NavigationNodes {\n  [nodeId: string]: NodeItem;\n}\n\nexport interface PageState {\n  pageData: EntityState<Page>;\n  index: IndexType;\n}\n\nexport interface CmsState {\n  page: PageState;\n  component: ComponentState;\n  navigation: EntityLoaderState<NodeItem>;\n}\n","import { CmsComponent } from '../../../model/cms.model';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport { COMPONENT_ENTITY } from '../cms-state';\n\nexport const LOAD_COMPONENT = '[Cms] Load Component';\nexport const LOAD_COMPONENT_FAIL = '[Cms] Load Component Fail';\nexport const LOAD_COMPONENT_SUCCESS = '[Cms] Load Component Success';\nexport const GET_COMPONENET_FROM_PAGE = '[Cms] Get Component from Page';\n\nexport class LoadComponent extends EntityLoadAction {\n  readonly type = LOAD_COMPONENT;\n  constructor(public payload: string) {\n    super(COMPONENT_ENTITY, payload);\n  }\n}\n\nexport class LoadComponentFail extends EntityFailAction {\n  readonly type = LOAD_COMPONENT_FAIL;\n  constructor(uid: string, public payload: any) {\n    super(COMPONENT_ENTITY, uid, payload);\n  }\n}\n\nexport class LoadComponentSuccess<\n  T extends CmsComponent\n> extends EntitySuccessAction {\n  readonly type = LOAD_COMPONENT_SUCCESS;\n  constructor(public payload: T, uid?: string) {\n    super(COMPONENT_ENTITY, uid || payload.uid || '');\n  }\n}\n\nexport class GetComponentFromPage<\n  T extends CmsComponent\n> extends EntitySuccessAction {\n  readonly type = GET_COMPONENET_FROM_PAGE;\n  constructor(public payload: T[]) {\n    super(COMPONENT_ENTITY, payload.map(cmp => cmp.uid));\n  }\n}\n\n// action types\nexport type ComponentAction<T extends CmsComponent> =\n  | LoadComponent\n  | LoadComponentFail\n  | LoadComponentSuccess<T>\n  | GetComponentFromPage<T>;\n","import { NAVIGATION_DETAIL_ENTITY } from '../cms-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\n\nexport const LOAD_NAVIGATION_ITEMS = '[Cms] Load NavigationEntry items';\nexport const LOAD_NAVIGATION_ITEMS_FAIL =\n  '[Cms] Load NavigationEntry items Fail';\nexport const LOAD_NAVIGATION_ITEMS_SUCCESS =\n  '[Cms] Load NavigationEntry items Success';\n\nexport class LoadNavigationItems extends EntityLoadAction {\n  readonly type = LOAD_NAVIGATION_ITEMS;\n  constructor(public payload: { nodeId: string; items: any[] }) {\n    super(NAVIGATION_DETAIL_ENTITY, payload.nodeId);\n  }\n}\n\nexport class LoadNavigationItemsFail extends EntityFailAction {\n  readonly type = LOAD_NAVIGATION_ITEMS_FAIL;\n  constructor(nodeId: string, public payload: any) {\n    super(NAVIGATION_DETAIL_ENTITY, nodeId, payload);\n  }\n}\n\nexport class LoadNavigationItemsSuccess extends EntitySuccessAction {\n  readonly type = LOAD_NAVIGATION_ITEMS_SUCCESS;\n  constructor(public payload: { nodeId: string; components: any[] }) {\n    super(NAVIGATION_DETAIL_ENTITY, payload.nodeId);\n  }\n}\n\n// action types\nexport type NavigationEntryItemAction =\n  | LoadNavigationItems\n  | LoadNavigationItemsFail\n  | LoadNavigationItemsSuccess;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { CmsState, CMS_FEATURE, StateWithCms } from '../cms-state';\n\nexport const getCmsState: MemoizedSelector<\n  StateWithCms,\n  CmsState\n> = createFeatureSelector<CmsState>(CMS_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { entityStateSelector } from '../../../state/utils/entity-loader/entity-loader.selectors';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { loaderValueSelector } from '../../../state/utils/loader/loader.selectors';\nimport { CmsState, ComponentState, StateWithCms } from '../cms-state';\nimport { getCmsState } from './feature.selectors';\n\nconst getComponentEntitiesSelector = (state: ComponentState): any =>\n  Object.keys(state.entities).reduce((acc, cur) => {\n    acc[cur] = state.entities[cur].value;\n    return acc;\n  }, {});\n\nexport const getComponentState: MemoizedSelector<\n  StateWithCms,\n  ComponentState\n> = createSelector(\n  getCmsState,\n  (state: CmsState) => state.component\n);\n\nexport const getComponentEntities: MemoizedSelector<\n  StateWithCms,\n  { [id: string]: any }\n> = createSelector(\n  getComponentState,\n  getComponentEntitiesSelector\n);\n\nexport const componentStateSelectorFactory = (\n  uid: string\n): MemoizedSelector<StateWithCms, LoaderState<any>> => {\n  return createSelector(\n    getComponentState,\n    entities => {\n      // the whole component entities are emtpy\n      if (Object.keys(entities.entities).length === 0) {\n        return undefined;\n      } else {\n        return entityStateSelector(entities, uid);\n      }\n    }\n  );\n};\n\nexport const componentSelectorFactory = (\n  uid: string\n): MemoizedSelector<StateWithCms, any> => {\n  return createSelector(\n    componentStateSelectorFactory(uid),\n    state => {\n      if (state) {\n        return loaderValueSelector(state);\n      } else {\n        return undefined;\n      }\n    }\n  );\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\nimport { entityStateSelector } from '../../../state/utils/entity-loader/entity-loader.selectors';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { loaderValueSelector } from '../../../state/utils/loader/loader.selectors';\nimport { NodeItem } from '../../model/node-item.model';\nimport { CmsState, StateWithCms } from '../cms-state';\nimport { getCmsState } from './feature.selectors';\n\nexport const getNavigationEntryItemState: MemoizedSelector<\n  StateWithCms,\n  EntityLoaderState<NodeItem>\n> = createSelector(\n  getCmsState,\n  (state: CmsState) => state.navigation\n);\n\nexport const getSelectedNavigationEntryItemState = (\n  nodeId: string\n): MemoizedSelector<StateWithCms, LoaderState<NodeItem>> => {\n  return createSelector(\n    getNavigationEntryItemState,\n    nodes => entityStateSelector(nodes, nodeId)\n  );\n};\n\nexport const getNavigationEntryItems = (\n  nodeId: string\n): MemoizedSelector<StateWithCms, NodeItem> => {\n  return createSelector(\n    getSelectedNavigationEntryItemState(nodeId),\n    itemState => loaderValueSelector(itemState)\n  );\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { PageType } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing';\nimport {\n  EntityLoaderState,\n  entityStateSelector,\n  LoaderState,\n  loaderValueSelector,\n} from '../../../state';\nimport { ContentSlotData } from '../../model/content-slot-data.model';\nimport { Page } from '../../model/page.model';\nimport { CmsState, IndexType, PageState, StateWithCms } from '../cms-state';\nimport { getCmsState } from './feature.selectors';\n\nconst getPageEntitiesSelector = (state: PageState) => state.pageData.entities;\nconst getIndexByType = (\n  index: IndexType,\n  type: PageType\n): EntityLoaderState<string> => {\n  switch (type) {\n    case PageType.CONTENT_PAGE: {\n      return index.content;\n    }\n    case PageType.PRODUCT_PAGE: {\n      return index.product;\n    }\n    case PageType.CATEGORY_PAGE: {\n      return index.category;\n    }\n    case PageType.CATALOG_PAGE: {\n      return index.catalog;\n    }\n  }\n  return { entities: {} };\n};\n\nconst getPageComponentTypesSelector: (page: Page) => string[] = (\n  page: Page\n) => {\n  const componentTypes = new Set<string>();\n  if (page && page.slots) {\n    for (const slot of Object.keys(page.slots)) {\n      for (const component of page.slots[slot].components || []) {\n        componentTypes.add(component.flexType);\n      }\n    }\n  }\n  return Array.from(componentTypes);\n};\n\nexport const getPageState: MemoizedSelector<\n  StateWithCms,\n  PageState\n> = createSelector(\n  getCmsState,\n  (state: CmsState) => state.page\n);\n\nexport const getPageStateIndex: MemoizedSelector<\n  StateWithCms,\n  IndexType\n> = createSelector(\n  getPageState,\n  (page: PageState) => page.index\n);\n\nexport const getPageStateIndexEntityLoaderState = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, EntityLoaderState<string>> =>\n  createSelector(\n    getPageStateIndex,\n    (index: IndexType) => getIndexByType(index, pageContext.type)\n  );\n\nexport const getPageStateIndexLoaderState = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, LoaderState<string>> =>\n  createSelector(\n    getPageStateIndexEntityLoaderState(pageContext),\n    indexState => entityStateSelector(indexState, pageContext.id)\n  );\n\nexport const getPageStateIndexValue = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, string> =>\n  createSelector(\n    getPageStateIndexLoaderState(pageContext),\n    entity => loaderValueSelector<string>(entity)\n  );\n\nexport const getPageEntities: MemoizedSelector<\n  StateWithCms,\n  { [id: string]: Page }\n> = createSelector(\n  getPageState,\n  getPageEntitiesSelector\n);\n\nexport const getPageData = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, Page> =>\n  createSelector(\n    getPageEntities,\n    getPageStateIndexValue(pageContext),\n    (entities: { [id: string]: Page }, indexValue: string) =>\n      entities[indexValue]\n  );\n\nexport const getPageComponentTypes = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, string[]> =>\n  createSelector(\n    getPageData(pageContext),\n    pageData => getPageComponentTypesSelector(pageData)\n  );\n\nexport const getCurrentSlotSelectorFactory = (\n  pageContext: PageContext,\n  position: string\n): MemoizedSelector<StateWithCms, ContentSlotData> => {\n  return createSelector(\n    getPageData(pageContext),\n    entity => {\n      if (entity) {\n        return entity.slots[position] || { components: [] };\n      }\n    }\n  );\n};\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport {\n  catchError,\n  filter,\n  pluck,\n  shareReplay,\n  switchMap,\n  take,\n  tap,\n} from 'rxjs/operators';\nimport { CmsComponent } from '../../model/cms.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { PageContext } from '../../routing/models/page-context.model';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { ContentSlotData } from '../model/content-slot-data.model';\nimport { NodeItem } from '../model/node-item.model';\nimport { Page } from '../model/page.model';\nimport * as fromCmsActions from '../store/actions/index';\nimport { StateWithCms } from '../store/cms-state';\nimport { CmsSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CmsService {\n  private _launchInSmartEdit = false;\n\n  private components: {\n    [uid: string]: Observable<CmsComponent>;\n  } = {};\n\n  constructor(\n    protected store: Store<StateWithCms>,\n    protected routingService: RoutingService\n  ) {}\n\n  /**\n   * Set _launchInSmartEdit value\n   */\n  set launchInSmartEdit(value: boolean) {\n    this._launchInSmartEdit = value;\n  }\n\n  /**\n   * Whether the app launched in smart edit\n   */\n  isLaunchInSmartEdit(): boolean {\n    return this._launchInSmartEdit;\n  }\n\n  /**\n   * Get current CMS page data\n   */\n  getCurrentPage(): Observable<Page> {\n    return this.routingService\n      .getPageContext()\n      .pipe(\n        switchMap(pageContext =>\n          this.store.select(CmsSelectors.getPageData(pageContext))\n        )\n      );\n  }\n\n  /**\n   * Get CMS component data by uid\n   * @param uid : CMS componet uid\n   */\n  getComponentData<T extends CmsComponent>(uid: string): Observable<T> {\n    if (!this.components[uid]) {\n      this.components[uid] = combineLatest([\n        this.routingService.isNavigating(),\n        this.store.pipe(\n          select(CmsSelectors.componentStateSelectorFactory(uid))\n        ),\n      ]).pipe(\n        tap(([isNavigating, componentState]) => {\n          // componentState is undefined when the whole components entities are empty.\n          // In this case, we don't load component one by one, but extract component data from cms page\n          if (componentState !== undefined) {\n            const attemptedLoad =\n              componentState.loading ||\n              componentState.success ||\n              componentState.error;\n            if (!attemptedLoad && !isNavigating) {\n              this.store.dispatch(new fromCmsActions.LoadComponent(uid));\n            }\n          }\n        }),\n        pluck(1),\n        filter(componentState => componentState && componentState.success),\n        pluck('value'),\n        shareReplay({ bufferSize: 1, refCount: true })\n      );\n    }\n\n    return this.components[uid] as Observable<T>;\n  }\n\n  /**\n   * Given the position, get the content slot data\n   * @param position : content slot position\n   */\n  getContentSlot(position: string): Observable<ContentSlotData> {\n    return this.routingService.getPageContext().pipe(\n      switchMap(pageContext =>\n        this.store.pipe(\n          select(\n            CmsSelectors.getCurrentSlotSelectorFactory(pageContext, position)\n          ),\n          filter(Boolean)\n        )\n      )\n    );\n  }\n\n  /**\n   * Given navigation node uid, get items (with id and type) inside the navigation entries\n   * @param navigationNodeUid : uid of the navigation node\n   */\n  getNavigationEntryItems(navigationNodeUid: string): Observable<NodeItem> {\n    return this.store.pipe(\n      select(CmsSelectors.getNavigationEntryItems(navigationNodeUid))\n    );\n  }\n\n  /**\n   * Load navigation items data\n   * @param rootUid : the uid of the root navigation node\n   * @param itemList : list of items (with id and type)\n   */\n  loadNavigationItems(\n    rootUid: string,\n    itemList: { id: string; superType: string }[]\n  ): void {\n    this.store.dispatch(\n      new fromCmsActions.LoadNavigationItems({\n        nodeId: rootUid,\n        items: itemList,\n      })\n    );\n  }\n\n  /**\n   * Refresh the content of the latest cms page\n   */\n  refreshLatestPage(): void {\n    this.routingService\n      .getPageContext()\n      .pipe(take(1))\n      .subscribe(pageContext =>\n        this.store.dispatch(new fromCmsActions.LoadPageData(pageContext))\n      );\n  }\n\n  /**\n   * Refresh the cms page content by page Id\n   * @param pageId\n   */\n  refreshPageById(pageId: string): void {\n    const pageContext: PageContext = { id: pageId };\n    this.store.dispatch(new fromCmsActions.LoadPageData(pageContext));\n  }\n\n  /**\n   * Refresh cms component's content\n   * @param uid : component uid\n   */\n  refreshComponent(uid: string): void {\n    this.store.dispatch(new fromCmsActions.LoadComponent(uid));\n  }\n\n  /**\n   * Given pageContext, return the CMS page data\n   * @param pageContext\n   */\n  getPageState(pageContext: PageContext): Observable<Page> {\n    return this.store.pipe(select(CmsSelectors.getPageData(pageContext)));\n  }\n\n  /**\n   * Given pageContext, return the CMS page data\n   * @param pageContext\n   */\n  getPageComponentTypes(pageContext: PageContext): Observable<string[]> {\n    return this.store.pipe(\n      select(CmsSelectors.getPageComponentTypes(pageContext))\n    );\n  }\n\n  /**\n   * Given pageContext, return whether the CMS page data exists or not\n   * @param pageContext\n   */\n  hasPage(pageContext: PageContext, forceReload = false): Observable<boolean> {\n    return this.store.pipe(\n      select(CmsSelectors.getPageStateIndexLoaderState(pageContext)),\n      tap((entity: LoaderState<string>) => {\n        const attemptedLoad = entity.loading || entity.success || entity.error;\n        const shouldReload = forceReload && !entity.loading;\n        if (!attemptedLoad || shouldReload) {\n          this.store.dispatch(new fromCmsActions.LoadPageData(pageContext));\n          forceReload = false;\n        }\n      }),\n      filter(entity => {\n        if (!entity.hasOwnProperty('value')) {\n          // if we have incomplete state from srr failed load transfer state,\n          // we should wait for reload and actual value\n          return false;\n        }\n        return entity.success || (entity.error && !entity.loading);\n      }),\n      pluck('success'),\n      catchError(() => of(false))\n    );\n  }\n\n  getPageIndex(pageContext: PageContext): Observable<string> {\n    return this.store.pipe(\n      select(CmsSelectors.getPageStateIndexValue(pageContext))\n    );\n  }\n\n  setPageFailIndex(pageContext: PageContext, value: string): void {\n    this.store.dispatch(\n      new fromCmsActions.SetPageFailIndex(pageContext, value)\n    );\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Page, PageMeta } from '../model/page.model';\nimport { PageType } from '../../model/cms.model';\n\nexport abstract class PageMetaResolver {\n  pageType: PageType;\n  pageTemplate: string;\n\n  abstract resolve(): Observable<PageMeta>;\n\n  getScore(page: Page): number {\n    let score = 0;\n\n    if (this.pageType) {\n      score += page.type === this.pageType ? 1 : -1;\n    }\n    if (this.pageTemplate) {\n      score += page.template === this.pageTemplate ? 1 : -1;\n    }\n    return score;\n  }\n}\n","import { Injectable, Inject } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { switchMap, filter } from 'rxjs/operators';\nimport { Page, PageMeta } from '../model/page.model';\nimport { CmsService } from './cms.service';\nimport { PageMetaResolver } from '../page/page-meta.resolver';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class PageMetaService {\n  constructor(\n    @Inject(PageMetaResolver) protected resolvers: PageMetaResolver[],\n    protected cms: CmsService\n  ) {}\n\n  getMeta(): Observable<PageMeta> {\n    return this.cms.getCurrentPage().pipe(\n      filter(Boolean),\n      switchMap((page: Page) => {\n        const metaResolver = this.getMetaResolver(page);\n        if (metaResolver) {\n          return metaResolver.resolve();\n        } else {\n          // we do not have a page resolver\n          return of(null);\n        }\n      })\n    );\n  }\n\n  /**\n   * return the title resolver with the best match\n   * title resovers can by default match on PageType and page template\n   * but custom match comparisors can be implemented.\n   */\n  protected getMetaResolver(page: Page) {\n    const matchingResolvers = this.resolvers.filter(\n      resolver => resolver.getScore(page) > 0\n    );\n    matchingResolvers.sort(function(a, b) {\n      return b.getScore(page) - a.getScore(page);\n    });\n    return matchingResolvers[0];\n  }\n}\n","import { Observable } from 'rxjs';\n\nexport abstract class TranslationService {\n  /**\n   * Translates given key with options.\n   * If key is missing, it tries to load the chunk and emits a value when chunk is loaded.\n   * If key is missing after loaded chunk, a fallback value is emitted\n   *\n   * @param key translation key\n   * @param options values for interpolation in translation\n   * @param whitespaceUntilLoaded if true, immediately emits a non-breaking space\n   */\n  translate: (\n    key: string,\n    options?: any,\n    whitespaceUntilLoaded?: boolean\n  ) => Observable<string>;\n\n  /**\n   * Loads chunks with translations\n   *\n   * @param chunkNames array of chunk names to be loaded\n   */\n  loadChunks: (chunkNames: string | string[]) => Promise<any>;\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { CmsService } from '../facade/cms.service';\nimport { Page, PageMeta } from '../model/page.model';\nimport { PageMetaResolver } from './page-meta.resolver';\nimport { PageBreadcrumbResolver, PageTitleResolver } from './page.resolvers';\nimport { PageType } from '../../model/cms.model';\nimport { TranslationService } from '../../i18n/translation.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ContentPageMetaResolver extends PageMetaResolver\n  implements PageTitleResolver, PageBreadcrumbResolver {\n  constructor(\n    protected cms: CmsService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n  }\n\n  resolve(): Observable<PageMeta> {\n    return this.cms.getCurrentPage().pipe(\n      filter(Boolean),\n      switchMap(page =>\n        combineLatest([\n          this.resolveTitle(page),\n          this.resolveBreadcrumbLabel().pipe(\n            switchMap(label => this.resolveBreadcrumbs(page, label))\n          ),\n        ])\n      ),\n      map(([title, breadcrumbs]) => ({ title, breadcrumbs }))\n    );\n  }\n\n  resolveTitle(page: Page): Observable<string> {\n    return of(page.title);\n  }\n\n  resolveBreadcrumbLabel(): Observable<string> {\n    return this.translation.translate('common.home');\n  }\n\n  resolveBreadcrumbs(_page: Page, breadcrumbLabel: string): Observable<any[]> {\n    // as long as we do not have CMSX-8689 in place\n    // we need specific resolvers for nested pages\n    return of([{ label: breadcrumbLabel, link: '/' }]);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { PageMetaResolver } from './page-meta.resolver';\nimport { ContentPageMetaResolver } from './content-page-meta.resolver';\n\n@NgModule({\n  providers: [\n    {\n      provide: PageMetaResolver,\n      useExisting: ContentPageMetaResolver,\n      multi: true,\n    },\n  ],\n})\nexport class CmsPageTitleModule {}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { SemanticPathService } from './semantic-path.service';\nimport { UrlCommands } from './url-command';\n\n@Pipe({\n  name: 'cxUrl',\n})\nexport class UrlPipe implements PipeTransform {\n  constructor(private urlService: SemanticPathService) {}\n\n  transform(commands: UrlCommands): any[] {\n    return this.urlService.transform(commands);\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { UrlPipe } from './url.pipe';\n\n@NgModule({\n  imports: [CommonModule],\n  declarations: [UrlPipe],\n  exports: [UrlPipe],\n})\nexport class UrlModule {}\n","import {\n  UrlMatcher,\n  UrlMatchResult,\n  UrlSegment,\n  UrlSegmentGroup,\n  Route,\n} from '@angular/router';\nimport { Injectable } from '@angular/core';\n\n@Injectable({ providedIn: 'root' })\nexport class UrlMatcherFactoryService {\n  getFalsyUrlMatcher(): UrlMatcher {\n    return function falsyUrlMatcher(): null {\n      return null;\n    };\n  }\n\n  getMultiplePathsUrlMatcher(paths: string[]): UrlMatcher {\n    const self = this;\n\n    const matcher = function multiplePathsUrlMatcher(\n      segments: UrlSegment[],\n      segmentGroup: UrlSegmentGroup,\n      route: Route\n    ): UrlMatchResult | null {\n      for (let i = 0; i < paths.length; i++) {\n        const result = self.getPathUrlMatcher(paths[i])(\n          segments,\n          segmentGroup,\n          route\n        );\n        if (result) {\n          return result;\n        }\n      }\n      return null;\n    };\n    matcher.paths = paths; // property added for easier debugging of routes\n    return matcher;\n  }\n\n  // Similar to Angular's defaultUrlMatcher. The difference is that `path` comes from function's argument, not from `route.path`\n  private getPathUrlMatcher(path: string = ''): UrlMatcher {\n    return (\n      segments: UrlSegment[],\n      segmentGroup: UrlSegmentGroup,\n      route: Route\n    ): UrlMatchResult | null => {\n      const parts = path.split('/');\n\n      if (parts.length > segments.length) {\n        // The actual URL is shorter than the config, no match\n        return null;\n      }\n\n      if (\n        route.pathMatch === 'full' &&\n        (segmentGroup.hasChildren() || parts.length < segments.length)\n      ) {\n        // The config is longer than the actual URL but we are looking for a full match, return null\n        return null;\n      }\n\n      const posParams: { [key: string]: UrlSegment } = {};\n\n      // Check each config part against the actual URL\n      for (let index = 0; index < parts.length; index++) {\n        const part = parts[index];\n        const segment = segments[index];\n        const isParameter = part.startsWith(':');\n        if (isParameter) {\n          posParams[part.substring(1)] = segment;\n        } else if (part !== segment.path) {\n          // The actual URL part does not match the config, no match\n          return null;\n        }\n      }\n\n      return { consumed: segments.slice(0, parts.length), posParams };\n    };\n  }\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { Routes, Router, Route } from '@angular/router';\nimport { ServerConfig } from '../../config/server-config/server-config';\nimport { RoutingConfigService } from './routing-config.service';\nimport { UrlMatcherFactoryService } from './url-matcher-factory.service';\n\n@Injectable({ providedIn: 'root' })\nexport class ConfigurableRoutesService {\n  constructor(\n    private config: ServerConfig,\n    private injector: Injector,\n    private routingConfigService: RoutingConfigService,\n    private urlMatcherFactory: UrlMatcherFactoryService\n  ) {}\n\n  private initCalled = false; // guard not to call init() more than once\n\n  /**\n   * Configures all existing Routes in the Router\n   */\n  init(): void {\n    if (!this.initCalled) {\n      this.initCalled = true;\n      this.configureRouter();\n    }\n  }\n\n  private configureRouter() {\n    // Router could not be injected in constructor due to cyclic dependency with APP_INITIALIZER:\n    const router = this.injector.get(Router);\n\n    const configuredRoutes = this.configureRoutes(router.config);\n\n    router.resetConfig(configuredRoutes);\n  }\n\n  private configureRoutes(routes: Routes): Routes {\n    const result = [];\n    routes.forEach(route => {\n      const configuredRoute = this.configureRoute(route);\n\n      if (route.children && route.children.length) {\n        configuredRoute.children = this.configureRoutes(route.children);\n      }\n      result.push(configuredRoute);\n    });\n    return result;\n  }\n\n  private configureRoute(route: Route): Route {\n    if (this.getRouteName(route)) {\n      const paths = this.getConfiguredPaths(route);\n      switch (paths.length) {\n        case 0:\n          delete route.path;\n          return {\n            ...route,\n            matcher: this.urlMatcherFactory.getFalsyUrlMatcher(),\n          };\n\n        case 1:\n          delete route.matcher;\n          return { ...route, path: paths[0] };\n\n        default:\n          delete route.path;\n          return {\n            ...route,\n            matcher: this.urlMatcherFactory.getMultiplePathsUrlMatcher(paths),\n          };\n      }\n    }\n    return route; // if route doesn't have a name, just pass the original route\n  }\n\n  private getRouteName(route: Route): string {\n    return route.data && route.data.cxRoute;\n  }\n\n  private getConfiguredPaths(route: Route): string[] {\n    const routeName = this.getRouteName(route);\n    const routeConfig = this.routingConfigService.getRouteConfig(routeName);\n    if (routeConfig === undefined) {\n      this.warn(\n        `Could not configure the named route '${routeName}'`,\n        route,\n        `due to undefined key '${routeName}' in the routes config`\n      );\n      return [];\n    }\n    if (routeConfig && routeConfig.paths === undefined) {\n      this.warn(\n        `Could not configure the named route '${routeName}'`,\n        route,\n        `due to undefined 'paths' for the named route '${routeName}' in the routes config`\n      );\n      return [];\n    }\n\n    // routeConfig or routeConfig.paths can be null - which means switching off the route\n    return (routeConfig && routeConfig.paths) || [];\n  }\n\n  private warn(...args) {\n    if (!this.config.production) {\n      console.warn(...args);\n    }\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule, APP_INITIALIZER } from '@angular/core';\nimport { ConfigurableRoutesService } from './configurable-routes.service';\nimport { Config } from '../../config/config.module';\nimport { RoutingConfig } from './config/routing-config';\n\nexport function initConfigurableRoutes(\n  service: ConfigurableRoutesService\n): () => void {\n  const result = () => service.init(); // workaround for AOT compilation (see https://stackoverflow.com/a/51977115)\n  return result;\n}\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    {\n      provide: APP_INITIALIZER,\n      useFactory: initConfigurableRoutes,\n      deps: [ConfigurableRoutesService],\n      multi: true,\n    },\n    { provide: RoutingConfig, useExisting: Config },\n  ],\n})\nexport class ConfigurableRoutesModule {}\n","import { PageType } from '../../model/cms.model';\n\nexport class PageContext {\n  id: string;\n  type?: PageType;\n\n  constructor(id: string, type?: PageType) {\n    this.id = id;\n    this.type = type;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport {\n  RouterState,\n  RouterStateSerializer,\n  StoreRouterConnectingModule,\n} from '@ngrx/router-store';\nimport { StoreModule } from '@ngrx/store';\nimport { ConfigurableRoutesModule } from './configurable-routes/configurable-routes.module';\nimport { effects } from './store/effects/index';\nimport {\n  CustomSerializer,\n  reducerProvider,\n  reducerToken,\n} from './store/reducers/router.reducer';\nimport { ROUTING_FEATURE } from './store/routing-state';\n\n@NgModule({\n  imports: [\n    ConfigurableRoutesModule,\n    StoreModule.forFeature(ROUTING_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n    StoreRouterConnectingModule.forRoot({\n      routerState: RouterState.Minimal,\n      stateKey: ROUTING_FEATURE, // name of reducer key\n    }),\n  ],\n  providers: [\n    reducerProvider,\n    {\n      provide: RouterStateSerializer,\n      useClass: CustomSerializer,\n    },\n  ],\n})\nexport class RoutingModule {}\n","import { Observable } from 'rxjs';\nimport { PageContext } from '../../../routing/models/page-context.model';\nimport { CmsStructureModel } from '../../model/page.model';\n\n/**\n * Abstract class that can be used to implement custom loader logic\n * in order to load CMS structure from third-party CMS system.\n */\nexport abstract class CmsPageAdapter {\n  /**\n   * Abstract method must be used to load the page structure for a given `PageContext`.\n   * The page can be loaded from alternative sources, as long as the structure\n   * converts to the `CmsStructureModel`.\n   *\n   * @param pageContext The `PageContext` holding the page Id.\n   */\n  abstract load(pageContext: PageContext): Observable<CmsStructureModel>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport {\n  CmsPageConfig,\n  CmsPageSlotsConfig,\n  CmsStructureConfig,\n} from '../config/cms-structure.config';\nimport { ContentSlotComponentData } from '../model/content-slot-component-data.model';\nimport { CmsStructureModel } from '../model/page.model';\n\n/**\n * Service that provides access to CMS structure from a static\n * configuration or configuration file. This class uses static\n * configuration is designed in async fashion so that configurations\n * can be loaded from a file or stream.\n *\n * The intent of the `CmsStructureConfigService` however is to provide\n * fast loading pages and default cms structure for commodity commerce.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport abstract class CmsStructureConfigService {\n  constructor(protected cmsDataConfig: CmsStructureConfig) {}\n\n  /**\n   * Merge the cms structure to the pageStructure. The page structure\n   * can either hold complete page structures or global structures that\n   * might apply to all pages (such has header coponents).\n   */\n  mergePageStructure(\n    pageId: string,\n    pageStructure: CmsStructureModel\n  ): Observable<CmsStructureModel> {\n    return this.mergePage(pageId, pageStructure).pipe(\n      switchMap(page => this.mergeSlots(page))\n    );\n  }\n\n  /**\n   *\n   * Returns boolean observable to indicate whether the page should not be\n   * loaded from the backend. This is useful for pages which are comoditized\n   * and follow best practice.\n   *\n   * By default, configurable pages are driven by static configuration,\n   * in order to allow for fast loading pages (preventing network delays).\n   */\n  shouldIgnoreBackend(pageId: string): Observable<boolean> {\n    return this.getPageFromConfig(pageId).pipe(\n      map(page => !!page && !!page.ignoreBackend)\n    );\n  }\n\n  /**\n   * returns an Observable component data from the static configuration.\n   */\n  getComponentFromConfig(\n    componentId: string\n  ): Observable<ContentSlotComponentData | any> {\n    return of(this.getComponentById(componentId));\n  }\n\n  /**\n   * returns an Observable components data from the static configuration.\n   */\n  getComponentsFromConfig(\n    ids: string[]\n  ): Observable<ContentSlotComponentData[]> {\n    return of(ids.map(id => this.getComponentById(id)));\n  }\n\n  /**\n   * returns an observable with the `PageConfig`.\n   */\n  protected getPageFromConfig(pageId: string): Observable<CmsPageConfig> {\n    return of(\n      this.cmsDataConfig.cmsStructure && this.cmsDataConfig.cmsStructure.pages\n        ? this.cmsDataConfig.cmsStructure.pages.find(p => p.pageId === pageId)\n        : null\n    );\n  }\n\n  /**\n   * Merge page data from the configuration into the given structure, if any.\n   * If the given page structure is empty, a page is created and the page slots are\n   * are merged into the page.\n   */\n  protected mergePage(\n    pageId: string,\n    pageStructure: CmsStructureModel\n  ): Observable<CmsStructureModel> {\n    return this.getPageFromConfig(pageId).pipe(\n      switchMap(page => {\n        if (page) {\n          // serialize page data\n          if (!pageStructure.page) {\n            pageStructure.page = {\n              ...page,\n            };\n            pageStructure.page.slots = {};\n          }\n          if (!pageStructure.page.slots) {\n            pageStructure.page.slots = {};\n          }\n          return this.mergeSlots(pageStructure, page.slots);\n        } else {\n          return of(pageStructure);\n        }\n      })\n    );\n  }\n\n  /**\n   * Adds any pre-configured slots for pages that do not use them.\n   * If pages have a slot for the given position, the configiuration\n   * is ingored. Even if the slot does not have inner structure (such as\n   * components), so that the cms structure is able to override the (static)\n   * configuration.\n   */\n  protected mergeSlots(\n    pageStructure: CmsStructureModel,\n    slots?: CmsPageSlotsConfig\n  ): Observable<CmsStructureModel> {\n    // if no slots have been given, we use the global configured slots\n    if (\n      !slots &&\n      this.cmsDataConfig.cmsStructure &&\n      this.cmsDataConfig.cmsStructure.slots\n    ) {\n      slots = this.cmsDataConfig.cmsStructure.slots;\n    }\n\n    if (!slots) {\n      return of(pageStructure);\n    }\n\n    for (const position of Object.keys(slots)) {\n      if (!Object.keys(pageStructure.page.slots).includes(position)) {\n        // the global slot isn't yet part of the page structure\n        pageStructure.page.slots[position] = {};\n\n        for (const component of this.getComponentsByPosition(slots, position)) {\n          if (!pageStructure.page.slots[position].components) {\n            pageStructure.page.slots[position].components = [];\n          }\n          pageStructure.page.slots[position].components.push({\n            uid: component.uid,\n            flexType: component.flexType,\n            typeCode: component.typeCode,\n          });\n          if (!pageStructure.components) {\n            pageStructure.components = [];\n          }\n\n          pageStructure.components.push(component);\n        }\n      }\n    }\n\n    return of(pageStructure);\n  }\n\n  protected getComponentsByPosition(\n    slots: CmsPageSlotsConfig,\n    position: string\n  ): ContentSlotComponentData[] {\n    const components = [];\n    if (slots[position] && slots[position].componentIds) {\n      for (const componentId of slots[position].componentIds) {\n        if (\n          this.cmsDataConfig.cmsStructure &&\n          this.cmsDataConfig.cmsStructure.components\n        ) {\n          const component = this.cmsDataConfig.cmsStructure.components[\n            componentId\n          ];\n          if (component) {\n            components.push({ uid: componentId, ...component });\n          }\n        }\n      }\n    }\n    return components;\n  }\n\n  protected getComponentById(componentId: string): ContentSlotComponentData {\n    return this.cmsDataConfig.cmsStructure &&\n      this.cmsDataConfig.cmsStructure.components\n      ? this.cmsDataConfig.cmsStructure.components[componentId]\n      : undefined;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError, switchMap } from 'rxjs/operators';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { CmsPageAdapter } from './cms-page.adapter';\nimport { CmsStructureConfigService } from '../../services/cms-structure-config.service';\nimport { PageContext } from '../../../routing/models/page-context.model';\nimport { CmsStructureModel } from '../../model/page.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CmsPageConnector {\n  constructor(\n    protected cmsPageAdapter: CmsPageAdapter,\n    protected cmsStructureConfigService: CmsStructureConfigService\n  ) {}\n\n  /**\n   * Returns an observable with the page structure. The page structure is\n   * typically loaded from a backend, but can also be returned from static\n   * configuration (see `CmsStructureConfigService`).\n   */\n  get(pageContext: PageContext): Observable<CmsStructureModel> {\n    return this.cmsStructureConfigService\n      .shouldIgnoreBackend(pageContext.id)\n      .pipe(\n        switchMap(loadFromConfig => {\n          if (!loadFromConfig) {\n            return this.cmsPageAdapter.load(pageContext).pipe(\n              catchError(error => {\n                if (\n                  error instanceof HttpErrorResponse &&\n                  error.status === 400\n                ) {\n                  return of({});\n                } else {\n                  return throwError(error);\n                }\n              })\n            );\n          } else {\n            return of({});\n          }\n        }),\n        switchMap(page => this.mergeDefaultPageStructure(pageContext, page))\n      );\n  }\n\n  /**\n   *\n   * Merge default page structure inot the given `CmsStructureModel`.\n   * This is benefitial for a fast setup of the UI without necessary\n   * finegrained CMS setup.\n   */\n  private mergeDefaultPageStructure(\n    pageContext: PageContext,\n    pageStructure: CmsStructureModel\n  ): Observable<CmsStructureModel> {\n    return this.cmsStructureConfigService.mergePageStructure(\n      pageContext.id,\n      pageStructure\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport {\n  catchError,\n  filter,\n  groupBy,\n  map,\n  mergeMap,\n  switchMap,\n  take,\n} from 'rxjs/operators';\nimport { LOGIN, LOGOUT } from '../../../auth/store/actions/login-logout.action';\nimport { RoutingService } from '../../../routing/index';\nimport { LANGUAGE_CHANGE } from '../../../site-context/store/actions/languages.action';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CmsPageConnector } from '../../connectors/page/cms-page.connector';\nimport { CmsStructureModel } from '../../model/page.model';\nimport * as componentActions from '../actions/component.action';\nimport * as pageActions from '../actions/page.action';\n\n@Injectable()\nexport class PageEffects {\n  @Effect()\n  refreshPage$: Observable<Action> = this.actions$.pipe(\n    ofType(LANGUAGE_CHANGE, LOGOUT, LOGIN),\n    switchMap(_ =>\n      this.routingService.getRouterState().pipe(\n        take(1),\n        filter(\n          routerState =>\n            routerState &&\n            routerState.state &&\n            routerState.state.cmsRequired &&\n            !routerState.nextState\n        ),\n        map(routerState => routerState.state.context),\n        mergeMap(context => of(new pageActions.LoadPageData(context)))\n      )\n    )\n  );\n\n  @Effect()\n  loadPageData$: Observable<Action> = this.actions$.pipe(\n    ofType(pageActions.LOAD_PAGE_DATA),\n    map((action: pageActions.LoadPageData) => action.payload),\n    groupBy(pageContext => pageContext.type + pageContext.id),\n    mergeMap(group =>\n      group.pipe(\n        switchMap(pageContext =>\n          this.cmsPageConnector.get(pageContext).pipe(\n            mergeMap((cmsStructure: CmsStructureModel) => {\n              return [\n                new componentActions.GetComponentFromPage(\n                  cmsStructure.components\n                ),\n                new pageActions.LoadPageDataSuccess(\n                  pageContext,\n                  cmsStructure.page\n                ),\n              ];\n            }),\n            catchError(error =>\n              of(\n                new pageActions.LoadPageDataFail(\n                  pageContext,\n                  makeErrorSerializable(error)\n                )\n              )\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cmsPageConnector: CmsPageConnector,\n    private routingService: RoutingService\n  ) {}\n}\n","import { Observable } from 'rxjs';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing/models/page-context.model';\n\nexport abstract class CmsComponentAdapter {\n  /**\n   * Abstract method must be used to load the component for a given `id` and `PageContext`.\n   * The component can be loaded from alternative backend, as long as the structure\n   * converts to the `CmsStructureModel`.\n   *\n   * @param pageContext The `PageContext` holding the page Id.\n   */\n  abstract load<T extends CmsComponent>(\n    id: string,\n    pageContext: PageContext,\n    fields?: string\n  ): Observable<T>;\n\n  abstract findComponentsByIds(\n    ids: string[],\n    pageContext: PageContext\n  ): Observable<CmsComponent[]>;\n\n  abstract findComponentsByIdsLegacy(\n    ids: string[],\n    pageContext: PageContext\n  ): Observable<CmsComponent[]>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { OccConfig } from '../../../occ/config/occ-config';\nimport { PageContext } from '../../../routing/models/page-context.model';\nimport { CmsStructureConfigService } from '../../services/cms-structure-config.service';\nimport { CmsComponentAdapter } from './cms-component.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CmsComponentConnector {\n  constructor(\n    protected cmsStructureConfigService: CmsStructureConfigService,\n    protected adapter: CmsComponentAdapter,\n    protected config: OccConfig\n  ) {}\n\n  get<T extends CmsComponent>(\n    id: string,\n    pageContext: PageContext\n  ): Observable<T> {\n    return this.cmsStructureConfigService\n      .getComponentFromConfig(id)\n      .pipe(\n        switchMap(configuredComponent =>\n          configuredComponent\n            ? of(configuredComponent)\n            : this.adapter.load(id, pageContext)\n        )\n      );\n  }\n\n  getList(ids: string[], pageContext: PageContext): Observable<CmsComponent[]> {\n    return this.cmsStructureConfigService.getComponentsFromConfig(ids).pipe(\n      switchMap(configuredComponents => {\n        // check if we have some components that are not loaded from configuration\n        const missingIds = configuredComponents.reduce(\n          (acc, component, index) => {\n            if (component === undefined) {\n              acc.push(ids[index]);\n            }\n            return acc;\n          },\n          []\n        );\n\n        if (missingIds.length > 0) {\n          return (this.config.backend.occ.legacy\n            ? this.adapter.findComponentsByIdsLegacy(missingIds, pageContext)\n            : this.adapter.findComponentsByIds(missingIds, pageContext)\n          ).pipe(\n            map(loadedComponents => [\n              ...configuredComponents.filter(Boolean),\n              ...loadedComponents,\n            ])\n          );\n        } else {\n          return of(configuredComponents);\n        }\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport {\n  catchError,\n  filter,\n  groupBy,\n  map,\n  mergeMap,\n  switchMap,\n  take,\n} from 'rxjs/operators';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { RoutingService } from '../../../routing/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CmsComponentConnector } from '../../connectors/component/cms-component.connector';\nimport * as componentActions from '../actions/component.action';\n\n@Injectable()\nexport class ComponentEffects {\n  constructor(\n    private actions$: Actions,\n    private cmsComponentLoader: CmsComponentConnector,\n    private routingService: RoutingService\n  ) {}\n\n  @Effect()\n  loadComponent$: Observable<\n    | componentActions.LoadComponentSuccess<CmsComponent>\n    | componentActions.LoadComponentFail\n  > = this.actions$.pipe(\n    ofType(componentActions.LOAD_COMPONENT),\n    map((action: componentActions.LoadComponent) => action.payload),\n    groupBy(uid => uid),\n    mergeMap(group =>\n      group.pipe(\n        switchMap(uid =>\n          this.routingService.getRouterState().pipe(\n            filter(routerState => routerState !== undefined),\n            map(routerState => routerState.state.context),\n            take(1),\n            mergeMap(pageContext =>\n              this.cmsComponentLoader.get(uid, pageContext).pipe(\n                map(\n                  data => new componentActions.LoadComponentSuccess(data, uid)\n                ),\n                catchError(error =>\n                  of(\n                    new componentActions.LoadComponentFail(\n                      uid,\n                      makeErrorSerializable(error)\n                    )\n                  )\n                )\n              )\n            )\n          )\n        )\n      )\n    )\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, filter, map, mergeMap, take } from 'rxjs/operators';\nimport { RoutingService } from '../../../routing/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CmsComponentConnector } from '../../connectors/component/cms-component.connector';\nimport * as navigationItemActions from '../actions/navigation-entry-item.action';\n\n@Injectable()\nexport class NavigationEntryItemEffects {\n  @Effect()\n  loadNavigationItems$: Observable<\n    | navigationItemActions.LoadNavigationItemsSuccess\n    | navigationItemActions.LoadNavigationItemsFail\n  > = this.actions$.pipe(\n    ofType(navigationItemActions.LOAD_NAVIGATION_ITEMS),\n    map((action: navigationItemActions.LoadNavigationItems) => action.payload),\n    map(payload => {\n      return {\n        ids: this.getIdListByItemType(payload.items),\n        nodeId: payload.nodeId,\n      };\n    }),\n    mergeMap(data => {\n      if (data.ids.componentIds.length > 0) {\n        return this.routingService.getRouterState().pipe(\n          filter(routerState => routerState !== undefined),\n          map(routerState => routerState.state.context),\n          take(1),\n          mergeMap(pageContext =>\n            // download all items in one request\n            this.cmsComponentConnector\n              .getList(data.ids.componentIds, pageContext)\n              .pipe(\n                map(\n                  components =>\n                    new navigationItemActions.LoadNavigationItemsSuccess({\n                      nodeId: data.nodeId,\n                      components: components,\n                    })\n                ),\n                catchError(error =>\n                  of(\n                    new navigationItemActions.LoadNavigationItemsFail(\n                      data.nodeId,\n                      makeErrorSerializable(error)\n                    )\n                  )\n                )\n              )\n          )\n        );\n      } else if (data.ids.pageIds.length > 0) {\n        // TODO: future work\n        // dispatch action to load cms page one by one\n      } else if (data.ids.mediaIds.length > 0) {\n        // TODO: future work\n        // send request to get list of media\n      } else {\n        return of(\n          new navigationItemActions.LoadNavigationItemsFail(\n            data.nodeId,\n            'navigation nodes are empty'\n          )\n        );\n      }\n    })\n  );\n\n  // We only consider 3 item types: cms page, cms component, and media.\n  getIdListByItemType(\n    itemList: any[]\n  ): { pageIds: string[]; componentIds: string[]; mediaIds: string[] } {\n    const pageIds: string[] = [];\n    const componentIds: string[] = [];\n    const mediaIds: string[] = [];\n\n    itemList.forEach(item => {\n      if (item.superType === 'AbstractCMSComponent') {\n        componentIds.push(item.id);\n      } else if (item.superType === 'AbstractPage') {\n        pageIds.push(item.id);\n      } else if (item.superType === 'AbstractMedia') {\n        mediaIds.push(item.id);\n      }\n    });\n    return { pageIds: pageIds, componentIds: componentIds, mediaIds: mediaIds };\n  }\n\n  constructor(\n    private actions$: Actions,\n    private cmsComponentConnector: CmsComponentConnector,\n    private routingService: RoutingService\n  ) {}\n}\n","import { PageEffects } from './page.effect';\nimport { ComponentEffects } from './component.effect';\nimport { NavigationEntryItemEffects } from './navigation-entry-item.effect';\n\nexport const effects: any[] = [\n  PageEffects,\n  ComponentEffects,\n  NavigationEntryItemEffects,\n];\n\nexport * from './page.effect';\nexport * from './component.effect';\nexport * from './navigation-entry-item.effect';\n","import { NodeItem } from '../../model/node-item.model';\nimport * as fromNavigationItem from '../actions/navigation-entry-item.action';\n\nexport const initialState: NodeItem = undefined;\n\nexport function reducer(\n  state = initialState,\n  action: fromNavigationItem.NavigationEntryItemAction\n): NodeItem {\n  switch (action.type) {\n    case fromNavigationItem.LOAD_NAVIGATION_ITEMS_SUCCESS: {\n      if (action.payload.components) {\n        const components = action.payload.components;\n        const newItem: NodeItem = components.reduce(\n          (compItems: { [uid_type: string]: any }, component: any) => {\n            return {\n              ...compItems,\n              [`${component.uid}_AbstractCMSComponent`]: component,\n            };\n          },\n          {\n            ...{},\n          }\n        );\n\n        return {\n          ...state,\n          ...newItem,\n        };\n      }\n    }\n  }\n\n  return state;\n}\n","import * as fromAction from '../actions';\nimport { Page } from '../../model/page.model';\nimport { EntityState } from '../../../state/utils/entity/entity-state';\n\nexport const initialState: EntityState<Page> = { entities: {} };\n\nexport function reducer(\n  state = initialState,\n  action: fromAction.LoadPageDataSuccess\n): EntityState<Page> {\n  switch (action.type) {\n    case fromAction.LOAD_PAGE_DATA_SUCCESS: {\n      const page: Page = action.payload;\n      return { ...state, entities: { ...state.entities, [page.pageId]: page } };\n    }\n  }\n  return state;\n}\n","import * as fromAction from '../actions/page.action';\n\nexport const initialState = undefined;\n\nexport function reducer(\n  entityType: string\n): (\n  state: string,\n  action:\n    | fromAction.LoadPageDataSuccess\n    | fromAction.LoadPageDataFail\n    | fromAction.SetPageFailIndex\n) => string {\n  return (\n    state = initialState,\n    action:\n      | fromAction.LoadPageDataSuccess\n      | fromAction.LoadPageDataFail\n      | fromAction.SetPageFailIndex\n  ): string => {\n    if (action.meta && action.meta.entityType === entityType) {\n      switch (action.type) {\n        case fromAction.LOAD_PAGE_DATA_SUCCESS: {\n          return action.payload.pageId;\n        }\n\n        case fromAction.LOAD_PAGE_DATA_FAIL: {\n          return initialState;\n        }\n\n        case fromAction.SET_PAGE_FAIL_INDEX: {\n          return action.payload;\n        }\n      }\n    }\n    return state;\n  };\n}\n","import { InjectionToken, Provider } from '@angular/core';\n\nimport {\n  ActionReducer,\n  ActionReducerMap,\n  MetaReducer,\n  Action,\n  combineReducers,\n} from '@ngrx/store';\n\nimport {\n  CmsState,\n  COMPONENT_ENTITY,\n  NAVIGATION_DETAIL_ENTITY,\n  StateWithCms,\n} from '../cms-state';\nimport { NodeItem } from '../../model/node-item.model';\nimport { LOGIN, LOGOUT } from '../../../auth/store/actions/login-logout.action';\nimport { LANGUAGE_CHANGE } from '../../../site-context/store/actions/languages.action';\nimport { entityLoaderReducer } from '../../../state/utils/entity-loader/entity-loader.reducer';\n\nimport * as fromNavigation from './navigation-entry-item.reducer';\nimport * as fromPageReducer from './page-data.reducer';\nimport * as fromPageIndexReducer from './page-index.reducer';\nimport { PageType } from '../../../model/cms.model';\n\nexport function getReducers(): ActionReducerMap<CmsState> {\n  return {\n    page: combineReducers({\n      pageData: fromPageReducer.reducer,\n      index: combineReducers({\n        content: entityLoaderReducer<string>(\n          PageType.CONTENT_PAGE,\n          fromPageIndexReducer.reducer(PageType.CONTENT_PAGE)\n        ),\n        product: entityLoaderReducer<string>(\n          PageType.PRODUCT_PAGE,\n          fromPageIndexReducer.reducer(PageType.PRODUCT_PAGE)\n        ),\n        category: entityLoaderReducer<string>(\n          PageType.CATEGORY_PAGE,\n          fromPageIndexReducer.reducer(PageType.CATEGORY_PAGE)\n        ),\n        catalog: entityLoaderReducer<string>(\n          PageType.CATALOG_PAGE,\n          fromPageIndexReducer.reducer(PageType.CATALOG_PAGE)\n        ),\n      }),\n    }),\n    component: entityLoaderReducer(COMPONENT_ENTITY),\n    navigation: entityLoaderReducer<NodeItem>(\n      NAVIGATION_DETAIL_ENTITY,\n      fromNavigation.reducer\n    ),\n  };\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<CmsState>\n> = new InjectionToken<ActionReducerMap<CmsState>>('CmsReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearCmsState(\n  reducer: ActionReducer<StateWithCms, Action>\n): ActionReducer<StateWithCms, Action> {\n  return function(state, action) {\n    if (\n      action.type === LANGUAGE_CHANGE ||\n      action.type === LOGOUT ||\n      action.type === LOGIN\n    ) {\n      state = undefined;\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<StateWithCms>[] = [clearCmsState];\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { ConfigModule } from '../../config/config.module';\nimport {\n  StateConfig,\n  StateTransferType,\n} from '../../state/config/state-config';\nimport { StateModule } from '../../state/state.module';\nimport { CMS_FEATURE } from './cms-state';\nimport { effects } from './effects/index';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function cmsStoreConfigFactory(): StateConfig {\n  // if we want to reuse CMS_FEATURE const in config, we have to use factory instead of plain object\n  const config = {\n    state: {\n      ssrTransfer: {\n        keys: { [CMS_FEATURE]: StateTransferType.TRANSFER_STATE },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StateModule,\n    StoreModule.forFeature(CMS_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n    ConfigModule.withConfigFactory(cmsStoreConfigFactory),\n  ],\n  providers: [reducerProvider],\n})\nexport class CmsStoreModule {}\n","import { NgModule } from '@angular/core';\nimport { Config, ConfigModule } from '../config/index';\nimport { CmsStructureConfig } from './config/cms-structure.config';\nimport { CmsConfig, defaultCmsModuleConfig } from './config/index';\nimport { CmsService } from './facade/index';\nimport { CmsPageTitleModule } from './page/page.module';\nimport { CmsStoreModule } from './store/cms-store.module';\n\n@NgModule({\n  imports: [\n    CmsStoreModule,\n    ConfigModule.withConfig(defaultCmsModuleConfig),\n    CmsPageTitleModule,\n  ],\n  providers: [\n    CmsService,\n    { provide: CmsConfig, useExisting: Config },\n    { provide: CmsStructureConfig, useExisting: Config },\n  ],\n})\nexport class CmsModule {}\n","import { InjectionToken } from '@angular/core';\nimport { CmsStructureModel } from '../../model/page.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const CMS_PAGE_NORMALIZER = new InjectionToken<\n  Converter<any, CmsStructureModel>\n>('CmsPageNormalizer');\n","import { InjectionToken } from '@angular/core';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const CMS_COMPONENT_NORMALIZER = new InjectionToken<\n  Converter<any, CmsComponent>\n>('CmsComponentNormalizer');\n","import { CmsComponent } from '../../model/cms.model';\nimport { ContentSlotData } from './content-slot-data.model';\n\nexport interface Page {\n  pageId?: string;\n  name?: string;\n  type?: string;\n  title?: string;\n  template?: string;\n  loadTime?: number;\n  slots: { [key: string]: ContentSlotData };\n  properties?: any;\n}\n\n/**\n * Represents the cms structure for pages, slots and components.\n */\nexport interface CmsStructureModel {\n  page?: Page;\n  components?: CmsComponent[];\n}\n\n/**\n * Represents the page meta data that can be used\n * to resolve page data and seo related data.\n */\nexport interface PageMeta {\n  /**\n   * the page title is used for the page title tag which\n   * is visible in the browser navigation as well as in the\n   * Search Engine Result Page\n   */\n  title?: string;\n\n  /**\n   * the page heading is typically used in the UI\n   */\n  heading?: string;\n\n  /**\n   * the page description is used in the Search Engine Result Page\n   */\n  description?: string;\n\n  /**\n   * the robots information drives search engines to index the page and\n   * follow links in the page\n   */\n  robots?: PageRobotsMeta[];\n\n  /**\n   * image that can be added to the og:image metatag\n   */\n  image?: string;\n\n  /**\n   * the list of breadcrumbs that can be rendered in the page UI.\n   */\n  breadcrumbs?: any[];\n}\n\nexport enum PageRobotsMeta {\n  INDEX = 'INDEX',\n  NOINDEX = 'NOINDEX',\n  FOLLOW = 'FOLLOW',\n  NOFOLLOW = 'NOFOLLOW',\n}\n","import { Injectable, Renderer2 } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class DynamicAttributeService {\n  /**\n   * Add dynamic attributes to DOM. These attributes are extracted from the properties of cms items received from backend.\n   * There can by many different groups of properties, one of them is smaredit. But EC allows addons to create different groups.\n   * For example, personalization may add 'script' group etc.\n   * @param properties: properties in each cms item response data\n   * @param element: slot or cms component element\n   * @param renderer\n   */\n  addDynamicAttributes(\n    properties: any,\n    element: Element,\n    renderer: Renderer2\n  ): void {\n    if (properties) {\n      // check each group of properties, e.g. smartedit\n      Object.keys(properties).forEach(group => {\n        const name = 'data-' + group + '-';\n        const groupProps = properties[group];\n\n        // check each property in the group\n        Object.keys(groupProps).forEach(propName => {\n          const propValue = groupProps[propName];\n          if (propName === 'classes') {\n            const classes = propValue.split(' ');\n            classes.forEach(classItem => {\n              element.classList.add(classItem);\n            });\n          } else {\n            renderer.setAttribute(\n              element,\n              name +\n                propName\n                  .split(/(?=[A-Z])/)\n                  .join('-')\n                  .toLowerCase(),\n              propValue\n            );\n          }\n        });\n      });\n    }\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { CardType } from '../../../model/cart.model';\n\nexport const LOAD_CARD_TYPES = '[Checkout] Load Card Types';\nexport const LOAD_CARD_TYPES_FAIL = '[Checkout] Load Card Fail';\nexport const LOAD_CARD_TYPES_SUCCESS = '[Checkout] Load Card Success';\n\nexport class LoadCardTypes implements Action {\n  readonly type = LOAD_CARD_TYPES;\n  constructor() {}\n}\n\nexport class LoadCardTypesFail implements Action {\n  readonly type = LOAD_CARD_TYPES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadCardTypesSuccess implements Action {\n  readonly type = LOAD_CARD_TYPES_SUCCESS;\n  constructor(public payload: CardType[]) {}\n}\n\nexport type CardTypesAction =\n  | LoadCardTypes\n  | LoadCardTypesFail\n  | LoadCardTypesSuccess;\n","import { Action } from '@ngrx/store';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\nexport const VERIFY_ADDRESS = '[Checkout] Verify Address';\nexport const VERIFY_ADDRESS_FAIL = '[Checkout] Verify Address Fail';\nexport const VERIFY_ADDRESS_SUCCESS = '[Checkout] Verify Address Success';\n\nexport const CLEAR_ADDRESS_VERIFICATION_RESULTS =\n  '[Checkout] Clear Address Verification Results';\n\nexport class VerifyAddress implements Action {\n  readonly type = VERIFY_ADDRESS;\n  constructor(public payload: { userId: string; address: Address }) {}\n}\n\nexport class VerifyAddressFail implements Action {\n  readonly type = VERIFY_ADDRESS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class VerifyAddressSuccess implements Action {\n  readonly type = VERIFY_ADDRESS_SUCCESS;\n  constructor(public payload: AddressValidation) {}\n}\n\nexport class ClearAddressVerificationResults implements Action {\n  readonly type = CLEAR_ADDRESS_VERIFICATION_RESULTS;\n  constructor() {}\n}\n\nexport type AddressVerificationActions =\n  | VerifyAddress\n  | VerifyAddressFail\n  | VerifyAddressSuccess\n  | ClearAddressVerificationResults;\n","import { Action } from '@ngrx/store';\n\nexport const CHECKOUT_CLEAR_MISCS_DATA = '[Checkout] Clear Miscs Data';\n\nexport class CheckoutClearMiscsData implements Action {\n  readonly type = CHECKOUT_CLEAR_MISCS_DATA;\n}\n\nexport type CheckoutMiscsDataAction = CheckoutClearMiscsData;\n\nexport * from './checkout.action';\nexport * from './card-types.action';\nexport * from './address-verification.action';\n","import * as fromAction from '../actions/index';\nimport { AddressVerificationState } from '../checkout-state';\n\nexport const initialState: AddressVerificationState = {\n  results: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromAction.AddressVerificationActions\n): AddressVerificationState {\n  switch (action.type) {\n    case fromAction.VERIFY_ADDRESS_SUCCESS: {\n      const results = action.payload;\n\n      return {\n        ...state,\n        results,\n      };\n    }\n\n    case fromAction.VERIFY_ADDRESS_FAIL: {\n      return {\n        ...state,\n        results: 'FAIL',\n      };\n    }\n\n    case fromAction.CLEAR_ADDRESS_VERIFICATION_RESULTS: {\n      return {\n        ...state,\n        results: {},\n      };\n    }\n  }\n\n  return state;\n}\n\nexport const getAddressVerificationResults = (\n  state: AddressVerificationState\n) => state.results;\n","import {\n  createFeatureSelector,\n  createSelector,\n  MemoizedSelector,\n} from '@ngrx/store';\nimport { Address } from '../../../model/address.model';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { DeliveryMode, Order } from '../../../model/order.model';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderLoadingSelector,\n  loaderSuccessSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport {\n  CheckoutState,\n  CheckoutStepsState,\n  CHECKOUT_FEATURE,\n  StateWithCheckout,\n} from '../checkout-state';\n\nconst getDeliveryAddressSelector = (state: CheckoutStepsState) => state.address;\nconst getDeliveryModeSelector = (state: CheckoutStepsState) =>\n  state.deliveryMode;\nconst getPaymentDetailsSelector = (state: CheckoutStepsState) =>\n  state.paymentDetails;\nconst getOrderDetailsSelector = (state: CheckoutStepsState) =>\n  state.orderDetails;\n\nexport const getCheckoutState: MemoizedSelector<\n  StateWithCheckout,\n  CheckoutState\n> = createFeatureSelector<CheckoutState>(CHECKOUT_FEATURE);\n\nexport const getCheckoutStepsState: MemoizedSelector<\n  StateWithCheckout,\n  LoaderState<CheckoutStepsState>\n> = createSelector(\n  getCheckoutState,\n  (checkoutState: CheckoutState) => checkoutState.steps\n);\n\nexport const getCheckoutSteps: MemoizedSelector<\n  StateWithCheckout,\n  CheckoutStepsState\n> = createSelector(\n  getCheckoutStepsState,\n  state => loaderValueSelector(state)\n);\n\nexport const getDeliveryAddress: MemoizedSelector<\n  StateWithCheckout,\n  Address\n> = createSelector(\n  getCheckoutSteps,\n  getDeliveryAddressSelector\n);\n\nexport const getDeliveryMode: MemoizedSelector<\n  StateWithCheckout,\n  {\n    supported: { [code: string]: DeliveryMode };\n    selected: string;\n  }\n> = createSelector(\n  getCheckoutSteps,\n  getDeliveryModeSelector\n);\n\nexport const getSupportedDeliveryModes: MemoizedSelector<\n  StateWithCheckout,\n  DeliveryMode[]\n> = createSelector(\n  getDeliveryMode,\n  deliveryMode => {\n    return Object.keys(deliveryMode.supported).map(\n      code => deliveryMode.supported[code]\n    );\n  }\n);\n\nexport const getSelectedDeliveryModeCode: MemoizedSelector<\n  StateWithCheckout,\n  string\n> = createSelector(\n  getDeliveryMode,\n  deliveryMode => {\n    return deliveryMode.selected;\n  }\n);\n\nexport const getSelectedDeliveryMode: MemoizedSelector<\n  StateWithCheckout,\n  DeliveryMode\n> = createSelector(\n  getDeliveryMode,\n  deliveryMode => {\n    if (deliveryMode.selected !== '') {\n      if (Object.keys(deliveryMode.supported).length === 0) {\n        return null;\n      }\n      return deliveryMode.supported[deliveryMode.selected];\n    }\n  }\n);\n\nexport const getPaymentDetails: MemoizedSelector<\n  StateWithCheckout,\n  PaymentDetails\n> = createSelector(\n  getCheckoutSteps,\n  getPaymentDetailsSelector\n);\n\nexport const getCheckoutOrderDetails: MemoizedSelector<\n  StateWithCheckout,\n  Order\n> = createSelector(\n  getCheckoutSteps,\n  getOrderDetailsSelector\n);\n\nexport const getCheckoutDetailsLoaded: MemoizedSelector<\n  StateWithCheckout,\n  boolean\n> = createSelector(\n  getCheckoutStepsState,\n  state => loaderSuccessSelector(state) && !loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { AddressValidation } from '../../../model/address.model';\nimport {\n  AddressVerificationState,\n  CheckoutState,\n  StateWithCheckout,\n} from '../checkout-state';\nimport * as fromReducer from './../reducers/address-verification.reducer';\nimport { getCheckoutState } from './checkout.selectors';\n\nexport const getAddressVerificationResultsState: MemoizedSelector<\n  StateWithCheckout,\n  AddressVerificationState\n> = createSelector(\n  getCheckoutState,\n  (state: CheckoutState) => state.addressVerification\n);\n\nexport const getAddressVerificationResults: MemoizedSelector<\n  StateWithCheckout,\n  string | AddressValidation\n> = createSelector(\n  getAddressVerificationResultsState,\n  fromReducer.getAddressVerificationResults\n);\n","import { CardTypesState } from '../checkout-state';\nimport * as fromAction from '../actions/index';\nimport { CardType } from '../../../model/cart.model';\n\nexport const initialState: CardTypesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromAction.CardTypesAction | fromAction.CheckoutMiscsDataAction\n): CardTypesState {\n  switch (action.type) {\n    case fromAction.LOAD_CARD_TYPES_SUCCESS: {\n      const cardTypes: CardType[] = action.payload;\n      const entities = cardTypes.reduce(\n        (cardTypesEntities: { [code: string]: CardType }, name: CardType) => {\n          return {\n            ...cardTypesEntities,\n            [name.code]: name,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case fromAction.CHECKOUT_CLEAR_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n\nexport const getCardTypesEntites = (state: CardTypesState) => state.entities;\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { CardType } from '../../../model/cart.model';\nimport {\n  CardTypesState,\n  CheckoutState,\n  StateWithCheckout,\n} from '../checkout-state';\nimport * as fromReducer from './../reducers/card-types.reducer';\nimport { getCheckoutState } from './checkout.selectors';\n\nexport const getCardTypesState: MemoizedSelector<\n  StateWithCheckout,\n  CardTypesState\n> = createSelector(\n  getCheckoutState,\n  (state: CheckoutState) => state.cardTypes\n);\n\nexport const getCardTypesEntites: MemoizedSelector<\n  StateWithCheckout,\n  { [code: string]: CardType }\n> = createSelector(\n  getCardTypesState,\n  fromReducer.getCardTypesEntites\n);\n\nexport const getAllCardTypes: MemoizedSelector<\n  StateWithCheckout,\n  CardType[]\n> = createSelector(\n  getCardTypesEntites,\n  entites => {\n    return Object.keys(entites).map(code => entites[code]);\n  }\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport {\n  ANONYMOUS_USERID,\n  CartDataService,\n} from '../../cart/facade/cart-data.service';\nimport { Order } from '../../model/order.model';\nimport * as fromCheckoutActions from '../store/actions/index';\nimport { StateWithCheckout } from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class CheckoutService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout>,\n    protected cartData: CartDataService\n  ) {}\n\n  /**\n   * Places an order\n   */\n  placeOrder(): void {\n    if (this.actionAllowed()) {\n      this.checkoutStore.dispatch(\n        new fromCheckoutActions.PlaceOrder({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cartId,\n        })\n      );\n    }\n  }\n\n  /**\n   * Clear checkout data\n   */\n  clearCheckoutData(): void {\n    this.checkoutStore.dispatch(new fromCheckoutActions.ClearCheckoutData());\n  }\n\n  /**\n   * Clear checkout step\n   * @param stepNumber : the step number to be cleared\n   */\n  clearCheckoutStep(stepNumber: number): void {\n    this.checkoutStore.dispatch(\n      new fromCheckoutActions.ClearCheckoutStep(stepNumber)\n    );\n  }\n\n  loadCheckoutDetails(cartId: string) {\n    this.checkoutStore.dispatch(\n      new fromCheckoutActions.LoadCheckoutDetails({\n        userId: this.cartData.userId,\n        cartId,\n      })\n    );\n  }\n\n  getCheckoutDetailsLoaded(): Observable<boolean> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getCheckoutDetailsLoaded)\n    );\n  }\n\n  /**\n   * Get order details\n   */\n  getOrderDetails(): Observable<Order> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getCheckoutOrderDetails)\n    );\n  }\n\n  protected actionAllowed(): boolean {\n    return this.cartData.userId !== ANONYMOUS_USERID;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, shareReplay, tap } from 'rxjs/operators';\nimport {\n  ANONYMOUS_USERID,\n  CartDataService,\n} from '../../cart/facade/cart-data.service';\nimport { Address, AddressValidation } from '../../model/address.model';\nimport { DeliveryMode } from '../../model/order.model';\nimport * as fromCheckoutActions from '../store/actions/index';\nimport { StateWithCheckout } from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutDeliveryService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout>,\n    protected cartData: CartDataService\n  ) {}\n\n  /**\n   * Get supported delivery modes\n   */\n  getSupportedDeliveryModes(): Observable<DeliveryMode[]> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getSupportedDeliveryModes),\n      tap(deliveryModes => {\n        if (Object.keys(deliveryModes).length === 0) {\n          this.loadSupportedDeliveryModes();\n        }\n      }),\n      shareReplay({ bufferSize: 1, refCount: true })\n    );\n  }\n\n  /**\n   * Get selected delivery mode\n   */\n  getSelectedDeliveryMode(): Observable<DeliveryMode> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getSelectedDeliveryMode)\n    );\n  }\n\n  /**\n   * Get selected delivery mode code\n   */\n  getSelectedDeliveryModeCode(): Observable<string> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getSelectedDeliveryModeCode)\n    );\n  }\n\n  /**\n   * Get delivery address\n   */\n  getDeliveryAddress(): Observable<Address> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getDeliveryAddress)\n    );\n  }\n\n  /**\n   * Get address verification results\n   */\n  getAddressVerificationResults(): Observable<AddressValidation | string> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getAddressVerificationResults),\n      filter(results => Object.keys(results).length !== 0)\n    );\n  }\n\n  /**\n   * Create and set a delivery address using the address param\n   * @param address : the Address to be created and set\n   */\n  createAndSetAddress(address: Address): void {\n    if (this.actionAllowed()) {\n      this.checkoutStore.dispatch(\n        new fromCheckoutActions.AddDeliveryAddress({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cartId,\n          address: address,\n        })\n      );\n    }\n  }\n\n  /**\n   * Load supported delivery modes\n   */\n  loadSupportedDeliveryModes(): void {\n    if (this.actionAllowed()) {\n      this.checkoutStore.dispatch(\n        new fromCheckoutActions.LoadSupportedDeliveryModes({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cartId,\n        })\n      );\n    }\n  }\n\n  /**\n   * Set delivery mode\n   * @param mode : The delivery mode to be set\n   */\n  setDeliveryMode(mode: string): void {\n    if (this.actionAllowed()) {\n      this.checkoutStore.dispatch(\n        new fromCheckoutActions.SetDeliveryMode({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cartId,\n          selectedModeId: mode,\n        })\n      );\n    }\n  }\n\n  /**\n   * Verifies the address\n   * @param address : the address to be verified\n   */\n  verifyAddress(address: Address): void {\n    if (this.actionAllowed()) {\n      this.checkoutStore.dispatch(\n        new fromCheckoutActions.VerifyAddress({\n          userId: this.cartData.userId,\n          address,\n        })\n      );\n    }\n  }\n\n  /**\n   * Set delivery address\n   * @param address : The address to be set\n   */\n  setDeliveryAddress(address: Address): void {\n    if (this.actionAllowed()) {\n      this.checkoutStore.dispatch(\n        new fromCheckoutActions.SetDeliveryAddress({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cart.code,\n          address: address,\n        })\n      );\n    }\n  }\n\n  /**\n   * Clear address verification results\n   */\n  clearAddressVerificationResults(): void {\n    this.checkoutStore.dispatch(\n      new fromCheckoutActions.ClearAddressVerificationResults()\n    );\n  }\n\n  protected actionAllowed(): boolean {\n    return this.cartData.userId !== ANONYMOUS_USERID;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport {\n  ANONYMOUS_USERID,\n  CartDataService,\n} from '../../cart/facade/cart-data.service';\nimport { CardType, PaymentDetails } from '../../model/cart.model';\nimport * as fromCheckoutActions from '../store/actions/index';\nimport { StateWithCheckout } from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutPaymentService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout>,\n    protected cartData: CartDataService\n  ) {}\n\n  /**\n   * Get card types\n   */\n  getCardTypes(): Observable<CardType[]> {\n    return this.checkoutStore.pipe(select(CheckoutSelectors.getAllCardTypes));\n  }\n\n  /**\n   * Get payment details\n   */\n  getPaymentDetails(): Observable<PaymentDetails> {\n    return this.checkoutStore.pipe(select(CheckoutSelectors.getPaymentDetails));\n  }\n\n  /**\n   * Load the supported card types\n   */\n  loadSupportedCardTypes(): void {\n    this.checkoutStore.dispatch(new fromCheckoutActions.LoadCardTypes());\n  }\n\n  /**\n   * Create payment details using the given paymentDetails param\n   * @param paymentDetails: the PaymentDetails to be created\n   */\n  createPaymentDetails(paymentDetails: PaymentDetails): void {\n    if (this.actionAllowed()) {\n      this.checkoutStore.dispatch(\n        new fromCheckoutActions.CreatePaymentDetails({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cartId,\n          paymentDetails,\n        })\n      );\n    }\n  }\n\n  /**\n   * Set payment details\n   * @param paymentDetails : the PaymentDetails to be set\n   */\n  setPaymentDetails(paymentDetails: PaymentDetails): void {\n    if (this.actionAllowed()) {\n      this.checkoutStore.dispatch(\n        new fromCheckoutActions.SetPaymentDetails({\n          userId: this.cartData.userId,\n          cartId: this.cartData.cart.code,\n          paymentDetails: paymentDetails,\n        })\n      );\n    }\n  }\n\n  protected actionAllowed(): boolean {\n    return this.cartData.userId !== ANONYMOUS_USERID;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { Page, PageMeta, PageRobotsMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageRobotsResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { PageType } from '../../model/cms.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartPageMetaResolver extends PageMetaResolver\n  implements PageTitleResolver, PageRobotsResolver {\n  constructor(protected cms: CmsService) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'CartPageTemplate';\n  }\n\n  resolve(): Observable<PageMeta> {\n    return this.cms.getCurrentPage().pipe(\n      filter(page => page !== undefined),\n      switchMap(page =>\n        combineLatest([this.resolveTitle(page), this.resolveRobots()])\n      ),\n      map(([title, robots]) => ({ title, robots }))\n    );\n  }\n\n  resolveTitle(page: Page): Observable<string> {\n    return of(page.title);\n  }\n\n  resolveRobots(): Observable<PageRobotsMeta[]> {\n    return of([PageRobotsMeta.NOFOLLOW, PageRobotsMeta.NOINDEX]);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { CartService } from '../../cart/facade/cart.service';\nimport { PageMeta, PageRobotsMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageRobotsResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { Cart } from '../../model/cart.model';\nimport { PageType } from '../../model/cms.model';\nimport { TranslationService } from '../../i18n/translation.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutPageMetaResolver extends PageMetaResolver\n  implements PageTitleResolver, PageRobotsResolver {\n  constructor(\n    protected cartService: CartService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'MultiStepCheckoutSummaryPageTemplate';\n  }\n\n  resolve(): Observable<PageMeta> {\n    return this.cartService.getActive().pipe(\n      switchMap(cart =>\n        combineLatest([this.resolveTitle(cart), this.resolveRobots()])\n      ),\n      map(([title, robots]) => ({ title, robots }))\n    );\n  }\n\n  resolveTitle(cart: Cart): Observable<string> {\n    return this.translation.translate('pageMetaResolver.checkout.title', {\n      count: cart.totalItems,\n    });\n  }\n\n  resolveRobots(): Observable<PageRobotsMeta[]> {\n    return of([PageRobotsMeta.NOFOLLOW, PageRobotsMeta.NOINDEX]);\n  }\n}\n","import { CheckoutStepsState } from '../checkout-state';\nimport * as fromAction from './../actions/index';\nimport { DeliveryMode, Order } from '../../../model/order.model';\nimport { Address } from '../../../model/address.model';\n\nexport const initialState: CheckoutStepsState = {\n  address: {},\n  deliveryMode: {\n    supported: {},\n    selected: '',\n  },\n  paymentDetails: {},\n  orderDetails: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromAction.CheckoutAction | fromAction.CheckoutClearMiscsData\n): CheckoutStepsState {\n  switch (action.type) {\n    case fromAction.ADD_DELIVERY_ADDRESS_SUCCESS:\n    case fromAction.SET_DELIVERY_ADDRESS_SUCCESS: {\n      const address: Address = action.payload;\n\n      return {\n        ...state,\n        address,\n      };\n    }\n\n    case fromAction.LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS: {\n      const supportedModes = action.payload;\n      if (!supportedModes) {\n        return state;\n      }\n\n      const supported = supportedModes.reduce(\n        (modes: { [code: string]: DeliveryMode }, mode: DeliveryMode) => {\n          return {\n            ...modes,\n            [mode.code]: mode,\n          };\n        },\n        {\n          ...state.deliveryMode.supported,\n        }\n      );\n\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          supported,\n        },\n      };\n    }\n\n    case fromAction.SET_DELIVERY_MODE_SUCCESS: {\n      const selected = action.payload;\n\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          selected,\n        },\n      };\n    }\n\n    case fromAction.CREATE_PAYMENT_DETAILS_SUCCESS:\n    case fromAction.SET_PAYMENT_DETAILS_SUCCESS: {\n      return {\n        ...state,\n        paymentDetails: action.payload,\n      };\n    }\n\n    case fromAction.CREATE_PAYMENT_DETAILS_FAIL: {\n      const paymentDetails = action.payload;\n      if (paymentDetails['hasError']) {\n        return {\n          ...state,\n          paymentDetails,\n        };\n      }\n\n      return state;\n    }\n\n    case fromAction.PLACE_ORDER_SUCCESS: {\n      const orderDetails: Order = action.payload;\n\n      return {\n        ...state,\n        orderDetails,\n      };\n    }\n\n    case fromAction.CLEAR_CHECKOUT_DATA: {\n      return initialState;\n    }\n\n    case fromAction.CLEAR_CHECKOUT_STEP: {\n      const stepNumber = action.payload;\n      switch (stepNumber) {\n        case 1: {\n          return {\n            ...state,\n            address: {},\n          };\n        }\n\n        case 2: {\n          return {\n            ...state,\n            deliveryMode: {\n              ...state.deliveryMode,\n              supported: {},\n              selected: '',\n            },\n          };\n        }\n\n        case 3: {\n          return {\n            ...state,\n            paymentDetails: {},\n          };\n        }\n      }\n\n      return state;\n    }\n\n    case fromAction.CLEAR_SUPPORTED_DELIVERY_MODES:\n    case fromAction.CHECKOUT_CLEAR_MISCS_DATA: {\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          supported: {},\n        },\n      };\n    }\n    case fromAction.LOAD_CHECKOUT_DETAILS_SUCCESS: {\n      return {\n        ...state,\n        address: action.payload.deliveryAddress,\n        deliveryMode: {\n          ...state.deliveryMode,\n          selected:\n            action.payload.deliveryMode && action.payload.deliveryMode.code,\n        },\n        paymentDetails: action.payload.paymentInfo,\n      };\n    }\n  }\n\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\n\nimport { ActionReducerMap } from '@ngrx/store';\n\nimport {\n  CheckoutState,\n  CHECKOUT_DETAILS,\n  CheckoutStepsState,\n} from '../checkout-state';\n\nimport * as fromAddressVerification from './address-verification.reducer';\nimport * as fromCardTypes from './card-types.reducer';\nimport * as fromCheckout from './checkout.reducer';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\n\nexport function getReducers(): ActionReducerMap<CheckoutState> {\n  return {\n    steps: loaderReducer<CheckoutStepsState>(\n      CHECKOUT_DETAILS,\n      fromCheckout.reducer\n    ),\n    cardTypes: fromCardTypes.reducer,\n    addressVerification: fromAddressVerification.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<CheckoutState>\n> = new InjectionToken<ActionReducerMap<CheckoutState>>('CheckoutReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { Action } from '@ngrx/store';\n\nexport const LOAD_BILLING_COUNTRIES = '[User] Load Billing Countries';\nexport const LOAD_BILLING_COUNTRIES_FAIL = '[User] Load Billing Countries Fail';\nexport const LOAD_BILLING_COUNTRIES_SUCCESS =\n  '[User] Load Billing Countries Success';\n\nexport class LoadBillingCountries implements Action {\n  readonly type = LOAD_BILLING_COUNTRIES;\n  constructor() {}\n}\n\nexport class LoadBillingCountriesFail implements Action {\n  readonly type = LOAD_BILLING_COUNTRIES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadBillingCountriesSuccess implements Action {\n  readonly type = LOAD_BILLING_COUNTRIES_SUCCESS;\n  constructor(public payload: any) {}\n}\n\nexport type BillingCountriesAction =\n  | LoadBillingCountries\n  | LoadBillingCountriesFail\n  | LoadBillingCountriesSuccess;\n","import { Action } from '@ngrx/store';\nimport { Country } from '../../../model/address.model';\n\nexport const LOAD_DELIVERY_COUNTRIES = '[User] Load Delivery Countries';\nexport const LOAD_DELIVERY_COUNTRIES_FAIL =\n  '[User] Load Delivery Countries Fail';\nexport const LOAD_DELIVERY_COUNTRIES_SUCCESS =\n  '[User] Load Delivery Countries Success';\n\nexport class LoadDeliveryCountries implements Action {\n  readonly type = LOAD_DELIVERY_COUNTRIES;\n  constructor() {}\n}\n\nexport class LoadDeliveryCountriesFail implements Action {\n  readonly type = LOAD_DELIVERY_COUNTRIES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadDeliveryCountriesSuccess implements Action {\n  readonly type = LOAD_DELIVERY_COUNTRIES_SUCCESS;\n  constructor(public payload: Country[]) {}\n}\n\nexport type DeliveryCountriesAction =\n  | LoadDeliveryCountries\n  | LoadDeliveryCountriesFail\n  | LoadDeliveryCountriesSuccess;\n","import { Action } from '@ngrx/store';\n\nexport const FORGOT_PASSWORD_EMAIL_REQUEST =\n  '[User] Forgot Password Email Request';\nexport const FORGOT_PASSWORD_EMAIL_REQUEST_SUCCESS =\n  '[User] Forgot Password Email Request Success';\nexport const FORGOT_PASSWORD_EMAIL_REQUEST_FAIL =\n  '[User] Forgot Password Email Request Fail';\n\nexport class ForgotPasswordEmailRequest implements Action {\n  readonly type = FORGOT_PASSWORD_EMAIL_REQUEST;\n  constructor(public payload: string) {}\n}\n\nexport class ForgotPasswordEmailRequestFail implements Action {\n  readonly type = FORGOT_PASSWORD_EMAIL_REQUEST_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class ForgotPasswordEmailRequestSuccess implements Action {\n  readonly type = FORGOT_PASSWORD_EMAIL_REQUEST_SUCCESS;\n}\n\nexport type ForgotPasswordEmailRequestAction =\n  | ForgotPasswordEmailRequest\n  | ForgotPasswordEmailRequestFail\n  | ForgotPasswordEmailRequestSuccess;\n","import { Action } from '@ngrx/store';\nimport { Order } from '../../../model/order.model';\n\nexport const LOAD_ORDER_DETAILS = '[User] Load Order Details';\nexport const LOAD_ORDER_DETAILS_FAIL = '[User] Load Order Details Fail';\nexport const LOAD_ORDER_DETAILS_SUCCESS = '[User] Load Order Details Success';\nexport const CLEAR_ORDER_DETAILS = '[User] Clear Order Details';\n\nexport class LoadOrderDetails implements Action {\n  readonly type = LOAD_ORDER_DETAILS;\n  constructor(\n    public payload: {\n      userId: string;\n      orderCode: string;\n    }\n  ) {}\n}\n\nexport class LoadOrderDetailsFail implements Action {\n  readonly type = LOAD_ORDER_DETAILS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadOrderDetailsSuccess implements Action {\n  readonly type = LOAD_ORDER_DETAILS_SUCCESS;\n  constructor(public payload: Order) {}\n}\n\nexport class ClearOrderDetails implements Action {\n  readonly type = CLEAR_ORDER_DETAILS;\n}\n\nexport type OrderDetailsAction =\n  | LoadOrderDetails\n  | LoadOrderDetailsFail\n  | LoadOrderDetailsSuccess\n  | ClearOrderDetails;\n","import { Address, Country, Region } from '../../model/address.model';\nimport { PaymentDetails } from '../../model/cart.model';\nimport { Title, User } from '../../model/misc.model';\nimport { Order, OrderHistoryList } from '../../model/order.model';\nimport { LoaderState } from '../../state';\nimport { ConsentTemplate } from '../../model/consent.model';\n\nexport const USER_FEATURE = 'user';\nexport const UPDATE_EMAIL_PROCESS_ID = 'updateEmail';\nexport const UPDATE_PASSWORD_PROCESS_ID = 'updatePassword';\nexport const UPDATE_USER_DETAILS_PROCESS_ID = 'updateUserDetails';\nexport const REMOVE_USER_PROCESS_ID = 'removeUser';\nexport const GIVE_CONSENT_PROCESS_ID = 'giveConsent';\nexport const WITHDRAW_CONSENT_PROCESS_ID = 'withdrawConsent';\n\nexport const USER_CONSENTS = '[User] User Consents';\nexport const USER_PAYMENT_METHODS = '[User] User Payment Methods';\nexport const USER_ORDERS = '[User] User Orders';\nexport const USER_ADDRESSES = '[User] User Addresses';\nexport const REGIONS = '[User] Regions';\n\nexport interface StateWithUser {\n  [USER_FEATURE]: UserState;\n}\n\nexport interface UserState {\n  account: UserDetailsState;\n  addresses: LoaderState<Address[]>;\n  consents: LoaderState<ConsentTemplate[]>;\n  billingCountries: BillingCountriesState;\n  countries: DeliveryCountriesState;\n  payments: LoaderState<PaymentDetails[]>;\n  orders: LoaderState<OrderHistoryList>;\n  order: OrderDetailsState;\n  titles: TitlesState;\n  regions: LoaderState<RegionsState>;\n  resetPassword: boolean;\n}\n\nexport interface OrderDetailsState {\n  order: Order;\n}\n\nexport interface RegionsState {\n  entities: Region[];\n  country: string;\n}\n\nexport interface BillingCountryEntities {\n  [key: string]: Country;\n}\n\nexport interface BillingCountriesState {\n  entities: BillingCountryEntities;\n}\n\nexport interface DeliveryCountryEntities {\n  [key: string]: Country;\n}\n\nexport interface DeliveryCountriesState {\n  entities: DeliveryCountryEntities;\n}\n\nexport interface TitleEntities {\n  [key: string]: Title;\n}\n\nexport interface TitlesState {\n  entities: TitleEntities;\n}\n\nexport interface UserDetailsState {\n  details: User;\n}\n","import { USER_PAYMENT_METHODS } from '../user-state';\nimport {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { PaymentDetails } from '../../../model/cart.model';\n\nexport const LOAD_USER_PAYMENT_METHODS = '[User] Load User Payment Methods';\nexport const LOAD_USER_PAYMENT_METHODS_FAIL =\n  '[User] Load User Payment Methods Fail';\nexport const LOAD_USER_PAYMENT_METHODS_SUCCESS =\n  '[User] Load User Payment Methods Success';\n\nexport const SET_DEFAULT_USER_PAYMENT_METHOD =\n  '[User] Set Default User Payment Method';\nexport const SET_DEFAULT_USER_PAYMENT_METHOD_FAIL =\n  '[User] Set Default User Payment Method Fail';\nexport const SET_DEFAULT_USER_PAYMENT_METHOD_SUCCESS =\n  '[User] Set Default User Payment Method Success';\n\nexport const DELETE_USER_PAYMENT_METHOD = '[User] Delete User Payment Method';\nexport const DELETE_USER_PAYMENT_METHOD_FAIL =\n  '[User] Delete User Payment Method Fail';\nexport const DELETE_USER_PAYMENT_METHOD_SUCCESS =\n  '[User] Delete User  Payment Method Success';\n\nexport class LoadUserPaymentMethods extends LoaderLoadAction {\n  readonly type = LOAD_USER_PAYMENT_METHODS;\n  constructor(public payload: string) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class LoadUserPaymentMethodsFail extends LoaderFailAction {\n  readonly type = LOAD_USER_PAYMENT_METHODS_FAIL;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS, payload);\n  }\n}\n\nexport class LoadUserPaymentMethodsSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_USER_PAYMENT_METHODS_SUCCESS;\n  constructor(public payload: PaymentDetails[]) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class SetDefaultUserPaymentMethod extends LoaderLoadAction {\n  readonly type = SET_DEFAULT_USER_PAYMENT_METHOD;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class SetDefaultUserPaymentMethodFail extends LoaderFailAction {\n  readonly type = SET_DEFAULT_USER_PAYMENT_METHOD_FAIL;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS, payload);\n  }\n}\n\nexport class SetDefaultUserPaymentMethodSuccess extends LoaderSuccessAction {\n  readonly type = SET_DEFAULT_USER_PAYMENT_METHOD_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class DeleteUserPaymentMethod extends LoaderLoadAction {\n  readonly type = DELETE_USER_PAYMENT_METHOD;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class DeleteUserPaymentMethodFail extends LoaderFailAction {\n  readonly type = DELETE_USER_PAYMENT_METHOD_FAIL;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS, payload);\n  }\n}\n\nexport class DeleteUserPaymentMethodSuccess extends LoaderSuccessAction {\n  readonly type = DELETE_USER_PAYMENT_METHOD_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\n// action types\nexport type UserPaymentMethodsAction =\n  | LoadUserPaymentMethods\n  | LoadUserPaymentMethodsFail\n  | LoadUserPaymentMethodsSuccess\n  | SetDefaultUserPaymentMethod\n  | SetDefaultUserPaymentMethodFail\n  | SetDefaultUserPaymentMethodSuccess\n  | DeleteUserPaymentMethod\n  | DeleteUserPaymentMethodFail\n  | DeleteUserPaymentMethodSuccess;\n","import { Region } from '../../../model/address.model';\n\nimport {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { REGIONS } from '../user-state';\nimport { Action } from '@ngrx/store';\n\nexport const LOAD_REGIONS = '[User] Load Regions';\nexport const LOAD_REGIONS_SUCCESS = '[User] Load Regions Success';\nexport const LOAD_REGIONS_FAIL = '[User] Load Regions Fail';\nexport const CLEAR_REGIONS = '[User] Clear Regions';\n\nexport class LoadRegions extends LoaderLoadAction {\n  readonly type = LOAD_REGIONS;\n  constructor(public payload: string) {\n    super(REGIONS);\n  }\n}\n\nexport class LoadRegionsFail extends LoaderFailAction {\n  readonly type = LOAD_REGIONS_FAIL;\n  constructor(public payload: any) {\n    super(REGIONS, payload);\n  }\n}\n\nexport class LoadRegionsSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_REGIONS_SUCCESS;\n  constructor(public payload: { entities: Region[]; country: string }) {\n    super(REGIONS);\n  }\n}\n\nexport class ClearRegions implements Action {\n  readonly type = CLEAR_REGIONS;\n  constructor() {}\n}\n\nexport type RegionsAction =\n  | LoadRegions\n  | LoadRegionsFail\n  | LoadRegionsSuccess\n  | ClearRegions;\n","import { Action } from '@ngrx/store';\n\nexport const RESET_PASSWORD = '[User] Reset Password';\nexport const RESET_PASSWORD_SUCCESS = '[User] Reset Password Success';\nexport const RESET_PASSWORD_FAIL = '[User] Reset Password Fail';\n\nexport class ResetPassword implements Action {\n  readonly type = RESET_PASSWORD;\n  constructor(public payload: { token: string; password: string }) {}\n}\n\nexport class ResetPasswordFail implements Action {\n  readonly type = RESET_PASSWORD_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class ResetPasswordSuccess implements Action {\n  readonly type = RESET_PASSWORD_SUCCESS;\n}\n\nexport type ResetPasswordAction =\n  | ResetPassword\n  | ResetPasswordFail\n  | ResetPasswordSuccess;\n","import { Action } from '@ngrx/store';\nimport { Title } from '../../../model/misc.model';\n\nexport const LOAD_TITLES = '[User] Load Tiltes';\nexport const LOAD_TITLES_FAIL = '[User] Load Titles Fail';\nexport const LOAD_TITLES_SUCCESS = '[User] Load Titles Success';\n\nexport class LoadTitles implements Action {\n  readonly type = LOAD_TITLES;\n  constructor() {}\n}\n\nexport class LoadTitlesFail implements Action {\n  readonly type = LOAD_TITLES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadTitlesSuccess implements Action {\n  readonly type = LOAD_TITLES_SUCCESS;\n  constructor(public payload: Title[]) {}\n}\n\nexport type TitlesAction = LoadTitles | LoadTitlesFail | LoadTitlesSuccess;\n","import { EntityLoaderState } from '../../state/utils/entity-loader/entity-loader-state';\n\nexport const PROCESS_FEATURE = 'process';\n\nexport interface StateWithProcess<T> {\n  [PROCESS_FEATURE]: EntityLoaderState<T>;\n}\n","import { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityResetAction,\n  EntitySuccessAction,\n} from '../../../state';\nimport { UPDATE_EMAIL_PROCESS_ID } from '../user-state';\n\nexport const UPDATE_EMAIL = '[User] Update Email';\nexport const UPDATE_EMAIL_ERROR = '[User] Update Email Error';\nexport const UPDATE_EMAIL_SUCCESS = '[User] Update Email Success';\nexport const RESET_EMAIL = '[User] Reset Email';\n\nexport class UpdateEmailAction extends EntityLoadAction {\n  readonly type = UPDATE_EMAIL;\n  constructor(\n    public payload: {\n      uid: string;\n      password: string;\n      newUid: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID);\n  }\n}\n\nexport class UpdateEmailSuccessAction extends EntitySuccessAction {\n  readonly type = UPDATE_EMAIL_SUCCESS;\n  constructor(public newUid: string) {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID);\n  }\n}\n\nexport class UpdateEmailErrorAction extends EntityFailAction {\n  readonly type = UPDATE_EMAIL_ERROR;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID, payload);\n  }\n}\n\nexport class ResetUpdateEmailAction extends EntityResetAction {\n  readonly type = RESET_EMAIL;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID);\n  }\n}\n\nexport type EmailActions =\n  | UpdateEmailAction\n  | UpdateEmailSuccessAction\n  | UpdateEmailErrorAction\n  | ResetUpdateEmailAction;\n","import { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityResetAction,\n  EntitySuccessAction,\n} from '../../../state';\nimport { UPDATE_PASSWORD_PROCESS_ID } from '../user-state';\n\nexport const UPDATE_PASSWORD = '[User] Update Password';\nexport const UPDATE_PASSWORD_FAIL = '[User] Update Password Fail';\nexport const UPDATE_PASSWORD_SUCCESS = '[User] Update Password Success';\nexport const UPDATE_PASSWORD_RESET =\n  '[User] Reset Update Password Process State';\n\nexport class UpdatePassword extends EntityLoadAction {\n  readonly type = UPDATE_PASSWORD;\n  constructor(\n    public payload: { userId: string; oldPassword: string; newPassword: string }\n  ) {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID);\n  }\n}\n\nexport class UpdatePasswordFail extends EntityFailAction {\n  readonly type = UPDATE_PASSWORD_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID, payload);\n  }\n}\n\nexport class UpdatePasswordSuccess extends EntitySuccessAction {\n  readonly type = UPDATE_PASSWORD_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID);\n  }\n}\n\nexport class UpdatePasswordReset extends EntityResetAction {\n  readonly type = UPDATE_PASSWORD_RESET;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID);\n  }\n}\n\n// action types\nexport type UpdatePasswordAction =\n  | UpdatePassword\n  | UpdatePasswordFail\n  | UpdatePasswordSuccess\n  | UpdatePasswordReset;\n","import { USER_ADDRESSES } from '../user-state';\nimport {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { Address } from '../../../model/address.model';\n\nexport const LOAD_USER_ADDRESSES = '[User] Load User Addresses';\nexport const LOAD_USER_ADDRESSES_FAIL = '[User] Load User Addresses Fail';\nexport const LOAD_USER_ADDRESSES_SUCCESS = '[User] Load User Addresses Success';\n\nexport const ADD_USER_ADDRESS = '[User] Add User Address';\nexport const ADD_USER_ADDRESS_FAIL = '[User] Add User Address Fail';\nexport const ADD_USER_ADDRESS_SUCCESS = '[User] Add User Address Success';\n\nexport const UPDATE_USER_ADDRESS = '[User] Update User Address';\nexport const UPDATE_USER_ADDRESS_FAIL = '[User] Update User Address Fail';\nexport const UPDATE_USER_ADDRESS_SUCCESS = '[User] Update User Address Success';\n\nexport const DELETE_USER_ADDRESS = '[User] Delete User Address';\nexport const DELETE_USER_ADDRESS_FAIL = '[User] Delete User Address Fail';\nexport const DELETE_USER_ADDRESS_SUCCESS = '[User] Delete User Address Success';\n\nexport class LoadUserAddresses extends LoaderLoadAction {\n  readonly type = LOAD_USER_ADDRESSES;\n  constructor(public payload: string) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class LoadUserAddressesFail extends LoaderFailAction {\n  readonly type = LOAD_USER_ADDRESSES_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class LoadUserAddressesSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_USER_ADDRESSES_SUCCESS;\n  constructor(public payload: Address[]) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// Adding address actions\nexport class AddUserAddress extends LoaderLoadAction {\n  readonly type = ADD_USER_ADDRESS;\n  constructor(public payload: { userId: string; address: Address }) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class AddUserAddressFail extends LoaderFailAction {\n  readonly type = ADD_USER_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class AddUserAddressSuccess extends LoaderSuccessAction {\n  readonly type = ADD_USER_ADDRESS_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// Updating address actions\nexport class UpdateUserAddress extends LoaderLoadAction {\n  readonly type = UPDATE_USER_ADDRESS;\n  constructor(\n    public payload: { userId: string; addressId: string; address: Address }\n  ) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class UpdateUserAddressFail extends LoaderFailAction {\n  readonly type = UPDATE_USER_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class UpdateUserAddressSuccess extends LoaderSuccessAction {\n  readonly type = UPDATE_USER_ADDRESS_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// Deleting address actions\nexport class DeleteUserAddress extends LoaderLoadAction {\n  readonly type = DELETE_USER_ADDRESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class DeleteUserAddressFail extends LoaderFailAction {\n  readonly type = DELETE_USER_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class DeleteUserAddressSuccess extends LoaderSuccessAction {\n  readonly type = DELETE_USER_ADDRESS_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// action types\nexport type UserAddressesAction =\n  | LoadUserAddresses\n  | LoadUserAddressesFail\n  | LoadUserAddressesSuccess\n  | AddUserAddress\n  | AddUserAddressFail\n  | AddUserAddressSuccess\n  | UpdateUserAddress\n  | UpdateUserAddressFail\n  | UpdateUserAddressSuccess\n  | DeleteUserAddress\n  | DeleteUserAddressFail\n  | DeleteUserAddressSuccess;\n","import { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityResetAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport {\n  LoaderFailAction,\n  LoaderLoadAction,\n  LoaderResetAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport {\n  GIVE_CONSENT_PROCESS_ID,\n  USER_CONSENTS,\n  WITHDRAW_CONSENT_PROCESS_ID,\n} from '../user-state';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\nexport const LOAD_USER_CONSENTS = '[User] Load User Consents';\nexport const LOAD_USER_CONSENTS_SUCCESS = '[User] Load User Consents Success';\nexport const LOAD_USER_CONSENTS_FAIL = '[User] Load User Consents Fail';\nexport const RESET_LOAD_USER_CONSENTS = '[User] Reset Load User Consents';\n\nexport const GIVE_USER_CONSENT = '[User] Give User Consent';\nexport const GIVE_USER_CONSENT_FAIL = '[User] Give User Consent Fail';\nexport const GIVE_USER_CONSENT_SUCCESS = '[User] Give User Consent Success';\nexport const RESET_GIVE_USER_CONSENT_PROCESS =\n  '[User] Reset Give User Consent Process';\n\nexport const WITHDRAW_USER_CONSENT = '[User] Withdraw User Consent';\nexport const WITHDRAW_USER_CONSENT_FAIL = '[User] Withdraw User Consent Fail';\nexport const WITHDRAW_USER_CONSENT_SUCCESS =\n  '[User] Withdraw User Consent Success';\nexport const RESET_WITHDRAW_USER_CONSENT_PROCESS =\n  '[User] Reset Withdraw User Consent Process';\n\nexport class LoadUserConsents extends LoaderLoadAction {\n  readonly type = LOAD_USER_CONSENTS;\n  constructor(public payload: string) {\n    super(USER_CONSENTS);\n  }\n}\n\nexport class LoadUserConsentsFail extends LoaderFailAction {\n  readonly type = LOAD_USER_CONSENTS_FAIL;\n  constructor(public payload: any) {\n    super(USER_CONSENTS, payload);\n  }\n}\n\nexport class LoadUserConsentsSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_USER_CONSENTS_SUCCESS;\n  constructor(public payload: ConsentTemplate[]) {\n    super(USER_CONSENTS);\n  }\n}\n\nexport class ResetLoadUserConsents extends LoaderResetAction {\n  readonly type = RESET_LOAD_USER_CONSENTS;\n  constructor() {\n    super(USER_CONSENTS);\n  }\n}\n\nexport class GiveUserConsent extends EntityLoadAction {\n  readonly type = GIVE_USER_CONSENT;\n  constructor(\n    public payload: {\n      userId: string;\n      consentTemplateId: string;\n      consentTemplateVersion: number;\n    }\n  ) {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class GiveUserConsentFail extends EntityFailAction {\n  readonly type = GIVE_USER_CONSENT_FAIL;\n  constructor(payload: any) {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID, payload);\n  }\n}\n\nexport class GiveUserConsentSuccess extends EntitySuccessAction {\n  readonly type = GIVE_USER_CONSENT_SUCCESS;\n  constructor(public consentTemplate: ConsentTemplate) {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class ResetGiveUserConsentProcess extends EntityResetAction {\n  readonly type = RESET_GIVE_USER_CONSENT_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class WithdrawUserConsent extends EntityLoadAction {\n  readonly type = WITHDRAW_USER_CONSENT;\n  constructor(\n    public payload: {\n      userId: string;\n      consentCode: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class WithdrawUserConsentFail extends EntityFailAction {\n  readonly type = WITHDRAW_USER_CONSENT_FAIL;\n  constructor(payload: any) {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID, payload);\n  }\n}\n\nexport class WithdrawUserConsentSuccess extends EntitySuccessAction {\n  readonly type = WITHDRAW_USER_CONSENT_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class ResetWithdrawUserConsentProcess extends EntityResetAction {\n  readonly type = RESET_WITHDRAW_USER_CONSENT_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID);\n  }\n}\n\nexport type UserConsentsAction =\n  | LoadUserConsents\n  | LoadUserConsentsFail\n  | LoadUserConsentsSuccess\n  | ResetLoadUserConsents\n  | GiveUserConsent\n  | GiveUserConsentFail\n  | GiveUserConsentSuccess\n  | WithdrawUserConsent\n  | WithdrawUserConsentFail\n  | WithdrawUserConsentSuccess\n  | ResetWithdrawUserConsentProcess;\n","import { Action } from '@ngrx/store';\nimport { User } from '../../../model/misc.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityResetAction,\n  EntitySuccessAction,\n} from '../../../state';\nimport { UPDATE_USER_DETAILS_PROCESS_ID } from '../user-state';\n\nexport const LOAD_USER_DETAILS = '[User] Load User Details';\nexport const LOAD_USER_DETAILS_FAIL = '[User] Load User Details Fail';\nexport const LOAD_USER_DETAILS_SUCCESS = '[User] Load User Details Success';\n\nexport const UPDATE_USER_DETAILS = '[User] Update User Details';\nexport const UPDATE_USER_DETAILS_FAIL = '[User] Update User Details Fail';\nexport const UPDATE_USER_DETAILS_SUCCESS = '[User] Update User Details Success';\nexport const RESET_USER_DETAILS = '[User] Reset User Details';\n\nexport class LoadUserDetails implements Action {\n  readonly type = LOAD_USER_DETAILS;\n  constructor(public payload: string) {}\n}\n\nexport class LoadUserDetailsFail implements Action {\n  readonly type = LOAD_USER_DETAILS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadUserDetailsSuccess implements Action {\n  readonly type = LOAD_USER_DETAILS_SUCCESS;\n  constructor(public payload: User) {}\n}\n\nexport class UpdateUserDetails extends EntityLoadAction {\n  readonly type = UPDATE_USER_DETAILS;\n  constructor(public payload: { username: string; userDetails: User }) {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class UpdateUserDetailsFail extends EntityFailAction {\n  readonly type = UPDATE_USER_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID, payload);\n  }\n}\n\nexport class UpdateUserDetailsSuccess extends EntitySuccessAction {\n  readonly type = UPDATE_USER_DETAILS_SUCCESS;\n  constructor(public userUpdates: User) {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class ResetUpdateUserDetails extends EntityResetAction {\n  readonly type = RESET_USER_DETAILS;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID);\n  }\n}\n\n// action types\nexport type UserDetailsAction =\n  | LoadUserDetails\n  | LoadUserDetailsFail\n  | LoadUserDetailsSuccess\n  | UpdateUserDetails\n  | UpdateUserDetailsFail\n  | UpdateUserDetailsSuccess\n  | ResetUpdateUserDetails;\n","import { USER_ORDERS } from '../user-state';\nimport {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { OrderHistoryList } from '../../../model/order.model';\n\nexport const LOAD_USER_ORDERS = '[User] Load User Orders';\nexport const LOAD_USER_ORDERS_FAIL = '[User] Load User Orders Fail';\nexport const LOAD_USER_ORDERS_SUCCESS = '[User] Load User Orders Success';\nexport const CLEAR_USER_ORDERS = '[User] Clear User Orders';\n\nexport class LoadUserOrders extends LoaderLoadAction {\n  readonly type = LOAD_USER_ORDERS;\n  constructor(\n    public payload: {\n      userId: string;\n      pageSize: number;\n      currentPage?: number;\n      sort?: string;\n    }\n  ) {\n    super(USER_ORDERS);\n  }\n}\n\nexport class LoadUserOrdersFail extends LoaderFailAction {\n  readonly type = LOAD_USER_ORDERS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ORDERS, payload);\n  }\n}\n\nexport class LoadUserOrdersSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_USER_ORDERS_SUCCESS;\n  constructor(public payload: OrderHistoryList) {\n    super(USER_ORDERS);\n  }\n}\n\nexport class ClearUserOrders {\n  readonly type = CLEAR_USER_ORDERS;\n  constructor() {}\n}\n\nexport type UserOrdersAction =\n  | LoadUserOrders\n  | LoadUserOrdersFail\n  | LoadUserOrdersSuccess\n  | ClearUserOrders;\n","import { Action } from '@ngrx/store';\n\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityResetAction,\n  EntitySuccessAction,\n} from '../../../state';\nimport { REMOVE_USER_PROCESS_ID } from '../user-state';\nimport { UserSignUp } from '../../../model/misc.model';\n\nexport const REGISTER_USER = '[User] Register User';\nexport const REGISTER_USER_FAIL = '[User] Register User Fail';\nexport const REGISTER_USER_SUCCESS = '[User] Register User Success';\n\nexport const REMOVE_USER = '[User] Remove User';\nexport const REMOVE_USER_FAIL = '[User] Remove User Fail';\nexport const REMOVE_USER_SUCCESS = '[User] Remove User Success';\nexport const REMOVE_USER_RESET = '[User] Reset Remove User Process State';\n\nexport class RegisterUser implements Action {\n  readonly type = REGISTER_USER;\n  constructor(public payload: UserSignUp) {}\n}\n\nexport class RegisterUserFail implements Action {\n  readonly type = REGISTER_USER_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class RegisterUserSuccess implements Action {\n  readonly type = REGISTER_USER_SUCCESS;\n  constructor() {}\n}\n\nexport class RemoveUser extends EntityLoadAction {\n  readonly type = REMOVE_USER;\n  constructor(public payload: string) {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID);\n  }\n}\n\nexport class RemoveUserFail extends EntityFailAction {\n  readonly type = REMOVE_USER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID, payload);\n  }\n}\n\nexport class RemoveUserSuccess extends EntitySuccessAction {\n  readonly type = REMOVE_USER_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID);\n  }\n}\n\nexport class RemoveUserReset extends EntityResetAction {\n  readonly type = REMOVE_USER_RESET;\n  constructor() {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID);\n  }\n}\n\n// action types\nexport type UserRegisterOrRemoveAction =\n  | RegisterUser\n  | RegisterUserFail\n  | RegisterUserSuccess\n  | RemoveUser\n  | RemoveUserFail\n  | RemoveUserSuccess\n  | RemoveUserReset;\n","import { Action } from '@ngrx/store';\n\nexport const CLEAR_MISCS_DATA = '[User] Clear User Misc Data';\n\nexport class ClearMiscsData implements Action {\n  readonly type = CLEAR_MISCS_DATA;\n}\n\nexport * from './billing-countries.action';\nexport * from './delivery-countries.action';\nexport * from './forgot-password.action';\nexport * from './order-details.action';\nexport * from './payment-methods.action';\nexport * from './regions.action';\nexport * from './reset-password.action';\nexport * from './titles.action';\nexport * from './update-email.action';\nexport * from './update-password.action';\nexport * from './user-addresses.action';\nexport * from './user-consents.action';\nexport * from './user-details.action';\nexport * from './user-orders.action';\nexport * from './user-register.action';\n","import { Observable } from 'rxjs';\nimport { Order } from '../../../model/order.model';\nimport { CheckoutDetails } from '../../models/checkout.model';\n\nexport abstract class CheckoutAdapter {\n  /**\n   * Abstract method used to place an order.\n   *\n   * @param userId The `userId` for given user\n   * @param cartId The `cartId` for cart used for placing order\n   */\n  abstract placeOrder(userId: string, cartId: string): Observable<Order>;\n\n  /**\n   * Abstract method used to load checkout details\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract loadCheckoutDetails(\n    userId: string,\n    cartId: string\n  ): Observable<CheckoutDetails>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CheckoutAdapter } from './checkout.adapter';\nimport { Order } from '../../../model/order.model';\nimport { CheckoutDetails } from '../../models/checkout.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutConnector {\n  constructor(protected adapter: CheckoutAdapter) {}\n\n  public placeOrder(userId: string, cartId: string): Observable<Order> {\n    return this.adapter.placeOrder(userId, cartId);\n  }\n\n  public loadCheckoutDetails(\n    userId: string,\n    cartId: string\n  ): Observable<CheckoutDetails> {\n    return this.adapter.loadCheckoutDetails(userId, cartId);\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Address } from '../../../model/address.model';\nimport { DeliveryMode } from '../../../model/order.model';\n\nexport abstract class CheckoutDeliveryAdapter {\n  /**\n   * Abstract method used to create address in cart\n   *\n   * @param userId\n   * @param cartId\n   * @param address\n   */\n  abstract createAddress(\n    userId: string,\n    cartId: string,\n    address: Address\n  ): Observable<Address>;\n\n  /**\n   * Abstract method used to set adress for delivery\n   *\n   * @param userId\n   * @param cartId\n   * @param addressId\n   */\n  abstract setAddress(\n    userId: string,\n    cartId: string,\n    addressId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to set delivery mode on cart\n   *\n   * @param userId\n   * @param cartId\n   * @param deliveryModeId\n   */\n  abstract setMode(\n    userId: string,\n    cartId: string,\n    deliveryModeId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to get current delivery mode from cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract getMode(userId: string, cartId: string): Observable<DeliveryMode>;\n\n  /**\n   * Abstract method used to get supported delivery modes for cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract getSupportedModes(\n    userId: string,\n    cartId: string\n  ): Observable<DeliveryMode[]>;\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { CheckoutDeliveryAdapter } from './checkout-delivery.adapter';\nimport { Address } from '../../../model/address.model';\nimport { DeliveryMode } from '../../../model/order.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutDeliveryConnector {\n  constructor(protected adapter: CheckoutDeliveryAdapter) {}\n\n  public createAddress(\n    userId: string,\n    cartId: string,\n    address: Address\n  ): Observable<Address> {\n    return this.adapter.createAddress(userId, cartId, address);\n  }\n\n  public setAddress(\n    userId: string,\n    cartId: string,\n    addressId: string\n  ): Observable<any> {\n    return this.adapter.setAddress(userId, cartId, addressId);\n  }\n\n  public setMode(\n    userId: string,\n    cartId: string,\n    deliveryModeId: string\n  ): Observable<any> {\n    return this.adapter.setMode(userId, cartId, deliveryModeId);\n  }\n\n  public getMode(userId: string, cartId: string): Observable<DeliveryMode> {\n    return this.adapter.getMode(userId, cartId);\n  }\n\n  public getSupportedModes(\n    userId: string,\n    cartId: string\n  ): Observable<DeliveryMode[]> {\n    return this.adapter.getSupportedModes(userId, cartId);\n  }\n}\n","import { Observable } from 'rxjs';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\n\nexport abstract class CheckoutPaymentAdapter {\n  /**\n   * Abstract method used to create payment details on cart\n   *\n   * @param userId\n   * @param cartId\n   * @param paymentDetails\n   */\n  abstract create(\n    userId: string,\n    cartId: string,\n    paymentDetails: PaymentDetails\n  ): Observable<PaymentDetails>;\n\n  /**\n   * Abstract method used to set payment details on cart\n   *\n   * @param userId\n   * @param cartId\n   * @param paymentDetailsId\n   */\n  abstract set(\n    userId: string,\n    cartId: string,\n    paymentDetailsId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to get available cart types\n   */\n  abstract loadCardTypes(): Observable<CardType[]>;\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { CheckoutPaymentAdapter } from './checkout-payment.adapter';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutPaymentConnector {\n  constructor(protected adapter: CheckoutPaymentAdapter) {}\n\n  public create(\n    userId: string,\n    cartId: string,\n    paymentDetails: PaymentDetails\n  ): Observable<PaymentDetails> {\n    return this.adapter.create(userId, cartId, paymentDetails);\n  }\n\n  public set(\n    userId: string,\n    cartId: string,\n    paymentDetailsId: string\n  ): Observable<any> {\n    return this.adapter.set(userId, cartId, paymentDetailsId);\n  }\n\n  getCardTypes(): Observable<CardType[]> {\n    return this.adapter.loadCardTypes();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { CartActions } from '../../../cart/store/actions/index';\nimport { CheckoutDetails } from '../../../checkout/models/checkout.model';\nimport { AddMessage } from '../../../global-message/index';\nimport * as fromSiteContextActions from '../../../site-context/store/actions/index';\nimport * as fromUserActions from '../../../user/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CheckoutConnector } from '../../connectors/checkout/checkout.connector';\nimport { CheckoutDeliveryConnector } from '../../connectors/delivery/checkout-delivery.connector';\nimport { CheckoutPaymentConnector } from '../../connectors/payment/checkout-payment.connector';\nimport * as fromActions from '../actions/index';\n\n@Injectable()\nexport class CheckoutEffects {\n  @Effect()\n  addDeliveryAddress$: Observable<\n    | fromUserActions.LoadUserAddresses\n    | fromActions.SetDeliveryAddress\n    | fromActions.AddDeliveryAddressFail\n  > = this.actions$.pipe(\n    ofType(fromActions.ADD_DELIVERY_ADDRESS),\n    map((action: fromActions.AddDeliveryAddress) => action.payload),\n    mergeMap(payload =>\n      this.checkoutDeliveryConnector\n        .createAddress(payload.userId, payload.cartId, payload.address)\n        .pipe(\n          mergeMap(address => {\n            address['titleCode'] = payload.address.titleCode;\n            return [\n              new fromUserActions.LoadUserAddresses(payload.userId),\n              new fromActions.SetDeliveryAddress({\n                userId: payload.userId,\n                cartId: payload.cartId,\n                address: address,\n              }),\n            ];\n          }),\n          catchError(error =>\n            of(\n              new fromActions.AddDeliveryAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    )\n  );\n\n  @Effect()\n  setDeliveryAddress$: Observable<\n    | fromActions.SetDeliveryAddressSuccess\n    | fromActions.LoadSupportedDeliveryModes\n    | fromActions.SetDeliveryAddressFail\n  > = this.actions$.pipe(\n    ofType(fromActions.SET_DELIVERY_ADDRESS),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutDeliveryConnector\n        .setAddress(payload.userId, payload.cartId, payload.address.id)\n        .pipe(\n          mergeMap(() => [\n            new fromActions.SetDeliveryAddressSuccess(payload.address),\n            new fromActions.LoadSupportedDeliveryModes({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            }),\n          ]),\n          catchError(error =>\n            of(\n              new fromActions.SetDeliveryAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  loadSupportedDeliveryModes$: Observable<\n    | fromActions.LoadSupportedDeliveryModesSuccess\n    | fromActions.LoadSupportedDeliveryModesFail\n  > = this.actions$.pipe(\n    ofType(fromActions.LOAD_SUPPORTED_DELIVERY_MODES),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutDeliveryConnector\n        .getSupportedModes(payload.userId, payload.cartId)\n        .pipe(\n          map(data => {\n            return new fromActions.LoadSupportedDeliveryModesSuccess(data);\n          }),\n          catchError(error =>\n            of(\n              new fromActions.LoadSupportedDeliveryModesFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  clearCheckoutMiscsDataOnLanguageChange$: Observable<\n    fromActions.CheckoutClearMiscsData\n  > = this.actions$.pipe(\n    ofType(fromSiteContextActions.LANGUAGE_CHANGE),\n    map(() => new fromActions.CheckoutClearMiscsData())\n  );\n\n  @Effect()\n  clearDeliveryModesOnCurrencyChange$: Observable<\n    fromActions.ClearSupportedDeliveryModes\n  > = this.actions$.pipe(\n    ofType(fromSiteContextActions.CURRENCY_CHANGE),\n    map(() => new fromActions.ClearSupportedDeliveryModes())\n  );\n\n  @Effect()\n  clearCheckoutDataOnLogout$: Observable<\n    fromActions.ClearCheckoutData\n  > = this.actions$.pipe(\n    ofType(AuthActions.LOGOUT),\n    map(() => new fromActions.ClearCheckoutData())\n  );\n\n  @Effect()\n  setDeliveryMode$: Observable<\n    | fromActions.SetDeliveryModeSuccess\n    | fromActions.SetDeliveryModeFail\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(fromActions.SET_DELIVERY_MODE),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutDeliveryConnector\n        .setMode(payload.userId, payload.cartId, payload.selectedModeId)\n        .pipe(\n          mergeMap(() => {\n            return [\n              new fromActions.SetDeliveryModeSuccess(payload.selectedModeId),\n              new CartActions.LoadCart({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ];\n          }),\n          catchError(error =>\n            of(\n              new fromActions.SetDeliveryModeFail(makeErrorSerializable(error))\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  createPaymentDetails$: Observable<\n    | fromUserActions.LoadUserPaymentMethods\n    | fromActions.CreatePaymentDetailsSuccess\n    | fromActions.CreatePaymentDetailsFail\n  > = this.actions$.pipe(\n    ofType(fromActions.CREATE_PAYMENT_DETAILS),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      // get information for creating a subscription directly with payment provider\n      return this.checkoutPaymentConnector\n        .create(payload.userId, payload.cartId, payload.paymentDetails)\n        .pipe(\n          mergeMap(details => [\n            new fromUserActions.LoadUserPaymentMethods(payload.userId),\n            new fromActions.CreatePaymentDetailsSuccess(details),\n          ]),\n          catchError(error =>\n            of(\n              new fromActions.CreatePaymentDetailsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  setPaymentDetails$: Observable<\n    fromActions.SetPaymentDetailsSuccess | fromActions.SetPaymentDetailsFail\n  > = this.actions$.pipe(\n    ofType(fromActions.SET_PAYMENT_DETAILS),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutPaymentConnector\n        .set(payload.userId, payload.cartId, payload.paymentDetails.id)\n        .pipe(\n          map(\n            () =>\n              new fromActions.SetPaymentDetailsSuccess(payload.paymentDetails)\n          ),\n          catchError(error =>\n            of(\n              new fromActions.SetPaymentDetailsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  placeOrder$: Observable<\n    fromActions.PlaceOrderSuccess | AddMessage | fromActions.PlaceOrderFail\n  > = this.actions$.pipe(\n    ofType(fromActions.PLACE_ORDER),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutConnector\n        .placeOrder(payload.userId, payload.cartId)\n        .pipe(\n          switchMap(data => [new fromActions.PlaceOrderSuccess(data)]),\n          catchError(error =>\n            of(new fromActions.PlaceOrderFail(makeErrorSerializable(error)))\n          )\n        );\n    })\n  );\n\n  @Effect()\n  loadCheckoutDetails$: Observable<\n    fromActions.LoadCheckoutDetailsSuccess | fromActions.LoadCheckoutDetailsFail\n  > = this.actions$.pipe(\n    ofType(fromActions.LOAD_CHECKOUT_DETAILS),\n    map((action: fromActions.LoadCheckoutDetails) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutConnector\n        .loadCheckoutDetails(payload.userId, payload.cartId)\n        .pipe(\n          map(\n            (data: CheckoutDetails) =>\n              new fromActions.LoadCheckoutDetailsSuccess(data)\n          ),\n          catchError(error =>\n            of(\n              new fromActions.LoadCheckoutDetailsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  reloadDetailsOnMergeCart$: Observable<\n    fromActions.LoadCheckoutDetails\n  > = this.actions$.pipe(\n    ofType(CartActions.MERGE_CART_SUCCESS),\n    map((action: CartActions.MergeCartSuccess) => action.payload),\n    map(payload => {\n      return new fromActions.LoadCheckoutDetails({\n        userId: payload.userId,\n        cartId: payload.cartId ? payload.cartId : 'current',\n      });\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private checkoutDeliveryConnector: CheckoutDeliveryConnector,\n    private checkoutPaymentConnector: CheckoutPaymentConnector,\n    private checkoutConnector: CheckoutConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CheckoutPaymentConnector } from '../../connectors/payment/checkout-payment.connector';\nimport * as fromAction from '../actions/card-types.action';\n\n@Injectable()\nexport class CardTypesEffects {\n  @Effect()\n  loadCardTypes$: Observable<\n    fromAction.LoadCardTypesSuccess | fromAction.LoadCardTypesFail\n  > = this.actions$.pipe(\n    ofType(fromAction.LOAD_CARD_TYPES),\n    switchMap(() => {\n      return this.checkoutPaymentConnector.getCardTypes().pipe(\n        map(cardTypes => new fromAction.LoadCardTypesSuccess(cardTypes)),\n        catchError(error =>\n          of(new fromAction.LoadCardTypesFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private checkoutPaymentConnector: CheckoutPaymentConnector\n  ) {}\n}\n","import { Observable } from 'rxjs';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\nexport abstract class UserAddressAdapter {\n  abstract loadAll(userId: string): Observable<Address[]>;\n\n  abstract add(userId: string, address: Address): Observable<{}>;\n\n  abstract update(\n    userId: string,\n    addressId: string,\n    address: Address\n  ): Observable<{}>;\n\n  abstract verify(\n    userId: string,\n    address: Address\n  ): Observable<AddressValidation>;\n\n  abstract delete(userId: string, addressId: string): Observable<{}>;\n}\n","import { Injectable } from '@angular/core';\nimport { UserAddressAdapter } from './user-address.adapter';\nimport { Observable } from 'rxjs';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserAddressConnector {\n  constructor(protected adapter: UserAddressAdapter) {}\n\n  getAll(userId: string): Observable<Address[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  add(userId: string, address: Address): Observable<{}> {\n    return this.adapter.add(userId, address);\n  }\n\n  update(userId: string, addressId: string, address: Address): Observable<{}> {\n    return this.adapter.update(userId, addressId, address);\n  }\n\n  verify(userId: string, address: Address): Observable<AddressValidation> {\n    return this.adapter.verify(userId, address);\n  }\n\n  delete(userId: string, addressId: string): Observable<{}> {\n    return this.adapter.delete(userId, addressId);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { UserAddressConnector } from '../../../user/connectors/address/user-address.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport * as fromAction from '../actions/address-verification.action';\n\n@Injectable()\nexport class AddressVerificationEffect {\n  @Effect()\n  verifyAddress$: Observable<\n    fromAction.VerifyAddressSuccess | fromAction.VerifyAddressFail\n  > = this.actions$.pipe(\n    ofType<fromAction.VerifyAddress>(fromAction.VERIFY_ADDRESS),\n    map(action => action.payload),\n    mergeMap(payload =>\n      this.userAddressConnector.verify(payload.userId, payload.address).pipe(\n        map(data => new fromAction.VerifyAddressSuccess(data)),\n        catchError(error =>\n          of(new fromAction.VerifyAddressFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAddressConnector: UserAddressConnector\n  ) {}\n}\n","import { CheckoutEffects } from './checkout.effect';\nimport { CardTypesEffects } from './card-types.effect';\nimport { AddressVerificationEffect } from './address-verification.effect';\n\nexport const effects: any[] = [\n  CheckoutEffects,\n  AddressVerificationEffect,\n  CardTypesEffects,\n];\n\nexport * from './checkout.effect';\nexport * from './card-types.effect';\nexport * from './address-verification.effect';\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\n\nimport { StoreModule } from '@ngrx/store';\nimport { EffectsModule } from '@ngrx/effects';\n\nimport { reducerToken, reducerProvider } from './reducers/index';\nimport { effects } from './effects/index';\nimport { CHECKOUT_FEATURE } from './checkout-state';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StoreModule.forFeature(CHECKOUT_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [reducerProvider],\n})\nexport class CheckoutStoreModule {}\n","import { NgModule } from '@angular/core';\nimport { PageMetaResolver } from '../cms/index';\nimport { CheckoutService } from './facade/index';\nimport { CartPageMetaResolver } from './services/cart-page-meta.resolver';\nimport { CheckoutPageMetaResolver } from './services/checkout-page-meta.resolver';\nimport { CheckoutStoreModule } from './store/checkout-store.module';\n\n@NgModule({\n  imports: [CheckoutStoreModule],\n  providers: [\n    CheckoutService,\n    {\n      provide: PageMetaResolver,\n      useExisting: CartPageMetaResolver,\n      multi: true,\n    },\n    {\n      provide: PageMetaResolver,\n      useExisting: CheckoutPageMetaResolver,\n      multi: true,\n    },\n  ],\n})\nexport class CheckoutModule {}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Order } from '../../../model/order.model';\n\nexport const ORDER_NORMALIZER = new InjectionToken<Converter<any, Order>>(\n  'OrderNormalizer'\n);\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { DeliveryMode } from '../../../model/order.model';\n\nexport const DELIVERY_MODE_NORMALIZER = new InjectionToken<\n  Converter<any, DeliveryMode>\n>('DeliveryModeNormalizer');\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\n\nexport const PAYMENT_DETAILS_NORMALIZER = new InjectionToken<\n  Converter<any, PaymentDetails>\n>('PaymentDetailsNormalizer');\n\nexport const PAYMENT_DETAILS_SERIALIZER = new InjectionToken<\n  Converter<PaymentDetails, any>\n>('PaymentDetailsSerializer');\n\nexport const CARD_TYPE_NORMALIZER = new InjectionToken<\n  Converter<any, CardType>\n>('CardTypeNormalizer');\n","import { NgModule } from '@angular/core';\n\n@NgModule({})\nexport class CxApiModule {}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../util/converter.service';\nimport { Currency, Language } from '../../model/misc.model';\nimport { Country, Region } from '../../model/address.model';\n\nexport const LANGUAGE_NORMALIZER = new InjectionToken<Converter<any, Language>>(\n  'LanguageNormalizer'\n);\n\nexport const CURRENCY_NORMALIZER = new InjectionToken<Converter<any, Currency>>(\n  'CurrencyNormalizer'\n);\n\nexport const COUNTRY_NORMALIZER = new InjectionToken<Converter<any, Country>>(\n  'CountryNormalizer'\n);\n\nexport const REGION_NORMALIZER = new InjectionToken<Converter<any, Region>>(\n  'RegionNormalizer'\n);\n","import { APP_INITIALIZER, Provider } from '@angular/core';\nimport { LanguageService } from '../facade/language.service';\nimport { CurrencyService } from '../facade/currency.service';\nimport { OccConfig } from '../../occ/config/occ-config';\nimport { BaseSiteService } from '../facade/base-site.service';\nimport { SiteContextConfig } from '../config/site-context-config';\nimport { getContextParameterDefault } from '../config/context-config-utils';\nimport {\n  BASE_SITE_CONTEXT_ID,\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from './context-service-map';\n\nexport function inititializeContext(\n  config: SiteContextConfig,\n  baseSiteService: BaseSiteService,\n  langService: LanguageService,\n  currService: CurrencyService\n) {\n  return () => {\n    baseSiteService.initialize(\n      getContextParameterDefault(config, BASE_SITE_CONTEXT_ID)\n    );\n    langService.initialize(\n      getContextParameterDefault(config, LANGUAGE_CONTEXT_ID)\n    );\n    currService.initialize(\n      getContextParameterDefault(config, CURRENCY_CONTEXT_ID)\n    );\n  };\n}\n\nexport const contextServiceProviders: Provider[] = [\n  BaseSiteService,\n  LanguageService,\n  CurrencyService,\n  {\n    provide: APP_INITIALIZER,\n    useFactory: inititializeContext,\n    deps: [OccConfig, BaseSiteService, LanguageService, CurrencyService],\n    multi: true,\n  },\n];\n","import { Injectable, Injector } from '@angular/core';\nimport {\n  ContextParameter,\n  ContextPersistence,\n  SiteContextConfig,\n} from '../config/site-context-config';\nimport { SiteContext } from '../facade/site-context.interface';\nimport { ContextServiceMap } from '../providers/context-service-map';\nimport {\n  getContextParameter,\n  getContextParameterDefault,\n} from '../config/context-config-utils';\n\n@Injectable()\nexport class SiteContextParamsService {\n  constructor(\n    private config: SiteContextConfig,\n    private injector: Injector,\n    private serviceMap: ContextServiceMap\n  ) {}\n\n  getContextParameters(persistence?: ContextPersistence | string): string[] {\n    const contextConfig = this.config.context && this.config.context.parameters;\n    if (contextConfig) {\n      const params = Object.keys(contextConfig);\n      if (persistence) {\n        return params.filter(\n          key => contextConfig[key].persistence === persistence\n        );\n      } else {\n        return params;\n      }\n    }\n    return [];\n  }\n\n  getParameter(param: string): ContextParameter {\n    return getContextParameter(this.config, param);\n  }\n\n  getParamValues(param: string): string[] {\n    return this.getParameter(param).values || [];\n  }\n\n  getParamDefaultValue(param: string): string {\n    return getContextParameterDefault(this.config, param);\n  }\n\n  getSiteContextService(param: string): SiteContext<any> {\n    if (this.serviceMap[param]) {\n      return this.injector.get<SiteContext<any>>(this.serviceMap[param], null);\n    }\n  }\n\n  getValue(param: string): string {\n    let value: string;\n\n    const service = this.getSiteContextService(param);\n    if (service) {\n      service\n        .getActive()\n        .subscribe(val => (value = val))\n        .unsubscribe();\n    }\n\n    return value !== undefined ? value : this.getParamDefaultValue(param);\n  }\n\n  setValue(param: string, value: string) {\n    const service = this.getSiteContextService(param);\n    if (service) {\n      service.setActive(value);\n    }\n  }\n}\n","import { DefaultUrlSerializer, UrlTree } from '@angular/router';\nimport { Injectable } from '@angular/core';\nimport { SiteContextParamsService } from './site-context-params.service';\nimport { SiteContextConfig } from '../config/site-context-config';\n\nexport interface ParamValuesMap {\n  [name: string]: string;\n}\n\nexport interface UrlTreeWithSiteContext extends UrlTree {\n  siteContext?: ParamValuesMap;\n}\n\n@Injectable()\nexport class SiteContextUrlSerializer extends DefaultUrlSerializer {\n  private readonly urlEncodingParameters: string[];\n\n  get hasContextInRoutes() {\n    return this.urlEncodingParameters.length > 0;\n  }\n\n  constructor(\n    private siteContextParams: SiteContextParamsService,\n    private config: SiteContextConfig\n  ) {\n    super();\n    this.urlEncodingParameters =\n      (this.config.context && this.config.context.urlEncodingParameters) || [];\n  }\n\n  parse(url: string): UrlTreeWithSiteContext {\n    if (this.hasContextInRoutes) {\n      const urlWithParams = this.urlExtractContextParameters(url);\n      const parsed = super.parse(urlWithParams.url) as UrlTreeWithSiteContext;\n      this.urlTreeIncludeContextParameters(parsed, urlWithParams.params);\n      return parsed;\n    } else {\n      return super.parse(url);\n    }\n  }\n\n  urlExtractContextParameters(\n    url: string\n  ): { url: string; params: ParamValuesMap } {\n    const segments = url.split('/');\n    if (segments[0] === '') {\n      segments.shift();\n    }\n    const params = {};\n\n    let paramId = 0;\n    let segmentId = 0;\n    while (\n      paramId < this.urlEncodingParameters.length &&\n      segmentId < segments.length\n    ) {\n      const paramName = this.urlEncodingParameters[paramId];\n      const paramValues = this.siteContextParams.getParamValues(paramName);\n\n      if (paramValues.includes(segments[segmentId])) {\n        params[paramName] = segments[segmentId];\n        segmentId++;\n      }\n      paramId++;\n    }\n\n    url = segments.slice(Object.keys(params).length).join('/');\n    return { url, params };\n  }\n\n  private urlTreeIncludeContextParameters(\n    urlTree: UrlTreeWithSiteContext,\n    params: ParamValuesMap\n  ) {\n    urlTree.siteContext = params;\n  }\n\n  serialize(tree: UrlTreeWithSiteContext): string {\n    const params = this.urlTreeExtractContextParameters(tree);\n    const url = super.serialize(tree);\n    const serialized = this.urlIncludeContextParameters(url, params);\n    return serialized;\n  }\n\n  urlTreeExtractContextParameters(\n    urlTree: UrlTreeWithSiteContext\n  ): ParamValuesMap {\n    return urlTree.siteContext ? urlTree.siteContext : {};\n  }\n\n  private urlIncludeContextParameters(url: string, params: ParamValuesMap) {\n    const contextRoutePart = this.urlEncodingParameters\n      .map(param => {\n        return params[param]\n          ? params[param]\n          : this.siteContextParams.getValue(param);\n      })\n      .join('/');\n\n    return contextRoutePart + url;\n  }\n}\n","import { Injectable, Injector, OnDestroy } from '@angular/core';\nimport { Location } from '@angular/common';\nimport {\n  NavigationCancel,\n  NavigationEnd,\n  NavigationError,\n  NavigationStart,\n  Router,\n  RouterEvent,\n} from '@angular/router';\nimport { filter } from 'rxjs/operators';\nimport { SiteContextParamsService } from './site-context-params.service';\nimport { Subscription } from 'rxjs';\nimport { SiteContextUrlSerializer } from './site-context-url-serializer';\nimport { ContextPersistence } from '../config/site-context-config';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SiteContextRoutesHandler implements OnDestroy {\n  constructor(\n    private siteContextParams: SiteContextParamsService,\n    private serializer: SiteContextUrlSerializer,\n    private injector: Injector\n  ) {}\n\n  private subscription = new Subscription();\n\n  private contextValues: {\n    [param: string]: string;\n  } = {};\n\n  private router: Router;\n  private location: Location;\n  private isNavigating = false;\n\n  init() {\n    this.router = this.injector.get<Router>(Router);\n\n    this.location = this.injector.get<Location>(Location);\n    const routingParams = this.siteContextParams.getContextParameters(\n      ContextPersistence.ROUTE\n    );\n\n    if (routingParams.length) {\n      this.setContextParamsFromRoute(this.router.url);\n      this.subscribeChanges(routingParams);\n      this.subscribeRouting();\n    }\n  }\n\n  private subscribeChanges(params: string[]) {\n    params.forEach(param => {\n      const service = this.siteContextParams.getSiteContextService(param);\n      if (service) {\n        this.subscription.add(\n          service.getActive().subscribe(value => {\n            if (\n              !this.isNavigating &&\n              this.contextValues[param] &&\n              this.contextValues[param] !== value\n            ) {\n              const parsed = this.router.parseUrl(this.router.url);\n              const serialized = this.router.serializeUrl(parsed);\n              this.location.replaceState(serialized);\n            }\n            this.contextValues[param] = value;\n          })\n        );\n      }\n    });\n  }\n\n  private subscribeRouting() {\n    this.subscription.add(\n      this.router.events\n        .pipe(\n          filter(\n            event =>\n              event instanceof NavigationStart ||\n              event instanceof NavigationEnd ||\n              event instanceof NavigationError ||\n              event instanceof NavigationCancel\n          )\n        )\n        .subscribe((event: RouterEvent) => {\n          this.isNavigating = event instanceof NavigationStart;\n          if (this.isNavigating) {\n            this.setContextParamsFromRoute(event.url);\n          }\n        })\n    );\n  }\n\n  private setContextParamsFromRoute(url: string) {\n    const { params } = this.serializer.urlExtractContextParameters(url);\n    Object.keys(params).forEach(param =>\n      this.siteContextParams.setValue(param, params[param])\n    );\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n}\n","import { APP_INITIALIZER, Provider } from '@angular/core';\nimport { SiteContextParamsService } from '../services/site-context-params.service';\nimport { UrlSerializer } from '@angular/router';\nimport { SiteContextUrlSerializer } from '../services/site-context-url-serializer';\nimport { SiteContextRoutesHandler } from '../services/site-context-routes-handler';\n\nexport function initSiteContextRoutesHandler(\n  siteContextRoutesHandler: SiteContextRoutesHandler\n) {\n  return () => {\n    siteContextRoutesHandler.init();\n  };\n}\n\nexport const siteContextParamsProviders: Provider[] = [\n  SiteContextParamsService,\n  SiteContextUrlSerializer,\n  { provide: UrlSerializer, useExisting: SiteContextUrlSerializer },\n  {\n    provide: APP_INITIALIZER,\n    useFactory: initSiteContextRoutesHandler,\n    deps: [SiteContextRoutesHandler],\n    multi: true,\n  },\n];\n","import {\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from '../providers/context-service-map';\nimport { ContextPersistence, SiteContextConfig } from './site-context-config';\n\nexport function defaultSiteContextConfigFactory(): SiteContextConfig {\n  return {\n    context: {\n      parameters: {\n        [LANGUAGE_CONTEXT_ID]: {\n          persistence: ContextPersistence.ROUTE,\n          default: 'en',\n          values: [\n            'en',\n            'de',\n            'ja',\n            'zh',\n            'ru',\n            'fr',\n            'tr',\n            'it',\n            'es',\n            'uk',\n            'pl',\n            'nl',\n            'hi',\n            'ar',\n            'pt',\n            'bn',\n            'pa',\n          ],\n        },\n        [CURRENCY_CONTEXT_ID]: {\n          persistence: ContextPersistence.ROUTE,\n          default: 'USD',\n          values: [\n            'USD',\n            'EUR',\n            'JPY',\n            'GBP',\n            'AUD',\n            'CAD',\n            'CHF',\n            'CNY',\n            'SEK',\n            'NZD',\n            'MXN',\n            'SGD',\n            'HKD',\n            'NOK',\n            'KRW',\n            'TRY',\n            'RUB',\n            'INR',\n            'BRL',\n            'ZAR',\n          ],\n        },\n      },\n    },\n  };\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { ConfigModule } from '../../config/config.module';\nimport {\n  StateConfig,\n  StateTransferType,\n} from '../../state/config/state-config';\nimport { effects } from './effects/index';\nimport { reducerProvider, reducerToken } from './reducers/index';\nimport { SITE_CONTEXT_FEATURE } from './state';\n\nexport function siteContextStoreConfigFactory(): StateConfig {\n  // if we want to reuse SITE_CONTEXT_FEATURE const in config, we have to use factory instead of plain object\n  const config = {\n    state: {\n      ssrTransfer: {\n        keys: { [SITE_CONTEXT_FEATURE]: StateTransferType.TRANSFER_STATE },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StoreModule.forFeature(SITE_CONTEXT_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n    ConfigModule.withConfigFactory(siteContextStoreConfigFactory),\n  ],\n  providers: [reducerProvider],\n})\nexport class SiteContextStoreModule {}\n","import { SiteContextConfig } from './site-context-config';\nimport { BASE_SITE_CONTEXT_ID } from '../providers/context-service-map';\nimport { getContextParameterDefault } from './context-config-utils';\n\nexport function baseSiteConfigValidator(config: SiteContextConfig) {\n  if (getContextParameterDefault(config, BASE_SITE_CONTEXT_ID) === undefined) {\n    return 'Please configure context.parameters.baseSite before using storefront library!';\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config, ConfigModule } from '../config/config.module';\nimport { StateModule } from '../state/index';\nimport { defaultSiteContextConfigFactory } from './config/default-site-context-config';\nimport { SiteContextConfig } from './config/site-context-config';\nimport { contextServiceMapProvider } from './providers/context-service-map';\nimport { contextServiceProviders } from './providers/context-service-providers';\nimport { siteContextParamsProviders } from './providers/site-context-params-providers';\nimport { SiteContextStoreModule } from './store/site-context-store.module';\nimport { provideConfigValidator } from '../config/utils/config-validator';\nimport { baseSiteConfigValidator } from './config/base-site-config-validator';\n\n// @dynamic\n@NgModule({\n  imports: [\n    ConfigModule.withConfigFactory(defaultSiteContextConfigFactory),\n    StateModule,\n    SiteContextStoreModule,\n  ],\n})\nexport class SiteContextModule {\n  static forRoot(): ModuleWithProviders<SiteContextModule> {\n    return {\n      ngModule: SiteContextModule,\n      providers: [\n        contextServiceMapProvider,\n        ...contextServiceProviders,\n        ...siteContextParamsProviders,\n        { provide: SiteContextConfig, useExisting: Config },\n        provideConfigValidator(baseSiteConfigValidator),\n      ],\n    };\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Product } from '../../../model/product.model';\n\nexport abstract class ProductAdapter {\n  /**\n   * Abstract method used to load product's details data.\n   * Product's data can be loaded from alternative sources, as long as the structure\n   * converts to the `Product`.\n   *\n   * @param productCode The `productCode` for given product\n   */\n  abstract load(productCode: string): Observable<Product>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Product } from '../../../model/product.model';\nimport { ProductAdapter } from './product.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductConnector {\n  constructor(protected adapter: ProductAdapter) {}\n\n  get(productCode: string): Observable<Product> {\n    return this.adapter.load(productCode);\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Product } from '../../../model/product.model';\n\nexport const PRODUCT_NORMALIZER = new InjectionToken<Converter<any, Product>>(\n  'ProductNormalizer'\n);\n","import { InjectionToken } from '@angular/core';\nimport { ProductReference } from '../../../model/product.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const PRODUCT_REFERENCES_NORMALIZER = new InjectionToken<\n  Converter<any, ProductReference[]>\n>('ProductReferencesListNormalizer');\n","import { Observable } from 'rxjs';\nimport { ProductReference } from '../../../model/product.model';\n\nexport abstract class ProductReferencesAdapter {\n  /**\n   * Abstract method used to load product references for a given product.\n   * References can be loaded from alternative sources, as long as the structure\n   * converts to the `ProductReference[]`.\n   *\n   * @param productCode The `productCode` for given product\n   * @param referenceType Reference type according to enum ProductReferenceTypeEnum\n   * @param pageSize Maximum number of product refrence to load\n   */\n  abstract load(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ProductReference } from '../../../model/product.model';\nimport { ProductReferencesAdapter } from './product-references.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductReferencesConnector {\n  constructor(protected adapter: ProductReferencesAdapter) {}\n\n  get(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]> {\n    return this.adapter.load(productCode, referenceType, pageSize);\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Review } from '../../../model/product.model';\n\nexport abstract class ProductReviewsAdapter {\n  /**\n   * Abstract method used to load reviews for a given product.\n   * Reviews can be loaded from alternative sources, as long as the structure\n   * converts to the `Review[]`.\n   *\n   * @param productCode The `productCode` for given product\n   * @param maxCount Maximum number of review to load\n   */\n  abstract load(productCode: string, maxCount?: number): Observable<Review[]>;\n\n  /**\n   * Abstract method used to post review for a given product.\n   *\n   * @param productCode The `productCode` for given product\n   * @param review Review to post\n   */\n  abstract post(productCode: string, review: any): Observable<Review>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ProductReviewsAdapter } from './product-reviews.adapter';\nimport { Review } from '../../../model/product.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductReviewsConnector {\n  constructor(protected adapter: ProductReviewsAdapter) {}\n\n  get(productCode: string, maxCount?: number): Observable<Review[]> {\n    return this.adapter.load(productCode, maxCount);\n  }\n\n  add(productCode: string, review: any): Observable<Review> {\n    return this.adapter.post(productCode, review);\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Review } from '../../../model/product.model';\n\nexport const PRODUCT_REVIEW_NORMALIZER = new InjectionToken<\n  Converter<any, Review>\n>('ProductReviewNormalizer');\n\nexport const PRODUCT_REVIEW_SERIALIZER = new InjectionToken<\n  Converter<Review, any>\n>('ProductReviewSerializer');\n","import { SearchConfig } from '../../model/search-config';\n\nimport { Observable } from 'rxjs';\nimport {\n  Suggestion,\n  ProductSearchPage,\n} from '../../../model/product-search.model';\n\nexport abstract class ProductSearchAdapter {\n  abstract search(\n    query: string,\n    searchConfig?: SearchConfig\n  ): Observable<ProductSearchPage>;\n\n  abstract loadSuggestions(\n    term: string,\n    pageSize?: number\n  ): Observable<Suggestion[]>;\n}\n","import { Injectable } from '@angular/core';\nimport { ProductSearchAdapter } from './product-search.adapter';\nimport { SearchConfig } from '../../model/search-config';\nimport { Observable } from 'rxjs';\nimport {\n  Suggestion,\n  ProductSearchPage,\n} from '../../../model/product-search.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductSearchConnector {\n  constructor(protected adapter: ProductSearchAdapter) {}\n\n  search(\n    query: string,\n    searchConfig?: SearchConfig\n  ): Observable<ProductSearchPage> {\n    return this.adapter.search(query, searchConfig);\n  }\n\n  getSuggestions(term: string, pageSize?: number): Observable<Suggestion[]> {\n    return this.adapter.loadSuggestions(term, pageSize);\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport {\n  Suggestion,\n  ProductSearchPage,\n} from '../../../model/product-search.model';\n\nexport const PRODUCT_SEARCH_PAGE_NORMALIZER = new InjectionToken<\n  Converter<any, ProductSearchPage>\n>('ProductSearchPageNormalizer');\n\nexport const PRODUCT_SUGGESTION_NORMALIZER = new InjectionToken<\n  Converter<any, Suggestion>\n>('ProductSuggestionNormalizer');\n","import { Action } from '@ngrx/store';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { ProductReference } from '../../../model/product.model';\n\nexport const LOAD_PRODUCT_REFERENCES = '[Product] Load Product References Data';\nexport const LOAD_PRODUCT_REFERENCES_FAIL =\n  '[Product] Load Product References Data Fail';\nexport const LOAD_PRODUCT_REFERENCES_SUCCESS =\n  '[Product] Load Product References Data Success';\n\nexport class LoadProductReferences implements Action {\n  readonly type = LOAD_PRODUCT_REFERENCES;\n  constructor(\n    public payload: {\n      productCode: string;\n      referenceType?: string;\n      pageSize?: number;\n    }\n  ) {}\n}\n\nexport class LoadProductReferencesFail implements Action {\n  readonly type = LOAD_PRODUCT_REFERENCES_FAIL;\n  constructor(public payload: ErrorModel) {}\n}\n\nexport class LoadProductReferencesSuccess implements Action {\n  readonly type = LOAD_PRODUCT_REFERENCES_SUCCESS;\n  constructor(\n    public payload: {\n      productCode: string;\n      list: ProductReference[];\n    }\n  ) {}\n}\n\n// action types\nexport type ProductReferencesAction =\n  | LoadProductReferences\n  | LoadProductReferencesFail\n  | LoadProductReferencesSuccess;\n","import { Action } from '@ngrx/store';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { Review } from '../../../model/product.model';\n\nexport const LOAD_PRODUCT_REVIEWS = '[Product] Load Product Reviews Data';\nexport const LOAD_PRODUCT_REVIEWS_FAIL =\n  '[Product] Load Product Reviews Data Fail';\nexport const LOAD_PRODUCT_REVIEWS_SUCCESS =\n  '[Product] Load Product Reviews Data Success';\nexport const POST_PRODUCT_REVIEW = '[Product] Post Product Review';\nexport const POST_PRODUCT_REVIEW_FAIL = '[Product] Post Product Review Fail';\nexport const POST_PRODUCT_REVIEW_SUCCESS =\n  '[Product] Post Product Review Success';\n\nexport class LoadProductReviews implements Action {\n  readonly type = LOAD_PRODUCT_REVIEWS;\n  constructor(public payload: string) {}\n}\n\nexport class LoadProductReviewsFail implements Action {\n  readonly type = LOAD_PRODUCT_REVIEWS_FAIL;\n  constructor(public payload: ErrorModel) {}\n}\n\nexport class LoadProductReviewsSuccess implements Action {\n  readonly type = LOAD_PRODUCT_REVIEWS_SUCCESS;\n  constructor(public payload: { productCode: string; list: Review[] }) {}\n}\n\nexport class PostProductReview implements Action {\n  readonly type = POST_PRODUCT_REVIEW;\n  constructor(public payload: { productCode: string; review: Review }) {}\n}\n\nexport class PostProductReviewFail implements Action {\n  readonly type = POST_PRODUCT_REVIEW_FAIL;\n  constructor(public payload: string) {}\n}\n\nexport class PostProductReviewSuccess implements Action {\n  readonly type = POST_PRODUCT_REVIEW_SUCCESS;\n  constructor(public payload: Review) {}\n}\n\n// action types\nexport type ProductReviewsAction =\n  | LoadProductReviews\n  | LoadProductReviewsFail\n  | LoadProductReviewsSuccess\n  | PostProductReview\n  | PostProductReviewFail\n  | PostProductReviewSuccess;\n","import { Action } from '@ngrx/store';\nimport { ErrorModel } from '../../../model/misc.model';\nimport {\n  ClearSearch,\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport { SearchConfig } from '../../model/search-config';\n\nexport const SEARCH_PRODUCTS = '[Product] Search Products';\nexport const SEARCH_PRODUCTS_FAIL = '[Product] Search Products Fail';\nexport const SEARCH_PRODUCTS_SUCCESS = '[Product] Search Products Success';\nexport const GET_PRODUCT_SUGGESTIONS = '[Product] Get Product Suggestions';\nexport const GET_PRODUCT_SUGGESTIONS_SUCCESS =\n  '[Product] Get Product Suggestions Success';\nexport const GET_PRODUCT_SUGGESTIONS_FAIL =\n  '[Product] Get Product Suggestions Fail';\nexport const CLEAR_PRODUCT_SEARCH_RESULT =\n  '[Product] Clear Product Search Result';\n\nexport class SearchProducts implements Action {\n  readonly type = SEARCH_PRODUCTS;\n  constructor(\n    public payload: { queryText: string; searchConfig: SearchConfig },\n    public auxiliary?: boolean\n  ) {}\n}\n\nexport class SearchProductsFail implements Action {\n  readonly type = SEARCH_PRODUCTS_FAIL;\n  constructor(public payload: ErrorModel, public auxiliary?: boolean) {}\n}\n\nexport class SearchProductsSuccess implements Action {\n  readonly type = SEARCH_PRODUCTS_SUCCESS;\n  constructor(public payload: ProductSearchPage, public auxiliary?: boolean) {}\n}\n\nexport class GetProductSuggestions implements Action {\n  readonly type = GET_PRODUCT_SUGGESTIONS;\n  constructor(public payload: { term: string; searchConfig: SearchConfig }) {}\n}\n\nexport class GetProductSuggestionsSuccess implements Action {\n  readonly type = GET_PRODUCT_SUGGESTIONS_SUCCESS;\n  constructor(public payload: Suggestion[]) {}\n}\n\nexport class GetProductSuggestionsFail implements Action {\n  readonly type = GET_PRODUCT_SUGGESTIONS_FAIL;\n  constructor(public payload: ErrorModel) {}\n}\n\nexport class ClearProductSearchResult implements Action {\n  readonly type = CLEAR_PRODUCT_SEARCH_RESULT;\n  constructor(\n    public payload: ClearSearch = {\n      clearPageResults: false,\n      clearSearchboxResults: false,\n    }\n  ) {}\n}\n\n// action types\nexport type ProductSearchAction =\n  | SearchProducts\n  | SearchProductsFail\n  | SearchProductsSuccess\n  | GetProductSuggestions\n  | GetProductSuggestionsSuccess\n  | GetProductSuggestionsFail\n  | ClearProductSearchResult;\n","import {\n  ProductSearchPage,\n  Suggestion,\n} from '../../model/product-search.model';\nimport { Product, ProductReference, Review } from '../../model/product.model';\nimport { EntityLoaderState } from '../../state/utils/entity-loader/entity-loader-state';\n\nexport const PRODUCT_FEATURE = 'product';\nexport const PRODUCT_DETAIL_ENTITY = '[Product] Detail Entity';\n\nexport interface StateWithProduct {\n  [PRODUCT_FEATURE]: ProductsState;\n}\n\nexport interface ProductsState {\n  details: EntityLoaderState<Product>;\n  search: ProductsSearchState;\n  reviews: ProductReviewsState;\n  references: ProductReferencesState;\n}\n\nexport interface ProductsSearchState {\n  results: ProductSearchPage;\n  suggestions: Suggestion[];\n  auxResults: ProductSearchPage;\n}\n\nexport interface ProductReviewsState {\n  productCode: string;\n  list: Review[];\n}\n\nexport interface ProductReferencesState {\n  productCode: string;\n  list: ProductReference[];\n}\n","import { PRODUCT_DETAIL_ENTITY } from '../product-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport { Product } from '../../../model/product.model';\n\nexport const LOAD_PRODUCT = '[Product] Load Product Data';\nexport const LOAD_PRODUCT_FAIL = '[Product] Load Product Data Fail';\nexport const LOAD_PRODUCT_SUCCESS = '[Product] Load Product Data Success';\n\nexport class LoadProduct extends EntityLoadAction {\n  readonly type = LOAD_PRODUCT;\n  constructor(public payload: string) {\n    super(PRODUCT_DETAIL_ENTITY, payload);\n  }\n}\n\nexport class LoadProductFail extends EntityFailAction {\n  readonly type = LOAD_PRODUCT_FAIL;\n  constructor(productCode: string, public payload: any) {\n    super(PRODUCT_DETAIL_ENTITY, productCode, payload);\n  }\n}\n\nexport class LoadProductSuccess extends EntitySuccessAction {\n  readonly type = LOAD_PRODUCT_SUCCESS;\n  constructor(public payload: Product) {\n    super(PRODUCT_DETAIL_ENTITY, payload.code);\n  }\n}\n\n// action types\nexport type ProductAction = LoadProduct | LoadProductFail | LoadProductSuccess;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  ProductsState,\n  PRODUCT_FEATURE,\n  StateWithProduct,\n} from '../product-state';\n\nexport const getProductsState: MemoizedSelector<\n  StateWithProduct,\n  ProductsState\n> = createFeatureSelector<ProductsState>(PRODUCT_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ProductReference } from '../../../model/product.model';\nimport {\n  ProductReferencesState,\n  ProductsState,\n  StateWithProduct,\n} from '../product-state';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductReferencesState: MemoizedSelector<\n  StateWithProduct,\n  ProductReferencesState\n> = createSelector(\n  getProductsState,\n  (state: ProductsState) => state.references\n);\n\nexport const getSelectedProductReferencesFactory = (\n  productCode: string\n): MemoizedSelector<StateWithProduct, ProductReference[]> => {\n  return createSelector(\n    getProductReferencesState,\n    referenceTypeData => {\n      if (referenceTypeData.productCode === productCode) {\n        return !!referenceTypeData.list ? referenceTypeData.list : [];\n      }\n    }\n  );\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Review } from '../../../model/product.model';\nimport {\n  ProductReviewsState,\n  ProductsState,\n  StateWithProduct,\n} from '../product-state';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductReviewsState: MemoizedSelector<\n  StateWithProduct,\n  ProductReviewsState\n> = createSelector(\n  getProductsState,\n  (state: ProductsState) => state.reviews\n);\n\nexport const getSelectedProductReviewsFactory = (\n  productCode\n): MemoizedSelector<StateWithProduct, Review[]> => {\n  return createSelector(\n    getProductReviewsState,\n    reviewData => {\n      if (reviewData.productCode === productCode) {\n        return reviewData.list;\n      }\n    }\n  );\n};\n","import {\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport * as fromProductsSearch from '../actions/product-search.action';\nimport { ProductsSearchState } from '../product-state';\n\nexport const initialState: ProductsSearchState = {\n  results: {},\n  suggestions: [],\n  auxResults: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromProductsSearch.ProductSearchAction\n): ProductsSearchState {\n  switch (action.type) {\n    case fromProductsSearch.SEARCH_PRODUCTS_SUCCESS: {\n      const results = action.payload;\n      const res = action.auxiliary ? { auxResults: results } : { results };\n      return {\n        ...state,\n        ...res,\n      };\n    }\n\n    case fromProductsSearch.GET_PRODUCT_SUGGESTIONS_SUCCESS: {\n      const suggestions: Suggestion[] = action.payload;\n\n      return {\n        ...state,\n        suggestions,\n      };\n    }\n\n    case fromProductsSearch.CLEAR_PRODUCT_SEARCH_RESULT: {\n      return {\n        ...state,\n        results: action.payload.clearPageResults ? {} : state.results,\n        suggestions: action.payload.clearSearchboxResults\n          ? []\n          : state.suggestions,\n        auxResults: action.payload.clearSearchboxResults\n          ? {}\n          : state.auxResults,\n      };\n    }\n  }\n  return state;\n}\n\nexport const getSearchResults = (\n  state: ProductsSearchState\n): ProductSearchPage => state.results;\nexport const getAuxSearchResults = (\n  state: ProductsSearchState\n): ProductSearchPage => state.auxResults;\nexport const getProductSuggestions = (\n  state: ProductsSearchState\n): Suggestion[] => state.suggestions;\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport {\n  ProductsSearchState,\n  ProductsState,\n  StateWithProduct,\n} from '../product-state';\nimport * as fromProductSearch from '../reducers/product-search.reducer';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductsSearchState: MemoizedSelector<\n  StateWithProduct,\n  ProductsSearchState\n> = createSelector(\n  getProductsState,\n  (state: ProductsState) => state.search\n);\n\nexport const getSearchResults: MemoizedSelector<\n  StateWithProduct,\n  ProductSearchPage\n> = createSelector(\n  getProductsSearchState,\n  fromProductSearch.getSearchResults\n);\n\nexport const getAuxSearchResults: MemoizedSelector<\n  StateWithProduct,\n  ProductSearchPage\n> = createSelector(\n  getProductsSearchState,\n  fromProductSearch.getAuxSearchResults\n);\n\nexport const getProductSuggestions: MemoizedSelector<\n  StateWithProduct,\n  Suggestion[]\n> = createSelector(\n  getProductsSearchState,\n  fromProductSearch.getProductSuggestions\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Product } from '../../../model/product.model';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\nimport { entityStateSelector } from '../../../state/utils/entity-loader/entity-loader.selectors';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderErrorSelector,\n  loaderLoadingSelector,\n  loaderSuccessSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { ProductsState, StateWithProduct } from '../product-state';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductState: MemoizedSelector<\n  StateWithProduct,\n  EntityLoaderState<Product>\n> = createSelector(\n  getProductsState,\n  (state: ProductsState) => state.details\n);\n\nexport const getSelectedProductsFactory = (\n  codes: string[]\n): MemoizedSelector<StateWithProduct, Product[]> => {\n  return createSelector(\n    getProductState,\n    (details: EntityLoaderState<Product>) => {\n      return codes\n        .map(code =>\n          details.entities[code] ? details.entities[code].value : undefined\n        )\n        .filter(product => product !== undefined);\n    }\n  );\n};\n\nexport const getSelectedProductStateFactory = (\n  code: string\n): MemoizedSelector<StateWithProduct, LoaderState<Product>> => {\n  return createSelector(\n    getProductState,\n    details => entityStateSelector(details, code)\n  );\n};\n\nexport const getSelectedProductFactory = (\n  code: string\n): MemoizedSelector<StateWithProduct, Product> => {\n  return createSelector(\n    getSelectedProductStateFactory(code),\n    productState => loaderValueSelector(productState)\n  );\n};\n\nexport const getSelectedProductLoadingFactory = (\n  code: string\n): MemoizedSelector<StateWithProduct, boolean> => {\n  return createSelector(\n    getSelectedProductStateFactory(code),\n    productState => loaderLoadingSelector(productState)\n  );\n};\n\nexport const getSelectedProductSuccessFactory = (\n  code: string\n): MemoizedSelector<StateWithProduct, boolean> => {\n  return createSelector(\n    getSelectedProductStateFactory(code),\n    productState => loaderSuccessSelector(productState)\n  );\n};\n\nexport const getSelectedProductErrorFactory = (\n  code: string\n): MemoizedSelector<StateWithProduct, boolean> => {\n  return createSelector(\n    getSelectedProductStateFactory(code),\n    productState => loaderErrorSelector(productState)\n  );\n};\n\nexport const getAllProductCodes: MemoizedSelector<\n  StateWithProduct,\n  string[]\n> = createSelector(\n  getProductState,\n  details => {\n    return Object.keys(details.entities);\n  }\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { ProductReference } from '../../model/product.model';\nimport * as fromProductActions from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class ProductReferenceService {\n  constructor(protected store: Store<StateWithProduct>) {}\n\n  get(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]> {\n    return this.store.pipe(\n      select(ProductSelectors.getSelectedProductReferencesFactory(productCode)),\n      tap(references => {\n        if (references === undefined && productCode !== undefined) {\n          this.store.dispatch(\n            new fromProductActions.LoadProductReferences({\n              productCode,\n              referenceType,\n              pageSize,\n            })\n          );\n        }\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { ProductReferencesConnector } from '../../connectors/references/product-references.connector';\nimport * as productReferencesActions from './../actions/product-references.action';\n\n@Injectable()\nexport class ProductReferencesEffects {\n  @Effect()\n  loadProductReferences$: Observable<\n    | productReferencesActions.LoadProductReferencesSuccess\n    | productReferencesActions.LoadProductReferencesFail\n  > = this.actions$.pipe(\n    ofType(productReferencesActions.LOAD_PRODUCT_REFERENCES),\n    map(\n      (action: productReferencesActions.LoadProductReferences) => action.payload\n    ),\n    mergeMap(payload => {\n      return this.productReferencesConnector\n        .get(payload.productCode, payload.referenceType, payload.pageSize)\n        .pipe(\n          map(data => {\n            return new productReferencesActions.LoadProductReferencesSuccess({\n              productCode: payload.productCode,\n              list: data,\n            });\n          }),\n          catchError(_error =>\n            of(\n              new productReferencesActions.LoadProductReferencesFail({\n                message: payload.productCode,\n              } as ErrorModel)\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private productReferencesConnector: ProductReferencesConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { ProductReviewsConnector } from '../../connectors/reviews/product-reviews.connector';\nimport * as productReviewsActions from './../actions/product-reviews.action';\nimport { ErrorModel } from '../../../model/misc.model';\n\n@Injectable()\nexport class ProductReviewsEffects {\n  @Effect()\n  loadProductReviews$: Observable<\n    | productReviewsActions.LoadProductReviewsSuccess\n    | productReviewsActions.LoadProductReviewsFail\n  > = this.actions$.pipe(\n    ofType(productReviewsActions.LOAD_PRODUCT_REVIEWS),\n    map((action: productReviewsActions.LoadProductReviews) => action.payload),\n    mergeMap(productCode => {\n      return this.productReviewsConnector.get(productCode).pipe(\n        map(data => {\n          return new productReviewsActions.LoadProductReviewsSuccess({\n            productCode,\n            list: data,\n          });\n        }),\n        catchError(_error =>\n          of(\n            new productReviewsActions.LoadProductReviewsFail({\n              message: productCode,\n            } as ErrorModel)\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  postProductReview: Observable<\n    | productReviewsActions.PostProductReviewSuccess\n    | productReviewsActions.PostProductReviewFail\n  > = this.actions$.pipe(\n    ofType(productReviewsActions.POST_PRODUCT_REVIEW),\n    map((action: productReviewsActions.PostProductReview) => action.payload),\n    mergeMap(payload => {\n      return this.productReviewsConnector\n        .add(payload.productCode, payload.review)\n        .pipe(\n          map(reviewResponse => {\n            return new productReviewsActions.PostProductReviewSuccess(\n              reviewResponse\n            );\n          }),\n          catchError(_error =>\n            of(\n              new productReviewsActions.PostProductReviewFail(\n                payload.productCode\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private productReviewsConnector: ProductReviewsConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, groupBy, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { ProductSearchConnector } from '../../connectors/search/product-search.connector';\nimport * as productsSearchActions from '../actions/product-search.action';\n\n@Injectable()\nexport class ProductsSearchEffects {\n  @Effect()\n  searchProducts$: Observable<\n    | productsSearchActions.SearchProductsSuccess\n    | productsSearchActions.SearchProductsFail\n  > = this.actions$.pipe(\n    ofType(productsSearchActions.SEARCH_PRODUCTS),\n    groupBy((action: productsSearchActions.SearchProducts) => action.auxiliary),\n    mergeMap(group =>\n      group.pipe(\n        switchMap((action: productsSearchActions.SearchProducts) => {\n          return this.productSearchConnector\n            .search(action.payload.queryText, action.payload.searchConfig)\n            .pipe(\n              map(data => {\n                return new productsSearchActions.SearchProductsSuccess(\n                  data,\n                  action.auxiliary\n                );\n              }),\n              catchError(error =>\n                of(\n                  new productsSearchActions.SearchProductsFail(\n                    makeErrorSerializable(error),\n                    action.auxiliary\n                  )\n                )\n              )\n            );\n        })\n      )\n    )\n  );\n\n  @Effect()\n  getProductSuggestions$: Observable<\n    | productsSearchActions.GetProductSuggestionsSuccess\n    | productsSearchActions.GetProductSuggestionsFail\n  > = this.actions$.pipe(\n    ofType(productsSearchActions.GET_PRODUCT_SUGGESTIONS),\n    map(\n      (action: productsSearchActions.GetProductSuggestions) => action.payload\n    ),\n    switchMap(payload => {\n      return this.productSearchConnector\n        .getSuggestions(payload.term, payload.searchConfig.pageSize)\n        .pipe(\n          map(suggestions => {\n            if (suggestions === undefined) {\n              return new productsSearchActions.GetProductSuggestionsSuccess([]);\n            }\n            return new productsSearchActions.GetProductSuggestionsSuccess(\n              suggestions\n            );\n          }),\n          catchError(error =>\n            of(\n              new productsSearchActions.GetProductSuggestionsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private productSearchConnector: ProductSearchConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, groupBy, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { ProductConnector } from '../../connectors/product/product.connector';\nimport * as actions from '../actions/index';\n\n@Injectable()\nexport class ProductEffects {\n  @Effect()\n  loadProduct$: Observable<\n    actions.LoadProductSuccess | actions.LoadProductFail\n  > = this.actions$.pipe(\n    ofType(actions.LOAD_PRODUCT),\n    map((action: actions.LoadProduct) => action.payload),\n    groupBy(productCode => productCode),\n    mergeMap(group =>\n      group.pipe(\n        switchMap(productCode => {\n          return this.productConnector.get(productCode).pipe(\n            map(product => {\n              return new actions.LoadProductSuccess(product);\n            }),\n            catchError(error =>\n              of(\n                new actions.LoadProductFail(\n                  productCode,\n                  makeErrorSerializable(error)\n                )\n              )\n            )\n          );\n        })\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private productConnector: ProductConnector\n  ) {}\n}\n","import { ProductReferencesEffects } from './product-references.effect';\nimport { ProductReviewsEffects } from './product-reviews.effect';\nimport { ProductsSearchEffects } from './product-search.effect';\nimport { ProductEffects } from './product.effect';\n\nexport const effects: any[] = [\n  ProductsSearchEffects,\n  ProductEffects,\n  ProductReviewsEffects,\n  ProductReferencesEffects,\n];\n\nexport * from './product-references.effect';\nexport * from './product-reviews.effect';\nexport * from './product-search.effect';\nexport * from './product.effect';\n","import { ProductReference } from '../../../model/product.model';\nimport * as fromProductReferences from '../actions/product-references.action';\nimport { ProductReferencesState } from '../product-state';\n\nexport const initialState: ProductReferencesState = {\n  productCode: '',\n  list: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromProductReferences.ProductReferencesAction\n): ProductReferencesState {\n  switch (action.type) {\n    case fromProductReferences.LOAD_PRODUCT_REFERENCES_SUCCESS: {\n      const productCode = action.payload.productCode;\n      const list = action.payload.list;\n\n      return {\n        ...state,\n        list,\n        productCode,\n      };\n    }\n  }\n\n  return state;\n}\n\nexport const getProductReferenceList = (\n  state: ProductReferencesState\n): ProductReference[] => state.list;\nexport const getProductReferenceProductCode = (\n  state: ProductReferencesState\n): string => state.productCode;\n","import { ProductReviewsState } from '../product-state';\nimport * as fromProductReviews from './../actions/product-reviews.action';\nimport { Review } from '../../../model/product.model';\n\nexport const initialState: ProductReviewsState = {\n  productCode: '',\n  list: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromProductReviews.ProductReviewsAction\n): ProductReviewsState {\n  switch (action.type) {\n    case fromProductReviews.LOAD_PRODUCT_REVIEWS_SUCCESS: {\n      const productCode = action.payload.productCode;\n      const list = action.payload.list;\n\n      return {\n        ...state,\n        productCode,\n        list,\n      };\n    }\n  }\n\n  return state;\n}\n\nexport const getReviewList = (state: ProductReviewsState): Review[] =>\n  state.list;\nexport const getReviewProductCode = (state: ProductReviewsState): string =>\n  state.productCode;\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducer, ActionReducerMap, MetaReducer } from '@ngrx/store';\nimport { Product } from '../../../model/product.model';\nimport { CURRENCY_CHANGE, LANGUAGE_CHANGE } from '../../../site-context';\nimport { entityLoaderReducer } from '../../../state/utils/entity-loader/entity-loader.reducer';\nimport { ProductsState, PRODUCT_DETAIL_ENTITY } from '../product-state';\nimport * as fromProductReferences from './product-references.reducer';\nimport * as fromProductReviews from './product-reviews.reducer';\nimport * as fromProductsSearch from './product-search.reducer';\n\nexport function getReducers(): ActionReducerMap<ProductsState> {\n  return {\n    search: fromProductsSearch.reducer,\n    details: entityLoaderReducer<Product>(PRODUCT_DETAIL_ENTITY),\n    reviews: fromProductReviews.reducer,\n    references: fromProductReferences.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<ProductsState>\n> = new InjectionToken<ActionReducerMap<ProductsState>>('ProductReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearProductsState(\n  reducer: ActionReducer<any>\n): ActionReducer<any> {\n  return function(state, action) {\n    if (action.type === CURRENCY_CHANGE || action.type === LANGUAGE_CHANGE) {\n      state = undefined;\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearProductsState];\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { Review } from '../../model/product.model';\nimport * as fromStore from '../store/index';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class ProductReviewService {\n  constructor(protected store: Store<fromStore.StateWithProduct>) {}\n\n  getByProductCode(productCode: string): Observable<Review[]> {\n    return this.store.pipe(\n      select(ProductSelectors.getSelectedProductReviewsFactory(productCode)),\n      tap(reviews => {\n        if (reviews === undefined && productCode !== undefined) {\n          this.store.dispatch(new fromStore.LoadProductReviews(productCode));\n        }\n      })\n    );\n  }\n\n  add(productCode: string, review: Review): void {\n    this.store.dispatch(\n      new fromStore.PostProductReview({\n        productCode: productCode,\n        review,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { ProductSearchPage } from '../../model/product-search.model';\nimport { SearchConfig } from '../model/search-config';\nimport * as fromStore from '../store/index';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class ProductSearchService {\n  constructor(protected store: Store<fromStore.StateWithProduct>) {}\n\n  search(query: string, searchConfig?: SearchConfig): void {\n    this.store.dispatch(\n      new fromStore.SearchProducts({\n        queryText: query,\n        searchConfig: searchConfig,\n      })\n    );\n  }\n\n  getResults(): Observable<ProductSearchPage> {\n    return this.store.pipe(select(ProductSelectors.getSearchResults));\n  }\n\n  clearResults(): void {\n    this.store.dispatch(\n      new fromStore.ClearProductSearchResult({\n        clearPageResults: true,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, shareReplay, tap } from 'rxjs/operators';\nimport { Product } from '../../model/product.model';\nimport * as fromStore from '../store/index';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class ProductService {\n  constructor(protected store: Store<fromStore.StateWithProduct>) {}\n\n  private products: { [code: string]: Observable<Product> } = {};\n\n  /**\n   * Returns the product observable. The product will be loaded\n   * whenever there's no value observed.\n   *\n   * The underlying product loader ensures that the product is\n   * only loaded once, even in case of parallel observers.\n   */\n  get(productCode: string): Observable<Product> {\n    if (!this.products[productCode]) {\n      this.products[productCode] = this.store.pipe(\n        select(ProductSelectors.getSelectedProductStateFactory(productCode)),\n        tap(productState => {\n          const attemptedLoad =\n            productState.loading || productState.success || productState.error;\n\n          if (!attemptedLoad) {\n            this.store.dispatch(new fromStore.LoadProduct(productCode));\n          }\n        }),\n        map(productState => productState.value),\n        shareReplay({ bufferSize: 1, refCount: true })\n      );\n    }\n    return this.products[productCode];\n  }\n\n  /**\n   * Returns boolean observable for product's loading state\n   */\n  isLoading(productCode: string): Observable<boolean> {\n    return this.store.pipe(\n      select(ProductSelectors.getSelectedProductLoadingFactory(productCode))\n    );\n  }\n\n  /**\n   * Returns boolean observable for product's load success state\n   */\n  isSuccess(productCode: string): Observable<boolean> {\n    return this.store.pipe(\n      select(ProductSelectors.getSelectedProductSuccessFactory(productCode))\n    );\n  }\n\n  /**\n   * Returns boolean observable for product's load error state\n   */\n  hasError(productCode: string): Observable<boolean> {\n    return this.store.pipe(\n      select(ProductSelectors.getSelectedProductErrorFactory(productCode))\n    );\n  }\n\n  /**\n   * Reloads the product. The product is loaded implicetly\n   * whenever selected by the `get`, but in some cases an\n   * explicit reload might be needed.\n   */\n  reload(productCode: string): void {\n    this.store.dispatch(new fromStore.LoadProduct(productCode));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { ProductSearchPage, Suggestion } from '../../model/index';\nimport { SearchConfig } from '../model';\nimport * as fromStore from '../store/index';\nimport { ProductSelectors } from '../store/selectors/index';\nimport { ProductSearchService } from './product-search.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SearchboxService extends ProductSearchService {\n  /**\n   * dispatch the search for the search box\n   */\n  search(query: string, searchConfig?: SearchConfig): void {\n    this.store.dispatch(\n      new fromStore.SearchProducts(\n        {\n          queryText: query,\n          searchConfig: searchConfig,\n        },\n        true\n      )\n    );\n  }\n\n  getResults(): Observable<ProductSearchPage> {\n    return this.store.pipe(select(ProductSelectors.getAuxSearchResults));\n  }\n\n  /**\n   * clears the products and suggestions\n   */\n  clearResults(): void {\n    this.store.dispatch(\n      new fromStore.ClearProductSearchResult({\n        clearSearchboxResults: true,\n      })\n    );\n  }\n\n  getSuggestionResults(): Observable<Suggestion[]> {\n    return this.store.pipe(select(ProductSelectors.getProductSuggestions));\n  }\n\n  searchSuggestions(query: string, searchConfig?: SearchConfig): void {\n    this.store.dispatch(\n      new fromStore.GetProductSuggestions({\n        term: query,\n        searchConfig: searchConfig,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { Page, PageMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport { PageTitleResolver } from '../../cms/page/page.resolvers';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { ProductSearchPage } from '../../model/product-search.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { ProductSearchService } from '../facade/product-search.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CategoryPageMetaResolver extends PageMetaResolver\n  implements PageTitleResolver {\n  constructor(\n    protected routingService: RoutingService,\n    protected productSearchService: ProductSearchService,\n    protected cms: CmsService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.CATEGORY_PAGE;\n  }\n\n  resolve(): Observable<PageMeta> {\n    return this.cms.getCurrentPage().pipe(\n      filter(Boolean),\n      switchMap(page => {\n        // only the existence of a plp component tells us if products\n        // are rendered or if this is an ordinary content page\n        if (this.hasProductListComponent(page)) {\n          return this.productSearchService.getResults().pipe(\n            filter(data => data.breadcrumbs && data.breadcrumbs.length > 0),\n            switchMap(data =>\n              combineLatest([\n                this.resolveTitle(data),\n                this.resolveBreadcrumbLabel().pipe(\n                  switchMap(label => this.resolveBreadcrumbs(data, label))\n                ),\n              ])\n            ),\n            map(([title, breadcrumbs]) => ({ title, breadcrumbs }))\n          );\n        } else {\n          return of({\n            title: page.title || page.name,\n          });\n        }\n      })\n    );\n  }\n\n  resolveTitle(data: ProductSearchPage): Observable<string> {\n    return this.translation.translate('pageMetaResolver.category.title', {\n      count: data.pagination.totalResults,\n      query: data.breadcrumbs[0].facetValueName,\n    });\n  }\n\n  resolveBreadcrumbLabel(): Observable<string> {\n    return this.translation.translate('common.home');\n  }\n\n  resolveBreadcrumbs(\n    data: ProductSearchPage,\n    breadcrumbLabel: string\n  ): Observable<any[]> {\n    const breadcrumbs = [];\n    breadcrumbs.push({ label: breadcrumbLabel, link: '/' });\n    for (const br of data.breadcrumbs) {\n      if (br.facetCode === 'category') {\n        breadcrumbs.push({\n          label: br.facetValueName,\n          link: `/c/${br.facetValueCode}`,\n        });\n      }\n      if (br.facetCode === 'brand') {\n        breadcrumbs.push({\n          label: br.facetValueName,\n          link: `/Brands/${br.facetValueName}/c/${br.facetValueCode}`,\n        });\n      }\n    }\n    return of(breadcrumbs);\n  }\n\n  private hasProductListComponent(page: Page): boolean {\n    // ProductListComponent\n    return !!Object.keys(page.slots).find(\n      key =>\n        !!page.slots[key].components.find(\n          comp => comp.typeCode === 'CMSProductListComponent'\n        )\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { PageMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageBreadcrumbResolver,\n  PageDescriptionResolver,\n  PageHeadingResolver,\n  PageImageResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { Product } from '../../model/product.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { ProductService } from '../facade/product.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductPageMetaResolver extends PageMetaResolver\n  implements\n    PageHeadingResolver,\n    PageTitleResolver,\n    PageDescriptionResolver,\n    PageBreadcrumbResolver,\n    PageImageResolver {\n  constructor(\n    protected routingService: RoutingService,\n    protected productService: ProductService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.PRODUCT_PAGE;\n  }\n\n  resolve(): Observable<PageMeta> {\n    return this.routingService.getRouterState().pipe(\n      map(state => state.state.params['productCode']),\n      filter(Boolean),\n      switchMap(code => this.productService.get(code)),\n      filter(Boolean),\n      switchMap((p: Product) =>\n        combineLatest([\n          this.resolveHeading(p),\n          this.resolveTitle(p),\n          this.resolveDescription(p),\n          this.resolveBreadcrumbLabel().pipe(\n            switchMap(label => this.resolveBreadcrumbs(p, label))\n          ),\n          this.resolveImage(p),\n        ])\n      ),\n      map(([heading, title, description, breadcrumbs, image]) => ({\n        heading,\n        title,\n        description,\n        breadcrumbs,\n        image,\n      }))\n    );\n  }\n\n  resolveHeading(product: Product): Observable<string> {\n    return this.translation.translate('pageMetaResolver.product.heading', {\n      heading: product.name,\n    });\n  }\n\n  resolveTitle(product: Product): Observable<string> {\n    let title = product.name;\n    title += this.resolveFirstCategory(product);\n    title += this.resolveManufacturer(product);\n\n    return this.translation.translate('pageMetaResolver.product.title', {\n      title: title,\n    });\n  }\n\n  resolveDescription(product: Product): Observable<string> {\n    return this.translation.translate('pageMetaResolver.product.description', {\n      description: product.summary,\n    });\n  }\n\n  resolveBreadcrumbLabel(): Observable<string> {\n    return this.translation.translate('common.home');\n  }\n\n  resolveBreadcrumbs(\n    product: Product,\n    breadcrumbLabel: string\n  ): Observable<any[]> {\n    const breadcrumbs = [];\n    breadcrumbs.push({ label: breadcrumbLabel, link: '/' });\n    for (const { name, code, url } of product.categories) {\n      breadcrumbs.push({\n        label: name || code,\n        link: url,\n      });\n    }\n    return of(breadcrumbs);\n  }\n\n  resolveImage(product: any): Observable<string> {\n    let result;\n    if (\n      product.images &&\n      product.images.PRIMARY &&\n      product.images.PRIMARY.zoom &&\n      product.images.PRIMARY.zoom.url\n    ) {\n      result = product.images.PRIMARY.zoom.url;\n    }\n    return of(result);\n  }\n\n  private resolveFirstCategory(product: Product): string {\n    let firstCategory;\n    if (product.categories && product.categories.length > 0) {\n      firstCategory = product.categories[0];\n    }\n    return firstCategory\n      ? ` | ${firstCategory.name || firstCategory.code}`\n      : '';\n  }\n\n  private resolveManufacturer(product: Product): string {\n    return product.manufacturer ? ` | ${product.manufacturer}` : '';\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { PageMetaResolver } from '../../cms';\nimport { PageMeta } from '../../cms/model/page.model';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { ProductSearchService } from '../facade/product-search.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SearchPageMetaResolver extends PageMetaResolver\n  implements PageMetaResolver {\n  constructor(\n    protected routingService: RoutingService,\n    protected productSearchService: ProductSearchService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'SearchResultsListPageTemplate';\n  }\n\n  resolve(): Observable<PageMeta> {\n    const total$: Observable<\n      number\n    > = this.productSearchService.getResults().pipe(\n      filter(data => !!(data && data.pagination)),\n      map(results => results.pagination.totalResults)\n    );\n\n    const query$: Observable<\n      string\n    > = this.routingService.getRouterState().pipe(\n      map(state => state.state.params['query']),\n      filter(Boolean)\n    );\n\n    return combineLatest([total$, query$]).pipe(\n      switchMap(([total, query]: [number, string]) =>\n        this.resolveTitle(total, query)\n      ),\n      map(title => ({ title }))\n    );\n  }\n\n  resolveTitle(total: number, query: string): Observable<string> {\n    return this.translation.translate('pageMetaResolver.search.title', {\n      count: total,\n      query: query,\n    });\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { ConfigModule } from '../../config/config.module';\nimport {\n  StateConfig,\n  StateTransferType,\n} from '../../state/config/state-config';\nimport { effects } from './effects/index';\nimport { PRODUCT_FEATURE } from './product-state';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function productStoreConfigFactory(): StateConfig {\n  // if we want to reuse PRODUCT_FEATURE const in config, we have to use factory instead of plain object\n  const config = {\n    state: {\n      ssrTransfer: {\n        keys: { [PRODUCT_FEATURE]: StateTransferType.TRANSFER_STATE },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StoreModule.forFeature(PRODUCT_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n    ConfigModule.withConfigFactory(productStoreConfigFactory),\n  ],\n  providers: [reducerProvider],\n})\nexport class ProductStoreModule {}\n","import { NgModule } from '@angular/core';\nimport { CmsModule } from '../cms/cms.module';\nimport { PageMetaResolver } from '../cms/page/page-meta.resolver';\nimport {\n  ProductReferenceService,\n  ProductReviewService,\n  ProductSearchService,\n  ProductService,\n} from './facade/index';\nimport { CategoryPageMetaResolver } from './services/category-page-meta.resolver';\nimport { ProductPageMetaResolver } from './services/product-page-meta.resolver';\nimport { SearchPageMetaResolver } from './services/search-page-meta.resolver';\nimport { ProductStoreModule } from './store/product-store.module';\n\nconst pageTitleResolvers = [\n  {\n    provide: PageMetaResolver,\n    useExisting: ProductPageMetaResolver,\n    multi: true,\n  },\n  {\n    provide: PageMetaResolver,\n    useExisting: CategoryPageMetaResolver,\n    multi: true,\n  },\n  {\n    provide: PageMetaResolver,\n    useExisting: SearchPageMetaResolver,\n    multi: true,\n  },\n];\n\n@NgModule({\n  imports: [ProductStoreModule, CmsModule],\n  providers: [\n    ProductService,\n    ProductSearchService,\n    ProductReviewService,\n    ProductReferenceService,\n    ...pageTitleResolvers,\n  ],\n})\nexport class ProductModule {}\n","import { Observable } from 'rxjs';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\n\nexport abstract class UserAdapter {\n  abstract load(userId: string): Observable<User>;\n\n  abstract update(username: string, user: User): Observable<{}>;\n\n  abstract register(user: UserSignUp): Observable<User>;\n\n  abstract requestForgotPasswordEmail(userEmailAddress: string): Observable<{}>;\n\n  abstract resetPassword(token: string, newPassword: string): Observable<{}>;\n\n  abstract updateEmail(\n    userId: string,\n    currentPassword: string,\n    newUserId: string\n  ): Observable<{}>;\n\n  abstract updatePassword(\n    userId: string,\n    oldPassword: string,\n    newPassword: string\n  ): Observable<{}>;\n\n  abstract remove(userId: string): Observable<{}>;\n\n  abstract loadTitles(): Observable<Title[]>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\nimport { UserAdapter } from './user.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserConnector {\n  constructor(protected adapter: UserAdapter) {}\n\n  get(userId: string): Observable<User> {\n    return this.adapter.load(userId);\n  }\n\n  update(username: string, user: User): Observable<{}> {\n    return this.adapter.update(username, user);\n  }\n\n  register(user: UserSignUp): Observable<User> {\n    return this.adapter.register(user);\n  }\n\n  requestForgotPasswordEmail(userEmailAddress: string): Observable<{}> {\n    return this.adapter.requestForgotPasswordEmail(userEmailAddress);\n  }\n\n  resetPassword(token: string, newPassword: string): Observable<{}> {\n    return this.adapter.resetPassword(token, newPassword);\n  }\n\n  updateEmail(\n    userId: string,\n    currentPassword: string,\n    newUserId: string\n  ): Observable<{}> {\n    return this.adapter.updateEmail(userId, currentPassword, newUserId);\n  }\n\n  updatePassword(\n    userId: string,\n    oldPassword: string,\n    newPassword: string\n  ): Observable<{}> {\n    return this.adapter.updatePassword(userId, oldPassword, newPassword);\n  }\n\n  remove(userId: string): Observable<{}> {\n    return this.adapter.remove(userId);\n  }\n\n  getTitles(): Observable<Title[]> {\n    return this.adapter.loadTitles();\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\n\nexport const USER_NORMALIZER = new InjectionToken<Converter<any, User>>(\n  'UserNormalizer'\n);\n\nexport const USER_SERIALIZER = new InjectionToken<Converter<User, any>>(\n  'UserSerializer'\n);\n\nexport const USER_SIGN_UP_SERIALIZER = new InjectionToken<\n  Converter<UserSignUp, any>\n>('UserSignUpSerializer');\n\nexport const TITLE_NORMALIZER = new InjectionToken<Converter<any, Title>>(\n  'TitleNormalizer'\n);\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\nexport const ADDRESS_NORMALIZER = new InjectionToken<Converter<any, Address>>(\n  'AddressNormalizer'\n);\n\nexport const ADDRESS_SERIALIZER = new InjectionToken<Converter<Address, any>>(\n  'AddressSerializer'\n);\n\nexport const ADDRESS_VALIDATION_NORMALIZER = new InjectionToken<\n  Converter<any, AddressValidation>\n>('AddressValidationNormalizer');\n","import { Observable } from 'rxjs';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\nexport abstract class UserConsentAdapter {\n  abstract loadConsents(userId: string): Observable<ConsentTemplate[]>;\n\n  abstract giveConsent(\n    userId: string,\n    consentTemplateId: string,\n    consentTemplateVersion: number\n  ): Observable<ConsentTemplate>;\n\n  abstract withdrawConsent(userId: string, consentCode: string): Observable<{}>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { UserConsentAdapter } from './user-consent.adapter';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserConsentConnector {\n  constructor(protected adapter: UserConsentAdapter) {}\n\n  loadConsents(userId: string): Observable<ConsentTemplate[]> {\n    return this.adapter.loadConsents(userId);\n  }\n\n  giveConsent(\n    userId: string,\n    consentTemplateId: string,\n    consentTemplateVersion: number\n  ): Observable<ConsentTemplate> {\n    return this.adapter.giveConsent(\n      userId,\n      consentTemplateId,\n      consentTemplateVersion\n    );\n  }\n\n  withdrawConsent(userId: string, consentCode: string): Observable<{}> {\n    return this.adapter.withdrawConsent(userId, consentCode);\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\nexport const CONSENT_TEMPLATE_NORMALIZER = new InjectionToken<\n  Converter<any, ConsentTemplate>\n>('ConsentTemplateNormalizer');\n","import { Observable } from 'rxjs';\nimport { PaymentDetails } from '../../../model/cart.model';\n\nexport abstract class UserPaymentAdapter {\n  abstract loadAll(userId: string): Observable<PaymentDetails[]>;\n\n  abstract delete(userId: string, paymentMethodID: string): Observable<{}>;\n\n  abstract setDefault(userId: string, paymentMethodID: string): Observable<{}>;\n}\n","import { Injectable } from '@angular/core';\nimport { UserPaymentAdapter } from './user-payment.adapter';\nimport { Observable } from 'rxjs';\nimport { PaymentDetails } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserPaymentConnector {\n  constructor(protected adapter: UserPaymentAdapter) {}\n\n  getAll(userId: string): Observable<PaymentDetails[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  delete(userId: string, paymentMethodID: string): Observable<{}> {\n    return this.adapter.delete(userId, paymentMethodID);\n  }\n\n  setDefault(userId: string, paymentMethodID: string): Observable<{}> {\n    return this.adapter.setDefault(userId, paymentMethodID);\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Order, OrderHistoryList } from '../../../model/order.model';\n\nexport abstract class UserOrderAdapter {\n  /**\n   * Abstract method used to load order data.\n   *\n   * @param userId The `userId` for given user\n   * @param orderCode The `orderCode` for given order\n   */\n  abstract load(userId: string, orderCode: string): Observable<Order>;\n\n  /**\n   * Abstract method used to load order history for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param pageSize\n   * @param currentPage\n   * @param sort Sorting method\n   */\n  abstract loadHistory(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<OrderHistoryList>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { UserOrderAdapter } from './user-order.adapter';\nimport { Order, OrderHistoryList } from '../../../model/order.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserOrderConnector {\n  constructor(protected adapter: UserOrderAdapter) {}\n\n  public get(userId: string, orderCode: string): Observable<Order> {\n    return this.adapter.load(userId, orderCode);\n  }\n\n  public getHistory(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<OrderHistoryList> {\n    return this.adapter.loadHistory(userId, pageSize, currentPage, sort);\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { OrderHistoryList } from '../../../model/order.model';\n\nexport const ORDER_HISTORY_NORMALIZER = new InjectionToken<\n  Converter<any, OrderHistoryList>\n>('OrderHistoryNormalizer');\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { entityStateSelector } from '../../../state/utils/entity-loader/entity-loader.selectors';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderErrorSelector,\n  loaderLoadingSelector,\n  loaderSuccessSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { StateWithProcess } from '../process-state';\nimport { getProcessState } from './feature.selector';\n\nexport function getProcessStateFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, LoaderState<T>> {\n  return createSelector(\n    getProcessState(),\n    entityState => entityStateSelector(entityState, processId)\n  );\n}\n\nexport function getProcessLoadingFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, boolean> {\n  return createSelector(\n    getProcessStateFactory(processId),\n    loaderState => loaderLoadingSelector(loaderState)\n  );\n}\n\nexport function getProcessSuccessFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, boolean> {\n  return createSelector(\n    getProcessStateFactory(processId),\n    loaderState => loaderSuccessSelector(loaderState)\n  );\n}\n\nexport function getProcessErrorFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, boolean> {\n  return createSelector(\n    getProcessStateFactory(processId),\n    loaderState => loaderErrorSelector(loaderState)\n  );\n}\n","import { MemoizedSelector, createFeatureSelector } from '@ngrx/store';\n\nimport { StateWithProcess, PROCESS_FEATURE } from '../process-state';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\n\nexport function getProcessState<T>(): MemoizedSelector<\n  StateWithProcess<T>,\n  EntityLoaderState<T>\n> {\n  return createFeatureSelector<EntityLoaderState<T>>(PROCESS_FEATURE);\n}\n","import { BillingCountriesState } from '../user-state';\nimport * as fromAction from '../actions/billing-countries.action';\nimport { CLEAR_MISCS_DATA, ClearMiscsData } from '../actions/index';\n\nexport const initialState: BillingCountriesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromAction.BillingCountriesAction | ClearMiscsData\n): BillingCountriesState {\n  switch (action.type) {\n    case fromAction.LOAD_BILLING_COUNTRIES_SUCCESS: {\n      const billingCountries = action.payload;\n      const entities = billingCountries.reduce(\n        (countryEntities: { [isocode: string]: any }, name: any) => {\n          return {\n            ...countryEntities,\n            [name.isocode]: name,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case CLEAR_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { DeliveryCountriesState } from '../user-state';\nimport * as fromAction from '../actions/index';\nimport { Country } from '../../../model/address.model';\n\nexport const initialState: DeliveryCountriesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromAction.DeliveryCountriesAction | fromAction.ClearMiscsData\n): DeliveryCountriesState {\n  switch (action.type) {\n    case fromAction.LOAD_DELIVERY_COUNTRIES_SUCCESS: {\n      const deliveryCountries = action.payload;\n      const entities = deliveryCountries.reduce(\n        (countryEntities: { [isocode: string]: Country }, country: Country) => {\n          return {\n            ...countryEntities,\n            [country.isocode]: country,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case fromAction.CLEAR_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import * as fromOrderDetailsAction from '../actions/order-details.action';\nimport { OrderDetailsState } from '../user-state';\nimport { Order } from '../../../model/order.model';\n\nexport const initialState: OrderDetailsState = {\n  order: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromOrderDetailsAction.OrderDetailsAction\n): OrderDetailsState {\n  switch (action.type) {\n    case fromOrderDetailsAction.LOAD_ORDER_DETAILS_SUCCESS: {\n      const order: Order = action.payload;\n\n      return {\n        ...state,\n        order,\n      };\n    }\n    case fromOrderDetailsAction.CLEAR_ORDER_DETAILS: {\n      return initialState;\n    }\n  }\n  return state;\n}\n","import * as fromPaymentMethodsAction from '../actions/payment-methods.action';\nimport { PaymentDetails } from '../../../model/cart.model';\n\nexport const initialState: PaymentDetails[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: fromPaymentMethodsAction.UserPaymentMethodsAction\n): PaymentDetails[] {\n  switch (action.type) {\n    case fromPaymentMethodsAction.LOAD_USER_PAYMENT_METHODS_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n\n    case fromPaymentMethodsAction.LOAD_USER_PAYMENT_METHODS_FAIL: {\n      return initialState;\n    }\n  }\n  return state;\n}\n","import { RegionsState } from '../user-state';\nimport * as fromAction from '../actions/index';\nimport { Region } from '../../../model/address.model';\n\nexport const initialState: RegionsState = {\n  entities: [],\n  country: null,\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromAction.RegionsAction | fromAction.ClearMiscsData\n): RegionsState {\n  switch (action.type) {\n    case fromAction.LOAD_REGIONS_SUCCESS: {\n      const entities: Region[] = action.payload.entities;\n      const country: string = action.payload.country;\n      if (entities) {\n        return {\n          ...state,\n          entities,\n          country,\n        };\n      }\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import * as fromAction from '../actions/reset-password.action';\n\nexport const initialState = false;\n\nexport function reducer(\n  state = initialState,\n  action: fromAction.ResetPasswordAction\n): boolean {\n  switch (action.type) {\n    case fromAction.RESET_PASSWORD_SUCCESS: {\n      return true;\n    }\n  }\n  return state;\n}\n","import { TitlesState } from '../user-state';\nimport * as fromAction from '../actions/index';\nimport { Title } from '../../../model/misc.model';\n\nexport const initialState: TitlesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromAction.TitlesAction | fromAction.ClearMiscsData\n): TitlesState {\n  switch (action.type) {\n    case fromAction.LOAD_TITLES_SUCCESS: {\n      const titles = action.payload;\n      const entities = titles.reduce(\n        (titleEntities: { [code: string]: Title }, name: Title) => {\n          return {\n            ...titleEntities,\n            [name.code]: name,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case fromAction.CLEAR_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import * as fromActions from '../actions/user-addresses.action';\nimport { Address } from '../../../model/address.model';\n\nexport const initialState: Address[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: fromActions.UserAddressesAction\n): Address[] {\n  switch (action.type) {\n    case fromActions.LOAD_USER_ADDRESSES_FAIL: {\n      return initialState;\n    }\n\n    case fromActions.LOAD_USER_ADDRESSES_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n  }\n  return state;\n}\n","import * as fromActions from '../actions/user-consents.action';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\nexport const initialState: ConsentTemplate[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: fromActions.UserConsentsAction\n): ConsentTemplate[] {\n  switch (action.type) {\n    case fromActions.LOAD_USER_CONSENTS_SUCCESS: {\n      const consents = action.payload;\n      return consents ? consents : initialState;\n    }\n\n    case fromActions.GIVE_USER_CONSENT_SUCCESS: {\n      const updatedConsentTemplate = action.consentTemplate;\n      return state.map(consentTemplate =>\n        consentTemplate.id === updatedConsentTemplate.id\n          ? updatedConsentTemplate\n          : consentTemplate\n      );\n    }\n  }\n\n  return state;\n}\n","import * as fromUpdateEmailAction from '../actions/update-email.action';\nimport * as fromUserDetailsAction from '../actions/user-details.action';\nimport { User } from '../../../model/misc.model';\n\nexport const initialState: User = <User>{};\n\nexport function reducer(\n  state = initialState,\n  action:\n    | fromUserDetailsAction.UserDetailsAction\n    | fromUpdateEmailAction.EmailActions\n): User {\n  switch (action.type) {\n    case fromUserDetailsAction.LOAD_USER_DETAILS_SUCCESS: {\n      return action.payload;\n    }\n\n    case fromUserDetailsAction.UPDATE_USER_DETAILS_SUCCESS: {\n      const updatedDetails: User = {\n        ...state,\n        ...action.userUpdates,\n      };\n      return {\n        ...updatedDetails,\n        name: `${updatedDetails.firstName} ${updatedDetails.lastName}`,\n      };\n    }\n  }\n\n  return state;\n}\n","import * as fromUserOrdersAction from '../actions/user-orders.action';\nimport { OrderHistoryList } from '../../../model/order.model';\n\nexport const initialState: OrderHistoryList = {\n  orders: [],\n  pagination: {},\n  sorts: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: fromUserOrdersAction.UserOrdersAction\n): OrderHistoryList {\n  switch (action.type) {\n    case fromUserOrdersAction.LOAD_USER_ORDERS_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n    case fromUserOrdersAction.LOAD_USER_ORDERS_FAIL: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  ActionReducer,\n  ActionReducerMap,\n  combineReducers,\n  MetaReducer,\n} from '@ngrx/store';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { Address } from '../../../model/address.model';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { OrderHistoryList } from '../../../model/order.model';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport {\n  REGIONS,\n  RegionsState,\n  UserState,\n  USER_ADDRESSES,\n  USER_CONSENTS,\n  USER_ORDERS,\n  USER_PAYMENT_METHODS,\n} from '../user-state';\nimport * as fromBillingCountriesReducer from './billing-countries.reducer';\nimport * as fromDeliveryCountries from './delivery-countries.reducer';\nimport * as fromOrderDetailsReducer from './order-details.reducer';\nimport * as fromPaymentReducer from './payment-methods.reducer';\nimport * as fromRegionsReducer from './regions.reducer';\nimport * as fromResetPasswordReducer from './reset-password.reducer';\nimport * as fromTitlesReducer from './titles.reducer';\nimport * as fromAddressesReducer from './user-addresses.reducer';\nimport * as fromUserConsentsReducer from './user-consents.reducer';\nimport * as fromUserDetailsReducer from './user-details.reducer';\nimport * as fromUserOrdersReducer from './user-orders.reducer';\n\nexport function getReducers(): ActionReducerMap<UserState> {\n  return {\n    account: combineReducers({\n      details: fromUserDetailsReducer.reducer,\n    }),\n    addresses: loaderReducer<Address[]>(\n      USER_ADDRESSES,\n      fromAddressesReducer.reducer\n    ),\n    billingCountries: fromBillingCountriesReducer.reducer,\n    consents: loaderReducer<ConsentTemplate[]>(\n      USER_CONSENTS,\n      fromUserConsentsReducer.reducer\n    ),\n    payments: loaderReducer<PaymentDetails[]>(\n      USER_PAYMENT_METHODS,\n      fromPaymentReducer.reducer\n    ),\n    orders: loaderReducer<OrderHistoryList>(\n      USER_ORDERS,\n      fromUserOrdersReducer.reducer\n    ),\n    order: fromOrderDetailsReducer.reducer,\n    countries: fromDeliveryCountries.reducer,\n    titles: fromTitlesReducer.reducer,\n    regions: loaderReducer<RegionsState>(REGIONS, fromRegionsReducer.reducer),\n    resetPassword: fromResetPasswordReducer.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<UserState>\n> = new InjectionToken<ActionReducerMap<UserState>>('UserReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearUserState(\n  reducer: ActionReducer<any>\n): ActionReducer<any> {\n  return function(state, action) {\n    if (action.type === AuthActions.LOGOUT) {\n      state = undefined;\n    }\n\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearUserState];\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateWithUser, UserState, USER_FEATURE } from '../user-state';\n\nexport const getUserState: MemoizedSelector<\n  StateWithUser,\n  UserState\n> = createFeatureSelector<UserState>(USER_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Country } from '../../../model/address.model';\nimport {\n  BillingCountriesState,\n  BillingCountryEntities,\n  StateWithUser,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getBillingCountriesState: MemoizedSelector<\n  StateWithUser,\n  BillingCountriesState\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.billingCountries\n);\n\nexport const getBillingCountriesEntites: MemoizedSelector<\n  StateWithUser,\n  BillingCountryEntities\n> = createSelector(\n  getBillingCountriesState,\n  (state: BillingCountriesState) => state.entities\n);\n\nexport const getAllBillingCountries: MemoizedSelector<\n  StateWithUser,\n  Country[]\n> = createSelector(\n  getBillingCountriesEntites,\n  entites => Object.keys(entites).map(isocode => entites[isocode])\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Country } from '../../../model/address.model';\nimport {\n  DeliveryCountriesState,\n  DeliveryCountryEntities,\n  StateWithUser,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getDeliveryCountriesState: MemoizedSelector<\n  StateWithUser,\n  DeliveryCountriesState\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.countries\n);\n\nexport const getDeliveryCountriesEntites: MemoizedSelector<\n  StateWithUser,\n  DeliveryCountryEntities\n> = createSelector(\n  getDeliveryCountriesState,\n  (state: DeliveryCountriesState) => state.entities\n);\n\nexport const getAllDeliveryCountries: MemoizedSelector<\n  StateWithUser,\n  Country[]\n> = createSelector(\n  getDeliveryCountriesEntites,\n  entites => Object.keys(entites).map(isocode => entites[isocode])\n);\n\nexport const countrySelectorFactory = (\n  isocode: string\n): MemoizedSelector<StateWithUser, Country> =>\n  createSelector(\n    getDeliveryCountriesEntites,\n    entities => (Object.keys(entities).length !== 0 ? entities[isocode] : null)\n  );\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Order } from '../../../model/order.model';\nimport { OrderDetailsState, StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getOrderState: MemoizedSelector<\n  StateWithUser,\n  OrderDetailsState\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.order\n);\n\nexport const getOrderDetails: MemoizedSelector<\n  StateWithUser,\n  Order\n> = createSelector(\n  getOrderState,\n  (state: OrderDetailsState) => state.order\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderLoadingSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getPaymentMethodsState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<PaymentDetails[]>\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.payments\n);\n\nexport const getPaymentMethods: MemoizedSelector<\n  StateWithUser,\n  PaymentDetails[]\n> = createSelector(\n  getPaymentMethodsState,\n  (state: LoaderState<PaymentDetails[]>) => loaderValueSelector(state)\n);\n\nexport const getPaymentMethodsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getPaymentMethodsState,\n  (state: LoaderState<PaymentDetails[]>) => loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Region } from '../../../model/address.model';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderLoadingSelector,\n  loaderSuccessSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { RegionsState, StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getRegionsLoaderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<RegionsState>\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.regions\n);\n\nexport const getAllRegions: MemoizedSelector<\n  StateWithUser,\n  Region[]\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) => {\n    return loaderValueSelector(state).entities;\n  }\n);\n\nexport const getRegionsDataAndLoading: MemoizedSelector<\n  StateWithUser,\n  {\n    loaded: boolean;\n    loading: boolean;\n    regions: Region[];\n    country: string;\n  }\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) => ({\n    loaded: loaderSuccessSelector(state),\n    loading: loaderLoadingSelector(state),\n    regions: loaderValueSelector(state).entities,\n    country: loaderValueSelector(state).country,\n  })\n);\n\nexport const getRegionsCountry: MemoizedSelector<\n  StateWithUser,\n  string\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) => loaderValueSelector(state).country\n);\n\nexport const getRegionsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) => loaderLoadingSelector(state)\n);\n\nexport const getRegionsLoaded: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) => loaderSuccessSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getResetPassword: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.resetPassword\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Title } from '../../../model/misc.model';\nimport {\n  StateWithUser,\n  TitleEntities,\n  TitlesState,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getTitlesState: MemoizedSelector<\n  StateWithUser,\n  TitlesState\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.titles\n);\n\nexport const getTitlesEntites: MemoizedSelector<\n  StateWithUser,\n  TitleEntities\n> = createSelector(\n  getTitlesState,\n  (state: TitlesState) => state.entities\n);\n\nexport const getAllTitles: MemoizedSelector<\n  StateWithUser,\n  Title[]\n> = createSelector(\n  getTitlesEntites,\n  entites => Object.keys(entites).map(code => entites[code])\n);\n\nexport const titleSelectorFactory = (\n  code: string\n): MemoizedSelector<StateWithUser, Title> =>\n  createSelector(\n    getTitlesEntites,\n    entities => (Object.keys(entities).length !== 0 ? entities[code] : null)\n  );\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Address } from '../../../model/address.model';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderLoadingSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getAddressesLoaderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<Address[]>\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.addresses\n);\n\nexport const getAddresses: MemoizedSelector<\n  StateWithUser,\n  Address[]\n> = createSelector(\n  getAddressesLoaderState,\n  (state: LoaderState<Address[]>) => loaderValueSelector(state)\n);\n\nexport const getAddressesLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getAddressesLoaderState,\n  (state: LoaderState<Address[]>) => loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderErrorSelector,\n  loaderLoadingSelector,\n  loaderSuccessSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getConsentsState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ConsentTemplate[]>\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.consents\n);\n\nexport const getConsentsValue: MemoizedSelector<\n  StateWithUser,\n  ConsentTemplate[]\n> = createSelector(\n  getConsentsState,\n  loaderValueSelector\n);\n\nexport const getConsentsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getConsentsState,\n  loaderLoadingSelector\n);\n\nexport const getConsentsSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getConsentsState,\n  loaderSuccessSelector\n);\n\nexport const getConsentsError: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getConsentsState,\n  loaderErrorSelector\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { User } from '../../../model/misc.model';\nimport { StateWithUser, UserDetailsState, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getDetailsState: MemoizedSelector<\n  StateWithUser,\n  UserDetailsState\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.account\n);\n\nexport const getDetails: MemoizedSelector<StateWithUser, User> = createSelector(\n  getDetailsState,\n  (state: UserDetailsState) => state.details\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { OrderHistoryList } from '../../../model/order.model';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderSuccessSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getOrdersState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<OrderHistoryList>\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.orders\n);\n\nexport const getOrdersLoaded: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getOrdersState,\n  (state: LoaderState<OrderHistoryList>) => loaderSuccessSelector(state)\n);\n\nexport const getOrders: MemoizedSelector<\n  StateWithUser,\n  OrderHistoryList\n> = createSelector(\n  getOrdersState,\n  (state: LoaderState<OrderHistoryList>) => loaderValueSelector(state)\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { Title, User, UserSignUp } from '../../model/misc.model';\nimport { USERID_CURRENT } from '../../occ/utils/occ-constants';\nimport * as fromProcessStore from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport * as fromStore from '../store/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  UPDATE_EMAIL_PROCESS_ID,\n  UPDATE_USER_DETAILS_PROCESS_ID,\n} from '../store/user-state';\n\n@Injectable()\nexport class UserService {\n  constructor(\n    protected store: Store<\n      fromStore.StateWithUser | fromProcessStore.StateWithProcess<void>\n    >\n  ) {}\n\n  /**\n   * Returns a user\n   */\n  get(): Observable<User> {\n    return this.store.pipe(\n      select(UsersSelectors.getDetails),\n      tap(details => {\n        if (Object.keys(details).length === 0) {\n          this.load();\n        }\n      })\n    );\n  }\n\n  /**\n   * Loads the user's details\n   */\n  load(): void {\n    this.store.dispatch(new fromStore.LoadUserDetails(USERID_CURRENT));\n  }\n\n  /**\n   * Register a new user\n   *\n   * @param submitFormData as UserRegisterFormData\n   */\n  register(userRegisterFormData: UserSignUp): void {\n    this.store.dispatch(new fromStore.RegisterUser(userRegisterFormData));\n  }\n\n  /**\n   * Remove user account, that's also called close user's account\n   */\n  remove(): void {\n    this.store.dispatch(new fromStore.RemoveUser(USERID_CURRENT));\n  }\n\n  /**\n   * Returns the remove user loading flag\n   */\n  getRemoveUserResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(fromStore.REMOVE_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the remove user failure outcome.\n   */\n  getRemoveUserResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(fromStore.REMOVE_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the remove user process success outcome.\n   */\n  getRemoveUserResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(fromStore.REMOVE_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the remove user process state. The state needs to be reset after the process\n   * concludes, regardless if it's a success or an error\n   */\n  resetRemoveUserProcessState(): void {\n    this.store.dispatch(new fromStore.RemoveUserReset());\n  }\n\n  /**\n   * Returns titles\n   */\n  getTitles(): Observable<Title[]> {\n    return this.store.pipe(select(UsersSelectors.getAllTitles));\n  }\n\n  /**\n   * Retrieves titles\n   */\n  loadTitles(): void {\n    this.store.dispatch(new fromStore.LoadTitles());\n  }\n\n  /**\n   * Return whether user's password is successfully reset\n   */\n  isPasswordReset(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getResetPassword));\n  }\n\n  /**\n   * Updates the user's details\n   * @param userDetails to be updated\n   */\n  updatePersonalDetails(userDetails: User): void {\n    this.store.dispatch(\n      new fromStore.UpdateUserDetails({ username: USERID_CURRENT, userDetails })\n    );\n  }\n\n  /**\n   * Returns the update user's personal details loading flag\n   */\n  getUpdatePersonalDetailsResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(UPDATE_USER_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's personal details error flag\n   */\n  getUpdatePersonalDetailsResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(UPDATE_USER_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's personal details success flag\n   */\n  getUpdatePersonalDetailsResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(UPDATE_USER_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the update user details processing state\n   */\n  resetUpdatePersonalDetailsProcessingState(): void {\n    this.store.dispatch(new fromStore.ResetUpdateUserDetails());\n  }\n\n  /**\n   * Reset new password.  Part of the forgot password flow.\n   * @param token\n   * @param password\n   */\n  resetPassword(token: string, password: string): void {\n    this.store.dispatch(new fromStore.ResetPassword({ token, password }));\n  }\n\n  /*\n   * Request an email to reset a forgotten password.\n   */\n  requestForgotPasswordEmail(userEmailAddress: string): void {\n    this.store.dispatch(\n      new fromStore.ForgotPasswordEmailRequest(userEmailAddress)\n    );\n  }\n\n  /**\n   * Updates the user's email\n   */\n  updateEmail(password: string, newUid: string): void {\n    this.store.dispatch(\n      new fromStore.UpdateEmailAction({ uid: USERID_CURRENT, password, newUid })\n    );\n  }\n\n  /**\n   * Returns the update user's email success flag\n   */\n  getUpdateEmailResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(UPDATE_EMAIL_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's email error flag\n   */\n  getUpdateEmailResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(UPDATE_EMAIL_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's email loading flag\n   */\n  getUpdateEmailResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(UPDATE_EMAIL_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the update user's email processing state\n   */\n  resetUpdateEmailResultState(): void {\n    this.store.dispatch(new fromStore.ResetUpdateEmailAction());\n  }\n\n  /**\n   * Updates the password for the user\n   * @param oldPassword the current password that will be changed\n   * @param newPassword the new password\n   */\n  updatePassword(oldPassword: string, newPassword: string): void {\n    this.store.dispatch(\n      new fromStore.UpdatePassword({\n        userId: USERID_CURRENT,\n        oldPassword,\n        newPassword,\n      })\n    );\n  }\n\n  /**\n   * Returns the update password loading flag\n   */\n  getUpdatePasswordResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(fromStore.UPDATE_PASSWORD_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update password failure outcome.\n   */\n  getUpdatePasswordResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(fromStore.UPDATE_PASSWORD_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update password process success outcome.\n   */\n  getUpdatePasswordResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(fromStore.UPDATE_PASSWORD_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the update password process state. The state needs to be reset after the process\n   * concludes, regardless if it's a success or an error\n   */\n  resetUpdatePasswordProcessState(): void {\n    this.store.dispatch(new fromStore.UpdatePasswordReset());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Address, Country, Region } from '../../model/address.model';\nimport { USERID_CURRENT } from '../../occ/utils/occ-constants';\nimport * as fromProcessStore from '../../process/store/process-state';\nimport * as fromStore from '../store/index';\nimport { UsersSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserAddressService {\n  constructor(\n    protected store: Store<\n      fromStore.StateWithUser | fromProcessStore.StateWithProcess<void>\n    >\n  ) {}\n\n  /**\n   * Retrieves user's addresses\n   */\n  loadAddresses(): void {\n    this.store.dispatch(new fromStore.LoadUserAddresses(USERID_CURRENT));\n  }\n\n  /**\n   * Adds user address\n   * @param address a user address\n   */\n  addUserAddress(address: Address): void {\n    this.store.dispatch(\n      new fromStore.AddUserAddress({\n        userId: USERID_CURRENT,\n        address: address,\n      })\n    );\n  }\n\n  /**\n   * Sets user address as default\n   * @param addressId a user address ID\n   */\n  setAddressAsDefault(addressId: string): void {\n    this.store.dispatch(\n      new fromStore.UpdateUserAddress({\n        userId: USERID_CURRENT,\n        addressId: addressId,\n        address: { defaultAddress: true },\n      })\n    );\n  }\n\n  /**\n   * Updates existing user address\n   * @param addressId a user address ID\n   * @param address a user address\n   */\n  updateUserAddress(addressId: string, address: Address): void {\n    this.store.dispatch(\n      new fromStore.UpdateUserAddress({\n        userId: USERID_CURRENT,\n        addressId: addressId,\n        address: address,\n      })\n    );\n  }\n\n  /**\n   * Deletes existing user address\n   * @param addressId a user address ID\n   */\n  deleteUserAddress(addressId: string): void {\n    this.store.dispatch(\n      new fromStore.DeleteUserAddress({\n        userId: USERID_CURRENT,\n        addressId: addressId,\n      })\n    );\n  }\n\n  /**\n   * Returns addresses\n   */\n  getAddresses(): Observable<Address[]> {\n    return this.store.pipe(select(UsersSelectors.getAddresses));\n  }\n\n  /**\n   * Returns a loading flag for addresses\n   */\n  getAddressesLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getAddressesLoading));\n  }\n\n  /**\n   * Retrieves delivery countries\n   */\n  loadDeliveryCountries(): void {\n    this.store.dispatch(new fromStore.LoadDeliveryCountries());\n  }\n\n  /**\n   * Returns all delivery countries\n   */\n  getDeliveryCountries(): Observable<Country[]> {\n    return this.store.pipe(select(UsersSelectors.getAllDeliveryCountries));\n  }\n\n  /**\n   * Returns a country based on the provided `isocode`\n   * @param isocode an isocode for a country\n   */\n  getCountry(isocode: string): Observable<Country> {\n    return this.store.pipe(\n      select(UsersSelectors.countrySelectorFactory(isocode))\n    );\n  }\n\n  /**\n   * Retrieves regions for specified country by `countryIsoCode`\n   * @param countryIsoCode\n   */\n  loadRegions(countryIsoCode: string): void {\n    this.store.dispatch(new fromStore.LoadRegions(countryIsoCode));\n  }\n\n  /**\n   * Clear regions in store - useful when changing country\n   */\n  clearRegions(): void {\n    this.store.dispatch(new fromStore.ClearRegions());\n  }\n\n  /**\n   * Returns all regions\n   */\n  getRegions(countryIsoCode: string): Observable<Region[]> {\n    return this.store.pipe(\n      select(UsersSelectors.getRegionsDataAndLoading),\n      map(({ regions, country, loading, loaded }) => {\n        if (!countryIsoCode && (loading || loaded)) {\n          this.clearRegions();\n          return [];\n        } else if (loading && !loaded) {\n          // don't interrupt loading\n          return [];\n        } else if (!loading && countryIsoCode !== country && countryIsoCode) {\n          // country changed - clear store and load new regions\n          if (country) {\n            this.clearRegions();\n          }\n          this.loadRegions(countryIsoCode);\n          return [];\n        }\n        return regions;\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { ConsentTemplate } from '../../model/consent.model';\nimport { USERID_CURRENT } from '../../occ/utils/occ-constants';\nimport * as fromProcessStore from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport * as fromStore from '../store/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  GIVE_CONSENT_PROCESS_ID,\n  WITHDRAW_CONSENT_PROCESS_ID,\n} from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserConsentService {\n  constructor(\n    protected store: Store<\n      fromStore.StateWithUser | fromProcessStore.StateWithProcess<void>\n    >\n  ) {}\n\n  /**\n   * Retrieves all consents.\n   */\n  loadConsents(): void {\n    this.store.dispatch(new fromStore.LoadUserConsents(USERID_CURRENT));\n  }\n\n  /**\n   * Returns all consents\n   */\n  getConsents(): Observable<ConsentTemplate[]> {\n    return this.store.pipe(select(UsersSelectors.getConsentsValue));\n  }\n\n  /**\n   * Returns the consents loading flag\n   */\n  getConsentsResultLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getConsentsLoading));\n  }\n\n  /**\n   * Returns the consents success flag\n   */\n  getConsentsResultSuccess(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getConsentsSuccess));\n  }\n\n  /**\n   * Returns the consents error flag\n   */\n  getConsentsResultError(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getConsentsError));\n  }\n\n  /**\n   * Resets the processing state for consent retrieval\n   */\n  resetConsentsProcessState(): void {\n    this.store.dispatch(new fromStore.ResetLoadUserConsents());\n  }\n\n  /**\n   * Give consent for specified consent template ID and version.\n   * @param consentTemplateId a template ID for which to give a consent\n   * @param consentTemplateVersion a template version for which to give a consent\n   */\n  giveConsent(consentTemplateId: string, consentTemplateVersion: number): void {\n    this.store.dispatch(\n      new fromStore.GiveUserConsent({\n        userId: USERID_CURRENT,\n        consentTemplateId,\n        consentTemplateVersion,\n      })\n    );\n  }\n\n  /**\n   * Returns the give consent process loading flag\n   */\n  getGiveConsentResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(GIVE_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the give consent process success flag\n   */\n  getGiveConsentResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(GIVE_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the give consent process error flag\n   */\n  getGiveConsentResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(GIVE_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resents the give consent process flags\n   */\n  resetGiveConsentProcessState(): void {\n    return this.store.dispatch(new fromStore.ResetGiveUserConsentProcess());\n  }\n\n  /**\n   * Withdraw consent for the given `consentCode`\n   * @param consentCode for which to withdraw the consent\n   */\n  withdrawConsent(consentCode: string): void {\n    this.store.dispatch(\n      new fromStore.WithdrawUserConsent({ userId: USERID_CURRENT, consentCode })\n    );\n  }\n\n  /**\n   * Returns the withdraw consent process loading flag\n   */\n  getWithdrawConsentResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(WITHDRAW_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the withdraw consent process success flag\n   */\n  getWithdrawConsentResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(WITHDRAW_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the withdraw consent process error flag\n   */\n  getWithdrawConsentResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(WITHDRAW_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the process flags for withdraw consent\n   */\n  resetWithdrawConsentProcessState(): void {\n    return this.store.dispatch(new fromStore.ResetWithdrawUserConsentProcess());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { Country } from '../../model/address.model';\nimport { PaymentDetails } from '../../model/cart.model';\nimport { USERID_CURRENT } from '../../occ/utils/occ-constants';\nimport * as fromProcessStore from '../../process/store/process-state';\nimport * as fromStore from '../store/index';\nimport { UsersSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserPaymentService {\n  constructor(\n    protected store: Store<\n      fromStore.StateWithUser | fromProcessStore.StateWithProcess<void>\n    >\n  ) {}\n\n  /**\n   * Loads all user's payment methods.\n   */\n  loadPaymentMethods(): void {\n    this.store.dispatch(new fromStore.LoadUserPaymentMethods(USERID_CURRENT));\n  }\n\n  /**\n   * Returns all user's payment methods\n   */\n  getPaymentMethods(): Observable<PaymentDetails[]> {\n    return this.store.pipe(select(UsersSelectors.getPaymentMethods));\n  }\n\n  /**\n   * Returns a loading flag for payment methods\n   */\n  getPaymentMethodsLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getPaymentMethodsLoading));\n  }\n\n  /**\n   * Sets the payment as a default one\n   * @param paymentMethodId a payment method ID\n   */\n  setPaymentMethodAsDefault(paymentMethodId: string): void {\n    this.store.dispatch(\n      new fromStore.SetDefaultUserPaymentMethod({\n        userId: USERID_CURRENT,\n        paymentMethodId,\n      })\n    );\n  }\n\n  /**\n   * Deletes the payment method\n   *\n   * @param paymentMethodId a payment method ID\n   */\n  deletePaymentMethod(paymentMethodId: string): void {\n    this.store.dispatch(\n      new fromStore.DeleteUserPaymentMethod({\n        userId: USERID_CURRENT,\n        paymentMethodId,\n      })\n    );\n  }\n\n  /**\n   * Returns all billing countries\n   */\n  getAllBillingCountries(): Observable<Country[]> {\n    return this.store.pipe(select(UsersSelectors.getAllBillingCountries));\n  }\n\n  /**\n   * Retrieves billing countries\n   */\n  loadBillingCountries(): void {\n    this.store.dispatch(new fromStore.LoadBillingCountries());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { Order, OrderHistoryList } from '../../model/order.model';\nimport { USERID_CURRENT } from '../../occ/utils/occ-constants';\nimport * as fromProcessStore from '../../process/store/process-state';\nimport * as fromStore from '../store/index';\nimport { UsersSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserOrderService {\n  constructor(\n    protected store: Store<\n      fromStore.StateWithUser | fromProcessStore.StateWithProcess<void>\n    >\n  ) {}\n\n  /**\n   * Returns an order's detail\n   */\n  getOrderDetails(): Observable<Order> {\n    return this.store.pipe(select(UsersSelectors.getOrderDetails));\n  }\n\n  /**\n   * Retrieves order's details\n   *\n   * @param orderCode an order code\n   */\n  loadOrderDetails(orderCode: string): void {\n    this.store.dispatch(\n      new fromStore.LoadOrderDetails({\n        userId: USERID_CURRENT,\n        orderCode: orderCode,\n      })\n    );\n  }\n\n  /**\n   * Clears order's details\n   */\n  clearOrderDetails(): void {\n    this.store.dispatch(new fromStore.ClearOrderDetails());\n  }\n\n  /**\n   * Returns order history list\n   */\n  getOrderHistoryList(pageSize: number): Observable<OrderHistoryList> {\n    return this.store.pipe(\n      select(UsersSelectors.getOrdersState),\n      tap(orderListState => {\n        const attemptedLoad =\n          orderListState.loading ||\n          orderListState.success ||\n          orderListState.error;\n        if (!attemptedLoad) {\n          this.loadOrderList(pageSize);\n        }\n      }),\n      map(orderListState => orderListState.value)\n    );\n  }\n\n  /**\n   * Returns a loaded flag for order history list\n   */\n  getOrderHistoryListLoaded(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getOrdersLoaded));\n  }\n\n  /**\n   * Retrieves an order list\n   * @param pageSize page size\n   * @param currentPage current page\n   * @param sort sort\n   */\n  loadOrderList(pageSize: number, currentPage?: number, sort?: string): void {\n    this.store.dispatch(\n      new fromStore.LoadUserOrders({\n        userId: USERID_CURRENT,\n        pageSize: pageSize,\n        currentPage: currentPage,\n        sort: sort,\n      })\n    );\n  }\n\n  /**\n   * Cleaning order list\n   */\n  clearOrderList(): void {\n    this.store.dispatch(new fromStore.ClearUserOrders());\n  }\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducer, ActionReducerMap } from '@ngrx/store';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\nimport { entityLoaderReducer } from '../../../state/utils/entity-loader/entity-loader.reducer';\nimport { PROCESS_FEATURE } from '../process-state';\n\nexport function getReducers<T>(): ActionReducer<EntityLoaderState<T>> {\n  return entityLoaderReducer(PROCESS_FEATURE);\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<EntityLoaderState<any>>\n> = new InjectionToken<ActionReducerMap<EntityLoaderState<any>>>(\n  'ProcessReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { NgModule } from '@angular/core';\nimport { StoreModule } from '@ngrx/store';\nimport { StateModule } from '../../state/state.module';\nimport { PROCESS_FEATURE } from './process-state';\nimport { reducerProvider, reducerToken } from './reducers/index';\n\n@NgModule({\n  imports: [StateModule, StoreModule.forFeature(PROCESS_FEATURE, reducerToken)],\n  providers: [reducerProvider],\n})\nexport class ProcessStoreModule {}\n","import { NgModule } from '@angular/core';\nimport { ProcessStoreModule } from './store/process-store.module';\n\n@NgModule({\n  imports: [ProcessStoreModule],\n})\nexport class ProcessModule {}\n","import { ErrorModel } from './misc.model';\n\nexport interface Country {\n  isocode?: string;\n  name?: string;\n}\n\nexport enum CountryType {\n  BILLING = 'BILLING',\n  SHIPPING = 'SHIPPING',\n}\n\nexport interface Region {\n  countryIso?: string;\n  isocode?: string;\n  isocodeShort?: string;\n  name?: string;\n}\n\nexport interface Address {\n  companyName?: string;\n  country?: Country;\n  defaultAddress?: boolean;\n  email?: string;\n  firstName?: string;\n  formattedAddress?: string;\n  id?: string;\n  lastName?: string;\n  line1?: string;\n  line2?: string;\n  phone?: string;\n  postalCode?: string;\n  region?: Region;\n  shippingAddress?: boolean;\n  title?: string;\n  titleCode?: string;\n  town?: string;\n  visibleInAddressBook?: boolean;\n}\n\nexport interface AddressValidation {\n  decision?: string;\n  // TODO: Simplify with converter\n  errors?: { errors: ErrorModel[] };\n  suggestedAddresses?: Address[];\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { CountryType } from '../../../model/address.model';\nimport { SiteConnector } from '../../../site-context/connectors/site.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport * as fromAction from '../actions/billing-countries.action';\n\n@Injectable()\nexport class BillingCountriesEffect {\n  @Effect()\n  loadBillingCountries$: Observable<\n    fromAction.BillingCountriesAction\n  > = this.actions$.pipe(\n    ofType(fromAction.LOAD_BILLING_COUNTRIES),\n    switchMap(() => {\n      return this.siteConnector.getCountries(CountryType.BILLING).pipe(\n        map(countries => new fromAction.LoadBillingCountriesSuccess(countries)),\n        catchError(error =>\n          of(\n            new fromAction.LoadBillingCountriesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\n\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\n\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport { ClearMiscsData } from '../actions/index';\nimport { CURRENCY_CHANGE } from '../../../site-context/store/actions/currencies.action';\nimport { LANGUAGE_CHANGE } from '../../../site-context/store/actions/languages.action';\n\n@Injectable()\nexport class ClearMiscsDataEffect {\n  @Effect()\n  clearMiscsData$: Observable<Action> = this.actions$.pipe(\n    ofType(LANGUAGE_CHANGE, CURRENCY_CHANGE),\n    map(() => {\n      return new ClearMiscsData();\n    })\n  );\n\n  constructor(private actions$: Actions) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { CountryType } from '../../../model/address.model';\nimport { SiteConnector } from '../../../site-context/connectors/site.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport * as fromAction from '../actions/delivery-countries.action';\n\n@Injectable()\nexport class DeliveryCountriesEffects {\n  @Effect()\n  loadDeliveryCountries$: Observable<\n    fromAction.DeliveryCountriesAction\n  > = this.actions$.pipe(\n    ofType(fromAction.LOAD_DELIVERY_COUNTRIES),\n    switchMap(() => {\n      return this.siteConnector.getCountries(CountryType.SHIPPING).pipe(\n        map(\n          countries => new fromAction.LoadDeliveryCountriesSuccess(countries)\n        ),\n        catchError(error =>\n          of(\n            new fromAction.LoadDeliveryCountriesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { Translatable } from '../../i18n/translatable';\n\nexport enum GlobalMessageType {\n  MSG_TYPE_CONFIRMATION = '[GlobalMessage] Confirmation',\n  MSG_TYPE_ERROR = '[GlobalMessage] Error',\n  MSG_TYPE_INFO = '[GlobalMessage] Information',\n}\n\nexport interface GlobalMessage {\n  text: Translatable;\n  type: GlobalMessageType;\n}\n","import { ServerConfig } from '../../config/server-config/server-config';\nimport { GlobalMessageType } from '../models/global-message.model';\n\nexport type GlobalMessageTypeConfig = {\n  timeout?: number;\n};\n\nexport abstract class GlobalMessageConfig extends ServerConfig {\n  globalMessages: {\n    [GlobalMessageType.MSG_TYPE_CONFIRMATION]?: GlobalMessageTypeConfig;\n    [GlobalMessageType.MSG_TYPE_INFO]?: GlobalMessageTypeConfig;\n    [GlobalMessageType.MSG_TYPE_ERROR]?: GlobalMessageTypeConfig;\n  };\n}\n","import { Action } from '@ngrx/store';\nimport {\n  GlobalMessageType,\n  GlobalMessage,\n} from '../../models/global-message.model';\n\nexport const ADD_MESSAGE = '[Global-message] Add a Message';\nexport const REMOVE_MESSAGE = '[Global-message] Remove a Message';\nexport const REMOVE_MESSAGES_BY_TYPE =\n  '[Global-message] Remove messages by type';\n\nexport class AddMessage implements Action {\n  readonly type = ADD_MESSAGE;\n  constructor(public payload: GlobalMessage) {}\n}\n\nexport class RemoveMessage implements Action {\n  readonly type = REMOVE_MESSAGE;\n  constructor(public payload: { type: GlobalMessageType; index: number }) {}\n}\n\nexport class RemoveMessagesByType implements Action {\n  readonly type = REMOVE_MESSAGES_BY_TYPE;\n  constructor(public payload: GlobalMessageType) {}\n}\n\nexport type GlobalMessageAction =\n  | AddMessage\n  | RemoveMessage\n  | RemoveMessagesByType;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  GlobalMessageState,\n  GLOBAL_MESSAGE_FEATURE,\n  StateWithGlobalMessage,\n} from '../global-message-state';\n\nexport const getGlobalMessageState: MemoizedSelector<\n  StateWithGlobalMessage,\n  GlobalMessageState\n> = createFeatureSelector<GlobalMessageState>(GLOBAL_MESSAGE_FEATURE);\n","import { Translatable } from '../../i18n/translatable';\n\nexport const GLOBAL_MESSAGE_FEATURE = 'global-message';\n\nexport interface StateWithGlobalMessage {\n  [GLOBAL_MESSAGE_FEATURE]: GlobalMessageState;\n}\n\nexport interface GlobalMessageState {\n  entities: GlobalMessageEntities;\n}\n\nexport interface GlobalMessageEntities {\n  [messageType: string]: Translatable[];\n}\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Translatable } from '../../../i18n/translatable';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport {\n  GlobalMessageEntities,\n  GlobalMessageState,\n  StateWithGlobalMessage,\n} from '../global-message-state';\nimport { getGlobalMessageState } from './feature.selector';\n\nexport const getGlobalMessageEntities: MemoizedSelector<\n  StateWithGlobalMessage,\n  GlobalMessageEntities\n> = createSelector(\n  getGlobalMessageState,\n  (state: GlobalMessageState) => state.entities\n);\n\nexport const getGlobalMessageEntitiesByType = (\n  type: GlobalMessageType\n): MemoizedSelector<StateWithGlobalMessage, Translatable[]> => {\n  return createSelector(\n    getGlobalMessageEntities,\n    entities => entities && entities[type]\n  );\n};\n\nexport const getGlobalMessageCountByType = (\n  type: GlobalMessageType\n): MemoizedSelector<StateWithGlobalMessage, number> => {\n  return createSelector(\n    getGlobalMessageEntitiesByType(type),\n    entities => entities && entities.length\n  );\n};\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter } from 'rxjs/operators';\nimport { Translatable } from '../../i18n/translatable';\nimport { GlobalMessageType } from '../models/global-message.model';\nimport * as fromGlobalMessageActions from '../store/actions/index';\nimport {\n  GlobalMessageEntities,\n  StateWithGlobalMessage,\n} from '../store/global-message-state';\nimport { GlobalMessageSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class GlobalMessageService {\n  constructor(protected store: Store<StateWithGlobalMessage>) {}\n\n  /**\n   * Get all global messages\n   */\n  get(): Observable<GlobalMessageEntities> {\n    return this.store.pipe(\n      select(GlobalMessageSelectors.getGlobalMessageEntities),\n      filter(data => data !== undefined)\n    );\n  }\n\n  /**\n   * Add one message into store\n   * @param text: string | Translatable\n   * @param type: GlobalMessageType object\n   */\n  add(text: string | Translatable, type: GlobalMessageType): void {\n    this.store.dispatch(\n      new fromGlobalMessageActions.AddMessage({\n        text: typeof text === 'string' ? { raw: text } : text,\n        type,\n      })\n    );\n  }\n\n  /**\n   * Remove message(s) from store\n   * @param type: GlobalMessageType\n   * @param index:optional. Without it, messages will be removed by type; otherwise,\n   * message will be removed from list by index.\n   */\n  remove(type: GlobalMessageType, index?: number): void {\n    this.store.dispatch(\n      index !== undefined\n        ? new fromGlobalMessageActions.RemoveMessage({\n            type: type,\n            index: index,\n          })\n        : new fromGlobalMessageActions.RemoveMessagesByType(type)\n    );\n  }\n}\n","export enum HttpResponseStatus {\n  UNKNOWN = -1,\n  BAD_REQUEST = 400,\n  FORBIDDEN = 403,\n  NOT_FOUND = 404,\n  CONFLICT = 409,\n  BAD_GATEWAY = 502,\n  GATEWAY_TIMEOUT = 504,\n}\n","import { HttpErrorResponse, HttpRequest } from '@angular/common/http';\nimport { GlobalMessageService } from '../../facade/global-message.service';\nimport { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport abstract class HttpErrorHandler {\n  constructor(protected globalMessageService: GlobalMessageService) {}\n\n  /**\n   * The http response status number which is handled by this handler.\n   * Implementations can set the response status number, i.e. 404, so that\n   * the handler can be found by the error interceptor.\n   */\n  abstract responseStatus: number;\n\n  /**\n   * Handles the error response for the respose status that is register for the handler\n   * @param { HttpRequest<any> } request : http request\n   * @param { HttpErrorResponse } errorResponse : Http error response\n   */\n  abstract handleError(\n    request: HttpRequest<any>,\n    errorResponse: HttpErrorResponse\n  ): void;\n}\n","import {\n  HttpErrorResponse,\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Inject, Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { HttpResponseStatus } from '../models/response-status.model';\nimport { HttpErrorHandler } from './handlers/http-error.handler';\n\n@Injectable()\nexport class HttpErrorInterceptor implements HttpInterceptor {\n  constructor(\n    @Inject(HttpErrorHandler) protected handlers: HttpErrorHandler[]\n  ) {\n    // We reverse the handlers to allow for custom handlers\n    // that replace standard handlers\n    this.handlers.reverse();\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return next.handle(request).pipe(\n      catchError((response: any) => {\n        if (response instanceof HttpErrorResponse) {\n          this.handleErrorResponse(request, response);\n          return throwError(response);\n        }\n      })\n    );\n  }\n\n  protected handleErrorResponse(\n    request: HttpRequest<any>,\n    response: HttpErrorResponse\n  ): void {\n    const handler = this.getResponseHandler(response);\n    if (handler) {\n      handler.handleError(request, response);\n    }\n  }\n\n  /**\n   * return the error handler that matches the `HttpResponseStatus` code.\n   * If no handler is available, the UNKNOWN handler is returned.\n   */\n  protected getResponseHandler(response: HttpErrorResponse): HttpErrorHandler {\n    const status = response.status;\n    let handler = this.handlers.find(h => h.responseStatus === status);\n    if (!handler) {\n      handler = this.handlers.find(\n        h => h.responseStatus === HttpResponseStatus.UNKNOWN\n      );\n    }\n    return handler;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageService } from '../../facade/global-message.service';\nimport { ServerConfig } from '../../../config/server-config/server-config';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UnknownErrorHandler extends HttpErrorHandler {\n  constructor(\n    private config: ServerConfig,\n    protected globalMessageService: GlobalMessageService\n  ) {\n    super(globalMessageService);\n  }\n  responseStatus = HttpResponseStatus.UNKNOWN;\n\n  handleError() {\n    if (!this.config.production) {\n      console.warn(`Unknown http response error: ${this.responseStatus}`);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class BadGatewayHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.BAD_GATEWAY;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.badGateway' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n}\n","import { HttpErrorResponse, HttpRequest } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { Translatable } from '../../../i18n/translatable';\n\nconst OAUTH_ENDPOINT = '/authorizationserver/oauth/token';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class BadRequestHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.BAD_REQUEST;\n\n  handleError(request: HttpRequest<any>, response: HttpErrorResponse): void {\n    if (\n      response.url.includes(OAUTH_ENDPOINT) &&\n      response.error &&\n      response.error.error === 'invalid_grant' &&\n      request.body.get('grant_type') === 'password'\n    ) {\n      this.globalMessageService.add(\n        {\n          key: 'httpHandlers.badRequestPleaseLoginAgain',\n          params: {\n            errorMessage:\n              response.error.error_description || response.message || '',\n          },\n        },\n        GlobalMessageType.MSG_TYPE_ERROR\n      );\n      this.globalMessageService.remove(GlobalMessageType.MSG_TYPE_CONFIRMATION);\n    } else {\n      if (\n        response.error &&\n        response.error.errors &&\n        response.error.errors instanceof Array\n      ) {\n        response.error.errors.forEach((error: ErrorModel) => {\n          let errorMessage: Translatable;\n          if (error.type === 'PasswordMismatchError') {\n            // uses en translation error message instead of backend exception error\n            // @todo: this condition could be removed if backend gives better message\n            errorMessage = {\n              key: 'httpHandlers.badRequestOldPasswordIncorrect',\n            };\n          } else if (\n            error.subjectType === 'cart' &&\n            error.reason === 'notFound'\n          ) {\n            errorMessage = { key: 'httpHandlers.cartNotFound' };\n          } else if (error.type === 'ValidationError') {\n            // build translation key in case of backend field validation error\n            errorMessage = {\n              key: `httpHandlers.validationErrors.${error.reason}.${\n                error.subject\n              }`,\n            };\n          } else {\n            // this is currently showing up in case we have a page not found. It should be a 404.\n            // see https://jira.hybris.com/browse/CMSX-8516\n            errorMessage = { raw: error.message || '' };\n          }\n          this.globalMessageService.add(\n            errorMessage,\n            GlobalMessageType.MSG_TYPE_ERROR\n          );\n        });\n      }\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConflictHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.CONFLICT;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.conflict' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ForbiddenHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.FORBIDDEN;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.forbidden' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class GatewayTimeoutHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.GATEWAY_TIMEOUT;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.gatewayTimeout' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class NotFoundHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.NOT_FOUND;\n\n  // empty error handler to avoid we fallabck to the unknown error handler\n  handleError(): void {}\n}\n","import { Provider } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\n\nimport { HttpErrorInterceptor } from './http-error.interceptor';\nimport { HttpErrorHandler } from './handlers/http-error.handler';\nimport { UnknownErrorHandler } from './handlers/unknown-error.handler';\nimport { BadGatewayHandler } from './handlers/bad-gateway.handler';\nimport { BadRequestHandler } from './handlers/bad-request.handler';\nimport { ConflictHandler } from './handlers/conflict.handler';\nimport { ForbiddenHandler } from './handlers/forbidden.handler';\nimport { GatewayTimeoutHandler } from './handlers/gateway-timeout.handler';\nimport { NotFoundHandler } from './handlers/not-found.handler';\n\nexport const errorHandlers: Provider[] = [\n  {\n    provide: HttpErrorHandler,\n    useExisting: UnknownErrorHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: BadGatewayHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: BadRequestHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: ConflictHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: ForbiddenHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: GatewayTimeoutHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: NotFoundHandler,\n    multi: true,\n  },\n];\n\nexport const httpErrorInterceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useClass: HttpErrorInterceptor,\n    multi: true,\n  },\n];\n","import { GlobalMessageAction } from '../actions/global-message.actions';\nimport {\n  GlobalMessage,\n  GlobalMessageType,\n} from '../../models/global-message.model';\nimport * as fromAction from '../actions/index';\nimport { GlobalMessageState } from '../global-message-state';\nimport { Translatable } from '../../../i18n/translatable';\nimport { deepEqualObjects } from '../../../util/compare-equal-objects';\n\nexport const initialState: GlobalMessageState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: GlobalMessageAction\n): GlobalMessageState {\n  switch (action.type) {\n    case fromAction.ADD_MESSAGE: {\n      const message: GlobalMessage = action.payload;\n\n      if (state.entities[message.type] === undefined) {\n        return {\n          ...state,\n          entities: {\n            ...state.entities,\n            [message.type]: [message.text],\n          },\n        };\n      } else {\n        const messages: Translatable[] = state.entities[message.type];\n        if (!messages.some(msg => deepEqualObjects(msg, message.text))) {\n          return {\n            ...state,\n            entities: {\n              ...state.entities,\n              [message.type]: [...messages, message.text],\n            },\n          };\n        }\n      }\n      return state;\n    }\n\n    case fromAction.REMOVE_MESSAGE: {\n      const msgType: GlobalMessageType = action.payload.type;\n      const msgIndex: number = action.payload.index;\n      if (\n        Object.keys(state.entities).length === 0 ||\n        !state.entities[msgType]\n      ) {\n        return state;\n      }\n\n      const messages = [...state.entities[msgType]];\n      messages.splice(msgIndex, 1);\n\n      return {\n        ...state,\n        entities: {\n          ...state.entities,\n          [msgType]: messages,\n        },\n      };\n    }\n\n    case fromAction.REMOVE_MESSAGES_BY_TYPE: {\n      const entities = {\n        ...state.entities,\n        [action.payload]: [],\n      };\n      return {\n        ...state,\n        entities,\n      };\n    }\n  }\n\n  return state;\n}\n","export function shallowEqualObjects(objA: object, objB: object): boolean {\n  if (objA === objB) {\n    return true;\n  }\n  if (!objA || !objB) {\n    return false;\n  }\n  const aKeys = Object.keys(objA);\n  const bKeys = Object.keys(objB);\n  const aKeysLen = aKeys.length;\n  const bKeysLen = bKeys.length;\n\n  if (aKeysLen !== bKeysLen) {\n    return false;\n  }\n  for (let i = 0; i < aKeysLen; i++) {\n    const key = aKeys[i];\n    if (objA[key] !== objB[key]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function deepEqualObjects(objA: object, objB: object): boolean {\n  if (objA === objB) {\n    return true; // if both objA and objB are null or undefined and exactly the same\n  } else if (!(objA instanceof Object) || !(objB instanceof Object)) {\n    return false; // if they are not strictly equal, they both need to be Objects\n  } else if (objA.constructor !== objB.constructor) {\n    // they must have the exact same prototype chain, the closest we can do is\n    // test their constructor.\n    return false;\n  } else {\n    for (const key in objA) {\n      if (!objA.hasOwnProperty(key)) {\n        continue; // other properties were tested using objA.constructor === y.constructor\n      }\n      if (!objB.hasOwnProperty(key)) {\n        return false; // allows to compare objA[ key ] and objB[ key ] when set to undefined\n      }\n      if (objA[key] === objB[key]) {\n        continue; // if they have the same strict value or identity then they are equal\n      }\n      if (typeof objA[key] !== 'object') {\n        return false; // Numbers, Strings, Functions, Booleans must be strictly equal\n      }\n      if (!deepEqualObjects(objA[key], objB[key])) {\n        return false;\n      }\n    }\n    for (const key in objB) {\n      if (objB.hasOwnProperty(key) && !objA.hasOwnProperty(key)) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport * as fromGlobalMessage from './global-message.reducer';\nimport { GlobalMessageState } from '../global-message-state';\nimport { ActionReducer } from '@ngrx/store';\n\nexport function getReducers(): ActionReducer<GlobalMessageState> {\n  return fromGlobalMessage.reducer;\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducer<GlobalMessageState>\n> = new InjectionToken<ActionReducer<GlobalMessageState>>(\n  'GlobalMessageReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { NgModule } from '@angular/core';\nimport { StoreModule } from '@ngrx/store';\n\nimport { reducerToken, reducerProvider } from './reducers/index';\nimport { GLOBAL_MESSAGE_FEATURE } from './global-message-state';\nimport { StateModule } from '../../state/state.module';\n\n@NgModule({\n  imports: [\n    StateModule,\n    StoreModule.forFeature(GLOBAL_MESSAGE_FEATURE, reducerToken),\n  ],\n  providers: [reducerProvider],\n})\nexport class GlobalMessageStoreModule {}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { select, Store } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { delay, filter, mergeMap, pluck, switchMap } from 'rxjs/operators';\nimport { GlobalMessageConfig } from '../../config/global-message-config';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport * as GlobalMessageActions from '../actions/global-message.actions';\nimport { StateWithGlobalMessage } from '../global-message-state';\nimport { GlobalMessageSelectors } from '../selectors/index';\n\n@Injectable()\nexport class GlobalMessageEffect {\n  @Effect()\n  hideAfterDelay$: Observable<\n    GlobalMessageActions.RemoveMessage\n  > = this.actions$.pipe(\n    ofType(GlobalMessageActions.ADD_MESSAGE),\n    pluck('payload', 'type'),\n    mergeMap((type: GlobalMessageType) => {\n      const config = this.config.globalMessages[type];\n      return this.store.pipe(\n        select(GlobalMessageSelectors.getGlobalMessageCountByType(type)),\n        filter(\n          (count: number) =>\n            config && config.timeout !== undefined && count && count > 0\n        ),\n        switchMap((count: number) =>\n          of(\n            new GlobalMessageActions.RemoveMessage({\n              type,\n              index: count - 1,\n            })\n          ).pipe(delay(config.timeout))\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private store: Store<StateWithGlobalMessage>,\n    private config: GlobalMessageConfig\n  ) {}\n}\n","import { GlobalMessageType } from '../models/global-message.model';\nimport { GlobalMessageConfig } from './global-message-config';\n\nexport function defaultGlobalMessageConfigFactory(): GlobalMessageConfig {\n  return {\n    globalMessages: {\n      [GlobalMessageType.MSG_TYPE_CONFIRMATION]: {\n        timeout: 3000,\n      },\n      [GlobalMessageType.MSG_TYPE_INFO]: {\n        timeout: 3000,\n      },\n      [GlobalMessageType.MSG_TYPE_ERROR]: {\n        timeout: 7000,\n      },\n    },\n  };\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\n\nimport { GlobalMessageService } from './facade/global-message.service';\nimport {\n  httpErrorInterceptors,\n  errorHandlers,\n} from './http-interceptors/index';\nimport { GlobalMessageStoreModule } from './store/global-message-store.module';\nimport { GlobalMessageEffect } from './store/effects/global-message.effect';\n\nimport { Config, ConfigModule } from '../config/config.module';\nimport { defaultGlobalMessageConfigFactory } from './config/default-global-message-config';\nimport { GlobalMessageConfig } from './config/global-message-config';\n\n@NgModule({\n  imports: [\n    GlobalMessageStoreModule,\n    EffectsModule.forFeature([GlobalMessageEffect]),\n    ConfigModule.withConfigFactory(defaultGlobalMessageConfigFactory),\n  ],\n  providers: [\n    GlobalMessageService,\n    { provide: GlobalMessageConfig, useExisting: Config },\n  ],\n})\nexport class GlobalMessageModule {\n  static forRoot(): ModuleWithProviders<GlobalMessageModule> {\n    return {\n      ngModule: GlobalMessageModule,\n      providers: [...errorHandlers, ...httpErrorInterceptors],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map, switchMap } from 'rxjs/operators';\nimport { AddMessage, GlobalMessageType } from '../../../global-message/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport * as fromActions from '../actions/index';\n\n@Injectable()\nexport class ForgotPasswordEffects {\n  @Effect()\n  requestForgotPasswordEmail$: Observable<\n    | fromActions.ForgotPasswordEmailRequestSuccess\n    | AddMessage\n    | fromActions.ForgotPasswordEmailRequestFail\n  > = this.actions$.pipe(\n    ofType(fromActions.FORGOT_PASSWORD_EMAIL_REQUEST),\n    map((action: fromActions.ForgotPasswordEmailRequest) => {\n      return action.payload;\n    }),\n    concatMap(userEmailAddress => {\n      return this.userAccountConnector\n        .requestForgotPasswordEmail(userEmailAddress)\n        .pipe(\n          switchMap(() => [\n            new fromActions.ForgotPasswordEmailRequestSuccess(),\n            new AddMessage({\n              text: { key: 'forgottenPassword.passwordResetEmailSent' },\n              type: GlobalMessageType.MSG_TYPE_CONFIRMATION,\n            }),\n          ]),\n          catchError(error =>\n            of(\n              new fromActions.ForgotPasswordEmailRequestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { Order } from '../../../model/order.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserOrderConnector } from '../../connectors/order/user-order.connector';\nimport * as fromOrderDetailsAction from '../actions/order-details.action';\n\n@Injectable()\nexport class OrderDetailsEffect {\n  @Effect()\n  loadOrderDetails$: Observable<\n    fromOrderDetailsAction.OrderDetailsAction\n  > = this.actions$.pipe(\n    ofType(fromOrderDetailsAction.LOAD_ORDER_DETAILS),\n    map((action: fromOrderDetailsAction.LoadOrderDetails) => action.payload),\n    switchMap(payload => {\n      return this.orderConnector.get(payload.userId, payload.orderCode).pipe(\n        map((order: Order) => {\n          return new fromOrderDetailsAction.LoadOrderDetailsSuccess(order);\n        }),\n        catchError(error =>\n          of(\n            new fromOrderDetailsAction.LoadOrderDetailsFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private orderConnector: UserOrderConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserPaymentConnector } from '../../connectors/payment/user-payment.connector';\nimport * as fromUserPaymentMethodsAction from '../actions/payment-methods.action';\n\n@Injectable()\nexport class UserPaymentMethodsEffects {\n  @Effect()\n  loadUserPaymentMethods$: Observable<Action> = this.actions$.pipe(\n    ofType(fromUserPaymentMethodsAction.LOAD_USER_PAYMENT_METHODS),\n    map(\n      (action: fromUserPaymentMethodsAction.LoadUserPaymentMethods) =>\n        action.payload\n    ),\n    mergeMap(payload => {\n      return this.userPaymentMethodConnector.getAll(payload).pipe(\n        map((payments: PaymentDetails[]) => {\n          return new fromUserPaymentMethodsAction.LoadUserPaymentMethodsSuccess(\n            payments\n          );\n        }),\n        catchError(error =>\n          of(\n            new fromUserPaymentMethodsAction.LoadUserPaymentMethodsFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  setDefaultUserPaymentMethod$: Observable<Action> = this.actions$.pipe(\n    ofType(fromUserPaymentMethodsAction.SET_DEFAULT_USER_PAYMENT_METHOD),\n    map(\n      (action: fromUserPaymentMethodsAction.SetDefaultUserPaymentMethod) =>\n        action.payload\n    ),\n    mergeMap(payload => {\n      return this.userPaymentMethodConnector\n        .setDefault(payload.userId, payload.paymentMethodId)\n        .pipe(\n          switchMap(data => [\n            new fromUserPaymentMethodsAction.SetDefaultUserPaymentMethodSuccess(\n              data\n            ),\n            new fromUserPaymentMethodsAction.LoadUserPaymentMethods(\n              payload.userId\n            ),\n          ]),\n          catchError(error =>\n            of(\n              new fromUserPaymentMethodsAction.SetDefaultUserPaymentMethodFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n  @Effect()\n  deleteUserPaymentMethod$: Observable<Action> = this.actions$.pipe(\n    ofType(fromUserPaymentMethodsAction.DELETE_USER_PAYMENT_METHOD),\n    map(\n      (action: fromUserPaymentMethodsAction.DeleteUserPaymentMethod) =>\n        action.payload\n    ),\n    mergeMap(payload => {\n      return this.userPaymentMethodConnector\n        .delete(payload.userId, payload.paymentMethodId)\n        .pipe(\n          switchMap(data => [\n            new fromUserPaymentMethodsAction.DeleteUserPaymentMethodSuccess(\n              data\n            ),\n            new fromUserPaymentMethodsAction.LoadUserPaymentMethods(\n              payload.userId\n            ),\n          ]),\n          catchError(error =>\n            of(\n              new fromUserPaymentMethodsAction.DeleteUserPaymentMethodFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userPaymentMethodConnector: UserPaymentConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { SiteConnector } from '../../../site-context/connectors/site.connector';\nimport { LoaderResetAction } from '../../../state/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport * as fromActions from '../actions/index';\nimport { CLEAR_MISCS_DATA } from '../actions/index';\nimport { REGIONS } from '../user-state';\n\n@Injectable()\nexport class RegionsEffects {\n  @Effect()\n  loadRegions$: Observable<fromActions.RegionsAction> = this.actions$.pipe(\n    ofType(fromActions.LOAD_REGIONS),\n    map((action: fromActions.LoadRegions) => {\n      return action.payload;\n    }),\n    switchMap((countryCode: string) => {\n      return this.siteConnector.getRegions(countryCode).pipe(\n        map(\n          regions =>\n            new fromActions.LoadRegionsSuccess({\n              entities: regions,\n              country: countryCode,\n            })\n        ),\n        catchError(error =>\n          of(new fromActions.LoadRegionsFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  @Effect()\n  resetRegions$: Observable<Action> = this.actions$.pipe(\n    ofType(CLEAR_MISCS_DATA, fromActions.CLEAR_REGIONS),\n    map(() => {\n      return new LoaderResetAction(REGIONS);\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { AddMessage, GlobalMessageType } from '../../../global-message/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport * as fromActions from '../actions/index';\n\n@Injectable()\nexport class ResetPasswordEffects {\n  @Effect()\n  resetPassword$: Observable<\n    | fromActions.ResetPasswordSuccess\n    | AddMessage\n    | fromActions.ResetPasswordFail\n  > = this.actions$.pipe(\n    ofType(fromActions.RESET_PASSWORD),\n    map((action: fromActions.ResetPassword) => action.payload),\n    switchMap(({ token, password }) => {\n      return this.userAccountConnector.resetPassword(token, password).pipe(\n        switchMap(() => [\n          new fromActions.ResetPasswordSuccess(),\n          new AddMessage({\n            text: { key: 'forgottenPassword.passwordResetSuccess' },\n            type: GlobalMessageType.MSG_TYPE_CONFIRMATION,\n          }),\n        ]),\n        catchError(error =>\n          of(new fromActions.ResetPasswordFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { Title } from '../../../model/misc.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport * as fromAction from '../actions/titles.action';\n\n@Injectable()\nexport class TitlesEffects {\n  @Effect()\n  loadTitles$: Observable<fromAction.TitlesAction> = this.actions$.pipe(\n    ofType(fromAction.LOAD_TITLES),\n    switchMap(() => {\n      return this.userAccountConnector.getTitles().pipe(\n        map(titles => {\n          const sortedTitles = this.sortTitles(titles);\n          return new fromAction.LoadTitlesSuccess(sortedTitles);\n        }),\n        catchError(error =>\n          of(new fromAction.LoadTitlesFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  private sortTitles(titles: Title[]) {\n    const drTitle = { code: 'dr', name: 'Dr.' };\n    const revTitle = { code: 'rev', name: 'Rev.' };\n\n    const filteredTitles = titles.filter(\n      t => t.code !== 'dr' && t.code !== 'rev'\n    );\n    const sortedTitles = [...filteredTitles, drTitle, revTitle];\n    return sortedTitles;\n  }\n\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport * as fromUpdateEmailAction from '../actions/update-email.action';\n\n@Injectable()\nexport class UpdateEmailEffects {\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n\n  @Effect()\n  updateEmail$: Observable<\n    | fromUpdateEmailAction.UpdateEmailSuccessAction\n    | fromUpdateEmailAction.UpdateEmailErrorAction\n  > = this.actions$.pipe(\n    ofType(fromUpdateEmailAction.UPDATE_EMAIL),\n    map((action: fromUpdateEmailAction.UpdateEmailAction) => action.payload),\n    concatMap(payload =>\n      this.userAccountConnector\n        .updateEmail(payload.uid, payload.password, payload.newUid)\n        .pipe(\n          map(\n            () =>\n              new fromUpdateEmailAction.UpdateEmailSuccessAction(payload.newUid)\n          ),\n          catchError(error =>\n            of(\n              new fromUpdateEmailAction.UpdateEmailErrorAction(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    )\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport * as fromActions from '../actions/update-password.action';\n\n@Injectable()\nexport class UpdatePasswordEffects {\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n\n  @Effect()\n  updatePassword$: Observable<\n    fromActions.UpdatePasswordSuccess | fromActions.UpdatePasswordFail\n  > = this.actions$.pipe(\n    ofType(fromActions.UPDATE_PASSWORD),\n    map((action: fromActions.UpdatePassword) => action.payload),\n    concatMap(payload =>\n      this.userAccountConnector\n        .updatePassword(\n          payload.userId,\n          payload.oldPassword,\n          payload.newPassword\n        )\n        .pipe(\n          map(_ => new fromActions.UpdatePasswordSuccess()),\n          catchError(error =>\n            of(new fromActions.UpdatePasswordFail(makeErrorSerializable(error)))\n          )\n        )\n    )\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, tap } from 'rxjs/operators';\nimport {\n  GlobalMessageService,\n  GlobalMessageType,\n} from '../../../global-message/index';\nimport { Address } from '../../../model/address.model';\nimport { USERID_CURRENT } from '../../../occ/utils/occ-constants';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserAddressConnector } from '../../connectors/address/user-address.connector';\nimport { UserAddressService } from '../../facade/user-address.service';\nimport * as fromUserAddressesAction from '../actions/user-addresses.action';\n\n@Injectable()\nexport class UserAddressesEffects {\n  @Effect()\n  loadUserAddresses$: Observable<\n    fromUserAddressesAction.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(fromUserAddressesAction.LOAD_USER_ADDRESSES),\n    map((action: fromUserAddressesAction.LoadUserAddresses) => action.payload),\n    mergeMap(payload => {\n      return this.userAddressConnector.getAll(payload).pipe(\n        map((addresses: Address[]) => {\n          return new fromUserAddressesAction.LoadUserAddressesSuccess(\n            addresses\n          );\n        }),\n        catchError(error =>\n          of(\n            new fromUserAddressesAction.LoadUserAddressesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  addUserAddress$: Observable<\n    fromUserAddressesAction.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(fromUserAddressesAction.ADD_USER_ADDRESS),\n    map((action: fromUserAddressesAction.AddUserAddress) => action.payload),\n    mergeMap(payload => {\n      return this.userAddressConnector\n        .add(payload.userId, payload.address)\n        .pipe(\n          map((data: any) => {\n            return new fromUserAddressesAction.AddUserAddressSuccess(data);\n          }),\n          catchError(error =>\n            of(\n              new fromUserAddressesAction.AddUserAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  updateUserAddress$: Observable<\n    fromUserAddressesAction.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(fromUserAddressesAction.UPDATE_USER_ADDRESS),\n    map((action: fromUserAddressesAction.UpdateUserAddress) => action.payload),\n    mergeMap(payload => {\n      return this.userAddressConnector\n        .update(payload.userId, payload.addressId, payload.address)\n        .pipe(\n          map(data => {\n            // don't show the message if just setting address as default\n            if (\n              payload.address &&\n              Object.keys(payload.address).length === 1 &&\n              payload.address.defaultAddress\n            ) {\n              return new fromUserAddressesAction.LoadUserAddresses(\n                USERID_CURRENT\n              );\n            } else {\n              return new fromUserAddressesAction.UpdateUserAddressSuccess(data);\n            }\n          }),\n          catchError(error =>\n            of(\n              new fromUserAddressesAction.UpdateUserAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  deleteUserAddress$: Observable<\n    fromUserAddressesAction.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(fromUserAddressesAction.DELETE_USER_ADDRESS),\n    map((action: fromUserAddressesAction.DeleteUserAddress) => action.payload),\n    mergeMap(payload => {\n      return this.userAddressConnector\n        .delete(payload.userId, payload.addressId)\n        .pipe(\n          map(data => {\n            return new fromUserAddressesAction.DeleteUserAddressSuccess(data);\n          }),\n          catchError(error =>\n            of(\n              new fromUserAddressesAction.DeleteUserAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  /**\n   *  Reload addresses and notify about add success\n   */\n  @Effect({ dispatch: false })\n  showGlobalMessageOnAddSuccess$ = this.actions$.pipe(\n    ofType(fromUserAddressesAction.ADD_USER_ADDRESS_SUCCESS),\n    tap(() => {\n      this.loadAddresses();\n      this.showGlobalMessage('addressForm.userAddressAddSuccess');\n    })\n  );\n\n  /**\n   *  Reload addresses and notify about update success\n   */\n  @Effect({ dispatch: false })\n  showGlobalMessageOnUpdateSuccess$ = this.actions$.pipe(\n    ofType(fromUserAddressesAction.UPDATE_USER_ADDRESS_SUCCESS),\n    tap(() => {\n      this.loadAddresses();\n      this.showGlobalMessage('addressForm.userAddressUpdateSuccess');\n    })\n  );\n\n  /**\n   *  Reload addresses and notify about delete success\n   */\n  @Effect({ dispatch: false })\n  showGlobalMessageOnDeleteSuccess$ = this.actions$.pipe(\n    ofType(fromUserAddressesAction.DELETE_USER_ADDRESS_SUCCESS),\n    tap(() => {\n      this.loadAddresses();\n      this.showGlobalMessage('addressForm.userAddressDeleteSuccess');\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAddressConnector: UserAddressConnector,\n    private userAddressService: UserAddressService,\n    private messageService: GlobalMessageService\n  ) {}\n\n  /**\n   * Show global confirmation message with provided text\n   */\n  private showGlobalMessage(text: string) {\n    this.messageService.add(\n      { key: text },\n      GlobalMessageType.MSG_TYPE_CONFIRMATION\n    );\n  }\n\n  private loadAddresses() {\n    this.userAddressService.loadAddresses();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConsentConnector } from '../../connectors/consent/user-consent.connector';\nimport * as fromActions from '../actions/user-consents.action';\nimport * as fromSiteContextActions from '../../../site-context/store/actions/index';\n\n@Injectable()\nexport class UserConsentsEffect {\n  @Effect()\n  resetConsents$: Observable<\n    fromActions.ResetLoadUserConsents\n  > = this.actions$.pipe(\n    ofType(fromSiteContextActions.LANGUAGE_CHANGE),\n    map(() => new fromActions.ResetLoadUserConsents())\n  );\n\n  @Effect()\n  getConsents$: Observable<fromActions.UserConsentsAction> = this.actions$.pipe(\n    ofType(fromActions.LOAD_USER_CONSENTS),\n    map((action: fromActions.LoadUserConsents) => action.payload),\n    switchMap(userId =>\n      this.userConsentConnector.loadConsents(userId).pipe(\n        map(consents => new fromActions.LoadUserConsentsSuccess(consents)),\n        catchError(error =>\n          of(new fromActions.LoadUserConsentsFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  @Effect()\n  giveConsent$: Observable<fromActions.UserConsentsAction> = this.actions$.pipe(\n    ofType(fromActions.GIVE_USER_CONSENT),\n    map((action: fromActions.GiveUserConsent) => action.payload),\n    switchMap(({ userId, consentTemplateId, consentTemplateVersion }) =>\n      this.userConsentConnector\n        .giveConsent(userId, consentTemplateId, consentTemplateVersion)\n        .pipe(\n          map(consent => new fromActions.GiveUserConsentSuccess(consent)),\n          catchError(error =>\n            of(\n              new fromActions.GiveUserConsentFail(makeErrorSerializable(error))\n            )\n          )\n        )\n    )\n  );\n\n  @Effect()\n  withdrawConsent$: Observable<\n    fromActions.UserConsentsAction\n  > = this.actions$.pipe(\n    ofType(fromActions.WITHDRAW_USER_CONSENT),\n    map((action: fromActions.WithdrawUserConsent) => action.payload),\n    switchMap(({ userId, consentCode }) =>\n      this.userConsentConnector.withdrawConsent(userId, consentCode).pipe(\n        map(() => new fromActions.WithdrawUserConsentSuccess()),\n        catchError(error =>\n          of(\n            new fromActions.WithdrawUserConsentFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userConsentConnector: UserConsentConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map, mergeMap } from 'rxjs/operators';\nimport { User } from '../../../model/misc.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport * as fromUserDetailsAction from '../actions/user-details.action';\n\n@Injectable()\nexport class UserDetailsEffects {\n  @Effect()\n  loadUserDetails$: Observable<\n    fromUserDetailsAction.UserDetailsAction\n  > = this.actions$.pipe(\n    ofType(fromUserDetailsAction.LOAD_USER_DETAILS),\n    map((action: fromUserDetailsAction.LoadUserDetails) => action.payload),\n    mergeMap(userId => {\n      return this.userConnector.get(userId).pipe(\n        map((user: User) => {\n          return new fromUserDetailsAction.LoadUserDetailsSuccess(user);\n        }),\n        catchError(error =>\n          of(\n            new fromUserDetailsAction.LoadUserDetailsFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  updateUserDetails$: Observable<\n    | fromUserDetailsAction.UpdateUserDetailsSuccess\n    | fromUserDetailsAction.UpdateUserDetailsFail\n  > = this.actions$.pipe(\n    ofType(fromUserDetailsAction.UPDATE_USER_DETAILS),\n    map((action: fromUserDetailsAction.UpdateUserDetails) => action.payload),\n    concatMap(payload =>\n      this.userConnector.update(payload.username, payload.userDetails).pipe(\n        map(\n          _ =>\n            new fromUserDetailsAction.UpdateUserDetailsSuccess(\n              payload.userDetails\n            )\n        ),\n        catchError(error =>\n          of(\n            new fromUserDetailsAction.UpdateUserDetailsFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { OrderHistoryList } from '../../../model/order.model';\nimport { LoaderResetAction } from '../../../state';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserOrderConnector } from '../../connectors/order/user-order.connector';\nimport { CLEAR_MISCS_DATA } from '../actions/index';\nimport * as fromUserOrdersAction from '../actions/user-orders.action';\nimport { USER_ORDERS } from '../user-state';\n\n@Injectable()\nexport class UserOrdersEffect {\n  constructor(\n    private actions$: Actions,\n    private orderConnector: UserOrderConnector\n  ) {}\n\n  @Effect()\n  loadUserOrders$: Observable<\n    fromUserOrdersAction.UserOrdersAction\n  > = this.actions$.pipe(\n    ofType(fromUserOrdersAction.LOAD_USER_ORDERS),\n    map((action: fromUserOrdersAction.LoadUserOrders) => action.payload),\n    switchMap(payload => {\n      return this.orderConnector\n        .getHistory(\n          payload.userId,\n          payload.pageSize,\n          payload.currentPage,\n          payload.sort\n        )\n        .pipe(\n          map((orders: OrderHistoryList) => {\n            return new fromUserOrdersAction.LoadUserOrdersSuccess(orders);\n          }),\n          catchError(error =>\n            of(\n              new fromUserOrdersAction.LoadUserOrdersFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  resetUserOrders$: Observable<Action> = this.actions$.pipe(\n    ofType(CLEAR_MISCS_DATA, fromUserOrdersAction.CLEAR_USER_ORDERS),\n    map(() => {\n      return new LoaderResetAction(USER_ORDERS);\n    })\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { UserSignUp } from '../../../model/misc.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport * as fromActions from '../actions/user-register.action';\n\n@Injectable()\nexport class UserRegisterEffects {\n  @Effect()\n  registerUser$: Observable<\n    fromActions.UserRegisterOrRemoveAction | AuthActions.LoadUserToken\n  > = this.actions$.pipe(\n    ofType(fromActions.REGISTER_USER),\n    map((action: fromActions.RegisterUser) => action.payload),\n    mergeMap((user: UserSignUp) =>\n      this.userConnector.register(user).pipe(\n        switchMap(_result => [\n          new AuthActions.LoadUserToken({\n            userId: user.uid,\n            password: user.password,\n          }),\n          new fromActions.RegisterUserSuccess(),\n        ]),\n        catchError(error =>\n          of(new fromActions.RegisterUserFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  @Effect()\n  removeUser$: Observable<\n    fromActions.UserRegisterOrRemoveAction | AuthActions.Logout\n  > = this.actions$.pipe(\n    ofType(fromActions.REMOVE_USER),\n    map((action: fromActions.RemoveUser) => action.payload),\n    mergeMap((userId: string) => {\n      return this.userConnector.remove(userId).pipe(\n        switchMap(_result => [\n          new fromActions.RemoveUserSuccess(),\n          new AuthActions.Logout(),\n        ]),\n        catchError(error =>\n          of(new fromActions.RemoveUserFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userConnector: UserConnector\n  ) {}\n}\n","import { BillingCountriesEffect } from './billing-countries.effect';\nimport { ClearMiscsDataEffect } from './clear-miscs-data.effect';\nimport { DeliveryCountriesEffects } from './delivery-countries.effect';\nimport { ForgotPasswordEffects } from './forgot-password.effect';\nimport { OrderDetailsEffect } from './order-details.effect';\nimport { UserPaymentMethodsEffects } from './payment-methods.effect';\nimport { RegionsEffects } from './regions.effect';\nimport { ResetPasswordEffects } from './reset-password.effect';\nimport { TitlesEffects } from './titles.effect';\nimport { UpdateEmailEffects } from './update-email.effect';\nimport { UpdatePasswordEffects } from './update-password.effect';\nimport { UserAddressesEffects } from './user-addresses.effect';\nimport { UserConsentsEffect } from './user-consents.effect';\nimport { UserDetailsEffects } from './user-details.effect';\nimport { UserOrdersEffect } from './user-orders.effect';\nimport { UserRegisterEffects } from './user-register.effect';\n\nexport const effects: any[] = [\n  ClearMiscsDataEffect,\n  DeliveryCountriesEffects,\n  RegionsEffects,\n  TitlesEffects,\n  UserDetailsEffects,\n  UserAddressesEffects,\n  UserPaymentMethodsEffects,\n  UserRegisterEffects,\n  UserOrdersEffect,\n  OrderDetailsEffect,\n  BillingCountriesEffect,\n  ResetPasswordEffects,\n  ForgotPasswordEffects,\n  UpdateEmailEffects,\n  UpdatePasswordEffects,\n  UserConsentsEffect,\n];\n\nexport * from './billing-countries.effect';\nexport * from './delivery-countries.effect';\nexport * from './order-details.effect';\nexport * from './payment-methods.effect';\nexport * from './regions.effect';\nexport * from './reset-password.effect';\nexport * from './titles.effect';\nexport * from './user-addresses.effect';\nexport * from './user-consents.effect';\nexport * from './user-details.effect';\nexport * from './user-orders.effect';\nexport * from './user-register.effect';\nexport * from './clear-miscs-data.effect';\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { RouterModule } from '@angular/router';\n\nimport { metaReducers, reducerToken, reducerProvider } from './reducers/index';\nimport { effects } from './effects/index';\nimport { USER_FEATURE } from './user-state';\nimport { StateModule } from '../../state/state.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n    StateModule,\n    StoreModule.forFeature(USER_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n    RouterModule,\n  ],\n  providers: [reducerProvider],\n})\nexport class UserStoreModule {}\n","import { NgModule } from '@angular/core';\nimport { ProcessModule } from '../process/process.module';\nimport { UserService } from './facade/index';\nimport { UserStoreModule } from './store/user-store.module';\n\n@NgModule({\n  imports: [UserStoreModule, ProcessModule],\n  providers: [UserService],\n})\nexport class UserModule {}\n","import { ServerConfig } from '../../config';\nimport { TranslationResources } from '../translation-resources';\n\nexport abstract class I18nConfig extends ServerConfig {\n  i18n?: {\n    fallbackLang?: string | false;\n    backend?: {\n      loadPath?: string;\n      crossDomain?: boolean;\n    };\n    resources?: TranslationResources;\n    debug?: boolean;\n    chunks?: {\n      [chunk: string]: string[];\n    };\n  };\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { DatePipe } from '@angular/common';\nimport { getLocaleId } from '@angular/common';\nimport { LanguageService } from '../site-context/facade/language.service';\nimport { I18nConfig } from './config/i18n-config';\n\n// type CxDatePipe, not DatePipe, due to conflict with Angular's DatePipe - problem occurs for the backward compatibility compiler of Ivy\n@Pipe({ name: 'cxDate' })\nexport class CxDatePipe extends DatePipe implements PipeTransform {\n  constructor(\n    protected language: LanguageService,\n    protected config: I18nConfig\n  ) {\n    super(null);\n  }\n\n  transform(value: any, format?: string, timezone?: string): string | null {\n    return super.transform(value, format, timezone, this.getLang());\n  }\n\n  private getLang() {\n    const lang = this.getActiveLang();\n    try {\n      getLocaleId(lang);\n      return lang;\n    } catch {\n      this.reportMissingLocaleData(lang);\n      return 'en';\n    }\n  }\n\n  private getActiveLang(): string {\n    let result;\n    this.language\n      .getActive()\n      .subscribe(lang => (result = lang))\n      .unsubscribe();\n    return result;\n  }\n\n  private reportMissingLocaleData(lang: string) {\n    if (!this.config.production) {\n      console.warn(\n        `cxDate pipe: No locale data registered for '${lang}' (see https://angular.io/api/common/registerLocaleData).`\n      );\n    }\n  }\n}\n","import {\n  ChangeDetectorRef,\n  OnDestroy,\n  Pipe,\n  PipeTransform,\n} from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { TranslationService } from './translation.service';\nimport { shallowEqualObjects } from '../util/compare-equal-objects';\nimport { Translatable, TranslatableParams } from './translatable';\n\n@Pipe({ name: 'cxTranslate', pure: false })\nexport class TranslatePipe implements PipeTransform, OnDestroy {\n  private lastKey: string;\n  private lastOptions: object;\n  private translatedValue: string;\n  private sub: Subscription;\n\n  constructor(\n    protected service: TranslationService,\n    protected cd: ChangeDetectorRef\n  ) {}\n\n  transform(\n    input: Translatable | string,\n    options: TranslatableParams = {}\n  ): string {\n    if ((input as Translatable).raw) {\n      return (input as Translatable).raw;\n    }\n\n    const key = typeof input === 'string' ? input : input.key;\n    if (typeof input !== 'string') {\n      options = { ...options, ...input.params };\n    }\n\n    this.translate(key, options);\n    return this.translatedValue;\n  }\n\n  private translate(key: any, options: object) {\n    if (\n      key !== this.lastKey ||\n      !shallowEqualObjects(options, this.lastOptions)\n    ) {\n      this.lastKey = key;\n      this.lastOptions = options;\n\n      if (this.sub) {\n        this.sub.unsubscribe();\n      }\n      this.sub = this.service\n        .translate(key, options, true)\n        .subscribe(val => this.markForCheck(val));\n    }\n  }\n\n  private markForCheck(value: string) {\n    this.translatedValue = value;\n    this.cd.markForCheck();\n  }\n\n  ngOnDestroy(): void {\n    if (this.sub) {\n      this.sub.unsubscribe();\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { I18nConfig } from './config/i18n-config';\n\n@Injectable()\nexport class TranslationChunkService {\n  protected duplicates: { [key: string]: string[] } = {};\n  protected chunks: { [key: string]: string } = {};\n  constructor(protected config: I18nConfig) {\n    Object.keys(config.i18n.chunks).forEach(chunk => {\n      config.i18n.chunks[chunk].forEach(key => {\n        if (this.chunks.hasOwnProperty(key)) {\n          if (!this.duplicates[key]) {\n            this.duplicates[key] = [this.chunks[key]];\n          }\n          this.duplicates[key].push(chunk);\n        } else {\n          this.chunks[key] = chunk;\n        }\n      });\n    });\n    if (Object.keys(this.duplicates).length > 0 && !this.config.production) {\n      this.warnDuplicates(this.duplicates);\n    }\n  }\n\n  protected readonly KEY_SEPARATOR = '.';\n\n  getChunkNameForKey(key: string): string {\n    const mainKey = (key || '').split(this.KEY_SEPARATOR)[0];\n    const chunk = this.chunks && this.chunks[mainKey];\n\n    if (!chunk) {\n      return mainKey; // fallback to main key as a chunk\n    }\n    return chunk;\n  }\n\n  private warnDuplicates(items: { [key: string]: string[] }): void {\n    const dupes: string[] = [];\n    Object.keys(items).forEach(key => {\n      dupes.push(\n        `* '${key}' found in chunks: ${items[key].join(', ')}. Used '${\n          this.chunks[key]\n        }.${key}'.`\n      );\n    });\n    console.warn(\n      `Duplicated keys has been found in the config of i18n chunks:\\n${dupes.join(\n        '\\n'\n      )}`\n    );\n  }\n}\n","import i18next from 'i18next';\nimport i18nextXhrBackend from 'i18next-xhr-backend';\nimport { I18nConfig } from '../config/i18n-config';\nimport { LanguageService } from '../../site-context/facade/language.service';\nimport { TranslationResources } from '../translation-resources';\n\nexport function i18nextInit(\n  config: I18nConfig,\n  languageService: LanguageService\n): () => Promise<any> {\n  return () => {\n    let i18nextConfig: i18next.InitOptions = {\n      ns: [], // don't preload any namespaces\n      fallbackLng: config.i18n.fallbackLang,\n      debug: config.i18n.debug,\n      interpolation: {\n        escapeValue: false,\n      },\n    };\n    if (config.i18n.backend) {\n      i18next.use(i18nextXhrBackend);\n      i18nextConfig = { ...i18nextConfig, backend: config.i18n.backend };\n    }\n    return i18next.init(i18nextConfig, () => {\n      // Don't use i18next's 'resources' config key for adding static translations,\n      // because it will disable loading chunks from backend. We add resources here, in the init's callback.\n      i18nextAddTranslations(config.i18n.resources);\n      syncI18nextWithSiteContext(languageService);\n    });\n  };\n}\n\nexport function i18nextAddTranslations(resources: TranslationResources = {}) {\n  Object.keys(resources).forEach(lang => {\n    Object.keys(resources[lang]).forEach(chunkName => {\n      i18next.addResourceBundle(\n        lang,\n        chunkName,\n        resources[lang][chunkName],\n        true,\n        true\n      );\n    });\n  });\n}\n\nexport function syncI18nextWithSiteContext(language: LanguageService) {\n  // always update language of i18next on site context (language) change\n  language.getActive().subscribe(lang => i18next.changeLanguage(lang));\n}\n","import { Provider, APP_INITIALIZER } from '@angular/core';\nimport { I18nConfig } from '../config/i18n-config';\nimport { LanguageService } from '../../site-context/facade/language.service';\nimport { i18nextInit } from './i18next-init';\n\nexport const i18nextProviders: Provider[] = [\n  {\n    provide: APP_INITIALIZER,\n    useFactory: i18nextInit,\n    deps: [I18nConfig, LanguageService],\n    multi: true,\n  },\n];\n","import { I18nConfig } from './i18n-config';\n\nexport const defaultI18nConfig: I18nConfig = {\n  i18n: {\n    fallbackLang: false,\n    debug: false,\n  },\n};\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { TranslationService } from '../translation.service';\nimport i18next from 'i18next';\nimport { I18nConfig } from '../config/i18n-config';\nimport { TranslationChunkService } from '../translation-chunk.service';\n\n@Injectable()\nexport class I18nextTranslationService implements TranslationService {\n  private readonly NON_BREAKING_SPACE = String.fromCharCode(160);\n  protected readonly NAMESPACE_SEPARATOR = ':';\n\n  constructor(\n    protected config: I18nConfig,\n    protected translationChunk: TranslationChunkService\n  ) {}\n\n  translate(\n    key: string,\n    options: any = {},\n    whitespaceUntilLoaded: boolean = false\n  ): Observable<string> {\n    // If we've already loaded the chunk (or failed to load), we should immediately emit the value\n    // (or the fallback value in case the key is missing).\n\n    // Moreover, we SHOULD emit a value (or a fallback value) synchronously (not in a promise/setTimeout).\n    // Otherwise, we the will trigger additional deferred change detection in a view that consumes the returned observable,\n    // which together with `switchMap` operator may lead to an infinite loop.\n\n    const chunkName = this.translationChunk.getChunkNameForKey(key);\n    const namespacedKey = this.getNamespacedKey(key, chunkName);\n\n    return new Observable<string>(subscriber => {\n      const translate = () => {\n        if (i18next.exists(namespacedKey, options)) {\n          subscriber.next(i18next.t(namespacedKey, options));\n        } else {\n          if (whitespaceUntilLoaded) {\n            subscriber.next(this.NON_BREAKING_SPACE);\n          }\n          i18next.loadNamespaces(chunkName, () => {\n            if (!i18next.exists(namespacedKey, options)) {\n              this.reportMissingKey(key, chunkName);\n              subscriber.next(this.getFallbackValue(namespacedKey));\n            } else {\n              subscriber.next(i18next.t(namespacedKey, options));\n            }\n          });\n        }\n      };\n\n      translate();\n      i18next.on('languageChanged', translate);\n      return () => i18next.off('languageChanged', translate);\n    });\n  }\n\n  loadChunks(chunkNames: string | string[]): Promise<any> {\n    return i18next.loadNamespaces(chunkNames);\n  }\n\n  /**\n   * Returns a fallback value in case when the given key is missing\n   * @param key\n   */\n  protected getFallbackValue(key: string): string {\n    return this.config.production ? this.NON_BREAKING_SPACE : `[${key}]`;\n  }\n\n  private reportMissingKey(key: string, chunkName: string) {\n    if (!this.config.production) {\n      console.warn(\n        `Translation key missing '${key}' in the chunk '${chunkName}'`\n      );\n    }\n  }\n\n  private getNamespacedKey(key: string, chunk: string): string {\n    return chunk + this.NAMESPACE_SEPARATOR + key;\n  }\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { TranslatePipe } from './translate.pipe';\nimport { i18nextProviders } from './i18next/i18next-providers';\nimport { defaultI18nConfig } from './config/default-i18n-config';\nimport { I18nConfig } from './config/i18n-config';\nimport { TranslationService } from './translation.service';\nimport { provideConfig, Config } from '../config/config.module';\nimport { I18nextTranslationService } from './i18next/i18next-translation.service';\nimport { CxDatePipe } from './date.pipe';\nimport { TranslationChunkService } from './translation-chunk.service';\n\n@NgModule({\n  declarations: [TranslatePipe, CxDatePipe],\n  exports: [TranslatePipe, CxDatePipe],\n})\nexport class I18nModule {\n  static forRoot(): ModuleWithProviders<I18nModule> {\n    return {\n      ngModule: I18nModule,\n      providers: [\n        provideConfig(defaultI18nConfig),\n        { provide: I18nConfig, useExisting: Config },\n        { provide: TranslationService, useClass: I18nextTranslationService },\n        TranslationChunkService,\n        ...i18nextProviders,\n      ],\n    };\n  }\n}\n","export function mockTranslate(key: string, options: any = {}) {\n  const optionsString = Object.keys(options)\n    .sort()\n    .map(optionName => `${optionName}:${options[optionName]}`)\n    .join(' ');\n  return optionsString ? `${key} ${optionsString}` : key;\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { mockTranslate } from './mock-translate';\nimport { Translatable } from '../translatable';\n\n@Pipe({ name: 'cxTranslate' })\nexport class MockTranslatePipe implements PipeTransform {\n  transform(input: Translatable | string, options: object = {}): string {\n    if ((input as Translatable).raw) {\n      return (input as Translatable).raw;\n    }\n\n    const key = typeof input === 'string' ? input : input.key;\n    if (typeof input !== 'string') {\n      options = { ...options, ...input.params };\n    }\n    return mockTranslate(key, options);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { TranslationService } from '../translation.service';\nimport { mockTranslate } from './mock-translate';\n\n@Injectable()\nexport class MockTranslationService implements TranslationService {\n  translate(\n    key: string,\n    options: any = {},\n    _whitespaceUntilLoaded: boolean = false\n  ): Observable<string> {\n    return new Observable<string>(subscriber => {\n      const value = mockTranslate(key, options);\n      subscriber.next(value);\n      subscriber.complete();\n    });\n  }\n\n  loadChunks(_chunks: string | string[]): Promise<any> {\n    return Promise.resolve();\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { DatePipe } from '@angular/common';\n\n@Pipe({ name: 'cxDate' })\nexport class MockDatePipe extends DatePipe implements PipeTransform {\n  transform(value: any, format?: string, timezone?: string): string {\n    return super.transform(value, format, timezone, 'en');\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { MockTranslatePipe } from './mock-translate.pipe';\nimport { TranslationService } from '../translation.service';\nimport { MockTranslationService } from './mock-translation.service';\nimport { MockDatePipe } from './mock-date.pipe';\n\n@NgModule({\n  declarations: [MockTranslatePipe, MockDatePipe],\n  exports: [MockTranslatePipe, MockDatePipe],\n  providers: [\n    { provide: TranslationService, useClass: MockTranslationService },\n  ],\n})\nexport class I18nTestingModule {}\n","import { Injectable, Optional } from '@angular/core';\n\nimport { AuthService } from '../auth/index';\nimport { CmsService } from '../cms/index';\nimport { RoutingService } from '../routing/index';\nimport { LanguageService, CurrencyService } from '../site-context/index';\nimport {\n  ProductService,\n  ProductSearchService,\n  ProductReviewService,\n} from '../product/index';\nimport { UserService } from '../user/index';\nimport { TranslationService } from '../i18n/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CxApiService {\n  constructor(\n    @Optional() public auth: AuthService,\n    @Optional() public cms: CmsService,\n    @Optional() public routing: RoutingService,\n    // site context\n    @Optional() public currency: CurrencyService,\n    @Optional() public language: LanguageService,\n    // product\n    @Optional() public product: ProductService,\n    @Optional() public productSearch: ProductSearchService,\n    @Optional() public productReview: ProductReviewService,\n    // user\n    @Optional() public user: UserService,\n    // translation\n    @Optional() public translation: TranslationService\n  ) {}\n}\n","import { OccConfig } from '../../occ/config/occ-config';\n\nexport abstract class KymaConfig extends OccConfig {\n  authentication?: {\n    /**\n     * If set to `true`, the integration with kyma will be enabled, and Open ID token will be retrieved when registering/logging in,\n     */\n    kyma_enabled?: boolean;\n    kyma_client_id?: string;\n    kyma_client_secret?: string;\n  };\n}\n","import { LoaderState } from '../../state/utils/loader/loader-state';\nimport { OpenIdToken } from '../models/kyma-token-types.model';\n\nexport const KYMA_FEATURE = 'kyma';\nexport const OPEN_ID_TOKEN_DATA = '[Kyma Auth] Open ID Token Data';\n\nexport interface StateWithKyma {\n  [KYMA_FEATURE]: KymaState;\n}\n\nexport interface KymaState {\n  openIdToken: LoaderState<OpenIdToken>;\n}\n","import {\n  LoaderFailAction,\n  LoaderLoadAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { OpenIdToken } from '../../models/kyma-token-types.model';\nimport { OPEN_ID_TOKEN_DATA } from '../kyma-state';\n\nexport const LOAD_OPEN_ID_TOKEN = '[Kyma] Load Open ID Token';\nexport const LOAD_OPEN_ID_TOKEN_FAIL = '[Kyma] Load Open ID Token Fail';\nexport const LOAD_OPEN_ID_TOKEN_SUCCESS = '[Kyma] Load Open ID Token Success';\n\nexport class LoadOpenIdToken extends LoaderLoadAction {\n  readonly type = LOAD_OPEN_ID_TOKEN;\n  constructor(public payload: { username: string; password: string }) {\n    super(OPEN_ID_TOKEN_DATA);\n  }\n}\n\nexport class LoadOpenIdTokenFail extends LoaderFailAction {\n  readonly type = LOAD_OPEN_ID_TOKEN_FAIL;\n  constructor(public payload: any) {\n    super(OPEN_ID_TOKEN_DATA, payload);\n  }\n}\n\nexport class LoadOpenIdTokenSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_OPEN_ID_TOKEN_SUCCESS;\n  constructor(public payload: OpenIdToken) {\n    super(OPEN_ID_TOKEN_DATA);\n  }\n}\n\nexport type OpenIdTokenActions =\n  | LoadOpenIdToken\n  | LoadOpenIdTokenFail\n  | LoadOpenIdTokenSuccess;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { KymaState, KYMA_FEATURE, StateWithKyma } from '../kyma-state';\n\nexport const getKymaState: MemoizedSelector<\n  StateWithKyma,\n  KymaState\n> = createFeatureSelector<KymaState>(KYMA_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderErrorSelector,\n  loaderLoadingSelector,\n  loaderSuccessSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { OpenIdToken } from '../../models/kyma-token-types.model';\nimport { StateWithKyma } from '../kyma-state';\nimport { getKymaState } from './feature.selector';\n\nexport const getOpenIdTokenState: MemoizedSelector<\n  StateWithKyma,\n  LoaderState<OpenIdToken>\n> = createSelector(\n  getKymaState,\n  state => state.openIdToken\n);\n\nexport const getOpenIdTokenValue: MemoizedSelector<\n  StateWithKyma,\n  OpenIdToken\n> = createSelector(\n  getOpenIdTokenState,\n  loaderValueSelector\n);\n\nexport const getOpenIdTokenLoading: MemoizedSelector<\n  StateWithKyma,\n  boolean\n> = createSelector(\n  getOpenIdTokenState,\n  loaderLoadingSelector\n);\n\nexport const getOpenIdTokenSuccess: MemoizedSelector<\n  StateWithKyma,\n  boolean\n> = createSelector(\n  getOpenIdTokenState,\n  loaderSuccessSelector\n);\n\nexport const getOpenIdTokenError: MemoizedSelector<\n  StateWithKyma,\n  boolean\n> = createSelector(\n  getOpenIdTokenState,\n  loaderErrorSelector\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { OpenIdToken } from '../models/kyma-token-types.model';\nimport * as fromKymaActions from '../store/actions/index';\nimport { StateWithKyma } from '../store/kyma-state';\nimport { KymaSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class KymaService {\n  constructor(protected store: Store<StateWithKyma>) {}\n\n  /**\n   * Authorizes using the Kyma OAuth client with scope `openid`.\n   *\n   * @param username a username\n   * @param password a password\n   */\n  authorizeOpenId(username: string, password: string): void {\n    this.store.dispatch(\n      new fromKymaActions.LoadOpenIdToken({ username, password })\n    );\n  }\n\n  /**\n   * Returns the `OpenIdToken`, which was previously retrieved using `authorizeOpenId` method.\n   */\n  getOpenIdToken(): Observable<OpenIdToken> {\n    return this.store.pipe(select(KymaSelectors.getOpenIdTokenValue));\n  }\n}\n","import { KymaConfig } from './kyma-config';\n\nexport const defaultKymaConfig: KymaConfig = {\n  authentication: {\n    kyma_enabled: false,\n    kyma_client_id: 'client4kyma',\n    kyma_client_secret: 'secret',\n  },\n};\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { KymaConfig } from '../../config/kyma-config';\nimport { OpenIdToken } from '../../models/kyma-token-types.model';\n\nconst OAUTH_ENDPOINT = '/authorizationserver/oauth/token';\n\n@Injectable()\nexport class OpenIdAuthenticationTokenService {\n  constructor(private config: KymaConfig, private http: HttpClient) {}\n\n  loadOpenIdAuthenticationToken(\n    username: string,\n    password: string\n  ): Observable<OpenIdToken> {\n    const url = this.getOAuthEndpoint();\n    const params = new HttpParams()\n      .set(\n        'client_id',\n        encodeURIComponent(this.config.authentication.kyma_client_id)\n      )\n      .set(\n        'client_secret',\n        encodeURIComponent(this.config.authentication.kyma_client_secret)\n      )\n      .set('grant_type', 'password') // authorization_code, client_credentials, password\n      .set('username', username)\n      .set('password', password)\n      .set('scope', 'openid');\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .post<OpenIdToken>(url, params, { headers })\n      .pipe(catchError(error => throwError(error)));\n  }\n\n  private getOAuthEndpoint(): string {\n    return (this.config.backend.occ.baseUrl || '') + OAUTH_ENDPOINT;\n  }\n}\n","import { OpenIdAuthenticationTokenService } from './open-id-token/open-id-token.service';\n\nexport const KymaServices: any[] = [OpenIdAuthenticationTokenService];\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { iif, Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map, withLatestFrom } from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { KymaConfig } from '../../config/kyma-config';\nimport { OpenIdAuthenticationTokenService } from '../../services/open-id-token/open-id-token.service';\nimport * as fromActions from '../actions/open-id-token.action';\n\n@Injectable()\nexport class OpenIdTokenEffect {\n  @Effect()\n  triggerOpenIdTokenLoading$: Observable<fromActions.LoadOpenIdToken> = iif<\n    fromActions.LoadOpenIdToken,\n    fromActions.LoadOpenIdToken\n  >(\n    () => this.config.authentication && this.config.authentication.kyma_enabled,\n    this.actions$.pipe(\n      ofType<fromActions.LoadOpenIdTokenSuccess>(\n        AuthActions.LOAD_USER_TOKEN_SUCCESS\n      ),\n      withLatestFrom(\n        this.actions$.pipe(\n          ofType<AuthActions.LoadUserToken>(AuthActions.LOAD_USER_TOKEN)\n        )\n      ),\n      map(\n        ([, loginAction]) =>\n          new fromActions.LoadOpenIdToken({\n            username: loginAction.payload.userId,\n            password: loginAction.payload.password,\n          })\n      )\n    )\n  );\n\n  @Effect()\n  loadOpenIdToken$: Observable<\n    fromActions.OpenIdTokenActions\n  > = this.actions$.pipe(\n    ofType(fromActions.LOAD_OPEN_ID_TOKEN),\n    map((action: fromActions.LoadOpenIdToken) => action.payload),\n    exhaustMap(payload =>\n      this.openIdTokenService\n        .loadOpenIdAuthenticationToken(payload.username, payload.password)\n        .pipe(\n          map(token => new fromActions.LoadOpenIdTokenSuccess(token)),\n          catchError(error =>\n            of(\n              new fromActions.LoadOpenIdTokenFail(makeErrorSerializable(error))\n            )\n          )\n        )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private openIdTokenService: OpenIdAuthenticationTokenService,\n    private config: KymaConfig\n  ) {}\n}\n","import { OpenIdTokenEffect } from './open-id-token.effect';\n\nexport const effects: any[] = [OpenIdTokenEffect];\n\nexport * from './open-id-token.effect';\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  Action,\n  ActionReducer,\n  ActionReducerMap,\n  MetaReducer,\n} from '@ngrx/store';\nimport { LOGOUT } from '../../../auth/store/actions/login-logout.action';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport { OpenIdToken } from '../../models/kyma-token-types.model';\nimport { KymaState, OPEN_ID_TOKEN_DATA } from '../kyma-state';\n\nexport function getReducers(): ActionReducerMap<KymaState> {\n  return {\n    openIdToken: loaderReducer<OpenIdToken>(OPEN_ID_TOKEN_DATA),\n  };\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<KymaState>\n> = new InjectionToken<ActionReducerMap<KymaState>>('KymaReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearKymaState(\n  reducer: ActionReducer<KymaState, Action>\n): ActionReducer<KymaState, Action> {\n  return function(state, action) {\n    if (action.type === LOGOUT) {\n      state = {\n        ...state,\n        openIdToken: undefined,\n      };\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearKymaState];\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { ConfigModule } from '../../config/config.module';\nimport { StateConfig, StorageSyncType } from '../../state/config/state-config';\nimport { StateModule } from '../../state/state.module';\nimport { effects } from './effects/index';\nimport { KYMA_FEATURE } from './kyma-state';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function kymaStoreConfigFactory(): StateConfig {\n  // if we want to reuse KYMA_FEATURE const in config, we have to use factory instead of plain object\n  const config: StateConfig = {\n    state: {\n      storageSync: {\n        keys: {\n          'kyma.openIdToken.value': StorageSyncType.LOCAL_STORAGE,\n        },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StateModule,\n    StoreModule.forFeature(KYMA_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n    ConfigModule.withConfigFactory(kymaStoreConfigFactory),\n  ],\n  providers: [reducerProvider],\n})\nexport class KymaStoreModule {}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { Config, ConfigModule } from '../config/config.module';\nimport { defaultKymaConfig } from './config/default-kyma-config';\nimport { KymaConfig } from './config/kyma-config';\nimport { KymaServices } from './services/index';\nimport { KymaStoreModule } from './store/kyma-store.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    KymaStoreModule,\n    ConfigModule.withConfig(defaultKymaConfig),\n  ],\n  providers: [...KymaServices, { provide: KymaConfig, useExisting: Config }],\n})\nexport class KymaModule {}\n","import { Provider } from '@angular/core';\nimport { Meta } from '@angular/platform-browser';\nimport { provideConfigFactory } from '../../config';\nimport { OccConfig } from './occ-config';\n\nexport const OCC_BASE_URL_META_TAG_NAME = 'occ-backend-base-url';\nexport const OCC_BASE_URL_META_TAG_PLACEHOLDER = 'OCC_BACKEND_BASE_URL_VALUE';\nexport const MEDIA_BASE_URL_META_TAG_NAME = 'media-backend-base-url';\nexport const MEDIA_BASE_URL_META_TAG_PLACEHOLDER =\n  'MEDIA_BACKEND_BASE_URL_VALUE';\n\nexport function occServerConfigFromMetaTagFactory(meta: Meta): OccConfig {\n  const baseUrl = getMetaTagContent(OCC_BASE_URL_META_TAG_NAME, meta);\n  return baseUrl && baseUrl !== OCC_BASE_URL_META_TAG_PLACEHOLDER\n    ? { backend: { occ: { baseUrl } } }\n    : {};\n}\n\nexport function mediaServerConfigFromMetaTagFactory(meta: Meta): OccConfig {\n  const baseUrl = getMetaTagContent(MEDIA_BASE_URL_META_TAG_NAME, meta);\n  return baseUrl && baseUrl !== MEDIA_BASE_URL_META_TAG_PLACEHOLDER\n    ? { backend: { media: { baseUrl } } }\n    : {};\n}\n\nfunction getMetaTagContent(name: string, meta: Meta) {\n  const metaTag = meta.getTag(`name=\"${name}\"`);\n  return metaTag && metaTag.content;\n}\n\nexport function provideConfigFromMetaTags(): Provider[] {\n  return [\n    provideConfigFactory(occServerConfigFromMetaTagFactory, [Meta]),\n    provideConfigFactory(mediaServerConfigFromMetaTagFactory, [Meta]),\n  ];\n}\n","import { OccConfig } from './occ-config';\n\nexport const defaultOccConfig: OccConfig = {\n  backend: {\n    occ: {\n      prefix: '/rest/v2/',\n    },\n    media: {},\n  },\n};\n","import { OccConfig } from '../../occ';\n\nexport function occConfigValidator(config: OccConfig) {\n  if (\n    config.backend === undefined ||\n    config.backend.occ === undefined ||\n    config.backend.occ.baseUrl === undefined\n  ) {\n    return 'Please configure backend.occ.baseUrl before using storefront library!';\n  }\n}\n","export namespace Occ {\n  /**\n   *\n   * An interface representing Country.\n   */\n  export interface Country {\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing Region.\n   */\n  export interface Region {\n    /**\n     * @member {string} [countryIso]\n     */\n    countryIso?: string;\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [isocodeShort]\n     */\n    isocodeShort?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing RegionList.\n   */\n  export interface RegionList {\n    /**\n     * @member {Region[]} [regions]\n     */\n    regions?: Region[];\n  }\n\n  /**\n   *\n   * An interface representing Address.\n   */\n  export interface Address {\n    /**\n     * @member {string} [companyName]\n     */\n    companyName?: string;\n    /**\n     * @member {Country} [country]\n     */\n    country?: Country;\n    /**\n     * @member {boolean} [defaultAddress]\n     */\n    defaultAddress?: boolean;\n    /**\n     * @member {string} [email]\n     */\n    email?: string;\n    /**\n     * @member {string} [firstName]\n     */\n    firstName?: string;\n    /**\n     * @member {string} [formattedAddress]\n     */\n    formattedAddress?: string;\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {string} [lastName]\n     */\n    lastName?: string;\n    /**\n     * @member {string} [line1]\n     */\n    line1?: string;\n    /**\n     * @member {string} [line2]\n     */\n    line2?: string;\n    /**\n     * @member {string} [phone]\n     */\n    phone?: string;\n    /**\n     * @member {string} [postalCode]\n     */\n    postalCode?: string;\n    /**\n     * @member {Region} [region]\n     */\n    region?: Region;\n    /**\n     * @member {boolean} [shippingAddress]\n     */\n    shippingAddress?: boolean;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n    /**\n     * @member {string} [titleCode]\n     */\n    titleCode?: string;\n    /**\n     * @member {string} [town]\n     */\n    town?: string;\n    /**\n     * @member {boolean} [visibleInAddressBook]\n     */\n    visibleInAddressBook?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing AddressList.\n   */\n  export interface AddressList {\n    /**\n     * @member {Address[]} [addresses]\n     */\n    addresses?: Address[];\n  }\n\n  /**\n   *\n   * An interface representing ErrorModel.\n   * Error message\n   *\n   */\n  export interface ErrorModel {\n    /**\n     * @member {string} [message] Descriptive, human readable error message.\n     */\n    message?: string;\n    /**\n     * @member {string} [reason] Additional classification specific for each\n     * error type e.g. 'noStock'.\n     */\n    reason?: string;\n    /**\n     * @member {string} [subject] Identifier of the related object e.g. '1'.\n     */\n    subject?: string;\n    /**\n     * @member {string} [subjectType] Type of the object related to the error\n     * e.g. 'entry'.\n     */\n    subjectType?: string;\n    /**\n     * @member {string} [type] Type of the error e.g. 'LowStockError'.\n     */\n    type?: string;\n  }\n\n  /**\n   *\n   * An interface representing ErrorList.\n   * List of errors\n   *\n   */\n  export interface ErrorList {\n    /**\n     * @member {ErrorModel[]} [errors]\n     */\n    errors?: ErrorModel[];\n  }\n\n  /**\n   *\n   * An interface representing AddressValidation.\n   */\n  export interface AddressValidation {\n    /**\n     * @member {string} [decision]\n     */\n    decision?: string;\n    /**\n     * @member {ErrorList} [errors]\n     */\n    errors?: ErrorList;\n    /**\n     * @member {Address[]} [suggestedAddresses]\n     */\n    suggestedAddresses?: Address[];\n  }\n\n  /**\n   *\n   * An interface representing Price.\n   */\n  export interface Price {\n    /**\n     * @member {string} [currencyIso]\n     */\n    currencyIso?: string;\n    /**\n     * @member {string} [formattedValue]\n     */\n    formattedValue?: string;\n    /**\n     * @member {number} [maxQuantity]\n     */\n    maxQuantity?: number;\n    /**\n     * @member {number} [minQuantity]\n     */\n    minQuantity?: number;\n    /**\n     * @member {PriceType} [priceType] Possible values include: 'BUY', 'FROM'\n     */\n    priceType?: PriceType;\n    /**\n     * @member {number} [value]\n     */\n    value?: number;\n  }\n\n  /**\n   *\n   * An interface representing Stock.\n   */\n  export interface Stock {\n    /**\n     * @member {number} [stockLevel]\n     */\n    stockLevel?: number;\n    /**\n     * @member {string} [stockLevelStatus]\n     */\n    stockLevelStatus?: string;\n  }\n\n  /**\n   *\n   * An interface representing Image.\n   */\n  export interface Image {\n    /**\n     * @member {string} [altText]\n     */\n    altText?: string;\n    /**\n     * @member {string} [format]\n     */\n    format?: string;\n    /**\n     * @member {number} [galleryIndex]\n     */\n    galleryIndex?: number;\n    /**\n     * @member {ImageType} [imageType] Possible values include: 'PRIMARY',\n     * 'GALLERY'\n     */\n    imageType?: ImageType;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing VariantOptionQualifier.\n   */\n  export interface VariantOptionQualifier {\n    /**\n     * @member {Image} [image]\n     */\n    image?: Image;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [qualifier]\n     */\n    qualifier?: string;\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing VariantOption.\n   */\n  export interface VariantOption {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Price} [priceData]\n     */\n    priceData?: Price;\n    /**\n     * @member {Stock} [stock]\n     */\n    stock?: Stock;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n    /**\n     * @member {VariantOptionQualifier[]} [variantOptionQualifiers]\n     */\n    variantOptionQualifiers?: VariantOptionQualifier[];\n  }\n\n  /**\n   *\n   * An interface representing BaseOption.\n   */\n  export interface BaseOption {\n    /**\n     * @member {VariantOption[]} [options]\n     */\n    options?: VariantOption[];\n    /**\n     * @member {VariantOption} [selected]\n     */\n    selected?: VariantOption;\n    /**\n     * @member {string} [variantType]\n     */\n    variantType?: string;\n  }\n\n  /**\n   *\n   * An interface representing SearchQuery.\n   */\n  export interface SearchQuery {\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing SearchState.\n   */\n  export interface SearchState {\n    /**\n     * @member {SearchQuery} [query]\n     */\n    query?: SearchQuery;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing Breadcrumb.\n   */\n  export interface Breadcrumb {\n    /**\n     * @member {string} [facetCode]\n     */\n    facetCode?: string;\n    /**\n     * @member {string} [facetName]\n     */\n    facetName?: string;\n    /**\n     * @member {string} [facetValueCode]\n     */\n    facetValueCode?: string;\n    /**\n     * @member {string} [facetValueName]\n     */\n    facetValueName?: string;\n    /**\n     * @member {SearchState} [removeQuery]\n     */\n    removeQuery?: SearchState;\n    /**\n     * @member {SearchState} [truncateQuery]\n     */\n    truncateQuery?: SearchState;\n  }\n\n  /**\n   *\n   * An interface representing Component.\n   */\n  export interface Component {\n    /**\n     * @member {Date} [modifiedTime]\n     */\n    modifiedTime?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {any} [otherProperties]\n     */\n    otherProperties?: any;\n    /**\n     * @member {string} [typeCode]\n     */\n    typeCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing ComponentList.\n   */\n  export interface ComponentList {\n    /**\n     * @member {Component[]} [component]\n     */\n    component?: Component[] | any[];\n  }\n\n  /**\n   *\n   * An interface representing ContentSlot.\n   */\n  export interface ContentSlot {\n    /**\n     * @member {ComponentList} [components]\n     */\n    components?: ComponentList;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [position]\n     */\n    position?: string;\n    /**\n     * @member {string} [slotId]\n     */\n    slotId?: string;\n    /**\n     * @member {boolean} [slotShared]\n     */\n    slotShared?: boolean;\n    /**\n     * @member {string} [slotStatus]\n     */\n    slotStatus?: string;\n  }\n\n  /**\n   *\n   * An interface representing ContentSlotList.\n   */\n  export interface ContentSlotList {\n    /**\n     * @member {ContentSlot[]} [contentSlot]\n     */\n    contentSlot?: ContentSlot[];\n  }\n\n  /**\n   *\n   * An interface representing CMSPage.\n   */\n  export interface CMSPage {\n    /**\n     * @member {ContentSlotList} [contentSlots]\n     */\n    contentSlots?: ContentSlotList;\n    /**\n     * @member {boolean} [defaultPage]\n     */\n    defaultPage?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [template]\n     */\n    template?: string;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n    /**\n     * @member {string} [typeCode]\n     */\n    typeCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing CardType.\n   */\n  export interface CardType {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing CardTypeList.\n   */\n  export interface CardTypeList {\n    /**\n     * @member {CardType[]} [cardTypes]\n     */\n    cardTypes?: CardType[];\n  }\n\n  /**\n   *\n   * An interface representing PromotionOrderEntryConsumed.\n   */\n  export interface PromotionOrderEntryConsumed {\n    /**\n     * @member {number} [adjustedUnitPrice]\n     */\n    adjustedUnitPrice?: number;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {number} [orderEntryNumber]\n     */\n    orderEntryNumber?: number;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n  }\n\n  /**\n   *\n   * An interface representing PromotionRestriction.\n   */\n  export interface PromotionRestriction {\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [restrictionType]\n     */\n    restrictionType?: string;\n  }\n\n  /**\n   *\n   * An interface representing Promotion.\n   */\n  export interface Promotion {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string[]} [couldFireMessages]\n     */\n    couldFireMessages?: string[];\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [enabled]\n     */\n    enabled?: boolean;\n    /**\n     * @member {Date} [endDate]\n     */\n    endDate?: Date;\n    /**\n     * @member {string[]} [firedMessages]\n     */\n    firedMessages?: string[];\n    /**\n     * @member {number} [priority]\n     */\n    priority?: number;\n    /**\n     * @member {Image} [productBanner]\n     */\n    productBanner?: Image;\n    /**\n     * @member {string} [promotionGroup]\n     */\n    promotionGroup?: string;\n    /**\n     * @member {string} [promotionType]\n     */\n    promotionType?: string;\n    /**\n     * @member {PromotionRestriction[]} [restrictions]\n     */\n    restrictions?: PromotionRestriction[];\n    /**\n     * @member {Date} [startDate]\n     */\n    startDate?: Date;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n  }\n\n  /**\n   *\n   * An interface representing PromotionResult.\n   */\n  export interface PromotionResult {\n    /**\n     * @member {PromotionOrderEntryConsumed[]} [consumedEntries]\n     */\n    consumedEntries?: PromotionOrderEntryConsumed[];\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {Promotion} [promotion]\n     */\n    promotion?: Promotion;\n  }\n\n  /**\n   *\n   * An interface representing Currency.\n   */\n  export interface Currency {\n    /**\n     * @member {boolean} [active]\n     */\n    active?: boolean;\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [symbol]\n     */\n    symbol?: string;\n  }\n\n  /**\n   *\n   * An interface representing Voucher.\n   */\n  export interface Voucher {\n    /**\n     * @member {Price} [appliedValue]\n     */\n    appliedValue?: Price;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Currency} [currency]\n     */\n    currency?: Currency;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [freeShipping]\n     */\n    freeShipping?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [value]\n     */\n    value?: number;\n    /**\n     * @member {string} [valueFormatted]\n     */\n    valueFormatted?: string;\n    /**\n     * @member {string} [valueString]\n     */\n    valueString?: string;\n    /**\n     * @member {string} [voucherCode]\n     */\n    voucherCode?: string;\n  }\n\n  /**\n   *\n   * An interface representing DeliveryMode.\n   */\n  export interface DeliveryMode {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing GeoPoint.\n   */\n  export interface GeoPoint {\n    /**\n     * @member {number} [latitude]\n     */\n    latitude?: number;\n    /**\n     * @member {number} [longitude]\n     */\n    longitude?: number;\n  }\n\n  /**\n   *\n   * An interface representing Time.\n   */\n  export interface Time {\n    /**\n     * @member {string} [formattedHour]\n     */\n    formattedHour?: string;\n    /**\n     * @member {number} [hour]\n     */\n    hour?: number;\n    /**\n     * @member {number} [minute]\n     */\n    minute?: number;\n  }\n\n  /**\n   *\n   * An interface representing SpecialOpeningDay.\n   */\n  export interface SpecialOpeningDay {\n    /**\n     * @member {boolean} [closed]\n     */\n    closed?: boolean;\n    /**\n     * @member {Time} [closingTime]\n     */\n    closingTime?: Time;\n    /**\n     * @member {string} [comment]\n     */\n    comment?: string;\n    /**\n     * @member {Date} [date]\n     */\n    date?: Date;\n    /**\n     * @member {string} [formattedDate]\n     */\n    formattedDate?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {Time} [openingTime]\n     */\n    openingTime?: Time;\n  }\n\n  /**\n   *\n   * An interface representing WeekdayOpeningDay.\n   */\n  export interface WeekdayOpeningDay {\n    /**\n     * @member {boolean} [closed]\n     */\n    closed?: boolean;\n    /**\n     * @member {Time} [closingTime]\n     */\n    closingTime?: Time;\n    /**\n     * @member {Time} [openingTime]\n     */\n    openingTime?: Time;\n    /**\n     * @member {string} [weekDay]\n     */\n    weekDay?: string;\n  }\n\n  /**\n   *\n   * An interface representing OpeningSchedule.\n   */\n  export interface OpeningSchedule {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {SpecialOpeningDay[]} [specialDayOpeningList]\n     */\n    specialDayOpeningList?: SpecialOpeningDay[];\n    /**\n     * @member {WeekdayOpeningDay[]} [weekDayOpeningList]\n     */\n    weekDayOpeningList?: WeekdayOpeningDay[];\n  }\n\n  /**\n   *\n   * An interface representing PointOfService.\n   */\n  export interface PointOfService {\n    /**\n     * @member {Address} [address]\n     */\n    address?: Address;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [displayName]\n     */\n    displayName?: string;\n    /**\n     * @member {number} [distanceKm]\n     */\n    distanceKm?: number;\n    /**\n     * @member {{ [propertyName: string]: string }} [features]\n     */\n    features?: { [propertyName: string]: string };\n    /**\n     * @member {string} [formattedDistance]\n     */\n    formattedDistance?: string;\n    /**\n     * @member {GeoPoint} [geoPoint]\n     */\n    geoPoint?: GeoPoint;\n    /**\n     * @member {Image} [mapIcon]\n     */\n    mapIcon?: Image;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {OpeningSchedule} [openingHours]\n     */\n    openingHours?: OpeningSchedule;\n    /**\n     * @member {string} [storeContent]\n     */\n    storeContent?: string;\n    /**\n     * @member {Image[]} [storeImages]\n     */\n    storeImages?: Image[];\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing Category.\n   */\n  export interface Category {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [code]\n     */\n    name?: string;\n    /**\n     * @member {Image} [image]\n     */\n    image?: Image;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing FeatureUnit.\n   */\n  export interface FeatureUnit {\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [symbol]\n     */\n    symbol?: string;\n    /**\n     * @member {string} [unitType]\n     */\n    unitType?: string;\n  }\n\n  /**\n   *\n   * An interface representing FeatureValue.\n   */\n  export interface FeatureValue {\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing Feature.\n   */\n  export interface Feature {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {boolean} [comparable]\n     */\n    comparable?: boolean;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {FeatureUnit} [featureUnit]\n     */\n    featureUnit?: FeatureUnit;\n    /**\n     * @member {FeatureValue[]} [featureValues]\n     */\n    featureValues?: FeatureValue[];\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {boolean} [range]\n     */\n    range?: boolean;\n    /**\n     * @member {string} [type]\n     */\n    type?: string;\n  }\n\n  /**\n   *\n   * An interface representing Classification.\n   */\n  export interface Classification {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Feature[]} [features]\n     */\n    features?: Feature[];\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing FutureStock.\n   */\n  export interface FutureStock {\n    /**\n     * @member {Date} [date]\n     */\n    date?: Date;\n    /**\n     * @member {string} [formattedDate]\n     */\n    formattedDate?: string;\n    /**\n     * @member {Stock} [stock]\n     */\n    stock?: Stock;\n  }\n\n  /**\n   *\n   * An interface representing PriceRange.\n   */\n  export interface PriceRange {\n    /**\n     * @member {Price} [maxPrice]\n     */\n    maxPrice?: Price;\n    /**\n     * @member {Price} [minPrice]\n     */\n    minPrice?: Price;\n  }\n\n  /**\n   *\n   * An interface representing ProductReference.\n   */\n  export interface ProductReference {\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [preselected]\n     */\n    preselected?: boolean;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {string} [referenceType]\n     */\n    referenceType?: string;\n    /**\n     * @member {Product} [target]\n     */\n    target?: Product;\n  }\n\n  /**\n   *\n   * An interface representing Language.\n   */\n  export interface Language {\n    /**\n     * @member {boolean} [active]\n     */\n    active?: boolean;\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [nativeName]\n     */\n    nativeName?: string;\n  }\n\n  /**\n   *\n   * An interface representing User.\n   */\n  export interface User {\n    /**\n     * @member {Currency} [currency]\n     */\n    currency?: Currency;\n    /**\n     * @member {string} [customerId]\n     */\n    customerId?: string;\n    /**\n     * @member {Date} [deactivationDate]\n     */\n    deactivationDate?: Date;\n    /**\n     * @member {Address} [defaultAddress]\n     */\n    defaultAddress?: Address;\n    /**\n     * @member {string} [displayUid]\n     */\n    displayUid?: string;\n    /**\n     * @member {string} [firstName]\n     */\n    firstName?: string;\n    /**\n     * @member {Language} [language]\n     */\n    language?: Language;\n    /**\n     * @member {string} [lastName]\n     */\n    lastName?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n    /**\n     * @member {string} [titleCode]\n     */\n    titleCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing Review.\n   */\n  export interface Review {\n    /**\n     * @member {string} [alias]\n     */\n    alias?: string;\n    /**\n     * @member {string} [comment]\n     */\n    comment?: string;\n    /**\n     * @member {Date} [date]\n     */\n    date?: Date;\n    /**\n     * @member {string} [headline]\n     */\n    headline?: string;\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {User} [principal]\n     */\n    principal?: User;\n    /**\n     * @member {number} [rating]\n     */\n    rating?: number;\n  }\n\n  /**\n   *\n   * An interface representing VariantCategory.\n   */\n  export interface VariantCategory {\n    /**\n     * @member {boolean} [hasImage]\n     */\n    hasImage?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [priority]\n     */\n    priority?: number;\n  }\n\n  /**\n   *\n   * An interface representing VariantValueCategory.\n   */\n  export interface VariantValueCategory {\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [sequence]\n     */\n    sequence?: number;\n    /**\n     * @member {VariantCategory[]} [superCategories]\n     */\n    superCategories?: VariantCategory[];\n  }\n\n  /**\n   *\n   * An interface representing VariantMatrixElement.\n   */\n  export interface VariantMatrixElement {\n    /**\n     * @member {VariantMatrixElement[]} [elements]\n     */\n    elements?: VariantMatrixElement[];\n    /**\n     * @member {boolean} [isLeaf]\n     */\n    isLeaf?: boolean;\n    /**\n     * @member {VariantCategory} [parentVariantCategory]\n     */\n    parentVariantCategory?: VariantCategory;\n    /**\n     * @member {VariantOption} [variantOption]\n     */\n    variantOption?: VariantOption;\n    /**\n     * @member {VariantValueCategory} [variantValueCategory]\n     */\n    variantValueCategory?: VariantValueCategory;\n  }\n\n  /**\n   *\n   * An interface representing Product.\n   */\n  export interface Product {\n    /**\n     * @member {boolean} [availableForPickup]\n     */\n    availableForPickup?: boolean;\n    /**\n     * @member {number} [averageRating]\n     */\n    averageRating?: number;\n    /**\n     * @member {BaseOption[]} [baseOptions]\n     */\n    baseOptions?: BaseOption[];\n    /**\n     * @member {string} [baseProduct]\n     */\n    baseProduct?: string;\n    /**\n     * @member {Category[]} [categories]\n     */\n    categories?: Category[];\n    /**\n     * @member {Classification[]} [classifications]\n     */\n    classifications?: Classification[];\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {FutureStock[]} [futureStocks]\n     */\n    futureStocks?: FutureStock[];\n    /**\n     * @member {Image[]} [images]\n     */\n    images?: Image[];\n    /**\n     * @member {string} [manufacturer]\n     */\n    manufacturer?: string;\n    /**\n     * @member {boolean} [multidimensional]\n     */\n    multidimensional?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [numberOfReviews]\n     */\n    numberOfReviews?: number;\n    /**\n     * @member {Promotion[]} [potentialPromotions]\n     */\n    potentialPromotions?: Promotion[];\n    /**\n     * @member {Price} [price]\n     */\n    price?: Price;\n    /**\n     * @member {PriceRange} [priceRange]\n     */\n    priceRange?: PriceRange;\n    /**\n     * @member {ProductReference[]} [productReferences]\n     */\n    productReferences?: ProductReference[];\n    /**\n     * @member {boolean} [purchasable]\n     */\n    purchasable?: boolean;\n    /**\n     * @member {Review[]} [reviews]\n     */\n    reviews?: Review[];\n    /**\n     * @member {Stock} [stock]\n     */\n    stock?: Stock;\n    /**\n     * @member {string} [summary]\n     */\n    summary?: string;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n    /**\n     * @member {VariantMatrixElement[]} [variantMatrix]\n     */\n    variantMatrix?: VariantMatrixElement[];\n    /**\n     * @member {VariantOption[]} [variantOptions]\n     */\n    variantOptions?: VariantOption[];\n    /**\n     * @member {string} [variantType]\n     */\n    variantType?: string;\n    /**\n     * @member {Price[]} [volumePrices]\n     */\n    volumePrices?: Price[];\n    /**\n     * @member {boolean} [volumePricesFlag]\n     */\n    volumePricesFlag?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing OrderEntry.\n   */\n  export interface OrderEntry {\n    /**\n     * @member {Price} [basePrice]\n     */\n    basePrice?: Price;\n    /**\n     * @member {DeliveryMode} [deliveryMode]\n     */\n    deliveryMode?: DeliveryMode;\n    /**\n     * @member {PointOfService} [deliveryPointOfService]\n     */\n    deliveryPointOfService?: PointOfService;\n    /**\n     * @member {number} [entryNumber]\n     */\n    entryNumber?: number;\n    /**\n     * @member {Product} [product]\n     */\n    product?: Product;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n    /**\n     * @member {boolean} [updateable]\n     */\n    updateable?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing DeliveryOrderEntryGroup.\n   */\n  export interface DeliveryOrderEntryGroup {\n    /**\n     * @member {Address} [deliveryAddress]\n     */\n    deliveryAddress?: Address;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n  }\n\n  /**\n   *\n   * An interface representing PaymentDetails.\n   */\n  export interface PaymentDetails {\n    /**\n     * @member {string} [accountHolderName]\n     */\n    accountHolderName?: string;\n    /**\n     * @member {Address} [billingAddress]\n     */\n    billingAddress?: Address;\n    /**\n     * @member {string} [cardNumber]\n     */\n    cardNumber?: string;\n    /**\n     * @member {CardType} [cardType]\n     */\n    cardType?: CardType;\n    /**\n     * @member {string} [cvn]\n     */\n    cvn?: string;\n    /**\n     * @member {boolean} [defaultPayment]\n     */\n    defaultPayment?: boolean;\n    /**\n     * @member {string} [expiryMonth]\n     */\n    expiryMonth?: string;\n    /**\n     * @member {string} [expiryYear]\n     */\n    expiryYear?: string;\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {string} [issueNumber]\n     */\n    issueNumber?: string;\n    /**\n     * @member {boolean} [saved]\n     */\n    saved?: boolean;\n    /**\n     * @member {string} [startMonth]\n     */\n    startMonth?: string;\n    /**\n     * @member {string} [startYear]\n     */\n    startYear?: string;\n    /**\n     * @member {string} [subscriptionId]\n     */\n    subscriptionId?: string;\n  }\n\n  /**\n   *\n   * An interface representing PickupOrderEntryGroup.\n   */\n  export interface PickupOrderEntryGroup {\n    /**\n     * @member {PointOfService} [deliveryPointOfService]\n     */\n    deliveryPointOfService?: PointOfService;\n    /**\n     * @member {number} [distance]\n     */\n    distance?: number;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n  }\n\n  /**\n   *\n   * An interface representing Principal.\n   */\n  export interface Principal {\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing Cart.\n   */\n  export interface Cart {\n    /**\n     * @member {PromotionResult[]} [appliedOrderPromotions]\n     */\n    appliedOrderPromotions?: PromotionResult[];\n    /**\n     * @member {PromotionResult[]} [appliedProductPromotions]\n     */\n    appliedProductPromotions?: PromotionResult[];\n    /**\n     * @member {Voucher[]} [appliedVouchers]\n     */\n    appliedVouchers?: Voucher[];\n    /**\n     * @member {boolean} [calculated]\n     */\n    calculated?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Address} [deliveryAddress]\n     */\n    deliveryAddress?: Address;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {number} [deliveryItemsQuantity]\n     */\n    deliveryItemsQuantity?: number;\n    /**\n     * @member {DeliveryMode} [deliveryMode]\n     */\n    deliveryMode?: DeliveryMode;\n    /**\n     * @member {DeliveryOrderEntryGroup[]} [deliveryOrderGroups]\n     */\n    deliveryOrderGroups?: DeliveryOrderEntryGroup[];\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {Date} [expirationTime]\n     */\n    expirationTime?: Date;\n    /**\n     * @member {string} [guid]\n     */\n    guid?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {boolean} [net]\n     */\n    net?: boolean;\n    /**\n     * @member {Price} [orderDiscounts]\n     */\n    orderDiscounts?: Price;\n    /**\n     * @member {PaymentDetails} [paymentInfo]\n     */\n    paymentInfo?: PaymentDetails;\n    /**\n     * @member {number} [pickupItemsQuantity]\n     */\n    pickupItemsQuantity?: number;\n    /**\n     * @member {PickupOrderEntryGroup[]} [pickupOrderGroups]\n     */\n    pickupOrderGroups?: PickupOrderEntryGroup[];\n    /**\n     * @member {PromotionResult[]} [potentialOrderPromotions]\n     */\n    potentialOrderPromotions?: PromotionResult[];\n    /**\n     * @member {PromotionResult[]} [potentialProductPromotions]\n     */\n    potentialProductPromotions?: PromotionResult[];\n    /**\n     * @member {Price} [productDiscounts]\n     */\n    productDiscounts?: Price;\n    /**\n     * @member {Date} [saveTime]\n     */\n    saveTime?: Date;\n    /**\n     * @member {Principal} [savedBy]\n     */\n    savedBy?: Principal;\n    /**\n     * @member {string} [site]\n     */\n    site?: string;\n    /**\n     * @member {string} [store]\n     */\n    store?: string;\n    /**\n     * @member {Price} [subTotal]\n     */\n    subTotal?: Price;\n    /**\n     * @member {Price} [totalDiscounts]\n     */\n    totalDiscounts?: Price;\n    /**\n     * @member {number} [totalItems]\n     */\n    totalItems?: number;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n    /**\n     * @member {Price} [totalTax]\n     */\n    totalTax?: Price;\n    /**\n     * @member {number} [totalUnitCount]\n     */\n    totalUnitCount?: number;\n    /**\n     * @member {Principal} [user]\n     */\n    user?: Principal;\n  }\n\n  /**\n   *\n   * An interface representing CartList.\n   */\n  export interface CartList {\n    /**\n     * @member {Cart[]} [carts]\n     */\n    carts?: Cart[];\n  }\n\n  /**\n   *\n   * An interface representing CartModification.\n   */\n  export interface CartModification {\n    /**\n     * @member {boolean} [deliveryModeChanged]\n     */\n    deliveryModeChanged?: boolean;\n    /**\n     * @member {OrderEntry} [entry]\n     */\n    entry?: OrderEntry;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {number} [quantityAdded]\n     */\n    quantityAdded?: number;\n    /**\n     * @member {string} [statusCode]\n     */\n    statusCode?: string;\n    /**\n     * @member {string} [statusMessage]\n     */\n    statusMessage?: string;\n  }\n\n  /**\n   *\n   * An interface representing CategoryHierarchy.\n   */\n  export interface CategoryHierarchy {\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {Date} [lastModified]\n     */\n    lastModified?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {CategoryHierarchy[]} [subcategories]\n     */\n    subcategories?: CategoryHierarchy[];\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing CatalogVersion.\n   */\n  export interface CatalogVersion {\n    /**\n     * @member {CategoryHierarchy[]} [categories]\n     */\n    categories?: CategoryHierarchy[];\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {Date} [lastModified]\n     */\n    lastModified?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing Catalog.\n   */\n  export interface Catalog {\n    /**\n     * @member {CatalogVersion[]} [catalogVersions]\n     */\n    catalogVersions?: CatalogVersion[];\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {Date} [lastModified]\n     */\n    lastModified?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing CatalogList.\n   */\n  export interface CatalogList {\n    /**\n     * @member {Catalog[]} [catalogs]\n     */\n    catalogs?: Catalog[];\n  }\n\n  /**\n   *\n   * An interface representing ComponentIDList.\n   */\n  export interface ComponentIDList {\n    /**\n     * @member {string[]} [idList]\n     */\n    idList?: string[];\n  }\n\n  /**\n   *\n   * An interface representing ConsignmentEntry.\n   */\n  export interface ConsignmentEntry {\n    /**\n     * @member {OrderEntry} [orderEntry]\n     */\n    orderEntry?: OrderEntry;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {number} [shippedQuantity]\n     */\n    shippedQuantity?: number;\n  }\n\n  /**\n   *\n   * An interface representing Consignment.\n   */\n  export interface Consignment {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {PointOfService} [deliveryPointOfService]\n     */\n    deliveryPointOfService?: PointOfService;\n    /**\n     * @member {ConsignmentEntry[]} [entries]\n     */\n    entries?: ConsignmentEntry[];\n    /**\n     * @member {Address} [shippingAddress]\n     */\n    shippingAddress?: Address;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {Date} [statusDate]\n     */\n    statusDate?: Date;\n    /**\n     * @member {string} [trackingID]\n     */\n    trackingID?: string;\n  }\n\n  /**\n   *\n   * An interface representing CountryList.\n   */\n  export interface CountryList {\n    /**\n     * @member {Country[]} [countries]\n     */\n    countries?: Country[];\n  }\n\n  /**\n   *\n   * An interface representing CurrencyList.\n   */\n  export interface CurrencyList {\n    /**\n     * @member {Currency[]} [currencies]\n     */\n    currencies?: Currency[];\n  }\n\n  /**\n   *\n   * An interface representing DeliveryModeList.\n   */\n  export interface DeliveryModeList {\n    /**\n     * @member {DeliveryMode[]} [deliveryModes]\n     */\n    deliveryModes?: DeliveryMode[];\n  }\n\n  /**\n   *\n   * An interface representing FacetValue.\n   */\n  export interface FacetValue {\n    /**\n     * @member {number} [count]\n     */\n    count?: number;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {SearchState} [query]\n     */\n    query?: SearchState;\n    /**\n     * @member {boolean} [selected]\n     */\n    selected?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing Facet.\n   */\n  export interface Facet {\n    /**\n     * @member {boolean} [category]\n     */\n    category?: boolean;\n    /**\n     * @member {boolean} [multiSelect]\n     */\n    multiSelect?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [priority]\n     */\n    priority?: number;\n    /**\n     * @member {FacetValue[]} [topValues]\n     */\n    topValues?: FacetValue[];\n    /**\n     * @member {FacetValue[]} [values]\n     */\n    values?: FacetValue[];\n    /**\n     * @member {boolean} [visible]\n     */\n    visible?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing LanguageList.\n   */\n  export interface LanguageList {\n    /**\n     * @member {Language[]} [languages]\n     */\n    languages?: Language[];\n  }\n\n  /**\n   *\n   * An interface representing Pagination.\n   * Pagination info\n   *\n   */\n  export interface Pagination {\n    /**\n     * @member {number} [count] Number of elements on this page\n     */\n    count?: number;\n    /**\n     * @member {number} [page] Current page number\n     */\n    page?: number;\n    /**\n     * @member {number} [totalCount] Total number of elements\n     */\n    totalCount?: number;\n    /**\n     * @member {number} [totalPages] Total number of pages\n     */\n    totalPages?: number;\n  }\n\n  /**\n   *\n   * An interface representing Sort.\n   * Sort option\n   *\n   */\n  export interface Sort {\n    /**\n     * @member {boolean} [asc]\n     */\n    asc?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n  }\n\n  /**\n   *\n   * An interface representing ListAdaptedComponents.\n   */\n  export interface ListAdaptedComponents {\n    /**\n     * @member {any[]} [components]\n     */\n    components?: any[];\n    /**\n     * @member {Pagination} [pagination]\n     */\n    pagination?: Pagination;\n    /**\n     * @member {Sort[]} [sorts]\n     */\n    sorts?: Sort[];\n  }\n\n  /**\n   *\n   * An interface representing MemberList.\n   */\n  export interface MemberList {\n    /**\n     * @member {Principal[]} [members]\n     */\n    members?: Principal[];\n  }\n\n  /**\n   *\n   * An interface representing OrderEntryList.\n   */\n  export interface OrderEntryList {\n    /**\n     * @member {OrderEntry[]} [orderEntries]\n     */\n    orderEntries?: OrderEntry[];\n  }\n\n  /**\n   *\n   * An interface representing OrderHistory.\n   */\n  export interface OrderHistory {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [guid]\n     */\n    guid?: string;\n    /**\n     * @member {Date} [placed]\n     */\n    placed?: Date;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {string} [statusDisplay]\n     */\n    statusDisplay?: string;\n    /**\n     * @member {Price} [total]\n     */\n    total?: Price;\n  }\n\n  /**\n   *\n   * An interface representing PaginationModel.\n   */\n  export interface PaginationModel {\n    /**\n     * @member {number} [currentPage]\n     */\n    currentPage?: number;\n    /**\n     * @member {number} [pageSize]\n     */\n    pageSize?: number;\n    /**\n     * @member {string} [sort]\n     */\n    sort?: string;\n    /**\n     * @member {number} [totalPages]\n     */\n    totalPages?: number;\n    /**\n     * @member {number} [totalResults]\n     */\n    totalResults?: number;\n  }\n\n  /**\n   *\n   * An interface representing SortModel.\n   */\n  export interface SortModel {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {boolean} [selected]\n     */\n    selected?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing OrderHistoryList.\n   */\n  export interface OrderHistoryList {\n    /**\n     * @member {OrderHistory[]} [orders]\n     */\n    orders?: OrderHistory[];\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n  }\n\n  /**\n   *\n   * An interface representing OrderStatusUpdateElement.\n   */\n  export interface OrderStatusUpdateElement {\n    /**\n     * @member {string} [baseSiteId]\n     */\n    baseSiteId?: string;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n  }\n\n  /**\n   *\n   * An interface representing OrderStatusUpdateElementList.\n   */\n  export interface OrderStatusUpdateElementList {\n    /**\n     * @member {OrderStatusUpdateElement[]} [orderStatusUpdateElements]\n     */\n    orderStatusUpdateElements?: OrderStatusUpdateElement[];\n  }\n\n  /**\n   *\n   * An interface representing Order.\n   */\n  export interface Order {\n    /**\n     * @member {PromotionResult[]} [appliedOrderPromotions]\n     */\n    appliedOrderPromotions?: PromotionResult[];\n    /**\n     * @member {PromotionResult[]} [appliedProductPromotions]\n     */\n    appliedProductPromotions?: PromotionResult[];\n    /**\n     * @member {Voucher[]} [appliedVouchers]\n     */\n    appliedVouchers?: Voucher[];\n    /**\n     * @member {boolean} [calculated]\n     */\n    calculated?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Consignment[]} [consignments]\n     */\n    consignments?: Consignment[];\n    /**\n     * @member {Date} [created]\n     */\n    created?: Date;\n    /**\n     * @member {Address} [deliveryAddress]\n     */\n    deliveryAddress?: Address;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {number} [deliveryItemsQuantity]\n     */\n    deliveryItemsQuantity?: number;\n    /**\n     * @member {DeliveryMode} [deliveryMode]\n     */\n    deliveryMode?: DeliveryMode;\n    /**\n     * @member {DeliveryOrderEntryGroup[]} [deliveryOrderGroups]\n     */\n    deliveryOrderGroups?: DeliveryOrderEntryGroup[];\n    /**\n     * @member {string} [deliveryStatus]\n     */\n    deliveryStatus?: string;\n    /**\n     * @member {string} [deliveryStatusDisplay]\n     */\n    deliveryStatusDisplay?: string;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {boolean} [guestCustomer]\n     */\n    guestCustomer?: boolean;\n    /**\n     * @member {string} [guid]\n     */\n    guid?: string;\n    /**\n     * @member {boolean} [net]\n     */\n    net?: boolean;\n    /**\n     * @member {Price} [orderDiscounts]\n     */\n    orderDiscounts?: Price;\n    /**\n     * @member {PaymentDetails} [paymentInfo]\n     */\n    paymentInfo?: PaymentDetails;\n    /**\n     * @member {number} [pickupItemsQuantity]\n     */\n    pickupItemsQuantity?: number;\n    /**\n     * @member {PickupOrderEntryGroup[]} [pickupOrderGroups]\n     */\n    pickupOrderGroups?: PickupOrderEntryGroup[];\n    /**\n     * @member {Price} [productDiscounts]\n     */\n    productDiscounts?: Price;\n    /**\n     * @member {string} [site]\n     */\n    site?: string;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {string} [statusDisplay]\n     */\n    statusDisplay?: string;\n    /**\n     * @member {string} [store]\n     */\n    store?: string;\n    /**\n     * @member {Price} [subTotal]\n     */\n    subTotal?: Price;\n    /**\n     * @member {Price} [totalDiscounts]\n     */\n    totalDiscounts?: Price;\n    /**\n     * @member {number} [totalItems]\n     */\n    totalItems?: number;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n    /**\n     * @member {Price} [totalTax]\n     */\n    totalTax?: Price;\n    /**\n     * @member {OrderEntry[]} [unconsignedEntries]\n     */\n    unconsignedEntries?: OrderEntry[];\n    /**\n     * @member {Principal} [user]\n     */\n    user?: Principal;\n  }\n\n  /**\n   *\n   * An interface representing PaymentDetailsList.\n   */\n  export interface PaymentDetailsList {\n    /**\n     * @member {PaymentDetails[]} [payments]\n     */\n    payments?: PaymentDetails[];\n  }\n\n  /**\n   *\n   * An interface representing PointOfServiceStock.\n   */\n  export interface PointOfServiceStock {\n    /**\n     * @member {Address} [address]\n     */\n    address?: Address;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [displayName]\n     */\n    displayName?: string;\n    /**\n     * @member {number} [distanceKm]\n     */\n    distanceKm?: number;\n    /**\n     * @member {{ [propertyName: string]: string }} [features]\n     */\n    features?: { [propertyName: string]: string };\n    /**\n     * @member {string} [formattedDistance]\n     */\n    formattedDistance?: string;\n    /**\n     * @member {GeoPoint} [geoPoint]\n     */\n    geoPoint?: GeoPoint;\n    /**\n     * @member {Image} [mapIcon]\n     */\n    mapIcon?: Image;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {OpeningSchedule} [openingHours]\n     */\n    openingHours?: OpeningSchedule;\n    /**\n     * @member {Stock} [stockInfo]\n     */\n    stockInfo?: Stock;\n    /**\n     * @member {string} [storeContent]\n     */\n    storeContent?: string;\n    /**\n     * @member {Image[]} [storeImages]\n     */\n    storeImages?: Image[];\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductExpressUpdateElement.\n   */\n  export interface ProductExpressUpdateElement {\n    /**\n     * @member {string} [catalogId]\n     */\n    catalogId?: string;\n    /**\n     * @member {string} [catalogVersion]\n     */\n    catalogVersion?: string;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductExpressUpdateElementList.\n   */\n  export interface ProductExpressUpdateElementList {\n    /**\n     * @member {ProductExpressUpdateElement[]} [productExpressUpdateElements]\n     */\n    productExpressUpdateElements?: ProductExpressUpdateElement[];\n  }\n\n  /**\n   *\n   * An interface representing ProductList.\n   */\n  export interface ProductList {\n    /**\n     * @member {string} [catalog]\n     */\n    catalog?: string;\n    /**\n     * @member {number} [currentPage]\n     */\n    currentPage?: number;\n    /**\n     * @member {Product[]} [products]\n     */\n    products?: Product[];\n    /**\n     * @member {number} [totalPageCount]\n     */\n    totalPageCount?: number;\n    /**\n     * @member {number} [totalProductCount]\n     */\n    totalProductCount?: number;\n    /**\n     * @member {string} [version]\n     */\n    version?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductReferenceList.\n   */\n  export interface ProductReferenceList {\n    /**\n     * @member {ProductReference[]} [references]\n     */\n    references?: ProductReference[];\n  }\n\n  /**\n   *\n   * An interface representing SpellingSuggestion.\n   */\n  export interface SpellingSuggestion {\n    /**\n     * @member {string} [query]\n     */\n    query?: string;\n    /**\n     * @member {string} [suggestion]\n     */\n    suggestion?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductSearchPage.\n   */\n  export interface ProductSearchPage {\n    /**\n     * @member {Breadcrumb[]} [breadcrumbs]\n     */\n    breadcrumbs?: Breadcrumb[];\n    /**\n     * @member {string} [categoryCode]\n     */\n    categoryCode?: string;\n    /**\n     * @member {SearchState} [currentQuery]\n     */\n    currentQuery?: SearchState;\n    /**\n     * @member {Facet[]} [facets]\n     */\n    facets?: Facet[];\n    /**\n     * @member {string} [freeTextSearch]\n     */\n    freeTextSearch?: string;\n    /**\n     * @member {string} [keywordRedirectUrl]\n     */\n    keywordRedirectUrl?: string;\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {Product[]} [products]\n     */\n    products?: Product[];\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n    /**\n     * @member {SpellingSuggestion} [spellingSuggestion]\n     */\n    spellingSuggestion?: SpellingSuggestion;\n  }\n\n  /**\n   *\n   * An interface representing PromotionList.\n   */\n  export interface PromotionList {\n    /**\n     * @member {Promotion[]} [promotions]\n     */\n    promotions?: Promotion[];\n  }\n\n  /**\n   *\n   * An interface representing PromotionResultList.\n   */\n  export interface PromotionResultList {\n    /**\n     * @member {PromotionResult[]} [promotions]\n     */\n    promotions?: PromotionResult[];\n  }\n\n  /**\n   *\n   * An interface representing ReviewList.\n   */\n  export interface ReviewList {\n    /**\n     * @member {Review[]} [reviews]\n     */\n    reviews?: Review[];\n  }\n\n  /**\n   *\n   * An interface representing SaveCartResult.\n   */\n  export interface SaveCartResult {\n    /**\n     * @member {Cart} [savedCartData]\n     */\n    savedCartData?: Cart;\n  }\n\n  /**\n   *\n   * An interface representing StoreFinderSearchPage.\n   */\n  export interface StoreFinderSearchPage {\n    /**\n     * @member {number} [boundEastLongitude]\n     */\n    boundEastLongitude?: number;\n    /**\n     * @member {number} [boundNorthLatitude]\n     */\n    boundNorthLatitude?: number;\n    /**\n     * @member {number} [boundSouthLatitude]\n     */\n    boundSouthLatitude?: number;\n    /**\n     * @member {number} [boundWestLongitude]\n     */\n    boundWestLongitude?: number;\n    /**\n     * @member {string} [locationText]\n     */\n    locationText?: string;\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n    /**\n     * @member {number} [sourceLatitude]\n     */\n    sourceLatitude?: number;\n    /**\n     * @member {number} [sourceLongitude]\n     */\n    sourceLongitude?: number;\n    /**\n     * @member {PointOfService[]} [stores]\n     */\n    stores?: PointOfService[];\n  }\n\n  /**\n   *\n   * An interface representing StoreFinderStockSearchPage.\n   */\n  export interface StoreFinderStockSearchPage {\n    /**\n     * @member {number} [boundEastLongitude]\n     */\n    boundEastLongitude?: number;\n    /**\n     * @member {number} [boundNorthLatitude]\n     */\n    boundNorthLatitude?: number;\n    /**\n     * @member {number} [boundSouthLatitude]\n     */\n    boundSouthLatitude?: number;\n    /**\n     * @member {number} [boundWestLongitude]\n     */\n    boundWestLongitude?: number;\n    /**\n     * @member {string} [locationText]\n     */\n    locationText?: string;\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {Product} [product]\n     */\n    product?: Product;\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n    /**\n     * @member {number} [sourceLatitude]\n     */\n    sourceLatitude?: number;\n    /**\n     * @member {number} [sourceLongitude]\n     */\n    sourceLongitude?: number;\n    /**\n     * @member {PointOfServiceStock[]} [stores]\n     */\n    stores?: PointOfServiceStock[];\n  }\n\n  /**\n   *\n   * An interface representing Suggestion.\n   */\n  export interface Suggestion {\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing SuggestionList.\n   */\n  export interface SuggestionList {\n    /**\n     * @member {Suggestion[]} [suggestions]\n     */\n    suggestions?: Suggestion[];\n  }\n\n  /**\n   *\n   * An interface representing Title.\n   */\n  export interface Title {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing TitleList.\n   */\n  export interface TitleList {\n    /**\n     * @member {Title[]} [titles]\n     */\n    titles?: Title[];\n  }\n\n  /**\n   *\n   * An interface representing UserGroup.\n   */\n  export interface UserGroup {\n    /**\n     * @member {Principal[]} [members]\n     */\n    members?: Principal[];\n    /**\n     * @member {number} [membersCount]\n     */\n    membersCount?: number;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {UserGroup[]} [subGroups]\n     */\n    subGroups?: UserGroup[];\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing UserGroupList.\n   */\n  export interface UserGroupList {\n    /**\n     * @member {number} [currentPage]\n     */\n    currentPage?: number;\n    /**\n     * @member {number} [numberOfPages]\n     */\n    numberOfPages?: number;\n    /**\n     * @member {number} [pageSize]\n     */\n    pageSize?: number;\n    /**\n     * @member {number} [totalNumber]\n     */\n    totalNumber?: number;\n    /**\n     * @member {UserGroup[]} [userGroups]\n     */\n    userGroups?: UserGroup[];\n  }\n\n  /**\n   *\n   * An interface representing UserSignUp.\n   */\n  export interface UserSignUp {\n    /**\n     * @member {string} [firstName]\n     */\n    firstName?: string;\n    /**\n     * @member {string} [lastName]\n     */\n    lastName?: string;\n    /**\n     * @member {string} [password]\n     */\n    password?: string;\n    /**\n     * @member {string} [titleCode]\n     */\n    titleCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  export interface StoreCount {\n    count?: number;\n    isoCode?: string;\n    name?: string;\n    type?: string;\n  }\n\n  export interface StoreCountList {\n    countriesAndRegionsStoreCount?: StoreCount[];\n  }\n\n  /**\n   *\n   * An interface representing VoucherList.\n   */\n  export interface VoucherList {\n    /**\n     * @member {Voucher[]} [vouchers]\n     */\n    vouchers?: Voucher[];\n  }\n\n  /**\n   * Defines values for PriceType.\n   * Possible values include: 'BUY', 'FROM'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: PriceType = <PriceType>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum PriceType {\n    BUY = 'BUY',\n    FROM = 'FROM',\n  }\n\n  /**\n   * Defines values for ImageType.\n   * Possible values include: 'PRIMARY', 'GALLERY'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: ImageType = <ImageType>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum ImageType {\n    PRIMARY = 'PRIMARY',\n    GALLERY = 'GALLERY',\n  }\n\n  /**\n   * Defines values for Fields.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields = <Fields>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields1.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields1 = <Fields1>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields1 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields2.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields2 = <Fields2>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields2 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields3.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields3 = <Fields3>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields3 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields4.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields4 = <Fields4>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields4 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields5.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields5 = <Fields5>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields5 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields6.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields6 = <Fields6>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields6 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for PageType.\n   * Possible values include: 'ContentPage', 'ProductPage', 'CategoryPage',\n   * 'CatalogPage'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: PageType = <PageType>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum PageType {\n    CONTENT_PAGE = 'ContentPage',\n    PRODUCT_PAGE = 'ProductPage',\n    CATEGORY_PAGE = 'CategoryPage',\n    CATALOG_PAGE = 'CatalogPage',\n  }\n\n  /**\n   * Defines values for Fields7.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields7 = <Fields7>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields7 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields8.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields8 = <Fields8>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields8 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields9.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields9 = <Fields9>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields9 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields10.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields10 = <Fields10>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields10 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields11.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields11 = <Fields11>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields11 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields12.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields12 = <Fields12>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields12 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields13.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields13 = <Fields13>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields13 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields14.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields14 = <Fields14>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields14 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields15.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields15 = <Fields15>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields15 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields16.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields16 = <Fields16>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields16 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for SortEnum.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: SortEnum = <SortEnum>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum SortEnum {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields17.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields17 = <Fields17>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields17 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields18.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields18 = <Fields18>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields18 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields19.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields19 = <Fields19>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields19 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields20.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields20 = <Fields20>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields20 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields21.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields21 = <Fields21>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields21 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields22.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields22 = <Fields22>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields22 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields23.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields23 = <Fields23>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields23 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields24.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields24 = <Fields24>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields24 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields25.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields25 = <Fields25>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields25 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields26.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields26 = <Fields26>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields26 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields27.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields27 = <Fields27>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields27 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields28.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields28 = <Fields28>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields28 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields29.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields29 = <Fields29>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields29 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields30.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields30 = <Fields30>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields30 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields31.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields31 = <Fields31>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields31 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields32.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields32 = <Fields32>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields32 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields33.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields33 = <Fields33>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields33 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields34.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields34 = <Fields34>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields34 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields35.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields35 = <Fields35>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields35 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields36.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields36 = <Fields36>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields36 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields37.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields37 = <Fields37>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields37 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields38.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields38 = <Fields38>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields38 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields39.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields39 = <Fields39>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields39 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields40.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields40 = <Fields40>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields40 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields41.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields41 = <Fields41>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields41 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields42.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields42 = <Fields42>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields42 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields43.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields43 = <Fields43>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields43 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields44.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields44 = <Fields44>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields44 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields45.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields45 = <Fields45>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields45 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields46.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields46 = <Fields46>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields46 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields47.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields47 = <Fields47>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields47 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields48.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields48 = <Fields48>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields48 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields49.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields49 = <Fields49>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields49 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields50.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields50 = <Fields50>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields50 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields51.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields51 = <Fields51>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields51 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields52.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields52 = <Fields52>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields52 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields53.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields53 = <Fields53>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields53 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields54.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields54 = <Fields54>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields54 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields55.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields55 = <Fields55>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields55 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields56.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields56 = <Fields56>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields56 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields57.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields57 = <Fields57>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields57 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields58.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields58 = <Fields58>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields58 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields59.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields59 = <Fields59>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields59 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields60.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields60 = <Fields60>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields60 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields61.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields61 = <Fields61>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields61 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Type.\n   * Possible values include: 'all', 'product', 'order'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Type = <Type>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Type {\n    All = 'all',\n    Product = 'product',\n    Order = 'order',\n  }\n\n  export interface ConsentTemplate {\n    id?: string;\n    name?: string;\n    description?: string;\n    version?: number;\n    currentConsent?: Consent;\n  }\n\n  export interface Consent {\n    code?: string;\n    consentGivenDate?: Date;\n    consentWithdrawnDate?: Date;\n  }\n\n  export interface ConsentTemplateList {\n    consentTemplates?: ConsentTemplate[];\n  }\n}\n","import { Injectable, InjectionToken, Injector } from '@angular/core';\nimport { Observable, OperatorFunction } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\n/**\n * Converter is used to convert source data model to target data model.\n * By convention, we distinguish two flows:\n *   - *Normalize* is the conversion from backend models to UI models\n *   - *Serialize* is the conversion of UI models to backend models (in case of submitting data to the backend).\n *\n * Converters can be stacked together to to apply decoupled customizations\n */\nexport interface Converter<S, T> {\n  /**\n   * Convert converts source model to target model. Can use optional target parameter,\n   * used in case of stacking multiple converters (for example, to implement populator pattern).\n   *\n   * @param source Source data model\n   * @param target Optional, partially converted target model\n   */\n  convert(source: S, target?: T): T;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConverterService {\n  constructor(protected injector: Injector) {}\n\n  private converters: Map<\n    InjectionToken<Converter<any, any>>,\n    Converter<any, any>[]\n  > = new Map();\n\n  private getConverters<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): Converter<S, T>[] {\n    if (!this.converters.has(injectionToken)) {\n      const converters = this.injector.get<Converter<S, T>[]>(\n        injectionToken,\n        []\n      );\n      if (!Array.isArray(converters)) {\n        console.warn(\n          'Converter must be multi-provided, please use \"multi: true\" for',\n          injectionToken.toString()\n        );\n      }\n      this.converters.set(injectionToken, converters);\n    }\n\n    return this.converters.get(injectionToken);\n  }\n\n  /**\n   * Will return true if converters for specified token were provided\n   */\n  hasConverters<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): boolean {\n    const converters = this.getConverters(injectionToken);\n    return Array.isArray(converters) && converters.length > 0;\n  }\n\n  /**\n   * Pipeable operator to apply converter logic in a observable stream\n   */\n  pipeable<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): OperatorFunction<S, T> {\n    if (this.hasConverters(injectionToken)) {\n      return map((model: S) => this.convertSource(model, injectionToken));\n    } else {\n      return (observable: Observable<any>) => observable as Observable<T>;\n    }\n  }\n\n  /**\n   * Pipeable operator to apply converter logic in a observable stream to collection of items\n   */\n  pipeableMany<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): OperatorFunction<S[], T[]> {\n    if (this.hasConverters(injectionToken)) {\n      return map((model: S[]) => this.convertMany(model, injectionToken));\n    } else {\n      return (observable: Observable<any[]>) => observable as Observable<T[]>;\n    }\n  }\n\n  /**\n   * Apply converter logic specified by injection token to source data\n   */\n  convert<S, T>(source: S, injectionToken: InjectionToken<Converter<S, T>>): T {\n    if (this.hasConverters(injectionToken)) {\n      return this.convertSource(source, injectionToken);\n    } else {\n      return source as any;\n    }\n  }\n\n  /**\n   * Apply converter logic specified by injection token to a collection\n   */\n  convertMany<S, T>(\n    sources: S[],\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): T[] {\n    if (this.hasConverters(injectionToken) && Array.isArray(sources)) {\n      return sources.map(source => this.convertSource(source, injectionToken));\n    } else {\n      return sources as any[];\n    }\n  }\n\n  private convertSource<S, T>(\n    source: S,\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): T {\n    return this.getConverters(injectionToken).reduce(\n      (target, converter) => {\n        return converter.convert(source, target);\n      },\n      undefined as T\n    );\n  }\n}\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport { CmsComponentAdapter } from '../../../cms/connectors/component/cms-component.adapter';\nimport { CMS_COMPONENT_NORMALIZER } from '../../../cms/connectors/component/converters';\nimport { CmsComponent, PageType } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCmsComponentAdapter implements CmsComponentAdapter {\n  protected headers = new HttpHeaders().set('Content-Type', 'application/json');\n\n  constructor(\n    private http: HttpClient,\n    private occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load<T extends CmsComponent>(\n    id: string,\n    pageContext: PageContext\n  ): Observable<T> {\n    return this.http\n      .get<T>(this.getComponentEndPoint(id, pageContext), {\n        headers: this.headers,\n      })\n      .pipe(this.converter.pipeable<any, T>(CMS_COMPONENT_NORMALIZER));\n  }\n\n  findComponentsByIds(\n    ids: string[],\n    pageContext: PageContext,\n    fields = 'DEFAULT',\n    currentPage = 0,\n    pageSize = ids.length,\n    sort?: string\n  ): Observable<CmsComponent[]> {\n    const requestParams = {\n      ...this.getContextParams(pageContext),\n      ...this.getPaginationParams(currentPage, pageSize, sort),\n    };\n\n    requestParams['componentIds'] = ids.toString();\n\n    return this.http\n      .get<Occ.ComponentList>(\n        this.getComponentsEndpoint(requestParams, fields),\n        {\n          headers: this.headers,\n        }\n      )\n      .pipe(\n        pluck('component'),\n        this.converter.pipeableMany(CMS_COMPONENT_NORMALIZER)\n      );\n  }\n\n  findComponentsByIdsLegacy(\n    ids: string[],\n    pageContext: PageContext,\n    fields = 'DEFAULT',\n    currentPage = 0,\n    pageSize = ids.length,\n    sort?: string\n  ): Observable<CmsComponent[]> {\n    const idList: Occ.ComponentIDList = { idList: ids };\n\n    const requestParams = {\n      ...this.getContextParams(pageContext),\n      ...this.getPaginationParams(currentPage, pageSize, sort),\n    };\n\n    return this.http\n      .post<Occ.ComponentList>(\n        this.getComponentsEndpoint(requestParams, fields),\n        idList,\n        {\n          headers: this.headers,\n        }\n      )\n      .pipe(\n        pluck('component'),\n        this.converter.pipeableMany(CMS_COMPONENT_NORMALIZER)\n      );\n  }\n\n  protected getComponentEndPoint(id: string, pageContext: PageContext): string {\n    return this.occEndpoints.getUrl(\n      'component',\n      { id },\n      this.getContextParams(pageContext)\n    );\n  }\n\n  protected getComponentsEndpoint(requestParams: any, fields: string): string {\n    return this.occEndpoints.getUrl('components', { fields }, requestParams);\n  }\n\n  private getPaginationParams(\n    currentPage?: number,\n    pageSize?: number,\n    sort?: string\n  ): { [key: string]: string } {\n    const requestParams = {};\n    if (currentPage !== undefined) {\n      requestParams['currentPage'] = currentPage.toString();\n    }\n    if (pageSize !== undefined) {\n      requestParams['pageSize'] = pageSize.toString();\n    }\n    if (sort !== undefined) {\n      requestParams['sort'] = sort;\n    }\n\n    return requestParams;\n  }\n\n  private getContextParams(\n    pageContext: PageContext\n  ): { [key: string]: string } {\n    let requestParams = {};\n    switch (pageContext.type) {\n      case PageType.PRODUCT_PAGE: {\n        requestParams = { productCode: pageContext.id };\n        break;\n      }\n      case PageType.CATEGORY_PAGE: {\n        requestParams = { categoryCode: pageContext.id };\n        break;\n      }\n      case PageType.CATALOG_PAGE: {\n        requestParams = { catalogCode: pageContext.id };\n        break;\n      }\n    }\n\n    return requestParams;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  CMS_FLEX_COMPONENT_TYPE,\n  JSP_INCLUDE_CMS_COMPONENT_TYPE,\n} from '../../../../cms/config/cms-config';\nimport { ContentSlotComponentData } from '../../../../cms/model/content-slot-component-data.model';\nimport { ContentSlotData } from '../../../../cms/model/content-slot-data.model';\nimport { CmsStructureModel } from '../../../../cms/model/page.model';\nimport { Converter } from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable()\nexport class OccCmsPageNormalizer\n  implements Converter<Occ.CMSPage, CmsStructureModel> {\n  convert(\n    source: Occ.CMSPage,\n    target: CmsStructureModel = {}\n  ): CmsStructureModel {\n    this.normalizePageData(source, target);\n    this.normalizePageSlotData(source, target);\n    this.normalizePageComponentData(source, target);\n    this.normalizeComponentData(source, target);\n    return target;\n  }\n\n  private normalizePageData(source: any, target: CmsStructureModel): void {\n    target.page = {\n      loadTime: Date.now(),\n      name: source.name,\n      type: source.typeCode,\n      title: source.title,\n      pageId: source.uid,\n      template: source.template,\n      slots: {},\n      properties: source.properties,\n    };\n  }\n\n  private normalizePageSlotData(source: any, target: CmsStructureModel): void {\n    for (const slot of source.contentSlots.contentSlot) {\n      target.page.slots[slot.position] = {\n        components: [],\n        properties: slot.properties,\n      } as ContentSlotData;\n    }\n  }\n\n  private normalizePageComponentData(\n    source: any,\n    target: CmsStructureModel\n  ): void {\n    for (const slot of source.contentSlots.contentSlot) {\n      if (\n        slot.components.component &&\n        Array.isArray(slot.components.component)\n      ) {\n        for (const component of slot.components.component) {\n          const comp: ContentSlotComponentData = {\n            uid: component.uid,\n            typeCode: component.typeCode,\n            properties: component.properties,\n          };\n\n          if (component.typeCode === CMS_FLEX_COMPONENT_TYPE) {\n            comp.flexType = component.flexType;\n          } else if (component.typeCode === JSP_INCLUDE_CMS_COMPONENT_TYPE) {\n            comp.flexType = component.uid;\n          } else {\n            comp.flexType = component.typeCode;\n          }\n          target.page.slots[slot.position].components.push(comp);\n        }\n      }\n    }\n  }\n\n  private normalizeComponentData(source: any, target: CmsStructureModel): void {\n    target.components = [];\n\n    for (const slot of source.contentSlots.contentSlot) {\n      if (\n        slot.components.component &&\n        Array.isArray(slot.components.component)\n      ) {\n        for (const component of slot.components.component as any) {\n          // we dont put properties into component state\n          if (component.properties) {\n            component.properties = undefined;\n          }\n          target.components.push(component);\n        }\n      }\n    }\n  }\n}\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { PageContext } from '../../../routing';\nimport { CmsPageAdapter } from '../../../cms/connectors/page/cms-page.adapter';\nimport { CMS_PAGE_NORMALIZER } from '../../../cms/connectors/page/converters';\nimport { ConverterService } from '../../../util/converter.service';\nimport { CmsStructureModel } from '../../../cms/model/page.model';\nimport { PageType } from '../../../model/cms.model';\n\n@Injectable()\nexport class OccCmsPageAdapter implements CmsPageAdapter {\n  protected headers = new HttpHeaders().set('Content-Type', 'application/json');\n\n  constructor(\n    private http: HttpClient,\n    private occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(\n    pageContext: PageContext,\n    fields?: string\n  ): Observable<CmsStructureModel> {\n    // load page by Id\n    if (pageContext.type === undefined) {\n      return this.http\n        .get(\n          this.occEndpoints.getUrl('page', {\n            id: pageContext.id,\n            fields: fields ? fields : 'DEFAULT',\n          }),\n          {\n            headers: this.headers,\n          }\n        )\n        .pipe(this.converter.pipeable(CMS_PAGE_NORMALIZER));\n    }\n\n    // load page by PageContext\n    const httpParams = this.getPagesRequestParams(pageContext);\n    return this.http\n      .get(this.getPagesEndpoint(httpParams, fields), {\n        headers: this.headers,\n      })\n      .pipe(this.converter.pipeable(CMS_PAGE_NORMALIZER));\n  }\n\n  private getPagesEndpoint(\n    params: {\n      [key: string]: string;\n    },\n    fields?: string\n  ): string {\n    fields = fields ? fields : 'DEFAULT';\n    return this.occEndpoints.getUrl('pages', { fields }, params);\n  }\n\n  private getPagesRequestParams(\n    pageContext: PageContext\n  ): { [key: string]: any } {\n    let httpParams = {};\n\n    // smartedit preview page is loaded by previewToken which added by interceptor\n    if (pageContext.id !== 'smartedit-preview') {\n      httpParams = { pageType: pageContext.type };\n\n      if (pageContext.type === PageType.CONTENT_PAGE) {\n        httpParams['pageLabelOrId'] = pageContext.id;\n      } else {\n        httpParams['code'] = pageContext.id;\n      }\n    }\n    return httpParams;\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { CmsPageAdapter } from '../../../cms/connectors/page/cms-page.adapter';\nimport { OccCmsComponentAdapter } from './occ-cms-component.adapter';\nimport { OccCmsPageNormalizer } from './converters/occ-cms-page-normalizer';\nimport { OccCmsPageAdapter } from './occ-cms-page.adapter';\nimport { CMS_PAGE_NORMALIZER } from '../../../cms/connectors/page/converters';\nimport { CmsComponentAdapter } from '../../../cms/connectors/component/cms-component.adapter';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    {\n      provide: CmsPageAdapter,\n      useClass: OccCmsPageAdapter,\n    },\n    {\n      provide: CMS_PAGE_NORMALIZER,\n      useClass: OccCmsPageNormalizer,\n      multi: true,\n    },\n    {\n      provide: CmsComponentAdapter,\n      useClass: OccCmsComponentAdapter,\n    },\n  ],\n})\nexport class CmsOccModule {}\n","import { HttpClient, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map, pluck } from 'rxjs/operators';\nimport { CartAdapter } from '../../../cart/connectors/cart/cart.adapter';\nimport { CART_NORMALIZER } from '../../../cart/connectors/cart/converters';\nimport { Cart } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\nconst DETAILS_PARAMS =\n  'DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,' +\n  'entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue)),' +\n  'totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),' +\n  'deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue),pickupItemsQuantity,net,' +\n  'appliedVouchers,productDiscounts(formattedValue)';\n\n@Injectable()\nexport class OccCartAdapter implements CartAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = `users/${userId}/carts/`;\n    return this.occEndpoints.getEndpoint(cartEndpoint);\n  }\n\n  public loadAll(userId: string): Observable<Cart[]> {\n    const url = this.getCartEndpoint(userId);\n    const params = new HttpParams({\n      fromString: `fields=carts(${DETAILS_PARAMS},saveTime)`,\n    });\n\n    return this.http.get<Occ.CartList>(url, { params: params }).pipe(\n      pluck('carts'),\n      this.converter.pipeableMany(CART_NORMALIZER)\n    );\n  }\n\n  public load(userId: string, cartId: string): Observable<Cart> {\n    const url = this.getCartEndpoint(userId) + cartId;\n    const params = new HttpParams({\n      fromString: `fields=${DETAILS_PARAMS}`,\n    });\n\n    if (cartId === 'current') {\n      return this.loadAll(userId).pipe(\n        map(carts => {\n          if (carts) {\n            const activeCart = carts.find(cart => {\n              return cart['saveTime'] === undefined;\n            });\n            return activeCart;\n          } else {\n            return null;\n          }\n        })\n      );\n    } else {\n      return this.http\n        .get<Occ.Cart>(url, { params: params })\n        .pipe(this.converter.pipeable(CART_NORMALIZER));\n    }\n  }\n\n  create(\n    userId: string,\n    oldCartId?: string,\n    toMergeCartGuid?: string\n  ): Observable<Cart> {\n    const url = this.getCartEndpoint(userId);\n    const toAdd = JSON.stringify({});\n    let queryString = `fields=${DETAILS_PARAMS}`;\n\n    if (oldCartId) {\n      queryString = `${queryString}&oldCartId=${oldCartId}`;\n    }\n    if (toMergeCartGuid) {\n      queryString = `${queryString}&toMergeCartGuid=${toMergeCartGuid}`;\n    }\n    const params = new HttpParams({\n      fromString: queryString,\n    });\n\n    return this.http\n      .post<Occ.Cart>(url, toAdd, { params: params })\n      .pipe(this.converter.pipeable(CART_NORMALIZER));\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CartEntryAdapter } from '../../../cart/connectors/entry/cart-entry.adapter';\nimport { CART_MODIFICATION_NORMALIZER } from '../../../cart/connectors/entry/converters';\nimport { CartModification } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCartEntryAdapter implements CartEntryAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = 'users/' + userId + '/carts/';\n    return this.occEndpoints.getEndpoint(cartEndpoint);\n  }\n\n  public add(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity: number = 1\n  ): Observable<CartModification> {\n    const toAdd = JSON.stringify({});\n\n    const url = this.getCartEndpoint(userId) + cartId + '/entries';\n\n    const params = new HttpParams({\n      fromString: 'code=' + productCode + '&qty=' + quantity,\n    });\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .post<CartModification>(url, toAdd, { headers, params })\n      .pipe(this.converter.pipeable(CART_MODIFICATION_NORMALIZER));\n  }\n\n  public update(\n    userId: string,\n    cartId: string,\n    entryNumber: string,\n    qty: number,\n    pickupStore?: string\n  ): Observable<CartModification> {\n    const url =\n      this.getCartEndpoint(userId) + cartId + '/entries/' + entryNumber;\n\n    let queryString = 'qty=' + qty;\n    if (pickupStore) {\n      queryString = queryString + '&pickupStore=' + pickupStore;\n    }\n    const params = new HttpParams({\n      fromString: queryString,\n    });\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .patch<CartModification>(url, {}, { headers, params })\n      .pipe(this.converter.pipeable(CART_MODIFICATION_NORMALIZER));\n  }\n\n  public remove(\n    userId: string,\n    cartId: string,\n    entryNumber: string\n  ): Observable<any> {\n    const url =\n      this.getCartEndpoint(userId) + cartId + '/entries/' + entryNumber;\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http.delete(url, { headers });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport { Cart } from '../../../../model/cart.model';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable()\nexport class OccCartNormalizer implements Converter<Occ.Cart, Cart> {\n  constructor(private converter: ConverterService) {}\n\n  convert(source: Occ.Cart, target?: Cart): Cart {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source && source.entries) {\n      target.entries = source.entries.map(entry => ({\n        ...entry,\n        product: this.converter.convert(entry.product, PRODUCT_NORMALIZER),\n      }));\n    }\n\n    return target;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { CartAdapter } from '../../../cart/connectors/cart/cart.adapter';\nimport { OccCartAdapter } from './occ-cart.adapter';\nimport { CartEntryAdapter } from '../../../cart/connectors/entry/cart-entry.adapter';\nimport { OccCartEntryAdapter } from './occ-cart-entry.adapter';\nimport { CART_NORMALIZER } from '../../../cart/connectors/cart/converters';\nimport { OccCartNormalizer } from './converters/occ-cart-normalizer';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    {\n      provide: CartAdapter,\n      useClass: OccCartAdapter,\n    },\n    {\n      provide: CART_NORMALIZER,\n      useClass: OccCartNormalizer,\n      multi: true,\n    },\n    {\n      provide: CartEntryAdapter,\n      useClass: OccCartEntryAdapter,\n    },\n  ],\n})\nexport class CartOccModule {}\n","import { Injectable } from '@angular/core';\nimport { ProductReference } from '../../../../model/product.model';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\n\n@Injectable()\nexport class OccProductReferencesListNormalizer\n  implements Converter<Occ.ProductReferenceList, ProductReference[]> {\n  constructor(private converter: ConverterService) {}\n\n  convert(\n    source: Occ.ProductReferenceList,\n    target: ProductReference[] = []\n  ): ProductReference[] {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source && source.references) {\n      target = source.references.map(reference => ({\n        ...reference,\n        target: this.converter.convert(reference.target, PRODUCT_NORMALIZER),\n      }));\n\n      return target;\n    }\n  }\n}\n","import { Occ } from '../../../occ-models/occ.models';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Injectable } from '@angular/core';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport { ProductSearchPage } from '../../../../model/product-search.model';\n\n@Injectable()\nexport class OccProductSearchPageNormalizer\n  implements Converter<Occ.ProductSearchPage, ProductSearchPage> {\n  constructor(private converterService: ConverterService) {}\n\n  convert(\n    source: Occ.ProductSearchPage,\n    target: ProductSearchPage = {}\n  ): ProductSearchPage {\n    target = {\n      ...target,\n      ...(source as any),\n    };\n    if (source.products) {\n      target.products = source.products.map(product =>\n        this.converterService.convert(product, PRODUCT_NORMALIZER)\n      );\n    }\n    return target;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { OccConfig } from '../../../config/occ-config';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { Converter } from '../../../../util/converter.service';\nimport { Product } from '../../../../model/product.model';\nimport { Images } from '../../../../model/image.model';\n\n@Injectable()\nexport class ProductImageNormalizer implements Converter<Occ.Product, Product> {\n  constructor(protected config: OccConfig) {}\n\n  convert(source: Occ.Product, target?: Product): Product {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n    if (source.images) {\n      target.images = this.normalize(source.images);\n    }\n    return target;\n  }\n\n  /**\n   * @desc\n   * Creates the image structure we'd like to have. Instead of\n   * having a single list with all images despite type and format\n   * we create a proper structure. With that we can do:\n   * - images.primary.thumnail.url\n   * - images.GALLERY[0].thumnail.url\n   */\n  normalize(source: Occ.Image[]): Images {\n    const images = {};\n    if (source) {\n      for (const image of source) {\n        const isList = image.hasOwnProperty('galleryIndex');\n        if (!images.hasOwnProperty(image.imageType)) {\n          images[image.imageType] = isList ? [] : {};\n        }\n\n        let imageContainer;\n        if (isList && !images[image.imageType][image.galleryIndex]) {\n          images[image.imageType][image.galleryIndex] = {};\n        }\n\n        if (isList) {\n          imageContainer = images[image.imageType][image.galleryIndex];\n        } else {\n          imageContainer = images[image.imageType];\n        }\n\n        /**\n         * Traditionally, in an on-prem world, medias and other backend related calls\n         * are hosted at the same platform, but in a cloud setup, applications are are\n         * typically distributed cross different environments. For media, we use the\n         * `backend.media.baseUrl` by default, but fallback to `backend.occ.baseUrl`\n         * if none provided.\n         */\n        image.url =\n          (this.config.backend.media.baseUrl ||\n            this.config.backend.occ.baseUrl ||\n            '') + image.url;\n\n        imageContainer[image.format] = image;\n      }\n    }\n    return images;\n  }\n}\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ProductReference } from '../../../model/product.model';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport { PRODUCT_REFERENCES_NORMALIZER } from '../../../product/connectors/references/converters';\nimport { ProductReferencesAdapter } from '../../../product/connectors/references/product-references.adapter';\n\n@Injectable()\nexport class OccProductReferencesAdapter implements ProductReferencesAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]> {\n    return this.http\n      .get(this.getEndpoint(productCode, referenceType, pageSize))\n      .pipe(this.converter.pipeable(PRODUCT_REFERENCES_NORMALIZER));\n  }\n\n  protected getEndpoint(\n    code: string,\n    reference?: string,\n    pageSize?: number\n  ): string {\n    return this.occEndpoints.getUrl(\n      'productReferences',\n      {\n        productCode: code,\n      },\n      { referenceType: reference, pageSize }\n    );\n  }\n}\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport { Review } from '../../../model/product.model';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport {\n  PRODUCT_REVIEW_NORMALIZER,\n  PRODUCT_REVIEW_SERIALIZER,\n} from '../../../product/connectors/reviews/converters';\nimport { ProductReviewsAdapter } from '../../../product/connectors/reviews/product-reviews.adapter';\n\n@Injectable()\nexport class OccProductReviewsAdapter implements ProductReviewsAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(productCode: string, maxCount?: number): Observable<Review[]> {\n    return this.http.get(this.getEndpoint(productCode, maxCount)).pipe(\n      pluck('reviews'),\n      this.converter.pipeableMany(PRODUCT_REVIEW_NORMALIZER)\n    );\n  }\n\n  post(productCode: string, review: any): Observable<Review> {\n    review = this.converter.convert(review, PRODUCT_REVIEW_SERIALIZER);\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    const body = new URLSearchParams();\n    body.append('headline', review.headline);\n    body.append('comment', review.comment);\n    body.append('rating', review.rating.toString());\n    body.append('alias', review.alias);\n\n    return this.http.post(this.getEndpoint(productCode), body.toString(), {\n      headers,\n    });\n  }\n\n  protected getEndpoint(code: string, maxCount?: number): string {\n    return this.occEndpoints.getUrl(\n      'productReviews',\n      {\n        productCode: code,\n      },\n      { maxCount }\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ProductSearchAdapter } from '../../../product/connectors/search/product-search.adapter';\nimport { SearchConfig } from '../../../product/model/search-config';\n\nimport { Observable } from 'rxjs';\nimport { HttpClient } from '@angular/common/http';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport {\n  PRODUCT_SEARCH_PAGE_NORMALIZER,\n  PRODUCT_SUGGESTION_NORMALIZER,\n} from '../../../product/connectors/search/converters';\nimport { pluck } from 'rxjs/operators';\nimport {\n  Suggestion,\n  ProductSearchPage,\n} from '../../../model/product-search.model';\n\nconst DEFAULT_SEARCH_CONFIG: SearchConfig = {\n  pageSize: 20,\n};\n\n@Injectable()\nexport class OccProductSearchAdapter implements ProductSearchAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  search(\n    query: string,\n    searchConfig: SearchConfig = DEFAULT_SEARCH_CONFIG\n  ): Observable<ProductSearchPage> {\n    return this.http\n      .get(this.getSearchEndpoint(query, searchConfig))\n      .pipe(this.converter.pipeable(PRODUCT_SEARCH_PAGE_NORMALIZER));\n  }\n\n  loadSuggestions(\n    term: string,\n    pageSize: number = 3\n  ): Observable<Suggestion[]> {\n    return this.http\n      .get(this.getSuggestionEndpoint(term, pageSize.toString()))\n      .pipe(\n        pluck('suggestions'),\n        this.converter.pipeableMany(PRODUCT_SUGGESTION_NORMALIZER)\n      );\n  }\n\n  protected getSearchEndpoint(\n    query: string,\n    searchConfig: SearchConfig\n  ): string {\n    return this.occEndpoints.getUrl(\n      'productSearch',\n      {\n        query,\n      },\n      {\n        pageSize: searchConfig.pageSize,\n        currentPage: searchConfig.currentPage,\n        sort: searchConfig.sortCode,\n      }\n    );\n  }\n\n  protected getSuggestionEndpoint(term: string, max: string): string {\n    return this.occEndpoints.getUrl('productSuggestions', {\n      term,\n      max,\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ProductAdapter } from '../../../product/connectors/product/product.adapter';\nimport { Observable } from 'rxjs';\nimport { HttpClient } from '@angular/common/http';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport { PRODUCT_NORMALIZER } from '../../../product/connectors/product/converters';\nimport { Product } from '../../../model/product.model';\n\n@Injectable()\nexport class OccProductAdapter implements ProductAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(productCode: string): Observable<Product> {\n    return this.http\n      .get(this.getEndpoint(productCode))\n      .pipe(this.converter.pipeable(PRODUCT_NORMALIZER));\n  }\n\n  protected getEndpoint(code: string): string {\n    return this.occEndpoints.getUrl('product', {\n      productCode: code,\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { OccConfig } from '../../../config/occ-config';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { Converter } from '../../../../util/converter.service';\nimport { Product } from '../../../../model/product.model';\n\n@Injectable()\nexport class ProductNameNormalizer implements Converter<Occ.Product, Product> {\n  constructor(protected config: OccConfig) {}\n\n  convert(source: Occ.Product, target?: Product): Product {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n    if (source.name) {\n      target.name = this.normalize(source.name);\n      target.nameHtml = source.name;\n    }\n    return target;\n  }\n\n  protected normalize(name: string): string {\n    return name.replace(/<[^>]*>/g, '');\n  }\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccProductConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        product:\n          'products/${productCode}?fields=DEFAULT,averageRating,images(FULL),classifications,numberOfReviews,categories(FULL)',\n        productReviews: 'products/${productCode}/reviews',\n        // Uncomment this when occ gets configured\n        // productReferences:\n        //   'products/${productCode}/references?fields=DEFAULT,references(target(images(FULL)))&referenceType=${referenceType}',\n        productReferences:\n          'products/${productCode}/references?fields=DEFAULT,references(target(images(FULL)))',\n        // tslint:disable:max-line-length\n        productSearch:\n          'products/search?fields=products(code,name,summary,price(FULL),images(DEFAULT),stock(FULL),averageRating),facets,breadcrumbs,pagination(DEFAULT),sorts(DEFAULT),freeTextSearch&query=${query}',\n        // tslint:enable\n        productSuggestions: 'products/suggestions?term=${term}&max=${max}',\n      },\n    },\n  },\n};\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { ConfigModule } from '../../../config/config.module';\nimport { PRODUCT_NORMALIZER } from '../../../product/connectors/product/converters';\nimport { ProductAdapter } from '../../../product/connectors/product/product.adapter';\nimport { PRODUCT_REFERENCES_NORMALIZER } from '../../../product/connectors/references/converters';\nimport { ProductReferencesAdapter } from '../../../product/connectors/references/product-references.adapter';\nimport { ProductReviewsAdapter } from '../../../product/connectors/reviews/product-reviews.adapter';\nimport { PRODUCT_SEARCH_PAGE_NORMALIZER } from '../../../product/connectors/search/converters';\nimport { ProductSearchAdapter } from '../../../product/connectors/search/product-search.adapter';\nimport { OccProductReferencesListNormalizer } from './converters/occ-product-references-list-normalizer';\nimport { OccProductSearchPageNormalizer } from './converters/occ-product-search-page-normalizer';\nimport { ProductImageNormalizer } from './converters/product-image-normalizer';\nimport { OccProductReferencesAdapter } from './occ-product-references.adapter';\nimport { OccProductReviewsAdapter } from './occ-product-reviews.adapter';\nimport { OccProductSearchAdapter } from './occ-product-search.adapter';\nimport { OccProductAdapter } from './occ-product.adapter';\nimport { ProductNameNormalizer } from './converters/product-name-normalizer';\nimport { defaultOccProductConfig } from './default-occ-product-config';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    ConfigModule.withConfig(defaultOccProductConfig),\n  ],\n  providers: [\n    {\n      provide: ProductAdapter,\n      useClass: OccProductAdapter,\n    },\n    {\n      provide: PRODUCT_NORMALIZER,\n      useClass: ProductImageNormalizer,\n      multi: true,\n    },\n    {\n      provide: PRODUCT_NORMALIZER,\n      useClass: ProductNameNormalizer,\n      multi: true,\n    },\n    {\n      provide: ProductReferencesAdapter,\n      useClass: OccProductReferencesAdapter,\n    },\n    {\n      provide: PRODUCT_REFERENCES_NORMALIZER,\n      useClass: OccProductReferencesListNormalizer,\n      multi: true,\n    },\n    {\n      provide: ProductSearchAdapter,\n      useClass: OccProductSearchAdapter,\n    },\n    {\n      provide: PRODUCT_SEARCH_PAGE_NORMALIZER,\n      useClass: OccProductSearchPageNormalizer,\n      multi: true,\n    },\n    {\n      provide: ProductReviewsAdapter,\n      useClass: OccProductReviewsAdapter,\n    },\n  ],\n})\nexport class ProductOccModule {}\n","import { HttpClient, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Country, CountryType, Region } from '../../../model/address.model';\nimport { BaseSite, Currency, Language } from '../../../model/misc.model';\nimport {\n  COUNTRY_NORMALIZER,\n  CURRENCY_NORMALIZER,\n  LANGUAGE_NORMALIZER,\n  REGION_NORMALIZER,\n} from '../../../site-context/connectors/converters';\nimport { SiteAdapter } from '../../../site-context/connectors/site.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\nconst COUNTRIES_ENDPOINT = 'countries';\nconst REGIONS_ENDPOINT = 'regions';\n\n@Injectable()\nexport class OccSiteAdapter implements SiteAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadLanguages(): Observable<Language[]> {\n    return this.http\n      .get<Occ.LanguageList>(this.occEndpoints.getEndpoint('languages'))\n      .pipe(\n        map(languageList => languageList.languages),\n        this.converter.pipeableMany(LANGUAGE_NORMALIZER)\n      );\n  }\n\n  loadCurrencies(): Observable<Currency[]> {\n    return this.http\n      .get<Occ.CurrencyList>(this.occEndpoints.getEndpoint('currencies'))\n      .pipe(\n        map(currencyList => currencyList.currencies),\n        this.converter.pipeableMany(CURRENCY_NORMALIZER)\n      );\n  }\n\n  loadCountries(type?: CountryType): Observable<Country[]> {\n    let params;\n\n    if (type) {\n      params = new HttpParams().set('type', type);\n    }\n\n    return this.http\n      .get<Occ.CountryList>(this.occEndpoints.getEndpoint(COUNTRIES_ENDPOINT), {\n        params,\n      })\n      .pipe(\n        map(countryList => countryList.countries),\n        this.converter.pipeableMany(COUNTRY_NORMALIZER)\n      );\n  }\n\n  loadRegions(countryIsoCode: string): Observable<Region[]> {\n    const regionsEndpoint = `${COUNTRIES_ENDPOINT}/${countryIsoCode}/${REGIONS_ENDPOINT}?fields=regions(name,isocode,isocodeShort)`;\n    return this.http\n      .get<Occ.RegionList>(this.occEndpoints.getEndpoint(regionsEndpoint))\n      .pipe(\n        map(regionList => regionList.regions),\n        this.converter.pipeableMany(REGION_NORMALIZER)\n      );\n  }\n\n  loadBaseSite(): Observable<BaseSite> {\n    const baseUrl = this.occEndpoints.getBaseEndpoint();\n    const urlSplits = baseUrl.split('/');\n    const activeSite = urlSplits.pop();\n    const url = urlSplits.join('/') + '/basesites';\n\n    const params = new HttpParams({\n      fromString: 'fields=FULL',\n    });\n\n    return this.http\n      .get<{ baseSites: BaseSite[] }>(url, { params: params })\n      .pipe(\n        map(siteList => {\n          return siteList.baseSites.find(site => site.uid === activeSite);\n        })\n      );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\n\nimport { Observable } from 'rxjs';\nimport { CurrencyService } from '../../../site-context/facade/currency.service';\nimport { LanguageService } from '../../../site-context/facade/language.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { SiteContextConfig } from '../../../site-context/config/site-context-config';\nimport { getContextParameterDefault } from '../../../site-context/config/context-config-utils';\nimport {\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from '../../../site-context/providers/context-service-map';\n\n@Injectable()\nexport class SiteContextInterceptor implements HttpInterceptor {\n  activeLang: string;\n  activeCurr: string;\n\n  constructor(\n    private languageService: LanguageService,\n    private currencyService: CurrencyService,\n    private occEndpoints: OccEndpointsService,\n    private config: SiteContextConfig\n  ) {\n    this.activeLang = getContextParameterDefault(\n      this.config,\n      LANGUAGE_CONTEXT_ID\n    );\n    this.activeCurr = getContextParameterDefault(\n      this.config,\n      CURRENCY_CONTEXT_ID\n    );\n\n    this.languageService\n      .getActive()\n      .subscribe(data => (this.activeLang = data));\n\n    this.currencyService\n      .getActive()\n      .subscribe(data => (this.activeCurr = data));\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (request.url.includes(this.occEndpoints.getBaseEndpoint())) {\n      request = request.clone({\n        setParams: {\n          lang: this.activeLang,\n          curr: this.activeCurr,\n        },\n      });\n    }\n\n    return next.handle(request);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HTTP_INTERCEPTORS, HttpClientModule } from '@angular/common/http';\nimport { OccSiteAdapter } from './occ-site.adapter';\nimport { SiteAdapter } from '../../../site-context/connectors/site.adapter';\nimport { SiteContextInterceptor } from './site-context.interceptor';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    {\n      provide: SiteAdapter,\n      useClass: OccSiteAdapter,\n    },\n    {\n      provide: HTTP_INTERCEPTORS,\n      useClass: SiteContextInterceptor,\n      multi: true,\n    },\n  ],\n})\nexport class SiteContextOccModule {}\n","import { StoreFinderSearchConfig } from '../model/search-config';\nimport { Observable } from 'rxjs';\nimport { PointOfService } from '../../model/point-of-service.model';\nimport { GeoPoint } from '../../model/misc.model';\nimport {\n  StoreFinderSearchPage,\n  StoreCount,\n} from '../../model/store-finder.model';\n\nexport abstract class StoreFinderAdapter {\n  abstract search(\n    query: string,\n    searchConfig: StoreFinderSearchConfig,\n    longitudeLatitude?: GeoPoint\n  ): Observable<StoreFinderSearchPage>;\n\n  abstract loadCounts(): Observable<StoreCount[]>;\n\n  abstract load(storeId: string): Observable<PointOfService>;\n}\n","import { StoreFinderSearchConfig } from '../model/search-config';\nimport { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { StoreFinderAdapter } from './store-finder.adapter';\nimport { PointOfService } from '../../model/point-of-service.model';\nimport { GeoPoint } from '../../model/misc.model';\nimport {\n  StoreCount,\n  StoreFinderSearchPage,\n} from '../../model/store-finder.model';\n\n@Injectable({ providedIn: 'root' })\nexport class StoreFinderConnector {\n  constructor(protected adapter: StoreFinderAdapter) {}\n\n  search(\n    query: string,\n    searchConfig: StoreFinderSearchConfig,\n    longitudeLatitude?: GeoPoint\n  ): Observable<StoreFinderSearchPage> {\n    return this.adapter.search(query, searchConfig, longitudeLatitude);\n  }\n\n  getCounts(): Observable<StoreCount[]> {\n    return this.adapter.loadCounts();\n  }\n\n  get(storeId: string): Observable<PointOfService> {\n    return this.adapter.load(storeId);\n  }\n}\n","import { Converter } from '../../util/converter.service';\nimport { PointOfService } from '../../model/point-of-service.model';\nimport { InjectionToken } from '@angular/core';\nimport {\n  StoreFinderSearchPage,\n  StoreCount,\n} from '../../model/store-finder.model';\n\nexport const POINT_OF_SERVICE_NORMALIZER = new InjectionToken<\n  Converter<any, PointOfService>\n>('PointOfServiceNormalizer');\n\nexport const STORE_FINDER_SEARCH_PAGE_NORMALIZER = new InjectionToken<\n  Converter<any, StoreFinderSearchPage>\n>('StoreFinderSearchPageNormalizer');\n\nexport const STORE_COUNT_NORMALIZER = new InjectionToken<\n  Converter<any, StoreCount>\n>('StoreCountNormalizer');\n","import { HttpClient, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { GeoPoint } from '../../../model/misc.model';\nimport { PointOfService } from '../../../model/point-of-service.model';\nimport {\n  StoreCount,\n  StoreFinderSearchPage,\n} from '../../../model/store-finder.model';\nimport {\n  POINT_OF_SERVICE_NORMALIZER,\n  STORE_COUNT_NORMALIZER,\n  STORE_FINDER_SEARCH_PAGE_NORMALIZER,\n} from '../../../store-finder/connectors';\nimport { StoreFinderAdapter } from '../../../store-finder/connectors/store-finder.adapter';\nimport { StoreFinderSearchConfig } from '../../../store-finder/model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\nconst STORES_ENDPOINT = 'stores';\n\n@Injectable()\nexport class OccStoreFinderAdapter implements StoreFinderAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  search(\n    query: string,\n    searchConfig: StoreFinderSearchConfig,\n    longitudeLatitude?: GeoPoint\n  ): Observable<StoreFinderSearchPage> {\n    return this.callOccFindStores(query, searchConfig, longitudeLatitude).pipe(\n      this.converter.pipeable(STORE_FINDER_SEARCH_PAGE_NORMALIZER)\n    );\n  }\n\n  loadCounts(): Observable<StoreCount[]> {\n    const storeCountUrl = this.getStoresEndpoint('storescounts');\n\n    return this.http.get<Occ.StoreCountList>(storeCountUrl).pipe(\n      map(({ countriesAndRegionsStoreCount }) => countriesAndRegionsStoreCount),\n      this.converter.pipeableMany(STORE_COUNT_NORMALIZER)\n    );\n  }\n\n  load(storeId: string): Observable<PointOfService> {\n    const storeDetailsUrl = this.getStoresEndpoint(storeId);\n    const params = { fields: 'FULL' };\n\n    return this.http\n      .get<Occ.PointOfService>(storeDetailsUrl, { params })\n      .pipe(this.converter.pipeable(POINT_OF_SERVICE_NORMALIZER));\n  }\n\n  protected callOccFindStores(\n    query: string,\n    searchConfig: StoreFinderSearchConfig,\n    longitudeLatitude?: GeoPoint\n  ): Observable<Occ.StoreFinderSearchPage> {\n    const url = this.getStoresEndpoint();\n    let params: HttpParams = new HttpParams({\n      fromString:\n        'fields=stores(name,displayName,openingHours(weekDayOpeningList(FULL),specialDayOpeningList(FULL)),' +\n        'geoPoint(latitude,longitude),address(line1,line2,town,region(FULL),postalCode,phone,country,email), features),' +\n        'pagination(DEFAULT),' +\n        'sorts(DEFAULT)',\n    });\n\n    if (longitudeLatitude) {\n      params = params.set('longitude', String(longitudeLatitude.longitude));\n      params = params.set('latitude', String(longitudeLatitude.latitude));\n    } else {\n      params = params.set('query', query);\n    }\n    if (searchConfig.pageSize) {\n      params = params.set('pageSize', String(searchConfig.pageSize));\n    }\n    if (searchConfig.currentPage) {\n      params = params.set('currentPage', String(searchConfig.currentPage));\n    }\n    if (searchConfig.sort) {\n      params = params.set('sort', searchConfig.sort);\n    }\n\n    return this.http.get<Occ.StoreFinderSearchPage>(url, { params });\n  }\n\n  protected getStoresEndpoint(url?: string): string {\n    const baseUrl = this.occEndpoints.getEndpoint(STORES_ENDPOINT);\n\n    return url ? baseUrl + '/' + url : baseUrl;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { StoreFinderAdapter } from '../../../store-finder/connectors/store-finder.adapter';\nimport { OccStoreFinderAdapter } from './occ-store-finder.adapter';\n\n@NgModule({\n  providers: [{ provide: StoreFinderAdapter, useClass: OccStoreFinderAdapter }],\n})\nexport class StoreFinderOccModule {}\n","import { HttpClient, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ORDER_NORMALIZER } from '../../../checkout/connectors/checkout/converters';\nimport { Order, OrderHistoryList } from '../../../model/order.model';\nimport { ORDER_HISTORY_NORMALIZER } from '../../../user/connectors/order/converters';\nimport { UserOrderAdapter } from '../../../user/connectors/order/user-order.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n// To be changed to a more optimised params after ticket: C3PO-1076\nconst FULL_PARAMS = 'fields=FULL';\n\n@Injectable()\nexport class OccUserOrderAdapter implements UserOrderAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getOrderEndpoint(userId: string): string {\n    const orderEndpoint = 'users/' + userId + '/orders';\n    return this.occEndpoints.getEndpoint(orderEndpoint);\n  }\n\n  public load(userId: string, orderCode: string): Observable<Order> {\n    const url = this.getOrderEndpoint(userId);\n\n    const orderUrl = url + '/' + orderCode;\n\n    const params = new HttpParams({\n      fromString: FULL_PARAMS,\n    });\n\n    return this.http\n      .get<Occ.Order>(orderUrl, {\n        params: params,\n      })\n      .pipe(this.converter.pipeable(ORDER_NORMALIZER));\n  }\n\n  public loadHistory(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<OrderHistoryList> {\n    const url = this.getOrderEndpoint(userId);\n    let params = new HttpParams();\n    if (pageSize) {\n      params = params.set('pageSize', pageSize.toString());\n    }\n    if (currentPage) {\n      params = params.set('currentPage', currentPage.toString());\n    }\n    if (sort) {\n      params = params.set('sort', sort);\n    }\n\n    return this.http\n      .get<Occ.OrderHistoryList>(url, { params: params })\n      .pipe(this.converter.pipeable(ORDER_HISTORY_NORMALIZER));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { UserAddressAdapter } from '../../../user/connectors/address/user-address.adapter';\nimport { Address, AddressValidation } from '../../../model/address.model';\nimport { Observable, throwError } from 'rxjs';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { catchError, map } from 'rxjs/operators';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport {\n  ADDRESS_NORMALIZER,\n  ADDRESS_SERIALIZER,\n  ADDRESS_VALIDATION_NORMALIZER,\n} from '../../../user/connectors/address/converters';\n\nconst USER_ENDPOINT = 'users/';\nconst ADDRESSES_ENDPOINT = '/addresses';\nconst ADDRESSES_VERIFICATION_ENDPOINT = '/addresses/verification';\n\n@Injectable()\nexport class OccUserAddressAdapter implements UserAddressAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  private getUserEndpoint(userId: string): string {\n    const endpoint = `${USER_ENDPOINT}${userId}`;\n    return this.occEndpoints.getEndpoint(endpoint);\n  }\n\n  loadAll(userId: string): Observable<Address[]> {\n    const url = this.getUserEndpoint(userId) + ADDRESSES_ENDPOINT;\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http.get<Occ.AddressList>(url, { headers }).pipe(\n      catchError((error: any) => throwError(error)),\n      map(addressList => addressList.addresses),\n      this.converter.pipeableMany(ADDRESS_NORMALIZER)\n    );\n  }\n\n  add(userId: string, address: Address): Observable<{}> {\n    const url = this.getUserEndpoint(userId) + ADDRESSES_ENDPOINT;\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .post(url, address, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  update(userId: string, addressId: string, address: Address): Observable<{}> {\n    const url =\n      this.getUserEndpoint(userId) + ADDRESSES_ENDPOINT + '/' + addressId;\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .patch(url, address, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  verify(userId: string, address: Address): Observable<AddressValidation> {\n    const url = this.getUserEndpoint(userId) + ADDRESSES_VERIFICATION_ENDPOINT;\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http.post<AddressValidation>(url, address, { headers }).pipe(\n      catchError((error: any) => throwError(error)),\n      this.converter.pipeable(ADDRESS_VALIDATION_NORMALIZER)\n    );\n  }\n\n  delete(userId: string, addressId: string): Observable<{}> {\n    const url =\n      this.getUserEndpoint(userId) + ADDRESSES_ENDPOINT + '/' + addressId;\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .delete(url, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\nimport {\n  TITLE_NORMALIZER,\n  USER_NORMALIZER,\n  USER_SERIALIZER,\n  USER_SIGN_UP_SERIALIZER,\n} from '../../../user/connectors/user/converters';\nimport { UserAdapter } from '../../../user/connectors/user/user.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\n\nconst USER_ENDPOINT = 'users/';\nconst FORGOT_PASSWORD_ENDPOINT = '/forgottenpasswordtokens';\nconst RESET_PASSWORD_ENDPOINT = '/resetpassword';\nconst UPDATE_EMAIL_ENDPOINT = '/login';\nconst UPDATE_PASSWORD_ENDPOINT = '/password';\nconst TITLES_ENDPOINT = 'titles';\n\n@Injectable()\nexport class OccUserAdapter implements UserAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  private getUserEndpoint(userId?: string): string {\n    const endpoint = userId ? `${USER_ENDPOINT}${userId}` : USER_ENDPOINT;\n    return this.occEndpoints.getEndpoint(endpoint);\n  }\n\n  load(userId: string): Observable<User> {\n    const url = this.getUserEndpoint(userId);\n    return this.http\n      .get<Occ.User>(url)\n      .pipe(this.converter.pipeable(USER_NORMALIZER));\n  }\n\n  update(userId: string, user: User): Observable<{}> {\n    const url = this.getUserEndpoint(userId);\n    user = this.converter.convert(user, USER_SERIALIZER);\n    return this.http.patch(url, user);\n  }\n\n  register(user: UserSignUp): Observable<User> {\n    const url: string = this.getUserEndpoint();\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    user = this.converter.convert(user, USER_SIGN_UP_SERIALIZER);\n\n    return this.http\n      .post<User>(url, user, { headers })\n      .pipe(this.converter.pipeable(USER_NORMALIZER));\n  }\n\n  requestForgotPasswordEmail(userEmailAddress: string): Observable<{}> {\n    const url = this.occEndpoints.getEndpoint(FORGOT_PASSWORD_ENDPOINT);\n    const httpParams: HttpParams = new HttpParams().set(\n      'userId',\n      userEmailAddress\n    );\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    return this.http.post(url, httpParams, { headers });\n  }\n\n  resetPassword(token: string, newPassword: string): Observable<{}> {\n    const url = this.occEndpoints.getEndpoint(RESET_PASSWORD_ENDPOINT);\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n\n    return this.http.post(url, { token, newPassword }, { headers });\n  }\n\n  updateEmail(\n    userId: string,\n    currentPassword: string,\n    newUserId: string\n  ): Observable<{}> {\n    const url = this.getUserEndpoint(userId) + UPDATE_EMAIL_ENDPOINT;\n    const httpParams: HttpParams = new HttpParams()\n      .set('password', currentPassword)\n      .set('newLogin', newUserId);\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http.put(url, httpParams, { headers });\n  }\n\n  updatePassword(\n    userId: string,\n    oldPassword: string,\n    newPassword: string\n  ): Observable<{}> {\n    const url = this.getUserEndpoint(userId) + UPDATE_PASSWORD_ENDPOINT;\n    const httpParams: HttpParams = new HttpParams()\n      .set('old', oldPassword)\n      .set('new', newPassword);\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http.put(url, httpParams, { headers });\n  }\n\n  remove(userId: string): Observable<{}> {\n    const url = this.getUserEndpoint(userId);\n    return this.http.delete<User>(url);\n  }\n\n  loadTitles(): Observable<Title[]> {\n    return this.http\n      .get<Occ.TitleList>(this.occEndpoints.getEndpoint(TITLES_ENDPOINT))\n      .pipe(\n        map(titleList => titleList.titles),\n        this.converter.pipeableMany(TITLE_NORMALIZER)\n      );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { UserPaymentAdapter } from '../../../user/connectors/payment/user-payment.adapter';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { Occ } from '../../occ-models/occ.models';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { PAYMENT_DETAILS_NORMALIZER } from '../../../checkout/connectors/payment/converters';\n\nconst USER_ENDPOINT = 'users/';\nconst PAYMENT_DETAILS_ENDPOINT = '/paymentdetails';\n\n@Injectable()\nexport class OccUserPaymentAdapter implements UserPaymentAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  private getPaymentDetailsEndpoint(userId: string): string {\n    const endpoint = `${USER_ENDPOINT}${userId}${PAYMENT_DETAILS_ENDPOINT}`;\n    return this.occEndpoints.getEndpoint(endpoint);\n  }\n\n  loadAll(userId: string): Observable<PaymentDetails[]> {\n    const url = this.getPaymentDetailsEndpoint(userId) + '?saved=true';\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http.get<Occ.PaymentDetailsList>(url, { headers }).pipe(\n      catchError((error: any) => throwError(error)),\n      map(methodList => methodList.payments),\n      this.converter.pipeableMany(PAYMENT_DETAILS_NORMALIZER)\n    );\n  }\n\n  delete(userId: string, paymentMethodID: string): Observable<{}> {\n    const url = this.getPaymentDetailsEndpoint(userId) + `/${paymentMethodID}`;\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .delete(url, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  setDefault(userId: string, paymentMethodID: string): Observable<{}> {\n    const url = this.getPaymentDetailsEndpoint(userId) + `/${paymentMethodID}`;\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .patch(\n        url,\n        // TODO: Remove billingAddress property\n        { billingAddress: { titleCode: 'mr' }, defaultPayment: true },\n        { headers }\n      )\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport { UserConsentAdapter } from '../../../user/connectors/consent/user-consent.adapter';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { Occ } from '../../occ-models/occ.models';\nimport { CONSENT_TEMPLATE_NORMALIZER } from '../../../user/connectors/consent/converters';\n\nconst USER_ENDPOINT = 'users/';\nconst CONSENTS_TEMPLATES_ENDPOINT = '/consenttemplates';\nconst CONSENTS_ENDPOINT = '/consents';\n\n@Injectable()\nexport class OccUserConsentAdapter implements UserConsentAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  private getUserEndpoint(userId?: string): string {\n    const endpoint = userId ? `${USER_ENDPOINT}${userId}` : USER_ENDPOINT;\n    return this.occEndpoints.getEndpoint(endpoint);\n  }\n\n  loadConsents(userId: string): Observable<ConsentTemplate[]> {\n    const url = this.getUserEndpoint(userId) + CONSENTS_TEMPLATES_ENDPOINT;\n    const headers = new HttpHeaders({ 'Cache-Control': 'no-cache' });\n    return this.http.get<Occ.ConsentTemplateList>(url, { headers }).pipe(\n      catchError((error: any) => throwError(error)),\n      map(consentList => consentList.consentTemplates),\n      this.converter.pipeableMany(CONSENT_TEMPLATE_NORMALIZER)\n    );\n  }\n\n  giveConsent(\n    userId: string,\n    consentTemplateId: string,\n    consentTemplateVersion: number\n  ): Observable<ConsentTemplate> {\n    const url = this.getUserEndpoint() + userId + CONSENTS_ENDPOINT;\n    const httpParams = new HttpParams()\n      .set('consentTemplateId', consentTemplateId)\n      .set('consentTemplateVersion', consentTemplateVersion.toString());\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n      'Cache-Control': 'no-cache',\n    });\n    return this.http\n      .post<Occ.ConsentTemplate>(url, httpParams, { headers })\n      .pipe(\n        catchError(error => throwError(error)),\n        this.converter.pipeable(CONSENT_TEMPLATE_NORMALIZER)\n      );\n  }\n\n  withdrawConsent(userId: string, consentCode: string): Observable<{}> {\n    const headers = new HttpHeaders({\n      'Cache-Control': 'no-cache',\n    });\n    const url =\n      this.getUserEndpoint() + userId + CONSENTS_ENDPOINT + '/' + consentCode;\n    return this.http.delete(url, { headers });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\n\nimport { UserOrderAdapter } from '../../../user/connectors/order/user-order.adapter';\nimport { OccUserOrderAdapter } from './occ-user-order.adapter';\nimport { UserAddressAdapter } from '../../../user/connectors/address/user-address.adapter';\nimport { OccUserAddressAdapter } from './occ-user-address.adapter';\nimport { UserAdapter } from '../../../user/connectors/user/user.adapter';\nimport { OccUserAdapter } from './occ-user.adapter';\nimport { UserPaymentAdapter } from '../../../user/connectors/payment/user-payment.adapter';\nimport { OccUserPaymentAdapter } from './occ-user-payment.adapter';\nimport { OccUserConsentAdapter } from './occ-user-consent.adapter';\nimport { UserConsentAdapter } from '../../../user/connectors/consent/user-consent.adapter';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    { provide: UserAdapter, useClass: OccUserAdapter },\n    { provide: UserAddressAdapter, useClass: OccUserAddressAdapter },\n    { provide: UserConsentAdapter, useClass: OccUserConsentAdapter },\n    {\n      provide: UserPaymentAdapter,\n      useClass: OccUserPaymentAdapter,\n    },\n    { provide: UserOrderAdapter, useClass: OccUserOrderAdapter },\n  ],\n})\nexport class UserOccModule {}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CheckoutAdapter } from '../../../checkout/connectors/checkout/checkout.adapter';\nimport { ORDER_NORMALIZER } from '../../../checkout/connectors/checkout/converters';\nimport { CheckoutDetails } from '../../../checkout/models/checkout.model';\nimport { Order } from '../../../model/order.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n// To be changed to a more optimised params after ticket: C3PO-1076\nconst FULL_PARAMS = 'fields=FULL';\nconst CHECKOUT_PARAMS = 'deliveryAddress(FULL),deliveryMode,paymentInfo(FULL)';\nconst ORDERS_ENDPOINT = '/orders';\nconst CARTS_ENDPOINT = '/carts/';\n\n@Injectable()\nexport class OccCheckoutAdapter implements CheckoutAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getEndpoint(userId: string, subEndpoint: string): string {\n    const orderEndpoint = 'users/' + userId + subEndpoint;\n    return this.occEndpoints.getEndpoint(orderEndpoint);\n  }\n\n  public placeOrder(userId: string, cartId: string): Observable<Order> {\n    const url = this.getEndpoint(userId, ORDERS_ENDPOINT);\n    const params = new HttpParams({\n      fromString: 'cartId=' + cartId + '&' + FULL_PARAMS,\n    });\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .post<Occ.Order>(url, {}, { headers, params })\n      .pipe(this.converter.pipeable(ORDER_NORMALIZER));\n  }\n\n  loadCheckoutDetails(\n    userId: string,\n    cartId: string\n  ): Observable<CheckoutDetails> {\n    const url = this.getEndpoint(userId, CARTS_ENDPOINT) + cartId;\n    const params = new HttpParams({\n      fromString: `fields=${CHECKOUT_PARAMS}`,\n    });\n    return this.http.get<CheckoutDetails>(url, { params });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Occ } from '../../../occ-models/occ.models';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Order, OrderEntry } from '../../../../model/order.model';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\n\n@Injectable()\nexport class OccOrderNormalizer implements Converter<Occ.Order, Order> {\n  constructor(private converter: ConverterService) {}\n\n  convert(source: Occ.Order, target?: Order): Order {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source.entries) {\n      target.entries = source.entries.map(entry =>\n        this.convertOrderEntry(entry)\n      );\n    }\n\n    if (source.consignments) {\n      target.consignments = source.consignments.map(consignment => ({\n        ...consignment,\n        entries: consignment.entries.map(entry => ({\n          ...entry,\n          orderEntry: this.convertOrderEntry(entry.orderEntry),\n        })),\n      }));\n    }\n\n    if (source.unconsignedEntries) {\n      target.unconsignedEntries = source.unconsignedEntries.map(entry =>\n        this.convertOrderEntry(entry)\n      );\n    }\n\n    return target;\n  }\n\n  private convertOrderEntry(source: Occ.OrderEntry): OrderEntry {\n    return {\n      ...source,\n      product: this.converter.convert(source.product, PRODUCT_NORMALIZER),\n    };\n  }\n}\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport { CheckoutDeliveryAdapter } from '../../../checkout/connectors/delivery/checkout-delivery.adapter';\nimport { DELIVERY_MODE_NORMALIZER } from '../../../checkout/connectors/delivery/converters';\nimport { Address } from '../../../model/address.model';\nimport { DeliveryMode } from '../../../model/order.model';\nimport {\n  ADDRESS_NORMALIZER,\n  ADDRESS_SERIALIZER,\n} from '../../../user/connectors/address/converters';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCheckoutDeliveryAdapter implements CheckoutDeliveryAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = 'users/' + userId + '/carts/';\n    return this.occEndpoints.getEndpoint(cartEndpoint);\n  }\n\n  public createAddress(\n    userId: string,\n    cartId: string,\n    address: Address\n  ): Observable<Address> {\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .post<Occ.Address>(\n        this.getCartEndpoint(userId) + cartId + '/addresses/delivery',\n        address,\n        {\n          headers: new HttpHeaders().set('Content-Type', 'application/json'),\n        }\n      )\n      .pipe(this.converter.pipeable(ADDRESS_NORMALIZER));\n  }\n\n  public setAddress(\n    userId: string,\n    cartId: string,\n    addressId: string\n  ): Observable<any> {\n    return this.http.put(\n      this.getCartEndpoint(userId) + cartId + '/addresses/delivery',\n      {},\n      {\n        params: { addressId: addressId },\n      }\n    );\n  }\n\n  public setMode(\n    userId: string,\n    cartId: string,\n    deliveryModeId: string\n  ): Observable<any> {\n    return this.http.put(\n      this.getCartEndpoint(userId) + cartId + '/deliverymode',\n      {},\n      {\n        params: { deliveryModeId: deliveryModeId },\n      }\n    );\n  }\n\n  public getMode(userId: string, cartId: string): Observable<any> {\n    return this.http\n      .get(this.getCartEndpoint(userId) + cartId + '/deliverymode')\n      .pipe(this.converter.pipeable(DELIVERY_MODE_NORMALIZER));\n  }\n\n  public getSupportedModes(\n    userId: string,\n    cartId: string\n  ): Observable<DeliveryMode[]> {\n    return this.http\n      .get<Occ.DeliveryModeList>(\n        this.getCartEndpoint(userId) + cartId + '/deliverymodes'\n      )\n      .pipe(\n        pluck('deliveryModes'),\n        this.converter.pipeableMany(DELIVERY_MODE_NORMALIZER)\n      );\n  }\n}\n","/**\n * Angular uses the native encodeURIComponent function,\n * but then un-encoded some characters that are allowed\n * to be part of the query according to IETF RFC 3986.\n * So, to make these characters still encoded, this encoder only\n * uses the encodeURIComponent.\n */\nimport { HttpParameterCodec } from '@angular/common/http';\n\nexport class CustomEncoder implements HttpParameterCodec {\n  encodeKey(key: string): string {\n    return encodeURIComponent(key);\n  }\n\n  encodeValue(value: string): string {\n    return encodeURIComponent(value);\n  }\n\n  decodeKey(key: string): string {\n    return decodeURIComponent(key);\n  }\n\n  decodeValue(value: string): string {\n    return decodeURIComponent(value);\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map, mergeMap } from 'rxjs/operators';\nimport { CheckoutPaymentAdapter } from '../../../checkout/connectors/payment/checkout-payment.adapter';\nimport {\n  CARD_TYPE_NORMALIZER,\n  PAYMENT_DETAILS_NORMALIZER,\n  PAYMENT_DETAILS_SERIALIZER,\n} from '../../../checkout/connectors/payment/converters';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { CustomEncoder } from '../cart/custom.encoder';\n\nconst ENDPOINT_CARD_TYPES = 'cardtypes';\n\n@Injectable()\nexport class OccCheckoutPaymentAdapter implements CheckoutPaymentAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {\n    if (typeof DOMParser !== 'undefined') {\n      this.domparser = new DOMParser();\n    }\n  }\n\n  private domparser: DOMParser;\n\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = 'users/' + userId + '/carts/';\n    return this.occEndpoints.getEndpoint(cartEndpoint);\n  }\n\n  public create(\n    userId: string,\n    cartId: string,\n    paymentDetails: PaymentDetails\n  ): Observable<PaymentDetails> {\n    paymentDetails = this.converter.convert(\n      paymentDetails,\n      PAYMENT_DETAILS_SERIALIZER\n    );\n    return this.getProviderSubInfo(userId, cartId).pipe(\n      map(data => {\n        const labelsMap = this.convertToMap(data.mappingLabels.entry);\n        return {\n          url: data.postUrl,\n          parameters: this.getParamsForPaymentProvider(\n            paymentDetails,\n            data.parameters.entry,\n            labelsMap\n          ),\n          mappingLabels: labelsMap,\n        };\n      }),\n      mergeMap(sub => {\n        // create a subscription directly with payment provider\n        return this.createSubWithProvider(sub.url, sub.parameters).pipe(\n          map(response => this.extractPaymentDetailsFromHtml(response)),\n          mergeMap(fromPaymentProvider => {\n            fromPaymentProvider['defaultPayment'] =\n              paymentDetails.defaultPayment;\n            fromPaymentProvider['savePaymentInfo'] = true;\n            return this.createDetailsWithParameters(\n              userId,\n              cartId,\n              fromPaymentProvider\n            ).pipe(this.converter.pipeable(PAYMENT_DETAILS_NORMALIZER));\n          })\n        );\n      })\n    );\n  }\n\n  public set(\n    userId: string,\n    cartId: string,\n    paymentDetailsId: string\n  ): Observable<any> {\n    return this.http.put(\n      this.getCartEndpoint(userId) + cartId + '/paymentdetails',\n      {},\n      {\n        params: { paymentDetailsId: paymentDetailsId },\n      }\n    );\n  }\n\n  loadCardTypes(): Observable<CardType[]> {\n    return this.http\n      .get<Occ.CardTypeList>(this.occEndpoints.getEndpoint(ENDPOINT_CARD_TYPES))\n      .pipe(\n        map(cardTypeList => cardTypeList.cardTypes),\n        this.converter.pipeableMany(CARD_TYPE_NORMALIZER)\n      );\n  }\n\n  protected getProviderSubInfo(\n    userId: string,\n    cartId: string\n  ): Observable<any> {\n    return this.http.get(\n      this.getCartEndpoint(userId) +\n        cartId +\n        '/payment/sop/request?responseUrl=sampleUrl'\n    );\n  }\n\n  protected createSubWithProvider(\n    postUrl: string,\n    parameters: any\n  ): Observable<any> {\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n      Accept: 'text/html',\n    });\n    let httpParams = new HttpParams({ encoder: new CustomEncoder() });\n    Object.keys(parameters).forEach(key => {\n      httpParams = httpParams.append(key, parameters[key]);\n    });\n\n    return this.http.post(postUrl, httpParams, {\n      headers,\n      responseType: 'text',\n    });\n  }\n\n  protected createDetailsWithParameters(\n    userId: string,\n    cartId: string,\n    parameters: any\n  ): Observable<PaymentDetails> {\n    let httpParams = new HttpParams({ encoder: new CustomEncoder() });\n    Object.keys(parameters).forEach(key => {\n      httpParams = httpParams.append(key, parameters[key]);\n    });\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http.post<PaymentDetails>(\n      this.getCartEndpoint(userId) + cartId + '/payment/sop/response',\n      httpParams,\n      { headers }\n    );\n  }\n\n  private getParamsForPaymentProvider(\n    paymentDetails: PaymentDetails,\n    parameters: { key; value }[],\n    mappingLabels: any\n  ) {\n    const params = this.convertToMap(parameters);\n    params[mappingLabels['hybris_account_holder_name']] =\n      paymentDetails.accountHolderName;\n    params[mappingLabels['hybris_card_type']] = paymentDetails.cardType.code;\n    params[mappingLabels['hybris_card_number']] = paymentDetails.cardNumber;\n    if (mappingLabels['hybris_combined_expiry_date'] === 'true') {\n      params[mappingLabels['hybris_card_expiry_date']] =\n        paymentDetails.expiryMonth +\n        mappingLabels['hybris_separator_expiry_date'] +\n        paymentDetails.expiryYear;\n    } else {\n      params[mappingLabels['hybris_card_expiration_month']] =\n        paymentDetails.expiryMonth;\n      params[mappingLabels['hybris_card_expiration_year']] =\n        paymentDetails.expiryYear;\n    }\n    params[mappingLabels['hybris_card_cvn']] = paymentDetails.cvn;\n\n    // billing address\n    params[mappingLabels['hybris_billTo_country']] =\n      paymentDetails.billingAddress.country.isocode;\n    params[mappingLabels['hybris_billTo_firstname']] =\n      paymentDetails.billingAddress.firstName;\n    params[mappingLabels['hybris_billTo_lastname']] =\n      paymentDetails.billingAddress.lastName;\n    params[mappingLabels['hybris_billTo_street1']] =\n      paymentDetails.billingAddress.line1 +\n      ' ' +\n      paymentDetails.billingAddress.line2;\n    params[mappingLabels['hybris_billTo_city']] =\n      paymentDetails.billingAddress.town;\n    params[mappingLabels['hybris_billTo_region']] =\n      paymentDetails.billingAddress.region.isocodeShort;\n    params[mappingLabels['hybris_billTo_postalcode']] =\n      paymentDetails.billingAddress.postalCode;\n    return params;\n  }\n\n  private extractPaymentDetailsFromHtml(html: string): any {\n    const domdoc = this.domparser.parseFromString(html, 'text/xml');\n    const responseForm = domdoc.getElementsByTagName('form')[0];\n    const inputs = responseForm.getElementsByTagName('input');\n\n    const values = {};\n    for (let i = 0; inputs[i]; i++) {\n      const input = inputs[i];\n      if (\n        input.getAttribute('name') !== '{}' &&\n        input.getAttribute('value') !== ''\n      ) {\n        values[input.getAttribute('name')] = input.getAttribute('value');\n      }\n    }\n\n    return values;\n  }\n\n  private convertToMap(paramList: { key; value }[]) {\n    return paramList.reduce(function(result, item) {\n      const key = item.key;\n      result[key] = item.value;\n      return result;\n    }, {});\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { CheckoutAdapter } from '../../../checkout/connectors/checkout/checkout.adapter';\nimport { OccCheckoutAdapter } from './occ-checkout.adapter';\nimport { OccOrderNormalizer } from './converters/occ-order-normalizer';\nimport { ORDER_NORMALIZER } from '../../../checkout/connectors/checkout/converters';\nimport { CheckoutDeliveryAdapter } from '../../../checkout/connectors/delivery/checkout-delivery.adapter';\nimport { OccCheckoutDeliveryAdapter } from './occ-checkout-delivery.adapter';\nimport { CheckoutPaymentAdapter } from '../../../checkout/connectors/payment/checkout-payment.adapter';\nimport { OccCheckoutPaymentAdapter } from './occ-checkout-payment.adapter';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    {\n      provide: CheckoutAdapter,\n      useClass: OccCheckoutAdapter,\n    },\n    { provide: ORDER_NORMALIZER, useClass: OccOrderNormalizer, multi: true },\n    {\n      provide: CheckoutDeliveryAdapter,\n      useClass: OccCheckoutDeliveryAdapter,\n    },\n    {\n      provide: CheckoutPaymentAdapter,\n      useClass: OccCheckoutPaymentAdapter,\n    },\n  ],\n})\nexport class CheckoutOccModule {}\n","import { NgModule } from '@angular/core';\n\nimport { OccConfig } from './config/occ-config';\nimport { Config, ConfigModule } from '../config/config.module';\nimport { defaultOccConfig } from './config/default-occ-config';\nimport { provideConfigValidator } from '../config';\nimport { occConfigValidator } from './config/occ-config-validator';\nimport { CmsOccModule } from './adapters/cms/cms-occ.module';\nimport { CartOccModule } from './adapters/cart/cart-occ.module';\nimport { ProductOccModule } from './adapters/product/product-occ.module';\nimport { SiteContextOccModule } from './adapters/site-context/site-context-occ.module';\nimport { StoreFinderOccModule } from './adapters/store-finder/store-finder-occ.module';\nimport { UserOccModule } from './adapters/user/user-occ.module';\nimport { CheckoutOccModule } from './adapters/checkout/checkout-occ.module';\n\n@NgModule({\n  imports: [\n    ConfigModule.withConfig(defaultOccConfig),\n    CmsOccModule,\n    CartOccModule,\n    CheckoutOccModule,\n    ProductOccModule,\n    SiteContextOccModule,\n    StoreFinderOccModule,\n    UserOccModule,\n  ],\n  providers: [\n    { provide: OccConfig, useExisting: Config },\n    provideConfigValidator(occConfigValidator),\n  ],\n})\nexport class OccModule {}\n","import { Injectable } from '@angular/core';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { Converter } from '../../../../util/converter.service';\nimport { Product, ProductReferences } from '../../../../model/product.model';\n\n@Injectable()\nexport class ProductReferenceNormalizer\n  implements Converter<Occ.Product, Product> {\n  convert(source: Occ.Product, target?: Product): Product {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source.productReferences) {\n      target.productReferences = this.normalize(source.productReferences);\n    }\n    return target;\n  }\n\n  /**\n   * @desc\n   * Creates the reference structure we'd like to have. Instead of\n   * having a single list with all references we create a proper structure.\n   * With that we have a semantic API for the clients\n   * - product.references.SIMILAR[0].code\n   */\n  protected normalize(source: Occ.ProductReference[]): ProductReferences {\n    const references = {};\n\n    if (source) {\n      for (const reference of source) {\n        if (!references.hasOwnProperty(reference.referenceType)) {\n          references[reference.referenceType] = [];\n        }\n        references[reference.referenceType].push(reference);\n      }\n    }\n    return references;\n  }\n}\n","export abstract class PersonalizationConfig {\n  personalization: {\n    enabled?: boolean;\n    httpHeaderName?: {\n      id: string;\n      timestamp: string;\n    };\n  };\n}\n","import { PersonalizationConfig } from './personalization-config';\n\nexport const defaultPersonalizationConfig: PersonalizationConfig = {\n  personalization: {\n    enabled: false,\n    httpHeaderName: {\n      id: 'Occ-Personalization-Id',\n      timestamp: 'Occ-Personalization-Time',\n    },\n  },\n};\n","import { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\n\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\nimport { PersonalizationConfig } from '../config/personalization-config';\nimport { WindowRef } from '../../window/window-ref';\nimport { isPlatformBrowser } from '@angular/common';\n\nconst PERSONALIZATION_ID_KEY = 'personalization-id';\n\n@Injectable()\nexport class OccPersonalizationIdInterceptor implements HttpInterceptor {\n  private personalizationId: string;\n  private requestHeader: string;\n  private enabled = false;\n\n  constructor(\n    private config: PersonalizationConfig,\n    private occEndpoints: OccEndpointsService,\n    private winRef: WindowRef,\n    @Inject(PLATFORM_ID) private platform: any\n  ) {\n    if (isPlatformBrowser(this.platform)) {\n      this.enabled =\n        (this.winRef.localStorage && this.config.personalization.enabled) ||\n        false;\n\n      if (this.enabled) {\n        this.requestHeader = this.config.personalization.httpHeaderName.id.toLowerCase();\n        this.personalizationId = this.winRef.localStorage.getItem(\n          PERSONALIZATION_ID_KEY\n        );\n      } else if (this.winRef.localStorage.getItem(PERSONALIZATION_ID_KEY)) {\n        this.winRef.localStorage.removeItem(PERSONALIZATION_ID_KEY);\n      }\n    }\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (!this.enabled) {\n      return next.handle(request);\n    }\n\n    if (\n      this.personalizationId &&\n      request.url.includes(this.occEndpoints.getBaseEndpoint())\n    ) {\n      request = request.clone({\n        setHeaders: {\n          [this.requestHeader]: this.personalizationId,\n        },\n      });\n    }\n\n    return next.handle(request).pipe(\n      tap(event => {\n        if (event instanceof HttpResponse) {\n          if (event.headers.keys().includes(this.requestHeader)) {\n            const receivedId = event.headers.get(this.requestHeader);\n            if (this.personalizationId !== receivedId) {\n              this.personalizationId = receivedId;\n              this.winRef.localStorage.setItem(\n                PERSONALIZATION_ID_KEY,\n                this.personalizationId\n              );\n            }\n          }\n        }\n      })\n    );\n  }\n}\n","import { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\n\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\nimport { PersonalizationConfig } from '../config/personalization-config';\nimport { WindowRef } from '../../window/window-ref';\nimport { isPlatformBrowser } from '@angular/common';\n\nconst PERSONALIZATION_TIME_KEY = 'personalization-time';\n\n@Injectable()\nexport class OccPersonalizationTimeInterceptor implements HttpInterceptor {\n  private timestamp: string;\n  private requestHeader: string;\n  private enabled = false;\n\n  constructor(\n    private config: PersonalizationConfig,\n    private occEndpoints: OccEndpointsService,\n    private winRef: WindowRef,\n    @Inject(PLATFORM_ID) private platform: any\n  ) {\n    if (isPlatformBrowser(this.platform)) {\n      this.enabled =\n        (this.winRef.localStorage && this.config.personalization.enabled) ||\n        false;\n\n      if (this.enabled) {\n        this.requestHeader = this.config.personalization.httpHeaderName.timestamp.toLowerCase();\n        this.timestamp = this.winRef.localStorage.getItem(\n          PERSONALIZATION_TIME_KEY\n        );\n      } else if (this.winRef.localStorage.getItem(PERSONALIZATION_TIME_KEY)) {\n        this.winRef.localStorage.removeItem(PERSONALIZATION_TIME_KEY);\n      }\n    }\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (!this.enabled) {\n      return next.handle(request);\n    }\n\n    if (\n      this.timestamp &&\n      request.url.includes(this.occEndpoints.getBaseEndpoint())\n    ) {\n      request = request.clone({\n        setHeaders: {\n          [this.requestHeader]: this.timestamp,\n        },\n      });\n    }\n\n    return next.handle(request).pipe(\n      tap(event => {\n        if (event instanceof HttpResponse) {\n          if (event.headers.keys().includes(this.requestHeader)) {\n            const receivedTimestamp = event.headers.get(this.requestHeader);\n            if (this.timestamp !== receivedTimestamp) {\n              this.timestamp = receivedTimestamp;\n              this.winRef.localStorage.setItem(\n                PERSONALIZATION_TIME_KEY,\n                this.timestamp\n              );\n            }\n          }\n        }\n      })\n    );\n  }\n}\n","import { Provider } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\n\nimport { OccPersonalizationIdInterceptor } from './occ-personalization-id.interceptor';\nimport { OccPersonalizationTimeInterceptor } from './occ-personalization-time.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useClass: OccPersonalizationIdInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useClass: OccPersonalizationTimeInterceptor,\n    multi: true,\n  },\n];\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { Config, ConfigModule } from '../config/config.module';\nimport { PersonalizationConfig } from './config/personalization-config';\nimport { defaultPersonalizationConfig } from './config/default-personalization-config';\n\nimport { interceptors } from './http-interceptors/index';\n\n@NgModule({\n  imports: [ConfigModule.withConfig(defaultPersonalizationConfig)],\n  providers: [{ provide: PersonalizationConfig, useExisting: Config }],\n})\nexport class PersonalizationModule {\n  static forRoot(): ModuleWithProviders<PersonalizationModule> {\n    return {\n      ngModule: PersonalizationModule,\n      providers: [...interceptors],\n    };\n  }\n}\n","import { Injectable, NgZone } from '@angular/core';\nimport { combineLatest } from 'rxjs';\nimport { takeWhile, take, filter } from 'rxjs/operators';\n\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { BaseSiteService } from '../../site-context/facade/base-site.service';\nimport { Page } from '../../cms/model/page.model';\nimport { WindowRef } from '../../window/window-ref';\nimport { PageType } from '../../model/cms.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SmartEditService {\n  private _cmsTicketId: string;\n  private isPreviewPage = false;\n  private _currentPageId: string;\n\n  private defaultPreviewProductCode: string;\n  private defaultPreviewCategoryCode: string;\n\n  constructor(\n    protected cmsService: CmsService,\n    protected routingService: RoutingService,\n    protected baseSiteService: BaseSiteService,\n    protected zone: NgZone,\n    protected winRef: WindowRef\n  ) {\n    this.getCmsTicket();\n    this.addPageContract();\n\n    if (winRef.nativeWindow) {\n      const window = winRef.nativeWindow as any;\n      // rerender components and slots after editing\n      window.smartedit = window.smartedit || {};\n      window.smartedit.renderComponent = (\n        componentId,\n        componentType,\n        parentId\n      ) => {\n        return this.renderComponent(componentId, componentType, parentId);\n      };\n\n      // reprocess page\n      window.smartedit.reprocessPage = this.reprocessPage;\n    }\n  }\n\n  get cmsTicketId(): string {\n    return this._cmsTicketId;\n  }\n\n  protected getCmsTicket() {\n    combineLatest([\n      this.cmsService.getCurrentPage(),\n      this.routingService.getRouterState(),\n    ])\n      .pipe(takeWhile(([cmsPage]) => cmsPage === undefined))\n      .subscribe(([, routerState]) => {\n        if (routerState.nextState && !this._cmsTicketId) {\n          this._cmsTicketId = routerState.nextState.queryParams['cmsTicketId'];\n          if (this._cmsTicketId) {\n            this.cmsService.launchInSmartEdit = true;\n            this.getDefaultPreviewCode();\n          }\n        }\n      });\n  }\n\n  protected getDefaultPreviewCode() {\n    this.baseSiteService\n      .getBaseSiteData()\n      .pipe(\n        filter(site => Object.keys(site).length !== 0),\n        take(1)\n      )\n      .subscribe(site => {\n        this.defaultPreviewCategoryCode = site.defaultPreviewCategoryCode;\n        this.defaultPreviewProductCode = site.defaultPreviewProductCode;\n      });\n  }\n\n  protected addPageContract() {\n    this.cmsService.getCurrentPage().subscribe(cmsPage => {\n      if (cmsPage && this._cmsTicketId) {\n        this._currentPageId = cmsPage.pageId;\n\n        // before adding contract to page, we need redirect to that page\n        this.goToPreviewPage(cmsPage);\n\n        // remove old page contract\n        const previousContract = [];\n        Array.from(this.winRef.document.body.classList).forEach(attr =>\n          previousContract.push(attr)\n        );\n        previousContract.forEach(attr =>\n          this.winRef.document.body.classList.remove(attr)\n        );\n\n        // add new page contract\n        if (cmsPage.properties && cmsPage.properties.smartedit) {\n          const seClasses = cmsPage.properties.smartedit.classes.split(' ');\n          seClasses.forEach(classItem => {\n            this.winRef.document.body.classList.add(classItem);\n          });\n        }\n      }\n    });\n  }\n\n  protected goToPreviewPage(cmsPage: Page) {\n    // only the first page is the smartedit preview page\n    if (!this.isPreviewPage) {\n      this.isPreviewPage = true;\n      if (\n        cmsPage.type === PageType.PRODUCT_PAGE &&\n        this.defaultPreviewProductCode\n      ) {\n        this.routingService.go({\n          cxRoute: 'product',\n          params: { code: this.defaultPreviewProductCode },\n        });\n      } else if (\n        cmsPage.type === PageType.CATEGORY_PAGE &&\n        this.defaultPreviewCategoryCode\n      ) {\n        this.routingService.go({\n          cxRoute: 'category',\n          params: { code: this.defaultPreviewCategoryCode },\n        });\n      }\n    }\n  }\n\n  protected renderComponent(\n    componentId: string,\n    componentType?: string,\n    parentId?: string\n  ): boolean {\n    if (componentId) {\n      this.zone.run(() => {\n        // without parentId, it is slot\n        if (!parentId) {\n          if (this._currentPageId) {\n            this.cmsService.refreshPageById(this._currentPageId);\n          } else {\n            this.cmsService.refreshLatestPage();\n          }\n        } else if (componentType) {\n          this.cmsService.refreshComponent(componentId);\n        }\n      });\n    }\n\n    return true;\n  }\n\n  protected reprocessPage() {\n    // TODO: reprocess page API\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  HttpRequest,\n  HttpHandler,\n  HttpEvent,\n  HttpInterceptor,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\nimport { SmartEditService } from '../services/smart-edit.service';\n\n@Injectable()\nexport class CmsTicketInterceptor implements HttpInterceptor {\n  constructor(private service: SmartEditService) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (request.url.includes('/cms/') && this.service.cmsTicketId) {\n      request = request.clone({\n        setParams: {\n          cmsTicketId: this.service.cmsTicketId,\n        },\n      });\n    }\n\n    return next.handle(request);\n  }\n}\n","import { Provider } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\n\nimport { CmsTicketInterceptor } from './cms-ticket.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useClass: CmsTicketInterceptor,\n    multi: true,\n  },\n];\n","import { NgModule, ModuleWithProviders } from '@angular/core';\n\nimport { interceptors } from './http-interceptors/index';\n\n@NgModule({})\nexport class SmartEditModule {\n  static forRoot(): ModuleWithProviders<SmartEditModule> {\n    return {\n      ngModule: SmartEditModule,\n      providers: [...interceptors],\n    };\n  }\n}\n","export abstract class StoreFinderConfig {\n  googleMaps?: {\n    apiUrl: string;\n    apiKey: string;\n    scale: number;\n    selectedMarkerScale: number;\n  };\n}\n","import { LoaderState } from '../../state';\nimport { StoreEntities } from '../model';\n\nexport const STORE_FINDER_FEATURE = 'stores';\nexport const STORE_FINDER_DATA = '[StoreFinder] Store Finder Data';\n\nexport interface StateWithStoreFinder {\n  [STORE_FINDER_FEATURE]: StoresState;\n}\n\nexport interface StoresState {\n  findStores: LoaderState<FindStoresState>;\n  viewAllStores: LoaderState<ViewAllStoresState>;\n}\n\nexport interface FindStoresState {\n  findStoresEntities: StoreEntities;\n}\n\nexport interface ViewAllStoresState {\n  viewAllStoresEntities: StoreEntities;\n}\n","import { StoreFinderSearchConfig } from '../../model/search-config';\nimport {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { STORE_FINDER_DATA } from '../store-finder-state';\nimport { GeoPoint } from '../../../model/misc.model';\n\nexport const ON_HOLD = '[StoreFinder] On Hold';\nexport const FIND_STORES = '[StoreFinder] Find Stores';\nexport const FIND_STORES_FAIL = '[StoreFinder] Find Stores Fail';\nexport const FIND_STORES_SUCCESS = '[StoreFinder] Find Stores Success';\n\nexport const FIND_STORE_BY_ID = '[StoreFinder] Find a Store by Id';\nexport const FIND_STORE_BY_ID_FAIL = '[StoreFinder] Find a Store by Id Fail';\nexport const FIND_STORE_BY_ID_SUCCESS =\n  '[StoreFinder] Find a Store by Id Success';\n\nexport class OnHold extends LoaderLoadAction {\n  readonly type = ON_HOLD;\n  constructor() {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport class FindStores extends LoaderLoadAction {\n  readonly type = FIND_STORES;\n  constructor(\n    public payload: {\n      queryText: string;\n      longitudeLatitude?: GeoPoint;\n      useMyLocation?: boolean;\n      searchConfig?: StoreFinderSearchConfig;\n      countryIsoCode?: string;\n    }\n  ) {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport class FindStoresFail extends LoaderFailAction {\n  readonly type = FIND_STORES_FAIL;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA, payload);\n  }\n}\n\nexport class FindStoresSuccess extends LoaderSuccessAction {\n  readonly type = FIND_STORES_SUCCESS;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport class FindStoreById extends LoaderLoadAction {\n  readonly type = FIND_STORE_BY_ID;\n  constructor(public payload: { storeId: string }) {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport class FindStoreByIdFail extends LoaderFailAction {\n  readonly type = FIND_STORE_BY_ID_FAIL;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA, payload);\n  }\n}\n\nexport class FindStoreByIdSuccess extends LoaderSuccessAction {\n  readonly type = FIND_STORE_BY_ID_SUCCESS;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport type FindStoresAction =\n  | OnHold\n  | FindStores\n  | FindStoresFail\n  | FindStoresSuccess\n  | FindStoreById\n  | FindStoreByIdFail\n  | FindStoreByIdSuccess;\n","import {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { STORE_FINDER_DATA } from '../store-finder-state';\n\nexport const VIEW_ALL_STORES = '[StoreFinder] View All Stores';\nexport const VIEW_ALL_STORES_FAIL = '[StoreFinder] View All Stores Fail';\nexport const VIEW_ALL_STORES_SUCCESS = '[StoreFinder] View All Stores Success';\n\nexport class ViewAllStores extends LoaderLoadAction {\n  readonly type = VIEW_ALL_STORES;\n  constructor() {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport class ViewAllStoresFail extends LoaderFailAction {\n  readonly type = VIEW_ALL_STORES_FAIL;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA, payload);\n  }\n}\n\nexport class ViewAllStoresSuccess extends LoaderSuccessAction {\n  readonly type = VIEW_ALL_STORES_SUCCESS;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport type ViewAllStoresAction =\n  | ViewAllStores\n  | ViewAllStoresFail\n  | ViewAllStoresSuccess;\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { StoreFinderConnector } from '../../connectors/store-finder.connector';\nimport * as fromAction from './../actions/find-stores.action';\n\n@Injectable()\nexport class FindStoresEffect {\n  constructor(\n    private actions$: Actions,\n    private storeFinderConnector: StoreFinderConnector\n  ) {}\n\n  @Effect()\n  findStores$: Observable<\n    fromAction.FindStoresSuccess | fromAction.FindStoresFail\n  > = this.actions$.pipe(\n    ofType(fromAction.FIND_STORES),\n    map((action: fromAction.FindStores) => action.payload),\n    mergeMap(payload =>\n      this.storeFinderConnector\n        .search(\n          payload.queryText,\n          payload.searchConfig,\n          payload.longitudeLatitude\n        )\n        .pipe(\n          map(data => {\n            if (payload.countryIsoCode) {\n              data.stores = data.stores.filter(\n                store =>\n                  store.address.country.isocode === payload.countryIsoCode\n              );\n            }\n\n            return new fromAction.FindStoresSuccess(data);\n          }),\n          catchError(error =>\n            of(new fromAction.FindStoresFail(makeErrorSerializable(error)))\n          )\n        )\n    )\n  );\n\n  @Effect()\n  findStoreById$: Observable<\n    fromAction.FindStoreByIdSuccess | fromAction.FindStoreByIdFail\n  > = this.actions$.pipe(\n    ofType(fromAction.FIND_STORE_BY_ID),\n    map((action: fromAction.FindStoreById) => action.payload),\n    switchMap(payload =>\n      this.storeFinderConnector.get(payload.storeId).pipe(\n        map(data => new fromAction.FindStoreByIdSuccess(data)),\n        catchError(error =>\n          of(new fromAction.FindStoreByIdFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { StoreFinderConnector } from '../../connectors/store-finder.connector';\nimport * as fromAction from './../actions/view-all-stores.action';\n\n@Injectable()\nexport class ViewAllStoresEffect {\n  constructor(\n    private actions$: Actions,\n    private storeFinderConnector: StoreFinderConnector\n  ) {}\n\n  @Effect()\n  viewAllStores$: Observable<\n    fromAction.ViewAllStoresSuccess | fromAction.ViewAllStoresFail\n  > = this.actions$.pipe(\n    ofType(fromAction.VIEW_ALL_STORES),\n    switchMap(() => {\n      return this.storeFinderConnector.getCounts().pipe(\n        map(data => new fromAction.ViewAllStoresSuccess(data)),\n        catchError(error =>\n          of(new fromAction.ViewAllStoresFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n}\n","import { FindStoresEffect } from './find-stores.effect';\nimport { ViewAllStoresEffect } from './view-all-stores.effect';\n\nexport const effects: any[] = [FindStoresEffect, ViewAllStoresEffect];\n\nexport * from './find-stores.effect';\nexport * from './view-all-stores.effect';\n","import { ActionReducerMap, MetaReducer } from '@ngrx/store';\n\nimport { InjectionToken, Provider } from '@angular/core';\nimport { StoresState, STORE_FINDER_DATA } from '../store-finder-state';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\n\nexport function getReducers(): ActionReducerMap<StoresState> {\n  return {\n    findStores: loaderReducer(STORE_FINDER_DATA),\n    viewAllStores: loaderReducer(STORE_FINDER_DATA),\n  };\n}\n\nexport const reducerToken: InjectionToken<\n  ActionReducerMap<StoresState>\n> = new InjectionToken<ActionReducerMap<StoresState>>('StoreFinderReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport const metaReducers: MetaReducer<any>[] = [];\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  StateWithStoreFinder,\n  StoresState,\n  STORE_FINDER_FEATURE,\n} from '../store-finder-state';\n\nexport const getStoreFinderState: MemoizedSelector<\n  StateWithStoreFinder,\n  StoresState\n> = createFeatureSelector<StoresState>(STORE_FINDER_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderLoadingSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport {\n  FindStoresState,\n  StateWithStoreFinder,\n  StoresState,\n} from '../store-finder-state';\nimport { getStoreFinderState } from './feature.selector';\n\nexport const getFindStoresState: MemoizedSelector<\n  StateWithStoreFinder,\n  LoaderState<FindStoresState>\n> = createSelector(\n  getStoreFinderState,\n  (storesState: StoresState) => storesState.findStores\n);\n\nexport const getFindStoresEntities: MemoizedSelector<\n  StateWithStoreFinder,\n  FindStoresState\n> = createSelector(\n  getFindStoresState,\n  state => loaderValueSelector(state)\n);\n\nexport const getStoresLoading: MemoizedSelector<\n  StateWithStoreFinder,\n  boolean\n> = createSelector(\n  getFindStoresState,\n  state => loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderLoadingSelector,\n  loaderValueSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport {\n  StateWithStoreFinder,\n  StoresState,\n  ViewAllStoresState,\n} from '../store-finder-state';\nimport { getStoreFinderState } from './feature.selector';\n\nexport const getViewAllStoresState: MemoizedSelector<\n  StateWithStoreFinder,\n  LoaderState<ViewAllStoresState>\n> = createSelector(\n  getStoreFinderState,\n  (storesState: StoresState) => storesState.viewAllStores\n);\n\nexport const getViewAllStoresEntities: MemoizedSelector<\n  StateWithStoreFinder,\n  ViewAllStoresState\n> = createSelector(\n  getViewAllStoresState,\n  state => loaderValueSelector(state)\n);\n\nexport const getViewAllStoresLoading: MemoizedSelector<\n  StateWithStoreFinder,\n  boolean\n> = createSelector(\n  getViewAllStoresState,\n  state => loaderLoadingSelector(state)\n);\n","import { Injectable } from '@angular/core';\nimport { Action, select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { GeoPoint } from '../../model/misc.model';\nimport { WindowRef } from '../../window/window-ref';\nimport * as fromStore from '../store/index';\nimport { StoreFinderSelectors } from '../store/selectors/index';\nimport {\n  FindStoresState,\n  StateWithStoreFinder,\n  ViewAllStoresState,\n} from '../store/store-finder-state';\nimport { StoreFinderSearchConfig } from './../model/search-config';\n\n@Injectable()\nexport class StoreFinderService {\n  private geolocationWatchId: number = null;\n\n  constructor(\n    protected store: Store<StateWithStoreFinder>,\n    protected winRef: WindowRef\n  ) {}\n\n  /**\n   * Returns boolean observable for store's loading state\n   */\n  getStoresLoading(): Observable<boolean> {\n    return this.store.pipe(select(StoreFinderSelectors.getStoresLoading));\n  }\n\n  /**\n   * Returns observable for store's entities\n   */\n  getFindStoresEntities(): Observable<FindStoresState> {\n    return this.store.pipe(select(StoreFinderSelectors.getFindStoresEntities));\n  }\n\n  /**\n   * Returns boolean observable for view all store's loading state\n   */\n  getViewAllStoresLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(StoreFinderSelectors.getViewAllStoresLoading)\n    );\n  }\n\n  /**\n   * Returns observable for view all store's entities\n   */\n  getViewAllStoresEntities(): Observable<ViewAllStoresState> {\n    return this.store.pipe(\n      select(StoreFinderSelectors.getViewAllStoresEntities)\n    );\n  }\n\n  /**\n   * Store finding action functionality\n   * @param queryText text query\n   * @param longitudeLatitude longitude and latitude coordinates\n   * @param searchConfig search configuration\n   * @param countryIsoCode country ISO code\n   */\n  findStoresAction(\n    queryText: string,\n    longitudeLatitude: GeoPoint,\n    searchConfig: StoreFinderSearchConfig,\n    countryIsoCode?: string\n  ) {\n    this.store.dispatch(\n      new fromStore.FindStores({\n        queryText: queryText,\n        longitudeLatitude: longitudeLatitude,\n        searchConfig: searchConfig,\n        countryIsoCode: countryIsoCode,\n      })\n    );\n  }\n\n  /**\n   * View all stores\n   */\n  viewAllStores() {\n    this.clearWatchGeolocation(new fromStore.ViewAllStores());\n  }\n\n  /**\n   * View all stores by id\n   * @param storeId store id\n   */\n  viewStoreById(storeId: string) {\n    this.clearWatchGeolocation(new fromStore.FindStoreById({ storeId }));\n  }\n\n  /**\n   * Find all stores\n   * @param queryText text query\n   * @param useMyLocation use current location\n   */\n  findStores(queryText: string, useMyLocation?: boolean) {\n    if (useMyLocation && this.winRef.nativeWindow) {\n      this.clearWatchGeolocation(new fromStore.OnHold());\n      this.geolocationWatchId = this.winRef.nativeWindow.navigator.geolocation.watchPosition(\n        (pos: Position) => {\n          const longitudeLatitude: GeoPoint = {\n            longitude: pos.coords.longitude,\n            latitude: pos.coords.latitude,\n          };\n          this.clearWatchGeolocation(\n            new fromStore.FindStores({ queryText, longitudeLatitude })\n          );\n        }\n      );\n    } else {\n      this.clearWatchGeolocation(new fromStore.FindStores({ queryText }));\n    }\n  }\n\n  private clearWatchGeolocation(callbackAction: Action) {\n    if (this.geolocationWatchId !== null) {\n      this.winRef.nativeWindow.navigator.geolocation.clearWatch(\n        this.geolocationWatchId\n      );\n      this.geolocationWatchId = null;\n    }\n    this.store.dispatch(callbackAction);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { PointOfService } from '../../model/point-of-service.model';\n\n@Injectable()\nexport class StoreDataService {\n  readonly DECIMAL_BASE: 10;\n  readonly weekDays = {\n    0: 'Sun',\n    1: 'Mon',\n    2: 'Tue',\n    3: 'Wed',\n    4: 'Thu',\n    5: 'Fri',\n    6: 'Sat',\n  };\n\n  /**\n   * Returns store latitude\n   * @param location store location\n   */\n  getStoreLatitude(location: PointOfService): number {\n    return location.geoPoint.latitude;\n  }\n\n  /**\n   * Returns store longitude\n   * @param location store location\n   */\n  getStoreLongitude(location: PointOfService): number {\n    return location.geoPoint.longitude;\n  }\n\n  /**\n   * Returns store closing time\n   * @param location store location\n   * @param date date to compare\n   */\n  getStoreClosingTime(location: PointOfService, date: Date): Date {\n    const requestedDaySchedule = this.getSchedule(location, date);\n    let result: Date = null;\n\n    if (requestedDaySchedule.closed === false) {\n      const closingHour = requestedDaySchedule.closingTime.formattedHour.split(\n        ':'\n      )[0];\n      const closingMinute = requestedDaySchedule.closingTime.minute;\n      result = new Date(date.valueOf());\n      result.setHours(closingHour);\n      result.setMinutes(closingMinute);\n    }\n\n    return result;\n  }\n\n  /**\n   * Returns store opening time\n   * @param location store location\n   * @param date date to compare\n   */\n  getStoreOpeningTime(location: PointOfService, date: Date): Date {\n    const requestedDaySchedule = this.getSchedule(location, date);\n    let result: Date = null;\n\n    if (requestedDaySchedule.closed === false) {\n      const openingHour = requestedDaySchedule.openingTime.formattedHour.split(\n        ':'\n      )[0];\n      const openingMinutes = requestedDaySchedule.openingTime.minute;\n      result = new Date(date.valueOf());\n      result.setHours(openingHour);\n      result.setMinutes(openingMinutes);\n    }\n\n    return result;\n  }\n\n  /**\n   * Returns information about store open status\n   * @param location store location\n   * @param date date to compare\n   */\n  isStoreOpen(location: PointOfService, date: Date): boolean {\n    const requestedDaySchedule = this.getSchedule(location, date);\n    let result = false;\n\n    if (requestedDaySchedule.closed === false) {\n      const openingDate = this.getStoreOpeningTime(location, date);\n      const closingDate = this.getStoreClosingTime(location, date);\n\n      result = date > openingDate && date < closingDate;\n    }\n\n    return result;\n  }\n\n  /**\n   * Extracts schedule from the given location for the given date\n   * @param location location\n   * @param date date\n   *\n   * @returns payload describing the store's schedule for the given day.\n   */\n  protected getSchedule(location: PointOfService, date: Date): any {\n    const weekday = this.weekDays[date.getDay()];\n    return location.openingHours.weekDayOpeningList.find(\n      weekDayOpeningListItem => weekDayOpeningListItem.weekDay === weekday\n    );\n  }\n}\n","import { Inject, Injectable } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\n\n@Injectable()\nexport class ExternalJsFileLoader {\n  constructor(@Inject(DOCUMENT) protected document: any) {}\n\n  /**\n   * Loads a javascript from an external URL\n   * @param src URL for the script to be loaded\n   * @param params additional parameters to be attached to the given URL\n   * @param callback a function to be invoked after the script has been loaded\n   */\n  public load(src: string, params?: Object, callback?: EventListener): void {\n    const script = this.document.createElement('script');\n    script.type = 'text/javascript';\n    if (params) {\n      script.src = src + this.parseParams(params);\n    } else {\n      script.src = src;\n    }\n\n    script.async = true;\n    script.defer = true;\n    if (callback) {\n      script.addEventListener('load', callback);\n    }\n\n    document.head.appendChild(script);\n  }\n\n  /**\n   * Parses the given object with parameters to a string \"param1=value1&param2=value2\"\n   * @param params object containing parameters\n   */\n  private parseParams(params: Object): string {\n    let result = '';\n    const keysArray = Object.keys(params);\n    if (keysArray.length > 0) {\n      result =\n        '?' +\n        keysArray\n          .map(key => encodeURI(key) + '=' + encodeURI(params[key]))\n          .join('&');\n    }\n    return result;\n  }\n}\n","/// <reference types=\"@types/googlemaps\" />\nimport { ExternalJsFileLoader } from './external-js-file-loader.service';\nimport { Injectable } from '@angular/core';\nimport { StoreDataService } from '../facade/store-data.service';\nimport { StoreFinderConfig } from '../config/store-finder-config';\n\n@Injectable()\nexport class GoogleMapRendererService {\n  private googleMap: google.maps.Map = null;\n  private markers: google.maps.Marker[];\n\n  constructor(\n    protected config: StoreFinderConfig,\n    protected externalJsFileLoader: ExternalJsFileLoader,\n    protected storeDataService: StoreDataService\n  ) {}\n\n  /**\n   * Renders google map on the given element and draws markers on it.\n   * If map already exists it will use an existing map otherwise it will create one\n   * @param mapElement HTML element inside of which the map will be displayed\n   * @param locations array containign geo data to be displayed on the map\n   * @param selectMarkerHandler function to handle whenever a marker on a map is clicked\n   */\n  renderMap(\n    mapElement: HTMLElement,\n    locations: any[],\n    selectMarkerHandler?: Function\n  ): void {\n    if (this.googleMap === null) {\n      this.externalJsFileLoader.load(\n        this.config.googleMaps.apiUrl,\n        { key: this.config.googleMaps.apiKey },\n        () => {\n          this.drawMap(mapElement, locations, selectMarkerHandler);\n        }\n      );\n    } else {\n      this.drawMap(mapElement, locations, selectMarkerHandler);\n    }\n  }\n\n  /**\n   * Centers the map to the given point\n   * @param latitute latitude of the new center\n   * @param longitude longitude of the new center\n   */\n  centerMap(latitute: number, longitude: number): void {\n    this.googleMap.panTo({ lat: latitute, lng: longitude });\n    this.googleMap.setZoom(this.config.googleMaps.selectedMarkerScale);\n  }\n\n  /**\n   * Defines and returns {@link google.maps.LatLng} representing a point where the map will be centered\n   * @param locations list of locations\n   */\n  private defineMapCenter(locations: any[]): google.maps.LatLng {\n    return new google.maps.LatLng(\n      this.storeDataService.getStoreLatitude(locations[0]),\n      this.storeDataService.getStoreLongitude(locations[0])\n    );\n  }\n\n  /**\n   * Creates google map inside if the given HTML element centered to the given point\n   * @param mapElement {@link HTMLElement} inside of which the map will be created\n   * @param mapCenter {@link google.maps.LatLng} the point where the map will be centered\n   */\n  private initMap(\n    mapElement: HTMLElement,\n    mapCenter: google.maps.LatLng\n  ): void {\n    const mapProp = {\n      center: mapCenter,\n      zoom: this.config.googleMaps.scale,\n      mapTypeId: google.maps.MapTypeId.ROADMAP,\n    };\n    this.googleMap = new google.maps.Map(mapElement, mapProp);\n  }\n\n  /**\n   * Erases the current map's markers and create a new one based on the given locations\n   * @param locations array of locations to be displayed on the map\n   * @param selectMarkerHandler function to handle whenever a marker on a map is clicked\n   */\n  private createMarkers(\n    locations: any[],\n    selectMarkerHandler?: Function\n  ): void {\n    this.markers = [];\n    locations.forEach((element, index) => {\n      const marker = new google.maps.Marker({\n        position: new google.maps.LatLng(\n          this.storeDataService.getStoreLatitude(element),\n          this.storeDataService.getStoreLongitude(element)\n        ),\n        label: index + 1 + '',\n      });\n      this.markers.push(marker);\n      marker.setMap(this.googleMap);\n      marker.addListener('mouseover', function() {\n        marker.setAnimation(google.maps.Animation.BOUNCE);\n      });\n      marker.addListener('mouseout', function() {\n        marker.setAnimation(null);\n      });\n      if (selectMarkerHandler) {\n        marker.addListener('click', function() {\n          selectMarkerHandler(index);\n        });\n      }\n    });\n  }\n\n  /**\n   * Initialize and draw the map\n   * @param mapElement {@link HTMLElement} inside of which the map will be drawn\n   * @param locations array of locations to be displayed on the map\n   * @param selectMarkerHandler function to handle whenever a marker on a map is clicked\n   */\n  private drawMap(\n    mapElement: HTMLElement,\n    locations: any[],\n    selectMarkerHandler: Function\n  ) {\n    this.initMap(mapElement, this.defineMapCenter(locations));\n    this.createMarkers(locations, selectMarkerHandler);\n  }\n}\n","import { StoreFinderConfig } from './store-finder-config';\n\nexport const defaultStoreFinderConfig: StoreFinderConfig = {\n  googleMaps: {\n    apiUrl: 'https://maps.googleapis.com/maps/api/js',\n    apiKey: '',\n    scale: 12,\n    selectedMarkerScale: 16,\n  },\n};\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\n\nimport { StoreModule } from '@ngrx/store';\nimport { EffectsModule } from '@ngrx/effects';\n\nimport { reducerToken, reducerProvider } from './reducers/index';\nimport { effects } from './effects/index';\nimport { STORE_FINDER_FEATURE } from './store-finder-state';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StoreModule.forFeature(STORE_FINDER_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [reducerProvider],\n})\nexport class StoreFinderStoreModule {}\n","import { NgModule } from '@angular/core';\nimport { Config, ConfigModule } from '../config/config.module';\nimport { defaultStoreFinderConfig } from './config/default-store-finder-config';\nimport { StoreFinderConfig } from './config/store-finder-config';\nimport { StoreDataService } from './facade/store-data.service';\nimport { StoreFinderService } from './facade/store-finder.service';\nimport {\n  ExternalJsFileLoader,\n  GoogleMapRendererService,\n} from './service/index';\nimport { StoreFinderStoreModule } from './store/store-finder-store.module';\n\n@NgModule({\n  imports: [\n    ConfigModule.withConfig(defaultStoreFinderConfig),\n    StoreFinderStoreModule,\n  ],\n  providers: [\n    StoreFinderService,\n    StoreDataService,\n    GoogleMapRendererService,\n    ExternalJsFileLoader,\n    { provide: StoreFinderConfig, useExisting: Config },\n  ],\n})\nexport class StoreFinderCoreModule {}\n","export interface Images {\n  [imageType: string]: ImageGroup | ImageGroup[];\n}\n\nexport interface Image {\n  altText?: string;\n  format?: string;\n  galleryIndex?: number;\n  imageType?: ImageType;\n  url?: string;\n}\n\nexport enum ImageType {\n  PRIMARY = 'PRIMARY',\n  GALLERY = 'GALLERY',\n}\n\nexport interface ImageGroup {\n  [format: string]: Image;\n}\n","import { Image, Images } from './image.model';\nimport { User } from './misc.model';\n\nexport interface VariantOptionQualifier {\n  image?: Image;\n  name?: string;\n  qualifier?: string;\n  value?: string;\n}\n\nexport interface PromotionRestriction {\n  description?: string;\n  restrictionType?: string;\n}\n\nexport interface FeatureUnit {\n  name?: string;\n  symbol?: string;\n  unitType?: string;\n}\n\nexport interface FeatureValue {\n  value?: string;\n}\n\nexport interface Feature {\n  code?: string;\n  comparable?: boolean;\n  description?: string;\n  featureUnit?: FeatureUnit;\n  featureValues?: FeatureValue[];\n  name?: string;\n  range?: boolean;\n  type?: string;\n}\n\nexport interface VariantCategory {\n  hasImage?: boolean;\n  name?: string;\n  priority?: number;\n}\n\nexport interface VariantValueCategory {\n  name?: string;\n  sequence?: number;\n  superCategories?: VariantCategory[];\n}\n\nexport enum PriceType {\n  BUY = 'BUY',\n  FROM = 'FROM',\n}\n\nexport interface Price {\n  currencyIso?: string;\n  formattedValue?: string;\n  maxQuantity?: number;\n  minQuantity?: number;\n  priceType?: PriceType;\n  value?: number;\n}\n\nexport interface Stock {\n  stockLevel?: number;\n  stockLevelStatus?: string;\n}\n\nexport interface VariantOption {\n  code?: string;\n  priceData?: Price;\n  stock?: Stock;\n  url?: string;\n  variantOptionQualifiers?: VariantOptionQualifier[];\n}\n\nexport interface Promotion {\n  code?: string;\n  couldFireMessages?: string[];\n  description?: string;\n  enabled?: boolean;\n  endDate?: Date;\n  firedMessages?: string[];\n  priority?: number;\n  productBanner?: Image;\n  promotionGroup?: string;\n  promotionType?: string;\n  restrictions?: PromotionRestriction[];\n  startDate?: Date;\n  title?: string;\n}\n\nexport interface Category {\n  code?: string;\n  name?: string;\n  image?: Image;\n  url?: string;\n}\n\nexport interface Classification {\n  code?: string;\n  features?: Feature[];\n  name?: string;\n}\n\nexport interface FutureStock {\n  date?: Date;\n  formattedDate?: string;\n  stock?: Stock;\n}\n\nexport interface PriceRange {\n  maxPrice?: Price;\n  minPrice?: Price;\n}\n\nexport interface ProductReference {\n  description?: string;\n  preselected?: boolean;\n  quantity?: number;\n  referenceType?: string;\n  target?: Product;\n}\n\nexport interface Review {\n  alias?: string;\n  comment?: string;\n  date?: Date;\n  headline?: string;\n  id?: string;\n  principal?: User;\n  rating?: number;\n}\n\nexport interface VariantMatrixElement {\n  elements?: VariantMatrixElement[];\n  isLeaf?: boolean;\n  parentVariantCategory?: VariantCategory;\n  variantOption?: VariantOption;\n  variantValueCategory?: VariantValueCategory;\n}\n\nexport interface ProductReferences {\n  [referenceType: string]: ProductReference[];\n}\n\nexport interface BaseOption {\n  options?: VariantOption[];\n  selected?: VariantOption;\n  variantType?: string;\n}\n\nexport interface Product {\n  availableForPickup?: boolean;\n  averageRating?: number;\n  baseOptions?: BaseOption[];\n  baseProduct?: string;\n  categories?: Category[];\n  classifications?: Classification[];\n  code?: string;\n  description?: string;\n  futureStocks?: FutureStock[];\n  images?: Images;\n  manufacturer?: string;\n  multidimensional?: boolean;\n  name?: string;\n  nameHtml?: string;\n  numberOfReviews?: number;\n  potentialPromotions?: Promotion[];\n  price?: Price;\n  priceRange?: PriceRange;\n  productReferences?: ProductReferences;\n  purchasable?: boolean;\n  reviews?: Review[];\n  stock?: Stock;\n  summary?: string;\n  url?: string;\n  variantMatrix?: VariantMatrixElement[];\n  variantOptions?: VariantOption[];\n  variantType?: string;\n  volumePrices?: Price[];\n  volumePricesFlag?: boolean;\n}\n","import { EntityState } from './entity-state';\n\nexport function entitySelector<T>(state: EntityState<T>, id: string): T {\n  return state.entities[id] || undefined;\n}\n","import { filter } from 'rxjs/operators';\n\nimport { EntityLoadAction } from '../entity-loader/entity-loader.action';\nimport { MonoTypeOperatorFunction } from 'rxjs';\n\nexport function ofLoaderLoad(\n  entityType: string\n): MonoTypeOperatorFunction<EntityLoadAction> {\n  return filter(\n    (action: EntityLoadAction) =>\n      action.meta &&\n      action.meta.loader &&\n      action.meta.entityType === entityType &&\n      action.meta.loader.load\n  );\n}\n\nexport function ofLoaderFail(\n  entityType: string\n): MonoTypeOperatorFunction<EntityLoadAction> {\n  return filter(\n    (action: EntityLoadAction) =>\n      action.meta &&\n      action.meta.loader &&\n      action.meta.entityType === entityType &&\n      action.meta.loader.error\n  );\n}\n\nexport function ofLoaderSuccess(\n  entityType: string\n): MonoTypeOperatorFunction<EntityLoadAction> {\n  return filter(\n    (action: EntityLoadAction) =>\n      action.meta &&\n      action.meta.loader &&\n      action.meta.entityType === entityType &&\n      !action.meta.loader.load &&\n      !action.meta.loader.error\n  );\n}\n","export const testestsd = 'sare';\n"]}