{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","ng://@spartacus/core/src/config/utils/deep-merge.ts","ng://@spartacus/core/src/config/config.module.ts","ng://@spartacus/core/src/site-context/config/site-context-config.ts","ng://@spartacus/core/src/occ/config/occ-config.ts","ng://@spartacus/core/src/anonymous-consents/config/anonymous-consents-config.ts","ng://@spartacus/core/src/anonymous-consents/config/default-anonymous-consents-config.ts","ng://@spartacus/core/src/auth/config/auth-config.ts","ng://@spartacus/core/src/auth/config/default-auth-config.ts","ng://@spartacus/core/src/occ/utils/interceptor-util.ts","ng://@spartacus/core/src/state/utils/entity/entity.action.ts","ng://@spartacus/core/src/state/utils/loader/loader.action.ts","ng://@spartacus/core/src/state/utils/entity-loader/entity-loader.action.ts","ng://@spartacus/core/src/state/utils/loader/loader.reducer.ts","ng://@spartacus/core/src/state/utils/entity-loader/entity-loader.selectors.ts","ng://@spartacus/core/src/state/utils/entity/entity.reducer.ts","ng://@spartacus/core/src/state/utils/entity-loader/entity-loader.reducer.ts","ng://@spartacus/core/src/state/utils/processes-loader/processes-loader.action.ts","ng://@spartacus/core/src/state/utils/entity-processes-loader/entity-processes-loader.action.ts","ng://@spartacus/core/src/state/utils/processes-loader/processes-loader.selectors.ts","ng://@spartacus/core/src/state/utils/processes-loader/processes-loader.reducer.ts","ng://@spartacus/core/src/state/utils/entity-processes-loader/entity-processes-loader.selectors.ts","ng://@spartacus/core/src/state/utils/entity-processes-loader/entity-processes-loader.reducer.ts","ng://@spartacus/core/src/state/utils/entity/entity.selectors.ts","ng://@spartacus/core/src/state/utils/get-state-slice.ts","ng://@spartacus/core/src/state/utils/loader/loader.selectors.ts","ng://@spartacus/core/src/auth/store/actions/client-token.action.ts","ng://@spartacus/core/src/auth/store/auth-state.ts","ng://@spartacus/core/src/auth/store/actions/login-logout.action.ts","ng://@spartacus/core/src/auth/store/actions/user-token.action.ts","ng://@spartacus/core/src/auth/store/selectors/feature.selector.ts","ng://@spartacus/core/src/auth/store/selectors/client-token.selectors.ts","ng://@spartacus/core/src/auth/store/selectors/user-token.selectors.ts","ng://@spartacus/core/src/auth/facade/auth.service.ts","ng://@spartacus/core/src/occ/utils/occ-constants.ts","ng://@spartacus/core/src/auth/services/client-error/client-error-handling.service.ts","ng://@spartacus/core/src/window/window-ref.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/url-parsing.service.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/path-utils.ts","ng://@spartacus/core/src/routing/configurable-routes/config/routing-config.ts","ng://@spartacus/core/src/routing/configurable-routes/routing-config.service.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/semantic-path.service.ts","ng://@spartacus/core/src/routing/store/actions/router.action.ts","ng://@spartacus/core/src/routing/store/selectors/routing.selector.ts","ng://@spartacus/core/src/routing/store/routing-state.ts","ng://@spartacus/core/src/routing/facade/routing.service.ts","ng://@spartacus/core/src/auth/services/user-error/user-error-handling.service.ts","ng://@spartacus/core/src/auth/http-interceptors/auth-error.interceptor.ts","ng://@spartacus/core/src/config/utils/dynamic-template.ts","ng://@spartacus/core/src/site-context/config/context-config-utils.ts","ng://@spartacus/core/src/site-context/store/actions/base-site.action.ts","ng://@spartacus/core/src/state/config/state-config.ts","ng://@spartacus/core/src/site-context/store/actions/currencies.action.ts","ng://@spartacus/core/src/site-context/store/actions/languages.action.ts","ng://@spartacus/core/src/site-context/store/selectors/site-context.selector.ts","ng://@spartacus/core/src/site-context/store/state.ts","ng://@spartacus/core/src/site-context/store/selectors/base-site.selectors.ts","ng://@spartacus/core/src/site-context/store/selectors/currencies.selectors.ts","ng://@spartacus/core/src/site-context/store/selectors/languages.selectors.ts","ng://@spartacus/core/src/site-context/facade/base-site.service.ts","ng://@spartacus/core/src/site-context/providers/context-ids.ts","ng://@spartacus/core/src/occ/services/occ-endpoints.service.ts","ng://@spartacus/core/src/auth/http-interceptors/client-token.interceptor.ts","ng://@spartacus/core/src/auth/http-interceptors/user-token.interceptor.ts","ng://@spartacus/core/src/auth/http-interceptors/token-revocation.interceptor.ts","ng://@spartacus/core/src/auth/http-interceptors/index.ts","ng://@spartacus/core/src/auth/services/client-authentication/client-authentication-token.service.ts","ng://@spartacus/core/src/auth/services/user-authentication/user-authentication-token.service.ts","ng://@spartacus/core/src/auth/services/index.ts","ng://@spartacus/core/src/state/config/default-state-config.ts","ng://@spartacus/core/src/state/reducers/storage-sync.reducer.ts","ng://@spartacus/core/src/state/reducers/transfer-state.reducer.ts","ng://@spartacus/core/src/state/reducers/index.ts","ng://@spartacus/core/src/state/state.module.ts","ng://@spartacus/core/src/util/serialization-utils.ts","ng://@spartacus/core/src/auth/store/effects/client-token.effect.ts","ng://@spartacus/core/src/auth/store/effects/user-token.effect.ts","ng://@spartacus/core/src/auth/store/effects/index.ts","ng://@spartacus/core/src/auth/store/reducers/user-token.reducer.ts","ng://@spartacus/core/src/auth/store/reducers/index.ts","ng://@spartacus/core/src/auth/store/auth-store.module.ts","ng://@spartacus/core/src/model/address.model.ts","ng://@spartacus/core/src/model/cart.model.ts","ng://@spartacus/core/src/model/cms.model.ts","ng://@spartacus/core/src/model/consent.model.ts","ng://@spartacus/core/src/model/image.model.ts","ng://@spartacus/core/src/model/product.model.ts","ng://@spartacus/core/src/auth/auth.module.ts","ng://@spartacus/core/src/auth/guards/auth-redirect.service.ts","ng://@spartacus/core/src/auth/guards/auth.guard.ts","ng://@spartacus/core/src/auth/guards/not-auth.guard.ts","ng://@spartacus/core/src/model/product-interest.model.ts","ng://@spartacus/core/src/anonymous-consents/store/anonymous-consents-state.ts","ng://@spartacus/core/src/anonymous-consents/store/actions/anonymous-consents.action.ts","ng://@spartacus/core/src/anonymous-consents/store/selectors/feature.selector.ts","ng://@spartacus/core/src/anonymous-consents/store/selectors/anonymous-consent-templates.selectors.ts","ng://@spartacus/core/src/anonymous-consents/store/selectors/anonymous-consent-ui.selectors.ts","ng://@spartacus/core/src/anonymous-consents/store/selectors/anonymous-consents.selectors.ts","ng://@spartacus/core/src/anonymous-consents/facade/anonymous-consents.service.ts","ng://@spartacus/core/src/features-config/config/features-config.ts","ng://@spartacus/core/src/features-config/utils/feature-config-utils.ts","ng://@spartacus/core/src/cms/config/cms-config.ts","ng://@spartacus/core/src/features-config/services/feature-config.service.ts","ng://@spartacus/core/src/features-config/directives/feature-level.directive.ts","ng://@spartacus/core/src/features-config/directives/feature.directive.ts","ng://@spartacus/core/src/features-config/features-config.module.ts","ng://@spartacus/core/src/asm/connectors/asm.adapter.ts","ng://@spartacus/core/src/occ/adapters/asm/default-occ-asm-config.ts","ng://@spartacus/core/src/asm/config/asm-config.ts","ng://@spartacus/core/src/asm/connectors/converters.ts","ng://@spartacus/core/src/util/converter.service.ts","ng://@spartacus/core/src/occ/adapters/asm/occ-asm.adapter.ts","ng://@spartacus/core/src/occ/adapters/asm/asm-occ.module.ts","ng://@spartacus/core/src/cart/connectors/cart/cart.adapter.ts","ng://@spartacus/core/src/cart/connectors/cart/converters.ts","ng://@spartacus/core/src/cart/connectors/entry/cart-entry.adapter.ts","ng://@spartacus/core/src/cart/connectors/save-cart/save-cart.adapter.ts","ng://@spartacus/core/src/cart/connectors/voucher/cart-voucher.adapter.ts","ng://@spartacus/core/src/product/connectors/product/converters.ts","ng://@spartacus/core/src/occ/adapters/cart/converters/occ-cart-normalizer.ts","ng://@spartacus/core/src/occ/adapters/cart/default-occ-cart-config.ts","ng://@spartacus/core/src/cart/connectors/entry/converters.ts","ng://@spartacus/core/src/occ/adapters/cart/occ-cart-entry.adapter.ts","ng://@spartacus/core/src/cart/connectors/voucher/converters.ts","ng://@spartacus/core/src/occ/adapters/cart/occ-cart-voucher.adapter.ts","ng://@spartacus/core/src/occ/adapters/cart/occ-cart.adapter.ts","ng://@spartacus/core/src/cart/connectors/save-cart/converters.ts","ng://@spartacus/core/src/occ/adapters/cart/occ-save-cart.adapter.ts","ng://@spartacus/core/src/occ/adapters/cart/cart-occ.module.ts","ng://@spartacus/core/src/checkout/connectors/checkout/converters.ts","ng://@spartacus/core/src/occ/adapters/checkout/occ-checkout.adapter.ts","ng://@spartacus/core/src/checkout/connectors/delivery/converters.ts","ng://@spartacus/core/src/user/connectors/address/converters.ts","ng://@spartacus/core/src/occ/adapters/checkout/occ-checkout-delivery.adapter.ts","ng://@spartacus/core/src/checkout/connectors/payment/converters.ts","ng://@spartacus/core/src/occ/adapters/cart/custom.encoder.ts","ng://@spartacus/core/src/occ/adapters/checkout/occ-checkout-payment.adapter.ts","ng://@spartacus/core/src/checkout/connectors/checkout/checkout.adapter.ts","ng://@spartacus/core/src/occ/adapters/checkout/converters/occ-order-normalizer.ts","ng://@spartacus/core/src/checkout/connectors/delivery/checkout-delivery.adapter.ts","ng://@spartacus/core/src/checkout/connectors/payment/checkout-payment.adapter.ts","ng://@spartacus/core/src/occ/adapters/checkout/checkout-occ.module.ts","ng://@spartacus/core/src/cms/connectors/page/converters.ts","ng://@spartacus/core/src/occ/adapters/cms/occ-cms-page.adapter.ts","ng://@spartacus/core/src/cms/connectors/component/converters.ts","ng://@spartacus/core/src/occ/adapters/cms/occ-cms-component.adapter.ts","ng://@spartacus/core/src/occ/adapters/cms/converters/occ-cms-page-normalizer.ts","ng://@spartacus/core/src/cms/connectors/page/cms-page.adapter.ts","ng://@spartacus/core/src/cms/connectors/component/cms-component.adapter.ts","ng://@spartacus/core/src/occ/adapters/cms/cms-occ.module.ts","ng://@spartacus/core/src/occ/adapters/product/converters/product-image-normalizer.ts","ng://@spartacus/core/src/occ/adapters/product/converters/product-reference-normalizer.ts","ng://@spartacus/core/src/occ/adapters/product/converters/occ-product-search-page-normalizer.ts","ng://@spartacus/core/src/occ/adapters/product/converters/occ-product-references-list-normalizer.ts","ng://@spartacus/core/src/occ/adapters/product/converters/product-name-normalizer.ts","ng://@spartacus/core/src/product/connectors/references/converters.ts","ng://@spartacus/core/src/occ/adapters/product/occ-product-references.adapter.ts","ng://@spartacus/core/src/product/connectors/reviews/converters.ts","ng://@spartacus/core/src/occ/adapters/product/occ-product-reviews.adapter.ts","ng://@spartacus/core/src/product/connectors/search/converters.ts","ng://@spartacus/core/src/occ/adapters/product/occ-product-search.adapter.ts","ng://@spartacus/core/src/occ/utils/occ-fields.ts","ng://@spartacus/core/src/occ/services/occ-fields.service.ts","ng://@spartacus/core/src/product/model/product-scope.ts","ng://@spartacus/core/src/occ/services/occ-requests-optimizer.service.ts","ng://@spartacus/core/src/occ/adapters/product/occ-product.adapter.ts","ng://@spartacus/core/src/product/connectors/product/product.adapter.ts","ng://@spartacus/core/src/product/connectors/references/product-references.adapter.ts","ng://@spartacus/core/src/product/connectors/reviews/product-reviews.adapter.ts","ng://@spartacus/core/src/product/connectors/search/product-search.adapter.ts","ng://@spartacus/core/src/occ/adapters/product/default-occ-product-config.ts","ng://@spartacus/core/src/occ/adapters/product/product-occ.module.ts","ng://@spartacus/core/src/site-context/connectors/converters.ts","ng://@spartacus/core/src/occ/adapters/site-context/occ-site.adapter.ts","ng://@spartacus/core/src/site-context/connectors/site.adapter.ts","ng://@spartacus/core/src/occ/adapters/site-context/default-occ-site-context-config.ts","ng://@spartacus/core/src/site-context/facade/currency.service.ts","ng://@spartacus/core/src/site-context/facade/language.service.ts","ng://@spartacus/core/src/occ/adapters/site-context/site-context.interceptor.ts","ng://@spartacus/core/src/occ/adapters/site-context/site-context-occ.module.ts","ng://@spartacus/core/src/store-finder/connectors/store-finder.adapter.ts","ng://@spartacus/core/src/occ/adapters/store-finder/default-occ-store-finder-config.ts","ng://@spartacus/core/src/store-finder/connectors/store-finder.connector.ts","ng://@spartacus/core/src/store-finder/connectors/converters.ts","ng://@spartacus/core/src/occ/adapters/store-finder/occ-store-finder.adapter.ts","ng://@spartacus/core/src/occ/adapters/store-finder/store-finder-occ.module.ts","ng://@spartacus/core/src/user/connectors/consent/converters.ts","ng://@spartacus/core/src/occ/adapters/user/occ-anonymous-consent-templates.adapter.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user-address.adapter.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user-consent.adapter.ts","ng://@spartacus/core/src/user/connectors/order/converters.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user-order.adapter.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user-payment.adapter.ts","ng://@spartacus/core/src/user/connectors/user/converters.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user.adapter.ts","ng://@spartacus/core/src/anonymous-consents/connectors/anonymous-consent-templates.adapter.ts","ng://@spartacus/core/src/user/connectors/address/user-address.adapter.ts","ng://@spartacus/core/src/user/connectors/consent/user-consent.adapter.ts","ng://@spartacus/core/src/user/connectors/order/user-order.adapter.ts","ng://@spartacus/core/src/user/connectors/payment/user-payment.adapter.ts","ng://@spartacus/core/src/user/connectors/user/user.adapter.ts","ng://@spartacus/core/src/occ/adapters/user/default-occ-user-config.ts","ng://@spartacus/core/src/user/connectors/customer-coupon/customer-coupon.adapter.ts","ng://@spartacus/core/src/user/connectors/customer-coupon/converters.ts","ng://@spartacus/core/src/occ/adapters/user/occ-customer-coupon.adapter.ts","ng://@spartacus/core/src/user/connectors/notification-preference/user-notification-preference.adapter.ts","ng://@spartacus/core/src/user/connectors/notification-preference/converters.ts","ng://@spartacus/core/src/user/connectors/notification-preference/user-notification-preference.connector.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user-notification-preference.adapter.ts","ng://@spartacus/core/src/user/connectors/interests/converters.ts","ng://@spartacus/core/src/occ/adapters/user/occ-user-interests.adapter.ts","ng://@spartacus/core/src/user/connectors/interests/user-interests.adapter.ts","ng://@spartacus/core/src/occ/adapters/user/converters/occ-user-interests-normalizer.ts","ng://@spartacus/core/src/occ/adapters/user/converters/occ-return-request-normalizer.ts","ng://@spartacus/core/src/occ/adapters/user/user-occ.module.ts","ng://@spartacus/core/src/occ/config-loader/java-reg-exp-converter.ts","ng://@spartacus/core/src/config/config-initializer/config-initializer.ts","ng://@spartacus/core/src/ssr/ssr.providers.ts","ng://@spartacus/core/src/occ/config-loader/occ-loaded-config-converter.ts","ng://@spartacus/core/src/occ/config-loader/occ-sites-config-loader.ts","ng://@spartacus/core/src/occ/config-loader/occ-config-loader.service.ts","ng://@spartacus/core/src/occ/config-loader/occ-config-loader.module.ts","ng://@spartacus/core/src/occ/config/config-from-meta-tag-factory.ts","ng://@spartacus/core/src/occ/occ-models/occ.models.ts","ng://@spartacus/core/src/occ/config/default-occ-config.ts","ng://@spartacus/core/src/occ/config/occ-config-validator.ts","ng://@spartacus/core/src/config/config-validator/config-validator.ts","ng://@spartacus/core/src/occ/occ.module.ts","ng://@spartacus/core/src/occ/services/loading-scopes.service.ts","ng://@spartacus/core/src/anonymous-consents/http-interceptors/anonymous-consents-interceptor.ts","ng://@spartacus/core/src/anonymous-consents/http-interceptors/index.ts","ng://@spartacus/core/src/state/services/state-persistence.service.ts","ng://@spartacus/core/src/process/store/selectors/process.selectors.ts","ng://@spartacus/core/src/process/store/selectors/feature.selector.ts","ng://@spartacus/core/src/process/store/process-state.ts","ng://@spartacus/core/src/user/store/actions/billing-countries.action.ts","ng://@spartacus/core/src/user/store/actions/consignment-tracking.action.ts","ng://@spartacus/core/src/user/store/actions/delivery-countries.action.ts","ng://@spartacus/core/src/user/store/actions/forgot-password.action.ts","ng://@spartacus/core/src/user/store/user-state.ts","ng://@spartacus/core/src/user/store/actions/order-details.action.ts","ng://@spartacus/core/src/user/store/actions/payment-methods.action.ts","ng://@spartacus/core/src/user/store/actions/regions.action.ts","ng://@spartacus/core/src/user/store/actions/reset-password.action.ts","ng://@spartacus/core/src/user/store/actions/titles.action.ts","ng://@spartacus/core/src/user/store/actions/update-email.action.ts","ng://@spartacus/core/src/user/store/actions/update-password.action.ts","ng://@spartacus/core/src/user/store/actions/user-addresses.action.ts","ng://@spartacus/core/src/user/store/actions/user-consents.action.ts","ng://@spartacus/core/src/user/store/actions/user-details.action.ts","ng://@spartacus/core/src/user/store/actions/user-misc.action.ts","ng://@spartacus/core/src/user/store/actions/user-orders.action.ts","ng://@spartacus/core/src/user/store/actions/user-register.action.ts","ng://@spartacus/core/src/user/store/actions/customer-coupon.action.ts","ng://@spartacus/core/src/user/store/actions/notification-preference.action.ts","ng://@spartacus/core/src/user/store/actions/product-interests.actions.ts","ng://@spartacus/core/src/user/store/actions/order-return-request.action.ts","ng://@spartacus/core/src/user/store/selectors/feature.selector.ts","ng://@spartacus/core/src/user/store/selectors/billing-countries.selectors.ts","ng://@spartacus/core/src/user/store/selectors/consignment-tracking.selectors.ts","ng://@spartacus/core/src/user/store/selectors/delivery-countries.selectors.ts","ng://@spartacus/core/src/user/store/selectors/order-details.selectors.ts","ng://@spartacus/core/src/user/store/selectors/order-return-request.selectors.ts","ng://@spartacus/core/src/user/store/selectors/payment-methods.selectors.ts","ng://@spartacus/core/src/user/store/selectors/regions.selectors.ts","ng://@spartacus/core/src/user/store/selectors/reset-password.selectors.ts","ng://@spartacus/core/src/user/store/selectors/titles.selectors.ts","ng://@spartacus/core/src/user/store/selectors/user-addresses.selectors.ts","ng://@spartacus/core/src/user/store/selectors/user-consents.selectors.ts","ng://@spartacus/core/src/user/store/selectors/user-details.selectors.ts","ng://@spartacus/core/src/user/store/selectors/user-orders.selectors.ts","ng://@spartacus/core/src/user/store/selectors/customer-coupons.selectors.ts","ng://@spartacus/core/src/user/store/selectors/notification-preference.selectors.ts","ng://@spartacus/core/src/user/store/selectors/product-interests.selectors.ts","ng://@spartacus/core/src/user/facade/user-consent.service.ts","ng://@spartacus/core/src/anonymous-consents/connectors/anonymous-consent-templates.connector.ts","ng://@spartacus/core/src/anonymous-consents/store/effects/anonymous-consents.effect.ts","ng://@spartacus/core/src/anonymous-consents/store/effects/index.ts","ng://@spartacus/core/src/site-context/connectors/site.connector.ts","ng://@spartacus/core/src/site-context/providers/context-service-map.ts","ng://@spartacus/core/src/site-context/config/base-site-config-validator.ts","ng://@spartacus/core/src/site-context/config/default-site-context-config.ts","ng://@spartacus/core/src/config/config-initializer/config-initializer.service.ts","ng://@spartacus/core/src/site-context/providers/context-service-providers.ts","ng://@spartacus/core/src/site-context/services/site-context-params.service.ts","ng://@spartacus/core/src/site-context/services/site-context-url-serializer.ts","ng://@spartacus/core/src/site-context/services/site-context-routes-handler.ts","ng://@spartacus/core/src/site-context/providers/site-context-params-providers.ts","ng://@spartacus/core/src/site-context/store/effects/languages.effect.ts","ng://@spartacus/core/src/site-context/store/effects/currencies.effect.ts","ng://@spartacus/core/src/site-context/store/effects/base-site.effect.ts","ng://@spartacus/core/src/site-context/store/effects/index.ts","ng://@spartacus/core/src/site-context/store/reducers/base-site.reducer.ts","ng://@spartacus/core/src/site-context/store/reducers/currencies.reducer.ts","ng://@spartacus/core/src/site-context/store/reducers/languages.reducer.ts","ng://@spartacus/core/src/site-context/store/reducers/index.ts","ng://@spartacus/core/src/site-context/store/site-context-store.module.ts","ng://@spartacus/core/src/site-context/site-context.module.ts","ng://@spartacus/core/src/anonymous-consents/store/reducers/anonymous-consents-banner.reducer.ts","ng://@spartacus/core/src/anonymous-consents/store/reducers/anonymous-consents-update.reducer.ts","ng://@spartacus/core/src/anonymous-consents/store/reducers/anonymous-consents.reducer.ts","ng://@spartacus/core/src/anonymous-consents/store/reducers/index.ts","ng://@spartacus/core/src/anonymous-consents/store/anonymous-consents-store.module.ts","ng://@spartacus/core/src/anonymous-consents/anonymous-consents.module.ts","ng://@spartacus/core/src/asm/config/default-asm-config.ts","ng://@spartacus/core/src/asm/store/asm-state.ts","ng://@spartacus/core/src/asm/connectors/asm.connector.ts","ng://@spartacus/core/src/asm/store/actions/asm-ui.action.ts","ng://@spartacus/core/src/asm/store/actions/customer.action.ts","ng://@spartacus/core/src/asm/store/actions/csagent-token.action.ts","ng://@spartacus/core/src/asm/store/effects/customer.effect.ts","ng://@spartacus/core/src/asm/store/effects/csagent-token.effect.ts","ng://@spartacus/core/src/asm/store/effects/index.ts","ng://@spartacus/core/src/asm/store/reducers/asm-ui.reducer.ts","ng://@spartacus/core/src/asm/store/reducers/index.ts","ng://@spartacus/core/src/asm/store/asm-store.module.ts","ng://@spartacus/core/src/global-message/models/global-message.model.ts","ng://@spartacus/core/src/asm/store/selectors/feature.selector.ts","ng://@spartacus/core/src/asm/store/selectors/asm-ui.selectors.ts","ng://@spartacus/core/src/asm/store/selectors/customer-search.selectors.ts","ng://@spartacus/core/src/asm/store/selectors/csagent-token.selectors.ts","ng://@spartacus/core/src/asm/facade/asm-auth.service.ts","ng://@spartacus/core/src/asm/http-interceptors/csagent-token.interceptor.ts","ng://@spartacus/core/src/global-message/models/response-status.model.ts","ng://@spartacus/core/src/global-message/config/global-message-config.ts","ng://@spartacus/core/src/global-message/store/actions/global-message.actions.ts","ng://@spartacus/core/src/global-message/store/selectors/feature.selector.ts","ng://@spartacus/core/src/global-message/store/global-message-state.ts","ng://@spartacus/core/src/global-message/store/selectors/global-message.selectors.ts","ng://@spartacus/core/src/global-message/facade/global-message.service.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/http-error.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/bad-gateway.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/bad-request.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/conflict.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/forbidden.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/gateway-timeout.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/internal-server-error.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/not-found.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/handlers/unknown-error.handler.ts","ng://@spartacus/core/src/global-message/http-interceptors/http-error.interceptor.ts","ng://@spartacus/core/src/global-message/http-interceptors/index.ts","ng://@spartacus/core/src/global-message/store/reducers/global-message.reducer.ts","ng://@spartacus/core/src/global-message/store/reducers/index.ts","ng://@spartacus/core/src/global-message/store/global-message-store.module.ts","ng://@spartacus/core/src/util/compare-equal-objects.ts","ng://@spartacus/core/src/global-message/store/effects/global-message.effect.ts","ng://@spartacus/core/src/global-message/config/default-global-message-config.ts","ng://@spartacus/core/src/global-message/global-message.module.ts","ng://@spartacus/core/src/asm/services/csagent-error-handling.service.ts","ng://@spartacus/core/src/asm/http-interceptors/csagent-auth-error.interceptor.ts","ng://@spartacus/core/src/asm/http-interceptors/index.ts","ng://@spartacus/core/src/asm/asm.module.ts","ng://@spartacus/core/src/asm/facade/asm.service.ts","ng://@spartacus/core/src/cms/page/page-meta.resolver.ts","ng://@spartacus/core/src/util/regex-pattern.ts","ng://@spartacus/core/src/cart/store/cart-state.ts","ng://@spartacus/core/src/cart/store/selectors/cart.selector.ts","ng://@spartacus/core/src/cart/store/selectors/multi-cart.selector.ts","ng://@spartacus/core/src/cart/store/multi-cart-state.ts","ng://@spartacus/core/src/cart/utils/utils.ts","ng://@spartacus/core/src/cart/store/actions/cart.action.ts","ng://@spartacus/core/src/cart/store/actions/cart-entry.action.ts","ng://@spartacus/core/src/cart/store/actions/cart-voucher.action.ts","ng://@spartacus/core/src/cart/store/actions/multi-cart.action.ts","ng://@spartacus/core/src/cart/store/actions/wish-list.action.ts","ng://@spartacus/core/src/cart/facade/multi-cart.service.ts","ng://@spartacus/core/src/cart/facade/active-cart.service.ts","ng://@spartacus/core/src/cart/facade/cart-voucher.service.ts","ng://@spartacus/core/src/user/facade/user.service.ts","ng://@spartacus/core/src/cart/facade/selective-cart.service.ts","ng://@spartacus/core/src/cart/facade/wish-list.service.ts","ng://@spartacus/core/src/cms/store/cms-state.ts","ng://@spartacus/core/src/cms/store/actions/components.action.ts","ng://@spartacus/core/src/cms/store/actions/navigation-entry-item.action.ts","ng://@spartacus/core/src/cms/store/actions/page.action.ts","ng://@spartacus/core/src/cms/store/selectors/feature.selectors.ts","ng://@spartacus/core/src/cms/store/selectors/components.selectors.ts","ng://@spartacus/core/src/cms/store/selectors/navigation-entry-item.selectors.ts","ng://@spartacus/core/src/cms/store/selectors/page.selectors.ts","ng://@spartacus/core/src/cms/utils/cms-utils.ts","ng://@spartacus/core/src/cms/model/page.model.ts","ng://@spartacus/core/src/cms/facade/cms.service.ts","ng://@spartacus/core/src/cart/services/cart-page-meta.resolver.ts","ng://@spartacus/core/src/util/withdraw-on.ts","ng://@spartacus/core/src/cart/connectors/entry/cart-entry.connector.ts","ng://@spartacus/core/src/cart/store/effects/cart-entry.effect.ts","ng://@spartacus/core/src/cart/connectors/voucher/cart-voucher.connector.ts","ng://@spartacus/core/src/cart/store/effects/cart-voucher.effect.ts","ng://@spartacus/core/src/checkout/store/actions/address-verification.action.ts","ng://@spartacus/core/src/checkout/store/actions/card-types.action.ts","ng://@spartacus/core/src/checkout/store/checkout-state.ts","ng://@spartacus/core/src/checkout/store/actions/checkout.action.ts","ng://@spartacus/core/src/cart/connectors/cart/cart.connector.ts","ng://@spartacus/core/src/cart/store/effects/cart.effect.ts","ng://@spartacus/core/src/cart/connectors/save-cart/save-cart.connecter.ts","ng://@spartacus/core/src/cart/store/effects/wish-list.effect.ts","ng://@spartacus/core/src/cart/store/reducers/cart.reducer.ts","ng://@spartacus/core/src/cart/store/reducers/multi-cart.reducer.ts","ng://@spartacus/core/src/cart/store/reducers/index.ts","ng://@spartacus/core/src/cart/services/multi-cart-state-persistence.service.ts","ng://@spartacus/core/src/cart/store/cart-store.module.ts","ng://@spartacus/core/src/cart/store/effects/multi-cart.effect.ts","ng://@spartacus/core/src/cart/store/multi-cart-store.module.ts","ng://@spartacus/core/src/cart/cart.module.ts","ng://@spartacus/core/src/checkout/store/reducers/address-verification.reducer.ts","ng://@spartacus/core/src/checkout/store/selectors/checkout.selectors.ts","ng://@spartacus/core/src/checkout/store/selectors/address-verification.selectors.ts","ng://@spartacus/core/src/checkout/store/reducers/card-types.reducer.ts","ng://@spartacus/core/src/checkout/store/selectors/card-types.selectors.ts","ng://@spartacus/core/src/checkout/facade/checkout.service.ts","ng://@spartacus/core/src/i18n/translation.service.ts","ng://@spartacus/core/src/checkout/services/checkout-page-meta.resolver.ts","ng://@spartacus/core/src/checkout/store/reducers/checkout.reducer.ts","ng://@spartacus/core/src/checkout/store/reducers/index.ts","ng://@spartacus/core/src/user/connectors/address/user-address.connector.ts","ng://@spartacus/core/src/checkout/store/effects/address-verification.effect.ts","ng://@spartacus/core/src/checkout/connectors/payment/checkout-payment.connector.ts","ng://@spartacus/core/src/checkout/store/effects/card-types.effect.ts","ng://@spartacus/core/src/checkout/connectors/checkout/checkout.connector.ts","ng://@spartacus/core/src/checkout/connectors/delivery/checkout-delivery.connector.ts","ng://@spartacus/core/src/checkout/store/effects/checkout.effect.ts","ng://@spartacus/core/src/checkout/store/effects/index.ts","ng://@spartacus/core/src/checkout/store/checkout-store.module.ts","ng://@spartacus/core/src/checkout/checkout.module.ts","ng://@spartacus/core/src/checkout/facade/checkout-delivery.service.ts","ng://@spartacus/core/src/checkout/facade/checkout-payment.service.ts","ng://@spartacus/core/src/cms/config/cms-structure.config.ts","ng://@spartacus/core/src/cms/config/default-cms-config.ts","ng://@spartacus/core/src/cms/page/content-page-meta.resolver.ts","ng://@spartacus/core/src/cms/page/page.module.ts","ng://@spartacus/core/src/util/buffer-debounce-time.ts","ng://@spartacus/core/src/cms/services/cms-structure-config.service.ts","ng://@spartacus/core/src/cms/connectors/component/cms-component.connector.ts","ng://@spartacus/core/src/cms/store/effects/components.effect.ts","ng://@spartacus/core/src/util/glob-utils.ts","ng://@spartacus/core/src/util/glob.service.ts","ng://@spartacus/core/src/routing/services/url-matcher.service.ts","ng://@spartacus/core/src/routing/configurable-routes/configurable-routes.service.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/url.pipe.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/product-url.pipe.ts","ng://@spartacus/core/src/routing/configurable-routes/url-translation/url.module.ts","ng://@spartacus/core/src/routing/external-routes/external-routes-config.ts","ng://@spartacus/core/src/routing/external-routes/external-routes.guard.ts","ng://@spartacus/core/src/routing/external-routes/external-routes.providers.ts","ng://@spartacus/core/src/routing/external-routes/external-routes.service.ts","ng://@spartacus/core/src/routing/external-routes/external-routes.module.ts","ng://@spartacus/core/src/routing/models/page-context.model.ts","ng://@spartacus/core/src/routing/protected-routes/protected-routes.service.ts","ng://@spartacus/core/src/routing/protected-routes/protected-routes.guard.ts","ng://@spartacus/core/src/routing/store/effects/router.effect.ts","ng://@spartacus/core/src/routing/store/effects/index.ts","ng://@spartacus/core/src/routing/store/reducers/router.reducer.ts","ng://@spartacus/core/src/routing/routing.module.ts","ng://@spartacus/core/src/routing/url-matcher/default-url-matcher.ts","ng://@spartacus/core/src/cms/store/effects/navigation-entry-item.effect.ts","ng://@spartacus/core/src/cms/connectors/page/cms-page.connector.ts","ng://@spartacus/core/src/cms/store/effects/page.effect.ts","ng://@spartacus/core/src/cms/store/effects/index.ts","ng://@spartacus/core/src/cms/store/reducers/components.reducer.ts","ng://@spartacus/core/src/cms/store/reducers/navigation-entry-item.reducer.ts","ng://@spartacus/core/src/cms/store/reducers/page-data.reducer.ts","ng://@spartacus/core/src/cms/store/reducers/page-index.reducer.ts","ng://@spartacus/core/src/cms/store/reducers/index.ts","ng://@spartacus/core/src/cms/store/cms-store.module.ts","ng://@spartacus/core/src/cms/cms.module.ts","ng://@spartacus/core/src/cms/facade/page-meta.service.ts","ng://@spartacus/core/src/cms/services/dynamic-attribute.service.ts","ng://@spartacus/core/src/config/test-config.module.ts","ng://@spartacus/core/src/config/utils/get-cookie.ts","ng://@spartacus/core/src/config/config-validator/config-validator.module.ts","ng://@spartacus/core/src/config/config-initializer/config-initializer.module.ts","ng://@spartacus/core/src/i18n/date.pipe.ts","ng://@spartacus/core/src/i18n/translate.pipe.ts","ng://@spartacus/core/src/i18n/config/i18n-config.ts","ng://@spartacus/core/src/i18n/translation-chunk.service.ts","ng://@spartacus/core/src/i18n/i18next/i18next-init.ts","ng://@spartacus/core/src/i18n/i18next/i18next-providers.ts","ng://@spartacus/core/src/i18n/config/default-i18n-config.ts","ng://@spartacus/core/src/i18n/i18next/i18next-translation.service.ts","ng://@spartacus/core/src/i18n/i18n.module.ts","ng://@spartacus/core/src/i18n/testing/mock-translate.ts","ng://@spartacus/core/src/i18n/testing/mock-translate.pipe.ts","ng://@spartacus/core/src/i18n/testing/mock-translation.service.ts","ng://@spartacus/core/src/i18n/testing/mock-date.pipe.ts","ng://@spartacus/core/src/i18n/testing/i18n-testing.module.ts","ng://@spartacus/core/src/kyma/config/kyma-config.ts","ng://@spartacus/core/src/kyma/store/kyma-state.ts","ng://@spartacus/core/src/kyma/store/actions/open-id-token.action.ts","ng://@spartacus/core/src/kyma/store/selectors/feature.selector.ts","ng://@spartacus/core/src/kyma/store/selectors/open-id-token.selectors.ts","ng://@spartacus/core/src/kyma/facade/kyma.service.ts","ng://@spartacus/core/src/kyma/config/default-kyma-config.ts","ng://@spartacus/core/src/kyma/services/open-id-token/open-id-token.service.ts","ng://@spartacus/core/src/kyma/services/index.ts","ng://@spartacus/core/src/kyma/store/effects/open-id-token.effect.ts","ng://@spartacus/core/src/kyma/store/effects/index.ts","ng://@spartacus/core/src/kyma/store/reducers/index.ts","ng://@spartacus/core/src/kyma/store/kyma-store.module.ts","ng://@spartacus/core/src/kyma/kyma.module.ts","ng://@spartacus/core/src/personalization/config/personalization-config.ts","ng://@spartacus/core/src/personalization/config/default-personalization-config.ts","ng://@spartacus/core/src/personalization/http-interceptors/occ-personalization-id.interceptor.ts","ng://@spartacus/core/src/personalization/http-interceptors/occ-personalization-time.interceptor.ts","ng://@spartacus/core/src/personalization/http-interceptors/index.ts","ng://@spartacus/core/src/personalization/personalization.module.ts","ng://@spartacus/core/src/personalization/services/personalization-context.service.ts","ng://@spartacus/core/src/process/store/reducers/index.ts","ng://@spartacus/core/src/state/utils/scoped-loader/entity-scoped-loader.actions.ts","ng://@spartacus/core/src/process/store/process-store.module.ts","ng://@spartacus/core/src/process/process.module.ts","ng://@spartacus/core/src/product/connectors/product/product.connector.ts","ng://@spartacus/core/src/product/connectors/references/product-references.connector.ts","ng://@spartacus/core/src/product/connectors/reviews/product-reviews.connector.ts","ng://@spartacus/core/src/product/connectors/search/product-search.connector.ts","ng://@spartacus/core/src/product/store/actions/product-references.action.ts","ng://@spartacus/core/src/product/store/actions/product-reviews.action.ts","ng://@spartacus/core/src/product/store/actions/product-search.action.ts","ng://@spartacus/core/src/product/store/actions/product.action.ts","ng://@spartacus/core/src/product/store/product-state.ts","ng://@spartacus/core/src/product/store/selectors/feature.selector.ts","ng://@spartacus/core/src/product/store/selectors/product-references.selectors.ts","ng://@spartacus/core/src/product/store/selectors/product-reviews.selectors.ts","ng://@spartacus/core/src/product/store/reducers/product-search.reducer.ts","ng://@spartacus/core/src/product/store/selectors/product-search.selectors.ts","ng://@spartacus/core/src/product/store/selectors/product.selectors.ts","ng://@spartacus/core/src/product/facade/product-reference.service.ts","ng://@spartacus/core/src/product/facade/product-review.service.ts","ng://@spartacus/core/src/product/facade/product-search.service.ts","ng://@spartacus/core/src/product/services/product-loading.service.ts","ng://@spartacus/core/src/product/facade/product.service.ts","ng://@spartacus/core/src/product/facade/searchbox.service.ts","ng://@spartacus/core/src/product/services/category-page-meta.resolver.ts","ng://@spartacus/core/src/product/services/product-page-meta.resolver.ts","ng://@spartacus/core/src/product/services/search-page-meta.resolver.ts","ng://@spartacus/core/src/product/store/effects/product-references.effect.ts","ng://@spartacus/core/src/product/store/effects/product-reviews.effect.ts","ng://@spartacus/core/src/product/store/effects/product-search.effect.ts","ng://@spartacus/core/src/product/store/effects/product.effect.ts","ng://@spartacus/core/src/product/store/effects/index.ts","ng://@spartacus/core/src/product/store/reducers/product-references.reducer.ts","ng://@spartacus/core/src/product/store/reducers/product-reviews.reducer.ts","ng://@spartacus/core/src/state/utils/scoped-loader/scoped-loader.reducer.ts","ng://@spartacus/core/src/state/utils/scoped-loader/entity-scoped-loader.reducer.ts","ng://@spartacus/core/src/product/store/reducers/index.ts","ng://@spartacus/core/src/product/store/product-store.module.ts","ng://@spartacus/core/src/product/product.module.ts","ng://@spartacus/core/src/smart-edit/services/smart-edit.service.ts","ng://@spartacus/core/src/smart-edit/http-interceptors/cms-ticket.interceptor.ts","ng://@spartacus/core/src/smart-edit/http-interceptors/index.ts","ng://@spartacus/core/src/smart-edit/smart-edit.module.ts","ng://@spartacus/core/src/ssr/ng-express-engine-decorator.ts","ng://@spartacus/core/src/store-finder/config/store-finder-config.ts","ng://@spartacus/core/src/store-finder/store/store-finder-state.ts","ng://@spartacus/core/src/store-finder/store/actions/find-stores.action.ts","ng://@spartacus/core/src/store-finder/store/actions/view-all-stores.action.ts","ng://@spartacus/core/src/store-finder/store/selectors/feature.selector.ts","ng://@spartacus/core/src/store-finder/store/selectors/find-stores.selectors.ts","ng://@spartacus/core/src/store-finder/store/selectors/view-all-stores.selectors.ts","ng://@spartacus/core/src/store-finder/facade/store-finder.service.ts","ng://@spartacus/core/src/store-finder/facade/store-data.service.ts","ng://@spartacus/core/src/store-finder/service/external-js-file-loader.service.ts","ng://@spartacus/core/src/store-finder/service/google-map-renderer.service.ts","ng://@spartacus/core/src/store-finder/config/default-store-finder-config.ts","ng://@spartacus/core/src/store-finder/store/reducers/index.ts","ng://@spartacus/core/src/store-finder/store/effects/find-stores.effect.ts","ng://@spartacus/core/src/store-finder/store/effects/view-all-stores.effect.ts","ng://@spartacus/core/src/store-finder/store/effects/index.ts","ng://@spartacus/core/src/store-finder/store/store-finder-store.module.ts","ng://@spartacus/core/src/store-finder/store-finder.module.ts","ng://@spartacus/core/src/user/connectors/user/user.connector.ts","ng://@spartacus/core/src/user/connectors/consent/user-consent.connector.ts","ng://@spartacus/core/src/user/connectors/payment/user-payment.connector.ts","ng://@spartacus/core/src/user/connectors/order/user-order.connector.ts","ng://@spartacus/core/src/user/connectors/customer-coupon/customer-coupon.connector.ts","ng://@spartacus/core/src/user/connectors/interests/user-interests.connector.ts","ng://@spartacus/core/src/user/facade/consent.service.ts","ng://@spartacus/core/src/user/facade/user-address.service.ts","ng://@spartacus/core/src/user/facade/user-order.service.ts","ng://@spartacus/core/src/user/facade/customer-coupon.service.ts","ng://@spartacus/core/src/user/facade/user-payment.service.ts","ng://@spartacus/core/src/user/facade/order-return-request.service.ts","ng://@spartacus/core/src/user/facade/user-notification-preference.service.ts","ng://@spartacus/core/src/user/facade/user-interests.service.ts","ng://@spartacus/core/src/user/store/reducers/billing-countries.reducer.ts","ng://@spartacus/core/src/user/store/reducers/consignment-tracking.reducer.ts","ng://@spartacus/core/src/user/store/reducers/delivery-countries.reducer.ts","ng://@spartacus/core/src/user/store/reducers/notification-preference.reducer.ts","ng://@spartacus/core/src/user/store/reducers/order-details.reducer.ts","ng://@spartacus/core/src/user/store/reducers/payment-methods.reducer.ts","ng://@spartacus/core/src/user/store/reducers/regions.reducer.ts","ng://@spartacus/core/src/user/store/reducers/reset-password.reducer.ts","ng://@spartacus/core/src/user/store/reducers/titles.reducer.ts","ng://@spartacus/core/src/user/store/reducers/user-addresses.reducer.ts","ng://@spartacus/core/src/user/store/reducers/user-consents.reducer.ts","ng://@spartacus/core/src/user/store/reducers/user-details.reducer.ts","ng://@spartacus/core/src/user/store/reducers/user-orders.reducer.ts","ng://@spartacus/core/src/user/store/reducers/customer-coupon.reducer.ts","ng://@spartacus/core/src/user/store/reducers/product-interests.reducer.ts","ng://@spartacus/core/src/user/store/reducers/order-return-request.reducer.ts","ng://@spartacus/core/src/user/store/reducers/index.ts","ng://@spartacus/core/src/user/store/effects/billing-countries.effect.ts","ng://@spartacus/core/src/user/store/effects/clear-miscs-data.effect.ts","ng://@spartacus/core/src/user/store/effects/consignment-tracking.effect.ts","ng://@spartacus/core/src/user/store/effects/delivery-countries.effect.ts","ng://@spartacus/core/src/user/store/effects/forgot-password.effect.ts","ng://@spartacus/core/src/user/store/effects/notification-preference.effect.ts","ng://@spartacus/core/src/user/store/effects/order-details.effect.ts","ng://@spartacus/core/src/user/store/effects/order-return-request.effect.ts","ng://@spartacus/core/src/user/store/effects/payment-methods.effect.ts","ng://@spartacus/core/src/user/store/effects/regions.effect.ts","ng://@spartacus/core/src/user/store/effects/reset-password.effect.ts","ng://@spartacus/core/src/user/store/effects/titles.effect.ts","ng://@spartacus/core/src/user/store/effects/update-email.effect.ts","ng://@spartacus/core/src/user/store/effects/update-password.effect.ts","ng://@spartacus/core/src/user/store/effects/user-addresses.effect.ts","ng://@spartacus/core/src/user/store/effects/user-consents.effect.ts","ng://@spartacus/core/src/user/store/effects/user-details.effect.ts","ng://@spartacus/core/src/user/store/effects/user-orders.effect.ts","ng://@spartacus/core/src/user/store/effects/user-register.effect.ts","ng://@spartacus/core/src/user/store/effects/customer-coupon.effect.ts","ng://@spartacus/core/src/user/store/effects/product-interests.effect.ts","ng://@spartacus/core/src/user/store/effects/index.ts","ng://@spartacus/core/src/user/store/user-store.module.ts","ng://@spartacus/core/src/user/services/find-product-page-meta.resolver.ts","ng://@spartacus/core/src/user/user.module.ts","ng://@spartacus/core/src/state/utils/loader/loader.helpers.ts","ng://@spartacus/core/src/model/shared.model.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","push","__values","o","m","__read","ar","error","__spread","concat","isObject","item","isArray","deepMerge","sources","_i","source","shift","Date","_a","_b","_c","Config","InjectionToken","ConfigChunk","DefaultConfigChunk","provideConfig","config","defaultConfig","provide","useValue","multi","provideConfigFactory","configFactory","deps","useFactory","provideDefaultConfig","provideDefaultConfigFactory","configurationFactory","configChunks","defaultConfigChunks","ConfigModule","withConfig","ngModule","ConfigModule_1","providers","withConfigFactory","forRoot","Optional","NgModule","imports","CommonModule","declarations","OccConfig","_super","SiteContextConfig","AnonymousConsentsConfig","defaultAnonymousConsentsConfig","anonymousConsents","registerConsent","showLegalDescriptionInDialog","requiredConsents","consentManagementPage","showAnonymousConsents","hideConsents","AuthConfig","defaultAuthConfig","authentication","client_id","client_secret","backend","occ","endpoints","login","revoke","USE_CLIENT_TOKEN","InterceptorUtil","createHeader","headerName","interceptorParam","headers","append","JSON","stringify","HttpHeaders","set","removeHeader","request","updatedHeaders","delete","clone","getInterceptorParam","rawValue","get","parse","entityMeta","type","id","entityType","entityId","entityRemoveMeta","entityRemove","entityRemoveAllMeta","EntityRemoveAction","meta","EntityRemoveAllAction","loadMeta","loader","load","failMeta","successMeta","success","resetMeta","LoaderLoadAction","LoaderFailAction","LoaderSuccessAction","LoaderResetAction","entityLoadMeta","entityFailMeta","entitySuccessMeta","entityResetMeta","EntityLoadAction","EntityFailAction","EntitySuccessAction","payload","EntityResetAction","initialLoaderState","loading","undefined","loaderReducer","reducer","state","action","entity","newValue","entityStateSelector","entities","entityValueSelector","initialEntityState","entityReducer","ids","partitionPayload","removed_1","newEntities","keys","reduce","acc","cur","includes","entityUpdates","subAction","newState","entityLoaderReducer","processesIncrementMeta","processesCountDiff","processesDecrementMeta","processesLoaderResetMeta","loaderResetMeta","ProcessesLoaderResetAction","ProcessesIncrementAction","ProcessesDecrementAction","entityProcessesLoaderResetMeta","entityProcessesIncrementMeta","entityProcessesDecrementMeta","EntityProcessesLoaderResetAction","EntityProcessesIncrementAction","EntityProcessesDecrementAction","isStableSelector","processesCount","hasPendingProcessesSelector","initialProcessesState","processesLoaderReducer","loaderState","isDevMode","console","initialProcessesLoaderState","entityHasPendingProcessesSelector","entityIsStableSelector","entityProcessesLoaderStateSelector","entityProcessesLoaderReducer","entitySelector","getStateSliceValue","split","previous","current","createShellObject","excludeKeys","shell","reduceRight","exclusionKeys","excludeKeys_1","excludeKeys_1_1","exclusionKey","getExclusionKeys","finalValue","exclusionKeys_1","exclusionKeys_1_1","exclusionChunksSplit","nestedTemp","currentChunk","handleExclusions","getStateSlice","stateSlices","keys_1","keys_1_1","currentKey","filterKeysByType","filter","loaderValueSelector","loaderLoadingSelector","loaderErrorSelector","loaderSuccessSelector","LoadClientToken","_this","StateLoaderActions.LoaderLoadAction","LoadClientTokenFail","StateLoaderActions.LoaderFailAction","LoadClientTokenSuccess","StateLoaderActions.LoaderSuccessAction","LOGIN","LOGOUT","Login","Logout","LOAD_USER_TOKEN","LOAD_USER_TOKEN_SUCCESS","LoadUserToken","LoadUserTokenFail","LoadUserTokenSuccess","RefreshUserToken","RefreshUserTokenSuccess","RefreshUserTokenFail","RevokeUserToken","RevokeUserTokenSuccess","RevokeUserTokenFail","getAuthState","createFeatureSelector","clientToken","getClientTokenState","createSelector","ɵ0","getUserTokenSelector","token","userToken","getUserTokenState","ɵ1","getUserToken","AuthService","store","authorize","userId","password","dispatch","AuthActions.LoadUserToken","getOccUserId","pipe","map","select","AuthSelectors.getUserToken","refreshUserToken","AuthActions.RefreshUserToken","refreshToken","refresh_token","authorizeWithToken","AuthActions.LoadUserTokenSuccess","logout","take","subscribe","AuthActions.Logout","Boolean","AuthActions.RevokeUserToken","getClientToken","AuthSelectors.getClientTokenState","isClientTokenLoaded","AuthActions.LoadClientToken","refreshClientToken","isUserLoggedIn","access_token","Store","Injectable","providedIn","ClientErrorHandlingService","authService","handleExpiredClientToken","switchMap","handle","createNewRequestWithNewToken","setHeaders","Authorization","token_type","WindowRef","document","window","nativeWindow","sessionStorage","localStorage","fromEvent","debounceTime","startWith","distinctUntilChanged","of","Inject","args","DOCUMENT","UrlParsingService","router","getPrimarySegments","url","urlTree","parseUrl","_getPrimarySegmentsFromUrlTree","root","tree","segments","path","childrenSegments","children","PRIMARY_OUTLET","Router","isParam","segment","startsWith","getParamName","slice","RoutingConfigService","getRouteConfig","routeName","routeConfig","routing","routes","warn","RoutingConfig","SemanticPathService","routingConfigService","urlParser","ROOT_URL","paths","transform","commands","commands_1","commands_1_1","command","isRouteCommand","partialResult","generateUrlPart","shouldOutputAbsolute","unshift","cxRoute","standarizeRouteCommand","findPathWithFillableParams","params","provideParamsValues","paramsMapping","paramName","mappedParamName","getMappedParamName","foundPath","find","getParams","every","RouteGoAction","RouteGoByUrlAction","RouteBackAction","RouteForwardAction","getRouterFeatureState","getRouterState","ɵ0$2","routingState","context","getPageContext","ɵ1$1","nextState","getNextPageContext","ɵ2","isNavigating","ɵ3","RoutingService","winRef","semanticPathService","RoutingSelector.getRouterState","RoutingSelector.getPageContext","RoutingSelector.getNextPageContext","RoutingSelector.isNavigating","go","query","extras","navigate","goByUrl","RoutingActions.RouteGoByUrlAction","back","referrer","location","origin","RoutingActions.RouteBackAction","forward","RoutingActions.RouteForwardAction","RoutingActions.RouteGoAction","UserErrorHandlingService","routingService","handleExpiredUserToken","handleExpiredToken","handleExpiredRefreshToken","oldToken","tap","AuthErrorInterceptor","userErrorHandlingService","clientErrorHandlingService","intercept","isClientTokenRequest","catchError","errResponse","HttpErrorResponse","status","isExpiredToken","throwError","isRequestMapping","resp","errors","DynamicTemplate","templateString","templateVariables","variableLabel","placeholder","RegExp","replace","getContextParameterValues","parameter","getContextParameterDefault","param","StorageSyncType","LOAD_BASE_SITE","LoadBaseSite","LoadBaseSiteFail","LoadBaseSiteSuccess","SetActiveBaseSite","BaseSiteChange","LOAD_CURRENCIES","SET_ACTIVE_CURRENCY","CURRENCY_CHANGE","LoadCurrencies","LoadCurrenciesFail","LoadCurrenciesSuccess","SetActiveCurrency","CurrencyChange","LOAD_LANGUAGES","SET_ACTIVE_LANGUAGE","LANGUAGE_CHANGE","LoadLanguages","LoadLanguagesFail","LoadLanguagesSuccess","SetActiveLanguage","LanguageChange","getSiteContextState","baseSite","activeSite","getActiveBaseSite","ɵ0$3","details","getBaseSiteData","ɵ1$2","currenciesEntitiesSelector","activeCurrencySelector","activeCurrency","currencies","getCurrenciesState","ɵ2$1","getCurrenciesEntities","getActiveCurrency","isocode","getAllCurrencies","ɵ3$1","activeLanguageSelector","activeLanguage","languagesEntitiesSelector","getLanguagesState","languages","getLanguagesEntities","getActiveLanguage","getAllLanguages","BaseSiteService","getActive","SiteContextSelectors.getActiveBaseSite","active","getAll","setActive","activeBaseSite","SiteContextActions.SetActiveBaseSite","initialize","SiteContextSelectors.getBaseSiteData","SiteContextActions.LoadBaseSite","OccEndpointsService","baseSiteService","SCOPE_SUFFIX","getRawEndpoint","endpoint","baseUrl","getBaseEndpoint","prefix","getEndpoint","getUrl","urlParams","queryParams","scope","getEndpointForScope","forEach","encodeURIComponent","httpParamsOptions","fromString","httpParams_1","HttpParams","toString","endpointsConfig","endpointConfig","ClientTokenInterceptor","occEndpoints","UserTokenInterceptor","isOccUrl","TokenRevocationInterceptor","isTokenRevocationRequest","EMPTY","isTokenRevocationHeaderPresent","interceptors","HTTP_INTERCEPTORS","useExisting","ClientAuthenticationTokenService","http","occEndpointsService","loadClientAuthenticationToken","Content-Type","post","HttpClient","UserAuthenticationTokenService","loadToken","encodeURI","AuthServices","StateTransferType","StateConfig","defaultStateConfig","storageSync","localStorageKeyName","sessionStorageKeyName","getStorageSyncReducer","storageSyncConfig","INIT","UPDATE","rehydratedState","localStorageValue","readFromStorage","sessionStorageValue","rehydrate","localStorageStateSlices","LOCAL_STORAGE","persistToStorage","sessionStorageStateSlices","SESSION_STORAGE","configKey","storage","isSsr","setItem","storageValue","getItem","CX_KEY","makeStateKey","getTransferStateReducer","platformId","transferState","ssrTransfer","isPlatformBrowser","transferStateKeys","TRANSFER_STATE","authState","hasKey","cxKey","getBrowserTransferStateReducer","isPlatformServer","stateSlice","getServerTransferStateReducer","TRANSFER_STATE_META_REDUCER","STORAGE_SYNC_META_REDUCER","ɵ1$5","stateMetaReducers","PLATFORM_ID","TransferState","META_REDUCERS","StateModule","StateModule_1","UNKNOWN_ERROR","circularReplacer","seen","WeakSet","_key","has","add","makeErrorSerializable","Error","message","name","reason","stack","serializableError","statusText","ClientTokenEffect","actions$","clientAuthenticationTokenService","loadClientToken$","ofType","exhaustMap","AuthActions.LoadClientTokenSuccess","AuthActions.LoadClientTokenFail","Actions","Effect","UserTokenEffects","userTokenService","loadUserToken$","AuthActions.LOAD_USER_TOKEN","mergeMap","date","setSeconds","getSeconds","expires_in","expiration_time","toJSON","AuthActions.LoadUserTokenFail","login$","AuthActions.LOAD_USER_TOKEN_SUCCESS","AuthActions.Login","refreshUserToken$","AuthActions.RefreshUserTokenSuccess","AuthActions.RefreshUserTokenFail","revokeUserToken$","AuthActions.RevokeUserTokenSuccess","AuthActions.RevokeUserTokenFail","effects","initialState","getReducers","combineReducers","fromUserTokenReducer.reducer","reducerToken","reducerProvider","clearAuthState","AuthActions.LOGOUT","metaReducers","authStoreConfigFactory","auth.userToken.token.access_token","auth.userToken.token.token_type","auth.userToken.token.expires_in","auth.userToken.token.expiration_time","auth.userToken.token.scope","auth.userToken.token.userId","CountryType","PromotionLocation","PageType","CmsBannerCarouselEffect","ANONYMOUS_CONSENT_STATUS","ImageType","VariantType","PriceType","VariantQualifier","AuthStoreModule","HttpClientModule","StoreModule","forFeature","EffectsModule","AuthModule","AuthModule_1","AuthRedirectService","ignoredUrls","Set","redirect","redirectUrl","lastAuthGuardNavigation","reportAuthGuard","getCurrentNavigation","navigationId","reportNotAuthGuard","initialUrl","navigation","serializeUrl","finalUrl","AuthGuard","authRedirectService","canActivate","NotAuthGuard","NotificationType","ANONYMOUS_CONSENTS","LoadAnonymousConsentTemplates","LoadAnonymousConsentTemplatesSuccess","LoadAnonymousConsentTemplatesFail","ResetLoadAnonymousConsentTemplates","StateLoaderActions.LoaderResetAction","GetAllAnonymousConsents","GetAnonymousConsent","templateCode","SetAnonymousConsents","GiveAnonymousConsent","WithdrawAnonymousConsent","ToggleAnonymousConsentsBannerDissmissed","dismissed","ToggleAnonymousConsentTemplatesUpdated","updated","getAnonymousConsentState","templates","getAnonymousConsentTemplatesState","ɵ0$8","getAnonymousConsentTemplatesValue","StateLoaderSelectors.loaderValueSelector","getAnonymousConsentTemplatesLoading","StateLoaderSelectors.loaderLoadingSelector","getAnonymousConsentTemplatesSuccess","StateLoaderSelectors.loaderSuccessSelector","getAnonymousConsentTemplatesError","StateLoaderSelectors.loaderErrorSelector","getAnonymousConsentTemplate","template","getAnonymousConsentTemplatesUpdate","ui","bannerDismissed","getAnonymousConsentsBannerDismissed","ɵ1$6","getAnonymousConsents","consents","getAnonymousConsentByTemplateCode","consent","AnonymousConsentsService","loadTemplates","AnonymousConsentsActions.LoadAnonymousConsentTemplates","getTemplates","loadIfMissing","iif","AnonymousConsentsSelectors.getAnonymousConsentTemplatesValue","withLatestFrom","getLoadTemplatesLoading","getTemplate","AnonymousConsentsSelectors.getAnonymousConsentTemplate","AnonymousConsentsSelectors.getAnonymousConsentTemplatesLoading","getLoadTemplatesSuccess","AnonymousConsentsSelectors.getAnonymousConsentTemplatesSuccess","getLoadTemplatesError","AnonymousConsentsSelectors.getAnonymousConsentTemplatesError","resetLoadTemplatesState","AnonymousConsentsActions.ResetLoadAnonymousConsentTemplates","getConsents","AnonymousConsentsSelectors.getAnonymousConsents","setConsents","AnonymousConsentsActions.SetAnonymousConsents","getConsent","templateId","authenticated","AnonymousConsentsSelectors.getAnonymousConsentByTemplateCode","giveConsent","AnonymousConsentsActions.GiveAnonymousConsent","giveAllConsents","isConsentGiven","consentState","GIVEN","withdrawConsent","AnonymousConsentsActions.WithdrawAnonymousConsent","withdrawAllConsents","isConsentWithdrawn","WITHDRAWN","toggleBannerDismissed","AnonymousConsentsActions.ToggleAnonymousConsentsBannerDissmissed","toggleTemplatesUpdated","isBannerDismissed","AnonymousConsentsSelectors.getAnonymousConsentsBannerDismissed","getTemplatesUpdated","AnonymousConsentsSelectors.getAnonymousConsentTemplatesUpdate","AnonymousConsentsActions.ToggleAnonymousConsentTemplatesUpdated","isBannerVisible","combineLatest","detectUpdatedTemplates","currentTemplates","newTemplates","newTemplate","currentTemplate","version","serializeAndEncode","serialized","decodeAndDeserialize","rawConsents","decoded","decodeURIComponent","consentsUpdated","newConsents","previousConsents","isFeatureConfig","features","isInLevel","level","levelParts","versionParts","versionNumberPart","Number","levelNumberPart","isFeatureLevel","substr","isFeatureEnabled","feature","featureConfig","DeferLoadingStrategy","FeatureConfigService","isLevel","isEnabled","FeaturesConfig","FeatureLevelDirective","templateRef","viewContainer","hasView","createEmbeddedView","clear","TemplateRef","ViewContainerRef","Input","Directive","selector","FeatureDirective","FeaturesConfigModule","defaultLevel","FeaturesConfigModule_1","exports","defaultOccAsmConfig","asmCustomerSearch","AsmConfig","CUSTOMER_SEARCH_PAGE_NORMALIZER","ConverterService","injector","converters","Map","getConverters","injectionToken","hasConverters","pipeable","model","convertSource","observable","pipeableMany","convertMany","convert","converter","Injector","OccAsmAdapter","converterService","customerSearch","options","pageSize","AsmOccModule","AsmAdapter","useClass","CART_NORMALIZER","PRODUCT_NORMALIZER","OccCartNormalizer","entries","entry","product","removeDuplicatePromotions","potentialOrderPromotions","removeDuplicateItems","potentialProductPromotions","appliedOrderPromotions","appliedProductPromotions","itemList","a","el","indexOf","defaultOccCartConfig","carts","cart","createCart","addEntries","updateEntries","removeEntries","addEmail","deleteCart","cartVoucher","saveCart","CART_MODIFICATION_NORMALIZER","OccCartEntryAdapter","featureConfigService","getCartEndpoint","cartEndpoint","cartId","productCode","quantity","toAdd","legacyAdd","code","qty","update","entryNumber","pickupStore","legacyUpdate","patch","remove","legacyRemove","queryString","CART_VOUCHER_NORMALIZER","OccCartVoucherAdapter","getCartVoucherEndpoint","getHeaders","voucherId","json","DETAILS_PARAMS","OccCartAdapter","loadAll","pluck","legacyLoadAll","legacyLoad","oldCartId","toMergeCartGuid","legacyCreate","email","httpParams","put","SAVE_CART_NORMALIZER","OccSaveCartAdapter","saveCartName","saveCartDescription","CartOccModule","CartAdapter","CartEntryAdapter","CartVoucherAdapter","SaveCartAdapter","ORDER_NORMALIZER","OccCheckoutAdapter","subEndpoint","orderEndpoint","placeOrder","loadCheckoutDetails","clearCheckoutDeliveryAddress","clearCheckoutDeliveryMode","DELIVERY_MODE_NORMALIZER","ADDRESS_NORMALIZER","ADDRESS_SERIALIZER","ADDRESS_VALIDATION_NORMALIZER","OccCheckoutDeliveryAdapter","createAddress","address","setAddress","addressId","setMode","deliveryModeId","getMode","getSupportedModes","PAYMENT_DETAILS_NORMALIZER","PAYMENT_DETAILS_SERIALIZER","CARD_TYPE_NORMALIZER","CustomEncoder","encodeKey","encodeValue","decodeKey","decodeValue","OccCheckoutPaymentAdapter","DOMParser","domparser","paymentDetails","getProviderSubInfo","data","labelsMap","convertToMap","mappingLabels","postUrl","parameters","getParamsForPaymentProvider","sub","createSubWithProvider","response","extractPaymentDetailsFromHtml","fromPaymentProvider","defaultPayment","createDetailsWithParameters","paymentDetailsId","loadCardTypes","cardTypeList","cardTypes","Accept","encoder","responseType","accountHolderName","cardType","cardNumber","expiryMonth","expiryYear","cvn","billingAddress","country","firstName","lastName","line1","line2","town","region","isocodeShort","postalCode","html","inputs","parseFromString","getElementsByTagName","values","input","getAttribute","paramList","OccOrderNormalizer","convertOrderEntry","consignments","consignment","orderEntry","unconsignedEntries","CheckoutOccModule","CheckoutAdapter","CheckoutDeliveryAdapter","CheckoutPaymentAdapter","CMS_PAGE_NORMALIZER","OccCmsPageAdapter","pageContext","fields","getPagesRequestParams","getPagesEndpoint","pageType","CONTENT_PAGE","CMS_COMPONENT_NORMALIZER","OccCmsComponentAdapter","getComponentEndPoint","findComponentsByIds","currentPage","sort","requestParams","getContextParams","getPaginationParams","getComponentsEndpoint","findComponentsByIdsLegacy","idList","PRODUCT_PAGE","CATEGORY_PAGE","categoryCode","CATALOG_PAGE","catalogCode","CmsConfig","OccCmsPageNormalizer","normalizePageData","normalizePageSlotData","normalizePageComponentData","normalizeComponentData","page","loadTime","now","typeCode","title","pageId","uid","slots","properties","contentSlots","contentSlot","slot","position","components","_d","component","_e","e_3","_f","comp","flexType","e_5","CmsPageAdapter","CmsOccModule","CmsComponentAdapter","ProductImageNormalizer","images","normalize","source_1","source_1_1","image","isList","imageType","imageContainer","galleryIndex","targetImage","normalizeImageUrl","format","test","media","ProductReferenceNormalizer","productReferences","references","reference","referenceType","OccProductSearchPageNormalizer","DEFAULT_TOP_VALUES","normalizeFacets","products","normalizeFacetValues","normalizeUselessFacets","facets","facet","pagination","totalResults","visible","selected","count","facetSource","topValues","facetTarget","getOwnPropertySymbols","propertyIsEnumerable","__rest","topValueCount","OccProductReferencesListNormalizer","ProductNameNormalizer","nameHtml","PRODUCT_REFERENCES_NORMALIZER","OccProductReferencesAdapter","PRODUCT_REVIEW_NORMALIZER","PRODUCT_REVIEW_SERIALIZER","OccProductReviewsAdapter","maxCount","review","URLSearchParams","headline","comment","rating","alias","PRODUCT_SEARCH_PAGE_NORMALIZER","PRODUCT_SUGGESTION_NORMALIZER","DEFAULT_SEARCH_CONFIG","OccProductSearchAdapter","search","searchConfig","getSearchEndpoint","loadSuggestions","term","getSuggestionEndpoint","sortCode","max","mergeFields","parsedFields","parseFields","stringifyFields","subFields","join","optimizeFields","startIndex","extractFields","getObjectPart","ProductScope","OccFieldsService","FIELDS_PARAM","getOptimalUrlGroups","models","groupedByUrls","splitFields","urlPart","scopedData","mergedUrls","_g","_h","group","getUrlWithFields","lo","urlWithFields","paramsMap","keyValue","nonFields","par","mergedFields","OccRequestsOptimizerService","occFields","scopedDataLoad","scopedDataWithUrls","dataFactory","groupedModelsSet","groupedModels","data$","data$_1","shareReplay","modelData","OccProductAdapter","requestsOptimizer","loadMany","scopedProduct","defaultOccProductConfig","product_scopes","list","attributes","variants","productReviews","productSearch","productSuggestions","loadingScopes","include","LIST","VARIANTS","ProductOccModule","ProductAdapter","ProductReferencesAdapter","ProductSearchAdapter","ProductReviewsAdapter","LANGUAGE_NORMALIZER","CURRENCY_NORMALIZER","COUNTRY_NORMALIZER","REGION_NORMALIZER","OccSiteAdapter","loadLanguages","languageList","loadCurrencies","currencyList","loadCountries","countryList","countries","loadRegions","countryIsoCode","isoCode","regionList","regions","loadBaseSite","urlSplits","siteList","baseSites","site","defaultOccSiteContextConfig","CurrencyService","SiteContextSelectors.getAllCurrencies","SiteContextActions.LoadCurrencies","currenies","SiteContextSelectors.getActiveCurrency","SiteContextActions.SetActiveCurrency","sessionCurrency","LanguageService","SiteContextSelectors.getAllLanguages","SiteContextActions.LoadLanguages","SiteContextSelectors.getActiveLanguage","SiteContextActions.SetActiveLanguage","sessionLanguage","SiteContextInterceptor","languageService","currencyService","activeLang","activeCurr","setParams","lang","curr","SiteContextOccModule","SiteAdapter","defaultOccStoreFinderConfig","stores","storescounts","StoreFinderConnector","adapter","longitudeLatitude","getCounts","loadCounts","storeId","StoreFinderAdapter","POINT_OF_SERVICE_NORMALIZER","STORE_FINDER_SEARCH_PAGE_NORMALIZER","STORE_COUNT_NORMALIZER","OccStoreFinderAdapter","callOccFindStores","countriesAndRegionsStoreCount","String","longitude","latitude","StoreFinderOccModule","CONSENT_TEMPLATE_NORMALIZER","OccAnonymousConsentTemplatesAdapter","loadAnonymousConsentTemplates","consentList","consentTemplates","OccUserAddressAdapter","addressList","addresses","verify","OccUserConsentAdapter","loadConsents","Cache-Control","consentTemplateId","consentTemplateVersion","consentCode","consentId","ORDER_HISTORY_NORMALIZER","CONSIGNMENT_TRACKING_NORMALIZER","ORDER_RETURN_REQUEST_NORMALIZER","ORDER_RETURN_REQUEST_INPUT_SERIALIZER","ORDER_RETURNS_NORMALIZER","OccUserOrderAdapter","getOrderEndpoint","orderCode","orderId","loadHistory","legacyLoadHistory","getConsignmentTracking","consignmentCode","cancel","cancelRequestInput","createReturnRequest","returnRequestInput","loadReturnRequestList","loadReturnRequestDetail","returnRequestCode","cancelReturnRequest","returnRequestModification","OccUserPaymentAdapter","methodList","payments","paymentMethodID","paymentDetailId","setDefault","titleCode","USER_NORMALIZER","USER_SERIALIZER","USER_SIGN_UP_SERIALIZER","TITLE_NORMALIZER","OccUserAdapter","user","register","registerGuest","guid","requestForgotPasswordEmail","userEmailAddress","resetPassword","newPassword","updateEmail","currentPassword","newUserId","updatePassword","oldPassword","loadTitles","titleList","titles","defaultOccUserConfig","userRegister","userForgotPassword","userResetPassword","userUpdateLoginId","userUpdatePassword","paymentDetailsAll","paymentDetail","orderHistory","orderDetail","anonymousConsentTemplates","consentDetail","addressDetail","addressVerification","consignmentTracking","customerCoupons","claimCoupon","couponNotification","notificationPreference","productInterests","getProductInterests","cancelOrder","returnOrder","orderReturns","orderReturnDetail","cancelReturn","CUSTOMER_COUPON_SEARCH_RESULT_NORMALIZER","OccCustomerCouponAdapter","getCustomerCoupons","newHttpHeader","turnOffNotification","couponCode","turnOnNotification","claimCustomerCoupon","NOTIFICATION_PREFERENCE_SERIALIZER","NOTIFICATION_PREFERENCE_NORMALIZER","UserNotificationPreferenceConnector","preferences","UserNotificationPreferenceAdapter","OccUserNotificationPreferenceAdapter","PRODUCT_INTERESTS_NORMALIZER","OccUserInterestsAdapter","getInterests","notificationType","headers$1","removeInterest","productInterestEntry","interestType","forkJoin","addInterest","OccUserInterestsNormalizer","results","OccReturnRequestNormalizer","returnEntries","UserOccModule","UserAdapter","UserAddressAdapter","UserConsentAdapter","AnonymousConsentTemplatesAdapter","UserPaymentAdapter","UserOrderAdapter","CustomerCouponAdapter","UserInterestsAdapter","JavaRegExpConverter","EXTRACT_JAVA_REGEXP_MODIFIERS","toJsRegExp","javaSyntax","parts","match","modifiers","jsSyntax","CONFIG_INITIALIZER","CONFIG_INITIALIZER_FORROOT_GUARD","SERVER_REQUEST_URL","SERVER_REQUEST_ORIGIN","OccLoadedConfigConverter","javaRegExpConverter","fromOccBaseSites","currentUrl","isCurrentBaseSite","getError","baseStore","getIsoCodes","defaultLanguage","defaultCurrency","urlParameters","getUrlParams","urlEncodingAttributes","toSiteContextConfig","toI18nConfig","i18n","fallbackLang","urlPatterns","findIndex","javaRegexp","jsRegexp","elements","defaultElement","moveToFirst","array","predicate","index","splice","OccSitesConfigLoader","baseEndpoint","EXTERNAL_CONFIG_TRANSFER_ID","OccConfigLoaderService","platform","sitesConfigLoader","serverRequestUrl","href","loadConfig","externalConfig","transfer","getConfigChunks","toPromise","rehydratedExternalConfig","chunks","shouldReturnI18nChunk","fallbackLangExists","initConfig","configLoader","scopes","OccConfigLoaderModule","OccConfigLoaderModule_1","occServerConfigFromMetaTagFactory","getMetaTagContent","mediaServerConfigFromMetaTagFactory","metaTag","getTag","content","CONSENT_STATUS","Type","Fields61","Fields60","Fields59","Fields58","Fields57","Fields56","Fields55","Fields54","Fields53","Fields52","Fields51","Fields50","Fields49","Fields48","Fields47","Fields46","Fields45","Fields44","Fields43","Fields42","Fields41","Fields40","Fields39","Fields38","Fields37","Fields36","Fields35","Fields34","Fields33","Fields32","Fields31","Fields30","Fields29","Fields28","Fields27","Fields26","Fields25","Fields24","Fields23","Fields22","Fields21","Fields20","Fields19","Fields18","Fields17","SortEnum","Fields16","Fields15","Fields14","Fields13","Fields12","Fields11","Fields10","Fields9","Fields8","Fields7","Fields6","Fields5","Fields4","Fields3","Fields2","Fields1","Fields","Occ","defaultOccConfig","occConfigValidator","ConfigValidatorToken","provideConfigValidator","configValidator","validateConfig","configValidators","configValidators_1","configValidators_1_1","warning","validate","OccModule","OccModule_1","LoadingScopesService","expand","scopesConfig","expandedScopes","includedScopes","includedScopes_1","e_1","includedScopes_1_1","includedScope","getMaxAge","maxAge","AnonymousConsentsInterceptor","anonymousConsentsService","clonedRequest","handleRequest","event","HttpResponse","handleResponse","newRawConsents","giveRequiredConsents","givenConsents","givenConsents_1","givenConsents_1_1","StatePersistenceService","syncWithStorage","state$","context$","rxjs","storageType","onRead","NO_STORAGE","getStorage","subscriptions","Subscription","generateKeyWithContext","getProcessStateFactory","processId","entityState","StateEntityLoaderSelectors.entityStateSelector","getProcessLoadingFactory","getProcessSuccessFactory","getProcessErrorFactory","LoadBillingCountries","LoadBillingCountriesFail","LoadBillingCountriesSuccess","LoadConsignmentTracking","LoadConsignmentTrackingFail","LoadConsignmentTrackingSuccess","ClearConsignmentTracking","LoadDeliveryCountries","LoadDeliveryCountriesFail","LoadDeliveryCountriesSuccess","ForgotPasswordEmailRequest","ForgotPasswordEmailRequestFail","ForgotPasswordEmailRequestSuccess","USER_CONSENTS","USER_PAYMENT_METHODS","USER_ORDERS","USER_ADDRESSES","USER_RETURN_REQUESTS","USER_ORDER_DETAILS","REGIONS","CUSTOMER_COUPONS","PRODUCT_INTERESTS","LoadOrderDetails","LoadOrderDetailsFail","LoadOrderDetailsSuccess","ClearOrderDetails","CancelOrder","StateEntityLoaderActions.EntityLoadAction","CancelOrderFail","StateEntityLoaderActions.EntityFailAction","CancelOrderSuccess","StateEntityLoaderActions.EntitySuccessAction","ResetCancelOrderProcess","StateEntityLoaderActions.EntityResetAction","LoadUserPaymentMethods","LoadUserPaymentMethodsFail","LoadUserPaymentMethodsSuccess","SetDefaultUserPaymentMethod","SetDefaultUserPaymentMethodFail","SetDefaultUserPaymentMethodSuccess","DeleteUserPaymentMethod","DeleteUserPaymentMethodFail","DeleteUserPaymentMethodSuccess","LoadRegions","LoadRegionsFail","LoadRegionsSuccess","ClearRegions","ResetPassword","ResetPasswordFail","ResetPasswordSuccess","LoadTitles","LoadTitlesFail","LoadTitlesSuccess","UpdateEmailAction","UpdateEmailSuccessAction","newUid","UpdateEmailErrorAction","ResetUpdateEmailAction","UpdatePassword","UpdatePasswordFail","UpdatePasswordSuccess","UpdatePasswordReset","LoadUserAddresses","LoadUserAddressesFail","LoadUserAddressesSuccess","AddUserAddress","AddUserAddressFail","AddUserAddressSuccess","UpdateUserAddress","UpdateUserAddressFail","UpdateUserAddressSuccess","DeleteUserAddress","DeleteUserAddressFail","DeleteUserAddressSuccess","LoadUserConsents","LoadUserConsentsFail","LoadUserConsentsSuccess","ResetLoadUserConsents","GiveUserConsent","GiveUserConsentFail","GiveUserConsentSuccess","consentTemplate","ResetGiveUserConsentProcess","TransferAnonymousConsent","WithdrawUserConsent","WithdrawUserConsentFail","WithdrawUserConsentSuccess","ResetWithdrawUserConsentProcess","LoadUserDetails","LoadUserDetailsFail","LoadUserDetailsSuccess","UpdateUserDetails","UpdateUserDetailsFail","UpdateUserDetailsSuccess","userUpdates","ResetUpdateUserDetails","ClearUserMiscsData","LoadUserOrders","LoadUserOrdersFail","LoadUserOrdersSuccess","ClearUserOrders","RegisterUser","RegisterUserFail","RegisterUserSuccess","ResetRegisterUserProcess","RegisterGuest","RegisterGuestFail","RegisterGuestSuccess","RemoveUser","RemoveUserFail","RemoveUserSuccess","RemoveUserReset","LoadCustomerCoupons","LoadCustomerCouponsFail","LoadCustomerCouponsSuccess","ResetLoadCustomerCoupons","SubscribeCustomerCoupon","SubscribeCustomerCouponFail","SubscribeCustomerCouponSuccess","ResetSubscribeCustomerCouponProcess","UnsubscribeCustomerCoupon","UnsubscribeCustomerCouponFail","UnsubscribeCustomerCouponSuccess","ResetUnsubscribeCustomerCouponProcess","ClaimCustomerCoupon","ClaimCustomerCouponFail","ClaimCustomerCouponSuccess","LoadNotificationPreferences","LoadNotificationPreferencesFail","LoadNotificationPreferencesSuccess","UpdateNotificationPreferences","UpdateNotificationPreferencesFail","UpdateNotificationPreferencesSuccess","ResetNotificationPreferences","ClearNotificationPreferences","LoadProductInterests","LoadProductInterestsFail","LoadProductInterestsSuccess","RemoveProductInterest","RemoveProductInterestSuccess","RemoveProductInterestFail","AddProductInterest","AddProductInterestSuccess","AddProductInterestFail","ResetAddInterestState","ResetRemoveInterestState","ClearProductInterests","CreateOrderReturnRequest","CreateOrderReturnRequestFail","CreateOrderReturnRequestSuccess","LoadOrderReturnRequest","LoadOrderReturnRequestFail","LoadOrderReturnRequestSuccess","CancelOrderReturnRequest","CancelOrderReturnRequestFail","CancelOrderReturnRequestSuccess","LoadOrderReturnRequestList","LoadOrderReturnRequestListFail","LoadOrderReturnRequestListSuccess","ClearOrderReturnRequest","ClearOrderReturnRequestList","ResetCancelReturnProcess","getUserState","billingCountries","getBillingCountriesState","ɵ0$b","getBillingCountriesEntites","ɵ1$7","entites","getAllBillingCountries","ɵ2$3","getConsignmentTrackingState","tracking","getDeliveryCountriesState","getDeliveryCountriesEntites","getAllDeliveryCountries","countrySelectorFactory","getOrderState","order","getOrderDetails","getOrderReturnRequestState","orderReturn","getOrderReturnRequest","getOrderReturnRequestLoading","getOrderReturnRequestSuccess","ɵ3$3","orderReturnList","getOrderReturnRequestListState","ɵ4","getOrderReturnRequestList","ɵ5","getPaymentMethodsState","getPaymentMethods","getPaymentMethodsLoading","getPaymentMethodsLoadedSuccess","getRegionsLoaderState","getAllRegions","getRegionsDataAndLoading","loaded","getRegionsCountry","getRegionsLoading","getRegionsLoaded","getResetPassword","getTitlesState","getTitlesEntites","getAllTitles","getAddressesLoaderState","getAddresses","getAddressesLoading","getAddressesLoadedSuccess","getConsentsState","getConsentsValue","getConsentByTemplateId","getConsentsLoading","getConsentsSuccess","getConsentsError","getDetailsState","account","getDetails","getOrdersState","orders","getOrdersLoaded","getOrders","getCustomerCouponsState","getCustomerCouponsLoaded","getCustomerCouponsLoading","getPreferencesLoaderState","notificationPreferences","getPreferences","getEnabledPreferences","enabled","getPreferencesLoading","getInterestsState","getInterestsLoading","UserConsentService","withUserId","UserActions.LoadUserConsents","UsersSelectors.getConsentsValue","getConsentsResultLoading","getConsentsResultSuccess","UsersSelectors.getConsentsLoading","UsersSelectors.getConsentsSuccess","getConsentsResultError","UsersSelectors.getConsentsError","resetConsentsProcessState","UserActions.ResetLoadUserConsents","UsersSelectors.getConsentByTemplateId","currentConsent","consentGivenDate","consentWithdrawnDate","UserActions.GiveUserConsent","getGiveConsentResultLoading","getGiveConsentResultSuccess","getGiveConsentResultError","resetGiveConsentProcessState","UserActions.ResetGiveUserConsentProcess","UserActions.WithdrawUserConsent","getWithdrawConsentResultLoading","getWithdrawConsentResultSuccess","getWithdrawConsentResultError","resetWithdrawConsentProcessState","UserActions.ResetWithdrawUserConsentProcess","filterConsentTemplates","templateList","hideTemplateIds","updatedTemplateList","templateList_1","templateList_1_1","callback","AnonymousConsentTemplatesConnector","AnonymousConsentsEffects","anonymousConsentTemplatesConnector","anonymousConsentsConfig","anonymousConsentService","userConsentService","loadAnonymousConsentTemplates$","concatMap","newConsentTemplates","currentConsentTemplates","AnonymousConsentsActions.LoadAnonymousConsentTemplatesSuccess","AnonymousConsentsActions.LoadAnonymousConsentTemplatesFail","transferAnonymousConsentsToUser$","registerAction","actions","consents_1","consents_1_1","templates_1","e_2","templates_1_1","UserActions.TransferAnonymousConsent","giveRequiredConsentsToUser$","templates_2","templates_2_1","SiteConnector","getLanguages","getCurrencies","getCountries","getRegions","getBaseSite","serviceMapFactory","contextServiceMapProvider","ContextServiceMap","baseSiteConfigValidator","defaultSiteContextConfigFactory","ConfigInitializerService","initializerGuard","ongoingScopes$","BehaviorSubject","getStableConfig","isStable","ongoingScopes","areReady","mapTo","finishScopes","newScopes","scopes_1","scopes_1_1","scopes_2","scopes_2_1","ongoingScopes_1","ongoingScopes_1_1","ongoingScope","scopesOverlap","initializers","asyncConfigs","initializer","this_1","all","initializeContext","langService","currService","configInit","contextServiceProviders","APP_INITIALIZER","SiteContextParamsService","serviceMap","getContextParameters","getUrlEncodingParameters","getParamValues","getParamDefaultValue","getSiteContextService","getValue","service","val","unsubscribe","setValue","getValues","UrlSplit","SiteContextUrlSerializer","siteContextParams","urlEncodingParameters","hasContextInRoutes","urlWithParams","urlExtractContextParameters","parsed","urlTreeIncludeContextParameters","queryPart","paramId","segmentId","siteContext","serialize","urlTreeExtractContextParameters","urlIncludeContextParameters","DefaultUrlSerializer","SiteContextRoutesHandler","serializer","subscription","contextValues","init","Location","routingParams","setContextParamsFromRoute","subscribeChanges","subscribeRouting","replaceState","events","NavigationStart","NavigationEnd","NavigationError","NavigationCancel","ngOnDestroy","initSiteContextRoutesHandler","siteContextRoutesHandler","siteContextParamsProviders","UrlSerializer","LanguagesEffects","siteConnector","loadLanguages$","SiteContextActions.LOAD_LANGUAGES","SiteContextActions.LoadLanguagesSuccess","SiteContextActions.LoadLanguagesFail","activateLanguage$","SiteContextActions.SET_ACTIVE_LANGUAGE","SiteContextActions.LanguageChange","CurrenciesEffects","loadCurrencies$","SiteContextActions.LOAD_CURRENCIES","SiteContextActions.LoadCurrenciesSuccess","SiteContextActions.LoadCurrenciesFail","activateCurrency$","SiteContextActions.SET_ACTIVE_CURRENCY","SiteContextActions.CurrencyChange","BaseSiteEffects","loadBaseSite$","SiteContextActions.LOAD_BASE_SITE","SiteContextActions.LoadBaseSiteSuccess","SiteContextActions.LoadBaseSiteFail","initialState$1","initialState$2","currEntities","currency","initialState$3","langEntities","language","fromLanguages.reducer","fromCurrencies.reducer","fromBaseSite.reducer","siteContextStoreConfigFactory","SiteContextStoreModule","SiteContextModule","SiteContextModule_1","toggleConsentStatus","initialState$6","fromAnonymousConsents.reducer","fromAnonymousConsentsBanner.reducer","fromAnonymousConsentsUpdate.reducer","clearAnonymousConsentTemplates","SiteContextActions.LANGUAGE_CHANGE","anonymousConsentsStoreConfigFactory","AnonymousConsentsStoreModule","ReactiveFormsModule","metaReducers$1","AnonymousConsentsModule","AnonymousConsentsModule_1","defaultAsmConfig","asm","agentSessionTimer","startingDelayInSeconds","maxResults","CSAGENT_TOKEN_DATA","AsmConnector","asmAdapter","AsmUiUpdate","CustomerSearch","CustomerSearchFail","CustomerSearchSuccess","CustomerSearchReset","LoadCustomerSupportAgentToken","LoadCustomerSupportAgentTokenFail","LoadCustomerSupportAgentTokenSuccess","LogoutCustomerSupportAgent","CustomerEffects","asmConnector","customerSearch$","customerSearchResults","AsmActions.CustomerSearchSuccess","AsmActions.CustomerSearchFail","CustomerSupportAgentTokenEffects","loadCustomerSupportAgentToken$","AsmActions.LoadCustomerSupportAgentTokenSuccess","AsmActions.LoadCustomerSupportAgentTokenFail","collapsed","initialState$7","customerSearchResult","asmUi","fromAsmUiReducer.reducer","csagentToken","clearCustomerSupportAgentAsmState","asmStoreConfigFactory","asm.asmUi","asm.csagentToken.value.access_token","asm.csagentToken.value.token_type","asm.csagentToken.value.expires_in","asm.csagentToken.value.expiration_time","asm.csagentToken.value.scope","asm.csagentToken.value.userId","GlobalMessageType","AsmStoreModule","metaReducers$2","getAsmState","getAsmUi","ɵ0$r","getCustomerSearchResultsLoaderState","getCustomerSearchResults","ɵ1$l","getCustomerSearchResultsLoading","ɵ2$e","getCustomerSupportAgentTokenState","getCustomerSupportAgentToken","getCustomerSupportAgentTokenLoading","AsmAuthService","authorizeCustomerSupportAgent","AsmActions.LoadCustomerSupportAgentToken","startCustomerEmulationSession","customerSupportAgentToken","customerId","isCustomerEmulationToken","AsmSelectors.getCustomerSupportAgentToken","AsmSelectors.getCustomerSupportAgentTokenLoading","logoutCustomerSupportAgent","AsmActions.LogoutCustomerSupportAgent","CustomerSupportAgentTokenInterceptor","asmAuthService","HttpResponseStatus","ADD_MESSAGE","REMOVE_MESSAGE","AddMessage","RemoveMessage","RemoveMessagesByType","getGlobalMessageState","getGlobalMessageEntities","ɵ0$u","getGlobalMessageEntitiesByType","getGlobalMessageCountByType","GlobalMessageService","GlobalMessageSelectors.getGlobalMessageEntities","text","timeout","GlobalMessageActions.AddMessage","raw","GlobalMessageActions.RemoveMessage","GlobalMessageActions.RemoveMessagesByType","HttpErrorHandler","globalMessageService","BadGatewayHandler","responseStatus","BAD_GATEWAY","handleError","MSG_TYPE_ERROR","BadRequestHandler","BAD_REQUEST","errorMessage","error_description","MSG_TYPE_CONFIRMATION","subjectType","subject","ConflictHandler","CONFLICT","ForbiddenHandler","FORBIDDEN","GatewayTimeoutHandler","GATEWAY_TIMEOUT","InternalServerErrorHandler","INTERNAL_SERVER_ERROR","NotFoundHandler","NOT_FOUND","UnknownErrorHandler","UNKNOWN","HttpErrorInterceptor","handlers","reverse","handleErrorResponse","handler","getResponseHandler","h","errorHandlers","httpErrorInterceptors","initialState$8","GlobalMessageActions.ADD_MESSAGE","currentMessages","GlobalMessageActions.REMOVE_MESSAGE","msgType","msgIndex","messages","fromGlobalMessage.reducer","GlobalMessageStoreModule","deepEqualObjects","objA","objB","indexOfFirstOccurrence","obj","arr","GlobalMessageEffect","removeDuplicated$","GlobalMessageSelectors.getGlobalMessageEntitiesByType","hideAfterDelay$","globalMessages","GlobalMessageSelectors.getGlobalMessageCountByType","delay","GlobalMessageConfig","defaultGlobalMessageConfigFactory","MSG_TYPE_INFO","MSG_TYPE_WARNING","GlobalMessageModule","GlobalMessageModule_1","CustomerSupportAgentErrorHandlingService","terminateCustomerSupportAgentExpiredSession","CustomerSupportAgentAuthErrorInterceptor","csagentErrorHandlingService","isCustomerSupportAgentRequest","AsmModule","AsmModule_1","AsmService","AsmActions.CustomerSearch","customerSearchReset","AsmActions.CustomerSearchReset","AsmSelectors.getCustomerSearchResults","AsmSelectors.getCustomerSearchResultsLoading","updateAsmUiState","AsmActions.AsmUiUpdate","getAsmUiState","AsmSelectors.getAsmUi","PageMetaResolver","getScore","score","pageTemplate","EMAIL_PATTERN","CART_DATA","getCartContentSelector","getCartRefreshSelector","refresh","getCartEntriesSelector","getCartMergeCompleteSelector","cartMergeComplete","getCartsState","cartsState","getActiveCartState","ɵ4$2","getCartState","ɵ5$2","getCartContent","getCartRefresh","getCartLoaded","ɵ6","getCartLoading","ɵ7","getCartMergeComplete","getCartEntriesMap","getCartEntries","ɵ8","getCartUser","ɵ9","getMultiCartState","getMultiCartEntities","ɵ0$w","getCartEntitySelectorFactory","getCartSelectorFactory","getCartIsStableSelectorFactory","getCartHasPendingProcessesSelectorFactory","getCartEntriesSelectorFactory","getCartEntrySelectorFactory","getActiveCartId","ɵ1$o","wishList","getWishListId","ɵ2$h","getCartIdByUserId","isTempCartId","CREATE_CART","LOAD_CART","MERGE_CART","DELETE_CART","CreateCart","CreateCartFail","CreateCartSuccess","AddEmailToCart","AddEmailToCartFail","AddEmailToCartSuccess","LoadCart","LoadCartFail","LoadCartSuccess","MergeCart","MergeCartSuccess","ResetCartDetails","ClearExpiredCoupons","ClearCart","DeleteCart","DeleteCartFail","CartAddEntry","CartAddEntrySuccess","CartAddEntryFail","CartRemoveEntry","CartRemoveEntrySuccess","CartRemoveEntryFail","CartUpdateEntry","CartUpdateEntrySuccess","CartUpdateEntryFail","CART_ADD_VOUCHER","CART_ADD_VOUCHER_SUCCESS","CART_REMOVE_VOUCHER","CartAddVoucher","CartAddVoucherFail","CartAddVoucherSuccess","CartResetAddVoucher","CartRemoveVoucher","CartRemoveVoucherFail","CartRemoveVoucherSuccess","SET_TEMP_CART","REMOVE_CART","RemoveTempCart","tempCartId","SetTempCart","CreateMultiCart","CreateMultiCartFail","CreateMultiCartSuccess","LoadMultiCart","LoadMultiCartFail","LoadMultiCartSuccess","MergeMultiCart","MergeMultiCartSuccess","ResetMultiCartDetails","RemoveCart","AddEmailToMultiCart","AddEmailToMultiCartFail","AddEmailToMultiCartSuccess","CartProcessesIncrement","CartProcessesDecrement","SetActiveCartId","ClearMultiCartState","CreateWishList","CreateWishListSuccess","CreateWishListFail","LoadWishList","LoadWishListSuccess","MultiCartService","getCart","MultiCartSelectors.getCartSelectorFactory","getCartEntity","MultiCartSelectors.getCartEntitySelectorFactory","MultiCartSelectors.getCartIsStableSelectorFactory","debounce","timer","generateTempCartId","Math","random","extraData","DeprecatedCartActions.CreateCart","mergeToCurrentCart","DeprecatedCartActions.MergeCart","loadCart","DeprecatedCartActions.LoadCart","getEntries","MultiCartSelectors.getCartEntriesSelectorFactory","addEntry","CartActions.CartAddEntry","removeEntry","CartActions.CartRemoveEntry","updateEntry","CartActions.CartUpdateEntry","getEntry","MultiCartSelectors.getCartEntrySelectorFactory","assignEmail","DeprecatedCartActions.AddEmailToCart","DeprecatedCartActions.DeleteCart","ActiveCartService","multiCartService","PREVIOUS_USER_ID_INITIAL_VALUE","previousUserId","activeCartId$","MultiCartSelectors.getActiveCartId","cartSelector$","isJustLoggedIn","loadOrMerge","initActiveCart","activeCart$","cartEntity","activeCartId","isEmpty","cartUser","bufferSize","refCount","getLoaded","isGuestCart","guestCartMerge","addEntriesGuestMerge","cartEntries","entriesToAdd","requireLoadedCartForGuestMerge","cartState","requireLoadedCart","isCartCreating","customCartSelector$","getAssignedUser","isEmail","str","CartVoucherService","addVoucher","combineUserAndCartId","occUserId","cartIdentifier","CartActions.CartAddVoucher","removeVoucher","CartActions.CartRemoveVoucher","getAddVoucherResultError","getAddVoucherResultSuccess","getAddVoucherResultLoading","resetAddVoucherProcessingState","CartActions.CartResetAddVoucher","CartSelectors.getCartContent","UserService","UsersSelectors.getDetails","UserActions.LoadUserDetails","userRegisterFormData","UserActions.RegisterUser","UserActions.RegisterGuest","getRegisterUserResultLoading","getRegisterUserResultSuccess","getRegisterUserResultError","resetRegisterUserProcessState","UserActions.ResetRegisterUserProcess","UserActions.RemoveUser","getRemoveUserResultLoading","getRemoveUserResultError","getRemoveUserResultSuccess","resetRemoveUserProcessState","UserActions.RemoveUserReset","getTitles","UsersSelectors.getAllTitles","UserActions.LoadTitles","isPasswordReset","UsersSelectors.getResetPassword","updatePersonalDetails","userDetails","UserActions.UpdateUserDetails","username","getUpdatePersonalDetailsResultLoading","getUpdatePersonalDetailsResultError","getUpdatePersonalDetailsResultSuccess","resetUpdatePersonalDetailsProcessingState","UserActions.ResetUpdateUserDetails","UserActions.ResetPassword","UserActions.ForgotPasswordEmailRequest","UserActions.UpdateEmailAction","getUpdateEmailResultSuccess","getUpdateEmailResultError","getUpdateEmailResultLoading","resetUpdateEmailResultState","UserActions.ResetUpdateEmailAction","UserActions.UpdatePassword","getUpdatePasswordResultLoading","getUpdatePasswordResultError","getUpdatePasswordResultSuccess","resetUpdatePasswordProcessState","UserActions.UpdatePasswordReset","SelectiveCartService","userService","cartId$","selectiveCart$","isLoggedIn","loadAttempted","WishListService","createWishList","description","CartActions.CreateWishList","getWishList","wishListId","loadWishList","CartActions.LoadWishList","getWishListLoading","stable","MultiCartSelectors.getWishListId","COMPONENT_ENTITY","LoadCmsComponent","LoadCmsComponentFail","LoadCmsComponentSuccess","CmsGetComponentFromPage","cmp","LoadCmsNavigationItems","nodeId","LoadCmsNavigationItemsFail","LoadCmsNavigationItemsSuccess","LoadCmsPageData","LoadCmsPageDataFail","LoadCmsPageDataSuccess","CmsSetPageSuccessIndex","CmsSetPageFailIndex","getCmsState","getComponentsState","ɵ0$x","componentsContextSelectorFactory","componentsState","StateEntitySelectors.entitySelector","componentsLoaderStateSelectorFactory","componentsContext","componentsContextExistsSelectorFactory","componentsDataSelectorFactory","componentsSelectorFactory","componentState","exists","getNavigationEntryItemState","getSelectedNavigationEntryItemState","nodes","getNavigationEntryItems","itemState","getPageEntitiesSelector","pageData","getIndexByType","category","catalog","getPageComponentTypesSelector","componentTypes","from","getPageState","ɵ3$a","getPageStateIndex","ɵ4$3","getPageStateIndexEntityLoaderState","getPageStateIndexLoaderState","indexState","getPageStateIndexValue","getPageEntities","getPageData","indexValue","getPageComponentTypes","getCurrentSlotSelectorFactory","serializePageContext","ignoreContentPageId","PageRobotsMeta","CmsService","_launchInSmartEdit","isLaunchInSmartEdit","getCurrentPage","CmsSelectors.getPageData","getComponentData","createComponentData","currentContext","loading$","CmsSelectors.componentsLoaderStateSelectorFactory","observeOn","queueScheduler","nextContext","loadingState","attemptedLoad","couldBeLoadedWithPageData","CmsActions.LoadCmsComponent","component$","CmsSelectors.componentsSelectorFactory","using","getContentSlot","CmsSelectors.getCurrentSlotSelectorFactory","navigationNodeUid","CmsSelectors.getNavigationEntryItems","loadNavigationItems","rootUid","CmsActions.LoadCmsNavigationItems","items","refreshLatestPage","CmsActions.LoadCmsPageData","refreshPageById","refreshComponent","CmsSelectors.getPageComponentTypes","hasPage","forceReload","CmsSelectors.getPageStateIndexLoaderState","shouldReload","getPage","getPageIndex","CmsSelectors.getPageStateIndexValue","setPageFailIndex","CmsActions.CmsSetPageFailIndex","CartPageMetaResolver","cms","cms$","resolveTitle","resolveRobots","robots","NOFOLLOW","NOINDEX","withdrawOn","notifier","switchMapTo","CartEntryConnector","CartEntryEffects","cartEntryConnector","contextChange$","SiteContextActions.CURRENCY_CHANGE","addEntry$","CartActions.CartAddEntrySuccess","CartActions.CartAddEntryFail","CartActions.CartProcessesDecrement","removeEntry$","CartActions.CartRemoveEntrySuccess","CartActions.CartRemoveEntryFail","updateEntry$","CartActions.CartUpdateEntrySuccess","CartActions.CartUpdateEntryFail","CartVoucherConnector","CartVoucherEffects","cartVoucherConnector","messageService","addCartVoucher$","CartActions.CART_ADD_VOUCHER","showGlobalMessage","CartActions.CartAddVoucherSuccess","CartActions.CartAddVoucherFail","CartActions.LoadCart","removeCartVoucher$","CartActions.CART_REMOVE_VOUCHER","CartActions.CartRemoveVoucherSuccess","CartActions.CartRemoveVoucherFail","messageType","voucherCode","VerifyAddress","VerifyAddressFail","VerifyAddressSuccess","ClearAddressVerificationResults","LoadCardTypes","LoadCardTypesFail","LoadCardTypesSuccess","CHECKOUT_DETAILS","PLACE_ORDER","AddDeliveryAddress","AddDeliveryAddressFail","AddDeliveryAddressSuccess","SetDeliveryAddress","SetDeliveryAddressFail","SetDeliveryAddressSuccess","ResetSetDeliveryAddressProcess","LoadSupportedDeliveryModes","LoadSupportedDeliveryModesFail","LoadSupportedDeliveryModesSuccess","ResetLoadSupportedDeliveryModesProcess","SetDeliveryMode","SetDeliveryModeFail","SetDeliveryModeSuccess","ResetSetDeliveryModeProcess","CreatePaymentDetails","CreatePaymentDetailsFail","CreatePaymentDetailsSuccess","PaymentProcessSuccess","SetPaymentDetails","SetPaymentDetailsFail","SetPaymentDetailsSuccess","ResetSetPaymentDetailsProcess","PlaceOrder","PlaceOrderFail","PlaceOrderSuccess","ClearSupportedDeliveryModes","ClearCheckoutStep","ClearCheckoutData","LoadCheckoutDetails","LoadCheckoutDetailsFail","LoadCheckoutDetailsSuccess","CheckoutClearMiscsData","ClearCheckoutDeliveryAddress","ClearCheckoutDeliveryAddressSuccess","ClearCheckoutDeliveryAddressFail","ClearCheckoutDeliveryMode","ClearCheckoutDeliveryModeSuccess","ClearCheckoutDeliveryModeFail","CartConnector","CartEffects","cartConnector","loadCart$","DeprecatedCartActions.LOAD_CART","groupBy","group$","DeprecatedCartActions.LoadCartSuccess","CartActions.LoadMultiCartSuccess","CartActions.RemoveCart","DeprecatedCartActions.LoadCartFail","CartActions.LoadMultiCartFail","err","CartActions.ClearExpiredCoupons","DeprecatedCartActions.ClearCart","createCart$","DeprecatedCartActions.CREATE_CART","conditionalActions","DeprecatedCartActions.MergeCartSuccess","CartActions.MergeMultiCartSuccess","DeprecatedCartActions.CreateCartSuccess","CartActions.CreateMultiCartSuccess","CartActions.SetTempCart","DeprecatedCartActions.CreateCartFail","CartActions.CreateMultiCartFail","mergeCart$","DeprecatedCartActions.MERGE_CART","currentCart","refresh$","CartActions.CART_ADD_VOUCHER_SUCCESS","refreshWithoutProcesses$","resetCartDetailsOnSiteContextChange$","DeprecatedCartActions.ResetCartDetails","CartActions.ResetMultiCartDetails","addEmail$","DeprecatedCartActions.AddEmailToCartSuccess","CartActions.AddEmailToMultiCartSuccess","DeprecatedCartActions.AddEmailToCartFail","CartActions.AddEmailToMultiCartFail","deleteCart$","DeprecatedCartActions.DELETE_CART","DeprecatedCartActions.DeleteCartFail","SaveCartConnector","WishListEffects","saveCartConnector","createWishList$","saveCartResult","CartActions.CreateWishListSuccess","savedCartData","CartActions.CreateWishListFail","loadWishList$","CartActions.LoadWishListSuccess","CartActions.LoadCartFail","resetWishList$","initialState$9","entryMap","activeCartReducer","CartActions.REMOVE_CART","cartEntitiesReducer","CartActions.SET_TEMP_CART","wishListReducer","cartReducer","clearCartState","clearMultiCartState","multiCartMetaReducers","multiCartReducerToken","getMultiCartReducers","multiCartReducerProvider","MultiCartStatePersistenceService","statePersistenceService","siteContextParamsService","sync","MultiCartSelectors.getMultiCartState","distinctUntilKeyChanged","CartActions.ClearCart","CartActions.ClearMultiCartState","CartActions.SetActiveCartId","cartStoreConfigFactory","CART_FEATURE","CartStoreModule","metaReducers$3","MultiCartEffects","loadCart2$","CartActions.LoadMultiCart","createCart2$","CartActions.CreateMultiCart","setTempCart$","CartActions.RemoveTempCart","mergeCart2$","CartActions.MergeMultiCart","addEmail2$","CartActions.AddEmailToMultiCart","removeCart$","processesIncrement$","CartActions.CartProcessesIncrement","MultiCartStoreModule","cartStatePersistenceFactory","cartStatePersistenceService","CartModule","CartModule_1","initialState$a","getDeliveryAddressSelector","getDeliveryModeSelector","deliveryMode","getPaymentDetailsSelector","getOrderDetailsSelector","orderDetails","getCheckoutState","checkoutState","steps","getCheckoutStepsState","ɵ4$4","getCheckoutSteps","ɵ5$3","getDeliveryAddress","getDeliveryMode","supported","getSupportedDeliveryModes","ɵ6$1","getSelectedDeliveryModeCode","ɵ7$1","getSelectedDeliveryMode","ɵ8$1","getPaymentDetails","getCheckoutOrderDetails","getCheckoutDetailsLoaded","ɵ9$1","getAddressVerificationResultsState","ɵ0$B","getAddressVerificationResults","initialState$b","cardTypesEntities","getCardTypesState","getCardTypesEntites","getAllCardTypes","ɵ1$r","CheckoutService","checkoutStore","activeCartService","userId_1","cartId_1","actionAllowed","CheckoutActions.PlaceOrder","clearCheckoutData","CheckoutActions.ClearCheckoutData","clearCheckoutStep","stepNumber","CheckoutActions.ClearCheckoutStep","CheckoutActions.LoadCheckoutDetails","CheckoutSelectors.getCheckoutDetailsLoaded","CheckoutSelectors.getCheckoutOrderDetails","CheckoutPageMetaResolver","translation","cart$","translate","totalItems","TranslationService","initialState$c","supportedModes","modes","mode","deliveryAddress","paymentInfo","fromCheckout.reducer","fromCardTypes.reducer","fromAddressVerification.reducer","UserAddressConnector","AddressVerificationEffect","userAddressConnector","verifyAddress$","CheckoutActions.VerifyAddressSuccess","CheckoutActions.VerifyAddressFail","CheckoutPaymentConnector","getCardTypes","CardTypesEffects","checkoutPaymentConnector","loadCardTypes$","CheckoutActions.LoadCardTypesSuccess","CheckoutActions.LoadCardTypesFail","CheckoutConnector","CheckoutDeliveryConnector","CheckoutEffects","checkoutDeliveryConnector","checkoutConnector","addDeliveryAddress$","CheckoutActions.SetDeliveryAddress","UserActions.LoadUserAddresses","CheckoutActions.AddDeliveryAddressFail","setDeliveryAddress$","CheckoutActions.SetDeliveryAddressSuccess","CheckoutActions.ClearCheckoutDeliveryMode","CheckoutActions.ClearSupportedDeliveryModes","CheckoutActions.ResetLoadSupportedDeliveryModesProcess","CheckoutActions.LoadSupportedDeliveryModes","CheckoutActions.SetDeliveryAddressFail","loadSupportedDeliveryModes$","CheckoutActions.LoadSupportedDeliveryModesSuccess","CheckoutActions.LoadSupportedDeliveryModesFail","clearCheckoutMiscsDataOnLanguageChange$","CheckoutActions.CheckoutClearMiscsData","clearDeliveryModesOnCurrencyChange$","clearCheckoutDataOnLogout$","clearCheckoutDataOnLogin$","AuthActions.LOGIN","setDeliveryMode$","selectedModeId","CheckoutActions.SetDeliveryModeSuccess","CheckoutActions.SetDeliveryModeFail","createPaymentDetails$","CheckoutActions.CreatePaymentDetailsSuccess","UserActions.LoadUserPaymentMethods","CheckoutActions.CreatePaymentDetailsFail","setPaymentDetails$","CheckoutActions.SetPaymentDetailsSuccess","CheckoutActions.SetPaymentDetailsFail","placeOrder$","CheckoutActions.PLACE_ORDER","CheckoutActions.PlaceOrderSuccess","CheckoutActions.PlaceOrderFail","loadCheckoutDetails$","CheckoutActions.LoadCheckoutDetailsSuccess","CheckoutActions.LoadCheckoutDetailsFail","reloadDetailsOnMergeCart$","clearCheckoutDeliveryAddress$","CheckoutActions.ClearCheckoutDeliveryAddressSuccess","CheckoutActions.ClearCheckoutDeliveryAddressFail","clearCheckoutDeliveryMode$","CheckoutActions.ClearCheckoutDeliveryModeSuccess","CheckoutActions.ClearCheckoutDeliveryModeFail","CheckoutStoreModule","CheckoutModule","CheckoutModule_1","CheckoutDeliveryService","CheckoutSelectors.getSupportedDeliveryModes","loadSupportedDeliveryModes","CheckoutSelectors.getSelectedDeliveryMode","CheckoutSelectors.getSelectedDeliveryModeCode","CheckoutSelectors.getDeliveryAddress","getSetDeliveryAddressProcess","resetSetDeliveryAddressProcess","CheckoutActions.ResetSetDeliveryAddressProcess","getSetDeliveryModeProcess","resetSetDeliveryModeProcess","CheckoutActions.ResetSetDeliveryModeProcess","resetLoadSupportedDeliveryModesProcess","getLoadSupportedDeliveryModeProcess","clearCheckoutDeliveryModes","CheckoutSelectors.getAddressVerificationResults","createAndSetAddress","CheckoutActions.AddDeliveryAddress","userId_2","cartId_2","setDeliveryMode","userId_3","cartId_3","CheckoutActions.SetDeliveryMode","verifyAddress","userId_4","CheckoutActions.VerifyAddress","setDeliveryAddress","userId_5","cart_1","activeCart","clearAddressVerificationResults","CheckoutActions.ClearAddressVerificationResults","CheckoutActions.ClearCheckoutDeliveryAddress","clearCheckoutDeliveryDetails","CheckoutPaymentService","CheckoutSelectors.getAllCardTypes","CheckoutSelectors.getPaymentDetails","getSetPaymentDetailsResultProcess","resetSetPaymentDetailsProcess","CheckoutActions.ResetSetPaymentDetailsProcess","loadSupportedCardTypes","CheckoutActions.LoadCardTypes","createPaymentDetails","CheckoutActions.CreatePaymentDetails","setPaymentDetails","CheckoutActions.SetPaymentDetails","paymentProcessSuccess","CheckoutActions.PaymentProcessSuccess","CmsStructureConfig","defaultCmsModuleConfig","pages","legacy","cmsComponents","ContentPageMetaResolver","resolveBreadcrumbLabel","resolveBreadcrumbs","breadcrumbs","_page","breadcrumbLabel","link","CmsPageTitleModule","bufferDebounceTime","time","scheduler","bufferedValues","CmsStructureConfigService","cmsDataConfig","mergePageStructure","pageStructure","mergePage","mergeSlots","shouldIgnoreBackend","getPageFromConfig","ignoreBackend","getComponentFromConfig","componentId","getComponentById","getComponentsFromConfig","cmsStructure","getComponentsByPosition","componentIds","CmsComponentConnector","cmsStructureConfigService","configuredComponent","getList","configuredComponents","missingIds","loadedComponents","ComponentsEffects","cmsComponentLoader","loadComponent$","createEffect","actionGroup","loadComponentsEffect","componentUids","CmsActions.LoadCmsComponentSuccess","CmsActions.LoadCmsComponentFail","merge","TO_ESCAPE_BASE","with","TO_ESCAPE_WILDCARD_QM","TO_ESCAPE_LITERAL_QM","globToRegex","glob","literalQuestionMark","toEscape","regex","seg","escape","processGlobPatterns","urls","positive","GlobService","getValidator","patterns","processedPatterns","includePatterns","spec","excludePatterns","some","pattern","UrlMatcherService","globService","getFalsy","getFromPaths","matchers","getFromPath","matcher","getCombined","segmentGroup","route","pathMatch","hasChildren","consumed","posParams","part","substring","getOpposite","originalMatcher","getFromGlob","globPatterns","globValidator","fullPath","ConfigurableRoutesService","urlMatcherService","initCalled","configure","resetConfig","configureRoutes","configuredRoute","configureRoute","getRouteName","validateRouteConfig","disabled","resolveUrlMatchers","matchersOrFactories","matcherOrFactory","resolveUrlMatcherFactory","factoryToken","factory","UrlPipe","urlService","Pipe","ProductURLPipe","semanticPath","UrlModule","ExternalRoutesGuard","addExternalRoutesFactory","addRoutes","ExternalRoutesService","internal","newRoutes","getRoutes","internalUrlPatterns","getUrlMatcher","ExternalRoutesConfig","ExternalRoutesModule","ExternalRoutesModule_1","ProtectedRoutesService","nonProtectedPaths","shouldProtect","getNonProtectedPaths","getSegments","routingConfig","protected","isUrlProtected","urlSegments","matchAnyPath","pathsSegments","pathSegments","matchPath","pathSeg","urlSeg","ProtectedRoutesGuard","authGuard","RouterEffects","navigate$","navigateBuUrl$","navigateByUrl","clearCmsRoutes$","filteredConfig","cxCmsRouteContext","navigateBack$","navigateForward$","cmsRequired","initialState$d","fromNgrxRouter.ROUTER_NAVIGATION","routerState","fromNgrxRouter.ROUTER_ERROR","fromNgrxRouter.ROUTER_CANCEL","fromNgrxRouter.ROUTER_NAVIGATED","CustomSerializer","firstChild","x","guardName","pageLabel","urlSegment","initConfigurableRoutes","RoutingModule","RoutingModule_1","RouterStateSerializer","StoreRouterConnectingModule","stateKey","DEFAULT_URL_MATCHER","inject","NavigationEntryItemEffects","cmsComponentConnector","loadNavigationItems$","getIdListByItemType","CmsActions.LoadCmsNavigationItemsSuccess","CmsActions.LoadCmsNavigationItemsFail","pageIds","mediaIds","superType","CmsPageConnector","cmsPageAdapter","loadFromConfig","mergeDefaultPageStructure","PageEffects","cmsPageConnector","refreshPage$","loadPageData$","CmsActions.CmsGetComponentFromPage","CmsActions.LoadCmsPageDataSuccess","CmsActions.CmsSetPageSuccessIndex","CmsActions.LoadCmsPageDataFail","componentExistsReducer","initialState$e","pageContextReducer","newItem","compItems","initialState$g","fromPageReducer.reducer","fromPageIndexReducer.reducer","fromComponentsReducer.reducer","fromNavigation.reducer","clearCmsState","cmsStoreConfigFactory","CmsStoreModule","metaReducers$4","CmsModule","CmsModule_1","PageMetaService","resolvers","resolverMethods","heading","getMeta","metaResolver","getMetaResolver","resolveMethods","matchingResolvers","resolver","DynamicAttributeService","addDynamicAttributes","element","renderer","groupProps","propName","propValue","classItem","classList","setAttribute","toLowerCase","TEST_CONFIG_COOKIE_NAME","configFromCookieFactory","cookieName","cookie","parseConfigJSON","exec","TestConfigModule","TestConfigModule_1","configValidatorFactory","configInitializer","validators","ConfigValidatorModule","ConfigValidatorModule_1","configInitializerFactory","ConfigInitializerModule","ConfigInitializerModule_1","CxDatePipe","timezone","getLang","getActiveLang","getLocaleId","reportMissingLocaleData","DatePipe","TranslatePipe","cd","translatedValue","lastKey","aKeys","bKeys","aKeysLen","shallowEqualObjects","lastOptions","markForCheck","ChangeDetectorRef","pure","TranslationChunkService","duplicates","KEY_SEPARATOR","chunk","warnDuplicates","getChunkNameForKey","mainKey","dupes","I18nConfig","i18nextInit","httpClient","serverRequestOrigin","i18nextConfig","ns","fallbackLng","debug","interpolation","escapeValue","i18next","use","i18nextXhrBackend","loadPath","getLoadPath","ajax","i18nextGetHttpClient","resources","chunkName","addResourceBundle","i18nextAddTranslations","changeLanguage","_options","_data","i18nextProviders","ɵ0$D","defaultI18nConfig","I18nextTranslationService","translationChunk","NON_BREAKING_SPACE","fromCharCode","NAMESPACE_SEPARATOR","whitespaceUntilLoaded","namespacedKey","getNamespacedKey","Observable","subscriber","loadNamespaces","reportMissingKey","getFallbackValue","on","off","loadChunks","chunkNames","I18nModule","I18nModule_1","mockTranslate","optionsString","optionName","MockTranslatePipe","MockTranslationService","_whitespaceUntilLoaded","complete","_chunks","MockDatePipe","I18nTestingModule","KymaConfig","OPEN_ID_TOKEN_DATA","LoadOpenIdToken","LoadOpenIdTokenFail","LoadOpenIdTokenSuccess","getKymaState","openIdToken","getOpenIdTokenState","ɵ0$E","getOpenIdTokenValue","getOpenIdTokenLoading","getOpenIdTokenSuccess","getOpenIdTokenError","KymaService","authorizeOpenId","KymaActions.LoadOpenIdToken","getOpenIdToken","KymaSelectors.getOpenIdTokenValue","defaultKymaConfig","kyma_enabled","kyma_client_id","kyma_client_secret","OpenIdAuthenticationTokenService","loadOpenIdAuthenticationToken","getOAuthEndpoint","KymaServices","OpenIdTokenEffect","openIdTokenService","triggerOpenIdTokenLoading$","loginAction","loadOpenIdToken$","KymaActions.LoadOpenIdTokenSuccess","KymaActions.LoadOpenIdTokenFail","clearKymaState","kymaStoreConfigFactory","kyma.openIdToken.value","KymaStoreModule","metaReducers$5","KymaModule","defaultPersonalizationConfig","personalization","httpHeaderName","timestamp","slotPosition","OccPersonalizationIdInterceptor","requestHeader","personalizationId","removeItem","receivedId","PersonalizationConfig","OccPersonalizationTimeInterceptor","receivedTimestamp","PersonalizationModule","PersonalizationModule_1","PersonalizationContextService","cmsService","getPersonalizationContext","buildPersonalizationContext","script","atob","EntityScopedLoaderActions","ProcessStoreModule","ProcessModule","ProcessModule_1","ProductConnector","getMany","ProductReferencesConnector","ProductReviewsConnector","ProductSearchConnector","getSuggestions","LoadProductReferences","LoadProductReferencesFail","LoadProductReferencesSuccess","CleanProductReferences","LoadProductReviews","LoadProductReviewsFail","LoadProductReviewsSuccess","PostProductReview","PostProductReviewFail","PostProductReviewSuccess","SearchProducts","auxiliary","SearchProductsFail","SearchProductsSuccess","GetProductSuggestions","GetProductSuggestionsSuccess","GetProductSuggestionsFail","ClearProductSearchResult","clearPageResults","clearSearchboxResults","entityScopedLoadMeta","entityScopedFailMeta","entityScopedSuccessMeta","entityScopedResetMeta","EntityScopedLoadAction","EntityScopedFailAction","EntityScopedSuccessAction","EntityScopedResetAction","LOAD_PRODUCT","LoadProduct","LoadProductFail","LoadProductSuccess","getProductsState","getProductReferencesState","ɵ0$F","getSelectedProductReferencesFactory","referenceTypeData","getProductReviewsState","reviews","getSelectedProductReviewsFactory","reviewData","suggestions","auxResults","initialState$i","res","getProductsSearchState","getSearchResults","getAuxSearchResults","getProductSuggestions","getProductState","getSelectedProductStateFactory","getSelectedProductFactory","productState","getSelectedProductLoadingFactory","getSelectedProductSuccessFactory","getSelectedProductErrorFactory","getAllProductCodes","ɵ1$s","codes","ProductReferenceService","ProductSelectors.getSelectedProductReferencesFactory","ProductActions.LoadProductReferences","cleanReferences","ProductActions.CleanProductReferences","ProductReviewService","getByProductCode","ProductSelectors.getSelectedProductReviewsFactory","ProductActions.LoadProductReviews","ProductActions.PostProductReview","ProductSearchService","ProductActions.SearchProducts","queryText","getResults","ProductSelectors.getSearchResults","clearResults","ProductActions.ClearProductSearchResult","ProductLoadingService","initProductScopes","getScopesIndex","getProductForScope","auditTime","productParts","shouldLoad$","ProductSelectors.getSelectedProductStateFactory","isLoading$","ProductSelectors.getSelectedProductLoadingFactory","productLoadLogic$","getProductReloadTriggers","ProductActions.LoadProduct","productData$","ProductSelectors.getSelectedProductFactory","triggers","loadFinish$","loadStart$","ProductActions.LOAD_PRODUCT","getMaxAgeTrigger","timestamp$","defer","age","timestampRefresh$","ProductService","productLoading","isLoading","isSuccess","ProductSelectors.getSelectedProductSuccessFactory","hasError","ProductSelectors.getSelectedProductErrorFactory","reload","SearchboxService","ProductSelectors.getAuxSearchResults","getSuggestionResults","ProductSelectors.getProductSuggestions","searchSuggestions","ProductActions.GetProductSuggestions","CategoryPageMetaResolver","productSearchService","searchPage$","hasProductListComponent","searchPage","facetValueName","resolveBreadcrumbData","br","facetCode","facetValueCode","ProductPageMetaResolver","productService","PRODUCT_SCOPE","DETAILS","product$","resolveHeading","resolveDescription","resolveImage","resolveFirstCategory","resolveManufacturer","summary","categories","name_1","PRIMARY","zoom","firstCategory","manufacturer","purchasable","FOLLOW","INDEX","SearchPageMetaResolver","total$","query$","total","q","ProductReferencesEffects","productReferencesConnector","loadProductReferences$","ProductActions.LoadProductReferencesSuccess","_error","ProductActions.LoadProductReferencesFail","ProductReviewsEffects","productReviewsConnector","loadProductReviews$","ProductActions.LoadProductReviewsSuccess","ProductActions.LoadProductReviewsFail","postProductReview","reviewResponse","ProductActions.PostProductReviewSuccess","ProductActions.PostProductReviewFail","showGlobalMessageOnPostProductReviewSuccess$","ProductsSearchEffects","productSearchConnector","searchProducts$","ProductActions.SearchProductsSuccess","ProductActions.SearchProductsFail","getProductSuggestions$","ProductActions.GetProductSuggestionsSuccess","ProductActions.GetProductSuggestionsFail","ProductEffects","productConnector","loadProduct$","productLoadEffect","productLoad","ProductActions.LoadProductSuccess","ProductActions.LoadProductFail","initialState$j","productReference","initialState$k","scopedLoaderReducer","entityScopedLoaderReducer","fromProductsSearch.reducer","fromProductReviews.reducer","fromProductReferences.reducer","clearProductsState","productStoreConfigFactory","ProductStoreModule","metaReducers$6","pageTitleResolvers","ProductModule","ProductModule_1","SmartEditService","zone","isPreviewPage","getCmsTicket","window_1","smartedit","renderComponent","componentType","parentId","reprocessPage","_cmsTicketId","takeWhile","launchInSmartEdit","getDefaultPreviewCode","defaultPreviewCategoryCode","defaultPreviewProductCode","addPageContract","cmsPage","_currentPageId","goToPreviewPage","previousContract_1","attr","classes","run","NgZone","CmsTicketInterceptor","cmsTicketId","SmartEditModule","SmartEditModule_1","NgExpressEngineDecorator","ngExpressEngine","setupOptions","filePath","getServerRequestProviders","engineInstance","req","getRequestOrigin","originalUrl","protocol","STORE_FINDER_DATA","FIND_STORES","FIND_STORE_BY_ID","FindStoresOnHold","FindStores","FindStoresFail","FindStoresSuccess","FindStoreById","FindStoreByIdFail","FindStoreByIdSuccess","ViewAllStores","ViewAllStoresFail","ViewAllStoresSuccess","getStoreFinderState","storesState","findStores","getFindStoresState","ɵ0$J","getFindStoresEntities","ɵ1$t","getStoresLoading","ɵ2$k","getViewAllStoresState","viewAllStores","getViewAllStoresEntities","getViewAllStoresLoading","StoreFinderService","geolocationWatchId","StoreFinderSelectors.getStoresLoading","StoreFinderSelectors.getFindStoresEntities","StoreFinderSelectors.getViewAllStoresLoading","StoreFinderSelectors.getViewAllStoresEntities","findStoresAction","useMyLocation","clearWatchGeolocation","StoreFinderActions.FindStoresOnHold","navigator","geolocation","watchPosition","pos","coords","StoreFinderActions.FindStores","StoreFinderActions.ViewAllStores","viewStoreById","StoreFinderActions.FindStoreById","callbackAction","clearWatch","StoreDataService","weekDays","0","1","2","3","4","5","6","getStoreLatitude","geoPoint","getStoreLongitude","getStoreClosingTime","requestedDaySchedule","getSchedule","closed","closingTime","formattedHour","getStoreOpeningTime","openingTime","weekday","getDay","openingHours","weekDayOpeningList","weekDayOpeningListItem","weekDay","ExternalJsFileLoader","src","createElement","parseParams","async","addEventListener","head","appendChild","keysArray","GoogleMapRendererService","externalJsFileLoader","storeDataService","googleMap","renderMap","mapElement","locations","selectMarkerHandler","googleMaps","apiUrl","apiKey","drawMap","centerMap","latitute","panTo","lat","lng","setZoom","selectedMarkerScale","defineMapCenter","google","maps","LatLng","initMap","mapCenter","mapProp","center","scale","mapTypeId","MapTypeId","ROADMAP","gestureHandling","createMarkers","markers","marker","Marker","setMap","addListener","setAnimation","Animation","BOUNCE","StoreFinderConfig","defaultStoreFinderConfig","FindStoresEffect","storeFinderConnector","findStores$","StoreFinderActions.FIND_STORES","StoreFinderActions.FindStoresSuccess","StoreFinderActions.FindStoresFail","findStoreById$","StoreFinderActions.FIND_STORE_BY_ID","StoreFinderActions.FindStoreByIdSuccess","StoreFinderActions.FindStoreByIdFail","ViewAllStoresEffect","viewAllStores$","StoreFinderActions.ViewAllStoresSuccess","StoreFinderActions.ViewAllStoresFail","StoreFinderStoreModule","StoreFinderCoreModule","UserConnector","UserConsentConnector","UserPaymentConnector","UserOrderConnector","getHistory","getReturnRequestDetail","getReturnRequestList","CustomerCouponConnector","UserInterestsConnector","ConsentService","checkConsentGivenByTemplateId","isAnonymousConsentType","checkConsentWithdrawnByTemplateId","isConsentType","UserAddressService","loadAddresses","addUserAddress","UserActions.AddUserAddress","setAddressAsDefault","UserActions.UpdateUserAddress","defaultAddress","updateUserAddress","deleteUserAddress","UserActions.DeleteUserAddress","UsersSelectors.getAddresses","UsersSelectors.getAddressesLoading","UsersSelectors.getAddressesLoadedSuccess","loadDeliveryCountries","UserActions.LoadDeliveryCountries","getDeliveryCountries","UsersSelectors.getAllDeliveryCountries","getCountry","UsersSelectors.countrySelectorFactory","UserActions.LoadRegions","clearRegions","UserActions.ClearRegions","UsersSelectors.getRegionsDataAndLoading","UserOrderService","UsersSelectors.getOrderDetails","loadOrderDetails","UserActions.LoadOrderDetails","clearOrderDetails","UserActions.ClearOrderDetails","getOrderHistoryList","UsersSelectors.getOrdersState","orderListState","loadOrderList","getOrderHistoryListLoaded","UsersSelectors.getOrdersLoaded","UserActions.LoadUserOrders","clearOrderList","UserActions.ClearUserOrders","UsersSelectors.getConsignmentTracking","loadConsignmentTracking","UserActions.LoadConsignmentTracking","clearConsignmentTracking","UserActions.ClearConsignmentTracking","UserActions.CancelOrder","getCancelOrderLoading","getCancelOrderSuccess","resetCancelOrderProcessState","UserActions.ResetCancelOrderProcess","CustomerCouponService","loadCustomerCoupons","UserActions.LoadCustomerCoupons","UsersSelectors.getCustomerCouponsState","customerCouponsState","UsersSelectors.getCustomerCouponsLoaded","UsersSelectors.getCustomerCouponsLoading","subscribeCustomerCoupon","UserActions.SubscribeCustomerCoupon","getSubscribeCustomerCouponResultLoading","getSubscribeCustomerCouponResultSuccess","getSubscribeCustomerCouponResultError","unsubscribeCustomerCoupon","UserActions.UnsubscribeCustomerCoupon","getUnsubscribeCustomerCouponResultLoading","getUnsubscribeCustomerCouponResultSuccess","getUnsubscribeCustomerCouponResultError","UserActions.ClaimCustomerCoupon","getClaimCustomerCouponResultSuccess","UserPaymentService","loadPaymentMethods","UsersSelectors.getPaymentMethods","UsersSelectors.getPaymentMethodsLoading","UsersSelectors.getPaymentMethodsLoadedSuccess","setPaymentMethodAsDefault","paymentMethodId","UserActions.SetDefaultUserPaymentMethod","deletePaymentMethod","UserActions.DeleteUserPaymentMethod","UsersSelectors.getAllBillingCountries","loadBillingCountries","UserActions.LoadBillingCountries","OrderReturnRequestService","createOrderReturnRequest","UserActions.CreateOrderReturnRequest","UsersSelectors.getOrderReturnRequest","UsersSelectors.getOrderReturnRequestListState","returnListState","loadOrderReturnRequestList","loadOrderReturnRequestDetail","UserActions.LoadOrderReturnRequest","UserActions.LoadOrderReturnRequestList","clearOrderReturnRequestList","UserActions.ClearOrderReturnRequestList","getReturnRequestLoading","UsersSelectors.getOrderReturnRequestLoading","getReturnRequestSuccess","UsersSelectors.getOrderReturnRequestSuccess","clearOrderReturnRequestDetail","UserActions.ClearOrderReturnRequest","cancelOrderReturnRequest","UserActions.CancelOrderReturnRequest","getCancelReturnRequestLoading","getCancelReturnRequestSuccess","resetCancelReturnRequestProcessState","UserActions.ResetCancelReturnProcess","UserNotificationPreferenceService","UsersSelectors.getPreferences","UsersSelectors.getEnabledPreferences","loadPreferences","UserActions.LoadNotificationPreferences","clearPreferences","UserActions.ClearNotificationPreferences","UsersSelectors.getPreferencesLoading","updatePreferences","UserActions.UpdateNotificationPreferences","getUpdatePreferencesResultLoading","resetNotificationPreferences","UserActions.ResetNotificationPreferences","UserInterestsService","loadProductInterests","UserActions.LoadProductInterests","UsersSelectors.getInterests","getAndLoadProductInterests","UsersSelectors.getInterestsState","interestListState","getProdutInterestsLoading","UsersSelectors.getInterestsLoading","removeProdutInterest","singleDelete","UserActions.RemoveProductInterest","getRemoveProdutInterestLoading","getRemoveProdutInterestSuccess","addProductInterest","UserActions.AddProductInterest","getAddProductInterestSuccess","getAddProductInterestError","resetAddInterestState","UserActions.ResetAddInterestState","resetRemoveInterestState","UserActions.ResetRemoveInterestState","clearProductInterests","UserActions.ClearProductInterests","initialState$l","countryEntities","initialState$m","initialState$n","initialState$o","initialState$p","initialState$q","initialState$r","initialState$t","titleEntities","initialState$u","initialState$v","updatedConsentTemplate_1","initialState$w","updatedDetails","sorts","initialState$x","coupons","initialState$y","updatedCustomerCoupon_1","coupon","customerCoupons_1","customerCoupon","couponId","updatedCouponCode_1","customerCoupons_2","notificationOn","initialState$z","returnRequests","initialState$A","fromUserDetailsReducer.reducer","fromAddressesReducer.reducer","fromBillingCountriesReducer.reducer","fromUserConsentsReducer.reducer","fromPaymentReducer.reducer","fromUserOrdersReducer.reducer","fromOrderDetailsReducer.reducer","fromOrderReturnRequestReducer.reducer","fromDeliveryCountries.reducer","fromTitlesReducer.reducer","fromRegionsReducer.reducer","fromResetPasswordReducer.reducer","fromConsignmentTrackingReducer.reducer","fromCustomerCouponReducer.reducer","fromNotificationPreferenceReducer.reducer","fromInterestsReducer.reducer","clearUserState","BillingCountriesEffect","loadBillingCountries$","BILLING","UserActions.LoadBillingCountriesSuccess","UserActions.LoadBillingCountriesFail","ClearMiscsDataEffect","clearMiscsData$","UserActions.ClearUserMiscsData","ConsignmentTrackingEffects","userOrderConnector","loadConsignmentTracking$","UserActions.LoadConsignmentTrackingSuccess","UserActions.LoadConsignmentTrackingFail","DeliveryCountriesEffects","loadDeliveryCountries$","SHIPPING","UserActions.LoadDeliveryCountriesSuccess","UserActions.LoadDeliveryCountriesFail","ForgotPasswordEffects","userAccountConnector","requestForgotPasswordEmail$","UserActions.ForgotPasswordEmailRequestSuccess","UserActions.ForgotPasswordEmailRequestFail","NotificationPreferenceEffects","connector","loadPreferences$","UserActions.LoadNotificationPreferencesSuccess","UserActions.LoadNotificationPreferencesFail","updatePreferences$","UserActions.UpdateNotificationPreferencesSuccess","UserActions.UpdateNotificationPreferencesFail","OrderDetailsEffect","orderConnector","loadOrderDetails$","UserActions.LoadOrderDetailsSuccess","UserActions.LoadOrderDetailsFail","cancelOrder$","UserActions.CancelOrderSuccess","UserActions.CancelOrderFail","OrderReturnRequestEffect","createReturnRequest$","returnRequest","UserActions.CreateOrderReturnRequestSuccess","UserActions.CreateOrderReturnRequestFail","loadReturnRequest$","UserActions.LoadOrderReturnRequestSuccess","UserActions.LoadOrderReturnRequestFail","cancelReturnRequest$","UserActions.CancelOrderReturnRequestSuccess","UserActions.CancelOrderReturnRequestFail","loadReturnRequestList$","returnRequestList","UserActions.LoadOrderReturnRequestListSuccess","UserActions.LoadOrderReturnRequestListFail","UserPaymentMethodsEffects","userPaymentMethodConnector","loadUserPaymentMethods$","UserActions.LoadUserPaymentMethodsSuccess","UserActions.LoadUserPaymentMethodsFail","setDefaultUserPaymentMethod$","UserActions.SetDefaultUserPaymentMethodSuccess","UserActions.SetDefaultUserPaymentMethodFail","deleteUserPaymentMethod$","UserActions.DeleteUserPaymentMethodSuccess","UserActions.DeleteUserPaymentMethodFail","RegionsEffects","loadRegions$","countryCode","UserActions.LoadRegionsSuccess","UserActions.LoadRegionsFail","resetRegions$","ResetPasswordEffects","resetPassword$","UserActions.ResetPasswordSuccess","UserActions.ResetPasswordFail","TitlesEffects","loadTitles$","UserActions.LoadTitlesSuccess","UserActions.LoadTitlesFail","UpdateEmailEffects","updateEmail$","UserActions.UpdateEmailSuccessAction","UserActions.UpdateEmailErrorAction","UpdatePasswordEffects","updatePassword$","UserActions.UpdatePasswordSuccess","UserActions.UpdatePasswordFail","UserAddressesEffects","userAddressService","loadUserAddresses$","UserActions.LoadUserAddressesSuccess","UserActions.LoadUserAddressesFail","addUserAddress$","UserActions.AddUserAddressSuccess","UserActions.AddUserAddressFail","updateUserAddress$","UserActions.UpdateUserAddressSuccess","UserActions.UpdateUserAddressFail","deleteUserAddress$","UserActions.DeleteUserAddressSuccess","UserActions.DeleteUserAddressFail","showGlobalMessageOnAddSuccess$","showGlobalMessageOnUpdateSuccess$","showGlobalMessageOnDeleteSuccess$","UserConsentsEffect","userConsentConnector","resetConsents$","getConsents$","UserActions.LoadUserConsentsSuccess","UserActions.LoadUserConsentsFail","giveConsent$","UserActions.GiveUserConsentSuccess","UserActions.GiveUserConsentFail","withdrawConsent$","UserActions.WithdrawUserConsentSuccess","UserActions.WithdrawUserConsentFail","UserDetailsEffects","userConnector","loadUserDetails$","UserActions.LoadUserDetailsSuccess","UserActions.LoadUserDetailsFail","updateUserDetails$","UserActions.UpdateUserDetailsSuccess","UserActions.UpdateUserDetailsFail","UserOrdersEffect","loadUserOrders$","UserActions.LoadUserOrdersSuccess","UserActions.LoadUserOrdersFail","resetUserOrders$","UserRegisterEffects","registerUser$","UserActions.RegisterUserSuccess","UserActions.RegisterUserFail","registerGuest$","UserActions.RegisterGuestSuccess","UserActions.RegisterGuestFail","removeUser$","_result","UserActions.RemoveUserSuccess","UserActions.RemoveUserFail","CustomerCouponEffects","customerCouponConnector","loadCustomerCoupons$","fromCustomerCouponsAction.LoadCustomerCouponsSuccess","fromCustomerCouponsAction.LoadCustomerCouponsFail","subscribeCustomerCoupon$","fromCustomerCouponsAction.SubscribeCustomerCouponSuccess","fromCustomerCouponsAction.SubscribeCustomerCouponFail","unsubscribeCustomerCoupon$","fromCustomerCouponsAction.UnsubscribeCustomerCouponSuccess","fromCustomerCouponsAction.UnsubscribeCustomerCouponFail","claimCustomerCoupon$","fromCustomerCouponsAction.ClaimCustomerCouponSuccess","fromCustomerCouponsAction.ClaimCustomerCouponFail","ProductInterestsEffect","userInterestsConnector","loadProductInteres$","interests","UserActions.LoadProductInterestsSuccess","UserActions.LoadProductInterestsFail","removeProductInterest$","UserActions.RemoveProductInterestSuccess","UserActions.RemoveProductInterestFail","addProductInterest$","UserActions.AddProductInterestSuccess","UserActions.AddProductInterestFail","UserStoreModule","metaReducers$8","RouterModule","FindProductPageMetaResolver","totalAndCode$","UserModule","UserModule_1","Meta"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export function isObject(item: any): boolean {\n  return item && typeof item === 'object' && !Array.isArray(item);\n}\n\nexport function deepMerge(target = {}, ...sources: any[]): any {\n  if (!sources.length) {\n    return target;\n  }\n  const source = sources.shift() || {};\n\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (source[key] instanceof Date) {\n        Object.assign(target, { [key]: source[key] });\n      } else if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        deepMerge(target[key], source[key]);\n      } else {\n        Object.assign(target, { [key]: source[key] });\n      }\n    }\n  }\n\n  return deepMerge(target, ...sources);\n}\n","import { CommonModule } from '@angular/common';\nimport {\n  InjectionToken,\n  ModuleWithProviders,\n  NgModule,\n  Optional,\n  Provider,\n} from '@angular/core';\nimport { deepMerge } from './utils/deep-merge';\n\n/**\n * Global Configuration injection token, can be used to inject configuration to any part of the app\n */\nexport const Config = new InjectionToken('Configuration');\n\n/**\n * Config chunk token, can be used to provide configuration chunk and contribute to the global configuration object.\n * Should not be used directly, use `provideConfig` or import `ConfigModule.withConfig` instead.\n */\nexport const ConfigChunk = new InjectionToken('ConfigurationChunk');\n\n/**\n * Config chunk token, can be used to provide configuration chunk and contribute to the default configuration.\n * Should not be used directly, use `provideDefaultConfig` or `provideDefaultConfigFactory` instead.\n *\n * General rule is, that all config provided in libraries should be provided as default config.\n */\nexport const DefaultConfigChunk = new InjectionToken(\n  'DefaultConfigurationChunk'\n);\n\n/**\n * Helper function to provide configuration chunk using ConfigChunk token\n *\n * To provide default configuration in libraries provideDefaultConfig should be used instead.\n *\n * @param config Config object to merge with the global configuration\n */\nexport function provideConfig(\n  config: any = {},\n  defaultConfig = false\n): Provider {\n  return {\n    provide: defaultConfig ? DefaultConfigChunk : ConfigChunk,\n    useValue: config,\n    multi: true,\n  };\n}\n\n/**\n * Helper function to provide configuration with factory function, using ConfigChunk token\n *\n * To provide default configuration in libraries provideDefaultConfigFactory should be used instead.\n *\n * @param configFactory Factory Function that will generate config object\n * @param deps Optional dependencies to a factory function\n */\nexport function provideConfigFactory(\n  configFactory: Function,\n  deps?: any[],\n  defaultConfig = false\n): Provider {\n  return {\n    provide: defaultConfig ? DefaultConfigChunk : ConfigChunk,\n    useFactory: configFactory,\n    multi: true,\n    deps: deps,\n  };\n}\n\n/**\n * Helper function to provide default configuration chunk using DefaultConfigChunk token\n *\n * @param config Config object to merge with the default configuration\n */\nexport function provideDefaultConfig(config: any = {}): Provider {\n  return {\n    provide: DefaultConfigChunk,\n    useValue: config,\n    multi: true,\n  };\n}\n\n/**\n * Helper function to provide default configuration with factory function, using DefaultConfigChunk token\n *\n * @param configFactory Factory Function that will generate config object\n * @param deps Optional dependencies to a factory function\n */\nexport function provideDefaultConfigFactory(\n  configFactory: Function,\n  deps?: any[]\n): Provider {\n  return {\n    provide: DefaultConfigChunk,\n    useFactory: configFactory,\n    multi: true,\n    deps: deps,\n  };\n}\n\n/**\n * Factory function that merges all configurations chunks. Should not be used directly without explicit reason.\n *\n */\nexport function configurationFactory(\n  configChunks: any[] = [],\n  defaultConfigChunks: any[] = []\n) {\n  const config = deepMerge(\n    {},\n    ...(defaultConfigChunks ?? []),\n    ...(configChunks ?? [])\n  );\n  return config;\n}\n\n@NgModule({\n  imports: [CommonModule],\n  declarations: [],\n})\nexport class ConfigModule {\n  /**\n   * Import ConfigModule and contribute config to the global configuration\n   *\n   * To provide default configuration in libraries provideDefaultConfig should be used instead.\n   *\n   * @param config Config object to merge with the global configuration\n   */\n  static withConfig(config: object): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule,\n      providers: [provideConfig(config)],\n    };\n  }\n\n  /**\n   * Import ConfigModule and contribute config to the global configuration using factory function\n   *\n   * To provide default configuration in libraries provideDefaultConfigFactory should be used instead.\n   *\n   * @param configFactory Factory function that will generate configuration\n   * @param deps Optional dependencies to factory function\n   */\n  static withConfigFactory(\n    configFactory: Function,\n    deps?: any[]\n  ): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule,\n      providers: [provideConfigFactory(configFactory, deps)],\n    };\n  }\n\n  /**\n   * Module with providers, should be imported only once, if possible, at the root of the app.\n   *\n   * @param config\n   */\n  static forRoot(config: any = {}): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule,\n      providers: [\n        provideConfig(config),\n        {\n          provide: Config,\n          useFactory: configurationFactory,\n          deps: [\n            [new Optional(), ConfigChunk],\n            [new Optional(), DefaultConfigChunk],\n          ],\n        },\n      ],\n    };\n  }\n}\n","export abstract class SiteContextConfig {\n  context?: {\n    urlParameters?: string[];\n    [contextName: string]: string[];\n  };\n}\n","import { SiteContextConfig } from '../../site-context/config/site-context-config';\nimport { OccEndpoints } from '../occ-models/occ-endpoints.model';\nimport { LoadingScopes } from './loading-scopes-config';\n\nexport abstract class OccConfig extends SiteContextConfig {\n  backend?: {\n    occ?: {\n      baseUrl?: string;\n      prefix?: string;\n      endpoints?: OccEndpoints;\n      legacy?: boolean;\n    };\n    media?: {\n      /**\n       * Media URLs are typically relative, so that the host can be configured.\n       * Configurable media baseURLs are useful for SEO, multi-site,\n       * switching environments, etc.\n       */\n      baseUrl?: string;\n    };\n    loadingScopes?: LoadingScopes;\n  };\n}\n","import { OccConfig } from '../../occ/config/occ-config';\n\nexport abstract class AnonymousConsentsConfig extends OccConfig {\n  anonymousConsents?: {\n    /**\n     * Specify the consent template ID to be show on the registration page.\n     */\n    registerConsent?: string;\n    /**\n     * Show the legal description at the top of the anonymous consents dialog.\n     */\n    showLegalDescriptionInDialog?: boolean;\n    /**\n     * Specify the list of consent template IDs that are required and which can't be toggled off.\n     */\n    requiredConsents?: string[];\n    /**\n     * Consent management page configuration.\n     */\n    consentManagementPage?: {\n      /**\n       * Show all anonymous consents on the consent management page.\n       */\n      showAnonymousConsents?: boolean;\n      /**\n       * A list of consent template IDs that should be hidden on the consent management page.\n       */\n      hideConsents?: string[];\n    };\n  };\n}\n","import { AnonymousConsentsConfig } from './anonymous-consents-config';\n\nexport const defaultAnonymousConsentsConfig: AnonymousConsentsConfig = {\n  anonymousConsents: {\n    registerConsent: 'MARKETING_NEWSLETTER',\n    showLegalDescriptionInDialog: true,\n    requiredConsents: [],\n    consentManagementPage: {\n      showAnonymousConsents: true,\n      hideConsents: [],\n    },\n  },\n};\n","import { OccConfig } from '../../occ/config/occ-config';\n\nexport abstract class AuthConfig extends OccConfig {\n  authentication?: {\n    client_id?: string;\n    client_secret?: string;\n  };\n}\n","import { AuthConfig } from './auth-config';\n\nexport const defaultAuthConfig: AuthConfig = {\n  authentication: {\n    client_id: 'mobile_android',\n    client_secret: 'secret',\n  },\n  backend: {\n    occ: {\n      endpoints: {\n        login: '/authorizationserver/oauth/token',\n        revoke: '/authorizationserver/oauth/revoke',\n      },\n    },\n  },\n};\n","import { HttpHeaders, HttpRequest } from '@angular/common/http';\n\nexport const USE_CLIENT_TOKEN = 'cx-use-client-token';\nexport const USE_CUSTOMER_SUPPORT_AGENT_TOKEN = 'cx-use-csagent-token';\nexport const TOKEN_REVOCATION_HEADER = 'cx-token-revocation';\n\nexport class InterceptorUtil {\n  static createHeader<T>(\n    headerName: string,\n    interceptorParam: T,\n    headers?: HttpHeaders\n  ): HttpHeaders {\n    if (headers) {\n      return headers.append(headerName, JSON.stringify(interceptorParam));\n    }\n    headers = new HttpHeaders().set(\n      headerName,\n      JSON.stringify(interceptorParam)\n    );\n    return headers;\n  }\n\n  static removeHeader(\n    headerName: string,\n    request: HttpRequest<any>\n  ): HttpRequest<any> {\n    const updatedHeaders = request.headers.delete(headerName);\n    return request.clone({ headers: updatedHeaders });\n  }\n\n  static getInterceptorParam<T>(headerName: string, headers: HttpHeaders): T {\n    const rawValue = headers.get(headerName);\n    if (rawValue) {\n      return JSON.parse(rawValue);\n    }\n    return undefined;\n  }\n}\n","import { Action } from '@ngrx/store';\n\nexport const ENTITY_REMOVE_ACTION = '[ENTITY] REMOVE';\nexport const ENTITY_REMOVE_ALL_ACTION = '[ENTITY] REMOVE ALL';\n\nexport interface EntityMeta {\n  entityType: string;\n  entityId: string | string[];\n  entityRemove?: boolean;\n}\n\nexport function entityMeta(type: string, id: string | string[]): EntityMeta {\n  return {\n    entityType: type,\n    entityId: id,\n  };\n}\n\nexport function entityRemoveMeta(\n  type: string,\n  id: string | string[]\n): EntityMeta {\n  return {\n    entityId: id,\n    entityType: type,\n    entityRemove: true,\n  };\n}\n\nexport function entityRemoveAllMeta(type: string): EntityMeta {\n  return {\n    entityId: null,\n    entityType: type,\n    entityRemove: true,\n  };\n}\n\nexport interface EntityAction extends Action {\n  readonly payload?: any;\n  readonly meta?: EntityMeta;\n}\n\nexport class EntityRemoveAction implements EntityAction {\n  type = ENTITY_REMOVE_ACTION;\n  readonly meta: EntityMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityRemoveMeta(entityType, id);\n  }\n}\n\nexport class EntityRemoveAllAction implements EntityAction {\n  type = ENTITY_REMOVE_ALL_ACTION;\n  readonly meta: EntityMeta;\n  constructor(entityType: string) {\n    this.meta = entityRemoveAllMeta(entityType);\n  }\n}\n","import { Action } from '@ngrx/store';\n\nexport const LOADER_LOAD_ACTION = '[LOADER] LOAD';\nexport const LOADER_FAIL_ACTION = '[LOADER] FAIL';\nexport const LOADER_SUCCESS_ACTION = '[LOADER] SUCCESS';\nexport const LOADER_RESET_ACTION = '[LOADER] RESET';\n\nexport interface LoaderMeta {\n  entityType: string;\n  loader: {\n    load?: boolean;\n    error?: any;\n    success?: boolean;\n  };\n}\n\nexport interface LoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: LoaderMeta;\n}\n\nexport function loadMeta(entityType: string): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {\n      load: true,\n    },\n  };\n}\n\nexport function failMeta(entityType: string, error?: any): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {\n      error: error ? error : true,\n    },\n  };\n}\n\nexport function successMeta(entityType: string): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {\n      success: true,\n    },\n  };\n}\n\nexport function resetMeta(entityType: string): LoaderMeta {\n  return {\n    entityType: entityType,\n    loader: {},\n  };\n}\nexport class LoaderLoadAction implements LoaderAction {\n  type = LOADER_LOAD_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string) {\n    this.meta = loadMeta(entityType);\n  }\n}\n\nexport class LoaderFailAction implements LoaderAction {\n  type = LOADER_FAIL_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string, error?: any) {\n    this.meta = failMeta(entityType, error);\n  }\n}\n\nexport class LoaderSuccessAction implements LoaderAction {\n  type = LOADER_SUCCESS_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string) {\n    this.meta = successMeta(entityType);\n  }\n}\n\nexport class LoaderResetAction implements LoaderAction {\n  type = LOADER_RESET_ACTION;\n  readonly meta: LoaderMeta;\n  constructor(entityType: string) {\n    this.meta = resetMeta(entityType);\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { entityMeta, EntityMeta } from '../entity/entity.action';\nimport {\n  failMeta,\n  LoaderMeta,\n  loadMeta,\n  resetMeta,\n  successMeta,\n} from '../loader/loader.action';\n\nexport const ENTITY_LOAD_ACTION = '[ENTITY] LOAD';\nexport const ENTITY_FAIL_ACTION = '[ENTITY] LOAD FAIL';\nexport const ENTITY_SUCCESS_ACTION = '[ENTITY] LOAD SUCCESS';\nexport const ENTITY_RESET_ACTION = '[ENTITY] RESET';\n\nexport interface EntityLoaderMeta extends EntityMeta, LoaderMeta {}\n\nexport interface EntityLoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: EntityLoaderMeta;\n}\n\nexport function entityLoadMeta(\n  entityType: string,\n  id: string | string[]\n): EntityLoaderMeta {\n  return {\n    ...loadMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entityFailMeta(\n  entityType: string,\n  id: string | string[],\n  error?: any\n): EntityLoaderMeta {\n  return {\n    ...failMeta(entityType, error),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entitySuccessMeta(\n  entityType: string,\n  id: string | string[]\n): EntityLoaderMeta {\n  return {\n    ...successMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entityResetMeta(\n  entityType: string,\n  id: string | string[]\n): EntityLoaderMeta {\n  return {\n    ...resetMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport class EntityLoadAction implements EntityLoaderAction {\n  type = ENTITY_LOAD_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityLoadMeta(entityType, id);\n  }\n}\n\nexport class EntityFailAction implements EntityLoaderAction {\n  type = ENTITY_FAIL_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[], error?: any) {\n    this.meta = entityFailMeta(entityType, id, error);\n  }\n}\n\nexport class EntitySuccessAction implements EntityLoaderAction {\n  type = ENTITY_SUCCESS_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[], public payload?: any) {\n    this.meta = entitySuccessMeta(entityType, id);\n  }\n}\n\nexport class EntityResetAction implements EntityLoaderAction {\n  type = ENTITY_RESET_ACTION;\n  readonly meta: EntityLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityResetMeta(entityType, id);\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { LoaderState } from './loader-state';\nimport { LoaderAction } from './loader.action';\n\nexport const initialLoaderState: LoaderState<any> = {\n  loading: false,\n  error: false,\n  success: false,\n  value: undefined,\n};\n\n/**\n * Higher order reducer that adds generic loading flag to chunk of the state\n *\n * Utilizes \"loader\" meta field of actions to set specific flags for specific\n * action (LOAD, SUCCESS, FAIL, RESET)\n */\nexport function loaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: Action) => T\n): (state: LoaderState<T>, action: LoaderAction) => LoaderState<T> {\n  return (\n    state: LoaderState<T> = initialLoaderState,\n    action: LoaderAction\n  ): LoaderState<T> => {\n    if (\n      action.meta &&\n      action.meta.loader &&\n      action.meta.entityType === entityType\n    ) {\n      const entity = action.meta.loader;\n\n      if (entity.load) {\n        return {\n          ...state,\n          loading: true,\n          value: reducer ? reducer(state.value, action) : state.value,\n        };\n      } else if (entity.error) {\n        return {\n          ...state,\n          loading: false,\n          error: true,\n          success: false,\n          value: reducer ? reducer(state.value, action) : undefined,\n        };\n      } else if (entity.success) {\n        return {\n          ...state,\n          value: reducer ? reducer(state.value, action) : action.payload,\n          loading: false,\n          error: false,\n          success: true,\n        };\n      } else {\n        // reset state action\n        return {\n          ...initialLoaderState,\n          value: reducer\n            ? reducer(initialLoaderState.value, action)\n            : initialLoaderState.value,\n        };\n      }\n    }\n\n    if (reducer) {\n      const newValue = reducer(state.value, action);\n      if (newValue !== state.value) {\n        return { ...state, value: newValue };\n      }\n    }\n    return state;\n  };\n}\n","import { LoaderState } from '../loader/loader-state';\nimport { initialLoaderState } from '../loader/loader.reducer';\nimport { EntityLoaderState } from './entity-loader-state';\n\nexport function entityStateSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): LoaderState<T> {\n  return state.entities[id] || initialLoaderState;\n}\n\nexport function entityValueSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): T {\n  const entityState = entityStateSelector(state, id);\n  return entityState.value;\n}\n\nexport function entityLoadingSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityStateSelector(state, id);\n  return entityState.loading;\n}\n\nexport function entityErrorSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityStateSelector(state, id);\n  return entityState.error;\n}\n\nexport function entitySuccessSelector<T>(\n  state: EntityLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityStateSelector(state, id);\n  return entityState.success;\n}\n","import { Action } from '@ngrx/store';\n\nimport { EntityState } from './entity-state';\nimport { EntityAction } from './entity.action';\n\nexport const initialEntityState: EntityState<any> = { entities: {} };\n\n/**\n * Higher order reducer for reusing reducer logic for multiple entities\n *\n * Utilizes entityId meta field to target entity by id in actions\n */\nexport function entityReducer<T>(\n  entityType: string,\n  reducer: (state: T, action: Action) => T\n) {\n  return (\n    state: EntityState<T> = initialEntityState,\n    action: EntityAction\n  ): EntityState<T> => {\n    let ids: string[];\n    let partitionPayload = false;\n    if (\n      action.meta &&\n      action.meta.entityType === entityType &&\n      action.meta.entityId !== undefined\n    ) {\n      ids = [].concat(action.meta.entityId);\n\n      // remove selected entities\n      if (action.meta.entityRemove) {\n        if (action.meta.entityId === null) {\n          return initialEntityState;\n        } else {\n          let removed = false;\n          const newEntities = Object.keys(state.entities).reduce((acc, cur) => {\n            if (ids.includes(cur)) {\n              removed = true;\n            } else {\n              acc[cur] = state.entities[cur];\n            }\n            return acc;\n          }, {});\n\n          return removed ? { entities: newEntities } : state;\n        }\n      }\n\n      partitionPayload =\n        Array.isArray(action.meta.entityId) && Array.isArray(action.payload);\n    } else {\n      ids = Object.keys(state.entities);\n    }\n\n    const entityUpdates: { [id: string]: T } = {};\n\n    for (let i = 0; i < ids.length; i++) {\n      const id = ids[i];\n      const subAction = partitionPayload\n        ? { ...action, payload: action.payload[i] }\n        : action;\n      const newState = reducer(state.entities[id], subAction);\n      if (newState) {\n        entityUpdates[id] = newState;\n      }\n    }\n\n    if (Object.keys(entityUpdates).length > 0) {\n      return {\n        ...state,\n        entities: { ...state.entities, ...entityUpdates },\n      };\n    }\n\n    return state;\n  };\n}\n","import { entityReducer } from '../entity/entity.reducer';\nimport { loaderReducer } from '../loader/loader.reducer';\nimport { LoaderAction } from '../loader/loader.action';\nimport { EntityLoaderState } from './entity-loader-state';\nimport { EntityLoaderAction } from './entity-loader.action';\n\n/**\n * Higher order reducer that wraps LoaderReducer and EntityReducer enhancing\n * single state reducer to support multiple entities with generic loading flags\n */\nexport function entityLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: LoaderAction) => T\n): (\n  state: EntityLoaderState<T>,\n  action: EntityLoaderAction\n) => EntityLoaderState<T> {\n  return entityReducer(entityType, loaderReducer(entityType, reducer));\n}\n","import { Action } from '@ngrx/store';\nimport {\n  LoaderMeta,\n  resetMeta as loaderResetMeta,\n} from '../loader/loader.action';\n\nexport const PROCESSES_INCREMENT_ACTION = '[PROCESSES LOADER] INCREMENT';\nexport const PROCESSES_DECREMENT_ACTION = '[PROCESSES LOADER] DECREMENT';\nexport const PROCESSES_LOADER_RESET_ACTION = '[PROCESSES LOADER] RESET';\n\nexport interface ProcessesLoaderMeta extends LoaderMeta {\n  entityType: string;\n  processesCountDiff?: number;\n}\n\nexport interface ProcessesLoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: ProcessesLoaderMeta;\n}\n\nexport function processesIncrementMeta(\n  entityType: string\n): ProcessesLoaderMeta {\n  return {\n    entityType: entityType,\n    loader: undefined,\n    processesCountDiff: 1,\n  };\n}\n\nexport function processesDecrementMeta(\n  entityType: string\n): ProcessesLoaderMeta {\n  return {\n    entityType: entityType,\n    loader: undefined,\n    processesCountDiff: -1,\n  };\n}\n\nexport function processesLoaderResetMeta(\n  entityType: string\n): ProcessesLoaderMeta {\n  // processes reset action is a reset action for loader reducer, but not the other way around\n  return {\n    ...loaderResetMeta(entityType),\n    processesCountDiff: null,\n  };\n}\n\nexport class ProcessesLoaderResetAction implements ProcessesLoaderAction {\n  type = PROCESSES_LOADER_RESET_ACTION;\n  readonly meta: ProcessesLoaderMeta;\n  constructor(entityType: string) {\n    this.meta = processesLoaderResetMeta(entityType);\n  }\n}\n\nexport class ProcessesIncrementAction implements ProcessesLoaderAction {\n  type = PROCESSES_INCREMENT_ACTION;\n  readonly meta: ProcessesLoaderMeta;\n  constructor(entityType: string) {\n    this.meta = processesIncrementMeta(entityType);\n  }\n}\n\nexport class ProcessesDecrementAction implements ProcessesLoaderAction {\n  type = PROCESSES_DECREMENT_ACTION;\n  readonly meta: ProcessesLoaderMeta;\n  constructor(entityType: string) {\n    this.meta = processesDecrementMeta(entityType);\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { entityMeta, EntityMeta } from '../entity/entity.action';\nimport {\n  processesDecrementMeta,\n  processesIncrementMeta,\n  ProcessesLoaderMeta,\n  processesLoaderResetMeta,\n} from '../processes-loader/processes-loader.action';\n\nexport const ENTITY_PROCESSES_LOADER_RESET_ACTION =\n  '[ENTITY] PROCESSES LOADER RESET';\nexport const ENTITY_PROCESSES_INCREMENT_ACTION = '[ENTITY] PROCESSES INCREMENT';\nexport const ENTITY_PROCESSES_DECREMENT_ACTION = '[ENTITY] PROCESSES DECREMENT';\n\nexport interface EntityProcessesLoaderMeta\n  extends EntityMeta,\n    ProcessesLoaderMeta {}\n\nexport interface EntityProcessesLoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: EntityProcessesLoaderMeta;\n}\n\nexport function entityProcessesLoaderResetMeta(\n  entityType: string,\n  id: string | string[]\n): EntityProcessesLoaderMeta {\n  return {\n    ...processesLoaderResetMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entityProcessesIncrementMeta(\n  entityType: string,\n  id: string | string[]\n): EntityProcessesLoaderMeta {\n  return {\n    ...processesIncrementMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport function entityProcessesDecrementMeta(\n  entityType: string,\n  id: string | string[]\n): EntityProcessesLoaderMeta {\n  return {\n    ...processesDecrementMeta(entityType),\n    ...entityMeta(entityType, id),\n  };\n}\n\nexport class EntityProcessesLoaderResetAction\n  implements EntityProcessesLoaderAction {\n  type = ENTITY_PROCESSES_LOADER_RESET_ACTION;\n  readonly meta: EntityProcessesLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityProcessesLoaderResetMeta(entityType, id);\n  }\n}\n\nexport class EntityProcessesIncrementAction\n  implements EntityProcessesLoaderAction {\n  type = ENTITY_PROCESSES_INCREMENT_ACTION;\n  readonly meta: EntityProcessesLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityProcessesIncrementMeta(entityType, id);\n  }\n}\n\nexport class EntityProcessesDecrementAction\n  implements EntityProcessesLoaderAction {\n  type = ENTITY_PROCESSES_DECREMENT_ACTION;\n  readonly meta: EntityProcessesLoaderMeta;\n  constructor(entityType: string, id: string | string[]) {\n    this.meta = entityProcessesDecrementMeta(entityType, id);\n  }\n}\n","import { ProcessesLoaderState } from './processes-loader-state';\n\nexport function isStableSelector<T>(state: ProcessesLoaderState<T>): boolean {\n  return state.processesCount === 0 && !state.loading;\n}\n\nexport function hasPendingProcessesSelector<T>(\n  state: ProcessesLoaderState<T>\n): boolean {\n  return state.processesCount > 0;\n}\n","import { isDevMode } from '@angular/core';\nimport { Action } from '@ngrx/store';\nimport { initialLoaderState, loaderReducer } from '../loader/loader.reducer';\nimport { ProcessesLoaderState } from './processes-loader-state';\nimport { ProcessesLoaderAction } from './processes-loader.action';\n\nexport const initialProcessesState: ProcessesLoaderState<any> = {\n  processesCount: 0,\n};\n\n/**\n * Higher order reducer that adds processes count\n */\nexport function processesLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: Action) => T\n): (\n  state: ProcessesLoaderState<T>,\n  action: ProcessesLoaderAction\n) => ProcessesLoaderState<T> {\n  return (\n    state: ProcessesLoaderState<T> = {\n      ...initialProcessesState,\n      ...initialLoaderState,\n    },\n    action: ProcessesLoaderAction\n  ): ProcessesLoaderState<T> => {\n    const loaderState = loaderReducer(entityType, reducer)(state, action);\n    if (action.meta && action.meta.entityType === entityType) {\n      const processesCountDiff = action.meta.processesCountDiff;\n      if (isDevMode() && state.processesCount + processesCountDiff < 0) {\n        console.error(\n          `Action '${action.type}' sets processesCount to value < 0!\\n` +\n            'Make sure to keep processesCount in sync.\\n' +\n            'There should always be only one decrement action for each increment action.\\n' +\n            \"Make sure that you don't reset state in between those actions.\\n\",\n          action\n        );\n      }\n      if (processesCountDiff) {\n        return {\n          ...loaderState,\n          processesCount: state.processesCount\n            ? state.processesCount + processesCountDiff\n            : processesCountDiff,\n        };\n      } else if (processesCountDiff === null) {\n        // reset action\n        return {\n          ...loaderState,\n          ...initialProcessesState,\n        };\n      }\n    }\n\n    return loaderState;\n  };\n}\n","import { entityStateSelector } from '../entity-loader/entity-loader.selectors';\nimport { initialLoaderState } from '../loader/loader.reducer';\nimport {\n  initialProcessesState,\n  ProcessesLoaderState,\n} from '../processes-loader';\nimport {\n  hasPendingProcessesSelector,\n  isStableSelector,\n} from '../processes-loader/processes-loader.selectors';\nimport { EntityProcessesLoaderState } from './entity-processes-loader-state';\n\nconst initialProcessesLoaderState = {\n  ...initialLoaderState,\n  ...initialProcessesState,\n};\n\nexport function entityHasPendingProcessesSelector<T>(\n  state: EntityProcessesLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityStateSelector(state, id);\n  return hasPendingProcessesSelector(entityState);\n}\n\nexport function entityIsStableSelector<T>(\n  state: EntityProcessesLoaderState<T>,\n  id: string\n): boolean {\n  const entityState = entityStateSelector(state, id);\n  return isStableSelector(entityState);\n}\n\nexport function entityProcessesLoaderStateSelector<T>(\n  state: EntityProcessesLoaderState<T>,\n  id: string\n): ProcessesLoaderState<T> {\n  return state.entities[id] || initialProcessesLoaderState;\n}\n","import { entityReducer } from '../entity/entity.reducer';\nimport { processesLoaderReducer } from '../processes-loader';\nimport { ProcessesLoaderAction } from '../processes-loader/processes-loader.action';\nimport { EntityProcessesLoaderState } from './entity-processes-loader-state';\nimport { EntityProcessesLoaderAction } from './entity-processes-loader.action';\n\n/**\n * Higher order reducer that wraps ProcessesLoaderReducer and EntityReducer enhancing\n * single state reducer to support multiple entities with generic processesCount flag\n */\nexport function entityProcessesLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: ProcessesLoaderAction) => T\n): (\n  state: EntityProcessesLoaderState<T>,\n  action: EntityProcessesLoaderAction\n) => EntityProcessesLoaderState<T> {\n  return entityReducer(entityType, processesLoaderReducer(entityType, reducer));\n}\n","import { EntityState } from './entity-state';\n\nexport function entitySelector<T>(state: EntityState<T>, id: string): T {\n  return state.entities[id] || undefined;\n}\n","import { deepMerge } from '../../config/utils/deep-merge';\nimport { StateTransferType, StorageSyncType } from '../config/state-config';\n\nconst OBJECT_SEPARATOR = '.';\n\nexport function getStateSliceValue<T, E>(keys: string, state: T): E {\n  return keys\n    .split(OBJECT_SEPARATOR)\n    .reduce(\n      (previous, current) => (previous ? previous[current] : undefined),\n      state\n    );\n}\n\nexport function createShellObject<T, E>(\n  key: string,\n  excludeKeys: string[],\n  value: T\n): E {\n  if (!key || !value || Object.keys(value).length === 0) {\n    return {} as E;\n  }\n\n  const shell = key.split(OBJECT_SEPARATOR).reduceRight((acc, previous) => {\n    return ({ [previous]: acc } as unknown) as T;\n  }, value);\n  return handleExclusions(key, excludeKeys, shell);\n}\n\nexport function getStateSlice<T, E>(\n  keys: string[],\n  excludeKeys: string[],\n  state: T\n): E {\n  if (keys && keys.length === 0) {\n    return {} as E;\n  }\n\n  let stateSlices = {};\n  for (const currentKey of keys) {\n    const stateValue = getStateSliceValue(currentKey, state);\n    const shell = createShellObject(currentKey, excludeKeys, stateValue);\n    stateSlices = deepMerge(stateSlices, shell);\n  }\n\n  return stateSlices as E;\n}\n\nexport function handleExclusions(\n  key: string,\n  excludeKeys: string[],\n  value: any\n): any {\n  const exclusionKeys = getExclusionKeys(key, excludeKeys);\n  if (exclusionKeys.length === 0) {\n    return value;\n  }\n\n  const finalValue = deepMerge({}, value);\n  for (const currentExclusionKey of exclusionKeys) {\n    const exclusionChunksSplit = currentExclusionKey.split(OBJECT_SEPARATOR);\n\n    let nestedTemp = finalValue;\n    for (let i = 0; i < exclusionChunksSplit.length; i++) {\n      const currentChunk = exclusionChunksSplit[i];\n\n      // last iteration\n      if (i === exclusionChunksSplit.length - 1) {\n        if (nestedTemp && nestedTemp[currentChunk]) {\n          delete nestedTemp[currentChunk];\n        }\n      } else {\n        nestedTemp = nestedTemp[currentChunk];\n      }\n    }\n  }\n\n  return finalValue;\n}\n\nexport function getExclusionKeys(key: string, excludeKeys: string[]): string[] {\n  if (!key || !excludeKeys) {\n    return [];\n  }\n\n  const exclusionKeys: string[] = [];\n  for (const exclusionKey of excludeKeys) {\n    if (exclusionKey.includes(key)) {\n      exclusionKeys.push(exclusionKey);\n    }\n  }\n\n  return exclusionKeys;\n}\n\nexport function filterKeysByType(\n  keys: { [key: string]: StorageSyncType | StateTransferType },\n  type: StorageSyncType | StateTransferType\n): string[] {\n  if (!keys) {\n    return [];\n  }\n  return Object.keys(keys).filter(key => keys[key] === type);\n}\n","import { LoaderState } from './loader-state';\n\nexport function loaderValueSelector<T>(state: LoaderState<T>): T {\n  return state.value;\n}\n\nexport function loaderLoadingSelector<T>(state: LoaderState<T>): boolean {\n  return state.loading;\n}\n\nexport function loaderErrorSelector<T>(state: LoaderState<T>): boolean {\n  return state.error;\n}\n\nexport function loaderSuccessSelector<T>(state: LoaderState<T>): boolean {\n  return state.success;\n}\n","import { StateLoaderActions } from '../../../state/utils/index';\nimport { ClientToken } from '../../models/token-types.model';\nimport { CLIENT_TOKEN_DATA } from '../auth-state';\n\nexport const LOAD_CLIENT_TOKEN = '[Token] Load Client Token';\nexport const LOAD_CLIENT_TOKEN_FAIL = '[Token] Load Client Token Fail';\nexport const LOAD_CLIENT_TOKEN_SUCCESS = '[Token] Load Client Token Success';\n\nexport class LoadClientToken extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_CLIENT_TOKEN;\n  constructor() {\n    super(CLIENT_TOKEN_DATA);\n  }\n}\n\nexport class LoadClientTokenFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_CLIENT_TOKEN_FAIL;\n  constructor(public payload: any) {\n    super(CLIENT_TOKEN_DATA, payload);\n  }\n}\n\nexport class LoadClientTokenSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_CLIENT_TOKEN_SUCCESS;\n  constructor(public payload: ClientToken) {\n    super(CLIENT_TOKEN_DATA);\n  }\n}\n\nexport type ClientTokenAction =\n  | LoadClientToken\n  | LoadClientTokenFail\n  | LoadClientTokenSuccess;\n","import { LoaderState } from '../../state/utils/loader/loader-state';\nimport { ClientToken, UserToken } from '../models/token-types.model';\n\nexport const AUTH_FEATURE = 'auth';\nexport const CLIENT_TOKEN_DATA = '[Auth] Client Token Data';\n\nexport interface StateWithAuth {\n  [AUTH_FEATURE]: AuthState;\n}\n\nexport interface AuthState {\n  userToken: UserTokenState;\n  clientToken: LoaderState<ClientToken>;\n}\n\nexport interface UserTokenState {\n  token: UserToken;\n}\n","import { Action } from '@ngrx/store';\n\nexport const LOGIN = '[Auth] Login';\nexport const LOGOUT = '[Auth] Logout';\nexport const LOGOUT_CUSTOMER_SUPPORT_AGENT =\n  '[Auth] Logout Customer Support Agent';\n\nexport class Login implements Action {\n  readonly type = LOGIN;\n}\n\nexport class Logout implements Action {\n  readonly type = LOGOUT;\n}\n\n// action types\nexport type LoginLogoutAction = Login | Logout;\n","import { Action } from '@ngrx/store';\nimport { UserToken } from '../../models/token-types.model';\n\nexport const LOAD_USER_TOKEN = '[Auth] Load User Token';\nexport const LOAD_USER_TOKEN_FAIL = '[Auth] Load User Token Fail';\nexport const LOAD_USER_TOKEN_SUCCESS = '[Auth] Load User Token Success';\nexport const REFRESH_USER_TOKEN = '[Auth] Refresh User Token';\nexport const REFRESH_USER_TOKEN_FAIL = '[Auth] Refresh User Token Fail';\nexport const REFRESH_USER_TOKEN_SUCCESS = '[Auth] Refresh User Token Success';\nexport const REVOKE_USER_TOKEN = '[Auth] Revoke User Token';\nexport const REVOKE_USER_TOKEN_FAIL = '[Auth] Revoke User Token Fail';\nexport const REVOKE_USER_TOKEN_SUCCESS = '[Auth] Revoke User Token Success';\n\nexport class LoadUserToken implements Action {\n  readonly type = LOAD_USER_TOKEN;\n  constructor(public payload: { userId: string; password: string }) {}\n}\n\nexport class LoadUserTokenFail implements Action {\n  readonly type = LOAD_USER_TOKEN_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadUserTokenSuccess implements Action {\n  readonly type = LOAD_USER_TOKEN_SUCCESS;\n  constructor(public payload: UserToken) {}\n}\n\nexport class RefreshUserToken implements Action {\n  readonly type = REFRESH_USER_TOKEN;\n  constructor(public payload: { refreshToken: string }) {}\n}\n\nexport class RefreshUserTokenSuccess implements Action {\n  readonly type = REFRESH_USER_TOKEN_SUCCESS;\n  constructor(public payload: UserToken) {}\n}\n\nexport class RefreshUserTokenFail implements Action {\n  readonly type = REFRESH_USER_TOKEN_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class RevokeUserToken implements Action {\n  readonly type = REVOKE_USER_TOKEN;\n  constructor(public payload: UserToken) {}\n}\n\nexport class RevokeUserTokenSuccess implements Action {\n  readonly type = REVOKE_USER_TOKEN_SUCCESS;\n  constructor(public payload: UserToken) {}\n}\n\nexport class RevokeUserTokenFail implements Action {\n  readonly type = REVOKE_USER_TOKEN_FAIL;\n  constructor(public payload: any) {}\n}\n\n// action types\nexport type UserTokenAction =\n  | LoadUserToken\n  | LoadUserTokenFail\n  | LoadUserTokenSuccess\n  | RefreshUserToken\n  | RefreshUserTokenFail\n  | RefreshUserTokenSuccess\n  | RevokeUserToken\n  | RevokeUserTokenFail\n  | RevokeUserTokenSuccess;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { AuthState, AUTH_FEATURE, StateWithAuth } from '../auth-state';\n\nexport const getAuthState: MemoizedSelector<\n  StateWithAuth,\n  AuthState\n> = createFeatureSelector<AuthState>(AUTH_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { ClientToken } from '../../models/token-types.model';\nimport { AuthState, StateWithAuth } from '../auth-state';\nimport { getAuthState } from './feature.selector';\n\nexport const getClientTokenState: MemoizedSelector<\n  StateWithAuth,\n  LoaderState<ClientToken>\n> = createSelector(getAuthState, (state: AuthState) => state.clientToken);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { UserToken } from '../../models/token-types.model';\nimport { AuthState, StateWithAuth, UserTokenState } from '../auth-state';\nimport { getAuthState } from './feature.selector';\n\nconst getUserTokenSelector = (state: UserTokenState) => state.token;\n\nexport const getUserTokenState: MemoizedSelector<\n  StateWithAuth,\n  UserTokenState\n> = createSelector(getAuthState, (state: AuthState) => state.userToken);\n\nexport const getUserToken: MemoizedSelector<\n  StateWithAuth,\n  UserToken\n> = createSelector(getUserTokenState, getUserTokenSelector);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, map, take } from 'rxjs/operators';\nimport {\n  OCC_USER_ID_ANONYMOUS,\n  OCC_USER_ID_CURRENT,\n} from '../../occ/utils/occ-constants';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { ClientToken, UserToken } from '../models/token-types.model';\nimport { AuthActions } from '../store/actions/index';\nimport { StateWithAuth } from '../store/auth-state';\nimport { AuthSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthService {\n  constructor(protected store: Store<StateWithAuth>) {}\n\n  /**\n   * Loads a new user token\n   * @param userId\n   * @param password\n   */\n  authorize(userId: string, password: string): void {\n    this.store.dispatch(\n      new AuthActions.LoadUserToken({\n        userId: userId,\n        password: password,\n      })\n    );\n  }\n\n  /**\n   * This function provides the userId the OCC calls should use, depending\n   * on whether there is an active storefront session or not.\n   *\n   * It returns the userId of the current storefront user or 'anonymous'\n   * in the case there are no signed in user in the storefront.\n   *\n   * The user id of a regular customer session is 'current'.  In the case of an\n   * asm customer emulation session, the userId will be the customerId.\n   */\n  getOccUserId(): Observable<string> {\n    return this.getUserToken().pipe(\n      map(userToken => {\n        if (!!userToken && !!userToken.userId) {\n          return userToken.userId;\n        } else {\n          return OCC_USER_ID_ANONYMOUS;\n        }\n      })\n    );\n  }\n\n  /**\n   * Returns the user's token\n   */\n  getUserToken(): Observable<UserToken> {\n    return this.store.pipe(select(AuthSelectors.getUserToken));\n  }\n\n  /**\n   * Refreshes the user token\n   * @param token a user token to refresh\n   */\n  refreshUserToken(token: UserToken): void {\n    this.store.dispatch(\n      new AuthActions.RefreshUserToken({\n        refreshToken: token.refresh_token,\n      })\n    );\n  }\n\n  /**\n   * Store the provided token\n   */\n  authorizeWithToken(token: UserToken): void {\n    this.store.dispatch(new AuthActions.LoadUserTokenSuccess(token));\n  }\n\n  /**\n   * Logout a storefront customer\n   */\n  logout(): void {\n    this.getUserToken()\n      .pipe(take(1))\n      .subscribe(userToken => {\n        this.store.dispatch(new AuthActions.Logout());\n        if (Boolean(userToken) && userToken.userId === OCC_USER_ID_CURRENT) {\n          this.store.dispatch(new AuthActions.RevokeUserToken(userToken));\n        }\n      });\n  }\n\n  /**\n   * Returns a client token.  The client token from the store is returned if there is one.\n   * Otherwise, an new token is fetched from the backend and saved in the store.\n   */\n  getClientToken(): Observable<ClientToken> {\n    return this.store.pipe(\n      select(AuthSelectors.getClientTokenState),\n      filter((state: LoaderState<ClientToken>) => {\n        if (this.isClientTokenLoaded(state)) {\n          return true;\n        } else {\n          if (!state.loading) {\n            this.store.dispatch(new AuthActions.LoadClientToken());\n          }\n          return false;\n        }\n      }),\n      map((state: LoaderState<ClientToken>) => state.value)\n    );\n  }\n\n  /**\n   * Fetches a clientToken from the backend ans saves it in the store where getClientToken can use it.\n   * The new clientToken is returned.\n   */\n  refreshClientToken(): Observable<ClientToken> {\n    this.store.dispatch(new AuthActions.LoadClientToken());\n\n    return this.store.pipe(\n      select(AuthSelectors.getClientTokenState),\n      filter((state: LoaderState<ClientToken>) =>\n        this.isClientTokenLoaded(state)\n      ),\n      map((state: LoaderState<ClientToken>) => state.value)\n    );\n  }\n\n  protected isClientTokenLoaded(state: LoaderState<ClientToken>): boolean {\n    return (state.success || state.error) && !state.loading;\n  }\n\n  /**\n   * Returns `true` if the user is logged in; and `false` if the user is anonymous.\n   */\n  isUserLoggedIn(): Observable<boolean> {\n    return this.getUserToken().pipe(\n      map(userToken => Boolean(userToken) && Boolean(userToken.access_token))\n    );\n  }\n}\n","export const OCC_USER_ID_CURRENT = 'current';\nexport const OCC_USER_ID_ANONYMOUS = 'anonymous';\nexport const OCC_USER_ID_GUEST = 'guest';\n\nexport const OCC_CART_ID_CURRENT = 'current';\n","import { Injectable } from '@angular/core';\nimport { HttpRequest, HttpHandler } from '@angular/common/http';\n\nimport { Observable } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\n\nimport { AuthService } from '../../facade/auth.service';\nimport { ClientToken } from '../../models/token-types.model';\n\n@Injectable()\nexport class ClientErrorHandlingService {\n  constructor(protected authService: AuthService) {}\n\n  public handleExpiredClientToken(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<any> {\n    return this.authService.refreshClientToken().pipe(\n      take(1),\n      switchMap((token: ClientToken) => {\n        return next.handle(this.createNewRequestWithNewToken(request, token));\n      })\n    );\n  }\n\n  protected createNewRequestWithNewToken(\n    request: HttpRequest<any>,\n    token: ClientToken\n  ): HttpRequest<any> {\n    request = request.clone({\n      setHeaders: {\n        Authorization: `${token.token_type} ${token.access_token}`,\n      },\n    });\n    return request;\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable } from '@angular/core';\nimport { fromEvent, Observable, of } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, startWith } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class WindowRef {\n  readonly document: Document;\n\n  constructor(@Inject(DOCUMENT) document) {\n    // it's a workaround to have document property properly typed\n    // see: https://github.com/angular/angular/issues/15640\n    this.document = document;\n  }\n\n  get nativeWindow(): Window {\n    return typeof window !== 'undefined' ? window : undefined;\n  }\n\n  get sessionStorage(): Storage {\n    return this.nativeWindow ? this.nativeWindow.sessionStorage : undefined;\n  }\n\n  get localStorage(): Storage {\n    return this.nativeWindow ? this.nativeWindow.localStorage : undefined;\n  }\n\n  /**\n   * Returns an observable for the window resize event and emits an event\n   * every 300ms in case of resizing. An event is simulated initially.\n   *\n   * If there's no window object availale (i.e. in SSR), a null value is emitted.\n   */\n  get resize$(): Observable<any> {\n    if (!this.nativeWindow) {\n      return of(null);\n    } else {\n      return fromEvent(this.nativeWindow, 'resize').pipe(\n        debounceTime(300),\n        startWith({ target: this.nativeWindow }),\n        distinctUntilChanged()\n      );\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { UrlSegmentGroup, PRIMARY_OUTLET } from '@angular/router';\n\n@Injectable({ providedIn: 'root' })\nexport class UrlParsingService {\n  constructor(private router: Router) {}\n\n  getPrimarySegments(url: string): string[] {\n    const urlTree = this.router.parseUrl(url);\n    return this._getPrimarySegmentsFromUrlTree(urlTree.root);\n  }\n\n  private _getPrimarySegmentsFromUrlTree(tree: UrlSegmentGroup): string[] {\n    const segments = tree.segments.map(s => s.path);\n    const childrenSegments = tree.children[PRIMARY_OUTLET]\n      ? this._getPrimarySegmentsFromUrlTree(tree.children[PRIMARY_OUTLET])\n      : [];\n    return segments.concat(childrenSegments);\n  }\n}\n","export const isParam = (segment: string): boolean => segment.startsWith(':');\n\nexport const getParamName = (segment: string): string => segment.slice(1); // it just removes leading ':'\n\nexport const ensureLeadingSlash = (path: string): string =>\n  path.startsWith('/') ? path : '/' + path;\n\nexport const removeLeadingSlash = (path: string): string =>\n  path.startsWith('/') ? path.slice(1) : path;\n","import { RoutesConfig } from '../routes-config';\n\nexport abstract class RoutingConfig {\n  routing?: {\n    /**\n     * Configuration of semantic routes. Key is route's name. Value is the config specific to this route.\n     */\n    routes?: RoutesConfig;\n\n    /**\n     * When true, it closes the storefront for unauthorized users, except from routes that have individual config flag `protected: false`\n     */\n    protected?: boolean;\n  };\n}\n","import { Injectable, isDevMode } from '@angular/core';\nimport { RouteConfig } from './routes-config';\nimport { RoutingConfig } from './config/routing-config';\n\n@Injectable({ providedIn: 'root' })\nexport class RoutingConfigService {\n  constructor(protected config: RoutingConfig) {}\n\n  getRouteConfig(routeName: string): RouteConfig {\n    const routeConfig =\n      this.config && this.config.routing && this.config.routing.routes;\n\n    const result = routeConfig && routeConfig[routeName];\n    if (!routeConfig || result === undefined) {\n      this.warn(`No path was configured for the named route '${routeName}'!`);\n    }\n    return result;\n  }\n\n  private warn(...args) {\n    if (isDevMode()) {\n      console.warn(...args);\n    }\n  }\n}\n","import { Injectable, isDevMode } from '@angular/core';\nimport { UrlParsingService } from './url-parsing.service';\nimport { RouteConfig, ParamsMapping } from '../routes-config';\nimport { getParamName, isParam } from './path-utils';\nimport { UrlCommandRoute, UrlCommands, UrlCommand } from './url-command';\nimport { RoutingConfigService } from '../routing-config.service';\n\n@Injectable({ providedIn: 'root' })\nexport class SemanticPathService {\n  readonly ROOT_URL = ['/'];\n\n  constructor(\n    protected routingConfigService: RoutingConfigService,\n    protected urlParser: UrlParsingService\n  ) {}\n\n  /**\n   * Returns the first path alias configured for a given route name. It adds `/` at the beginning.\n   */\n  get(routeName: string): string {\n    const routeConfig = this.routingConfigService.getRouteConfig(routeName);\n    return routeConfig && Array.isArray(routeConfig.paths)\n      ? '/' + routeConfig.paths[0]\n      : undefined;\n  }\n\n  /**\n   * Transforms the array of url commands. Each command can be:\n   * a) string - will be left untouched\n   * b) object { cxRoute: <route name> } - will be replaced with semantic path\n   * c) object { cxRoute: <route name>, params: { ... } } - same as above, but with passed params\n   *\n   * If the first command is the object with the `cxRoute` property, returns an absolute url (with the first element of the array `'/'`)\n   */\n  transform(commands: UrlCommands): any[] {\n    if (!Array.isArray(commands)) {\n      commands = [commands];\n    }\n\n    const result: string[] = [];\n    for (const command of commands) {\n      if (!this.isRouteCommand(command)) {\n        // don't modify segment that is not route command:\n        result.push(command);\n      } else {\n        // generate array with url segments for given route command:\n        const partialResult = this.generateUrlPart(command);\n\n        if (partialResult === null) {\n          return this.ROOT_URL;\n        }\n\n        result.push(...partialResult);\n      }\n    }\n\n    if (this.shouldOutputAbsolute(commands)) {\n      result.unshift('/');\n    }\n\n    return result;\n  }\n\n  private isRouteCommand(command: UrlCommand): boolean {\n    return command && Boolean(command.cxRoute);\n  }\n\n  private shouldOutputAbsolute(commands: UrlCommands): boolean {\n    return this.isRouteCommand(commands[0]);\n  }\n\n  private generateUrlPart(command: UrlCommandRoute): string[] | null {\n    this.standarizeRouteCommand(command);\n\n    if (!command.cxRoute) {\n      return null;\n    }\n\n    const routeConfig = this.routingConfigService.getRouteConfig(\n      command.cxRoute\n    );\n\n    // if no route translation was configured, return null:\n    if (!routeConfig || !routeConfig.paths) {\n      return null;\n    }\n\n    // find first path that can satisfy it's parameters with given parameters\n    const path = this.findPathWithFillableParams(routeConfig, command.params);\n\n    // if there is no configured path that can be satisfied with given params, return null\n    if (!path) {\n      return null;\n    }\n\n    const result = this.provideParamsValues(\n      path,\n      command.params,\n      routeConfig.paramsMapping\n    );\n\n    return result;\n  }\n\n  private standarizeRouteCommand(command: UrlCommandRoute): void {\n    command.params = command.params || {};\n  }\n\n  private provideParamsValues(\n    path: string,\n    params: object,\n    paramsMapping: ParamsMapping\n  ): string[] {\n    return this.urlParser.getPrimarySegments(path).map(segment => {\n      if (isParam(segment)) {\n        const paramName = getParamName(segment);\n        const mappedParamName = this.getMappedParamName(\n          paramName,\n          paramsMapping\n        );\n        return params[mappedParamName];\n      }\n      return segment;\n    });\n  }\n\n  private findPathWithFillableParams(\n    routeConfig: RouteConfig,\n    params: object\n  ): string {\n    const foundPath = routeConfig.paths.find(path =>\n      this.getParams(path).every(paramName => {\n        const mappedParamName = this.getMappedParamName(\n          paramName,\n          routeConfig.paramsMapping\n        );\n\n        return params[mappedParamName] !== undefined;\n      })\n    );\n\n    if (foundPath === undefined || foundPath === null) {\n      this.warn(\n        `No configured path matches all its params to given object. `,\n        `Route config: `,\n        routeConfig,\n        `Params object: `,\n        params\n      );\n      return null;\n    }\n    return foundPath;\n  }\n\n  private getParams(path: string) {\n    return this.urlParser\n      .getPrimarySegments(path)\n      .filter(isParam)\n      .map(getParamName);\n  }\n\n  private getMappedParamName(paramName: string, paramsMapping: object): string {\n    if (paramsMapping) {\n      return paramsMapping[paramName] || paramName;\n    }\n    return paramName;\n  }\n\n  private warn(...args) {\n    if (isDevMode()) {\n      console.warn(...args);\n    }\n  }\n}\n","import { NavigationExtras } from '@angular/router';\nimport { Action } from '@ngrx/store';\n\nexport const ROUTER_GO = '[Router] Go';\nexport const ROUTER_GO_BY_URL = '[Router] Go By Url';\nexport const ROUTER_BACK = '[Router] Back';\nexport const ROUTER_FORWARD = '[Router] Forward';\n\nexport class RouteGoAction implements Action {\n  readonly type = ROUTER_GO;\n  constructor(\n    public payload: {\n      path: string[];\n      query?: object;\n      extras?: NavigationExtras;\n    }\n  ) {}\n}\n\nexport class RouteGoByUrlAction implements Action {\n  readonly type = ROUTER_GO_BY_URL;\n  constructor(public payload: string) {}\n}\n\nexport class RouteBackAction implements Action {\n  readonly type = ROUTER_BACK;\n}\n\nexport class RouteForwardAction implements Action {\n  readonly type = ROUTER_FORWARD;\n}\n\nexport type RoutingAction =\n  | RouteGoAction\n  | RouteGoByUrlAction\n  | RouteBackAction\n  | RouteForwardAction;\n","import {\n  createFeatureSelector,\n  createSelector,\n  MemoizedSelector,\n} from '@ngrx/store';\nimport { PageContext } from '../../models/page-context.model';\nimport { RouterState, ROUTING_FEATURE, State } from '../routing-state';\n\nexport const getRouterFeatureState: MemoizedSelector<\n  any,\n  State\n> = createFeatureSelector<State>(ROUTING_FEATURE);\n\nexport const getRouterState: MemoizedSelector<\n  any,\n  RouterState\n> = createSelector(getRouterFeatureState, state => state.router);\n\nexport const getPageContext: MemoizedSelector<\n  any,\n  PageContext\n> = createSelector(\n  getRouterState,\n  (routingState: RouterState) =>\n    (routingState.state && routingState.state.context) || { id: '' }\n);\n\nexport const getNextPageContext: MemoizedSelector<\n  any,\n  PageContext\n> = createSelector(\n  getRouterState,\n  (routingState: RouterState) =>\n    routingState.nextState && routingState.nextState.context\n);\n\nexport const isNavigating: MemoizedSelector<any, boolean> = createSelector(\n  getNextPageContext,\n  context => !!context\n);\n","import { Params } from '@angular/router';\nimport * as fromNgrxRouter from '@ngrx/router-store';\nimport { PageContext } from '../models/page-context.model';\n\nexport const ROUTING_FEATURE = 'router';\n\nexport interface RouterState\n  extends fromNgrxRouter.RouterReducerState<ActivatedRouterStateSnapshot> {\n  nextState?: ActivatedRouterStateSnapshot;\n}\n\nexport interface ActivatedRouterStateSnapshot {\n  url: string;\n  queryParams: Params;\n  params: Params;\n  context: PageContext;\n  cmsRequired: boolean;\n}\n\nexport interface State {\n  [ROUTING_FEATURE]: RouterState;\n}\n","import { Injectable } from '@angular/core';\nimport { NavigationExtras } from '@angular/router';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { WindowRef } from '../../window/window-ref';\nimport { SemanticPathService } from '../configurable-routes/url-translation/semantic-path.service';\nimport { UrlCommands } from '../configurable-routes/url-translation/url-command';\nimport { PageContext } from '../models/page-context.model';\nimport { RoutingActions } from '../store/actions/index';\nimport { RouterState } from '../store/routing-state';\nimport { RoutingSelector } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class RoutingService {\n  constructor(\n    protected store: Store<RouterState>,\n    protected winRef: WindowRef,\n    protected semanticPathService: SemanticPathService\n  ) {}\n\n  /**\n   * Get the current router state\n   */\n  getRouterState(): Observable<RouterState> {\n    return this.store.pipe(select(RoutingSelector.getRouterState));\n  }\n\n  /**\n   * Get the `PageContext` from the state\n   */\n  getPageContext(): Observable<PageContext> {\n    return this.store.pipe(select(RoutingSelector.getPageContext));\n  }\n\n  /**\n   * Get the next `PageContext` from the state\n   */\n  getNextPageContext(): Observable<PageContext> {\n    return this.store.pipe(select(RoutingSelector.getNextPageContext));\n  }\n\n  /**\n   * Get the `isNavigating` info from the state\n   */\n  isNavigating(): Observable<boolean> {\n    return this.store.pipe(select(RoutingSelector.isNavigating));\n  }\n\n  /**\n   * Navigation with a new state into history\n   * @param commands: url commands\n   * @param query\n   * @param extras: Represents the extra options used during navigation.\n   */\n  go(commands: UrlCommands, query?: object, extras?: NavigationExtras): void {\n    const path = this.semanticPathService.transform(commands);\n\n    return this.navigate(path, query, extras);\n  }\n\n  /**\n   * Navigation using URL\n   * @param url\n   */\n  goByUrl(url: string) {\n    this.store.dispatch(new RoutingActions.RouteGoByUrlAction(url));\n  }\n\n  /**\n   * Navigating back\n   */\n  back(): void {\n    const isLastPageInApp = this.winRef.document.referrer.includes(\n      this.winRef.nativeWindow.location.origin\n    );\n    if (isLastPageInApp) {\n      this.store.dispatch(new RoutingActions.RouteBackAction());\n      return;\n    }\n    this.go(['/']);\n    return;\n  }\n\n  /**\n   * Navigating forward\n   */\n  forward(): void {\n    this.store.dispatch(new RoutingActions.RouteForwardAction());\n  }\n\n  /**\n   * Navigation with a new state into history\n   * @param path\n   * @param query\n   * @param extras: Represents the extra options used during navigation.\n   */\n  protected navigate(\n    path: any[],\n    query?: object,\n    extras?: NavigationExtras\n  ): void {\n    this.store.dispatch(\n      new RoutingActions.RouteGoAction({\n        path,\n        query,\n        extras,\n      })\n    );\n  }\n}\n","import { HttpEvent, HttpHandler, HttpRequest } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { filter, switchMap, take, tap } from 'rxjs/operators';\nimport { RoutingService } from '../../../routing/facade/routing.service';\nimport { AuthService } from '../../facade/auth.service';\nimport { UserToken } from '../../models/token-types.model';\n\n@Injectable()\nexport class UserErrorHandlingService {\n  constructor(\n    protected authService: AuthService,\n    protected routingService: RoutingService\n  ) {}\n\n  public handleExpiredUserToken(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<UserToken>> {\n    return this.handleExpiredToken().pipe(\n      switchMap((token: UserToken) => {\n        return next.handle(this.createNewRequestWithNewToken(request, token));\n      })\n    );\n  }\n\n  public handleExpiredRefreshToken(): void {\n    // Logout user\n    this.authService.logout();\n  }\n\n  protected handleExpiredToken(): Observable<UserToken> {\n    let oldToken: UserToken;\n    return this.authService.getUserToken().pipe(\n      tap((token: UserToken) => {\n        if (token.access_token && token.refresh_token && !oldToken) {\n          this.authService.refreshUserToken(token);\n        } else if (!token.access_token && !token.refresh_token) {\n          this.routingService.go({ cxRoute: 'login' });\n        } else if (!token.refresh_token) {\n          this.authService.logout();\n          this.routingService.go({ cxRoute: 'login' });\n        }\n        oldToken = oldToken || token;\n      }),\n      filter(\n        (token: UserToken) => oldToken.access_token !== token.access_token\n      ),\n      take(1)\n    );\n  }\n\n  protected createNewRequestWithNewToken(\n    request: HttpRequest<any>,\n    token: UserToken\n  ): HttpRequest<any> {\n    request = request.clone({\n      setHeaders: {\n        Authorization: `${token.token_type} ${token.access_token}`,\n      },\n    });\n    return request;\n  }\n}\n","import {\n  HttpErrorResponse,\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../occ/utils/interceptor-util';\nimport { AuthService } from '../facade/auth.service';\nimport { ClientErrorHandlingService } from '../services/client-error/client-error-handling.service';\nimport { UserErrorHandlingService } from '../services/user-error/user-error-handling.service';\n\nconst OAUTH_ENDPOINT = '/authorizationserver/oauth/token';\n\n@Injectable({ providedIn: 'root' })\nexport class AuthErrorInterceptor implements HttpInterceptor {\n  constructor(\n    private userErrorHandlingService: UserErrorHandlingService,\n    private clientErrorHandlingService: ClientErrorHandlingService,\n    private authService: AuthService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    const isClientTokenRequest = this.isClientTokenRequest(request);\n    if (isClientTokenRequest) {\n      request = InterceptorUtil.removeHeader(USE_CLIENT_TOKEN, request);\n    }\n\n    return next.handle(request).pipe(\n      catchError((errResponse: any) => {\n        if (errResponse instanceof HttpErrorResponse) {\n          switch (errResponse.status) {\n            case 401: // Unauthorized\n              if (isClientTokenRequest) {\n                if (this.isExpiredToken(errResponse)) {\n                  return this.clientErrorHandlingService.handleExpiredClientToken(\n                    request,\n                    next\n                  );\n                }\n                // user token request\n              } else {\n                if (this.isExpiredToken(errResponse)) {\n                  return this.userErrorHandlingService.handleExpiredUserToken(\n                    request,\n                    next\n                  );\n                } else if (\n                  // Refresh expired token\n                  // Check that the OAUTH endpoint was called and the error is for refresh token is expired\n                  errResponse.url.includes(OAUTH_ENDPOINT) &&\n                  errResponse.error.error === 'invalid_token'\n                ) {\n                  this.userErrorHandlingService.handleExpiredRefreshToken();\n                  return of();\n                }\n              }\n              break;\n            case 400: // Bad Request\n              if (\n                errResponse.url.includes(OAUTH_ENDPOINT) &&\n                errResponse.error.error === 'invalid_grant'\n              ) {\n                if (request.body.get('grant_type') === 'refresh_token') {\n                  // refresh token fail, force user logout\n                  this.authService.logout();\n                }\n              }\n              break;\n          }\n        }\n        return throwError(errResponse);\n      })\n    );\n  }\n\n  private isClientTokenRequest(request: HttpRequest<any>): boolean {\n    const isRequestMapping = InterceptorUtil.getInterceptorParam(\n      USE_CLIENT_TOKEN,\n      request.headers\n    );\n    return Boolean(isRequestMapping);\n  }\n\n  private isExpiredToken(resp: HttpErrorResponse): boolean {\n    if (\n      resp.error &&\n      resp.error.errors &&\n      resp.error.errors instanceof Array &&\n      resp.error.errors[0]\n    ) {\n      return resp.error.errors[0].type === 'InvalidTokenError';\n    }\n    return false;\n  }\n}\n","export class DynamicTemplate {\n  static resolve(templateString: string, templateVariables: Object) {\n    for (const variableLabel of Object.keys(templateVariables)) {\n      const placeholder = new RegExp('\\\\${' + variableLabel + '}', 'g');\n      templateString = templateString.replace(\n        placeholder,\n        templateVariables[variableLabel]\n      );\n    }\n    return templateString;\n  }\n}\n","import { SiteContextConfig } from './site-context-config';\n\n/**\n * Helper function for safely getting context parameter config\n *\n * @param config\n * @param parameter\n */\nexport function getContextParameterValues(\n  config: SiteContextConfig,\n  parameter: string\n): string[] {\n  return (config.context && config.context[parameter]) || [];\n}\n\n/**\n * Helper function for calculating default value for context parameter from config\n *\n * @param config\n * @param parameter\n */\nexport function getContextParameterDefault(\n  config: SiteContextConfig,\n  parameter: string\n): string {\n  const param = getContextParameterValues(config, parameter);\n  return param && param.length ? param[0] : undefined;\n}\n","import { Action } from '@ngrx/store';\nimport { BaseSite } from '../../../model/misc.model';\n\nexport const LOAD_BASE_SITE = '[Site-context] Load BaseSite';\nexport const LOAD_BASE_SITE_FAIL = '[Site-context] Load BaseSite Fail';\nexport const LOAD_BASE_SITE_SUCCESS = '[Site-context] Load BaseSite Success';\nexport const SET_ACTIVE_BASE_SITE = '[Site-context] Set Active BaseSite';\nexport const BASE_SITE_CHANGE = '[Site-context] BaseSite Change';\n\nexport class LoadBaseSite implements Action {\n  readonly type = LOAD_BASE_SITE;\n}\n\nexport class LoadBaseSiteFail implements Action {\n  readonly type = LOAD_BASE_SITE_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadBaseSiteSuccess implements Action {\n  readonly type = LOAD_BASE_SITE_SUCCESS;\n  constructor(public payload: BaseSite) {}\n}\n\nexport class SetActiveBaseSite implements Action {\n  readonly type = SET_ACTIVE_BASE_SITE;\n  constructor(public payload: string) {}\n}\n\nexport class BaseSiteChange implements Action {\n  readonly type = BASE_SITE_CHANGE;\n}\n\n// action types\nexport type BaseSiteAction =\n  | LoadBaseSite\n  | LoadBaseSiteFail\n  | LoadBaseSiteSuccess\n  | SetActiveBaseSite\n  | BaseSiteChange;\n","export enum StorageSyncType {\n  NO_STORAGE = 'NO_STORAGE',\n  LOCAL_STORAGE = 'LOCAL_STORAGE',\n  SESSION_STORAGE = 'SESSION_STORAGE',\n}\n\nexport enum StateTransferType {\n  TRANSFER_STATE = 'SSR',\n}\n\nexport abstract class StateConfig {\n  state?: {\n    storageSync?: {\n      /**\n       * A key name for the data stored in `localStorage`.\n       * Default is `DEFAULT_LOCAL_STORAGE_KEY`.\n       */\n      localStorageKeyName?: string;\n      /**\n       * A key name for the data stored in `sessionStorage`.\n       * Default is `DEFAULT_SESSION_STORAGE_KEY`.\n       */\n      sessionStorageKeyName?: string;\n      /**\n       * A set of state keys that should be synced with the specified browser's storage.\n       */\n      keys?: {\n        [key: string]: StorageSyncType;\n      };\n      /**\n       * A set of keys not to sync with the specified browser's storage.\n       */\n      excludeKeys?: {\n        [key: string]: StorageSyncType;\n      };\n    };\n    ssrTransfer?: {\n      keys?: {\n        /**\n         * A set of state keys that should be transferred from server.\n         */\n        [key: string]: StateTransferType;\n      };\n    };\n  };\n}\n","import { Action } from '@ngrx/store';\nimport { Currency } from '../../../model/misc.model';\n\nexport const LOAD_CURRENCIES = '[Site-context] Load Currencies';\nexport const LOAD_CURRENCIES_FAIL = '[Site-context] Load Currencies Fail';\nexport const LOAD_CURRENCIES_SUCCESS = '[Site-context] Load Currencies Success';\nexport const SET_ACTIVE_CURRENCY = '[Site-context] Set Active Currency';\nexport const CURRENCY_CHANGE = '[Site-context] Currency Change';\n\nexport class LoadCurrencies implements Action {\n  readonly type = LOAD_CURRENCIES;\n}\n\nexport class LoadCurrenciesFail implements Action {\n  readonly type = LOAD_CURRENCIES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadCurrenciesSuccess implements Action {\n  readonly type = LOAD_CURRENCIES_SUCCESS;\n  constructor(public payload: Currency[]) {}\n}\n\nexport class SetActiveCurrency implements Action {\n  readonly type = SET_ACTIVE_CURRENCY;\n  constructor(public payload: string) {}\n}\n\nexport class CurrencyChange implements Action {\n  readonly type = CURRENCY_CHANGE;\n}\n\n// action types\nexport type CurrenciesAction =\n  | LoadCurrencies\n  | LoadCurrenciesFail\n  | LoadCurrenciesSuccess\n  | SetActiveCurrency\n  | CurrencyChange;\n","import { Action } from '@ngrx/store';\nimport { Language } from '../../../model/misc.model';\n\nexport const LOAD_LANGUAGES = '[Site-context] Load Languages';\nexport const LOAD_LANGUAGES_FAIL = '[Site-context] Load Languages Fail';\nexport const LOAD_LANGUAGES_SUCCESS = '[Site-context] Load Languages Success';\nexport const SET_ACTIVE_LANGUAGE = '[Site-context] Set Active Language';\nexport const LANGUAGE_CHANGE = '[Site-context] Language Change';\n\nexport class LoadLanguages implements Action {\n  readonly type = LOAD_LANGUAGES;\n}\n\nexport class LoadLanguagesFail implements Action {\n  readonly type = LOAD_LANGUAGES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadLanguagesSuccess implements Action {\n  readonly type = LOAD_LANGUAGES_SUCCESS;\n  constructor(public payload: Language[]) {}\n}\n\nexport class SetActiveLanguage implements Action {\n  readonly type = SET_ACTIVE_LANGUAGE;\n  constructor(public payload: string) {}\n}\n\nexport class LanguageChange implements Action {\n  readonly type = LANGUAGE_CHANGE;\n}\n\n// action types\nexport type LanguagesAction =\n  | LoadLanguages\n  | LoadLanguagesFail\n  | LoadLanguagesSuccess\n  | SetActiveLanguage\n  | LanguageChange;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  SiteContextState,\n  SITE_CONTEXT_FEATURE,\n  StateWithSiteContext,\n} from '../state';\n\nexport const getSiteContextState: MemoizedSelector<\n  StateWithSiteContext,\n  SiteContextState\n> = createFeatureSelector<SiteContextState>(SITE_CONTEXT_FEATURE);\n","import { Currency, Language, BaseSite } from '../../model/misc.model';\nexport const SITE_CONTEXT_FEATURE = 'siteContext';\n\nexport interface StateWithSiteContext {\n  [SITE_CONTEXT_FEATURE]: SiteContextState;\n}\n\nexport interface SiteContextState {\n  languages: LanguagesState;\n  currencies: CurrenciesState;\n  baseSite: BaseSiteState;\n}\n\nexport interface CurrencyEntities {\n  [isocode: string]: Currency;\n}\n\nexport interface CurrenciesState {\n  entities: CurrencyEntities;\n  activeCurrency: string;\n}\nexport interface LanguagesEntities {\n  [isocode: string]: Language;\n}\n\nexport interface LanguagesState {\n  entities: LanguagesEntities;\n  activeLanguage: string;\n}\n\nexport interface BaseSiteState {\n  activeSite: string;\n  details: BaseSite;\n}\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { BaseSite } from '../../../model/misc.model';\nimport { SiteContextState, StateWithSiteContext } from '../state';\nimport { getSiteContextState } from './site-context.selector';\n\nexport const getActiveBaseSite: MemoizedSelector<\n  StateWithSiteContext,\n  string\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) =>\n    state && state.baseSite && state.baseSite.activeSite\n);\n\nexport const getBaseSiteData: MemoizedSelector<\n  StateWithSiteContext,\n  BaseSite\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) => state && state.baseSite && state.baseSite.details\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Currency } from '../../../model/misc.model';\nimport {\n  CurrenciesState,\n  CurrencyEntities,\n  SiteContextState,\n  StateWithSiteContext,\n} from '../state';\nimport { getSiteContextState } from './site-context.selector';\n\nconst currenciesEntitiesSelector = (state: CurrenciesState) => state.entities;\nconst activeCurrencySelector = (state: CurrenciesState) => state.activeCurrency;\n\nexport const getCurrenciesState: MemoizedSelector<\n  StateWithSiteContext,\n  CurrenciesState\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) => state.currencies\n);\n\nexport const getCurrenciesEntities: MemoizedSelector<\n  StateWithSiteContext,\n  CurrencyEntities\n> = createSelector(getCurrenciesState, currenciesEntitiesSelector);\n\nexport const getActiveCurrency: MemoizedSelector<\n  StateWithSiteContext,\n  string\n> = createSelector(getCurrenciesState, activeCurrencySelector);\n\nexport const getAllCurrencies: MemoizedSelector<\n  StateWithSiteContext,\n  Currency[]\n> = createSelector(getCurrenciesEntities, entities => {\n  return entities\n    ? Object.keys(entities).map(isocode => entities[isocode])\n    : null;\n});\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Language } from '../../../model/misc.model';\nimport {\n  LanguagesEntities,\n  LanguagesState,\n  SiteContextState,\n  StateWithSiteContext,\n} from '../state';\nimport { getSiteContextState } from './site-context.selector';\n\nconst activeLanguageSelector = (state: LanguagesState) => state.activeLanguage;\nconst languagesEntitiesSelector = (state: LanguagesState) => state.entities;\n\nexport const getLanguagesState: MemoizedSelector<\n  StateWithSiteContext,\n  LanguagesState\n> = createSelector(\n  getSiteContextState,\n  (state: SiteContextState) => state.languages\n);\n\nexport const getLanguagesEntities: MemoizedSelector<\n  StateWithSiteContext,\n  LanguagesEntities\n> = createSelector(getLanguagesState, languagesEntitiesSelector);\n\nexport const getActiveLanguage: MemoizedSelector<\n  StateWithSiteContext,\n  string\n> = createSelector(getLanguagesState, activeLanguageSelector);\n\nexport const getAllLanguages: MemoizedSelector<\n  StateWithSiteContext,\n  Language[]\n> = createSelector(getLanguagesEntities, entities => {\n  return entities\n    ? Object.keys(entities).map(isocode => entities[isocode])\n    : null;\n});\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable, Subscription } from 'rxjs';\nimport { filter, map, take, tap } from 'rxjs/operators';\nimport { BaseSite } from '../../model/misc.model';\nimport { SiteContextActions } from '../store/actions/index';\nimport { SiteContextSelectors } from '../store/selectors/index';\nimport { StateWithSiteContext } from '../store/state';\nimport { SiteContext } from './site-context.interface';\nimport { SiteContextConfig } from '../config/site-context-config';\nimport { getContextParameterDefault } from '../config/context-config-utils';\nimport { BASE_SITE_CONTEXT_ID } from '../providers/context-ids';\n\n@Injectable()\nexport class BaseSiteService implements SiteContext<string> {\n  constructor(\n    protected store: Store<StateWithSiteContext>,\n    protected config: SiteContextConfig\n  ) {}\n\n  /**\n   * Represents the current baseSite uid.\n   */\n  getActive(): Observable<string> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getActiveBaseSite),\n      filter(active => Boolean(active))\n    );\n  }\n\n  /**\n   * We currently don't support switching baseSite at run time\n   */\n  getAll(): Observable<string[]> {\n    return this.getActive().pipe(map(baseSite => [baseSite]));\n  }\n\n  setActive(baseSite: string): Subscription {\n    return this.store\n      .pipe(select(SiteContextSelectors.getActiveBaseSite), take(1))\n      .subscribe(activeBaseSite => {\n        if (baseSite && activeBaseSite !== baseSite) {\n          this.store.dispatch(\n            new SiteContextActions.SetActiveBaseSite(baseSite)\n          );\n        }\n      });\n  }\n\n  /**\n   * Initializes the active baseSite.\n   */\n  initialize(): void {\n    this.setActive(\n      getContextParameterDefault(this.config, BASE_SITE_CONTEXT_ID)\n    );\n  }\n\n  /**\n   * Get the base site details data\n   */\n  getBaseSiteData(): Observable<BaseSite> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getBaseSiteData),\n      tap(baseSite => {\n        if (Object.keys(baseSite).length === 0) {\n          this.store.dispatch(new SiteContextActions.LoadBaseSite());\n        }\n      })\n    );\n  }\n}\n","export const LANGUAGE_CONTEXT_ID = 'language';\nexport const CURRENCY_CONTEXT_ID = 'currency';\nexport const BASE_SITE_CONTEXT_ID = 'baseSite';\n","import { HttpParams } from '@angular/common/http';\nimport { Injectable, isDevMode, Optional } from '@angular/core';\nimport { DynamicTemplate } from '../../config/utils/dynamic-template';\nimport { getContextParameterDefault } from '../../site-context/config/context-config-utils';\nimport { BaseSiteService } from '../../site-context/facade/base-site.service';\nimport { BASE_SITE_CONTEXT_ID } from '../../site-context/providers/context-ids';\nimport { OccConfig } from '../config/occ-config';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccEndpointsService {\n  private activeBaseSite: string;\n\n  private readonly SCOPE_SUFFIX = '_scopes';\n\n  constructor(\n    private config: OccConfig,\n    @Optional() private baseSiteService: BaseSiteService\n  ) {\n    this.activeBaseSite =\n      getContextParameterDefault(this.config, BASE_SITE_CONTEXT_ID) || '';\n\n    if (this.baseSiteService) {\n      this.baseSiteService\n        .getActive()\n        .subscribe(value => (this.activeBaseSite = value));\n    }\n  }\n\n  /**\n   * Returns and endpoint starting from the OCC baseUrl (no baseSite)\n   * @param endpoint Endpoint suffix\n   */\n  getRawEndpoint(endpoint: string): string {\n    if (!this.config || !this.config.backend || !this.config.backend.occ) {\n      return '';\n    }\n    endpoint = this.config.backend.occ.endpoints[endpoint];\n\n    if (!endpoint.startsWith('/')) {\n      endpoint = '/' + endpoint;\n    }\n\n    return this.config.backend.occ.baseUrl + endpoint;\n  }\n\n  /**\n   * Returns base OCC endpoint (baseUrl + prefix + baseSite)\n   */\n  getBaseEndpoint(): string {\n    if (!this.config || !this.config.backend || !this.config.backend.occ) {\n      return '';\n    }\n\n    return (\n      (this.config.backend.occ.baseUrl || '') +\n      this.config.backend.occ.prefix +\n      this.activeBaseSite\n    );\n  }\n\n  /**\n   * Returns an OCC endpoint including baseUrl and baseSite\n   * @param endpoint Endpoint suffix\n   */\n  getEndpoint(endpoint: string): string {\n    if (!endpoint.startsWith('/')) {\n      endpoint = '/' + endpoint;\n    }\n    return this.getBaseEndpoint() + endpoint;\n  }\n\n  /**\n   * Returns a fully qualified OCC Url (including baseUrl and baseSite)\n   * @param endpoint Name of the OCC endpoint key config\n   * @param urlParams  URL parameters\n   * @param queryParams Query parameters\n   * @param scope\n   */\n  getUrl(\n    endpoint: string,\n    urlParams?: object,\n    queryParams?: object,\n    scope = ''\n  ): string {\n    endpoint = this.getEndpointForScope(endpoint, scope);\n\n    if (urlParams) {\n      Object.keys(urlParams).forEach(key => {\n        urlParams[key] = encodeURIComponent(urlParams[key]);\n      });\n      endpoint = DynamicTemplate.resolve(endpoint, urlParams);\n    }\n\n    if (queryParams) {\n      let httpParamsOptions;\n\n      if (endpoint.includes('?')) {\n        let queryParamsFromEndpoint;\n        [endpoint, queryParamsFromEndpoint] = endpoint.split('?');\n\n        httpParamsOptions = { fromString: queryParamsFromEndpoint };\n      }\n\n      let httpParams = new HttpParams(httpParamsOptions);\n      Object.keys(queryParams).forEach(key => {\n        const value = queryParams[key];\n        if (value !== undefined) {\n          if (value === null) {\n            httpParams = httpParams.delete(key);\n          } else {\n            httpParams = httpParams.set(key, value);\n          }\n        }\n      });\n\n      const params = httpParams.toString();\n      if (params.length) {\n        endpoint += '?' + params;\n      }\n    }\n\n    return this.getEndpoint(endpoint);\n  }\n\n  private getEndpointForScope(endpoint: string, scope: string): string {\n    const endpointsConfig =\n      this.config.backend &&\n      this.config.backend.occ &&\n      this.config.backend.occ.endpoints;\n\n    if (scope) {\n      const endpointConfig = endpointsConfig[`${endpoint}${this.SCOPE_SUFFIX}`];\n      if (endpointConfig && endpointConfig[scope]) {\n        return endpointConfig[scope];\n      }\n      if (isDevMode()) {\n        console.warn(\n          `${endpoint} endpoint configuration missing for scope \"${scope}\"`\n        );\n      }\n    }\n\n    return endpointsConfig[endpoint] || endpoint;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  HttpInterceptor,\n  HttpRequest,\n  HttpHandler,\n  HttpEvent,\n} from '@angular/common/http';\n\nimport { Observable, of } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\n\nimport { AuthService } from '../facade/auth.service';\nimport {\n  USE_CLIENT_TOKEN,\n  InterceptorUtil,\n} from '../../occ/utils/interceptor-util';\nimport { ClientToken } from '../models/token-types.model';\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\n\n@Injectable({ providedIn: 'root' })\nexport class ClientTokenInterceptor implements HttpInterceptor {\n  constructor(\n    private authService: AuthService,\n    private occEndpoints: OccEndpointsService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return this.getClientToken(request).pipe(\n      take(1),\n      switchMap((token: ClientToken) => {\n        if (\n          token &&\n          request.url.includes(this.occEndpoints.getBaseEndpoint())\n        ) {\n          request = request.clone({\n            setHeaders: {\n              Authorization: `${token.token_type} ${token.access_token}`,\n            },\n          });\n        }\n        return next.handle(request);\n      })\n    );\n  }\n\n  private getClientToken(request: HttpRequest<any>): Observable<ClientToken> {\n    if (\n      InterceptorUtil.getInterceptorParam(USE_CLIENT_TOKEN, request.headers)\n    ) {\n      return this.authService.getClientToken();\n    }\n    return of(null);\n  }\n}\n","import {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\nimport { AuthService } from '../facade/auth.service';\n\n@Injectable({ providedIn: 'root' })\nexport class UserTokenInterceptor implements HttpInterceptor {\n  constructor(\n    private authService: AuthService,\n    private occEndpoints: OccEndpointsService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return this.authService.getUserToken().pipe(\n      take(1),\n      switchMap(token => {\n        if (\n          token &&\n          this.isOccUrl(request.url) &&\n          !request.headers.get('Authorization')\n        ) {\n          request = request.clone({\n            setHeaders: {\n              Authorization: `${token.token_type} ${token.access_token}`,\n            },\n          });\n        }\n\n        return next.handle(request);\n      })\n    );\n  }\n\n  private isOccUrl(url: string): boolean {\n    return url.includes(this.occEndpoints.getBaseEndpoint());\n  }\n}\n","import {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { EMPTY, Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport {\n  InterceptorUtil,\n  TOKEN_REVOCATION_HEADER,\n} from '../../occ/utils/interceptor-util';\n\n@Injectable({ providedIn: 'root' })\nexport class TokenRevocationInterceptor implements HttpInterceptor {\n  constructor() {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    const isTokenRevocationRequest = this.isTokenRevocationRequest(request);\n    if (isTokenRevocationRequest) {\n      request = InterceptorUtil.removeHeader(TOKEN_REVOCATION_HEADER, request);\n    }\n\n    return next.handle(request).pipe(\n      catchError((error: any) => {\n        if (isTokenRevocationRequest) {\n          return EMPTY;\n        }\n        return throwError(error);\n      })\n    );\n  }\n\n  protected isTokenRevocationRequest(request: HttpRequest<any>): boolean {\n    const isTokenRevocationHeaderPresent = InterceptorUtil.getInterceptorParam<\n      string\n    >(TOKEN_REVOCATION_HEADER, request.headers);\n    return Boolean(isTokenRevocationHeaderPresent);\n  }\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Provider } from '@angular/core';\nimport { AuthErrorInterceptor } from './auth-error.interceptor';\nimport { ClientTokenInterceptor } from './client-token.interceptor';\nimport { UserTokenInterceptor } from './user-token.interceptor';\nimport { TokenRevocationInterceptor } from './token-revocation.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: ClientTokenInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: UserTokenInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: AuthErrorInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: TokenRevocationInterceptor,\n    multi: true,\n  },\n];\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { OccEndpointsService } from '../../../occ/services/occ-endpoints.service';\nimport { AuthConfig } from '../../config/auth-config';\nimport { ClientToken } from '../../models/token-types.model';\n\n@Injectable()\nexport class ClientAuthenticationTokenService {\n  constructor(\n    config: AuthConfig,\n    http: HttpClient,\n    // tslint:disable-next-line:unified-signatures\n    occEndpointsService: OccEndpointsService\n  );\n\n  /**\n   * @deprecated since version 1.1\n   * Use constructor(http: HttpClient, config: AuthConfig, occEndpointsService: OccEndpointsService) instead\n   */\n  constructor(config: AuthConfig, http: HttpClient);\n  constructor(\n    protected config: AuthConfig,\n    protected http: HttpClient,\n    protected occEndpointsService?: OccEndpointsService\n  ) {}\n\n  loadClientAuthenticationToken(): Observable<ClientToken> {\n    const url: string = this.occEndpointsService.getRawEndpoint('login');\n    const params = new HttpParams()\n      .set(\n        'client_id',\n        encodeURIComponent(this.config.authentication.client_id)\n      )\n      .set(\n        'client_secret',\n        encodeURIComponent(this.config.authentication.client_secret)\n      )\n      .set('grant_type', 'client_credentials');\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http.post<ClientToken>(url, params, { headers });\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { OccEndpointsService } from '../../../occ/services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  TOKEN_REVOCATION_HEADER,\n} from '../../../occ/utils/interceptor-util';\nimport { AuthConfig } from '../../config/auth-config';\nimport { UserToken } from '../../models/token-types.model';\n\n@Injectable()\nexport class UserAuthenticationTokenService {\n  constructor(\n    http: HttpClient,\n    config: AuthConfig,\n    // tslint:disable-next-line:unified-signatures\n    occEndpointsService: OccEndpointsService\n  );\n\n  /**\n   * @deprecated since version 1.1\n   * Use constructor(http: HttpClient, config: AuthConfig, occEndpointsService: OccEndpointsService) instead\n   */\n  constructor(http: HttpClient, config: AuthConfig);\n  constructor(\n    protected http: HttpClient,\n    protected config: AuthConfig,\n    protected occEndpointsService?: OccEndpointsService\n  ) {}\n\n  loadToken(userId: string, password: string): Observable<UserToken> {\n    const url = this.occEndpointsService.getRawEndpoint('login');\n    const params = new HttpParams()\n      .set('client_id', this.config.authentication.client_id)\n      .set('client_secret', this.config.authentication.client_secret)\n      .set('grant_type', 'password')\n      .set('username', userId)\n      .set('password', password);\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .post<UserToken>(url, params, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  refreshToken(refreshToken: string): Observable<UserToken> {\n    const url = this.occEndpointsService.getRawEndpoint('login');\n    const params = new HttpParams()\n      .set(\n        'client_id',\n        encodeURIComponent(this.config.authentication.client_id)\n      )\n      .set(\n        'client_secret',\n        encodeURIComponent(this.config.authentication.client_secret)\n      )\n      .set('refresh_token', encodeURI(refreshToken))\n      .set('grant_type', 'refresh_token');\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .post<UserToken>(url, params, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  revoke(userToken: UserToken): Observable<{}> {\n    const url = this.occEndpointsService.getRawEndpoint('revoke');\n    const headers = InterceptorUtil.createHeader(\n      TOKEN_REVOCATION_HEADER,\n      true,\n      new HttpHeaders({\n        Authorization: `${userToken.token_type} ${userToken.access_token}`,\n        'Content-Type': 'application/x-www-form-urlencoded',\n      })\n    );\n    const params = new HttpParams().set('token', userToken.access_token);\n    return this.http\n      .post<{}>(url, params, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { ClientAuthenticationTokenService } from './client-authentication/client-authentication-token.service';\nimport { ClientErrorHandlingService } from './client-error/client-error-handling.service';\nimport { UserAuthenticationTokenService } from './user-authentication/user-authentication-token.service';\nimport { UserErrorHandlingService } from './user-error/user-error-handling.service';\n\nexport const AuthServices: any[] = [\n  ClientAuthenticationTokenService,\n  ClientErrorHandlingService,\n  UserAuthenticationTokenService,\n  UserErrorHandlingService,\n];\n","import { StateConfig } from './state-config';\n\nexport const DEFAULT_LOCAL_STORAGE_KEY = 'spartacus-local-data';\nexport const DEFAULT_SESSION_STORAGE_KEY = 'spartacus-session-data';\n\nexport const defaultStateConfig: StateConfig = {\n  state: {\n    storageSync: {\n      localStorageKeyName: DEFAULT_LOCAL_STORAGE_KEY,\n      sessionStorageKeyName: DEFAULT_SESSION_STORAGE_KEY,\n      keys: {},\n      excludeKeys: {},\n    },\n  },\n};\n","import { Action, ActionReducer, INIT, MetaReducer, UPDATE } from '@ngrx/store';\nimport { deepMerge } from '../../config/utils/deep-merge';\nimport { WindowRef } from '../../window/window-ref';\nimport { StateConfig, StorageSyncType } from '../config/state-config';\nimport { filterKeysByType, getStateSlice } from '../utils/get-state-slice';\n\nexport function getStorageSyncReducer<T>(\n  winRef: WindowRef,\n  config?: StateConfig\n): MetaReducer<T, Action> {\n  if (\n    !winRef.nativeWindow ||\n    !config ||\n    !config.state ||\n    !config.state.storageSync ||\n    !config.state.storageSync.keys\n  ) {\n    return reducer => reducer;\n  }\n\n  const storageSyncConfig = config.state.storageSync;\n\n  return (reducer: ActionReducer<T, Action>): ActionReducer<T, Action> => {\n    return (state, action): T => {\n      const newState = reducer(state, action);\n\n      if (action.type === INIT || action.type === UPDATE) {\n        const rehydratedState = rehydrate(config, winRef);\n        return deepMerge({}, newState, rehydratedState);\n      }\n\n      if (action.type !== INIT) {\n        // handle local storage\n        const localStorageKeys = filterKeysByType(\n          storageSyncConfig.keys,\n          StorageSyncType.LOCAL_STORAGE\n        );\n        const localStorageExclusionKeys = filterKeysByType(\n          storageSyncConfig.excludeKeys,\n          StorageSyncType.LOCAL_STORAGE\n        );\n        const localStorageStateSlices = getStateSlice(\n          localStorageKeys,\n          localStorageExclusionKeys,\n          newState\n        );\n        persistToStorage(\n          config.state.storageSync.localStorageKeyName,\n          localStorageStateSlices,\n          winRef.localStorage\n        );\n\n        // handle session storage\n        const sessionStorageKeys = filterKeysByType(\n          storageSyncConfig.keys,\n          StorageSyncType.SESSION_STORAGE\n        );\n        const sessionStorageExclusionKeys = filterKeysByType(\n          storageSyncConfig.excludeKeys,\n          StorageSyncType.SESSION_STORAGE\n        );\n        const sessionStorageStateSlices = getStateSlice(\n          sessionStorageKeys,\n          sessionStorageExclusionKeys,\n          newState\n        );\n        persistToStorage(\n          config.state.storageSync.sessionStorageKeyName,\n          sessionStorageStateSlices,\n          winRef.sessionStorage\n        );\n      }\n\n      return newState;\n    };\n  };\n}\n\nexport function rehydrate<T>(config: StateConfig, winRef: WindowRef): T {\n  const localStorageValue = readFromStorage(\n    winRef.localStorage,\n    config.state.storageSync.localStorageKeyName\n  );\n  const sessionStorageValue = readFromStorage(\n    winRef.sessionStorage,\n    config.state.storageSync.sessionStorageKeyName\n  );\n\n  return deepMerge(localStorageValue, sessionStorageValue);\n}\n\nexport function exists(value: Object): boolean {\n  if (value != null) {\n    if (typeof value === 'object') {\n      return Object.keys(value).length !== 0;\n    }\n    return value !== '';\n  }\n  return false;\n}\n\nexport function getStorage(\n  storageType: StorageSyncType,\n  winRef: WindowRef\n): Storage {\n  let storage: Storage;\n\n  switch (storageType) {\n    case StorageSyncType.LOCAL_STORAGE: {\n      storage = winRef.localStorage;\n      break;\n    }\n    case StorageSyncType.SESSION_STORAGE: {\n      storage = winRef.sessionStorage;\n      break;\n    }\n    case StorageSyncType.NO_STORAGE: {\n      storage = undefined;\n      break;\n    }\n\n    default: {\n      storage = winRef.sessionStorage;\n    }\n  }\n\n  return storage;\n}\n\nexport function persistToStorage(\n  configKey: string,\n  value: any,\n  storage: Storage\n): void {\n  if (!isSsr(storage) && value) {\n    storage.setItem(configKey, JSON.stringify(value));\n  }\n}\n\nexport function readFromStorage(storage: Storage, key: string): any {\n  if (isSsr(storage)) {\n    return;\n  }\n\n  const storageValue = storage.getItem(key);\n  if (!storageValue) {\n    return;\n  }\n\n  return JSON.parse(storageValue);\n}\n\nexport function isSsr(storage: Storage): boolean {\n  return !Boolean(storage);\n}\n","import { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport {\n  makeStateKey,\n  StateKey,\n  TransferState,\n} from '@angular/platform-browser';\nimport { INIT } from '@ngrx/store';\nimport { AUTH_FEATURE, StateWithAuth } from '../../auth/store/auth-state';\nimport { deepMerge } from '../../config/utils/deep-merge';\nimport { StateConfig, StateTransferType } from '../config/state-config';\nimport { filterKeysByType, getStateSlice } from '../utils/get-state-slice';\n\nexport const CX_KEY: StateKey<string> = makeStateKey<string>('cx-state');\n\nexport function getTransferStateReducer(\n  platformId,\n  transferState?: TransferState,\n  config?: StateConfig\n) {\n  if (\n    transferState &&\n    config &&\n    config.state &&\n    config.state.ssrTransfer &&\n    config.state.ssrTransfer.keys\n  ) {\n    if (isPlatformBrowser(platformId)) {\n      return getBrowserTransferStateReducer(\n        transferState,\n        config.state.ssrTransfer.keys\n      );\n    } else if (isPlatformServer(platformId)) {\n      return getServerTransferStateReducer(\n        transferState,\n        config.state.ssrTransfer.keys\n      );\n    }\n  }\n\n  return reducer => reducer;\n}\n\nexport function getServerTransferStateReducer(\n  transferState: TransferState,\n  keys: { [key: string]: StateTransferType }\n) {\n  const transferStateKeys = filterKeysByType(\n    keys,\n    StateTransferType.TRANSFER_STATE\n  );\n\n  return function(reducer) {\n    return function(state, action: any) {\n      const newState = reducer(state, action);\n      if (newState) {\n        const stateSlice = getStateSlice(transferStateKeys, [], newState);\n        transferState.set(CX_KEY, stateSlice);\n      }\n\n      return newState;\n    };\n  };\n}\n\nexport function getBrowserTransferStateReducer(\n  transferState: TransferState,\n  keys: { [key: string]: StateTransferType }\n) {\n  const transferStateKeys = filterKeysByType(\n    keys,\n    StateTransferType.TRANSFER_STATE\n  );\n\n  return function(reducer) {\n    return function(state, action: any) {\n      if (action.type === INIT) {\n        if (!state) {\n          state = reducer(state, action);\n        }\n\n        // we should not utilize transfer state if user is logged in\n        const authState = (state as StateWithAuth)[AUTH_FEATURE];\n        const isLoggedIn =\n          authState && authState.userToken && authState.userToken.token;\n\n        if (!isLoggedIn && transferState.hasKey(CX_KEY)) {\n          const cxKey = transferState.get(CX_KEY, {});\n          const transferredStateSlice = getStateSlice(\n            transferStateKeys,\n            [],\n            cxKey\n          );\n\n          state = deepMerge({}, state, transferredStateSlice);\n        }\n        return state;\n      }\n      return reducer(state, action);\n    };\n  };\n}\n","import { Optional, PLATFORM_ID, Provider, InjectionToken } from '@angular/core';\nimport { TransferState } from '@angular/platform-browser';\nimport { META_REDUCERS } from '@ngrx/store';\nimport { Config } from '../../config/config.module';\nimport { WindowRef } from '../../window/window-ref';\nimport { getStorageSyncReducer } from './storage-sync.reducer';\nimport { getTransferStateReducer } from './transfer-state.reducer';\n\nexport { getStateSlice } from '../utils/get-state-slice';\nexport { getStorageSyncReducer } from './storage-sync.reducer';\nexport * from './transfer-state.reducer';\n\nexport const TRANSFER_STATE_META_REDUCER = new InjectionToken(\n  'TransferStateMetaReducer'\n);\nexport const STORAGE_SYNC_META_REDUCER = new InjectionToken(\n  'StorageSyncMetaReducer'\n);\n\nexport const stateMetaReducers: Provider[] = [\n  {\n    provide: TRANSFER_STATE_META_REDUCER,\n    useFactory: getTransferStateReducer,\n    deps: [\n      PLATFORM_ID,\n      [new Optional(), TransferState],\n      [new Optional(), Config],\n    ],\n  },\n  {\n    provide: STORAGE_SYNC_META_REDUCER,\n    useFactory: getStorageSyncReducer,\n    deps: [WindowRef, [new Optional(), Config]],\n  },\n  {\n    provide: META_REDUCERS,\n    useExisting: TRANSFER_STATE_META_REDUCER,\n    multi: true,\n  },\n  {\n    provide: META_REDUCERS,\n    useExisting: STORAGE_SYNC_META_REDUCER,\n    multi: true,\n  },\n];\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { defaultStateConfig } from './config/default-state-config';\nimport { StateConfig } from './config/state-config';\nimport { stateMetaReducers } from './reducers/index';\n\n@NgModule({})\nexport class StateModule {\n  static forRoot(): ModuleWithProviders<StateModule> {\n    return {\n      ngModule: StateModule,\n      providers: [\n        ...stateMetaReducers,\n        provideDefaultConfig(defaultStateConfig),\n        { provide: StateConfig, useExisting: Config },\n      ],\n    };\n  }\n}\n","import { HttpErrorResponse } from '@angular/common/http';\nimport { isObject } from '../config/utils/deep-merge';\nimport { ErrorModel, HttpErrorModel } from '../model/misc.model';\n\nexport const UNKNOWN_ERROR = {\n  error: 'unknown error',\n};\n\nconst circularReplacer = () => {\n  const seen = new WeakSet();\n  return (_key: any, value: any) => {\n    if (typeof value === 'object' && value !== null) {\n      if (seen.has(value)) {\n        return;\n      }\n      seen.add(value);\n    }\n    return value;\n  };\n};\n\nexport function makeErrorSerializable(\n  error: HttpErrorResponse | ErrorModel | any\n): HttpErrorModel | Error | any {\n  if (error instanceof Error) {\n    return {\n      message: error.message,\n      type: error.name,\n      reason: error.stack,\n    } as ErrorModel;\n  }\n\n  if (error instanceof HttpErrorResponse) {\n    let serializableError = error.error;\n    if (isObject(error.error)) {\n      serializableError = JSON.stringify(error.error, circularReplacer());\n    }\n\n    return {\n      message: error.message,\n      error: serializableError,\n      status: error.status,\n      statusText: error.statusText,\n      url: error.url,\n    } as HttpErrorModel;\n  }\n\n  return isObject(error) ? UNKNOWN_ERROR : error;\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { ClientToken } from '../../models/token-types.model';\nimport { ClientAuthenticationTokenService } from '../../services/client-authentication/client-authentication-token.service';\nimport { AuthActions } from '../actions/index';\n\n@Injectable()\nexport class ClientTokenEffect {\n  @Effect()\n  loadClientToken$: Observable<\n    AuthActions.ClientTokenAction\n  > = this.actions$.pipe(\n    ofType(AuthActions.LOAD_CLIENT_TOKEN),\n    exhaustMap(() => {\n      return this.clientAuthenticationTokenService\n        .loadClientAuthenticationToken()\n        .pipe(\n          map((token: ClientToken) => {\n            return new AuthActions.LoadClientTokenSuccess(token);\n          }),\n          catchError(error =>\n            of(\n              new AuthActions.LoadClientTokenFail(makeErrorSerializable(error))\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private clientAuthenticationTokenService: ClientAuthenticationTokenService\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map, mergeMap } from 'rxjs/operators';\nimport { OCC_USER_ID_CURRENT } from '../../../occ/utils/occ-constants';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserToken } from '../../models/token-types.model';\nimport { UserAuthenticationTokenService } from '../../services/user-authentication/user-authentication-token.service';\nimport { AuthActions } from '../actions/index';\n\n@Injectable()\nexport class UserTokenEffects {\n  @Effect()\n  loadUserToken$: Observable<AuthActions.UserTokenAction> = this.actions$.pipe(\n    ofType(AuthActions.LOAD_USER_TOKEN),\n    map((action: AuthActions.LoadUserToken) => action.payload),\n    mergeMap(({ userId, password }) =>\n      this.userTokenService.loadToken(userId, password).pipe(\n        map((token: UserToken) => {\n          const date = new Date();\n          date.setSeconds(date.getSeconds() + token.expires_in);\n          token.expiration_time = date.toJSON();\n          token.userId = OCC_USER_ID_CURRENT;\n          return new AuthActions.LoadUserTokenSuccess(token);\n        }),\n        catchError(error =>\n          of(new AuthActions.LoadUserTokenFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  @Effect()\n  login$: Observable<AuthActions.Login> = this.actions$.pipe(\n    ofType(AuthActions.LOAD_USER_TOKEN_SUCCESS),\n    map(() => new AuthActions.Login())\n  );\n\n  @Effect()\n  refreshUserToken$: Observable<\n    AuthActions.UserTokenAction\n  > = this.actions$.pipe(\n    ofType(AuthActions.REFRESH_USER_TOKEN),\n    map((action: AuthActions.RefreshUserToken) => action.payload),\n    exhaustMap(({ refreshToken }) => {\n      return this.userTokenService.refreshToken(refreshToken).pipe(\n        map(\n          (token: UserToken) => {\n            const date = new Date();\n            date.setSeconds(date.getSeconds() + token.expires_in);\n            token.expiration_time = date.toJSON();\n            return new AuthActions.RefreshUserTokenSuccess(token);\n          },\n          catchError(error =>\n            of(\n              new AuthActions.RefreshUserTokenFail(makeErrorSerializable(error))\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  revokeUserToken$: Observable<\n    AuthActions.UserTokenAction\n  > = this.actions$.pipe(\n    ofType(AuthActions.REVOKE_USER_TOKEN),\n    map((action: AuthActions.RevokeUserToken) => {\n      return action.payload;\n    }),\n    mergeMap((userToken: UserToken) => {\n      return this.userTokenService.revoke(userToken).pipe(\n        map(() => new AuthActions.RevokeUserTokenSuccess(userToken)),\n        catchError(error => of(new AuthActions.RevokeUserTokenFail(error)))\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userTokenService: UserAuthenticationTokenService\n  ) {}\n}\n","import { ClientTokenEffect } from './client-token.effect';\nimport { UserTokenEffects } from './user-token.effect';\n\nexport const effects: any[] = [UserTokenEffects, ClientTokenEffect];\n\nexport * from './client-token.effect';\nexport * from './user-token.effect';\n","import * as fromUpdateEmailAction from '../../../user/store/actions/update-email.action';\nimport { UserToken } from '../../models/token-types.model';\nimport { AuthActions } from '../actions/index';\n\nexport const initialState: UserToken = <UserToken>{};\n\nexport function reducer(\n  state = initialState,\n  action:\n    | AuthActions.UserTokenAction\n    | fromUpdateEmailAction.UpdateEmailSuccessAction\n): UserToken {\n  switch (action.type) {\n    case AuthActions.LOAD_USER_TOKEN:\n    case AuthActions.REFRESH_USER_TOKEN: {\n      return {\n        ...state,\n      };\n    }\n\n    case AuthActions.LOAD_USER_TOKEN_SUCCESS:\n    case AuthActions.REFRESH_USER_TOKEN_SUCCESS: {\n      return {\n        ...state,\n        ...action.payload,\n      };\n    }\n\n    case AuthActions.LOAD_USER_TOKEN_FAIL:\n    case AuthActions.REFRESH_USER_TOKEN_FAIL: {\n      return {\n        ...state,\n      };\n    }\n  }\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  Action,\n  ActionReducer,\n  ActionReducerMap,\n  combineReducers,\n  MetaReducer,\n} from '@ngrx/store';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport { ClientToken } from '../../models/token-types.model';\nimport { AuthActions } from '../actions/index';\nimport { AuthState, CLIENT_TOKEN_DATA } from '../auth-state';\nimport * as fromUserTokenReducer from './user-token.reducer';\n\nexport function getReducers(): ActionReducerMap<AuthState> {\n  return {\n    userToken: combineReducers({ token: fromUserTokenReducer.reducer }),\n    clientToken: loaderReducer<ClientToken>(CLIENT_TOKEN_DATA),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  AuthState\n>> = new InjectionToken<ActionReducerMap<AuthState>>('AuthReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearAuthState(\n  reducer: ActionReducer<AuthState, Action>\n): ActionReducer<AuthState, Action> {\n  return function(state, action) {\n    if (action.type === AuthActions.LOGOUT) {\n      state = {\n        ...state,\n        userToken: undefined,\n      };\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearAuthState];\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { provideDefaultConfigFactory } from '../../config/config.module';\nimport { StateConfig, StorageSyncType } from '../../state/config/state-config';\nimport { StateModule } from '../../state/state.module';\nimport { AUTH_FEATURE } from './auth-state';\nimport { effects } from './effects/index';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function authStoreConfigFactory(): StateConfig {\n  // if we want to reuse AUTH_FEATURE const in config, we have to use factory instead of plain object\n  const config: StateConfig = {\n    state: {\n      storageSync: {\n        keys: {\n          'auth.userToken.token.access_token': StorageSyncType.LOCAL_STORAGE,\n          'auth.userToken.token.token_type': StorageSyncType.LOCAL_STORAGE,\n          'auth.userToken.token.expires_in': StorageSyncType.LOCAL_STORAGE,\n          'auth.userToken.token.expiration_time': StorageSyncType.LOCAL_STORAGE,\n          'auth.userToken.token.scope': StorageSyncType.LOCAL_STORAGE,\n          'auth.userToken.token.userId': StorageSyncType.LOCAL_STORAGE,\n        },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StateModule,\n    StoreModule.forFeature(AUTH_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(authStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class AuthStoreModule {}\n","import { ErrorModel } from './misc.model';\n\nexport interface Country {\n  isocode?: string;\n  name?: string;\n}\n\nexport enum CountryType {\n  BILLING = 'BILLING',\n  SHIPPING = 'SHIPPING',\n}\n\nexport interface Region {\n  countryIso?: string;\n  isocode?: string;\n  isocodeShort?: string;\n  name?: string;\n}\n\nexport interface Address {\n  companyName?: string;\n  country?: Country;\n  defaultAddress?: boolean;\n  email?: string;\n  firstName?: string;\n  formattedAddress?: string;\n  id?: string;\n  lastName?: string;\n  line1?: string;\n  line2?: string;\n  phone?: string;\n  postalCode?: string;\n  region?: Region;\n  shippingAddress?: boolean;\n  title?: string;\n  titleCode?: string;\n  town?: string;\n  visibleInAddressBook?: boolean;\n}\n\nexport interface AddressValidation {\n  decision?: string;\n  // TODO: Simplify with converter\n  errors?: { errors: ErrorModel[] };\n  suggestedAddresses?: Address[];\n}\n","import { Address } from './address.model';\nimport { Currency } from './misc.model';\nimport {\n  DeliveryMode,\n  OrderEntry,\n  PickupOrderEntryGroup,\n  PromotionOrderEntryConsumed,\n} from './order.model';\nimport { Price, Promotion } from './product.model';\n\nexport interface PromotionResult {\n  consumedEntries?: PromotionOrderEntryConsumed[];\n  description?: string;\n  promotion?: Promotion;\n}\n\nexport enum PromotionLocation {\n  ActiveCart = 'CART',\n  Checkout = 'CHECKOUT',\n  Order = 'ORDER',\n}\n\nexport interface Voucher {\n  appliedValue?: Price;\n  code?: string;\n  currency?: Currency;\n  description?: string;\n  freeShipping?: boolean;\n  name?: string;\n  value?: number;\n  valueFormatted?: string;\n  valueString?: string;\n  voucherCode?: string;\n}\n\nexport interface DeliveryOrderEntryGroup {\n  deliveryAddress?: Address;\n  entries?: OrderEntry[];\n  quantity?: number;\n  totalPriceWithTax?: Price;\n}\n\nexport interface Principal {\n  name?: string;\n  uid?: string;\n}\n\nexport interface CardType {\n  code?: string;\n  name?: string;\n}\n\nexport interface PaymentDetails {\n  accountHolderName?: string;\n  billingAddress?: Address;\n  cardNumber?: string;\n  cardType?: CardType;\n  cvn?: string;\n  defaultPayment?: boolean;\n  expiryMonth?: string;\n  expiryYear?: string;\n  id?: string;\n  issueNumber?: string;\n  saved?: boolean;\n  startMonth?: string;\n  startYear?: string;\n  subscriptionId?: string;\n}\n\nexport interface SaveCartResult {\n  savedCartData?: Cart;\n}\n\nexport interface Cart {\n  appliedOrderPromotions?: PromotionResult[];\n  appliedProductPromotions?: PromotionResult[];\n  appliedVouchers?: Voucher[];\n  calculated?: boolean;\n  code?: string;\n  deliveryAddress?: Address;\n  deliveryCost?: Price;\n  deliveryItemsQuantity?: number;\n  deliveryMode?: DeliveryMode;\n  deliveryOrderGroups?: DeliveryOrderEntryGroup[];\n  description?: string;\n  entries?: OrderEntry[];\n  expirationTime?: Date;\n  guid?: string;\n  name?: string;\n  net?: boolean;\n  orderDiscounts?: Price;\n  paymentInfo?: PaymentDetails;\n  pickupItemsQuantity?: number;\n  pickupOrderGroups?: PickupOrderEntryGroup[];\n  potentialOrderPromotions?: PromotionResult[];\n  potentialProductPromotions?: PromotionResult[];\n  productDiscounts?: Price;\n  saveTime?: Date;\n  savedBy?: Principal;\n  site?: string;\n  store?: string;\n  subTotal?: Price;\n  totalDiscounts?: Price;\n  totalItems?: number;\n  totalPrice?: Price;\n  totalPriceWithTax?: Price;\n  totalTax?: Price;\n  totalUnitCount?: number;\n  user?: Principal;\n}\n\nexport interface CartModification {\n  deliveryModeChanged?: boolean;\n  entry?: OrderEntry;\n  quantity?: number;\n  quantityAdded?: number;\n  statusCode?: string;\n  statusMessage?: string;\n}\n","export interface CmsComponent {\n  modifiedTime?: Date;\n  name?: string;\n  otherProperties?: any;\n  typeCode?: string;\n  uid?: string;\n}\n\nexport enum PageType {\n  CONTENT_PAGE = 'ContentPage',\n  PRODUCT_PAGE = 'ProductPage',\n  CATEGORY_PAGE = 'CategoryPage',\n  CATALOG_PAGE = 'CatalogPage',\n}\n\nexport interface CmsLinkComponent extends CmsComponent {\n  url?: string;\n  container?: boolean;\n  external?: boolean;\n  contentPage?: string;\n  contentPageLabelOrId?: string;\n  linkName?: string;\n  target?: boolean;\n}\n\nexport interface CmsSiteContextSelectorComponent extends CmsComponent {\n  context?: string;\n}\n\nexport interface CmsSearchBoxComponent extends CmsComponent {\n  container?: boolean;\n  maxSuggestions?: number;\n  maxProducts?: number;\n  displaySuggestions?: boolean;\n  displayProducts?: boolean;\n  displayProductImages?: boolean;\n  waitTimeBeforeRequest?: number;\n  minCharactersBeforeRequest?: number;\n}\n\nexport interface CmsParagraphComponent extends CmsComponent {\n  content?: string;\n  container?: string;\n  title?: string;\n}\n\nexport interface CMSTabParagraphContainer extends CmsComponent {\n  container?: string;\n  components?: string;\n}\n\nexport interface CmsBannerComponentMedia {\n  altText?: string;\n  code?: string;\n  mime?: string;\n  url?: string;\n}\n\nexport interface CmsResponsiveBannerComponentMedia {\n  desktop?: CmsBannerComponentMedia;\n  mobile?: CmsBannerComponentMedia;\n  tablet?: CmsBannerComponentMedia;\n  widescreen?: CmsBannerComponentMedia;\n}\n\nexport interface CmsBannerComponent extends CmsComponent {\n  headline?: string;\n  content?: string;\n  container?: string;\n  media?: CmsBannerComponentMedia | CmsResponsiveBannerComponentMedia;\n  urlLink?: string;\n  external?: string;\n}\n\nexport enum CmsBannerCarouselEffect {\n  FADE = 'FADE',\n  ZOOM = 'ZOOM',\n  CURTAIN = 'CURTAINX',\n  TURNDOWN = 'TURNDOWN',\n}\n\nexport interface CmsBannerCarouselComponent extends CmsComponent {\n  banners?: string;\n  effect?: CmsBannerCarouselEffect;\n}\n\nexport interface CmsProductCarouselComponent extends CmsComponent {\n  title?: string;\n  productCodes?: string;\n  container?: string;\n  popup?: string;\n  scroll?: string;\n}\n\nexport interface CmsProductReferencesComponent extends CmsComponent {\n  title?: string;\n  displayProductTitles?: string;\n  displayProductPrices?: string;\n  maximumNumberProducts?: number;\n  productReferenceTypes?: string;\n  container?: string;\n}\n\nexport interface CmsMiniCartComponent extends CmsComponent {\n  container?: string;\n  shownProductCount?: string;\n  title?: string;\n  totalDisplay?: string;\n  lightboxBannerComponent?: CmsBannerComponent;\n}\n\n// TODO: Upgrade model when Breadcrumbs will be finally used in project\nexport interface CmsBreadcrumbsComponent extends CmsComponent {\n  container?: string;\n}\n\nexport interface CmsNavigationNode {\n  uid?: string;\n  title?: string;\n  children?: Array<CmsNavigationNode>;\n  entries?: Array<CmsNavigationEntry>;\n}\n\nexport interface CmsNavigationEntry {\n  itemId?: string;\n  itemSuperType?: string;\n  itemType?: string;\n}\n\nexport interface CmsNavigationComponent extends CmsComponent {\n  container?: string;\n  styleClass?: string;\n  wrapAfter?: string;\n  notice?: string;\n  showLanguageCurrency?: string;\n  navigationNode?: CmsNavigationNode;\n}\n\nexport interface CmsProductFacetNavigationComponent extends CmsComponent {\n  container?: string;\n  activeFacetValueCode?: string;\n  searchResult?: string;\n  minPerFacet?: string;\n}\n","export interface ConsentTemplate {\n  id?: string;\n  name?: string;\n  description?: string;\n  version?: number;\n  currentConsent?: Consent;\n}\n\nexport interface Consent {\n  code?: string;\n  consentGivenDate?: Date;\n  consentWithdrawnDate?: Date;\n}\n\nexport interface AnonymousConsent {\n  templateCode?: string;\n  version?: number;\n  consentState?: ANONYMOUS_CONSENT_STATUS;\n}\n\nexport enum ANONYMOUS_CONSENT_STATUS {\n  GIVEN = 'GIVEN',\n  WITHDRAWN = 'WITHDRAWN',\n}\n","export interface Images {\n  [imageType: string]: ImageGroup | ImageGroup[];\n}\n\nexport interface Image {\n  altText?: string;\n  format?: string;\n  galleryIndex?: number;\n  imageType?: ImageType;\n  url?: string;\n}\n\nexport enum ImageType {\n  PRIMARY = 'PRIMARY',\n  GALLERY = 'GALLERY',\n}\n\nexport interface ImageGroup {\n  [format: string]: Image;\n}\n","import { Image, Images } from './image.model';\nimport { User } from './misc.model';\n\nexport interface VariantOptionQualifier {\n  image?: Image;\n  name?: string;\n  qualifier?: VariantQualifier;\n  value?: string;\n}\n\nexport interface PromotionRestriction {\n  description?: string;\n  restrictionType?: string;\n}\n\nexport interface FeatureUnit {\n  name?: string;\n  symbol?: string;\n  unitType?: string;\n}\n\nexport interface FeatureValue {\n  value?: string;\n}\n\nexport interface Feature {\n  code?: string;\n  comparable?: boolean;\n  description?: string;\n  featureUnit?: FeatureUnit;\n  featureValues?: FeatureValue[];\n  name?: string;\n  range?: boolean;\n  type?: string;\n}\n\nexport interface VariantCategory {\n  hasImage?: boolean;\n  name?: string;\n  priority?: number;\n}\n\nexport interface VariantValueCategory {\n  name?: string;\n  sequence?: number;\n  superCategories?: VariantCategory[];\n}\n\nexport enum VariantType {\n  SIZE = 'ApparelSizeVariantProduct',\n  STYLE = 'ApparelStyleVariantProduct',\n  COLOR = 'ElectronicsColorVariantProduct',\n}\n\nexport enum PriceType {\n  BUY = 'BUY',\n  FROM = 'FROM',\n}\n\nexport interface Price {\n  currencyIso?: string;\n  formattedValue?: string;\n  maxQuantity?: number;\n  minQuantity?: number;\n  priceType?: PriceType;\n  value?: number;\n}\n\nexport interface Stock {\n  stockLevel?: number;\n  stockLevelStatus?: string;\n}\n\nexport interface VariantOption {\n  code?: string;\n  priceData?: Price;\n  stock?: Stock;\n  url?: string;\n  variantOptionQualifiers?: VariantOptionQualifier[];\n}\n\nexport interface Promotion {\n  code?: string;\n  couldFireMessages?: string[];\n  description?: string;\n  enabled?: boolean;\n  endDate?: Date;\n  firedMessages?: string[];\n  priority?: number;\n  productBanner?: Image;\n  promotionGroup?: string;\n  promotionType?: string;\n  restrictions?: PromotionRestriction[];\n  startDate?: Date;\n  title?: string;\n}\n\nexport interface Category {\n  code?: string;\n  name?: string;\n  image?: Image;\n  url?: string;\n}\n\nexport interface Classification {\n  code?: string;\n  features?: Feature[];\n  name?: string;\n}\n\nexport interface FutureStock {\n  date?: Date;\n  formattedDate?: string;\n  stock?: Stock;\n}\n\nexport interface PriceRange {\n  maxPrice?: Price;\n  minPrice?: Price;\n}\n\nexport interface ProductReference {\n  description?: string;\n  preselected?: boolean;\n  quantity?: number;\n  referenceType?: string;\n  target?: Product;\n}\n\nexport interface Review {\n  alias?: string;\n  comment?: string;\n  date?: Date;\n  headline?: string;\n  id?: string;\n  principal?: User;\n  rating?: number;\n}\n\nexport interface VariantMatrixElement {\n  elements?: VariantMatrixElement[];\n  isLeaf?: boolean;\n  parentVariantCategory?: VariantCategory;\n  variantOption?: VariantOption;\n  variantValueCategory?: VariantValueCategory;\n}\n\nexport interface ProductReferences {\n  [referenceType: string]: ProductReference[];\n}\n\nexport interface BaseOption {\n  options?: VariantOption[];\n  selected?: VariantOption;\n  variantType?: VariantType;\n}\n\nexport interface Product {\n  availableForPickup?: boolean;\n  averageRating?: number;\n  baseOptions?: BaseOption[];\n  baseProduct?: string;\n  categories?: Category[];\n  classifications?: Classification[];\n  code?: string;\n  description?: string;\n  futureStocks?: FutureStock[];\n  images?: Images;\n  manufacturer?: string;\n  multidimensional?: boolean;\n  name?: string;\n  nameHtml?: string;\n  numberOfReviews?: number;\n  potentialPromotions?: Promotion[];\n  price?: Price;\n  priceRange?: PriceRange;\n  productReferences?: ProductReferences;\n  purchasable?: boolean;\n  reviews?: Review[];\n  stock?: Stock;\n  summary?: string;\n  url?: string;\n  variantMatrix?: VariantMatrixElement[];\n  variantOptions?: VariantOption[];\n  variantType?: VariantType;\n  volumePrices?: Price[];\n  volumePricesFlag?: boolean;\n}\n\nexport enum VariantQualifier {\n  SIZE = 'size',\n  STYLE = 'style',\n  COLOR = 'color',\n  THUMBNAIL = 'thumbnail',\n  PRODUCT = 'product',\n  ROLLUP_PROPERTY = 'rollupProperty',\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { AuthConfig } from './config/auth-config';\nimport { defaultAuthConfig } from './config/default-auth-config';\nimport { interceptors } from './http-interceptors/index';\nimport { AuthServices } from './services/index';\nimport { AuthStoreModule } from './store/auth-store.module';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule, AuthStoreModule],\n})\nexport class AuthModule {\n  static forRoot(): ModuleWithProviders<AuthModule> {\n    return {\n      ngModule: AuthModule,\n      providers: [\n        provideDefaultConfig(defaultAuthConfig),\n        ...interceptors,\n        ...AuthServices,\n        { provide: AuthConfig, useExisting: Config },\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { RoutingService } from '../../routing/facade/routing.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthRedirectService {\n  /**\n   * This service is responsible for redirecting to the last page before authorization. \"The last page\" can be:\n   * 1. Just the previously opened page; or\n   * 2. The page that we just tried to open, but AuthGuard cancelled it\n   *\n   * For example:\n   * 1. The user opens the product page, then clicks /login link and signs in\n   *    -> Then we should redirect to the product page; or\n   * 2. The user opens the product page, then he clicks /my-account link,\n   *    but is automatically redirected to the login page by the AuthGuard, and he signs in\n   *    -> Then we should redirect to the my-account page, not the product page\n   */\n  constructor(private routing: RoutingService, private router: Router) {}\n\n  private redirectUrl: string;\n  private ignoredUrls = new Set<string>();\n  private lastAuthGuardNavigation: {\n    url: string;\n    navigationId: number;\n  };\n\n  redirect() {\n    if (this.redirectUrl === undefined) {\n      this.routing.go('/');\n    } else {\n      this.routing.goByUrl(this.redirectUrl);\n    }\n    this.redirectUrl = undefined;\n    this.lastAuthGuardNavigation = undefined;\n  }\n\n  reportAuthGuard() {\n    const { url, navigationId } = this.getCurrentNavigation();\n    this.lastAuthGuardNavigation = { url, navigationId };\n    this.redirectUrl = url;\n  }\n\n  reportNotAuthGuard() {\n    const { url, initialUrl, navigationId } = this.getCurrentNavigation();\n\n    this.ignoredUrls.add(url);\n\n    // Don't save redirect url if you've already come from page with NotAuthGuard (i.e. user has come from login to register)\n    if (!this.ignoredUrls.has(initialUrl)) {\n      // We compare the navigation id to find out if the url cancelled by AuthGuard (i.e. my-account) is more recent\n      // than the last opened page\n      if (\n        !this.lastAuthGuardNavigation ||\n        this.lastAuthGuardNavigation.navigationId < navigationId - 1\n      ) {\n        this.redirectUrl = initialUrl;\n        this.lastAuthGuardNavigation = undefined;\n      }\n    }\n  }\n\n  private getCurrentNavigation(): {\n    navigationId: number;\n    url: string;\n    initialUrl: string;\n  } {\n    const initialUrl = this.router.url;\n    const navigation = this.router.getCurrentNavigation();\n    const url = this.router.serializeUrl(navigation.finalUrl);\n    return {\n      navigationId: navigation.id,\n      url,\n      initialUrl,\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CanActivate, Router } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { AuthService } from '../facade/auth.service';\nimport { UserToken } from '../models/token-types.model';\nimport { AuthRedirectService } from './auth-redirect.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthGuard implements CanActivate {\n  constructor(\n    protected routingService: RoutingService,\n    protected authService: AuthService,\n    protected authRedirectService: AuthRedirectService,\n    protected router: Router\n  ) {}\n\n  canActivate(): Observable<boolean> {\n    return this.authService.getUserToken().pipe(\n      map((token: UserToken) => {\n        if (!token.access_token) {\n          this.authRedirectService.reportAuthGuard();\n          this.routingService.go({ cxRoute: 'login' });\n        }\n        return !!token.access_token;\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CanActivate } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { AuthService } from '../facade/auth.service';\nimport { AuthRedirectService } from './auth-redirect.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class NotAuthGuard implements CanActivate {\n  constructor(\n    protected routingService: RoutingService,\n    protected authService: AuthService,\n    private authRedirectService: AuthRedirectService\n  ) {}\n\n  canActivate(): Observable<boolean> {\n    this.authRedirectService.reportNotAuthGuard();\n\n    // redirect, if user is already logged in:\n    return this.authService.getUserToken().pipe(\n      map(token => {\n        if (token.access_token) {\n          this.routingService.go({ cxRoute: 'home' });\n        }\n        return !token.access_token;\n      })\n    );\n  }\n}\n","import { Product } from './product.model';\nimport { Pagination, Sort } from './unused.model';\n\nexport interface ProductInterestEntry {\n  interestType?: NotificationType;\n  dateAdded?: string;\n  expirationDate?: string;\n}\n\nexport interface ProductInterestEntryRelation {\n  product?: Product;\n  productInterestEntry?: ProductInterestEntry[];\n}\n\nexport interface ProductInterestSearchResult {\n  results?: ProductInterestEntryRelation[];\n  sorts?: Sort[];\n  pagination?: Pagination;\n}\n\nexport enum NotificationType {\n  BACK_IN_STOCK = 'BACK_IN_STOCK',\n}\n","import { AnonymousConsent, ConsentTemplate } from '../../model/consent.model';\nimport { LoaderState } from '../../state';\n\nexport const ANONYMOUS_CONSENTS_STORE_FEATURE = 'anonymous-consents';\nexport const ANONYMOUS_CONSENTS = '[Anonymous Consents] Anonymous Consents';\n\nexport interface StateWithAnonymousConsents {\n  [ANONYMOUS_CONSENTS_STORE_FEATURE]: AnonymousConsentsState;\n}\n\nexport interface AnonymousConsentsState {\n  templates: LoaderState<ConsentTemplate[]>;\n  consents: AnonymousConsent[];\n  ui: {\n    bannerDismissed: boolean;\n    updated: boolean;\n  };\n}\n","import {\n  AnonymousConsent,\n  ConsentTemplate,\n} from '../../../model/consent.model';\nimport { StateLoaderActions } from '../../../state/utils/index';\nimport { ANONYMOUS_CONSENTS } from '../anonymous-consents-state';\n\nexport const LOAD_ANONYMOUS_CONSENT_TEMPLATES =\n  '[Anonymous Consents] Load Anonymous Consent Templates';\nexport const LOAD_ANONYMOUS_CONSENT_TEMPLATES_SUCCESS =\n  '[Anonymous Consents] Load Anonymous Consent Templates Success';\nexport const LOAD_ANONYMOUS_CONSENT_TEMPLATES_FAIL =\n  '[Anonymous Consents] Load Anonymous Consent Templates Fail';\nexport const RESET_LOAD_ANONYMOUS_CONSENT_TEMPLATES =\n  '[Anonymous Consents] Reset Load Anonymous Consent Templates';\n\nexport const GET_ALL_ANONYMOUS_CONSENTS =\n  '[Anonymous Consents] Get All Anonymous Consents';\nexport const GET_ANONYMOUS_CONSENT =\n  '[Anonymous Consents] Get Anonymous Consent';\nexport const SET_ANONYMOUS_CONSENTS =\n  '[Anonymous Consents] Set Anonymous Consents';\nexport const GIVE_ANONYMOUS_CONSENT =\n  '[Anonymous Consents] Give Anonymous Consent';\nexport const WITHDRAW_ANONYMOUS_CONSENT =\n  '[Anonymous Consents] Withdraw Anonymous Consent';\n\nexport const TOGGLE_ANONYMOUS_CONSENTS_BANNER_DISMISSED =\n  '[Anonymous Consents] Toggle Anonymous Consents Banner Dismissed';\nexport const TOGGLE_ANONYMOUS_CONSENT_TEMPLATES_UPDATED =\n  '[Anonymous Consents] Anonymous Consent Templates Updated';\n\nexport class LoadAnonymousConsentTemplates extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_ANONYMOUS_CONSENT_TEMPLATES;\n  constructor() {\n    super(ANONYMOUS_CONSENTS);\n  }\n}\n\nexport class LoadAnonymousConsentTemplatesSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_ANONYMOUS_CONSENT_TEMPLATES_SUCCESS;\n  constructor(public payload: ConsentTemplate[]) {\n    super(ANONYMOUS_CONSENTS);\n  }\n}\nexport class LoadAnonymousConsentTemplatesFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_ANONYMOUS_CONSENT_TEMPLATES_FAIL;\n  constructor(payload: any) {\n    super(ANONYMOUS_CONSENTS, payload);\n  }\n}\n\nexport class ResetLoadAnonymousConsentTemplates extends StateLoaderActions.LoaderResetAction {\n  readonly type = RESET_LOAD_ANONYMOUS_CONSENT_TEMPLATES;\n  constructor() {\n    super(ANONYMOUS_CONSENTS);\n  }\n}\n\nexport class GetAllAnonymousConsents {\n  readonly type = GET_ALL_ANONYMOUS_CONSENTS;\n  constructor() {}\n}\n\nexport class GetAnonymousConsent {\n  readonly type = GET_ANONYMOUS_CONSENT;\n  constructor(public templateCode: string) {}\n}\n\nexport class SetAnonymousConsents {\n  readonly type = SET_ANONYMOUS_CONSENTS;\n  constructor(public payload: AnonymousConsent[]) {}\n}\n\nexport class GiveAnonymousConsent {\n  readonly type = GIVE_ANONYMOUS_CONSENT;\n  constructor(public templateCode: string) {}\n}\n\nexport class WithdrawAnonymousConsent {\n  readonly type = WITHDRAW_ANONYMOUS_CONSENT;\n  constructor(public templateCode: string) {}\n}\n\nexport class ToggleAnonymousConsentsBannerDissmissed {\n  readonly type = TOGGLE_ANONYMOUS_CONSENTS_BANNER_DISMISSED;\n  constructor(public dismissed: boolean) {}\n}\n\nexport class ToggleAnonymousConsentTemplatesUpdated {\n  readonly type = TOGGLE_ANONYMOUS_CONSENT_TEMPLATES_UPDATED;\n  constructor(public updated: boolean) {}\n}\n\nexport type AnonymousConsentsActions =\n  | LoadAnonymousConsentTemplates\n  | LoadAnonymousConsentTemplatesSuccess\n  | LoadAnonymousConsentTemplatesFail\n  | ResetLoadAnonymousConsentTemplates\n  | GetAllAnonymousConsents\n  | SetAnonymousConsents\n  | GetAnonymousConsent\n  | GiveAnonymousConsent\n  | WithdrawAnonymousConsent\n  | ToggleAnonymousConsentsBannerDissmissed\n  | ToggleAnonymousConsentTemplatesUpdated;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  AnonymousConsentsState,\n  ANONYMOUS_CONSENTS_STORE_FEATURE,\n  StateWithAnonymousConsents,\n} from '../anonymous-consents-state';\n\nexport const getAnonymousConsentState: MemoizedSelector<\n  StateWithAnonymousConsents,\n  AnonymousConsentsState\n> = createFeatureSelector<AnonymousConsentsState>(\n  ANONYMOUS_CONSENTS_STORE_FEATURE\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithAnonymousConsents } from '../anonymous-consents-state';\nimport { getAnonymousConsentState } from './feature.selector';\n\nexport const getAnonymousConsentTemplatesState: MemoizedSelector<\n  StateWithAnonymousConsents,\n  LoaderState<ConsentTemplate[]>\n> = createSelector(getAnonymousConsentState, state => state.templates);\n\nexport const getAnonymousConsentTemplatesValue: MemoizedSelector<\n  StateWithAnonymousConsents,\n  ConsentTemplate[]\n> = createSelector(\n  getAnonymousConsentTemplatesState,\n  StateLoaderSelectors.loaderValueSelector\n);\n\nexport const getAnonymousConsentTemplatesLoading: MemoizedSelector<\n  StateWithAnonymousConsents,\n  boolean\n> = createSelector(\n  getAnonymousConsentTemplatesState,\n  StateLoaderSelectors.loaderLoadingSelector\n);\n\nexport const getAnonymousConsentTemplatesSuccess: MemoizedSelector<\n  StateWithAnonymousConsents,\n  boolean\n> = createSelector(\n  getAnonymousConsentTemplatesState,\n  StateLoaderSelectors.loaderSuccessSelector\n);\n\nexport const getAnonymousConsentTemplatesError: MemoizedSelector<\n  StateWithAnonymousConsents,\n  boolean\n> = createSelector(\n  getAnonymousConsentTemplatesState,\n  StateLoaderSelectors.loaderErrorSelector\n);\n\nexport const getAnonymousConsentTemplate = (\n  templateCode: string\n): MemoizedSelector<StateWithAnonymousConsents, ConsentTemplate> => {\n  return createSelector(getAnonymousConsentTemplatesValue, templates => {\n    return templates\n      ? templates.find(template => template.id === templateCode)\n      : null;\n  });\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateWithAnonymousConsents } from '../anonymous-consents-state';\nimport { getAnonymousConsentState } from './feature.selector';\n\nexport const getAnonymousConsentTemplatesUpdate: MemoizedSelector<\n  StateWithAnonymousConsents,\n  boolean\n> = createSelector(getAnonymousConsentState, state => state.ui.updated);\n\nexport const getAnonymousConsentsBannerDismissed: MemoizedSelector<\n  StateWithAnonymousConsents,\n  boolean\n> = createSelector(getAnonymousConsentState, state => state.ui.bannerDismissed);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { AnonymousConsent } from '../../../model/consent.model';\nimport { StateWithAnonymousConsents } from '../anonymous-consents-state';\nimport { getAnonymousConsentState } from './feature.selector';\n\nexport const getAnonymousConsents: MemoizedSelector<\n  StateWithAnonymousConsents,\n  AnonymousConsent[]\n> = createSelector(getAnonymousConsentState, state => state.consents);\n\nexport const getAnonymousConsentByTemplateCode = (\n  templateCode: string\n): MemoizedSelector<StateWithAnonymousConsents, AnonymousConsent> =>\n  createSelector(getAnonymousConsents, consents =>\n    consents.find(consent => consent.templateCode === templateCode)\n  );\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, iif, Observable } from 'rxjs';\nimport { filter, map, switchMap, tap, withLatestFrom } from 'rxjs/operators';\nimport { AuthService } from '../../auth/index';\nimport {\n  AnonymousConsent,\n  ANONYMOUS_CONSENT_STATUS,\n  ConsentTemplate,\n} from '../../model/index';\nimport { AnonymousConsentsActions } from '../store/actions/index';\nimport { StateWithAnonymousConsents } from '../store/anonymous-consents-state';\nimport { AnonymousConsentsSelectors } from '../store/selectors/index';\n\n@Injectable({ providedIn: 'root' })\nexport class AnonymousConsentsService {\n  constructor(\n    protected store: Store<StateWithAnonymousConsents>,\n    protected authService: AuthService\n  ) {}\n\n  /**\n   * Retrieves the anonymous consent templates.\n   */\n  loadTemplates(): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.LoadAnonymousConsentTemplates()\n    );\n  }\n\n  /**\n   * Conditionally triggers the load of the anonymous consent templates if:\n   *   - `loadIfMissing` parameter is set to `true`\n   *   - the `templates` in the store are `undefined`\n   *\n   * Othewise it just returns the value from the store.\n   *\n   * @param loadIfMissing setting to `true` will trigger the load of the templates if the currently stored templates are `undefined`\n   */\n  getTemplates(loadIfMissing = false): Observable<ConsentTemplate[]> {\n    return iif(\n      () => loadIfMissing,\n      this.store.pipe(\n        select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesValue),\n        withLatestFrom(this.getLoadTemplatesLoading()),\n        filter(([_templates, loading]) => !loading),\n        tap(([templates, _loading]) => {\n          if (!Boolean(templates)) {\n            this.loadTemplates();\n          }\n        }),\n        filter(([templates, _loading]) => Boolean(templates)),\n        map(([templates, _loading]) => templates)\n      ),\n      this.store.pipe(\n        select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesValue)\n      )\n    );\n  }\n\n  /**\n   * Returns the anonymous consent templates with the given template code.\n   * @param templateCode a template code by which to filter anonymous consent templates.\n   */\n  getTemplate(templateCode: string): Observable<ConsentTemplate> {\n    return this.store.pipe(\n      select(\n        AnonymousConsentsSelectors.getAnonymousConsentTemplate(templateCode)\n      )\n    );\n  }\n\n  /**\n   * Returns an indicator for the loading status for the anonymous consent templates.\n   */\n  getLoadTemplatesLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesLoading)\n    );\n  }\n\n  /**\n   * Returns an indicator for the success status for the anonymous consent templates.\n   */\n  getLoadTemplatesSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesSuccess)\n    );\n  }\n\n  /**\n   * Returns an indicator for the error status for the anonymous consent templates.\n   */\n  getLoadTemplatesError(): Observable<boolean> {\n    return this.store.pipe(\n      select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesError)\n    );\n  }\n\n  /**\n   * Resets the loading, success and error indicators for the anonymous consent templates.\n   */\n  resetLoadTemplatesState(): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.ResetLoadAnonymousConsentTemplates()\n    );\n  }\n\n  /**\n   * Returns all the anonymous consents.\n   */\n  getConsents(): Observable<AnonymousConsent[]> {\n    return this.store.pipe(\n      select(AnonymousConsentsSelectors.getAnonymousConsents)\n    );\n  }\n\n  /**\n   * Puts the provided anonymous consents into the store.\n   */\n  setConsents(consents: AnonymousConsent[]): void {\n    return this.store.dispatch(\n      new AnonymousConsentsActions.SetAnonymousConsents(consents)\n    );\n  }\n\n  /**\n   * Returns the anonymous consent for the given template ID.\n   *\n   * As a side-effect, the method will call `getTemplates(true)` to load the templates if those are not present.\n   *\n   * @param templateId a template ID by which to filter anonymous consent templates.\n   */\n  getConsent(templateId: string): Observable<AnonymousConsent> {\n    return this.authService.isUserLoggedIn().pipe(\n      filter(authenticated => !authenticated),\n      tap(_ => this.getTemplates(true)),\n      switchMap(_ =>\n        this.store.pipe(\n          select(\n            AnonymousConsentsSelectors.getAnonymousConsentByTemplateCode(\n              templateId\n            )\n          )\n        )\n      )\n    );\n  }\n\n  /**\n   * Give a consent for the given `templateCode`\n   * @param templateCode for which to give the consent\n   */\n  giveConsent(templateCode: string): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.GiveAnonymousConsent(templateCode)\n    );\n  }\n\n  /**\n   * Sets all the anonymous consents' state to given.\n   */\n  giveAllConsents(): Observable<ConsentTemplate[]> {\n    return this.getTemplates(true).pipe(\n      tap(templates =>\n        templates.forEach(template => this.giveConsent(template.id))\n      )\n    );\n  }\n\n  /**\n   * Returns `true` if the provided `consent` is given.\n   * @param consent a consent to test\n   */\n  isConsentGiven(consent: AnonymousConsent): boolean {\n    return consent && consent.consentState === ANONYMOUS_CONSENT_STATUS.GIVEN;\n  }\n\n  /**\n   * Withdraw a consent for the given `templateCode`\n   * @param templateCode for which to withdraw the consent\n   */\n  withdrawConsent(templateCode: string): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.WithdrawAnonymousConsent(templateCode)\n    );\n  }\n\n  /**\n   * Sets all the anonymous consents' state to withdrawn.\n   */\n  withdrawAllConsents(): Observable<ConsentTemplate[]> {\n    return this.getTemplates(true).pipe(\n      tap(templates =>\n        templates.forEach(template => this.withdrawConsent(template.id))\n      )\n    );\n  }\n\n  /**\n   * Returns `true` if the provided `consent` is withdrawn.\n   * @param consent a consent to test\n   */\n  isConsentWithdrawn(consent: AnonymousConsent): boolean {\n    return (\n      consent && consent.consentState === ANONYMOUS_CONSENT_STATUS.WITHDRAWN\n    );\n  }\n\n  /**\n   * Toggles the dismissed state of the anonymous consents banner.\n   * @param dismissed the banner will be dismissed if `true` is passed, otherwise it will be visible.\n   */\n  toggleBannerDismissed(dismissed: boolean): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.ToggleAnonymousConsentsBannerDissmissed(\n        dismissed\n      )\n    );\n    if (dismissed) {\n      this.toggleTemplatesUpdated(false);\n    }\n  }\n\n  /**\n   * Returns `true` if the banner was dismissed, `false` otherwise.\n   */\n  isBannerDismissed(): Observable<boolean> {\n    return this.store.pipe(\n      select(AnonymousConsentsSelectors.getAnonymousConsentsBannerDismissed)\n    );\n  }\n\n  /**\n   * Returns `true` if the consent templates were updated on the back-end.\n   * If the templates are not present in the store, it triggers the load.\n   */\n  getTemplatesUpdated(): Observable<boolean> {\n    return this.getTemplates(true).pipe(\n      switchMap(_ =>\n        this.store.pipe(\n          select(AnonymousConsentsSelectors.getAnonymousConsentTemplatesUpdate)\n        )\n      )\n    );\n  }\n\n  /**\n   * Toggles the `updated` slice of the state\n   * @param updated\n   */\n  toggleTemplatesUpdated(updated: boolean): void {\n    this.store.dispatch(\n      new AnonymousConsentsActions.ToggleAnonymousConsentTemplatesUpdated(\n        updated\n      )\n    );\n  }\n\n  /**\n   * Returns `true` if either the banner is not dismissed or if the templates were updated on the back-end.\n   * Otherwise, it returns `false`.\n   */\n  isBannerVisible(): Observable<boolean> {\n    return combineLatest([\n      this.isBannerDismissed(),\n      this.getTemplatesUpdated(),\n    ]).pipe(map(([dismissed, updated]) => !dismissed || updated));\n  }\n\n  /**\n   * Returns `true` if there's a missmatch in template versions between the provided `currentTemplates` and `newTemplates`\n   * @param currentTemplates current templates to check\n   * @param newTemplates new templates to check\n   */\n  detectUpdatedTemplates(\n    currentTemplates: ConsentTemplate[],\n    newTemplates: ConsentTemplate[]\n  ): boolean {\n    if (newTemplates.length !== currentTemplates.length) {\n      return true;\n    }\n\n    for (let i = 0; i < newTemplates.length; i++) {\n      const newTemplate = newTemplates[i];\n      const currentTemplate = currentTemplates[i];\n      if (newTemplate.version !== currentTemplate.version) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Serializes using `JSON.stringify()` and encodes using `encodeURIComponent()` methods\n   * @param consents to serialize and encode\n   */\n  serializeAndEncode(consents: AnonymousConsent[]): string {\n    if (!consents) {\n      return '';\n    }\n    const serialized = JSON.stringify(consents);\n    const encoded = encodeURIComponent(serialized);\n    return encoded;\n  }\n\n  /**\n   * Decodes using `decodeURIComponent()` and deserializes using `JSON.parse()`\n   * @param rawConsents to decode an deserialize\n   */\n  decodeAndDeserialize(rawConsents: string): AnonymousConsent[] {\n    const decoded = decodeURIComponent(rawConsents);\n    const unserialized = JSON.parse(decoded) as AnonymousConsent[];\n    return unserialized;\n  }\n\n  /**\n   *\n   * Compares the given `newConsents` and `previousConsents` and returns `true` if there are differences (the `newConsents` are updates).\n   * Otherwise it returns `false`.\n   *\n   * @param newConsents new consents to compare\n   * @param previousConsents old consents to compare\n   */\n  consentsUpdated(\n    newConsents: AnonymousConsent[],\n    previousConsents: AnonymousConsent[]\n  ): boolean {\n    const newRawConsents = this.serializeAndEncode(newConsents);\n    const previousRawConsents = this.serializeAndEncode(previousConsents);\n    return newRawConsents !== previousRawConsents;\n  }\n}\n","export abstract class FeaturesConfig {\n  features?: {\n    [featureToggle: string]: string | boolean;\n  };\n}\n\nexport const ANONYMOUS_CONSENTS_FEATURE = 'anonymousConsents';\n","import { FeaturesConfig } from '../config/features-config';\n\nfunction isFeatureConfig(config: any): config is FeaturesConfig {\n  return typeof config === 'object' && config.features;\n}\n\nfunction isInLevel(level, version) {\n  if (level === '*') {\n    return true;\n  }\n  const levelParts = level.split('.');\n  const versionParts = version.split('.');\n\n  for (let i = 0; i < versionParts.length; i++) {\n    const versionNumberPart = Number(versionParts[i]);\n    const levelNumberPart = Number(levelParts[i]) || 0;\n\n    if (versionNumberPart !== levelNumberPart) {\n      return levelNumberPart > versionNumberPart;\n    }\n  }\n  return true;\n}\n\nexport function isFeatureLevel(config: unknown, level: string): boolean {\n  if (isFeatureConfig(config)) {\n    return level[0] === '!'\n      ? !isInLevel(config.features.level, level.substr(1, level.length))\n      : isInLevel(config.features.level, level);\n  }\n}\n\nexport function isFeatureEnabled(config: unknown, feature: string): boolean {\n  if (isFeatureConfig(config)) {\n    const featureConfig =\n      feature[0] === '!'\n        ? config.features[feature.substr(1, feature.length)]\n        : config.features[feature];\n\n    const result =\n      typeof featureConfig === 'string'\n        ? isFeatureLevel(config, featureConfig)\n        : featureConfig;\n\n    return feature[0] === '!' ? !result : result;\n  }\n}\n","import { StaticProvider } from '@angular/core';\nimport { Routes } from '@angular/router';\nimport { AuthConfig } from '../../auth/config/auth-config';\nimport { KymaConfig } from '../../kyma/config/kyma-config';\nimport { OccConfig } from '../../occ/config/occ-config';\n\nexport interface StandardCmsComponentConfig {\n  CMSSiteContextComponent?: CmsComponentMapping;\n  CMSLinkComponent?: CmsComponentMapping;\n  SimpleResponsiveBannerComponent?: CmsComponentMapping;\n  SimpleBannerComponent?: CmsComponentMapping;\n  BannerComponent?: CmsComponentMapping;\n  CMSParagraphComponent?: CmsComponentMapping;\n  BreadcrumbComponent?: CmsComponentMapping;\n  NavigationComponent?: CmsComponentMapping;\n  FooterNavigationComponent?: CmsComponentMapping;\n  CategoryNavigationComponent?: CmsComponentMapping;\n  ProductAddToCartComponent?: CmsComponentMapping;\n  MiniCartComponent?: CmsComponentMapping;\n  ProductCarouselComponent?: CmsComponentMapping;\n  SearchBoxComponent?: CmsComponentMapping;\n  ProductReferencesComponent?: CmsComponentMapping;\n  CMSTabParagraphComponent?: CmsComponentMapping;\n  LoginComponent?: CmsComponentMapping;\n}\n\nexport interface JspIncludeCmsComponentConfig {\n  AccountAddressBookComponent?: CmsComponentMapping;\n  ForgotPasswordComponent?: CmsComponentMapping;\n  ResetPasswordComponent?: CmsComponentMapping;\n  ProductDetailsTabComponent?: CmsComponentMapping;\n  ProductSpecsTabComponent?: CmsComponentMapping;\n  ProductReviewsTabComponent?: CmsComponentMapping;\n}\n\nexport const JSP_INCLUDE_CMS_COMPONENT_TYPE = 'JspIncludeComponent';\nexport const CMS_FLEX_COMPONENT_TYPE = 'CMSFlexComponent';\n\nexport interface CmsComponentMapping {\n  component?: any;\n  providers?: StaticProvider[];\n  childRoutes?: Routes;\n  disableSSR?: boolean;\n  i18nKeys?: string[];\n  guards?: any[];\n\n  /**\n   * DeferLoading can be specified globally, but also per component.\n   * Some components require direct loading while it's not initially\n   * in the viewport.\n   */\n  deferLoading?: DeferLoadingStrategy;\n}\n\n/** Strategy to control the loading strategy of DOM elements. */\nexport enum DeferLoadingStrategy {\n  /** Defers loading of DOM elements until element is near/in the users view port */\n  DEFER = 'DEFERRED-LOADING',\n  /** Renders the DOM instantly without being concerned with the view port */\n  INSTANT = 'INSTANT-LOADING',\n}\n\nexport interface CMSComponentConfig\n  extends StandardCmsComponentConfig,\n    JspIncludeCmsComponentConfig {\n  [_: string]: CmsComponentMapping;\n}\n\nexport abstract class CmsConfig extends OccConfig\n  implements AuthConfig, KymaConfig {\n  authentication?: {\n    client_id?: string;\n    client_secret?: string;\n\n    kyma_enabled?: boolean;\n    kyma_client_id?: string;\n    kyma_client_secret?: string;\n  };\n\n  cmsComponents?: CMSComponentConfig;\n}\n","import { Injectable } from '@angular/core';\nimport { FeaturesConfig } from '../config/features-config';\nimport {\n  isFeatureEnabled,\n  isFeatureLevel,\n} from '../utils/feature-config-utils';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class FeatureConfigService {\n  constructor(protected config: FeaturesConfig) {}\n\n  isLevel(version: string): boolean {\n    return isFeatureLevel(this.config, version);\n  }\n\n  isEnabled(feature: string) {\n    return isFeatureEnabled(this.config, feature);\n  }\n}\n","import { Directive, Input, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { FeatureConfigService } from '../services/feature-config.service';\n\n@Directive({\n  selector: '[cxFeatureLevel]',\n})\nexport class FeatureLevelDirective {\n  constructor(\n    protected templateRef: TemplateRef<any>,\n    protected viewContainer: ViewContainerRef,\n    protected featureConfig: FeatureConfigService\n  ) {}\n\n  private hasView = false;\n\n  @Input() set cxFeatureLevel(level: string | number) {\n    if (this.featureConfig.isLevel(level.toString()) && !this.hasView) {\n      this.viewContainer.createEmbeddedView(this.templateRef);\n      this.hasView = true;\n    } else if (!this.featureConfig.isLevel(level.toString()) && this.hasView) {\n      this.viewContainer.clear();\n      this.hasView = false;\n    }\n  }\n}\n","import { Directive, Input, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { FeatureConfigService } from '../services/feature-config.service';\n\n@Directive({\n  selector: '[cxFeature]',\n})\nexport class FeatureDirective {\n  constructor(\n    protected templateRef: TemplateRef<any>,\n    protected viewContainer: ViewContainerRef,\n    protected featureConfig: FeatureConfigService\n  ) {}\n\n  private hasView = false;\n\n  @Input() set cxFeature(feature: string) {\n    if (this.featureConfig.isEnabled(feature) && !this.hasView) {\n      this.viewContainer.createEmbeddedView(this.templateRef);\n      this.hasView = true;\n    } else if (!this.featureConfig.isEnabled(feature) && this.hasView) {\n      this.viewContainer.clear();\n      this.hasView = false;\n    }\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { FeaturesConfig } from './config/features-config';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { FeatureLevelDirective } from './directives/feature-level.directive';\nimport { FeatureDirective } from './directives/feature.directive';\n\n@NgModule({\n  declarations: [FeatureLevelDirective, FeatureDirective],\n  exports: [FeatureLevelDirective, FeatureDirective],\n})\nexport class FeaturesConfigModule {\n  static forRoot(\n    defaultLevel?: string\n  ): ModuleWithProviders<FeaturesConfigModule> {\n    return {\n      ngModule: FeaturesConfigModule,\n      providers: [\n        provideDefaultConfig(<FeaturesConfig>{\n          features: {\n            level: defaultLevel || '*',\n          },\n        }),\n        {\n          provide: FeaturesConfig,\n          useExisting: Config,\n        },\n      ],\n    };\n  }\n}\n","import { Observable } from 'rxjs';\nimport {\n  CustomerSearchOptions,\n  CustomerSearchPage,\n} from '../models/asm.models';\n\nexport abstract class AsmAdapter {\n  /**\n   * Abstract function used to search for customers.\n   */\n  abstract customerSearch(\n    options: CustomerSearchOptions\n  ): Observable<CustomerSearchPage>;\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccAsmConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        asmCustomerSearch: '/assistedservicewebservices/customers/search',\n      },\n    },\n  },\n};\n","import { OccConfig } from '../../occ/config/occ-config';\n\nexport abstract class AsmConfig extends OccConfig {\n  asm?: {\n    agentSessionTimer?: {\n      startingDelayInSeconds?: number;\n    };\n    customerSearch?: {\n      maxResults?: number;\n    };\n  };\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../util/converter.service';\nimport { CustomerSearchPage } from '../models/asm.models';\n\nexport const CUSTOMER_SEARCH_PAGE_NORMALIZER = new InjectionToken<\n  Converter<any, CustomerSearchPage>\n>('CustomerSearchPageNormalizer');\n","import { Injectable, InjectionToken, Injector } from '@angular/core';\nimport { Observable, OperatorFunction } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\n/**\n * Converter is used to convert source data model to target data model.\n * By convention, we distinguish two flows:\n *   - *Normalize* is the conversion from backend models to UI models\n *   - *Serialize* is the conversion of UI models to backend models (in case of submitting data to the backend).\n *\n * Converters can be stacked together to to apply decoupled customizations\n */\nexport interface Converter<S, T> {\n  /**\n   * Convert converts source model to target model. Can use optional target parameter,\n   * used in case of stacking multiple converters (for example, to implement populator pattern).\n   *\n   * @param source Source data model\n   * @param target Optional, partially converted target model\n   */\n  convert(source: S, target?: T): T;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConverterService {\n  constructor(protected injector: Injector) {}\n\n  private converters: Map<\n    InjectionToken<Converter<any, any>>,\n    Converter<any, any>[]\n  > = new Map();\n\n  private getConverters<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): Converter<S, T>[] {\n    if (!this.converters.has(injectionToken)) {\n      const converters = this.injector.get<Converter<S, T>[]>(\n        injectionToken,\n        []\n      );\n      if (!Array.isArray(converters)) {\n        console.warn(\n          'Converter must be multi-provided, please use \"multi: true\" for',\n          injectionToken.toString()\n        );\n      }\n      this.converters.set(injectionToken, converters);\n    }\n\n    return this.converters.get(injectionToken);\n  }\n\n  /**\n   * Will return true if converters for specified token were provided\n   */\n  hasConverters<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): boolean {\n    const converters = this.getConverters(injectionToken);\n    return Array.isArray(converters) && converters.length > 0;\n  }\n\n  /**\n   * Pipeable operator to apply converter logic in a observable stream\n   */\n  pipeable<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): OperatorFunction<S, T> {\n    if (this.hasConverters(injectionToken)) {\n      return map((model: S) => this.convertSource(model, injectionToken));\n    } else {\n      return (observable: Observable<any>) => observable as Observable<T>;\n    }\n  }\n\n  /**\n   * Pipeable operator to apply converter logic in a observable stream to collection of items\n   */\n  pipeableMany<S, T>(\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): OperatorFunction<S[], T[]> {\n    if (this.hasConverters(injectionToken)) {\n      return map((model: S[]) => this.convertMany(model, injectionToken));\n    } else {\n      return (observable: Observable<any[]>) => observable as Observable<T[]>;\n    }\n  }\n\n  /**\n   * Apply converter logic specified by injection token to source data\n   */\n  convert<S, T>(source: S, injectionToken: InjectionToken<Converter<S, T>>): T {\n    if (this.hasConverters(injectionToken)) {\n      return this.convertSource(source, injectionToken);\n    } else {\n      return source as any;\n    }\n  }\n\n  /**\n   * Apply converter logic specified by injection token to a collection\n   */\n  convertMany<S, T>(\n    sources: S[],\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): T[] {\n    if (this.hasConverters(injectionToken) && Array.isArray(sources)) {\n      return sources.map(source => this.convertSource(source, injectionToken));\n    } else {\n      return sources as any[];\n    }\n  }\n\n  private convertSource<S, T>(\n    source: S,\n    injectionToken: InjectionToken<Converter<S, T>>\n  ): T {\n    return this.getConverters(injectionToken).reduce((target, converter) => {\n      return converter.convert(source, target);\n    }, undefined as T);\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { AsmConfig } from '../../../asm/config/asm-config';\nimport { AsmAdapter } from '../../../asm/connectors/asm.adapter';\nimport { CUSTOMER_SEARCH_PAGE_NORMALIZER } from '../../../asm/connectors/converters';\nimport {\n  CustomerSearchOptions,\n  CustomerSearchPage,\n} from '../../../asm/models/asm.models';\nimport { BaseSiteService } from '../../../site-context/facade/base-site.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n} from '../../utils/interceptor-util';\n\n@Injectable()\nexport class OccAsmAdapter implements AsmAdapter {\n  private activeBaseSite: string;\n\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService,\n    protected config: AsmConfig,\n    protected baseSiteService: BaseSiteService\n  ) {\n    this.baseSiteService\n      .getActive()\n      .subscribe(value => (this.activeBaseSite = value));\n  }\n\n  customerSearch(\n    options: CustomerSearchOptions\n  ): Observable<CustomerSearchPage> {\n    const headers = InterceptorUtil.createHeader(\n      USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n      true,\n      new HttpHeaders()\n    );\n    let params: HttpParams = new HttpParams()\n      .set('baseSite', this.activeBaseSite)\n      .set('sort', 'byNameAsc');\n\n    if (typeof options['query'] !== 'undefined') {\n      params = params.set('query', '' + options.query);\n    }\n\n    if (typeof options['pageSize'] !== 'undefined') {\n      params = params.set('pageSize', '' + options.pageSize);\n    }\n\n    const url = this.occEndpointsService.getRawEndpoint('asmCustomerSearch');\n\n    return this.http\n      .get<CustomerSearchPage>(url, { headers, params })\n      .pipe(this.converterService.pipeable(CUSTOMER_SEARCH_PAGE_NORMALIZER));\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { AsmAdapter } from '../../../asm/connectors/asm.adapter';\nimport { provideDefaultConfig } from '../../../config/config.module';\nimport { defaultOccAsmConfig } from './default-occ-asm-config';\nimport { OccAsmAdapter } from './occ-asm.adapter';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    provideDefaultConfig(defaultOccAsmConfig),\n    {\n      provide: AsmAdapter,\n      useClass: OccAsmAdapter,\n    },\n  ],\n})\nexport class AsmOccModule {}\n","import { Observable } from 'rxjs';\nimport { Cart } from '../../../model/cart.model';\n\nexport abstract class CartAdapter {\n  /**\n   * Abstract method used to load all carts\n   *\n   * @param userId\n   */\n  abstract loadAll(userId: string): Observable<Cart[]>;\n\n  /**\n   * Abstract method used to load cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract load(userId: string, cartId: string): Observable<Cart>;\n\n  /**\n   * Abstract method used to create cart. If toMergeCartGuid is specified, cart will be merged with existing one\n   *\n   * @param userId\n   * @param oldCartId\n   * @param toMergeCartGuid\n   */\n  abstract create(\n    userId: string,\n    oldCartId?: string,\n    toMergeCartGuid?: string\n  ): Observable<Cart>;\n\n  /**\n   * Abstract method used to delete cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract delete(userId: string, cartId: string): Observable<{}>;\n\n  /**\n   * Abstract method to assign an email to the cart. This step is required to make a guest checkout\n   * @param userId\n   * @param cartId\n   * @param email\n   */\n  abstract addEmail(\n    userId: string,\n    cartId: string,\n    email: string\n  ): Observable<{}>;\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Cart } from '../../../model/cart.model';\n\nexport const CART_NORMALIZER = new InjectionToken<Converter<any, Cart>>(\n  'CartNormalizer'\n);\n","import { Observable } from 'rxjs';\nimport { CartModification } from '../../../model/cart.model';\n\nexport abstract class CartEntryAdapter {\n  /**\n   * Abstract method used to add entry to cart\n   *\n   * @param userId\n   * @param cartId\n   * @param productCode\n   * @param quantity\n   */\n  abstract add(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity?: number\n  ): Observable<CartModification>;\n\n  /**\n   * Abstract method used to update entry in cart\n   * @param userId\n   * @param cartId\n   * @param entryNumber\n   * @param qty\n   * @param pickupStore\n   */\n  abstract update(\n    userId: string,\n    cartId: string,\n    entryNumber: string,\n    qty: number,\n    pickupStore?: string\n  ): Observable<CartModification>;\n\n  /**\n   * Abstract method used to remove entry from cart\n   *\n   * @param userId\n   * @param cartId\n   * @param entryNumber\n   */\n  abstract remove(\n    userId: string,\n    cartId: string,\n    entryNumber: string\n  ): Observable<any>;\n}\n","import { Observable } from 'rxjs';\nimport { SaveCartResult } from '../../../model/cart.model';\n\nexport abstract class SaveCartAdapter {\n  /**\n   * Abstract method used to save a cart\n   *\n   * @param userId: string\n   * @param cartId: string\n   * @param saveCartName?: string\n   * @param saveCartDescription?: string\n   */\n  abstract saveCart(\n    userId: string,\n    cartId: string,\n    saveCartName?: string,\n    saveCartDescription?: string\n  ): Observable<SaveCartResult>;\n}\n","import { Observable } from 'rxjs';\n\nexport abstract class CartVoucherAdapter {\n  /**\n   * Abstract method used to apply voucher to cart\n   *\n   * @param userId\n   * @param cartId\n   * @param voucherId\n   */\n  abstract add(\n    userId: string,\n    cartId: string,\n    voucherId: string\n  ): Observable<{}>;\n\n  /**\n   * Abstract method used to remove voucher from cart\n   *\n   * @param userId\n   * @param cartId\n   * @param voucherId\n   */\n  abstract remove(\n    userId: string,\n    cartId: string,\n    voucherId: string\n  ): Observable<{}>;\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Product } from '../../../model/product.model';\n\nexport const PRODUCT_NORMALIZER = new InjectionToken<Converter<any, Product>>(\n  'ProductNormalizer'\n);\n","import { Injectable } from '@angular/core';\nimport { Cart } from '../../../../model/cart.model';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccCartNormalizer implements Converter<Occ.Cart, Cart> {\n  constructor(private converter: ConverterService) {}\n\n  convert(source: Occ.Cart, target?: Cart): Cart {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source && source.entries) {\n      target.entries = source.entries.map(entry => ({\n        ...entry,\n        product: this.converter.convert(entry.product, PRODUCT_NORMALIZER),\n      }));\n    }\n\n    this.removeDuplicatePromotions(source, target);\n    return target;\n  }\n\n  /**\n   * Remove all duplicate promotions\n   */\n  private removeDuplicatePromotions(source: any, target: Cart): void {\n    if (source && source.potentialOrderPromotions) {\n      target.potentialOrderPromotions = this.removeDuplicateItems(\n        source.potentialOrderPromotions\n      );\n    }\n\n    if (source && source.potentialProductPromotions) {\n      target.potentialProductPromotions = this.removeDuplicateItems(\n        source.potentialProductPromotions\n      );\n    }\n\n    if (source && source.appliedOrderPromotions) {\n      target.appliedOrderPromotions = this.removeDuplicateItems(\n        source.appliedOrderPromotions\n      );\n    }\n\n    if (source && source.appliedProductPromotions) {\n      target.appliedProductPromotions = this.removeDuplicateItems(\n        source.appliedProductPromotions\n      );\n    }\n  }\n\n  private removeDuplicateItems(itemList: any[]): any[] {\n    return itemList.filter((p, i, a) => {\n      const b = a.map(el => JSON.stringify(el));\n      return i === b.indexOf(JSON.stringify(p));\n    });\n  }\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccCartConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        // tslint:disable:max-line-length\n        carts:\n          'users/${userId}/carts?fields=carts(DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),saveTime,user,name)',\n        cart:\n          'users/${userId}/carts/${cartId}?fields=DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user',\n        createCart:\n          'users/${userId}/carts?fields=DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user',\n        addEntries: 'users/${userId}/carts/${cartId}/entries',\n        updateEntries: 'users/${userId}/carts/${cartId}/entries/${entryNumber}',\n        removeEntries: 'users/${userId}/carts/${cartId}/entries/${entryNumber}',\n        addEmail: 'users/${userId}/carts/${cartId}/email',\n        deleteCart: 'users/${userId}/carts/${cartId}',\n        cartVoucher: 'users/${userId}/carts/${cartId}/vouchers',\n        saveCart: 'users/${userId}/carts/${cartId}/save',\n        // tslint:enable\n      },\n    },\n  },\n};\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { CartModification } from '../../../model/cart.model';\n\nexport const CART_MODIFICATION_NORMALIZER = new InjectionToken<\n  Converter<any, CartModification>\n>('CartModificationNormalizer');\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CartEntryAdapter } from '../../../cart/connectors/entry/cart-entry.adapter';\nimport { CART_MODIFICATION_NORMALIZER } from '../../../cart/connectors/entry/converters';\nimport { FeatureConfigService } from '../../../features-config/services/feature-config.service';\nimport { CartModification } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCartEntryAdapter implements CartEntryAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService,\n    protected featureConfigService?: FeatureConfigService\n  ) {}\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = 'users/' + userId + '/carts/';\n    return this.occEndpointsService.getEndpoint(cartEndpoint);\n  }\n\n  public add(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity: number = 1\n  ): Observable<CartModification> {\n    const toAdd = JSON.stringify({});\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    // TODO: Deprecated, remove Issue: #4125\n    if (!this.featureConfigService.isLevel('1.1')) {\n      return this.legacyAdd(userId, cartId, productCode, quantity);\n    }\n\n    const url = this.occEndpointsService.getUrl(\n      'addEntries',\n      {\n        userId,\n        cartId,\n      },\n      { code: productCode, qty: quantity }\n    );\n\n    return this.http\n      .post<CartModification>(url, toAdd, { headers })\n      .pipe(this.converterService.pipeable(CART_MODIFICATION_NORMALIZER));\n  }\n\n  public update(\n    userId: string,\n    cartId: string,\n    entryNumber: string,\n    qty: number,\n    pickupStore?: string\n  ): Observable<CartModification> {\n    let params = {};\n    if (pickupStore) {\n      params = { pickupStore };\n    }\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    // TODO: Deprecated, remove Issue: #4125\n    if (!this.featureConfigService.isLevel('1.1')) {\n      return this.legacyUpdate(userId, cartId, entryNumber, qty, pickupStore);\n    }\n\n    const url = this.occEndpointsService.getUrl(\n      'updateEntries',\n      { userId, cartId, entryNumber },\n      { qty, ...params }\n    );\n\n    return this.http\n      .patch<CartModification>(url, {}, { headers })\n      .pipe(this.converterService.pipeable(CART_MODIFICATION_NORMALIZER));\n  }\n\n  public remove(\n    userId: string,\n    cartId: string,\n    entryNumber: string\n  ): Observable<any> {\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    // TODO: Deprecated, remove Issue: #4125\n    if (!this.featureConfigService.isLevel('1.1')) {\n      return this.legacyRemove(userId, cartId, entryNumber);\n    }\n\n    const url = this.occEndpointsService.getUrl('removeEntries', {\n      userId,\n      cartId,\n      entryNumber,\n    });\n\n    return this.http.delete(url, { headers });\n  }\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  private legacyAdd(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity: number = 1\n  ): Observable<CartModification> {\n    const url = this.getCartEndpoint(userId) + cartId + '/entries';\n\n    const params = new HttpParams({\n      fromString: 'code=' + productCode + '&qty=' + quantity,\n    });\n\n    const toAdd = JSON.stringify({});\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .post<CartModification>(url, toAdd, { headers, params })\n      .pipe(this.converterService.pipeable(CART_MODIFICATION_NORMALIZER));\n  }\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  private legacyUpdate(\n    userId: string,\n    cartId: string,\n    entryNumber: string,\n    qty: number,\n    pickupStore?: string\n  ): Observable<CartModification> {\n    const url =\n      this.getCartEndpoint(userId) + cartId + '/entries/' + entryNumber;\n    let queryString = 'qty=' + qty;\n\n    if (pickupStore) {\n      queryString = queryString + '&pickupStore=' + pickupStore;\n    }\n    const params = new HttpParams({\n      fromString: queryString,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http\n      .patch<CartModification>(url, {}, { headers, params })\n      .pipe(this.converterService.pipeable(CART_MODIFICATION_NORMALIZER));\n  }\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  private legacyRemove(\n    userId: string,\n    cartId: string,\n    entryNumber: string\n  ): Observable<any> {\n    const url =\n      this.getCartEndpoint(userId) + cartId + '/entries/' + entryNumber;\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http.delete(url, { headers });\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Voucher } from '../../../model/cart.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const CART_VOUCHER_NORMALIZER = new InjectionToken<\n  Converter<any, Voucher>\n>('CartVoucherNormalizer');\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { CartVoucherAdapter } from '../../../cart/connectors/voucher/cart-voucher.adapter';\nimport { CART_VOUCHER_NORMALIZER } from '../../../cart/connectors/voucher/converters';\nimport { OCC_USER_ID_ANONYMOUS } from '../../../occ/utils/occ-constants';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\n\n@Injectable()\nexport class OccCartVoucherAdapter implements CartVoucherAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getCartVoucherEndpoint(userId: string, cartId): string {\n    return this.occEndpoints.getUrl('cartVoucher', { userId, cartId });\n  }\n\n  protected getHeaders(userId: string): HttpHeaders {\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n\n    return headers;\n  }\n\n  add(userId: string, cartId: string, voucherId: string): Observable<{}> {\n    const url = this.getCartVoucherEndpoint(userId, cartId);\n\n    const toAdd = JSON.stringify({});\n\n    const params: HttpParams = new HttpParams().set('voucherId', voucherId);\n\n    const headers = this.getHeaders(userId);\n\n    return this.http.post(url, toAdd, { headers, params }).pipe(\n      catchError((error: any) => throwError(error.json())),\n      this.converter.pipeable(CART_VOUCHER_NORMALIZER)\n    );\n  }\n\n  remove(userId: string, cartId: string, voucherId: string): Observable<{}> {\n    const url =\n      this.getCartVoucherEndpoint(userId, cartId) +\n      '/' +\n      encodeURIComponent(voucherId);\n\n    const headers = this.getHeaders(userId);\n\n    return this.http\n      .delete(url, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map, pluck } from 'rxjs/operators';\nimport { CartAdapter } from '../../../cart/connectors/cart/cart.adapter';\nimport { CART_NORMALIZER } from '../../../cart/connectors/cart/converters';\nimport { FeatureConfigService } from '../../../features-config/services/feature-config.service';\nimport { Cart } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\nimport {\n  OCC_USER_ID_ANONYMOUS,\n  OCC_CART_ID_CURRENT,\n} from '../../utils/occ-constants';\n\n// TODO: Deprecated, remove Issue: #4125. Use configurable endpoints.\nconst DETAILS_PARAMS =\n  'DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,' +\n  'entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue),updateable),' +\n  'totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),' +\n  'deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue),pickupItemsQuantity,net,' +\n  'appliedVouchers,productDiscounts(formattedValue),user';\n\n@Injectable()\nexport class OccCartAdapter implements CartAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService,\n    protected featureConfigService?: FeatureConfigService\n  ) {}\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = `users/${userId}/carts/`;\n    return this.occEndpointsService.getEndpoint(cartEndpoint);\n  }\n\n  public loadAll(userId: string): Observable<Cart[]> {\n    // TODO: Deprecated, remove Issue: #4125.\n    if (!this.featureConfigService.isLevel('1.1')) {\n      return this.legacyLoadAll(userId);\n    }\n\n    return this.http\n      .get<Occ.CartList>(this.occEndpointsService.getUrl('carts', { userId }))\n      .pipe(\n        pluck('carts'),\n        this.converterService.pipeableMany(CART_NORMALIZER)\n      );\n  }\n\n  public load(userId: string, cartId: string): Observable<Cart> {\n    if (cartId === OCC_CART_ID_CURRENT) {\n      return this.loadAll(userId).pipe(\n        map(carts => {\n          if (carts) {\n            const activeCart = carts.find(cart => {\n              return cart['saveTime'] === undefined;\n            });\n            return activeCart;\n          } else {\n            return null;\n          }\n        })\n      );\n    } else {\n      // TODO: Deprecated, remove Issue: #4125.\n      if (!this.featureConfigService.isLevel('1.1')) {\n        return this.legacyLoad(userId, cartId);\n      }\n      return this.http\n        .get<Occ.Cart>(\n          this.occEndpointsService.getUrl('cart', { userId, cartId })\n        )\n        .pipe(this.converterService.pipeable(CART_NORMALIZER));\n    }\n  }\n\n  create(\n    userId: string,\n    oldCartId?: string,\n    toMergeCartGuid?: string\n  ): Observable<Cart> {\n    const toAdd = JSON.stringify({});\n    // TODO: Deprecated, remove Issue: #4125.\n    if (!this.featureConfigService.isLevel('1.1')) {\n      return this.legacyCreate(userId, toAdd, oldCartId, toMergeCartGuid);\n    }\n\n    let params = {};\n\n    if (oldCartId) {\n      params = { oldCartId: oldCartId };\n    }\n    if (toMergeCartGuid) {\n      params['toMergeCartGuid'] = toMergeCartGuid;\n    }\n\n    return this.http\n      .post<Occ.Cart>(\n        this.occEndpointsService.getUrl('createCart', { userId }, params),\n        toAdd\n      )\n      .pipe(this.converterService.pipeable(CART_NORMALIZER));\n  }\n\n  delete(userId: string, cartId: string): Observable<{}> {\n    let headers = new HttpHeaders();\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n    return this.http.delete<{}>(\n      this.occEndpointsService.getUrl('deleteCart', { userId, cartId }),\n      { headers }\n    );\n  }\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  private legacyLoadAll(userId: string): Observable<Cart[]> {\n    const url = this.getCartEndpoint(userId);\n    const params = new HttpParams({\n      fromString: `fields=carts(${DETAILS_PARAMS},saveTime)`,\n    });\n\n    return this.http\n      .get<Occ.CartList>(url, { params })\n      .pipe(\n        pluck('carts'),\n        this.converterService.pipeableMany(CART_NORMALIZER)\n      );\n  }\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  private legacyLoad(userId: string, cartId: string): Observable<Cart> {\n    const url = this.getCartEndpoint(userId) + cartId;\n    const params = new HttpParams({\n      fromString: `fields=${DETAILS_PARAMS}`,\n    });\n\n    return this.http\n      .get<Occ.Cart>(url, { params })\n      .pipe(this.converterService.pipeable(CART_NORMALIZER));\n  }\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  private legacyCreate(\n    userId: string,\n    toAdd: string,\n    oldCartId?: string,\n    toMergeCartGuid?: string\n  ): Observable<Cart> {\n    const url = this.getCartEndpoint(userId);\n    let queryString = `fields=${DETAILS_PARAMS}`;\n\n    if (oldCartId) {\n      queryString = `${queryString}&oldCartId=${oldCartId}`;\n    }\n    if (toMergeCartGuid) {\n      queryString = `${queryString}&toMergeCartGuid=${toMergeCartGuid}`;\n    }\n\n    const params = new HttpParams({\n      fromString: queryString,\n    });\n\n    return this.http\n      .post<Occ.Cart>(url, toAdd, { params })\n      .pipe(this.converterService.pipeable(CART_NORMALIZER));\n  }\n\n  addEmail(userId: string, cartId: string, email: string): Observable<{}> {\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n\n    const httpParams: HttpParams = new HttpParams().set('email', email);\n\n    const url = this.occEndpointsService.getUrl('addEmail', {\n      userId,\n      cartId,\n    });\n\n    return this.http.put(url, httpParams, { headers });\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { SaveCartResult } from '../../../model/cart.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const SAVE_CART_NORMALIZER = new InjectionToken<\n  Converter<any, SaveCartResult>\n>('SaveCartNormalizer');\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { SAVE_CART_NORMALIZER } from '../../../cart/connectors/save-cart/converters';\nimport { SaveCartAdapter } from '../../../cart/connectors/save-cart/save-cart.adapter';\nimport { SaveCartResult } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccSaveCartAdapter implements SaveCartAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService\n  ) {}\n\n  public saveCart(\n    userId: string,\n    cartId: string,\n    saveCartName?: string,\n    saveCartDescription?: string\n  ): Observable<SaveCartResult> {\n    let httpParams = new HttpParams();\n\n    if (Boolean(saveCartName)) {\n      httpParams = httpParams.set('saveCartName', saveCartName);\n    }\n\n    if (Boolean(saveCartDescription)) {\n      httpParams = httpParams.set('saveCartDescription', saveCartDescription);\n    }\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .patch<Occ.SaveCartResult>(\n        this.occEndpointsService.getUrl('saveCart', { userId, cartId }),\n        httpParams,\n        { headers }\n      )\n      .pipe(this.converterService.pipeable(SAVE_CART_NORMALIZER));\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { CartAdapter } from '../../../cart/connectors/cart/cart.adapter';\nimport { CART_NORMALIZER } from '../../../cart/connectors/cart/converters';\nimport { CartEntryAdapter } from '../../../cart/connectors/entry/cart-entry.adapter';\nimport { SaveCartAdapter } from '../../../cart/connectors/save-cart/save-cart.adapter';\nimport { CartVoucherAdapter } from '../../../cart/connectors/voucher/cart-voucher.adapter';\nimport { provideDefaultConfig } from '../../../config/config.module';\nimport { OccCartNormalizer } from './converters/occ-cart-normalizer';\nimport { defaultOccCartConfig } from './default-occ-cart-config';\nimport { OccCartEntryAdapter } from './occ-cart-entry.adapter';\nimport { OccCartVoucherAdapter } from './occ-cart-voucher.adapter';\nimport { OccCartAdapter } from './occ-cart.adapter';\nimport { OccSaveCartAdapter } from './occ-save-cart.adapter';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    provideDefaultConfig(defaultOccCartConfig),\n    {\n      provide: CartAdapter,\n      useClass: OccCartAdapter,\n    },\n    {\n      provide: CART_NORMALIZER,\n      useExisting: OccCartNormalizer,\n      multi: true,\n    },\n    {\n      provide: CartEntryAdapter,\n      useClass: OccCartEntryAdapter,\n    },\n    {\n      provide: CartVoucherAdapter,\n      useClass: OccCartVoucherAdapter,\n    },\n    {\n      provide: SaveCartAdapter,\n      useClass: OccSaveCartAdapter,\n    },\n  ],\n})\nexport class CartOccModule {}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Order } from '../../../model/order.model';\n\nexport const ORDER_NORMALIZER = new InjectionToken<Converter<any, Order>>(\n  'OrderNormalizer'\n);\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CheckoutAdapter } from '../../../checkout/connectors/checkout/checkout.adapter';\nimport { ORDER_NORMALIZER } from '../../../checkout/connectors/checkout/converters';\nimport { CheckoutDetails } from '../../../checkout/models/checkout.model';\nimport { Order } from '../../../model/order.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\nimport { OCC_USER_ID_ANONYMOUS } from '../../utils/occ-constants';\n\n// To be changed to a more optimised params after ticket: C3PO-1076\nconst FULL_PARAMS = 'fields=FULL';\nconst CHECKOUT_PARAMS = 'deliveryAddress(FULL),deliveryMode,paymentInfo(FULL)';\nconst ORDERS_ENDPOINT = '/orders';\nconst CARTS_ENDPOINT = '/carts/';\n\n@Injectable()\nexport class OccCheckoutAdapter implements CheckoutAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getEndpoint(userId: string, subEndpoint: string): string {\n    const orderEndpoint = 'users/' + userId + subEndpoint;\n    return this.occEndpoints.getEndpoint(orderEndpoint);\n  }\n\n  public placeOrder(userId: string, cartId: string): Observable<Order> {\n    const url = this.getEndpoint(userId, ORDERS_ENDPOINT);\n    const params = new HttpParams({\n      fromString: 'cartId=' + cartId + '&' + FULL_PARAMS,\n    });\n\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n\n    return this.http\n      .post<Occ.Order>(url, {}, { headers, params })\n      .pipe(this.converter.pipeable(ORDER_NORMALIZER));\n  }\n\n  loadCheckoutDetails(\n    userId: string,\n    cartId: string\n  ): Observable<CheckoutDetails> {\n    const url = this.getEndpoint(userId, CARTS_ENDPOINT) + cartId;\n    const params = new HttpParams({\n      fromString: `fields=${CHECKOUT_PARAMS}`,\n    });\n    return this.http.get<CheckoutDetails>(url, { params });\n  }\n\n  clearCheckoutDeliveryAddress(\n    userId: string,\n    cartId: string\n  ): Observable<any> {\n    const url = `${this.getEndpoint(\n      userId,\n      CARTS_ENDPOINT\n    )}${cartId}/addresses/delivery`;\n    return this.http.delete<any>(url);\n  }\n\n  clearCheckoutDeliveryMode(userId: string, cartId: string): Observable<any> {\n    const url = `${this.getEndpoint(\n      userId,\n      CARTS_ENDPOINT\n    )}${cartId}/deliverymode`;\n    return this.http.delete<any>(url);\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { DeliveryMode } from '../../../model/order.model';\n\nexport const DELIVERY_MODE_NORMALIZER = new InjectionToken<\n  Converter<any, DeliveryMode>\n>('DeliveryModeNormalizer');\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\nexport const ADDRESS_NORMALIZER = new InjectionToken<Converter<any, Address>>(\n  'AddressNormalizer'\n);\n\nexport const ADDRESS_SERIALIZER = new InjectionToken<Converter<Address, any>>(\n  'AddressSerializer'\n);\n\nexport const ADDRESS_VALIDATION_NORMALIZER = new InjectionToken<\n  Converter<any, AddressValidation>\n>('AddressValidationNormalizer');\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport { CheckoutDeliveryAdapter } from '../../../checkout/connectors/delivery/checkout-delivery.adapter';\nimport { DELIVERY_MODE_NORMALIZER } from '../../../checkout/connectors/delivery/converters';\nimport { Address } from '../../../model/address.model';\nimport { DeliveryMode } from '../../../model/order.model';\nimport {\n  ADDRESS_NORMALIZER,\n  ADDRESS_SERIALIZER,\n} from '../../../user/connectors/address/converters';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCheckoutDeliveryAdapter implements CheckoutDeliveryAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = 'users/' + userId + '/carts/';\n    return this.occEndpoints.getEndpoint(cartEndpoint);\n  }\n\n  public createAddress(\n    userId: string,\n    cartId: string,\n    address: Address\n  ): Observable<Address> {\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .post<Occ.Address>(\n        this.getCartEndpoint(userId) + cartId + '/addresses/delivery',\n        address,\n        {\n          headers: new HttpHeaders().set('Content-Type', 'application/json'),\n        }\n      )\n      .pipe(this.converter.pipeable(ADDRESS_NORMALIZER));\n  }\n\n  public setAddress(\n    userId: string,\n    cartId: string,\n    addressId: string\n  ): Observable<any> {\n    return this.http.put(\n      this.getCartEndpoint(userId) + cartId + '/addresses/delivery',\n      {},\n      {\n        params: { addressId: addressId },\n      }\n    );\n  }\n\n  public setMode(\n    userId: string,\n    cartId: string,\n    deliveryModeId: string\n  ): Observable<any> {\n    return this.http.put(\n      this.getCartEndpoint(userId) + cartId + '/deliverymode',\n      {},\n      {\n        params: { deliveryModeId: deliveryModeId },\n      }\n    );\n  }\n\n  public getMode(userId: string, cartId: string): Observable<any> {\n    return this.http\n      .get(this.getCartEndpoint(userId) + cartId + '/deliverymode')\n      .pipe(this.converter.pipeable(DELIVERY_MODE_NORMALIZER));\n  }\n\n  public getSupportedModes(\n    userId: string,\n    cartId: string\n  ): Observable<DeliveryMode[]> {\n    return this.http\n      .get<Occ.DeliveryModeList>(\n        this.getCartEndpoint(userId) + cartId + '/deliverymodes'\n      )\n      .pipe(\n        pluck('deliveryModes'),\n        this.converter.pipeableMany(DELIVERY_MODE_NORMALIZER)\n      );\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\n\nexport const PAYMENT_DETAILS_NORMALIZER = new InjectionToken<\n  Converter<any, PaymentDetails>\n>('PaymentDetailsNormalizer');\n\nexport const PAYMENT_DETAILS_SERIALIZER = new InjectionToken<\n  Converter<PaymentDetails, any>\n>('PaymentDetailsSerializer');\n\nexport const CARD_TYPE_NORMALIZER = new InjectionToken<\n  Converter<any, CardType>\n>('CardTypeNormalizer');\n","/**\n * Angular uses the native encodeURIComponent function,\n * but then un-encoded some characters that are allowed\n * to be part of the query according to IETF RFC 3986.\n * So, to make these characters still encoded, this encoder only\n * uses the encodeURIComponent.\n */\nimport { HttpParameterCodec } from '@angular/common/http';\n\nexport class CustomEncoder implements HttpParameterCodec {\n  encodeKey(key: string): string {\n    return encodeURIComponent(key);\n  }\n\n  encodeValue(value: string): string {\n    return encodeURIComponent(value);\n  }\n\n  decodeKey(key: string): string {\n    return decodeURIComponent(key);\n  }\n\n  decodeValue(value: string): string {\n    return decodeURIComponent(value);\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map, mergeMap } from 'rxjs/operators';\nimport { CheckoutPaymentAdapter } from '../../../checkout/connectors/payment/checkout-payment.adapter';\nimport {\n  CARD_TYPE_NORMALIZER,\n  PAYMENT_DETAILS_NORMALIZER,\n  PAYMENT_DETAILS_SERIALIZER,\n} from '../../../checkout/connectors/payment/converters';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { CustomEncoder } from '../cart/custom.encoder';\n\nconst ENDPOINT_CARD_TYPES = 'cardtypes';\n\n@Injectable()\nexport class OccCheckoutPaymentAdapter implements CheckoutPaymentAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {\n    if (typeof DOMParser !== 'undefined') {\n      this.domparser = new DOMParser();\n    }\n  }\n\n  private domparser: DOMParser;\n\n  protected getCartEndpoint(userId: string): string {\n    const cartEndpoint = 'users/' + userId + '/carts/';\n    return this.occEndpoints.getEndpoint(cartEndpoint);\n  }\n\n  public create(\n    userId: string,\n    cartId: string,\n    paymentDetails: PaymentDetails\n  ): Observable<PaymentDetails> {\n    paymentDetails = this.converter.convert(\n      paymentDetails,\n      PAYMENT_DETAILS_SERIALIZER\n    );\n    return this.getProviderSubInfo(userId, cartId).pipe(\n      map(data => {\n        const labelsMap = this.convertToMap(data.mappingLabels.entry);\n        return {\n          url: data.postUrl,\n          parameters: this.getParamsForPaymentProvider(\n            paymentDetails,\n            data.parameters.entry,\n            labelsMap\n          ),\n          mappingLabels: labelsMap,\n        };\n      }),\n      mergeMap(sub => {\n        // create a subscription directly with payment provider\n        return this.createSubWithProvider(sub.url, sub.parameters).pipe(\n          map(response => this.extractPaymentDetailsFromHtml(response)),\n          mergeMap(fromPaymentProvider => {\n            fromPaymentProvider['defaultPayment'] =\n              paymentDetails.defaultPayment;\n            fromPaymentProvider['savePaymentInfo'] = true;\n            return this.createDetailsWithParameters(\n              userId,\n              cartId,\n              fromPaymentProvider\n            ).pipe(this.converter.pipeable(PAYMENT_DETAILS_NORMALIZER));\n          })\n        );\n      })\n    );\n  }\n\n  public set(\n    userId: string,\n    cartId: string,\n    paymentDetailsId: string\n  ): Observable<any> {\n    return this.http.put(\n      this.getCartEndpoint(userId) + cartId + '/paymentdetails',\n      {},\n      {\n        params: { paymentDetailsId: paymentDetailsId },\n      }\n    );\n  }\n\n  loadCardTypes(): Observable<CardType[]> {\n    return this.http\n      .get<Occ.CardTypeList>(this.occEndpoints.getEndpoint(ENDPOINT_CARD_TYPES))\n      .pipe(\n        map(cardTypeList => cardTypeList.cardTypes),\n        this.converter.pipeableMany(CARD_TYPE_NORMALIZER)\n      );\n  }\n\n  protected getProviderSubInfo(\n    userId: string,\n    cartId: string\n  ): Observable<any> {\n    return this.http.get(\n      this.getCartEndpoint(userId) +\n        cartId +\n        '/payment/sop/request?responseUrl=sampleUrl'\n    );\n  }\n\n  protected createSubWithProvider(\n    postUrl: string,\n    parameters: any\n  ): Observable<any> {\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n      Accept: 'text/html',\n    });\n    let httpParams = new HttpParams({ encoder: new CustomEncoder() });\n    Object.keys(parameters).forEach(key => {\n      httpParams = httpParams.append(key, parameters[key]);\n    });\n\n    return this.http.post(postUrl, httpParams, {\n      headers,\n      responseType: 'text',\n    });\n  }\n\n  protected createDetailsWithParameters(\n    userId: string,\n    cartId: string,\n    parameters: any\n  ): Observable<PaymentDetails> {\n    let httpParams = new HttpParams({ encoder: new CustomEncoder() });\n    Object.keys(parameters).forEach(key => {\n      httpParams = httpParams.append(key, parameters[key]);\n    });\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http.post<PaymentDetails>(\n      this.getCartEndpoint(userId) + cartId + '/payment/sop/response',\n      httpParams,\n      { headers }\n    );\n  }\n\n  private getParamsForPaymentProvider(\n    paymentDetails: PaymentDetails,\n    parameters: { key; value }[],\n    mappingLabels: any\n  ) {\n    const params = this.convertToMap(parameters);\n    params[mappingLabels['hybris_account_holder_name']] =\n      paymentDetails.accountHolderName;\n    params[mappingLabels['hybris_card_type']] = paymentDetails.cardType.code;\n    params[mappingLabels['hybris_card_number']] = paymentDetails.cardNumber;\n    if (mappingLabels['hybris_combined_expiry_date'] === 'true') {\n      params[mappingLabels['hybris_card_expiry_date']] =\n        paymentDetails.expiryMonth +\n        mappingLabels['hybris_separator_expiry_date'] +\n        paymentDetails.expiryYear;\n    } else {\n      params[mappingLabels['hybris_card_expiration_month']] =\n        paymentDetails.expiryMonth;\n      params[mappingLabels['hybris_card_expiration_year']] =\n        paymentDetails.expiryYear;\n    }\n    params[mappingLabels['hybris_card_cvn']] = paymentDetails.cvn;\n\n    // billing address\n    params[mappingLabels['hybris_billTo_country']] =\n      paymentDetails.billingAddress.country.isocode;\n    params[mappingLabels['hybris_billTo_firstname']] =\n      paymentDetails.billingAddress.firstName;\n    params[mappingLabels['hybris_billTo_lastname']] =\n      paymentDetails.billingAddress.lastName;\n    params[mappingLabels['hybris_billTo_street1']] =\n      paymentDetails.billingAddress.line1 +\n      ' ' +\n      paymentDetails.billingAddress.line2;\n    params[mappingLabels['hybris_billTo_city']] =\n      paymentDetails.billingAddress.town;\n    if (paymentDetails.billingAddress.region) {\n      params[mappingLabels['hybris_billTo_region']] =\n        paymentDetails.billingAddress.region.isocodeShort;\n    } else {\n      params[mappingLabels['hybris_billTo_region']] = '';\n    }\n    params[mappingLabels['hybris_billTo_postalcode']] =\n      paymentDetails.billingAddress.postalCode;\n    return params;\n  }\n\n  private extractPaymentDetailsFromHtml(html: string): any {\n    const domdoc = this.domparser.parseFromString(html, 'text/xml');\n    const responseForm = domdoc.getElementsByTagName('form')[0];\n    const inputs = responseForm.getElementsByTagName('input');\n\n    const values = {};\n    for (let i = 0; inputs[i]; i++) {\n      const input = inputs[i];\n      if (\n        input.getAttribute('name') !== '{}' &&\n        input.getAttribute('value') !== ''\n      ) {\n        values[input.getAttribute('name')] = input.getAttribute('value');\n      }\n    }\n\n    return values;\n  }\n\n  private convertToMap(paramList: { key; value }[]) {\n    return paramList.reduce(function(result, item) {\n      const key = item.key;\n      result[key] = item.value;\n      return result;\n    }, {});\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Order } from '../../../model/order.model';\nimport { CheckoutDetails } from '../../models/checkout.model';\n\nexport abstract class CheckoutAdapter {\n  /**\n   * Abstract method used to place an order.\n   *\n   * @param userId The `userId` for given user\n   * @param cartId The `cartId` for cart used for placing order\n   */\n  abstract placeOrder(userId: string, cartId: string): Observable<Order>;\n\n  /**\n   * Abstract method used to load checkout details\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract loadCheckoutDetails(\n    userId: string,\n    cartId: string\n  ): Observable<CheckoutDetails>;\n\n  /**\n   * Abstract method used to clear checkout delivery address\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract clearCheckoutDeliveryAddress(\n    userId: string,\n    cartId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to clear checkout delivery mode\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract clearCheckoutDeliveryMode(\n    userId: string,\n    cartId: string\n  ): Observable<any>;\n}\n","import { Injectable } from '@angular/core';\nimport { Occ } from '../../../occ-models/occ.models';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Order, OrderEntry } from '../../../../model/order.model';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\n\n@Injectable({ providedIn: 'root' })\nexport class OccOrderNormalizer implements Converter<Occ.Order, Order> {\n  constructor(private converter: ConverterService) {}\n\n  convert(source: Occ.Order, target?: Order): Order {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source.entries) {\n      target.entries = source.entries.map(entry =>\n        this.convertOrderEntry(entry)\n      );\n    }\n\n    if (source.consignments) {\n      target.consignments = source.consignments.map(consignment => ({\n        ...consignment,\n        entries: consignment.entries.map(entry => ({\n          ...entry,\n          orderEntry: this.convertOrderEntry(entry.orderEntry),\n        })),\n      }));\n    }\n\n    if (source.unconsignedEntries) {\n      target.unconsignedEntries = source.unconsignedEntries.map(entry =>\n        this.convertOrderEntry(entry)\n      );\n    }\n\n    return target;\n  }\n\n  private convertOrderEntry(source: Occ.OrderEntry): OrderEntry {\n    return {\n      ...source,\n      product: this.converter.convert(source.product, PRODUCT_NORMALIZER),\n    };\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Address } from '../../../model/address.model';\nimport { DeliveryMode } from '../../../model/order.model';\n\nexport abstract class CheckoutDeliveryAdapter {\n  /**\n   * Abstract method used to create address in cart\n   *\n   * @param userId\n   * @param cartId\n   * @param address\n   */\n  abstract createAddress(\n    userId: string,\n    cartId: string,\n    address: Address\n  ): Observable<Address>;\n\n  /**\n   * Abstract method used to set adress for delivery\n   *\n   * @param userId\n   * @param cartId\n   * @param addressId\n   */\n  abstract setAddress(\n    userId: string,\n    cartId: string,\n    addressId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to set delivery mode on cart\n   *\n   * @param userId\n   * @param cartId\n   * @param deliveryModeId\n   */\n  abstract setMode(\n    userId: string,\n    cartId: string,\n    deliveryModeId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to get current delivery mode from cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract getMode(userId: string, cartId: string): Observable<DeliveryMode>;\n\n  /**\n   * Abstract method used to get supported delivery modes for cart\n   *\n   * @param userId\n   * @param cartId\n   */\n  abstract getSupportedModes(\n    userId: string,\n    cartId: string\n  ): Observable<DeliveryMode[]>;\n}\n","import { Observable } from 'rxjs';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\n\nexport abstract class CheckoutPaymentAdapter {\n  /**\n   * Abstract method used to create payment details on cart\n   *\n   * @param userId\n   * @param cartId\n   * @param paymentDetails\n   */\n  abstract create(\n    userId: string,\n    cartId: string,\n    paymentDetails: PaymentDetails\n  ): Observable<PaymentDetails>;\n\n  /**\n   * Abstract method used to set payment details on cart\n   *\n   * @param userId\n   * @param cartId\n   * @param paymentDetailsId\n   */\n  abstract set(\n    userId: string,\n    cartId: string,\n    paymentDetailsId: string\n  ): Observable<any>;\n\n  /**\n   * Abstract method used to get available cart types\n   */\n  abstract loadCardTypes(): Observable<CardType[]>;\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { CheckoutAdapter } from '../../../checkout/connectors/checkout/checkout.adapter';\nimport { OccCheckoutAdapter } from './occ-checkout.adapter';\nimport { OccOrderNormalizer } from './converters/occ-order-normalizer';\nimport { ORDER_NORMALIZER } from '../../../checkout/connectors/checkout/converters';\nimport { CheckoutDeliveryAdapter } from '../../../checkout/connectors/delivery/checkout-delivery.adapter';\nimport { OccCheckoutDeliveryAdapter } from './occ-checkout-delivery.adapter';\nimport { CheckoutPaymentAdapter } from '../../../checkout/connectors/payment/checkout-payment.adapter';\nimport { OccCheckoutPaymentAdapter } from './occ-checkout-payment.adapter';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    {\n      provide: CheckoutAdapter,\n      useClass: OccCheckoutAdapter,\n    },\n    { provide: ORDER_NORMALIZER, useExisting: OccOrderNormalizer, multi: true },\n    {\n      provide: CheckoutDeliveryAdapter,\n      useClass: OccCheckoutDeliveryAdapter,\n    },\n    {\n      provide: CheckoutPaymentAdapter,\n      useClass: OccCheckoutPaymentAdapter,\n    },\n  ],\n})\nexport class CheckoutOccModule {}\n","import { InjectionToken } from '@angular/core';\nimport { CmsStructureModel } from '../../model/page.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const CMS_PAGE_NORMALIZER = new InjectionToken<\n  Converter<any, CmsStructureModel>\n>('CmsPageNormalizer');\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CmsPageAdapter } from '../../../cms/connectors/page/cms-page.adapter';\nimport { CMS_PAGE_NORMALIZER } from '../../../cms/connectors/page/converters';\nimport { CmsStructureModel } from '../../../cms/model/page.model';\nimport { PageType } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCmsPageAdapter implements CmsPageAdapter {\n  protected headers = new HttpHeaders().set('Content-Type', 'application/json');\n\n  constructor(\n    private http: HttpClient,\n    private occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(\n    pageContext: PageContext,\n    fields?: string\n  ): Observable<CmsStructureModel> {\n    // load page by Id\n    if (pageContext.type === undefined) {\n      return this.http\n        .get(\n          this.occEndpoints.getUrl(\n            'page',\n            {\n              id: pageContext.id,\n            },\n            { fields: fields ? fields : 'DEFAULT' }\n          ),\n          {\n            headers: this.headers,\n          }\n        )\n        .pipe(this.converter.pipeable(CMS_PAGE_NORMALIZER));\n    }\n\n    // load page by PageContext\n    const httpParams = this.getPagesRequestParams(pageContext);\n    return this.http\n      .get(this.getPagesEndpoint(httpParams, fields), {\n        headers: this.headers,\n      })\n      .pipe(this.converter.pipeable(CMS_PAGE_NORMALIZER));\n  }\n\n  private getPagesEndpoint(\n    params: {\n      [key: string]: string;\n    },\n    fields?: string\n  ): string {\n    fields = fields ? fields : 'DEFAULT';\n    return this.occEndpoints.getUrl('pages', {}, { fields, ...params });\n  }\n\n  private getPagesRequestParams(\n    pageContext: PageContext\n  ): { [key: string]: any } {\n    let httpParams = {};\n\n    // smartedit preview page is loaded by previewToken which added by interceptor\n    if (pageContext.id !== 'smartedit-preview') {\n      httpParams = { pageType: pageContext.type };\n\n      if (pageContext.type === PageType.CONTENT_PAGE) {\n        httpParams['pageLabelOrId'] = pageContext.id;\n      } else {\n        httpParams['code'] = pageContext.id;\n      }\n    }\n    return httpParams;\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const CMS_COMPONENT_NORMALIZER = new InjectionToken<\n  Converter<any, CmsComponent>\n>('CmsComponentNormalizer');\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport { CmsComponentAdapter } from '../../../cms/connectors/component/cms-component.adapter';\nimport { CMS_COMPONENT_NORMALIZER } from '../../../cms/connectors/component/converters';\nimport { CmsComponent, PageType } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccCmsComponentAdapter implements CmsComponentAdapter {\n  protected headers = new HttpHeaders().set('Content-Type', 'application/json');\n\n  constructor(\n    private http: HttpClient,\n    private occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load<T extends CmsComponent>(\n    id: string,\n    pageContext: PageContext\n  ): Observable<T> {\n    return this.http\n      .get<T>(this.getComponentEndPoint(id, pageContext), {\n        headers: this.headers,\n      })\n      .pipe(this.converter.pipeable<any, T>(CMS_COMPONENT_NORMALIZER));\n  }\n\n  findComponentsByIds(\n    ids: string[],\n    pageContext: PageContext,\n    fields = 'DEFAULT',\n    currentPage = 0,\n    pageSize = ids.length,\n    sort?: string\n  ): Observable<CmsComponent[]> {\n    const requestParams = {\n      ...this.getContextParams(pageContext),\n      ...this.getPaginationParams(currentPage, pageSize, sort),\n    };\n\n    requestParams['componentIds'] = ids.toString();\n\n    return this.http\n      .get<Occ.ComponentList>(\n        this.getComponentsEndpoint(requestParams, fields),\n        {\n          headers: this.headers,\n        }\n      )\n      .pipe(\n        pluck('component'),\n        this.converter.pipeableMany(CMS_COMPONENT_NORMALIZER)\n      );\n  }\n\n  findComponentsByIdsLegacy(\n    ids: string[],\n    pageContext: PageContext,\n    fields = 'DEFAULT',\n    currentPage = 0,\n    pageSize = ids.length,\n    sort?: string\n  ): Observable<CmsComponent[]> {\n    const idList: Occ.ComponentIDList = { idList: ids };\n\n    const requestParams = {\n      ...this.getContextParams(pageContext),\n      ...this.getPaginationParams(currentPage, pageSize, sort),\n    };\n\n    return this.http\n      .post<Occ.ComponentList>(\n        this.getComponentsEndpoint(requestParams, fields),\n        idList,\n        {\n          headers: this.headers,\n        }\n      )\n      .pipe(\n        pluck('component'),\n        this.converter.pipeableMany(CMS_COMPONENT_NORMALIZER)\n      );\n  }\n\n  protected getComponentEndPoint(id: string, pageContext: PageContext): string {\n    return this.occEndpoints.getUrl(\n      'component',\n      { id },\n      this.getContextParams(pageContext)\n    );\n  }\n\n  protected getComponentsEndpoint(requestParams: any, fields: string): string {\n    return this.occEndpoints.getUrl(\n      'components',\n      {},\n      { fields, ...requestParams }\n    );\n  }\n\n  private getPaginationParams(\n    currentPage?: number,\n    pageSize?: number,\n    sort?: string\n  ): { [key: string]: string } {\n    const requestParams = {};\n    if (currentPage !== undefined) {\n      requestParams['currentPage'] = currentPage.toString();\n    }\n    if (pageSize !== undefined) {\n      requestParams['pageSize'] = pageSize.toString();\n    }\n    if (sort !== undefined) {\n      requestParams['sort'] = sort;\n    }\n\n    return requestParams;\n  }\n\n  private getContextParams(\n    pageContext: PageContext\n  ): { [key: string]: string } {\n    let requestParams = {};\n    switch (pageContext.type) {\n      case PageType.PRODUCT_PAGE: {\n        requestParams = { productCode: pageContext.id };\n        break;\n      }\n      case PageType.CATEGORY_PAGE: {\n        requestParams = { categoryCode: pageContext.id };\n        break;\n      }\n      case PageType.CATALOG_PAGE: {\n        requestParams = { catalogCode: pageContext.id };\n        break;\n      }\n    }\n\n    return requestParams;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  CMS_FLEX_COMPONENT_TYPE,\n  JSP_INCLUDE_CMS_COMPONENT_TYPE,\n} from '../../../../cms/config/cms-config';\nimport { ContentSlotComponentData } from '../../../../cms/model/content-slot-component-data.model';\nimport { ContentSlotData } from '../../../../cms/model/content-slot-data.model';\nimport { CmsStructureModel } from '../../../../cms/model/page.model';\nimport { Converter } from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccCmsPageNormalizer\n  implements Converter<Occ.CMSPage, CmsStructureModel> {\n  convert(\n    source: Occ.CMSPage,\n    target: CmsStructureModel = {}\n  ): CmsStructureModel {\n    this.normalizePageData(source, target);\n    this.normalizePageSlotData(source, target);\n    this.normalizePageComponentData(source, target);\n    this.normalizeComponentData(source, target);\n    return target;\n  }\n\n  private normalizePageData(source: any, target: CmsStructureModel): void {\n    target.page = {\n      loadTime: Date.now(),\n      name: source.name,\n      type: source.typeCode,\n      title: source.title,\n      pageId: source.uid,\n      template: source.template,\n      slots: {},\n      properties: source.properties,\n      label: source.label,\n    };\n  }\n\n  private normalizePageSlotData(source: any, target: CmsStructureModel): void {\n    for (const slot of source.contentSlots.contentSlot) {\n      target.page.slots[slot.position] = {\n        components: [],\n        properties: slot.properties,\n      } as ContentSlotData;\n    }\n  }\n\n  private normalizePageComponentData(\n    source: any,\n    target: CmsStructureModel\n  ): void {\n    for (const slot of source.contentSlots.contentSlot) {\n      if (\n        slot.components.component &&\n        Array.isArray(slot.components.component)\n      ) {\n        for (const component of slot.components.component) {\n          const comp: ContentSlotComponentData = {\n            uid: component.uid,\n            typeCode: component.typeCode,\n            properties: component.properties,\n          };\n\n          if (component.typeCode === CMS_FLEX_COMPONENT_TYPE) {\n            comp.flexType = component.flexType;\n          } else if (component.typeCode === JSP_INCLUDE_CMS_COMPONENT_TYPE) {\n            comp.flexType = component.uid;\n          } else {\n            comp.flexType = component.typeCode;\n          }\n          target.page.slots[slot.position].components.push(comp);\n        }\n      }\n    }\n  }\n\n  private normalizeComponentData(source: any, target: CmsStructureModel): void {\n    target.components = [];\n\n    for (const slot of source.contentSlots.contentSlot) {\n      if (\n        slot.components.component &&\n        Array.isArray(slot.components.component)\n      ) {\n        for (const component of slot.components.component as any) {\n          // we dont put properties into component state\n          if (component.properties) {\n            component.properties = undefined;\n          }\n          target.components.push(component);\n        }\n      }\n    }\n  }\n}\n","import { Observable } from 'rxjs';\nimport { PageContext } from '../../../routing/models/page-context.model';\nimport { CmsStructureModel } from '../../model/page.model';\n\n/**\n * Abstract class that can be used to implement custom loader logic\n * in order to load CMS structure from third-party CMS system.\n */\nexport abstract class CmsPageAdapter {\n  /**\n   * Abstract method must be used to load the page structure for a given `PageContext`.\n   * The page can be loaded from alternative sources, as long as the structure\n   * converts to the `CmsStructureModel`.\n   *\n   * @param pageContext The `PageContext` holding the page Id.\n   */\n  abstract load(pageContext: PageContext): Observable<CmsStructureModel>;\n}\n","import { Observable } from 'rxjs';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing/models/page-context.model';\n\nexport abstract class CmsComponentAdapter {\n  /**\n   * Abstract method must be used to load the component for a given `id` and `PageContext`.\n   * The component can be loaded from alternative backend, as long as the structure\n   * converts to the `CmsStructureModel`.\n   *\n   * @param pageContext The `PageContext` holding the page Id.\n   */\n  abstract load<T extends CmsComponent>(\n    id: string,\n    pageContext: PageContext,\n    fields?: string\n  ): Observable<T>;\n\n  abstract findComponentsByIds(\n    ids: string[],\n    pageContext: PageContext\n  ): Observable<CmsComponent[]>;\n\n  abstract findComponentsByIdsLegacy(\n    ids: string[],\n    pageContext: PageContext\n  ): Observable<CmsComponent[]>;\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { CmsPageAdapter } from '../../../cms/connectors/page/cms-page.adapter';\nimport { OccCmsComponentAdapter } from './occ-cms-component.adapter';\nimport { OccCmsPageNormalizer } from './converters/occ-cms-page-normalizer';\nimport { OccCmsPageAdapter } from './occ-cms-page.adapter';\nimport { CMS_PAGE_NORMALIZER } from '../../../cms/connectors/page/converters';\nimport { CmsComponentAdapter } from '../../../cms/connectors/component/cms-component.adapter';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    {\n      provide: CmsPageAdapter,\n      useClass: OccCmsPageAdapter,\n    },\n    {\n      provide: CMS_PAGE_NORMALIZER,\n      useExisting: OccCmsPageNormalizer,\n      multi: true,\n    },\n    {\n      provide: CmsComponentAdapter,\n      useClass: OccCmsComponentAdapter,\n    },\n  ],\n})\nexport class CmsOccModule {}\n","import { Injectable } from '@angular/core';\nimport { OccConfig } from '../../../config/occ-config';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { Converter } from '../../../../util/converter.service';\nimport { Product } from '../../../../model/product.model';\nimport { Images } from '../../../../model/image.model';\n\n@Injectable({ providedIn: 'root' })\nexport class ProductImageNormalizer implements Converter<Occ.Product, Product> {\n  constructor(protected config: OccConfig) {}\n\n  convert(source: Occ.Product, target?: Product): Product {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n    if (source.images) {\n      target.images = this.normalize(source.images);\n    }\n    return target;\n  }\n\n  /**\n   * @desc\n   * Creates the image structure we'd like to have. Instead of\n   * having a single list with all images despite type and format\n   * we create a proper structure. With that we can do:\n   * - images.primary.thumnail.url\n   * - images.GALLERY[0].thumnail.url\n   */\n  normalize(source: Occ.Image[]): Images {\n    const images = {};\n    if (source) {\n      for (const image of source) {\n        const isList = image.hasOwnProperty('galleryIndex');\n        if (!images.hasOwnProperty(image.imageType)) {\n          images[image.imageType] = isList ? [] : {};\n        }\n\n        let imageContainer;\n        if (isList && !images[image.imageType][image.galleryIndex]) {\n          images[image.imageType][image.galleryIndex] = {};\n        }\n\n        if (isList) {\n          imageContainer = images[image.imageType][image.galleryIndex];\n        } else {\n          imageContainer = images[image.imageType];\n        }\n\n        const targetImage = { ...image };\n        targetImage.url = this.normalizeImageUrl(targetImage.url);\n        imageContainer[image.format] = targetImage;\n      }\n    }\n    return images;\n  }\n  /**\n   * Traditionally, in an on-prem world, medias and other backend related calls\n   * are hosted at the same platform, but in a cloud setup, applications are are\n   * typically distributed cross different environments. For media, we use the\n   * `backend.media.baseUrl` by default, but fallback to `backend.occ.baseUrl`\n   * if none provided.\n   */\n  private normalizeImageUrl(url: string): string {\n    if (new RegExp(/^(http|data:image|\\/\\/)/i).test(url)) {\n      return url;\n    }\n    return (\n      (this.config.backend.media.baseUrl ||\n        this.config.backend.occ.baseUrl ||\n        '') + url\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { Converter } from '../../../../util/converter.service';\nimport { Product, ProductReferences } from '../../../../model/product.model';\n\n@Injectable()\nexport class ProductReferenceNormalizer\n  implements Converter<Occ.Product, Product> {\n  convert(source: Occ.Product, target?: Product): Product {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source.productReferences) {\n      target.productReferences = this.normalize(source.productReferences);\n    }\n    return target;\n  }\n\n  /**\n   * @desc\n   * Creates the reference structure we'd like to have. Instead of\n   * having a single list with all references we create a proper structure.\n   * With that we have a semantic API for the clients\n   * - product.references.SIMILAR[0].code\n   */\n  protected normalize(source: Occ.ProductReference[]): ProductReferences {\n    const references = {};\n\n    if (source) {\n      for (const reference of source) {\n        if (!references.hasOwnProperty(reference.referenceType)) {\n          references[reference.referenceType] = [];\n        }\n        references[reference.referenceType].push(reference);\n      }\n    }\n    return references;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  Facet,\n  ProductSearchPage,\n} from '../../../../model/product-search.model';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { Occ } from '../../../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccProductSearchPageNormalizer\n  implements Converter<Occ.ProductSearchPage, ProductSearchPage> {\n  constructor(private converterService: ConverterService) {}\n\n  /**\n   * Specifies the minimal number of top values in case\n   * non have been setup by the business.\n   */\n  protected DEFAULT_TOP_VALUES = 6;\n\n  convert(\n    source: Occ.ProductSearchPage,\n    target: ProductSearchPage = {}\n  ): ProductSearchPage {\n    target = {\n      ...target,\n      ...(source as any),\n    };\n\n    this.normalizeFacets(target);\n    if (source.products) {\n      target.products = source.products.map(product =>\n        this.converterService.convert(product, PRODUCT_NORMALIZER)\n      );\n    }\n    return target;\n  }\n\n  private normalizeFacets(target: ProductSearchPage): void {\n    this.normalizeFacetValues(target);\n    this.normalizeUselessFacets(target);\n  }\n  /**\n   * The (current) backend returns facets with values that do not contribute\n   * to the facet navigation much, as the number in the result list will not get\n   * behaviour, see https://jira.hybris.com/browse/CS-427.\n   *\n   * As long as this is not in place, we manually filter the facet from the list;\n   * any facet that does not have a count < the total results will be dropped from\n   * the facets.\n   */\n  private normalizeUselessFacets(target: ProductSearchPage): void {\n    target.facets = target.facets.filter(facet => {\n      return (\n        !target.pagination ||\n        !target.pagination.totalResults ||\n        ((!facet.hasOwnProperty('visible') || facet.visible) &&\n          facet.values &&\n          facet.values.find(value => {\n            return (\n              value.selected || value.count < target.pagination.totalResults\n            );\n          }))\n      );\n    });\n  }\n\n  /*\n   * In case there are so-called `topValues` given for the facet values,\n   * values are obsolete.\n   *\n   * `topValues` is a feature in Adaptive Search which can limit a large\n   * amount of facet values to a small set (5 by default). As long as the backend\n   * provides all facet values AND topValues, we normalize the data to not bother\n   * the UI with this specific feature.\n   */\n  private normalizeFacetValues(target: ProductSearchPage): void {\n    if (target.facets) {\n      target.facets = target.facets.map((facetSource: Facet) => {\n        const { topValues, ...facetTarget } = facetSource;\n        facetTarget.topValueCount = topValues\n          ? topValues.length\n          : this.DEFAULT_TOP_VALUES;\n        return facetTarget;\n      });\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ProductReference } from '../../../../model/product.model';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\n\n@Injectable({ providedIn: 'root' })\nexport class OccProductReferencesListNormalizer\n  implements Converter<Occ.ProductReferenceList, ProductReference[]> {\n  constructor(private converter: ConverterService) {}\n\n  convert(\n    source: Occ.ProductReferenceList,\n    target: ProductReference[] = []\n  ): ProductReference[] {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source && source.references) {\n      target = source.references.map(reference => ({\n        ...reference,\n        target: this.converter.convert(reference.target, PRODUCT_NORMALIZER),\n      }));\n\n      return target;\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { OccConfig } from '../../../config/occ-config';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { Converter } from '../../../../util/converter.service';\nimport { Product } from '../../../../model/product.model';\n\n@Injectable({ providedIn: 'root' })\nexport class ProductNameNormalizer implements Converter<Occ.Product, Product> {\n  constructor(protected config: OccConfig) {}\n\n  convert(source: Occ.Product, target?: Product): Product {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n    if (source.name) {\n      target.name = this.normalize(source.name);\n      target.nameHtml = source.name;\n    }\n    return target;\n  }\n\n  protected normalize(name: string): string {\n    return name.replace(/<[^>]*>/g, '');\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { ProductReference } from '../../../model/product.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const PRODUCT_REFERENCES_NORMALIZER = new InjectionToken<\n  Converter<any, ProductReference[]>\n>('ProductReferencesListNormalizer');\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ProductReference } from '../../../model/product.model';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport { PRODUCT_REFERENCES_NORMALIZER } from '../../../product/connectors/references/converters';\nimport { ProductReferencesAdapter } from '../../../product/connectors/references/product-references.adapter';\n\n@Injectable()\nexport class OccProductReferencesAdapter implements ProductReferencesAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]> {\n    return this.http\n      .get(this.getEndpoint(productCode, referenceType, pageSize))\n      .pipe(this.converter.pipeable(PRODUCT_REFERENCES_NORMALIZER));\n  }\n\n  protected getEndpoint(\n    code: string,\n    reference?: string,\n    pageSize?: number\n  ): string {\n    return this.occEndpoints.getUrl(\n      'productReferences',\n      {\n        productCode: code,\n      },\n      { referenceType: reference, pageSize }\n    );\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Review } from '../../../model/product.model';\n\nexport const PRODUCT_REVIEW_NORMALIZER = new InjectionToken<\n  Converter<any, Review>\n>('ProductReviewNormalizer');\n\nexport const PRODUCT_REVIEW_SERIALIZER = new InjectionToken<\n  Converter<Review, any>\n>('ProductReviewSerializer');\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport { Review } from '../../../model/product.model';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport {\n  PRODUCT_REVIEW_NORMALIZER,\n  PRODUCT_REVIEW_SERIALIZER,\n} from '../../../product/connectors/reviews/converters';\nimport { ProductReviewsAdapter } from '../../../product/connectors/reviews/product-reviews.adapter';\n\n@Injectable()\nexport class OccProductReviewsAdapter implements ProductReviewsAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(productCode: string, maxCount?: number): Observable<Review[]> {\n    return this.http\n      .get(this.getEndpoint(productCode, maxCount))\n      .pipe(\n        pluck('reviews'),\n        this.converter.pipeableMany(PRODUCT_REVIEW_NORMALIZER)\n      );\n  }\n\n  post(productCode: string, review: any): Observable<Review> {\n    review = this.converter.convert(review, PRODUCT_REVIEW_SERIALIZER);\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    const body = new URLSearchParams();\n    body.append('headline', review.headline);\n    body.append('comment', review.comment);\n    body.append('rating', review.rating.toString());\n    body.append('alias', review.alias);\n\n    return this.http.post(this.getEndpoint(productCode), body.toString(), {\n      headers,\n    });\n  }\n\n  protected getEndpoint(code: string, maxCount?: number): string {\n    return this.occEndpoints.getUrl(\n      'productReviews',\n      {\n        productCode: code,\n      },\n      { maxCount }\n    );\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport {\n  Suggestion,\n  ProductSearchPage,\n} from '../../../model/product-search.model';\n\nexport const PRODUCT_SEARCH_PAGE_NORMALIZER = new InjectionToken<\n  Converter<any, ProductSearchPage>\n>('ProductSearchPageNormalizer');\n\nexport const PRODUCT_SUGGESTION_NORMALIZER = new InjectionToken<\n  Converter<any, Suggestion>\n>('ProductSuggestionNormalizer');\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\nimport {\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport {\n  PRODUCT_SEARCH_PAGE_NORMALIZER,\n  PRODUCT_SUGGESTION_NORMALIZER,\n} from '../../../product/connectors/search/converters';\nimport { ProductSearchAdapter } from '../../../product/connectors/search/product-search.adapter';\nimport { SearchConfig } from '../../../product/model/search-config';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\nconst DEFAULT_SEARCH_CONFIG: SearchConfig = {\n  pageSize: 20,\n};\n\n@Injectable()\nexport class OccProductSearchAdapter implements ProductSearchAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  search(\n    query: string,\n    searchConfig: SearchConfig = DEFAULT_SEARCH_CONFIG\n  ): Observable<ProductSearchPage> {\n    return this.http\n      .get(this.getSearchEndpoint(query, searchConfig))\n      .pipe(this.converter.pipeable(PRODUCT_SEARCH_PAGE_NORMALIZER));\n  }\n\n  loadSuggestions(\n    term: string,\n    pageSize: number = 3\n  ): Observable<Suggestion[]> {\n    return this.http\n      .get(this.getSuggestionEndpoint(term, pageSize.toString()))\n      .pipe(\n        pluck('suggestions'),\n        this.converter.pipeableMany(PRODUCT_SUGGESTION_NORMALIZER)\n      );\n  }\n\n  protected getSearchEndpoint(\n    query: string,\n    searchConfig: SearchConfig\n  ): string {\n    return this.occEndpoints.getUrl(\n      'productSearch',\n      {},\n      {\n        query,\n        pageSize: searchConfig.pageSize,\n        currentPage: searchConfig.currentPage,\n        sort: searchConfig.sortCode,\n      }\n    );\n  }\n\n  protected getSuggestionEndpoint(term: string, max: string): string {\n    return this.occEndpoints.getUrl('productSuggestions', {}, { term, max });\n  }\n}\n","import { deepMerge, isObject } from '../../config/utils/deep-merge';\n\n/**\n * Merge occ fields parameters\n *\n * @param fields Fields definition as string or object\n */\nexport function mergeFields(fields: (string | object)[]): string {\n  const parsedFields = fields.map(f =>\n    typeof f === 'string' ? parseFields(f) : f\n  );\n  const mergedFields = optimizeFields(deepMerge({}, ...parsedFields));\n  return stringifyFields(mergedFields);\n}\n\n/**\n * Optimize fields definition by removing not needed groups\n *\n * @param fields\n */\nexport function optimizeFields(fields: object = {}): object {\n  const keys = Object.keys(fields);\n  if (keys.includes('FULL')) {\n    delete fields['DEFAULT'];\n    delete fields['BASIC'];\n  } else if (keys.includes('DEFAULT')) {\n    delete fields['BASIC'];\n  }\n  Object.keys(fields).forEach(key => {\n    fields[key] = optimizeFields(fields[key]);\n  });\n  return fields;\n}\n\n/**\n * Parse string field definition to an AST object\n *\n * @param fields Fields string definition\n * @param startIndex Used for recurrence\n */\nexport function parseFields(\n  fields: string,\n  startIndex = 0\n): [object, number] | object {\n  const parsedFields = {};\n\n  let i = startIndex;\n  while (i < fields.length) {\n    if (fields[i] === ',') {\n      if (i > startIndex) {\n        parsedFields[fields.substr(startIndex, i - startIndex)] = {};\n      }\n      startIndex = i + 1;\n    } else if (fields[i] === '(') {\n      const subFields = parseFields(fields, i + 1);\n      if (Array.isArray(subFields)) {\n        parsedFields[fields.substr(startIndex, i - startIndex)] = subFields[0];\n        startIndex = subFields[1];\n        i = startIndex - 1;\n      } else {\n        return parsedFields;\n      }\n    } else if (fields[i] === ')') {\n      if (i > startIndex) {\n        parsedFields[fields.substr(startIndex, i - startIndex)] = {};\n      }\n      return [parsedFields, i + 1];\n    }\n    i++;\n  }\n\n  if (startIndex < fields.length) {\n    parsedFields[fields.substr(startIndex, i - startIndex)] = {};\n  }\n\n  return parsedFields;\n}\n\n/**\n * Convert AST object fields definition to string representation\n *\n * @param fields\n */\nexport function stringifyFields(fields: object): string {\n  return Object.keys(fields)\n    .map(key => {\n      const subFields = stringifyFields(fields[key]);\n      return subFields ? `${key}(${subFields})` : key;\n    })\n    .join(',');\n}\n\n/**\n * Extract part of the object described by fields definition\n *\n * @param data\n * @param fields\n */\nexport function extractFields<T>(data: T, fields: string | object): T {\n  const parsedFields =\n    typeof fields === 'string' ? parseFields(fields) : fields;\n  return getObjectPart<T>(data, parsedFields);\n}\n\nfunction getObjectPart<T>(data: T, fields: object): T {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  const keys = Object.keys(fields);\n\n  if (\n    keys.length === 0 ||\n    // we should not extract parts of the object with ambiguous fields definitions\n    keys.find(el => el === 'BASIC' || el === 'DEFAULT' || el === 'FULL')\n  ) {\n    return data;\n  }\n\n  const result = {} as T;\n\n  keys.forEach(key => {\n    if (data.hasOwnProperty(key)) {\n      result[key] = getObjectPart(data[key], fields[key]);\n    }\n  });\n\n  return result;\n}\n","import { Injectable } from '@angular/core';\nimport { mergeFields, parseFields } from '../utils/occ-fields';\nimport { ScopedData } from '../../model/scoped-data';\nimport { HttpClient } from '@angular/common/http';\n\nexport interface ScopedDataWithUrl {\n  /** Url (with fields) to load scoped data */\n  url?: string;\n  /** scoped data model */\n  scopedData: ScopedData<any>;\n}\n\n/**\n * Intermediate model to accommodate all data needed to perform occ fields optimizations\n * wrapping ScopedData with url and fields\n */\nexport interface OccFieldsModel extends ScopedDataWithUrl {\n  /** extracted fields object, used to extract data from broader model */\n  fields?: object;\n}\n\n/**\n * Grouped rest calls with optimal urls\n *\n * One url groups all scopes it covers with related occFieldsModels\n */\nexport interface OccOptimimalUrlGroups {\n  [optimalUrl: string]: {\n    [scope: string]: OccFieldsModel;\n  };\n}\n\n/**\n * Helper service for optimizing endpoint calls to occ backend\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccFieldsService {\n  constructor(protected http: HttpClient) {}\n\n  protected FIELDS_PARAM = 'fields';\n\n  /**\n   * Merge similar occ endpoints calls by merging fields parameter\n   *\n   * We assume that different scopes are defined by different fields parameters,\n   * so we are grouping all requests with the same urls (except fields definition)\n   * and merging into one request with fields that will satisfy all separate ones.\n   *\n   * @param models\n   */\n  getOptimalUrlGroups(models: ScopedDataWithUrl[]): OccOptimimalUrlGroups {\n    const groupedByUrls: OccOptimimalUrlGroups = {};\n    for (const model of models as OccFieldsModel[]) {\n      const [urlPart, fields] = this.splitFields(model.url);\n      if (!groupedByUrls[urlPart]) {\n        groupedByUrls[urlPart] = {};\n      }\n      model.fields = fields ? parseFields(fields) : {};\n      groupedByUrls[urlPart][model.scopedData.scope] = model;\n    }\n\n    const mergedUrls: OccOptimimalUrlGroups = {};\n    for (const [url, group] of Object.entries(groupedByUrls)) {\n      const urlWithFields = this.getUrlWithFields(\n        url,\n        Object.values(group).map(lo => lo.fields)\n      );\n      mergedUrls[urlWithFields] = group;\n    }\n\n    return mergedUrls;\n  }\n\n  /**\n   * Extract fields parameter from occ endpoint url\n   *\n   * @param urlWithFields\n   */\n  private splitFields(urlWithFields: string): [string, string] {\n    const [url, params] = urlWithFields.split('?');\n\n    const paramsMap = {};\n\n    if (params) {\n      params.split('&').map(param => {\n        const keyValue = param.split('=');\n        paramsMap[keyValue[0]] = keyValue[1];\n      });\n    }\n\n    const nonFieldsParams = Object.keys(paramsMap)\n      .sort()\n      .reduce((id, par) => {\n        if (par !== this.FIELDS_PARAM) {\n          id.push(paramsMap[par] ? `${par}=${paramsMap[par]}` : par);\n        }\n        return id;\n      }, []);\n\n    const nonFields = nonFieldsParams.join('&');\n\n    return [\n      nonFields ? `${url}?${nonFields}` : url,\n      paramsMap[this.FIELDS_PARAM],\n    ];\n  }\n\n  /**\n   * Combine url with field parameters\n   *\n   * @param url\n   * @param fields\n   */\n  private getUrlWithFields(url: string, fields: (string | object)[]): string {\n    const mergedFields = mergeFields(fields);\n\n    if (mergedFields) {\n      url += url.includes('?') ? '&' : '?';\n      url += `${this.FIELDS_PARAM}=${mergedFields}`;\n    }\n\n    return url;\n  }\n}\n","export enum ProductScope {\n  LIST = 'list',\n  DETAILS = 'details',\n  ATTRIBUTES = 'attributes',\n  VARIANTS = 'variants',\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ScopedData } from '../../model/scoped-data';\nimport { map, shareReplay } from 'rxjs/operators';\nimport { extractFields } from '../utils/occ-fields';\nimport {\n  OccFieldsModel,\n  OccFieldsService,\n  ScopedDataWithUrl,\n} from './occ-fields.service';\nimport { HttpClient } from '@angular/common/http';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OccRequestsOptimizerService {\n  constructor(\n    protected http: HttpClient,\n    protected occFields: OccFieldsService\n  ) {}\n\n  /**\n   * Optimize occ endpoint calls merging requests to the same url by merging field parameters\n   *\n   * @param scopedDataWithUrls\n   * @param dataFactory\n   */\n  scopedDataLoad<T>(\n    scopedDataWithUrls: ScopedDataWithUrl[],\n    dataFactory?: (url: string) => Observable<T>\n  ): ScopedData<T>[] {\n    const result = [];\n\n    if (!dataFactory) {\n      dataFactory = url => this.http.get<any>(url);\n    }\n\n    const mergedUrls = this.occFields.getOptimalUrlGroups(scopedDataWithUrls);\n\n    Object.entries(mergedUrls).forEach(\n      ([url, groupedModelsSet]: [\n        string,\n        {\n          [scope: string]: OccFieldsModel;\n        }\n      ]) => {\n        const groupedModels = Object.values(groupedModelsSet);\n\n        if (groupedModels.length === 1) {\n          // only one scope for url, we can pass the data straightaway\n          result.push({\n            ...groupedModels[0].scopedData,\n            data$: dataFactory(url),\n          });\n        } else {\n          // multiple scopes per url\n          // we have to split the model per each scope\n          const data$ = dataFactory(url).pipe(\n            shareReplay(1),\n            // TODO deprecated since 1.4, remove\n            map(data => JSON.parse(JSON.stringify(data)))\n          );\n\n          groupedModels.forEach(modelData => {\n            result.push({\n              ...modelData.scopedData,\n              data$: data$.pipe(\n                map(data => extractFields<T>(data, modelData.fields))\n              ),\n            });\n          });\n        }\n      }\n    );\n\n    return result;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ProductAdapter } from '../../../product/connectors/product/product.adapter';\nimport { Observable } from 'rxjs';\nimport { HttpClient } from '@angular/common/http';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { ConverterService } from '../../../util/converter.service';\nimport { PRODUCT_NORMALIZER } from '../../../product/connectors/product/converters';\nimport { Product } from '../../../model/product.model';\nimport { ScopedProductData } from '../../../product/connectors/product/scoped-product-data';\nimport { ScopedDataWithUrl } from '../../services/occ-fields.service';\nimport { Occ } from '../../occ-models';\nimport { OccRequestsOptimizerService } from '../../services/occ-requests-optimizer.service';\n\n@Injectable()\nexport class OccProductAdapter implements ProductAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService,\n    protected requestsOptimizer: OccRequestsOptimizerService\n  ) {}\n\n  load(productCode: string, scope?: string): Observable<Product> {\n    return this.http\n      .get(this.getEndpoint(productCode, scope))\n      .pipe(this.converter.pipeable(PRODUCT_NORMALIZER));\n  }\n\n  loadMany(products: ScopedProductData[]): ScopedProductData[] {\n    const scopedDataWithUrls: ScopedDataWithUrl[] = products.map(model => ({\n      scopedData: model,\n      url: this.getEndpoint(model.code, model.scope),\n    }));\n\n    return this.requestsOptimizer\n      .scopedDataLoad<Occ.Product>(scopedDataWithUrls)\n      .map(\n        scopedProduct =>\n          ({\n            ...scopedProduct,\n            data$: scopedProduct.data$.pipe(\n              this.converter.pipeable(PRODUCT_NORMALIZER)\n            ),\n          } as ScopedProductData)\n      );\n  }\n\n  protected getEndpoint(code: string, scope?: string): string {\n    return this.occEndpoints.getUrl(\n      'product',\n      {\n        productCode: code,\n      },\n      undefined,\n      scope\n    );\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Product } from '../../../model/product.model';\nimport { ScopedProductData } from './scoped-product-data';\n\nexport abstract class ProductAdapter {\n  /**\n   * Abstract method used to load product's details data.\n   * Product's data can be loaded from alternative sources, as long as the structure\n   * converts to the `Product`.\n   *\n   * @param productCode The `productCode` for given product\n   * @param scope The product scope to load\n   */\n  abstract load(productCode: string, scope?: string): Observable<Product>;\n\n  /**\n   * Abstract method used to load data for multiple product and scopes\n   * Adapter is able to optimize necessary backend calls and load\n   * products in the most efficient way possible.\n   *\n   * @param products\n   */\n  abstract loadMany?(products: ScopedProductData[]): ScopedProductData[];\n}\n","import { Observable } from 'rxjs';\nimport { ProductReference } from '../../../model/product.model';\n\nexport abstract class ProductReferencesAdapter {\n  /**\n   * Abstract method used to load product references for a given product.\n   * References can be loaded from alternative sources, as long as the structure\n   * converts to the `ProductReference[]`.\n   *\n   * @param productCode The `productCode` for given product\n   * @param referenceType Reference type according to enum ProductReferenceTypeEnum\n   * @param pageSize Maximum number of product refrence to load\n   */\n  abstract load(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]>;\n}\n","import { Observable } from 'rxjs';\nimport { Review } from '../../../model/product.model';\n\nexport abstract class ProductReviewsAdapter {\n  /**\n   * Abstract method used to load reviews for a given product.\n   * Reviews can be loaded from alternative sources, as long as the structure\n   * converts to the `Review[]`.\n   *\n   * @param productCode The `productCode` for given product\n   * @param maxCount Maximum number of review to load\n   */\n  abstract load(productCode: string, maxCount?: number): Observable<Review[]>;\n\n  /**\n   * Abstract method used to post review for a given product.\n   *\n   * @param productCode The `productCode` for given product\n   * @param review Review to post\n   */\n  abstract post(productCode: string, review: any): Observable<Review>;\n}\n","import { SearchConfig } from '../../model/search-config';\n\nimport { Observable } from 'rxjs';\nimport {\n  Suggestion,\n  ProductSearchPage,\n} from '../../../model/product-search.model';\n\nexport abstract class ProductSearchAdapter {\n  abstract search(\n    query: string,\n    searchConfig?: SearchConfig\n  ): Observable<ProductSearchPage>;\n\n  abstract loadSuggestions(\n    term: string,\n    pageSize?: number\n  ): Observable<Suggestion[]>;\n}\n","import { ProductScope } from '../../../product/model/product-scope';\nimport { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccProductConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        product:\n          'products/${productCode}?fields=DEFAULT,averageRating,images(FULL),classifications,manufacturer,numberOfReviews,categories(FULL),baseOptions,baseProduct,variantOptions,variantType',\n        product_scopes: {\n          list:\n            'products/${productCode}?fields=code,name,summary,price(formattedValue),images(DEFAULT,galleryIndex)',\n          details:\n            'products/${productCode}?fields=averageRating,stock(DEFAULT),description,availableForPickup,code,url,price(DEFAULT),numberOfReviews,manufacturer,categories(FULL),priceRange,multidimensional,configuratorType,configurable,tags,images(FULL)',\n          attributes: 'products/${productCode}?fields=classifications',\n          variants:\n            'products/${productCode}?fields=name,purchasable,baseOptions(DEFAULT),baseProduct,variantOptions(DEFAULT),variantType',\n        },\n        productReviews: 'products/${productCode}/reviews',\n        // Uncomment this when occ gets configured\n        // productReferences:\n        //   'products/${productCode}/references?fields=DEFAULT,references(target(images(FULL)))&referenceType=${referenceType}',\n        productReferences:\n          'products/${productCode}/references?fields=DEFAULT,references(target(images(FULL)))',\n        // tslint:disable:max-line-length\n        productSearch:\n          'products/search?fields=products(code,name,summary,price(FULL),images(DEFAULT),stock(FULL),averageRating,variantOptions),facets,breadcrumbs,pagination(DEFAULT),sorts(DEFAULT),freeTextSearch',\n        // tslint:enable\n        productSuggestions: 'products/suggestions',\n      },\n    },\n    loadingScopes: {\n      product: {\n        details: {\n          include: [ProductScope.LIST, ProductScope.VARIANTS],\n        },\n      },\n    },\n  },\n};\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { provideDefaultConfig } from '../../../config/config.module';\nimport { PRODUCT_NORMALIZER } from '../../../product/connectors/product/converters';\nimport { ProductAdapter } from '../../../product/connectors/product/product.adapter';\nimport { PRODUCT_REFERENCES_NORMALIZER } from '../../../product/connectors/references/converters';\nimport { ProductReferencesAdapter } from '../../../product/connectors/references/product-references.adapter';\nimport { ProductReviewsAdapter } from '../../../product/connectors/reviews/product-reviews.adapter';\nimport { PRODUCT_SEARCH_PAGE_NORMALIZER } from '../../../product/connectors/search/converters';\nimport { ProductSearchAdapter } from '../../../product/connectors/search/product-search.adapter';\nimport { OccProductReferencesListNormalizer } from './converters/occ-product-references-list-normalizer';\nimport { OccProductSearchPageNormalizer } from './converters/occ-product-search-page-normalizer';\nimport { ProductImageNormalizer } from './converters/product-image-normalizer';\nimport { OccProductReferencesAdapter } from './occ-product-references.adapter';\nimport { OccProductReviewsAdapter } from './occ-product-reviews.adapter';\nimport { OccProductSearchAdapter } from './occ-product-search.adapter';\nimport { OccProductAdapter } from './occ-product.adapter';\nimport { ProductNameNormalizer } from './converters/product-name-normalizer';\nimport { defaultOccProductConfig } from './default-occ-product-config';\nimport './product-occ-config';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    provideDefaultConfig(defaultOccProductConfig),\n    {\n      provide: ProductAdapter,\n      useClass: OccProductAdapter,\n    },\n    {\n      provide: PRODUCT_NORMALIZER,\n      useExisting: ProductImageNormalizer,\n      multi: true,\n    },\n    {\n      provide: PRODUCT_NORMALIZER,\n      useExisting: ProductNameNormalizer,\n      multi: true,\n    },\n    {\n      provide: ProductReferencesAdapter,\n      useClass: OccProductReferencesAdapter,\n    },\n    {\n      provide: PRODUCT_REFERENCES_NORMALIZER,\n      useExisting: OccProductReferencesListNormalizer,\n      multi: true,\n    },\n    {\n      provide: ProductSearchAdapter,\n      useClass: OccProductSearchAdapter,\n    },\n    {\n      provide: PRODUCT_SEARCH_PAGE_NORMALIZER,\n      useExisting: OccProductSearchPageNormalizer,\n      multi: true,\n    },\n    {\n      provide: ProductReviewsAdapter,\n      useClass: OccProductReviewsAdapter,\n    },\n  ],\n})\nexport class ProductOccModule {}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../util/converter.service';\nimport { Currency, Language } from '../../model/misc.model';\nimport { Country, Region } from '../../model/address.model';\n\nexport const LANGUAGE_NORMALIZER = new InjectionToken<Converter<any, Language>>(\n  'LanguageNormalizer'\n);\n\nexport const CURRENCY_NORMALIZER = new InjectionToken<Converter<any, Currency>>(\n  'CurrencyNormalizer'\n);\n\nexport const COUNTRY_NORMALIZER = new InjectionToken<Converter<any, Country>>(\n  'CountryNormalizer'\n);\n\nexport const REGION_NORMALIZER = new InjectionToken<Converter<any, Region>>(\n  'RegionNormalizer'\n);\n","import { HttpClient, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Country, CountryType, Region } from '../../../model/address.model';\nimport { BaseSite, Currency, Language } from '../../../model/misc.model';\nimport {\n  COUNTRY_NORMALIZER,\n  CURRENCY_NORMALIZER,\n  LANGUAGE_NORMALIZER,\n  REGION_NORMALIZER,\n} from '../../../site-context/connectors/converters';\nimport { SiteAdapter } from '../../../site-context/connectors/site.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccSiteAdapter implements SiteAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService\n  ) {}\n\n  loadLanguages(): Observable<Language[]> {\n    return this.http\n      .get<Occ.LanguageList>(this.occEndpointsService.getUrl('languages'))\n      .pipe(\n        map(languageList => languageList.languages),\n        this.converterService.pipeableMany(LANGUAGE_NORMALIZER)\n      );\n  }\n\n  loadCurrencies(): Observable<Currency[]> {\n    return this.http\n      .get<Occ.CurrencyList>(this.occEndpointsService.getUrl('currencies'))\n      .pipe(\n        map(currencyList => currencyList.currencies),\n        this.converterService.pipeableMany(CURRENCY_NORMALIZER)\n      );\n  }\n\n  loadCountries(type?: CountryType): Observable<Country[]> {\n    return this.http\n      .get<Occ.CountryList>(\n        this.occEndpointsService.getUrl(\n          'countries',\n          undefined,\n          type ? { type } : undefined\n        )\n      )\n      .pipe(\n        map(countryList => countryList.countries),\n        this.converterService.pipeableMany(COUNTRY_NORMALIZER)\n      );\n  }\n\n  loadRegions(countryIsoCode: string): Observable<Region[]> {\n    return this.http\n      .get<Occ.RegionList>(\n        this.occEndpointsService.getUrl('regions', { isoCode: countryIsoCode })\n      )\n      .pipe(\n        map(regionList => regionList.regions),\n        this.converterService.pipeableMany(REGION_NORMALIZER)\n      );\n  }\n\n  loadBaseSite(): Observable<BaseSite> {\n    const baseUrl = this.occEndpointsService.getBaseEndpoint();\n    const urlSplits = baseUrl.split('/');\n    const activeSite = urlSplits.pop();\n    const url = urlSplits.join('/') + '/basesites';\n\n    const params = new HttpParams({\n      fromString: 'fields=FULL',\n    });\n\n    return this.http\n      .get<{ baseSites: BaseSite[] }>(url, { params: params })\n      .pipe(\n        map(siteList => {\n          return siteList.baseSites.find(site => site.uid === activeSite);\n        })\n      );\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Country, CountryType, Region } from '../../model/address.model';\nimport { BaseSite, Currency, Language } from '../../model/misc.model';\n\nexport abstract class SiteAdapter {\n  /**\n   * Abstract method used to load languages.\n   */\n  abstract loadLanguages(): Observable<Language[]>;\n\n  /**\n   * Abstract method used to load currencies.\n   */\n  abstract loadCurrencies(): Observable<Currency[]>;\n\n  /**\n   * Abstract method used to get countries with optional type.\n   */\n  abstract loadCountries(type?: CountryType): Observable<Country[]>;\n\n  /**\n   * Abstract method used to get regions for a country.\n   */\n  abstract loadRegions(countryIsoCode: string): Observable<Region[]>;\n\n  /**\n   * Abstract method used to get base site data.\n   */\n  abstract loadBaseSite(): Observable<BaseSite>;\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccSiteContextConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        languages: 'languages',\n        currencies: 'currencies',\n        countries: 'countries',\n        regions:\n          'countries/${isoCode}/regions?fields=regions(name,isocode,isocodeShort)',\n      },\n    },\n  },\n};\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, take, tap } from 'rxjs/operators';\nimport { Currency } from '../../model/misc.model';\nimport { WindowRef } from '../../window/window-ref';\nimport { SiteContextActions } from '../store/actions/index';\nimport { SiteContextSelectors } from '../store/selectors/index';\nimport { StateWithSiteContext } from '../store/state';\nimport { SiteContext } from './site-context.interface';\nimport { SiteContextConfig } from '../config/site-context-config';\nimport {\n  getContextParameterValues,\n  getContextParameterDefault,\n} from '../config/context-config-utils';\nimport { CURRENCY_CONTEXT_ID } from '../providers/context-ids';\n\n/**\n * Facade that provides easy access to curreny state, actions and selectors.\n */\n@Injectable()\nexport class CurrencyService implements SiteContext<Currency> {\n  private sessionStorage: Storage;\n\n  constructor(\n    protected store: Store<StateWithSiteContext>,\n    winRef: WindowRef,\n    protected config: SiteContextConfig\n  ) {\n    this.sessionStorage = winRef.sessionStorage;\n  }\n\n  /**\n   * Represents all the currencies supported by the current store.\n   */\n  getAll(): Observable<Currency[]> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getAllCurrencies),\n      tap(currencies => {\n        if (!currencies) {\n          this.store.dispatch(new SiteContextActions.LoadCurrencies());\n        }\n      }),\n      filter(currenies => Boolean(currenies))\n    );\n  }\n\n  /**\n   * Represents the isocode of the active currency.\n   */\n  getActive(): Observable<string> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getActiveCurrency),\n      filter(active => Boolean(active))\n    );\n  }\n\n  /**\n   * Sets the active language.\n   */\n  setActive(isocode: string) {\n    return this.store\n      .pipe(select(SiteContextSelectors.getActiveCurrency), take(1))\n      .subscribe(activeCurrency => {\n        if (activeCurrency !== isocode) {\n          this.store.dispatch(\n            new SiteContextActions.SetActiveCurrency(isocode)\n          );\n        }\n      });\n  }\n\n  /**\n   * Initials the active currency. The active currency is either given\n   * by the last visit (stored in session storage) or by the\n   * default session currency of the store.\n   */\n  initialize() {\n    const sessionCurrency =\n      this.sessionStorage && this.sessionStorage.getItem('currency');\n    if (\n      sessionCurrency &&\n      getContextParameterValues(this.config, CURRENCY_CONTEXT_ID).includes(\n        sessionCurrency\n      )\n    ) {\n      this.setActive(sessionCurrency);\n    } else {\n      this.setActive(\n        getContextParameterDefault(this.config, CURRENCY_CONTEXT_ID)\n      );\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter, take, tap } from 'rxjs/operators';\nimport { Language } from '../../model/misc.model';\nimport { WindowRef } from '../../window/window-ref';\nimport { SiteContextActions } from '../store/actions/index';\nimport { SiteContextSelectors } from '../store/selectors/index';\nimport { StateWithSiteContext } from '../store/state';\nimport { SiteContext } from './site-context.interface';\nimport { LANGUAGE_CONTEXT_ID } from '../providers/context-ids';\nimport { SiteContextConfig } from '../config/site-context-config';\nimport {\n  getContextParameterValues,\n  getContextParameterDefault,\n} from '../config/context-config-utils';\n\n/**\n * Facade that provides easy access to language state, actions and selectors.\n */\n@Injectable()\nexport class LanguageService implements SiteContext<Language> {\n  private sessionStorage: Storage;\n\n  constructor(\n    protected store: Store<StateWithSiteContext>,\n    winRef: WindowRef,\n    protected config: SiteContextConfig\n  ) {\n    this.sessionStorage = winRef.sessionStorage;\n  }\n\n  /**\n   * Represents all the languages supported by the current store.\n   */\n  getAll(): Observable<Language[]> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getAllLanguages),\n      tap(languages => {\n        if (!languages) {\n          this.store.dispatch(new SiteContextActions.LoadLanguages());\n        }\n      }),\n      filter(languages => Boolean(languages))\n    );\n  }\n\n  /**\n   * Represents the isocode of the active language.\n   */\n  getActive(): Observable<string> {\n    return this.store.pipe(\n      select(SiteContextSelectors.getActiveLanguage),\n      filter(active => Boolean(active))\n    );\n  }\n\n  /**\n   * Sets the active language.\n   */\n  setActive(isocode: string) {\n    return this.store\n      .pipe(select(SiteContextSelectors.getActiveLanguage), take(1))\n      .subscribe(activeLanguage => {\n        if (activeLanguage !== isocode) {\n          this.store.dispatch(\n            new SiteContextActions.SetActiveLanguage(isocode)\n          );\n        }\n      });\n  }\n\n  /**\n   * Initials the active language. The active language is either given\n   * by the last visit (stored in session storage) or by the\n   * default session language of the store.\n   */\n  initialize() {\n    const sessionLanguage =\n      this.sessionStorage && this.sessionStorage.getItem('language');\n    if (\n      sessionLanguage &&\n      getContextParameterValues(this.config, LANGUAGE_CONTEXT_ID).includes(\n        sessionLanguage\n      )\n    ) {\n      this.setActive(sessionLanguage);\n    } else {\n      this.setActive(\n        getContextParameterDefault(this.config, LANGUAGE_CONTEXT_ID)\n      );\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\n\nimport { Observable } from 'rxjs';\nimport { CurrencyService } from '../../../site-context/facade/currency.service';\nimport { LanguageService } from '../../../site-context/facade/language.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { SiteContextConfig } from '../../../site-context/config/site-context-config';\nimport { getContextParameterDefault } from '../../../site-context/config/context-config-utils';\nimport {\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from '../../../site-context/providers/context-ids';\n\n@Injectable({ providedIn: 'root' })\nexport class SiteContextInterceptor implements HttpInterceptor {\n  activeLang: string;\n  activeCurr: string;\n\n  constructor(\n    private languageService: LanguageService,\n    private currencyService: CurrencyService,\n    private occEndpoints: OccEndpointsService,\n    private config: SiteContextConfig\n  ) {\n    this.activeLang = getContextParameterDefault(\n      this.config,\n      LANGUAGE_CONTEXT_ID\n    );\n    this.activeCurr = getContextParameterDefault(\n      this.config,\n      CURRENCY_CONTEXT_ID\n    );\n\n    this.languageService\n      .getActive()\n      .subscribe(data => (this.activeLang = data));\n\n    this.currencyService.getActive().subscribe(data => {\n      this.activeCurr = data;\n    });\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (request.url.includes(this.occEndpoints.getBaseEndpoint())) {\n      request = request.clone({\n        setParams: {\n          lang: this.activeLang,\n          curr: this.activeCurr,\n        },\n      });\n    }\n\n    return next.handle(request);\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { HTTP_INTERCEPTORS, HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { provideDefaultConfig } from '../../../config/config.module';\nimport { SiteAdapter } from '../../../site-context/connectors/site.adapter';\nimport { defaultOccSiteContextConfig } from './default-occ-site-context-config';\nimport { OccSiteAdapter } from './occ-site.adapter';\nimport { SiteContextInterceptor } from './site-context.interceptor';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    provideDefaultConfig(defaultOccSiteContextConfig),\n    {\n      provide: SiteAdapter,\n      useClass: OccSiteAdapter,\n    },\n    {\n      provide: HTTP_INTERCEPTORS,\n      useExisting: SiteContextInterceptor,\n      multi: true,\n    },\n  ],\n})\nexport class SiteContextOccModule {}\n","import { StoreFinderSearchConfig } from '../model/search-config';\nimport { Observable } from 'rxjs';\nimport { PointOfService } from '../../model/point-of-service.model';\nimport { GeoPoint } from '../../model/misc.model';\nimport {\n  StoreFinderSearchPage,\n  StoreCount,\n} from '../../model/store-finder.model';\n\nexport abstract class StoreFinderAdapter {\n  abstract search(\n    query: string,\n    searchConfig: StoreFinderSearchConfig,\n    longitudeLatitude?: GeoPoint\n  ): Observable<StoreFinderSearchPage>;\n\n  abstract loadCounts(): Observable<StoreCount[]>;\n\n  abstract load(storeId: string): Observable<PointOfService>;\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccStoreFinderConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        store: 'stores/${storeId}?fields=FULL',\n        stores:\n          'stores?fields=stores(name,displayName,formattedDistance,openingHours(weekDayOpeningList(FULL),specialDayOpeningList(FULL)),geoPoint(latitude,longitude),address(line1,line2,town,region(FULL),postalCode,phone,country,email), features),pagination(DEFAULT),sorts(DEFAULT)',\n        storescounts: 'stores/storescounts',\n      },\n    },\n  },\n};\n","import { StoreFinderSearchConfig } from '../model/search-config';\nimport { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { StoreFinderAdapter } from './store-finder.adapter';\nimport { PointOfService } from '../../model/point-of-service.model';\nimport { GeoPoint } from '../../model/misc.model';\nimport {\n  StoreCount,\n  StoreFinderSearchPage,\n} from '../../model/store-finder.model';\n\n@Injectable({ providedIn: 'root' })\nexport class StoreFinderConnector {\n  constructor(protected adapter: StoreFinderAdapter) {}\n\n  search(\n    query: string,\n    searchConfig: StoreFinderSearchConfig,\n    longitudeLatitude?: GeoPoint\n  ): Observable<StoreFinderSearchPage> {\n    return this.adapter.search(query, searchConfig, longitudeLatitude);\n  }\n\n  getCounts(): Observable<StoreCount[]> {\n    return this.adapter.loadCounts();\n  }\n\n  get(storeId: string): Observable<PointOfService> {\n    return this.adapter.load(storeId);\n  }\n}\n","import { Converter } from '../../util/converter.service';\nimport { PointOfService } from '../../model/point-of-service.model';\nimport { InjectionToken } from '@angular/core';\nimport {\n  StoreFinderSearchPage,\n  StoreCount,\n} from '../../model/store-finder.model';\n\nexport const POINT_OF_SERVICE_NORMALIZER = new InjectionToken<\n  Converter<any, PointOfService>\n>('PointOfServiceNormalizer');\n\nexport const STORE_FINDER_SEARCH_PAGE_NORMALIZER = new InjectionToken<\n  Converter<any, StoreFinderSearchPage>\n>('StoreFinderSearchPageNormalizer');\n\nexport const STORE_COUNT_NORMALIZER = new InjectionToken<\n  Converter<any, StoreCount>\n>('StoreCountNormalizer');\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { GeoPoint } from '../../../model/misc.model';\nimport { PointOfService } from '../../../model/point-of-service.model';\nimport {\n  StoreCount,\n  StoreFinderSearchPage,\n} from '../../../model/store-finder.model';\nimport {\n  POINT_OF_SERVICE_NORMALIZER,\n  STORE_COUNT_NORMALIZER,\n  STORE_FINDER_SEARCH_PAGE_NORMALIZER,\n} from '../../../store-finder/connectors';\nimport { StoreFinderAdapter } from '../../../store-finder/connectors/store-finder.adapter';\nimport { StoreFinderSearchConfig } from '../../../store-finder/model';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccStoreFinderAdapter implements StoreFinderAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService\n  ) {}\n\n  search(\n    query: string,\n    searchConfig: StoreFinderSearchConfig,\n    longitudeLatitude?: GeoPoint\n  ): Observable<StoreFinderSearchPage> {\n    return this.callOccFindStores(query, searchConfig, longitudeLatitude).pipe(\n      this.converterService.pipeable(STORE_FINDER_SEARCH_PAGE_NORMALIZER)\n    );\n  }\n\n  loadCounts(): Observable<StoreCount[]> {\n    return this.http\n      .get<Occ.StoreCountList>(this.occEndpointsService.getUrl('storescounts'))\n      .pipe(\n        map(\n          ({ countriesAndRegionsStoreCount }) => countriesAndRegionsStoreCount\n        ),\n        this.converterService.pipeableMany(STORE_COUNT_NORMALIZER)\n      );\n  }\n\n  load(storeId: string): Observable<PointOfService> {\n    return this.http\n      .get<Occ.PointOfService>(\n        this.occEndpointsService.getUrl('store', { storeId })\n      )\n      .pipe(this.converterService.pipeable(POINT_OF_SERVICE_NORMALIZER));\n  }\n\n  protected callOccFindStores(\n    query: string,\n    searchConfig: StoreFinderSearchConfig,\n    longitudeLatitude?: GeoPoint\n  ): Observable<Occ.StoreFinderSearchPage> {\n    const params = {};\n\n    if (longitudeLatitude) {\n      params['longitude'] = String(longitudeLatitude.longitude);\n      params['latitude'] = String(longitudeLatitude.latitude);\n      params['radius'] = String('10000000');\n    } else {\n      params['query'] = query;\n    }\n    if (searchConfig.pageSize) {\n      params['pageSize'] = String(searchConfig.pageSize);\n    }\n    if (searchConfig.currentPage) {\n      params['currentPage'] = String(searchConfig.currentPage);\n    }\n    if (searchConfig.sort) {\n      params['sort'] = searchConfig.sort;\n    }\n\n    return this.http.get<Occ.StoreFinderSearchPage>(\n      this.occEndpointsService.getUrl('stores', undefined, params)\n    );\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { provideDefaultConfig } from '../../../config/config.module';\nimport { StoreFinderAdapter } from '../../../store-finder/connectors/store-finder.adapter';\nimport { defaultOccStoreFinderConfig } from './default-occ-store-finder-config';\nimport { OccStoreFinderAdapter } from './occ-store-finder.adapter';\n\n@NgModule({\n  providers: [\n    provideDefaultConfig(defaultOccStoreFinderConfig),\n    { provide: StoreFinderAdapter, useClass: OccStoreFinderAdapter },\n  ],\n})\nexport class StoreFinderOccModule {}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\nexport const CONSENT_TEMPLATE_NORMALIZER = new InjectionToken<\n  Converter<any, ConsentTemplate>\n>('ConsentTemplateNormalizer');\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { AnonymousConsentTemplatesAdapter } from '../../../anonymous-consents/connectors/anonymous-consent-templates.adapter';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { CONSENT_TEMPLATE_NORMALIZER } from '../../../user/connectors/consent/converters';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccAnonymousConsentTemplatesAdapter\n  implements AnonymousConsentTemplatesAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadAnonymousConsentTemplates(): Observable<ConsentTemplate[]> {\n    const url = this.occEndpoints.getUrl('anonymousConsentTemplates');\n    return this.http.get<Occ.ConsentTemplateList>(url).pipe(\n      catchError(error => throwError(error)),\n      map(consentList => consentList.consentTemplates),\n      this.converter.pipeableMany(CONSENT_TEMPLATE_NORMALIZER)\n    );\n  }\n}\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { Address, AddressValidation } from '../../../model/address.model';\nimport {\n  ADDRESS_NORMALIZER,\n  ADDRESS_SERIALIZER,\n  ADDRESS_VALIDATION_NORMALIZER,\n} from '../../../user/connectors/address/converters';\nimport { UserAddressAdapter } from '../../../user/connectors/address/user-address.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\nimport { OCC_USER_ID_ANONYMOUS } from '../../utils/occ-constants';\n\n@Injectable()\nexport class OccUserAddressAdapter implements UserAddressAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadAll(userId: string): Observable<Address[]> {\n    const url = this.occEndpoints.getUrl('addresses', { userId });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .get<Occ.AddressList>(url, { headers })\n      .pipe(\n        catchError((error: any) => throwError(error)),\n        map(addressList => addressList.addresses),\n        this.converter.pipeableMany(ADDRESS_NORMALIZER)\n      );\n  }\n\n  add(userId: string, address: Address): Observable<{}> {\n    const url = this.occEndpoints.getUrl('addresses', { userId });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .post(url, address, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  update(userId: string, addressId: string, address: Address): Observable<{}> {\n    const url = this.occEndpoints.getUrl('addressDetail', {\n      userId,\n      addressId,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .patch(url, address, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  verify(userId: string, address: Address): Observable<AddressValidation> {\n    const url = this.occEndpoints.getUrl('addressVerification', { userId });\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n\n    return this.http\n      .post<AddressValidation>(url, address, { headers })\n      .pipe(\n        catchError((error: any) => throwError(error)),\n        this.converter.pipeable(ADDRESS_VALIDATION_NORMALIZER)\n      );\n  }\n\n  delete(userId: string, addressId: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('addressDetail', {\n      userId,\n      addressId,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .delete(url, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { CONSENT_TEMPLATE_NORMALIZER } from '../../../user/connectors/consent/converters';\nimport { UserConsentAdapter } from '../../../user/connectors/consent/user-consent.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccUserConsentAdapter implements UserConsentAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadConsents(userId: string): Observable<ConsentTemplate[]> {\n    const url = this.occEndpoints.getUrl('consentTemplates', { userId });\n    const headers = new HttpHeaders({ 'Cache-Control': 'no-cache' });\n    return this.http\n      .get<Occ.ConsentTemplateList>(url, { headers })\n      .pipe(\n        catchError((error: any) => throwError(error)),\n        map(consentList => consentList.consentTemplates),\n        this.converter.pipeableMany(CONSENT_TEMPLATE_NORMALIZER)\n      );\n  }\n\n  giveConsent(\n    userId: string,\n    consentTemplateId: string,\n    consentTemplateVersion: number\n  ): Observable<ConsentTemplate> {\n    const url = this.occEndpoints.getUrl('consents', { userId });\n    const httpParams = new HttpParams()\n      .set('consentTemplateId', consentTemplateId)\n      .set('consentTemplateVersion', consentTemplateVersion.toString());\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n      'Cache-Control': 'no-cache',\n    });\n    return this.http\n      .post<Occ.ConsentTemplate>(url, httpParams, { headers })\n      .pipe(\n        catchError(error => throwError(error)),\n        this.converter.pipeable(CONSENT_TEMPLATE_NORMALIZER)\n      );\n  }\n\n  withdrawConsent(userId: string, consentCode: string): Observable<{}> {\n    const headers = new HttpHeaders({\n      'Cache-Control': 'no-cache',\n    });\n    const url = this.occEndpoints.getUrl('consentDetail', {\n      userId,\n      consentId: consentCode,\n    });\n\n    return this.http.delete(url, { headers });\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport {\n  OrderHistoryList,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequest,\n} from '../../../model/order.model';\nimport { ConsignmentTracking } from '../../../model/consignment-tracking.model';\n\nexport const ORDER_HISTORY_NORMALIZER = new InjectionToken<\n  Converter<any, OrderHistoryList>\n>('OrderHistoryNormalizer');\n\nexport const CONSIGNMENT_TRACKING_NORMALIZER = new InjectionToken<\n  Converter<any, ConsignmentTracking>\n>('ConsignmentTrackingNormalizer');\n\nexport const ORDER_RETURN_REQUEST_NORMALIZER = new InjectionToken<\n  Converter<any, ReturnRequest>\n>('OrderReturnRequestNormalizer');\n\nexport const ORDER_RETURN_REQUEST_INPUT_SERIALIZER = new InjectionToken<\n  Converter<ReturnRequestEntryInputList, any>\n>('OrderReturnRequestInputSerializer');\n\nexport const ORDER_RETURNS_NORMALIZER = new InjectionToken<\n  Converter<any, ReturnRequestList>\n>('OrderReturnsNormalizer');\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { ORDER_NORMALIZER } from '../../../checkout/connectors/checkout/converters';\nimport { FeatureConfigService } from '../../../features-config/services/feature-config.service';\nimport { ConsignmentTracking } from '../../../model/consignment-tracking.model';\nimport {\n  CancellationRequestEntryInputList,\n  Order,\n  OrderHistoryList,\n  ReturnRequest,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequestModification,\n} from '../../../model/order.model';\nimport {\n  CONSIGNMENT_TRACKING_NORMALIZER,\n  ORDER_HISTORY_NORMALIZER,\n  ORDER_RETURNS_NORMALIZER,\n  ORDER_RETURN_REQUEST_INPUT_SERIALIZER,\n  ORDER_RETURN_REQUEST_NORMALIZER,\n} from '../../../user/connectors/order/converters';\nimport { UserOrderAdapter } from '../../../user/connectors/order/user-order.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\nimport {\n  OCC_USER_ID_ANONYMOUS,\n  OCC_USER_ID_CURRENT,\n} from '../../utils/occ-constants';\n\n@Injectable()\nexport class OccUserOrderAdapter implements UserOrderAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService,\n    protected featureConfigService?: FeatureConfigService\n  ) {}\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  protected getOrderEndpoint(userId: string): string {\n    const orderEndpoint = 'users/' + userId + '/orders';\n    return this.occEndpoints.getEndpoint(orderEndpoint);\n  }\n\n  public load(userId: string, orderCode: string): Observable<Order> {\n    // TODO: Deprecated, remove Issue #4125\n    if (!this.featureConfigService.isLevel('1.1')) {\n      return this.legacyLoad(userId, orderCode);\n    }\n\n    const url = this.occEndpoints.getUrl('orderDetail', {\n      userId,\n      orderId: orderCode,\n    });\n\n    let headers = new HttpHeaders();\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n\n    return this.http\n      .get<Occ.Order>(url, { headers })\n      .pipe(this.converter.pipeable(ORDER_NORMALIZER));\n  }\n\n  public loadHistory(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<OrderHistoryList> {\n    // TODO: Deprecated, remove Issue #4125\n    if (!this.featureConfigService.isLevel('1.1')) {\n      return this.legacyLoadHistory(userId, pageSize, currentPage, sort);\n    }\n\n    const params = {};\n    if (pageSize) {\n      params['pageSize'] = pageSize.toString();\n    }\n    if (currentPage) {\n      params['currentPage'] = currentPage.toString();\n    }\n    if (sort) {\n      params['sort'] = sort.toString();\n    }\n\n    const url = this.occEndpoints.getUrl('orderHistory', { userId }, params);\n\n    return this.http\n      .get<Occ.OrderHistoryList>(url)\n      .pipe(this.converter.pipeable(ORDER_HISTORY_NORMALIZER));\n  }\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  private legacyLoad(userId: string, orderCode: string): Observable<Order> {\n    const url = this.getOrderEndpoint(userId) + '/' + orderCode;\n\n    const params = new HttpParams({\n      fromString: 'fields=FULL',\n    });\n\n    return this.http\n      .get<Occ.Order>(url, {\n        params,\n      })\n      .pipe(this.converter.pipeable(ORDER_NORMALIZER));\n  }\n\n  /**\n   * @deprecated Since 1.1\n   * Use configurable endpoints.\n   * Remove issue: #4125\n   */\n  private legacyLoadHistory(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<OrderHistoryList> {\n    const url = this.getOrderEndpoint(userId);\n    let params = new HttpParams();\n    if (pageSize) {\n      params = params.set('pageSize', pageSize.toString());\n    }\n    if (currentPage) {\n      params = params.set('currentPage', currentPage.toString());\n    }\n    if (sort) {\n      params = params.set('sort', sort);\n    }\n\n    return this.http\n      .get<Occ.OrderHistoryList>(url, { params: params })\n      .pipe(this.converter.pipeable(ORDER_HISTORY_NORMALIZER));\n  }\n\n  public getConsignmentTracking(\n    orderCode: string,\n    consignmentCode: string,\n    userId: string = OCC_USER_ID_CURRENT\n  ): Observable<ConsignmentTracking> {\n    const url = this.occEndpoints.getUrl('consignmentTracking', {\n      userId,\n      orderCode,\n      consignmentCode,\n    });\n    return this.http\n      .get<ConsignmentTracking>(url)\n      .pipe(this.converter.pipeable(CONSIGNMENT_TRACKING_NORMALIZER));\n  }\n\n  public cancel(\n    userId: string,\n    orderCode: string,\n    cancelRequestInput: CancellationRequestEntryInputList\n  ): Observable<{}> {\n    const url = this.occEndpoints.getUrl('cancelOrder', {\n      userId,\n      orderId: orderCode,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .post(url, cancelRequestInput, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  public createReturnRequest(\n    userId: string,\n    returnRequestInput: ReturnRequestEntryInputList\n  ): Observable<ReturnRequest> {\n    const url = this.occEndpoints.getUrl('returnOrder', {\n      userId,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    returnRequestInput = this.converter.convert(\n      returnRequestInput,\n      ORDER_RETURN_REQUEST_INPUT_SERIALIZER\n    );\n\n    return this.http.post(url, returnRequestInput, { headers }).pipe(\n      catchError((error: any) => throwError(error)),\n      this.converter.pipeable(ORDER_RETURN_REQUEST_NORMALIZER)\n    );\n  }\n\n  public loadReturnRequestList(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<ReturnRequestList> {\n    const params = {};\n    if (pageSize) {\n      params['pageSize'] = pageSize.toString();\n    }\n    if (currentPage) {\n      params['currentPage'] = currentPage.toString();\n    }\n    if (sort) {\n      params['sort'] = sort.toString();\n    }\n\n    const url = this.occEndpoints.getUrl('orderReturns', { userId }, params);\n\n    return this.http\n      .get<ReturnRequestList>(url)\n      .pipe(this.converter.pipeable(ORDER_RETURNS_NORMALIZER));\n  }\n\n  public loadReturnRequestDetail(\n    userId: string,\n    returnRequestCode: string\n  ): Observable<ReturnRequest> {\n    const url = this.occEndpoints.getUrl('orderReturnDetail', {\n      userId,\n      returnRequestCode,\n    });\n\n    return this.http\n      .get<ReturnRequest>(url)\n      .pipe(this.converter.pipeable(ORDER_RETURN_REQUEST_NORMALIZER));\n  }\n\n  public cancelReturnRequest(\n    userId: string,\n    returnRequestCode: string,\n    returnRequestModification: ReturnRequestModification\n  ): Observable<{}> {\n    const url = this.occEndpoints.getUrl('cancelReturn', {\n      userId,\n      returnRequestCode,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .patch(url, returnRequestModification, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { PAYMENT_DETAILS_NORMALIZER } from '../../../checkout/connectors/payment/converters';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { UserPaymentAdapter } from '../../../user/connectors/payment/user-payment.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\n@Injectable()\nexport class OccUserPaymentAdapter implements UserPaymentAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  loadAll(userId: string): Observable<PaymentDetails[]> {\n    const url =\n      this.occEndpoints.getUrl('paymentDetailsAll', { userId }) + '?saved=true';\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .get<Occ.PaymentDetailsList>(url, { headers })\n      .pipe(\n        catchError((error: any) => throwError(error)),\n        map(methodList => methodList.payments),\n        this.converter.pipeableMany(PAYMENT_DETAILS_NORMALIZER)\n      );\n  }\n\n  delete(userId: string, paymentMethodID: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('paymentDetail', {\n      userId,\n      paymentDetailId: paymentMethodID,\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .delete(url, { headers })\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n\n  setDefault(userId: string, paymentMethodID: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('paymentDetail', {\n      userId,\n      paymentDetailId: paymentMethodID,\n    });\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n\n    return this.http\n      .patch(\n        url,\n        // TODO: Remove billingAddress property\n        { billingAddress: { titleCode: 'mr' }, defaultPayment: true },\n        { headers }\n      )\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\n\nexport const USER_NORMALIZER = new InjectionToken<Converter<any, User>>(\n  'UserNormalizer'\n);\n\nexport const USER_SERIALIZER = new InjectionToken<Converter<User, any>>(\n  'UserSerializer'\n);\n\nexport const USER_SIGN_UP_SERIALIZER = new InjectionToken<\n  Converter<UserSignUp, any>\n>('UserSignUpSerializer');\n\nexport const TITLE_NORMALIZER = new InjectionToken<Converter<any, Title>>(\n  'TitleNormalizer'\n);\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\nimport {\n  TITLE_NORMALIZER,\n  USER_NORMALIZER,\n  USER_SERIALIZER,\n  USER_SIGN_UP_SERIALIZER,\n} from '../../../user/connectors/user/converters';\nimport { UserAdapter } from '../../../user/connectors/user/user.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport {\n  InterceptorUtil,\n  USE_CLIENT_TOKEN,\n} from '../../utils/interceptor-util';\n@Injectable()\nexport class OccUserAdapter implements UserAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(userId: string): Observable<User> {\n    const url = this.occEndpoints.getUrl('user', { userId });\n    return this.http\n      .get<Occ.User>(url)\n      .pipe(this.converter.pipeable(USER_NORMALIZER));\n  }\n\n  update(userId: string, user: User): Observable<{}> {\n    const url = this.occEndpoints.getUrl('user', { userId });\n    user = this.converter.convert(user, USER_SERIALIZER);\n    return this.http.patch(url, user);\n  }\n\n  register(user: UserSignUp): Observable<User> {\n    const url: string = this.occEndpoints.getUrl('userRegister');\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    user = this.converter.convert(user, USER_SIGN_UP_SERIALIZER);\n\n    return this.http\n      .post<User>(url, user, { headers })\n      .pipe(this.converter.pipeable(USER_NORMALIZER));\n  }\n\n  registerGuest(guid: string, password: string): Observable<User> {\n    const url: string = this.occEndpoints.getUrl('userRegister');\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n\n    const httpParams: HttpParams = new HttpParams()\n      .set('guid', guid)\n      .set('password', password);\n\n    return this.http\n      .post<User>(url, httpParams, { headers })\n      .pipe(this.converter.pipeable(USER_NORMALIZER));\n  }\n\n  requestForgotPasswordEmail(userEmailAddress: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('userForgotPassword');\n    const httpParams: HttpParams = new HttpParams().set(\n      'userId',\n      userEmailAddress\n    );\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    return this.http.post(url, httpParams, { headers });\n  }\n\n  resetPassword(token: string, newPassword: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('userResetPassword');\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n\n    return this.http.post(url, { token, newPassword }, { headers });\n  }\n\n  updateEmail(\n    userId: string,\n    currentPassword: string,\n    newUserId: string\n  ): Observable<{}> {\n    const url = this.occEndpoints.getUrl('userUpdateLoginId', { userId });\n    const httpParams: HttpParams = new HttpParams()\n      .set('password', currentPassword)\n      .set('newLogin', newUserId);\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http.put(url, httpParams, { headers });\n  }\n\n  updatePassword(\n    userId: string,\n    oldPassword: string,\n    newPassword: string\n  ): Observable<{}> {\n    const url = this.occEndpoints.getUrl('userUpdatePassword', { userId });\n    const httpParams: HttpParams = new HttpParams()\n      .set('old', oldPassword)\n      .set('new', newPassword);\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n    return this.http.put(url, httpParams, { headers });\n  }\n\n  remove(userId: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('user', { userId });\n    return this.http.delete<User>(url);\n  }\n\n  loadTitles(): Observable<Title[]> {\n    const url = this.occEndpoints.getUrl('titles');\n    return this.http.get<Occ.TitleList>(url).pipe(\n      map(titleList => titleList.titles),\n      this.converter.pipeableMany(TITLE_NORMALIZER)\n    );\n  }\n}\n","import { Observable } from 'rxjs';\nimport { ConsentTemplate } from '../../model/consent.model';\n\nexport abstract class AnonymousConsentTemplatesAdapter {\n  /**\n   * Abstract method used to load anonymous consents.\n   */\n  abstract loadAnonymousConsentTemplates(): Observable<ConsentTemplate[]>;\n}\n","import { Observable } from 'rxjs';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\nexport abstract class UserAddressAdapter {\n  abstract loadAll(userId: string): Observable<Address[]>;\n\n  abstract add(userId: string, address: Address): Observable<{}>;\n\n  abstract update(\n    userId: string,\n    addressId: string,\n    address: Address\n  ): Observable<{}>;\n\n  abstract verify(\n    userId: string,\n    address: Address\n  ): Observable<AddressValidation>;\n\n  abstract delete(userId: string, addressId: string): Observable<{}>;\n}\n","import { Observable } from 'rxjs';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\nexport abstract class UserConsentAdapter {\n  abstract loadConsents(userId: string): Observable<ConsentTemplate[]>;\n\n  abstract giveConsent(\n    userId: string,\n    consentTemplateId: string,\n    consentTemplateVersion: number\n  ): Observable<ConsentTemplate>;\n\n  abstract withdrawConsent(userId: string, consentCode: string): Observable<{}>;\n}\n","import { Observable } from 'rxjs';\nimport { ConsignmentTracking } from '../../../model/consignment-tracking.model';\nimport {\n  CancellationRequestEntryInputList,\n  Order,\n  OrderHistoryList,\n  ReturnRequest,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequestModification,\n} from '../../../model/order.model';\n\nexport abstract class UserOrderAdapter {\n  /**\n   * Abstract method used to load order data.\n   *\n   * @param userId The `userId` for given user\n   * @param orderCode The `orderCode` for given order\n   */\n  abstract load(userId: string, orderCode: string): Observable<Order>;\n\n  /**\n   * Abstract method used to load order history for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param pageSize\n   * @param currentPage\n   * @param sort Sorting method\n   */\n  abstract loadHistory(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<OrderHistoryList>;\n\n  /**\n   * Abstract method used to get consignment tracking details\n   * @param orderCode an order code\n   * @param consignmentCode a consignment code\n   * @param userId user id related to order\n   */\n  abstract getConsignmentTracking(\n    orderCode: string,\n    consignmentCode: string,\n    userId?: string\n  ): Observable<ConsignmentTracking>;\n\n  /**\n   * Abstract method used to create return request\n   * @param userId The `userId` for given user\n   * @param returnRequestInput Return request entry input list\n   */\n  abstract createReturnRequest(\n    userId: string,\n    returnRequestInput: ReturnRequestEntryInputList\n  ): Observable<ReturnRequest>;\n\n  /**\n   * Abstract method used to load order return request details\n   * @param userId\n   * @param returnRequestCode\n   */\n  abstract loadReturnRequestDetail(\n    userId: string,\n    returnRequestCode: string\n  ): Observable<ReturnRequest>;\n\n  /**\n   * Abstract method used to load order return request list for an user.\n   * @param userId\n   * @param pageSize\n   * @param currentPage\n   * @param sort\n   */\n  abstract loadReturnRequestList(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<ReturnRequestList>;\n\n  /**\n   * Abstract method used to cancel order\n   * @param userId\n   * @param orderCode\n   * @param cancelRequestInput Cancel request entry input list\n   */\n  abstract cancel(\n    userId: string,\n    orderCode: string,\n    cancelRequestInput: CancellationRequestEntryInputList\n  ): Observable<{}>;\n\n  /**\n   * Abstract method used to cancel one return request\n   * @param userId\n   * @param returnRequestCode\n   * @param returnRequestModification\n   */\n  abstract cancelReturnRequest(\n    userId: string,\n    returnRequestCode: string,\n    returnRequestModification: ReturnRequestModification\n  ): Observable<{}>;\n}\n","import { Observable } from 'rxjs';\nimport { PaymentDetails } from '../../../model/cart.model';\n\nexport abstract class UserPaymentAdapter {\n  abstract loadAll(userId: string): Observable<PaymentDetails[]>;\n\n  abstract delete(userId: string, paymentMethodID: string): Observable<{}>;\n\n  abstract setDefault(userId: string, paymentMethodID: string): Observable<{}>;\n}\n","import { Observable } from 'rxjs';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\n\nexport abstract class UserAdapter {\n  abstract load(userId: string): Observable<User>;\n\n  abstract update(username: string, user: User): Observable<{}>;\n\n  abstract register(user: UserSignUp): Observable<User>;\n\n  abstract registerGuest(guid: string, password: string): Observable<User>;\n\n  abstract requestForgotPasswordEmail(userEmailAddress: string): Observable<{}>;\n\n  abstract resetPassword(token: string, newPassword: string): Observable<{}>;\n\n  abstract updateEmail(\n    userId: string,\n    currentPassword: string,\n    newUserId: string\n  ): Observable<{}>;\n\n  abstract updatePassword(\n    userId: string,\n    oldPassword: string,\n    newPassword: string\n  ): Observable<{}>;\n\n  abstract remove(userId: string): Observable<{}>;\n\n  abstract loadTitles(): Observable<Title[]>;\n}\n","import { OccConfig } from '../../config/occ-config';\n\nexport const defaultOccUserConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        // tslint:disable:max-line-length\n        user: 'users/${userId}',\n        userRegister: 'users',\n        userForgotPassword: 'forgottenpasswordtokens',\n        userResetPassword: 'resetpassword',\n        userUpdateLoginId: 'users/${userId}/login',\n        userUpdatePassword: 'users/${userId}/password',\n        titles: 'titles',\n        paymentDetailsAll: 'users/${userId}/paymentdetails',\n        paymentDetail: 'users/${userId}/paymentdetails/${paymentDetailId}',\n        orderHistory: 'users/${userId}/orders',\n        orderDetail: 'users/${userId}/orders/${orderId}?fields=FULL',\n        anonymousConsentTemplates: 'users/anonymous/consenttemplates',\n        consentTemplates: 'users/${userId}/consenttemplates',\n        consents: 'users/${userId}/consents',\n        consentDetail: 'users/${userId}/consents/${consentId}',\n        addresses: 'users/${userId}/addresses',\n        addressDetail: 'users/${userId}/addresses/${addressId}',\n        addressVerification: 'users/${userId}/addresses/verification',\n        consignmentTracking:\n          'users/${userId}/orders/${orderCode}/consignments/${consignmentCode}/tracking',\n        customerCoupons: 'users/${userId}/customercoupons',\n        claimCoupon: 'users/${userId}/customercoupons/${couponCode}/claim',\n        couponNotification:\n          'users/${userId}/customercoupons/${couponCode}/notification',\n        notificationPreference: 'users/${userId}/notificationpreferences',\n        productInterests: 'users/${userId}/productinterests',\n        getProductInterests:\n          'users/${userId}/productinterests?fields=sorts,pagination,results(productInterestEntry,product(code))',\n        cancelOrder: 'users/${userId}/orders/${orderId}/cancellation',\n        returnOrder:\n          'users/${userId}/orderReturns?fields=BASIC,returnEntries(BASIC,refundAmount(formattedValue),orderEntry(basePrice(formattedValue),product(name,code,baseOptions,images(DEFAULT,galleryIndex)))),deliveryCost(formattedValue),totalPrice(formattedValue),subTotal(formattedValue)',\n        orderReturns: 'users/${userId}/orderReturns?fields=BASIC',\n        orderReturnDetail:\n          'users/${userId}/orderReturns/${returnRequestCode}?fields=BASIC,returnEntries(BASIC,refundAmount(formattedValue),orderEntry(basePrice(formattedValue),product(name,code,baseOptions,images(DEFAULT,galleryIndex)))),deliveryCost(formattedValue),totalPrice(formattedValue),subTotal(formattedValue)',\n        cancelReturn: 'users/${userId}/orderReturns/${returnRequestCode}',\n        // tslint:enable\n      },\n    },\n  },\n};\n","import { Observable } from 'rxjs';\nimport {\n  CustomerCouponSearchResult,\n  CustomerCouponNotification,\n  CustomerCoupon2Customer,\n} from '../../../model/customer-coupon.model';\n\nexport abstract class CustomerCouponAdapter {\n  abstract getCustomerCoupons(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<CustomerCouponSearchResult>;\n\n  abstract turnOnNotification(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCouponNotification>;\n\n  abstract turnOffNotification(\n    userId: string,\n    couponCode: string\n  ): Observable<{}>;\n\n  abstract claimCustomerCoupon(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCoupon2Customer>;\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { CustomerCouponSearchResult } from '../../../model/customer-coupon.model';\n\nexport const CUSTOMER_COUPON_SEARCH_RESULT_NORMALIZER = new InjectionToken<\n  Converter<any, CustomerCouponSearchResult>\n>('CustomerCouponSearchResultNormalizer');\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { CustomerCouponAdapter } from '../../../user/connectors/customer-coupon/customer-coupon.adapter';\nimport {\n  CustomerCouponSearchResult,\n  CustomerCouponNotification,\n  CustomerCoupon2Customer,\n} from '../../../model/customer-coupon.model';\nimport { CUSTOMER_COUPON_SEARCH_RESULT_NORMALIZER } from '../../../user/connectors/customer-coupon/converters';\nimport { ConverterService } from '../../../util/converter.service';\nimport { Occ } from '../../occ-models/occ.models';\n\n@Injectable()\nexport class OccCustomerCouponAdapter implements CustomerCouponAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  getCustomerCoupons(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<CustomerCouponSearchResult> {\n    const url = this.occEndpoints.getUrl('customerCoupons', { userId });\n\n    let params = new HttpParams().set('sort', sort ? sort : 'startDate:asc');\n\n    if (pageSize) {\n      params = params.set('pageSize', pageSize.toString());\n    }\n    if (currentPage) {\n      params = params.set('currentPage', currentPage.toString());\n    }\n\n    const headers = this.newHttpHeader();\n\n    return this.http\n      .get<Occ.CustomerCouponSearchResult>(url, { headers, params })\n      .pipe(this.converter.pipeable(CUSTOMER_COUPON_SEARCH_RESULT_NORMALIZER));\n  }\n\n  turnOffNotification(userId: string, couponCode: string): Observable<{}> {\n    const url = this.occEndpoints.getUrl('couponNotification', {\n      userId,\n      couponCode,\n    });\n    const headers = this.newHttpHeader();\n\n    return this.http.delete(url, { headers });\n  }\n\n  turnOnNotification(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCouponNotification> {\n    const url = this.occEndpoints.getUrl('couponNotification', {\n      userId,\n      couponCode,\n    });\n    const headers = this.newHttpHeader();\n\n    return this.http.post(url, { headers });\n  }\n\n  claimCustomerCoupon(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCoupon2Customer> {\n    const url = this.occEndpoints.getUrl('claimCoupon', {\n      userId,\n      couponCode,\n    });\n    const headers = this.newHttpHeader();\n\n    return this.http.post(url, { headers });\n  }\n\n  private newHttpHeader() {\n    return new HttpHeaders({\n      'Content-Type': 'application/json',\n    });\n  }\n}\n","import { Observable } from 'rxjs';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\n\nexport abstract class UserNotificationPreferenceAdapter {\n  /**\n   * Abstract method used to load notification preferences for an user.\n   *\n   * @param userId The `userId` for given user\n   */\n  abstract loadAll(userId: string): Observable<NotificationPreference[]>;\n\n  /**\n   * Abstract method used to update notification preferences for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param preferences The notification preferences to be updated.\n   */\n  abstract update(\n    userId: string,\n    preferences: NotificationPreference[]\n  ): Observable<{}>;\n}\n","import { InjectionToken } from '@angular/core';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\nimport { Converter } from '../../../util/converter.service';\n\nexport const NOTIFICATION_PREFERENCE_SERIALIZER = new InjectionToken<\n  Converter<NotificationPreference[], any>\n>('NotificationPreferenceSerializer');\n\nexport const NOTIFICATION_PREFERENCE_NORMALIZER = new InjectionToken<\n  Converter<any, NotificationPreference>\n>('NotificationPreferenceNormalizer');\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { UserNotificationPreferenceAdapter } from './user-notification-preference.adapter';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserNotificationPreferenceConnector {\n  constructor(protected adapter: UserNotificationPreferenceAdapter) {}\n\n  loadAll(userId: string): Observable<NotificationPreference[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  update(userId: string, preferences: NotificationPreference[]) {\n    return this.adapter.update(userId, preferences);\n  }\n}\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport {\n  NotificationPreference,\n  NotificationPreferenceList,\n} from '../../../model/notification-preference.model';\nimport {\n  NOTIFICATION_PREFERENCE_NORMALIZER,\n  NOTIFICATION_PREFERENCE_SERIALIZER,\n} from '../../../user/connectors/notification-preference';\nimport { UserNotificationPreferenceAdapter } from '../../../user/connectors/notification-preference/user-notification-preference.adapter';\nimport { ConverterService } from '../../../util/converter.service';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\n\nconst headers = new HttpHeaders({\n  'Content-Type': 'application/json',\n});\n\n@Injectable()\nexport class OccUserNotificationPreferenceAdapter\n  implements UserNotificationPreferenceAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected converter: ConverterService,\n    protected occEndpoints: OccEndpointsService\n  ) {}\n\n  loadAll(userId: string): Observable<NotificationPreference[]> {\n    return this.http\n      .get<NotificationPreferenceList>(\n        this.occEndpoints.getUrl('notificationPreference', { userId }),\n        {\n          headers,\n        }\n      )\n      .pipe(\n        map(list => list.preferences),\n        this.converter.pipeableMany(NOTIFICATION_PREFERENCE_NORMALIZER),\n        catchError((error: any) => throwError(error))\n      );\n  }\n\n  update(\n    userId: string,\n    preferences: NotificationPreference[]\n  ): Observable<{}> {\n    preferences = this.converter.convert(\n      preferences,\n      NOTIFICATION_PREFERENCE_SERIALIZER\n    );\n    return this.http\n      .patch(\n        this.occEndpoints.getUrl('notificationPreference', { userId }),\n        { preferences: preferences },\n        { headers }\n      )\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Converter } from '../../../util/converter.service';\nimport { ProductInterestSearchResult } from '../../../model/product-interest.model';\n\nexport const PRODUCT_INTERESTS_NORMALIZER = new InjectionToken<\n  Converter<any, ProductInterestSearchResult>\n>('ProductInterestsNormalizer');\n","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { OccEndpointsService } from '../../services/occ-endpoints.service';\nimport { Observable, throwError, forkJoin } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { UserInterestsAdapter } from '../../../user/connectors/interests/user-interests.adapter';\nimport {\n  ProductInterestSearchResult,\n  ProductInterestEntryRelation,\n  NotificationType,\n} from '../../../model/product-interest.model';\nimport { OccConfig } from '../../config/occ-config';\nimport { ConverterService } from '../../../util/converter.service';\nimport { PRODUCT_INTERESTS_NORMALIZER } from '../../../user/connectors/interests/converters';\n\nconst headers = new HttpHeaders({\n  'Content-Type': 'application/json',\n});\n\n@Injectable()\nexport class OccUserInterestsAdapter implements UserInterestsAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected config: OccConfig,\n    protected converter: ConverterService\n  ) {}\n\n  public getInterests(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string,\n    productCode?: string,\n    notificationType?: NotificationType\n  ): Observable<ProductInterestSearchResult> {\n    let params = new HttpParams().set('sort', sort ? sort : 'name:asc');\n    if (pageSize) {\n      params = params.set('pageSize', pageSize.toString());\n    }\n    if (currentPage) {\n      params = params.set('currentPage', currentPage.toString());\n    }\n    if (productCode) {\n      params = params.set('productCode', productCode);\n    }\n    if (notificationType) {\n      params = params.set('notificationType', notificationType.toString());\n    }\n\n    return this.http\n      .get(this.occEndpoints.getUrl('getProductInterests', { userId }), {\n        headers,\n        params,\n      })\n      .pipe(\n        this.converter.pipeable(PRODUCT_INTERESTS_NORMALIZER),\n        catchError((error: any) => throwError(error))\n      );\n  }\n\n  public removeInterest(\n    userId: string,\n    item: ProductInterestEntryRelation\n  ): Observable<any[]> {\n    const r: Observable<any>[] = [];\n    item.productInterestEntry.forEach((entry: any) => {\n      const params: HttpParams = new HttpParams()\n        .set('productCode', item.product.code)\n        .set('notificationType', entry.interestType);\n      r.push(\n        this.http\n          .delete(this.occEndpoints.getUrl('productInterests', { userId }), {\n            params: params,\n          })\n          .pipe(catchError((error: any) => throwError(error)))\n      );\n    });\n    return forkJoin(r);\n  }\n\n  public addInterest(\n    userId: string,\n    productCode: string,\n    notificationType: NotificationType\n  ): Observable<any> {\n    const params = new HttpParams()\n      .set('productCode', productCode)\n      .set('notificationType', notificationType.toString());\n    return this.http\n      .post(\n        this.occEndpoints.getUrl('productInterests', { userId }),\n        {},\n        {\n          headers,\n          params,\n        }\n      )\n      .pipe(catchError((error: any) => throwError(error)));\n  }\n}\n","import { Observable } from 'rxjs';\nimport {\n  ProductInterestSearchResult,\n  ProductInterestEntryRelation,\n  NotificationType,\n} from '../../../model/product-interest.model';\n\nexport abstract class UserInterestsAdapter {\n  /**\n   * Abstract method used to load product interests for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param pageSize\n   * @param currentPage\n   * @param sort Sorting method\n   * @param productCode The product code\n   * @param  notificationType The notification type\n   */\n  abstract getInterests(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string,\n    productCode?: string,\n    notificationType?: NotificationType\n  ): Observable<ProductInterestSearchResult>;\n\n  /**\n   * Abstract method used to remove product interest for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param ProductInterestRelation The product interest to be removed.\n   */\n  abstract removeInterest(\n    userId: string,\n    item: ProductInterestEntryRelation\n  ): Observable<any[]>;\n\n  /**\n   * Abstract method to add a product interest for an user.\n   *\n   * @param userId The `userId` for given user\n   * @param productCode The product code\n   * @param notificationType The notification type\n   */\n  abstract addInterest(\n    userId: string,\n    productCode: string,\n    notificationType: NotificationType\n  ): Observable<any>;\n}\n","import { Injectable } from '@angular/core';\nimport { Occ } from '../../../occ-models/occ.models';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { ProductInterestSearchResult } from '../../../../model/product-interest.model';\n\n@Injectable({ providedIn: 'root' })\nexport class OccUserInterestsNormalizer\n  implements\n    Converter<Occ.ProductInterestSearchResult, ProductInterestSearchResult> {\n  constructor(private converter: ConverterService) {}\n\n  convert(\n    source: Occ.ProductInterestSearchResult,\n    target?: ProductInterestSearchResult\n  ): ProductInterestSearchResult {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n    if (source && source.results) {\n      target.results = source.results.map(result => ({\n        ...result,\n        product: this.converter.convert(result.product, PRODUCT_NORMALIZER),\n      }));\n    }\n\n    return target;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Occ } from '../../../occ-models/occ.models';\nimport {\n  Converter,\n  ConverterService,\n} from '../../../../util/converter.service';\nimport { OrderEntry, ReturnRequest } from '../../../../model/order.model';\nimport { PRODUCT_NORMALIZER } from '../../../../product/connectors/product/converters';\n\n@Injectable({ providedIn: 'root' })\nexport class OccReturnRequestNormalizer\n  implements Converter<Occ.ReturnRequest, ReturnRequest> {\n  constructor(private converter: ConverterService) {}\n\n  convert(source: Occ.ReturnRequest, target?: ReturnRequest): ReturnRequest {\n    if (target === undefined) {\n      target = { ...(source as any) };\n    }\n\n    if (source.returnEntries) {\n      target.returnEntries = source.returnEntries.map(entry => ({\n        ...entry,\n        orderEntry: this.convertOrderEntry(entry.orderEntry),\n      }));\n    }\n\n    return target;\n  }\n\n  private convertOrderEntry(source: Occ.OrderEntry): OrderEntry {\n    return {\n      ...source,\n      product: this.converter.convert(source.product, PRODUCT_NORMALIZER),\n    };\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { AnonymousConsentTemplatesAdapter } from '../../../anonymous-consents/connectors/anonymous-consent-templates.adapter';\nimport { provideDefaultConfig } from '../../../config/config.module';\nimport { UserAddressAdapter } from '../../../user/connectors/address/user-address.adapter';\nimport { UserConsentAdapter } from '../../../user/connectors/consent/user-consent.adapter';\nimport { UserOrderAdapter } from '../../../user/connectors/order/user-order.adapter';\nimport { UserPaymentAdapter } from '../../../user/connectors/payment/user-payment.adapter';\nimport { UserAdapter } from '../../../user/connectors/user/user.adapter';\nimport { defaultOccUserConfig } from './default-occ-user-config';\nimport { OccAnonymousConsentTemplatesAdapter } from './occ-anonymous-consent-templates.adapter';\nimport { OccUserAddressAdapter } from './occ-user-address.adapter';\nimport { OccUserConsentAdapter } from './occ-user-consent.adapter';\nimport { OccUserOrderAdapter } from './occ-user-order.adapter';\nimport { OccUserPaymentAdapter } from './occ-user-payment.adapter';\nimport { OccUserAdapter } from './occ-user.adapter';\nimport { CustomerCouponAdapter } from '../../../user/connectors/customer-coupon/customer-coupon.adapter';\nimport { OccCustomerCouponAdapter } from '../user/occ-customer-coupon.adapter';\nimport { UserNotificationPreferenceAdapter } from '../../../user/connectors/notification-preference/user-notification-preference.adapter';\nimport { OccUserNotificationPreferenceAdapter } from './occ-user-notification-preference.adapter';\nimport { OccUserInterestsAdapter } from './occ-user-interests.adapter';\nimport { UserInterestsAdapter } from '../../../user/connectors/interests/user-interests.adapter';\nimport { OccUserInterestsNormalizer } from './converters/occ-user-interests-normalizer';\nimport { PRODUCT_INTERESTS_NORMALIZER } from '../../../user/connectors/interests/converters';\nimport { ORDER_RETURN_REQUEST_NORMALIZER } from '../../../user/connectors/order/converters';\nimport { OccReturnRequestNormalizer } from './converters/index';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  providers: [\n    provideDefaultConfig(defaultOccUserConfig),\n    { provide: UserAdapter, useClass: OccUserAdapter },\n    { provide: UserAddressAdapter, useClass: OccUserAddressAdapter },\n    { provide: UserConsentAdapter, useClass: OccUserConsentAdapter },\n    {\n      provide: AnonymousConsentTemplatesAdapter,\n      useClass: OccAnonymousConsentTemplatesAdapter,\n    },\n    {\n      provide: UserPaymentAdapter,\n      useClass: OccUserPaymentAdapter,\n    },\n    { provide: UserOrderAdapter, useClass: OccUserOrderAdapter },\n    { provide: CustomerCouponAdapter, useClass: OccCustomerCouponAdapter },\n    {\n      provide: UserNotificationPreferenceAdapter,\n      useClass: OccUserNotificationPreferenceAdapter,\n    },\n    { provide: UserInterestsAdapter, useClass: OccUserInterestsAdapter },\n    {\n      provide: PRODUCT_INTERESTS_NORMALIZER,\n      useExisting: OccUserInterestsNormalizer,\n      multi: true,\n    },\n    {\n      provide: ORDER_RETURN_REQUEST_NORMALIZER,\n      useExisting: OccReturnRequestNormalizer,\n      multi: true,\n    },\n  ],\n})\nexport class UserOccModule {}\n","import { Injectable, isDevMode } from '@angular/core';\n\n@Injectable({ providedIn: 'root' })\nexport class JavaRegExpConverter {\n  /**\n   * Pattern that extracts modifiers from the Java regexp.\n   *\n   * Java regexps MAY start with ONE or MANY modifiers like `(?MODIFIERS)PATTERN`. Examples:\n   * - `(?i)` for Case Insensitive Mode: `(?i)PATTERN`\n   * - `(?u)` for Unicode-Aware Case Folding; `(?u)PATTERN`\n   * - or multiple combined:  `(?iu)PATTERN`\n   * - (more modifiers in the official Java docs https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html)\n   *\n   * This pattern extracts 3 parts from the input string, i.e. for `(?iu)PATTERN`:\n   *    1. original modifiers syntax, i.e. `(?iu)` (or undefined if no modifiers present)\n   *    2. extracted modifiers, i.e. `iu` (or undefined if no modifiers present)\n   *    3. the rest of the regexp, i.e. `PATTERN`\n   */\n  private readonly EXTRACT_JAVA_REGEXP_MODIFIERS: RegExp = /^(\\(\\?([a-z]+)\\))?(.*)/;\n\n  /**\n   * Converts RegExp from Java syntax to Javascript, by recognizing Java regexp modifiers\n   * and converting them to the Javascript ones (i.e. case insensitive mode: `(?i)PATTERN` -> `/pattern/i`)\n   *\n   * **CAUTION!** Not all features and modifiers of Java regexps are valid in Javascript!\n   * If unsupported feature or modifier is used, then `null` will be returned instead of Javascript RegExp.\n   *\n   * See differences between Java and Javascript regexps:\n   * - https://stackoverflow.com/questions/8754444/convert-javascript-regular-expression-to-java-syntax\n   * - https://en.wikipedia.org/wiki/Comparison_of_regular_expression_engines#Language_features\n   */\n  toJsRegExp(javaSyntax: string): RegExp {\n    const parts = javaSyntax.match(this.EXTRACT_JAVA_REGEXP_MODIFIERS);\n    if (!parts) {\n      return null;\n    }\n    const [, , modifiers, jsSyntax] = parts;\n    try {\n      return new RegExp(jsSyntax, modifiers);\n    } catch (error) {\n      if (isDevMode()) {\n        console.warn(\n          `WARNING: Could not convert Java regexp into Javascript. Original regexp: ${javaSyntax} \\nMessage: ${error}`\n        );\n      }\n      return null;\n    }\n  }\n}\n","import { InjectionToken } from '@angular/core';\n\nexport const CONFIG_INITIALIZER = new InjectionToken('ConfigInitializer');\n\n/**\n * Used to provide asynchronous config during app initialization\n */\nexport interface ConfigInitializer {\n  /**\n   * List of config parts that are resolved by configFactory, e.g.:\n   * 'context.baseSite', 'context.language'\n   */\n  scopes: string[];\n  /**\n   * Promise that returns config chunk\n   */\n  configFactory: () => Promise<any>;\n}\n\nexport const CONFIG_INITIALIZER_FORROOT_GUARD = new InjectionToken<void>(\n  'CONFIG_INITIALIZER_FORROOT_GUARD'\n);\n","import { InjectionToken } from '@angular/core';\n\n/**\n * The url of the server request when running SSR\n * */\nexport const SERVER_REQUEST_URL = new InjectionToken<string>(\n  'SERVER_REQUEST_URL'\n);\n\n/**\n * The url of the server request host when running SSR\n * */\nexport const SERVER_REQUEST_ORIGIN = new InjectionToken<string>(\n  'SERVER_REQUEST_ORIGIN'\n);\n","import { Injectable } from '@angular/core';\nimport { I18nConfig } from '../../i18n';\nimport { BaseSite } from '../../model/misc.model';\nimport { SiteContextConfig } from '../../site-context/config/site-context-config';\nimport {\n  BASE_SITE_CONTEXT_ID,\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from '../../site-context/providers/context-ids';\nimport { Occ } from '../occ-models/occ.models';\nimport { JavaRegExpConverter } from './java-reg-exp-converter';\nimport { OccLoadedConfig } from './occ-loaded-config';\n\n@Injectable({ providedIn: 'root' })\nexport class OccLoadedConfigConverter {\n  constructor(private javaRegExpConverter: JavaRegExpConverter) {}\n\n  fromOccBaseSites(baseSites: BaseSite[], currentUrl: string): OccLoadedConfig {\n    const baseSite = baseSites.find(site =>\n      this.isCurrentBaseSite(site, currentUrl)\n    );\n    if (!baseSite) {\n      throw this.getError(\n        `Current url (${currentUrl}) doesn't match with any of url patterns of any base site.`\n      );\n    }\n\n    // Although `stores` property is an array, typically there is only one store. So we return the first store from the list.\n    const baseStore = baseSite.stores && baseSite.stores[0];\n    if (!baseStore) {\n      throw this.getError(\n        `Current base site (${baseSite.uid}) doesn't have any base store.`\n      );\n    }\n\n    return {\n      baseSite: baseSite.uid,\n      languages: this.getIsoCodes(\n        baseStore.languages,\n        baseSite.defaultLanguage || baseStore.defaultLanguage\n      ),\n      currencies: this.getIsoCodes(\n        baseStore.currencies,\n        baseStore.defaultCurrency\n      ),\n      urlParameters: this.getUrlParams(baseSite.urlEncodingAttributes),\n    };\n  }\n\n  toSiteContextConfig({\n    baseSite,\n    languages,\n    currencies,\n    urlParameters: urlEncodingAttributes,\n  }: OccLoadedConfig): SiteContextConfig {\n    const result = {\n      context: {\n        urlParameters: urlEncodingAttributes,\n        [BASE_SITE_CONTEXT_ID]: [baseSite],\n        [LANGUAGE_CONTEXT_ID]: languages,\n        [CURRENCY_CONTEXT_ID]: currencies,\n      },\n    };\n    return result;\n  }\n\n  toI18nConfig({ languages }: OccLoadedConfig): I18nConfig {\n    return { i18n: { fallbackLang: languages[0] } };\n  }\n\n  private isCurrentBaseSite(site: Occ.BaseSite, currentUrl: string): boolean {\n    const index = (site.urlPatterns || []).findIndex(javaRegexp => {\n      const jsRegexp = this.javaRegExpConverter.toJsRegExp(javaRegexp);\n      if (jsRegexp) {\n        const result = jsRegexp.test(currentUrl);\n        return result;\n      }\n    });\n\n    return index !== -1;\n  }\n\n  /**\n   * Returns an array of url encoded site context parameters.\n   *\n   * It maps the string \"storefront\" (used in OCC) to the \"baseSite\" (used in Spartacus)\n   */\n  private getUrlParams(params: string[]): string[] {\n    const STOREFRONT_PARAM = 'storefront';\n\n    return (params || []).map(param =>\n      param === STOREFRONT_PARAM ? BASE_SITE_CONTEXT_ID : param\n    );\n  }\n\n  /**\n   * Returns iso codes in a array, where the first element is the default iso code.\n   */\n  private getIsoCodes(\n    elements: { isocode?: string }[],\n    defaultElement: { isocode?: string }\n  ) {\n    const result = this.moveToFirst(\n      elements,\n      el => el.isocode === defaultElement.isocode\n    ).map(el => el.isocode);\n    return result;\n  }\n\n  /**\n   * Moves to the start of the array the first element that satisfies the given predicate.\n   *\n   * @param array array to modify\n   * @param predicate function called on elements\n   */\n  private moveToFirst(array: any[], predicate: (el: any) => boolean): any[] {\n    array = [...array];\n    const index = array.findIndex(predicate);\n    if (index !== -1) {\n      const [el] = array.splice(index, 1);\n      array.unshift(el);\n    }\n    return array;\n  }\n\n  private getError(message: string): Error {\n    return new Error(`Error: Cannot get base site config! ${message}`);\n  }\n}\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { BaseSite } from '../../model/misc.model';\nimport { OccConfig } from '../config/occ-config';\nimport { Occ } from '../occ-models/occ.models';\n\n@Injectable({ providedIn: 'root' })\nexport class OccSitesConfigLoader {\n  constructor(protected config: OccConfig, protected http: HttpClient) {}\n\n  protected readonly endpoint =\n    'basesites?fields=baseSites(uid,defaultLanguage(isocode),urlEncodingAttributes,urlPatterns,stores(currencies(isocode),defaultCurrency(isocode),languages(isocode),defaultLanguage(isocode)))';\n\n  private get baseEndpoint(): string {\n    return (\n      (this.config.backend.occ.baseUrl || '') + this.config.backend.occ.prefix\n    );\n  }\n\n  private get url(): string {\n    return `${this.baseEndpoint}${this.endpoint}`;\n  }\n\n  load(): Observable<BaseSite[]> {\n    if (!this.config || !this.config.backend || !this.config.backend.occ) {\n      return throwError(new Error(`Missing config for OCC backend!`));\n    }\n\n    return this.http\n      .get<Occ.BaseSites>(this.url)\n      .pipe(map(({ baseSites }) => baseSites));\n  }\n}\n","import { DOCUMENT, isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport {\n  Inject,\n  Injectable,\n  isDevMode,\n  Optional,\n  PLATFORM_ID,\n} from '@angular/core';\nimport {\n  makeStateKey,\n  StateKey,\n  TransferState,\n} from '@angular/platform-browser';\nimport { Observable, of } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { Config } from '../../config/config.module';\nimport { deepMerge } from '../../config/utils/deep-merge';\nimport { I18nConfig } from '../../i18n/config/i18n-config';\nimport { SiteContextConfig } from '../../site-context/config/site-context-config';\nimport { SERVER_REQUEST_URL } from '../../ssr/ssr.providers';\nimport { OccLoadedConfig } from './occ-loaded-config';\nimport { OccLoadedConfigConverter } from './occ-loaded-config-converter';\nimport { OccSitesConfigLoader } from './occ-sites-config-loader';\n\nexport const EXTERNAL_CONFIG_TRANSFER_ID: StateKey<string> = makeStateKey<\n  string\n>('cx-external-config');\n\n@Injectable({ providedIn: 'root' })\nexport class OccConfigLoaderService {\n  constructor(\n    @Inject(PLATFORM_ID) protected platform: any,\n    @Inject(DOCUMENT) protected document: any,\n    @Inject(Config) protected config: any,\n    protected sitesConfigLoader: OccSitesConfigLoader,\n    protected converter: OccLoadedConfigConverter,\n    @Optional() protected transferState: TransferState,\n\n    @Optional()\n    @Inject(SERVER_REQUEST_URL)\n    protected serverRequestUrl?: string\n  ) {}\n\n  private get currentUrl(): string {\n    if (isPlatformBrowser(this.platform)) {\n      return this.document.location.href;\n    }\n    if (this.serverRequestUrl) {\n      return this.serverRequestUrl;\n    }\n    if (isDevMode()) {\n      console.error(\n        `Please provide token 'SERVER_REQUEST_URL' with the requested URL for SSR`\n      );\n    }\n  }\n\n  /**\n   * Initializes the Spartacus config asynchronously basing on the external config\n   */\n  loadConfig(): Promise<I18nConfig | SiteContextConfig> {\n    return this.get()\n      .pipe(\n        tap(externalConfig => this.transfer(externalConfig)),\n        map(externalConfig =>\n          deepMerge({}, ...this.getConfigChunks(externalConfig))\n        )\n      )\n      .toPromise();\n  }\n\n  /**\n   * Returns the external config\n   */\n  protected get(): Observable<OccLoadedConfig> {\n    const rehydratedExternalConfig = this.rehydrate();\n\n    return rehydratedExternalConfig\n      ? of(rehydratedExternalConfig)\n      : this.load();\n  }\n\n  /**\n   * Loads the external config from backend\n   */\n  protected load(): Observable<OccLoadedConfig> {\n    return this.sitesConfigLoader\n      .load()\n      .pipe(\n        map(baseSites =>\n          this.converter.fromOccBaseSites(baseSites, this.currentUrl)\n        )\n      );\n  }\n\n  /**\n   * Tries to rehydrate external config in the browser from SSR\n   */\n  protected rehydrate(): OccLoadedConfig {\n    if (this.transferState && isPlatformBrowser(this.platform)) {\n      return this.transferState.get(EXTERNAL_CONFIG_TRANSFER_ID, undefined);\n    }\n  }\n\n  /**\n   * Transfers the given external config in SSR to the browser\n   *\n   * @param externalConfig\n   */\n  protected transfer(externalConfig: OccLoadedConfig) {\n    if (\n      this.transferState &&\n      isPlatformServer(this.platform) &&\n      externalConfig\n    ) {\n      this.transferState.set(EXTERNAL_CONFIG_TRANSFER_ID, externalConfig);\n    }\n  }\n\n  protected getConfigChunks(\n    externalConfig: OccLoadedConfig\n  ): (I18nConfig | SiteContextConfig)[] {\n    const chunks: any[] = [this.converter.toSiteContextConfig(externalConfig)];\n\n    if (this.shouldReturnI18nChunk()) {\n      chunks.push(this.converter.toI18nConfig(externalConfig));\n    }\n\n    return chunks;\n  }\n\n  private shouldReturnI18nChunk(): boolean {\n    const fallbackLangExists =\n      typeof (\n        this.config &&\n        this.config.i18n &&\n        this.config.i18n.fallbackLang\n      ) !== 'undefined';\n    if (fallbackLangExists && isDevMode()) {\n      console.warn(\n        `There is an already provided static config for 'i18n.fallbackLang', so the value from OCC loaded config is ignored.`\n      );\n    }\n    return !fallbackLangExists;\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport {\n  ConfigInitializer,\n  CONFIG_INITIALIZER,\n} from '../../config/config-initializer/config-initializer';\nimport { SiteContextConfig } from '../../site-context/config/site-context-config';\nimport { BASE_SITE_CONTEXT_ID } from '../../site-context/providers/context-ids';\nimport { OccConfigLoaderService } from './occ-config-loader.service';\n\n/**\n * Initializes the Spartacus config asynchronously basing on the external config\n */\nexport function initConfig(\n  configLoader: OccConfigLoaderService,\n  config: SiteContextConfig\n): ConfigInitializer {\n  /**\n   * Load config for `context` from backend only when there is no static config for `context.baseSite`\n   */\n  if (!config.context || !config.context[BASE_SITE_CONTEXT_ID]) {\n    return {\n      scopes: ['context', 'i18n.fallbackLang'],\n      configFactory: () => configLoader.loadConfig(),\n    };\n  }\n  return null;\n}\n\n/**\n * Re-provides the external config chunk given before Angular bootstrap\n */\n@NgModule()\nexport class OccConfigLoaderModule {\n  static forRoot(): ModuleWithProviders<OccConfigLoaderModule> {\n    return {\n      ngModule: OccConfigLoaderModule,\n      providers: [\n        {\n          provide: CONFIG_INITIALIZER,\n          useFactory: initConfig,\n          deps: [OccConfigLoaderService, SiteContextConfig],\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import { Provider } from '@angular/core';\nimport { Meta } from '@angular/platform-browser';\nimport { provideConfigFactory } from '../../config/config.module';\nimport { OccConfig } from './occ-config';\n\nexport const OCC_BASE_URL_META_TAG_NAME = 'occ-backend-base-url';\nexport const OCC_BASE_URL_META_TAG_PLACEHOLDER = 'OCC_BACKEND_BASE_URL_VALUE';\nexport const MEDIA_BASE_URL_META_TAG_NAME = 'media-backend-base-url';\nexport const MEDIA_BASE_URL_META_TAG_PLACEHOLDER =\n  'MEDIA_BACKEND_BASE_URL_VALUE';\n\nexport function occServerConfigFromMetaTagFactory(meta: Meta): OccConfig {\n  const baseUrl = getMetaTagContent(OCC_BASE_URL_META_TAG_NAME, meta);\n  return baseUrl && baseUrl !== OCC_BASE_URL_META_TAG_PLACEHOLDER\n    ? { backend: { occ: { baseUrl } } }\n    : {};\n}\n\nexport function mediaServerConfigFromMetaTagFactory(meta: Meta): OccConfig {\n  const baseUrl = getMetaTagContent(MEDIA_BASE_URL_META_TAG_NAME, meta);\n  return baseUrl && baseUrl !== MEDIA_BASE_URL_META_TAG_PLACEHOLDER\n    ? { backend: { media: { baseUrl } } }\n    : {};\n}\n\nfunction getMetaTagContent(name: string, meta: Meta) {\n  const metaTag = meta.getTag(`name=\"${name}\"`);\n  return metaTag && metaTag.content;\n}\n\nexport function provideConfigFromMetaTags(): Provider[] {\n  return [\n    provideConfigFactory(occServerConfigFromMetaTagFactory, [Meta]),\n    provideConfigFactory(mediaServerConfigFromMetaTagFactory, [Meta]),\n  ];\n}\n","export namespace Occ {\n  /**\n   *\n   * An interface representing Country.\n   */\n  export interface Country {\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing Region.\n   */\n  export interface Region {\n    /**\n     * @member {string} [countryIso]\n     */\n    countryIso?: string;\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [isocodeShort]\n     */\n    isocodeShort?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing RegionList.\n   */\n  export interface RegionList {\n    /**\n     * @member {Region[]} [regions]\n     */\n    regions?: Region[];\n  }\n\n  /**\n   *\n   * An interface representing Address.\n   */\n  export interface Address {\n    /**\n     * @member {string} [companyName]\n     */\n    companyName?: string;\n    /**\n     * @member {Country} [country]\n     */\n    country?: Country;\n    /**\n     * @member {boolean} [defaultAddress]\n     */\n    defaultAddress?: boolean;\n    /**\n     * @member {string} [email]\n     */\n    email?: string;\n    /**\n     * @member {string} [firstName]\n     */\n    firstName?: string;\n    /**\n     * @member {string} [formattedAddress]\n     */\n    formattedAddress?: string;\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {string} [lastName]\n     */\n    lastName?: string;\n    /**\n     * @member {string} [line1]\n     */\n    line1?: string;\n    /**\n     * @member {string} [line2]\n     */\n    line2?: string;\n    /**\n     * @member {string} [phone]\n     */\n    phone?: string;\n    /**\n     * @member {string} [postalCode]\n     */\n    postalCode?: string;\n    /**\n     * @member {Region} [region]\n     */\n    region?: Region;\n    /**\n     * @member {boolean} [shippingAddress]\n     */\n    shippingAddress?: boolean;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n    /**\n     * @member {string} [titleCode]\n     */\n    titleCode?: string;\n    /**\n     * @member {string} [town]\n     */\n    town?: string;\n    /**\n     * @member {boolean} [visibleInAddressBook]\n     */\n    visibleInAddressBook?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing AddressList.\n   */\n  export interface AddressList {\n    /**\n     * @member {Address[]} [addresses]\n     */\n    addresses?: Address[];\n  }\n\n  /**\n   *\n   * An interface representing ErrorModel.\n   * Error message\n   *\n   */\n  export interface ErrorModel {\n    /**\n     * @member {string} [message] Descriptive, human readable error message.\n     */\n    message?: string;\n    /**\n     * @member {string} [reason] Additional classification specific for each\n     * error type e.g. 'noStock'.\n     */\n    reason?: string;\n    /**\n     * @member {string} [subject] Identifier of the related object e.g. '1'.\n     */\n    subject?: string;\n    /**\n     * @member {string} [subjectType] Type of the object related to the error\n     * e.g. 'entry'.\n     */\n    subjectType?: string;\n    /**\n     * @member {string} [type] Type of the error e.g. 'LowStockError'.\n     */\n    type?: string;\n  }\n\n  /**\n   *\n   * An interface representing ErrorList.\n   * List of errors\n   *\n   */\n  export interface ErrorList {\n    /**\n     * @member {ErrorModel[]} [errors]\n     */\n    errors?: ErrorModel[];\n  }\n\n  /**\n   *\n   * An interface representing AddressValidation.\n   */\n  export interface AddressValidation {\n    /**\n     * @member {string} [decision]\n     */\n    decision?: string;\n    /**\n     * @member {ErrorList} [errors]\n     */\n    errors?: ErrorList;\n    /**\n     * @member {Address[]} [suggestedAddresses]\n     */\n    suggestedAddresses?: Address[];\n  }\n\n  /**\n   *\n   * An interface representing Price.\n   */\n  export interface Price {\n    /**\n     * @member {string} [currencyIso]\n     */\n    currencyIso?: string;\n    /**\n     * @member {string} [formattedValue]\n     */\n    formattedValue?: string;\n    /**\n     * @member {number} [maxQuantity]\n     */\n    maxQuantity?: number;\n    /**\n     * @member {number} [minQuantity]\n     */\n    minQuantity?: number;\n    /**\n     * @member {PriceType} [priceType] Possible values include: 'BUY', 'FROM'\n     */\n    priceType?: PriceType;\n    /**\n     * @member {number} [value]\n     */\n    value?: number;\n  }\n\n  /**\n   *\n   * An interface representing Stock.\n   */\n  export interface Stock {\n    /**\n     * @member {number} [stockLevel]\n     */\n    stockLevel?: number;\n    /**\n     * @member {string} [stockLevelStatus]\n     */\n    stockLevelStatus?: string;\n  }\n\n  /**\n   *\n   * An interface representing Image.\n   */\n  export interface Image {\n    /**\n     * @member {string} [altText]\n     */\n    altText?: string;\n    /**\n     * @member {string} [format]\n     */\n    format?: string;\n    /**\n     * @member {number} [galleryIndex]\n     */\n    galleryIndex?: number;\n    /**\n     * @member {ImageType} [imageType] Possible values include: 'PRIMARY',\n     * 'GALLERY'\n     */\n    imageType?: ImageType;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing VariantOptionQualifier.\n   */\n  export interface VariantOptionQualifier {\n    /**\n     * @member {Image} [image]\n     */\n    image?: Image;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [qualifier]\n     */\n    qualifier?: string;\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing VariantOption.\n   */\n  export interface VariantOption {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Price} [priceData]\n     */\n    priceData?: Price;\n    /**\n     * @member {Stock} [stock]\n     */\n    stock?: Stock;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n    /**\n     * @member {VariantOptionQualifier[]} [variantOptionQualifiers]\n     */\n    variantOptionQualifiers?: VariantOptionQualifier[];\n  }\n\n  /**\n   *\n   * An interface representing BaseOption.\n   */\n  export interface BaseOption {\n    /**\n     * @member {VariantOption[]} [options]\n     */\n    options?: VariantOption[];\n    /**\n     * @member {VariantOption} [selected]\n     */\n    selected?: VariantOption;\n    /**\n     * @member {string} [variantType]\n     */\n    variantType?: string;\n  }\n\n  /**\n   *\n   * An interface representing SearchQuery.\n   */\n  export interface SearchQuery {\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing SearchState.\n   */\n  export interface SearchState {\n    /**\n     * @member {SearchQuery} [query]\n     */\n    query?: SearchQuery;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing Breadcrumb.\n   */\n  export interface Breadcrumb {\n    /**\n     * @member {string} [facetCode]\n     */\n    facetCode?: string;\n    /**\n     * @member {string} [facetName]\n     */\n    facetName?: string;\n    /**\n     * @member {string} [facetValueCode]\n     */\n    facetValueCode?: string;\n    /**\n     * @member {string} [facetValueName]\n     */\n    facetValueName?: string;\n    /**\n     * @member {SearchState} [removeQuery]\n     */\n    removeQuery?: SearchState;\n    /**\n     * @member {SearchState} [truncateQuery]\n     */\n    truncateQuery?: SearchState;\n  }\n\n  /**\n   *\n   * An interface representing Component.\n   */\n  export interface Component {\n    /**\n     * @member {Date} [modifiedTime]\n     */\n    modifiedTime?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {any} [otherProperties]\n     */\n    otherProperties?: any;\n    /**\n     * @member {string} [typeCode]\n     */\n    typeCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing ComponentList.\n   */\n  export interface ComponentList {\n    /**\n     * @member {Component[]} [component]\n     */\n    component?: Component[] | any[];\n  }\n\n  /**\n   *\n   * An interface representing ContentSlot.\n   */\n  export interface ContentSlot {\n    /**\n     * @member {ComponentList} [components]\n     */\n    components?: ComponentList;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [position]\n     */\n    position?: string;\n    /**\n     * @member {string} [slotId]\n     */\n    slotId?: string;\n    /**\n     * @member {boolean} [slotShared]\n     */\n    slotShared?: boolean;\n    /**\n     * @member {string} [slotStatus]\n     */\n    slotStatus?: string;\n  }\n\n  /**\n   *\n   * An interface representing ContentSlotList.\n   */\n  export interface ContentSlotList {\n    /**\n     * @member {ContentSlot[]} [contentSlot]\n     */\n    contentSlot?: ContentSlot[];\n  }\n\n  /**\n   *\n   * An interface representing CMSPage.\n   */\n  export interface CMSPage {\n    /**\n     * @member {ContentSlotList} [contentSlots]\n     */\n    contentSlots?: ContentSlotList;\n    /**\n     * @member {boolean} [defaultPage]\n     */\n    defaultPage?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [template]\n     */\n    template?: string;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n    /**\n     * @member {string} [typeCode]\n     */\n    typeCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing CardType.\n   */\n  export interface CardType {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing CardTypeList.\n   */\n  export interface CardTypeList {\n    /**\n     * @member {CardType[]} [cardTypes]\n     */\n    cardTypes?: CardType[];\n  }\n\n  /**\n   *\n   * An interface representing PromotionOrderEntryConsumed.\n   */\n  export interface PromotionOrderEntryConsumed {\n    /**\n     * @member {number} [adjustedUnitPrice]\n     */\n    adjustedUnitPrice?: number;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {number} [orderEntryNumber]\n     */\n    orderEntryNumber?: number;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n  }\n\n  /**\n   *\n   * An interface representing PromotionRestriction.\n   */\n  export interface PromotionRestriction {\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [restrictionType]\n     */\n    restrictionType?: string;\n  }\n\n  /**\n   *\n   * An interface representing Promotion.\n   */\n  export interface Promotion {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string[]} [couldFireMessages]\n     */\n    couldFireMessages?: string[];\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [enabled]\n     */\n    enabled?: boolean;\n    /**\n     * @member {Date} [endDate]\n     */\n    endDate?: Date;\n    /**\n     * @member {string[]} [firedMessages]\n     */\n    firedMessages?: string[];\n    /**\n     * @member {number} [priority]\n     */\n    priority?: number;\n    /**\n     * @member {Image} [productBanner]\n     */\n    productBanner?: Image;\n    /**\n     * @member {string} [promotionGroup]\n     */\n    promotionGroup?: string;\n    /**\n     * @member {string} [promotionType]\n     */\n    promotionType?: string;\n    /**\n     * @member {PromotionRestriction[]} [restrictions]\n     */\n    restrictions?: PromotionRestriction[];\n    /**\n     * @member {Date} [startDate]\n     */\n    startDate?: Date;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n  }\n\n  /**\n   *\n   * An interface representing PromotionResult.\n   */\n  export interface PromotionResult {\n    /**\n     * @member {PromotionOrderEntryConsumed[]} [consumedEntries]\n     */\n    consumedEntries?: PromotionOrderEntryConsumed[];\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {Promotion} [promotion]\n     */\n    promotion?: Promotion;\n  }\n\n  /**\n   *\n   * An interface representing Currency.\n   */\n  export interface Currency {\n    /**\n     * @member {boolean} [active]\n     */\n    active?: boolean;\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [symbol]\n     */\n    symbol?: string;\n  }\n\n  /**\n   *\n   * An interface representing Voucher.\n   */\n  export interface Voucher {\n    /**\n     * @member {Price} [appliedValue]\n     */\n    appliedValue?: Price;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Currency} [currency]\n     */\n    currency?: Currency;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [freeShipping]\n     */\n    freeShipping?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [value]\n     */\n    value?: number;\n    /**\n     * @member {string} [valueFormatted]\n     */\n    valueFormatted?: string;\n    /**\n     * @member {string} [valueString]\n     */\n    valueString?: string;\n    /**\n     * @member {string} [voucherCode]\n     */\n    voucherCode?: string;\n  }\n\n  /**\n   *\n   * An interface representing DeliveryMode.\n   */\n  export interface DeliveryMode {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing GeoPoint.\n   */\n  export interface GeoPoint {\n    /**\n     * @member {number} [latitude]\n     */\n    latitude?: number;\n    /**\n     * @member {number} [longitude]\n     */\n    longitude?: number;\n  }\n\n  /**\n   *\n   * An interface representing Time.\n   */\n  export interface Time {\n    /**\n     * @member {string} [formattedHour]\n     */\n    formattedHour?: string;\n    /**\n     * @member {number} [hour]\n     */\n    hour?: number;\n    /**\n     * @member {number} [minute]\n     */\n    minute?: number;\n  }\n\n  /**\n   *\n   * An interface representing SpecialOpeningDay.\n   */\n  export interface SpecialOpeningDay {\n    /**\n     * @member {boolean} [closed]\n     */\n    closed?: boolean;\n    /**\n     * @member {Time} [closingTime]\n     */\n    closingTime?: Time;\n    /**\n     * @member {string} [comment]\n     */\n    comment?: string;\n    /**\n     * @member {Date} [date]\n     */\n    date?: Date;\n    /**\n     * @member {string} [formattedDate]\n     */\n    formattedDate?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {Time} [openingTime]\n     */\n    openingTime?: Time;\n  }\n\n  /**\n   *\n   * An interface representing WeekdayOpeningDay.\n   */\n  export interface WeekdayOpeningDay {\n    /**\n     * @member {boolean} [closed]\n     */\n    closed?: boolean;\n    /**\n     * @member {Time} [closingTime]\n     */\n    closingTime?: Time;\n    /**\n     * @member {Time} [openingTime]\n     */\n    openingTime?: Time;\n    /**\n     * @member {string} [weekDay]\n     */\n    weekDay?: string;\n  }\n\n  /**\n   *\n   * An interface representing OpeningSchedule.\n   */\n  export interface OpeningSchedule {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {SpecialOpeningDay[]} [specialDayOpeningList]\n     */\n    specialDayOpeningList?: SpecialOpeningDay[];\n    /**\n     * @member {WeekdayOpeningDay[]} [weekDayOpeningList]\n     */\n    weekDayOpeningList?: WeekdayOpeningDay[];\n  }\n\n  /**\n   *\n   * An interface representing PointOfService.\n   */\n  export interface PointOfService {\n    /**\n     * @member {Address} [address]\n     */\n    address?: Address;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [displayName]\n     */\n    displayName?: string;\n    /**\n     * @member {number} [distanceKm]\n     */\n    distanceKm?: number;\n    /**\n     * @member {{ [propertyName: string]: string }} [features]\n     */\n    features?: { [propertyName: string]: string };\n    /**\n     * @member {string} [formattedDistance]\n     */\n    formattedDistance?: string;\n    /**\n     * @member {GeoPoint} [geoPoint]\n     */\n    geoPoint?: GeoPoint;\n    /**\n     * @member {Image} [mapIcon]\n     */\n    mapIcon?: Image;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {OpeningSchedule} [openingHours]\n     */\n    openingHours?: OpeningSchedule;\n    /**\n     * @member {string} [storeContent]\n     */\n    storeContent?: string;\n    /**\n     * @member {Image[]} [storeImages]\n     */\n    storeImages?: Image[];\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing Category.\n   */\n  export interface Category {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [code]\n     */\n    name?: string;\n    /**\n     * @member {Image} [image]\n     */\n    image?: Image;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing FeatureUnit.\n   */\n  export interface FeatureUnit {\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [symbol]\n     */\n    symbol?: string;\n    /**\n     * @member {string} [unitType]\n     */\n    unitType?: string;\n  }\n\n  /**\n   *\n   * An interface representing FeatureValue.\n   */\n  export interface FeatureValue {\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing Feature.\n   */\n  export interface Feature {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {boolean} [comparable]\n     */\n    comparable?: boolean;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {FeatureUnit} [featureUnit]\n     */\n    featureUnit?: FeatureUnit;\n    /**\n     * @member {FeatureValue[]} [featureValues]\n     */\n    featureValues?: FeatureValue[];\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {boolean} [range]\n     */\n    range?: boolean;\n    /**\n     * @member {string} [type]\n     */\n    type?: string;\n  }\n\n  /**\n   *\n   * An interface representing Classification.\n   */\n  export interface Classification {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Feature[]} [features]\n     */\n    features?: Feature[];\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing FutureStock.\n   */\n  export interface FutureStock {\n    /**\n     * @member {Date} [date]\n     */\n    date?: Date;\n    /**\n     * @member {string} [formattedDate]\n     */\n    formattedDate?: string;\n    /**\n     * @member {Stock} [stock]\n     */\n    stock?: Stock;\n  }\n\n  /**\n   *\n   * An interface representing PriceRange.\n   */\n  export interface PriceRange {\n    /**\n     * @member {Price} [maxPrice]\n     */\n    maxPrice?: Price;\n    /**\n     * @member {Price} [minPrice]\n     */\n    minPrice?: Price;\n  }\n\n  /**\n   *\n   * An interface representing ProductReference.\n   */\n  export interface ProductReference {\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [preselected]\n     */\n    preselected?: boolean;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {string} [referenceType]\n     */\n    referenceType?: string;\n    /**\n     * @member {Product} [target]\n     */\n    target?: Product;\n  }\n\n  /**\n   *\n   * An interface representing Language.\n   */\n  export interface Language {\n    /**\n     * @member {boolean} [active]\n     */\n    active?: boolean;\n    /**\n     * @member {string} [isocode]\n     */\n    isocode?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [nativeName]\n     */\n    nativeName?: string;\n  }\n\n  /**\n   *\n   * An interface representing User.\n   */\n  export interface User {\n    /**\n     * @member {Currency} [currency]\n     */\n    currency?: Currency;\n    /**\n     * @member {string} [customerId]\n     */\n    customerId?: string;\n    /**\n     * @member {Date} [deactivationDate]\n     */\n    deactivationDate?: Date;\n    /**\n     * @member {Address} [defaultAddress]\n     */\n    defaultAddress?: Address;\n    /**\n     * @member {string} [displayUid]\n     */\n    displayUid?: string;\n    /**\n     * @member {string} [firstName]\n     */\n    firstName?: string;\n    /**\n     * @member {Language} [language]\n     */\n    language?: Language;\n    /**\n     * @member {string} [lastName]\n     */\n    lastName?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [title]\n     */\n    title?: string;\n    /**\n     * @member {string} [titleCode]\n     */\n    titleCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing Review.\n   */\n  export interface Review {\n    /**\n     * @member {string} [alias]\n     */\n    alias?: string;\n    /**\n     * @member {string} [comment]\n     */\n    comment?: string;\n    /**\n     * @member {Date} [date]\n     */\n    date?: Date;\n    /**\n     * @member {string} [headline]\n     */\n    headline?: string;\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {User} [principal]\n     */\n    principal?: User;\n    /**\n     * @member {number} [rating]\n     */\n    rating?: number;\n  }\n\n  /**\n   *\n   * An interface representing VariantCategory.\n   */\n  export interface VariantCategory {\n    /**\n     * @member {boolean} [hasImage]\n     */\n    hasImage?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [priority]\n     */\n    priority?: number;\n  }\n\n  /**\n   *\n   * An interface representing VariantValueCategory.\n   */\n  export interface VariantValueCategory {\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [sequence]\n     */\n    sequence?: number;\n    /**\n     * @member {VariantCategory[]} [superCategories]\n     */\n    superCategories?: VariantCategory[];\n  }\n\n  /**\n   *\n   * An interface representing VariantMatrixElement.\n   */\n  export interface VariantMatrixElement {\n    /**\n     * @member {VariantMatrixElement[]} [elements]\n     */\n    elements?: VariantMatrixElement[];\n    /**\n     * @member {boolean} [isLeaf]\n     */\n    isLeaf?: boolean;\n    /**\n     * @member {VariantCategory} [parentVariantCategory]\n     */\n    parentVariantCategory?: VariantCategory;\n    /**\n     * @member {VariantOption} [variantOption]\n     */\n    variantOption?: VariantOption;\n    /**\n     * @member {VariantValueCategory} [variantValueCategory]\n     */\n    variantValueCategory?: VariantValueCategory;\n  }\n\n  /**\n   *\n   * An interface representing Product.\n   */\n  export interface Product {\n    /**\n     * @member {boolean} [availableForPickup]\n     */\n    availableForPickup?: boolean;\n    /**\n     * @member {number} [averageRating]\n     */\n    averageRating?: number;\n    /**\n     * @member {BaseOption[]} [baseOptions]\n     */\n    baseOptions?: BaseOption[];\n    /**\n     * @member {string} [baseProduct]\n     */\n    baseProduct?: string;\n    /**\n     * @member {Category[]} [categories]\n     */\n    categories?: Category[];\n    /**\n     * @member {Classification[]} [classifications]\n     */\n    classifications?: Classification[];\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {FutureStock[]} [futureStocks]\n     */\n    futureStocks?: FutureStock[];\n    /**\n     * @member {Image[]} [images]\n     */\n    images?: Image[];\n    /**\n     * @member {string} [manufacturer]\n     */\n    manufacturer?: string;\n    /**\n     * @member {boolean} [multidimensional]\n     */\n    multidimensional?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [numberOfReviews]\n     */\n    numberOfReviews?: number;\n    /**\n     * @member {Promotion[]} [potentialPromotions]\n     */\n    potentialPromotions?: Promotion[];\n    /**\n     * @member {Price} [price]\n     */\n    price?: Price;\n    /**\n     * @member {PriceRange} [priceRange]\n     */\n    priceRange?: PriceRange;\n    /**\n     * @member {ProductReference[]} [productReferences]\n     */\n    productReferences?: ProductReference[];\n    /**\n     * @member {boolean} [purchasable]\n     */\n    purchasable?: boolean;\n    /**\n     * @member {Review[]} [reviews]\n     */\n    reviews?: Review[];\n    /**\n     * @member {Stock} [stock]\n     */\n    stock?: Stock;\n    /**\n     * @member {string} [summary]\n     */\n    summary?: string;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n    /**\n     * @member {VariantMatrixElement[]} [variantMatrix]\n     */\n    variantMatrix?: VariantMatrixElement[];\n    /**\n     * @member {VariantOption[]} [variantOptions]\n     */\n    variantOptions?: VariantOption[];\n    /**\n     * @member {string} [variantType]\n     */\n    variantType?: string;\n    /**\n     * @member {Price[]} [volumePrices]\n     */\n    volumePrices?: Price[];\n    /**\n     * @member {boolean} [volumePricesFlag]\n     */\n    volumePricesFlag?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing OrderEntry.\n   */\n  export interface OrderEntry {\n    /**\n     * @member {Price} [basePrice]\n     */\n    basePrice?: Price;\n    /**\n     * @member {DeliveryMode} [deliveryMode]\n     */\n    deliveryMode?: DeliveryMode;\n    /**\n     * @member {PointOfService} [deliveryPointOfService]\n     */\n    deliveryPointOfService?: PointOfService;\n    /**\n     * @member {number} [entryNumber]\n     */\n    entryNumber?: number;\n    /**\n     * @member {Product} [product]\n     */\n    product?: Product;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n    /**\n     * @member {boolean} [updateable]\n     */\n    updateable?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing DeliveryOrderEntryGroup.\n   */\n  export interface DeliveryOrderEntryGroup {\n    /**\n     * @member {Address} [deliveryAddress]\n     */\n    deliveryAddress?: Address;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n  }\n\n  /**\n   *\n   * An interface representing PaymentDetails.\n   */\n  export interface PaymentDetails {\n    /**\n     * @member {string} [accountHolderName]\n     */\n    accountHolderName?: string;\n    /**\n     * @member {Address} [billingAddress]\n     */\n    billingAddress?: Address;\n    /**\n     * @member {string} [cardNumber]\n     */\n    cardNumber?: string;\n    /**\n     * @member {CardType} [cardType]\n     */\n    cardType?: CardType;\n    /**\n     * @member {string} [cvn]\n     */\n    cvn?: string;\n    /**\n     * @member {boolean} [defaultPayment]\n     */\n    defaultPayment?: boolean;\n    /**\n     * @member {string} [expiryMonth]\n     */\n    expiryMonth?: string;\n    /**\n     * @member {string} [expiryYear]\n     */\n    expiryYear?: string;\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {string} [issueNumber]\n     */\n    issueNumber?: string;\n    /**\n     * @member {boolean} [saved]\n     */\n    saved?: boolean;\n    /**\n     * @member {string} [startMonth]\n     */\n    startMonth?: string;\n    /**\n     * @member {string} [startYear]\n     */\n    startYear?: string;\n    /**\n     * @member {string} [subscriptionId]\n     */\n    subscriptionId?: string;\n  }\n\n  /**\n   *\n   * An interface representing PickupOrderEntryGroup.\n   */\n  export interface PickupOrderEntryGroup {\n    /**\n     * @member {PointOfService} [deliveryPointOfService]\n     */\n    deliveryPointOfService?: PointOfService;\n    /**\n     * @member {number} [distance]\n     */\n    distance?: number;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n  }\n\n  /**\n   *\n   * An interface representing Principal.\n   */\n  export interface Principal {\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing Cart.\n   */\n  export interface Cart {\n    /**\n     * @member {PromotionResult[]} [appliedOrderPromotions]\n     */\n    appliedOrderPromotions?: PromotionResult[];\n    /**\n     * @member {PromotionResult[]} [appliedProductPromotions]\n     */\n    appliedProductPromotions?: PromotionResult[];\n    /**\n     * @member {Voucher[]} [appliedVouchers]\n     */\n    appliedVouchers?: Voucher[];\n    /**\n     * @member {boolean} [calculated]\n     */\n    calculated?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Address} [deliveryAddress]\n     */\n    deliveryAddress?: Address;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {number} [deliveryItemsQuantity]\n     */\n    deliveryItemsQuantity?: number;\n    /**\n     * @member {DeliveryMode} [deliveryMode]\n     */\n    deliveryMode?: DeliveryMode;\n    /**\n     * @member {DeliveryOrderEntryGroup[]} [deliveryOrderGroups]\n     */\n    deliveryOrderGroups?: DeliveryOrderEntryGroup[];\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {Date} [expirationTime]\n     */\n    expirationTime?: Date;\n    /**\n     * @member {string} [guid]\n     */\n    guid?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {boolean} [net]\n     */\n    net?: boolean;\n    /**\n     * @member {Price} [orderDiscounts]\n     */\n    orderDiscounts?: Price;\n    /**\n     * @member {PaymentDetails} [paymentInfo]\n     */\n    paymentInfo?: PaymentDetails;\n    /**\n     * @member {number} [pickupItemsQuantity]\n     */\n    pickupItemsQuantity?: number;\n    /**\n     * @member {PickupOrderEntryGroup[]} [pickupOrderGroups]\n     */\n    pickupOrderGroups?: PickupOrderEntryGroup[];\n    /**\n     * @member {PromotionResult[]} [potentialOrderPromotions]\n     */\n    potentialOrderPromotions?: PromotionResult[];\n    /**\n     * @member {PromotionResult[]} [potentialProductPromotions]\n     */\n    potentialProductPromotions?: PromotionResult[];\n    /**\n     * @member {Price} [productDiscounts]\n     */\n    productDiscounts?: Price;\n    /**\n     * @member {Date} [saveTime]\n     */\n    saveTime?: Date;\n    /**\n     * @member {Principal} [savedBy]\n     */\n    savedBy?: Principal;\n    /**\n     * @member {string} [site]\n     */\n    site?: string;\n    /**\n     * @member {string} [store]\n     */\n    store?: string;\n    /**\n     * @member {Price} [subTotal]\n     */\n    subTotal?: Price;\n    /**\n     * @member {Price} [totalDiscounts]\n     */\n    totalDiscounts?: Price;\n    /**\n     * @member {number} [totalItems]\n     */\n    totalItems?: number;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n    /**\n     * @member {Price} [totalTax]\n     */\n    totalTax?: Price;\n    /**\n     * @member {number} [totalUnitCount]\n     */\n    totalUnitCount?: number;\n    /**\n     * @member {Principal} [user]\n     */\n    user?: Principal;\n  }\n\n  /**\n   *\n   * An interface representing CartList.\n   */\n  export interface CartList {\n    /**\n     * @member {Cart[]} [carts]\n     */\n    carts?: Cart[];\n  }\n\n  /**\n   *\n   * An interface representing CartModification.\n   */\n  export interface CartModification {\n    /**\n     * @member {boolean} [deliveryModeChanged]\n     */\n    deliveryModeChanged?: boolean;\n    /**\n     * @member {OrderEntry} [entry]\n     */\n    entry?: OrderEntry;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {number} [quantityAdded]\n     */\n    quantityAdded?: number;\n    /**\n     * @member {string} [statusCode]\n     */\n    statusCode?: string;\n    /**\n     * @member {string} [statusMessage]\n     */\n    statusMessage?: string;\n  }\n\n  /**\n   *\n   * An interface representing CategoryHierarchy.\n   */\n  export interface CategoryHierarchy {\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {Date} [lastModified]\n     */\n    lastModified?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {CategoryHierarchy[]} [subcategories]\n     */\n    subcategories?: CategoryHierarchy[];\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing CatalogVersion.\n   */\n  export interface CatalogVersion {\n    /**\n     * @member {CategoryHierarchy[]} [categories]\n     */\n    categories?: CategoryHierarchy[];\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {Date} [lastModified]\n     */\n    lastModified?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing Catalog.\n   */\n  export interface Catalog {\n    /**\n     * @member {CatalogVersion[]} [catalogVersions]\n     */\n    catalogVersions?: CatalogVersion[];\n    /**\n     * @member {string} [id]\n     */\n    id?: string;\n    /**\n     * @member {Date} [lastModified]\n     */\n    lastModified?: Date;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing CatalogList.\n   */\n  export interface CatalogList {\n    /**\n     * @member {Catalog[]} [catalogs]\n     */\n    catalogs?: Catalog[];\n  }\n\n  /**\n   *\n   * An interface representing ComponentIDList.\n   */\n  export interface ComponentIDList {\n    /**\n     * @member {string[]} [idList]\n     */\n    idList?: string[];\n  }\n\n  /**\n   *\n   * An interface representing ConsignmentEntry.\n   */\n  export interface ConsignmentEntry {\n    /**\n     * @member {OrderEntry} [orderEntry]\n     */\n    orderEntry?: OrderEntry;\n    /**\n     * @member {number} [quantity]\n     */\n    quantity?: number;\n    /**\n     * @member {number} [shippedQuantity]\n     */\n    shippedQuantity?: number;\n  }\n\n  /**\n   *\n   * An interface representing Consignment.\n   */\n  export interface Consignment {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {PointOfService} [deliveryPointOfService]\n     */\n    deliveryPointOfService?: PointOfService;\n    /**\n     * @member {ConsignmentEntry[]} [entries]\n     */\n    entries?: ConsignmentEntry[];\n    /**\n     * @member {Address} [shippingAddress]\n     */\n    shippingAddress?: Address;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {Date} [statusDate]\n     */\n    statusDate?: Date;\n    /**\n     * @member {string} [trackingID]\n     */\n    trackingID?: string;\n  }\n\n  /**\n   *\n   * An interface representing CountryList.\n   */\n  export interface CountryList {\n    /**\n     * @member {Country[]} [countries]\n     */\n    countries?: Country[];\n  }\n\n  /**\n   *\n   * An interface representing CurrencyList.\n   */\n  export interface CurrencyList {\n    /**\n     * @member {Currency[]} [currencies]\n     */\n    currencies?: Currency[];\n  }\n\n  /**\n   * An interface representing CustomerCoupon\n   */\n  export interface CustomerCoupon {\n    /**\n     * @member {string} [couponId]\n     */\n    couponId?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {string} [startDate]\n     */\n    startDate?: string;\n    /**\n     * @member {string} [endDate]\n     */\n    endDate?: string;\n    /**\n     * @member {string} [endDate]\n     */\n    status?: string;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {boolean} [notificationOn]\n     */\n    notificationOn?: boolean;\n    /**\n     * @member {boolean} [allProductsApplicable]\n     */\n    allProductsApplicable?: boolean;\n  }\n\n  /**\n   * An interface representing CustomerCouponSearchResult\n   */\n  export interface CustomerCouponSearchResult {\n    /**\n     * @member {CustomerCoupon[]} [coupons]\n     */\n    coupons?: CustomerCoupon[];\n    /**\n     * @member {Sort[]} [sorts]\n     */\n    sorts?: Sort[];\n    /**\n     * @member {Pagination} [pagination]\n     */\n    pagination?: Pagination;\n  }\n\n  /**\n   *\n   * An interface representing DeliveryModeList.\n   */\n  export interface DeliveryModeList {\n    /**\n     * @member {DeliveryMode[]} [deliveryModes]\n     */\n    deliveryModes?: DeliveryMode[];\n  }\n\n  /**\n   *\n   * An interface representing FacetValue.\n   */\n  export interface FacetValue {\n    /**\n     * @member {number} [count]\n     */\n    count?: number;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {SearchState} [query]\n     */\n    query?: SearchState;\n    /**\n     * @member {boolean} [selected]\n     */\n    selected?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing Facet.\n   */\n  export interface Facet {\n    /**\n     * @member {boolean} [category]\n     */\n    category?: boolean;\n    /**\n     * @member {boolean} [multiSelect]\n     */\n    multiSelect?: boolean;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {number} [priority]\n     */\n    priority?: number;\n    /**\n     * @member {FacetValue[]} [topValues]\n     */\n    topValues?: FacetValue[];\n    /**\n     * @member {FacetValue[]} [values]\n     */\n    values?: FacetValue[];\n    /**\n     * @member {boolean} [visible]\n     */\n    visible?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing LanguageList.\n   */\n  export interface LanguageList {\n    /**\n     * @member {Language[]} [languages]\n     */\n    languages?: Language[];\n  }\n\n  /**\n   *\n   * An interface representing Pagination.\n   * Pagination info\n   *\n   */\n  export interface Pagination {\n    /**\n     * @member {number} [count] Number of elements on this page\n     */\n    count?: number;\n    /**\n     * @member {number} [page] Current page number\n     */\n    page?: number;\n    /**\n     * @member {number} [totalCount] Total number of elements\n     */\n    totalCount?: number;\n    /**\n     * @member {number} [totalPages] Total number of pages\n     */\n    totalPages?: number;\n  }\n\n  /**\n   *\n   * An interface representing Sort.\n   * Sort option\n   *\n   */\n  export interface Sort {\n    /**\n     * @member {boolean} [asc]\n     */\n    asc?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n  }\n\n  /**\n   *\n   * An interface representing ListAdaptedComponents.\n   */\n  export interface ListAdaptedComponents {\n    /**\n     * @member {any[]} [components]\n     */\n    components?: any[];\n    /**\n     * @member {Pagination} [pagination]\n     */\n    pagination?: Pagination;\n    /**\n     * @member {Sort[]} [sorts]\n     */\n    sorts?: Sort[];\n  }\n\n  /**\n   *\n   * An interface representing MemberList.\n   */\n  export interface MemberList {\n    /**\n     * @member {Principal[]} [members]\n     */\n    members?: Principal[];\n  }\n\n  /**\n   *\n   * An interface representing OrderEntryList.\n   */\n  export interface OrderEntryList {\n    /**\n     * @member {OrderEntry[]} [orderEntries]\n     */\n    orderEntries?: OrderEntry[];\n  }\n\n  /**\n   *\n   * An interface representing OrderHistory.\n   */\n  export interface OrderHistory {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [guid]\n     */\n    guid?: string;\n    /**\n     * @member {Date} [placed]\n     */\n    placed?: Date;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {string} [statusDisplay]\n     */\n    statusDisplay?: string;\n    /**\n     * @member {Price} [total]\n     */\n    total?: Price;\n  }\n\n  /**\n   *\n   * An interface representing PaginationModel.\n   */\n  export interface PaginationModel {\n    /**\n     * @member {number} [currentPage]\n     */\n    currentPage?: number;\n    /**\n     * @member {number} [pageSize]\n     */\n    pageSize?: number;\n    /**\n     * @member {string} [sort]\n     */\n    sort?: string;\n    /**\n     * @member {number} [totalPages]\n     */\n    totalPages?: number;\n    /**\n     * @member {number} [totalResults]\n     */\n    totalResults?: number;\n  }\n\n  /**\n   *\n   * An interface representing SortModel.\n   */\n  export interface SortModel {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {boolean} [selected]\n     */\n    selected?: boolean;\n  }\n\n  /**\n   *\n   * An interface representing OrderHistoryList.\n   */\n  export interface OrderHistoryList {\n    /**\n     * @member {OrderHistory[]} [orders]\n     */\n    orders?: OrderHistory[];\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n  }\n\n  /**\n   *\n   * An interface representing OrderStatusUpdateElement.\n   */\n  export interface OrderStatusUpdateElement {\n    /**\n     * @member {string} [baseSiteId]\n     */\n    baseSiteId?: string;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n  }\n\n  /**\n   *\n   * An interface representing OrderStatusUpdateElementList.\n   */\n  export interface OrderStatusUpdateElementList {\n    /**\n     * @member {OrderStatusUpdateElement[]} [orderStatusUpdateElements]\n     */\n    orderStatusUpdateElements?: OrderStatusUpdateElement[];\n  }\n\n  /**\n   *\n   * An interface representing Order.\n   */\n  export interface Order {\n    /**\n     * @member {PromotionResult[]} [appliedOrderPromotions]\n     */\n    appliedOrderPromotions?: PromotionResult[];\n    /**\n     * @member {PromotionResult[]} [appliedProductPromotions]\n     */\n    appliedProductPromotions?: PromotionResult[];\n    /**\n     * @member {Voucher[]} [appliedVouchers]\n     */\n    appliedVouchers?: Voucher[];\n    /**\n     * @member {boolean} [calculated]\n     */\n    calculated?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Consignment[]} [consignments]\n     */\n    consignments?: Consignment[];\n    /**\n     * @member {Date} [created]\n     */\n    created?: Date;\n    /**\n     * @member {Address} [deliveryAddress]\n     */\n    deliveryAddress?: Address;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {number} [deliveryItemsQuantity]\n     */\n    deliveryItemsQuantity?: number;\n    /**\n     * @member {DeliveryMode} [deliveryMode]\n     */\n    deliveryMode?: DeliveryMode;\n    /**\n     * @member {DeliveryOrderEntryGroup[]} [deliveryOrderGroups]\n     */\n    deliveryOrderGroups?: DeliveryOrderEntryGroup[];\n    /**\n     * @member {string} [deliveryStatus]\n     */\n    deliveryStatus?: string;\n    /**\n     * @member {string} [deliveryStatusDisplay]\n     */\n    deliveryStatusDisplay?: string;\n    /**\n     * @member {OrderEntry[]} [entries]\n     */\n    entries?: OrderEntry[];\n    /**\n     * @member {boolean} [guestCustomer]\n     */\n    guestCustomer?: boolean;\n    /**\n     * @member {string} [guid]\n     */\n    guid?: string;\n    /**\n     * @member {boolean} [net]\n     */\n    net?: boolean;\n    /**\n     * @member {Price} [orderDiscounts]\n     */\n    orderDiscounts?: Price;\n    /**\n     * @member {PaymentDetails} [paymentInfo]\n     */\n    paymentInfo?: PaymentDetails;\n    /**\n     * @member {number} [pickupItemsQuantity]\n     */\n    pickupItemsQuantity?: number;\n    /**\n     * @member {PickupOrderEntryGroup[]} [pickupOrderGroups]\n     */\n    pickupOrderGroups?: PickupOrderEntryGroup[];\n    /**\n     * @member {Price} [productDiscounts]\n     */\n    productDiscounts?: Price;\n    /**\n     * @member {string} [site]\n     */\n    site?: string;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {string} [statusDisplay]\n     */\n    statusDisplay?: string;\n    /**\n     * @member {string} [store]\n     */\n    store?: string;\n    /**\n     * @member {Price} [subTotal]\n     */\n    subTotal?: Price;\n    /**\n     * @member {Price} [totalDiscounts]\n     */\n    totalDiscounts?: Price;\n    /**\n     * @member {number} [totalItems]\n     */\n    totalItems?: number;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n    /**\n     * @member {Price} [totalPriceWithTax]\n     */\n    totalPriceWithTax?: Price;\n    /**\n     * @member {Price} [totalTax]\n     */\n    totalTax?: Price;\n    /**\n     * @member {OrderEntry[]} [unconsignedEntries]\n     */\n    unconsignedEntries?: OrderEntry[];\n    /**\n     * @member {Principal} [user]\n     */\n    user?: Principal;\n  }\n\n  /**\n   *\n   * An interface representing ReturnRequest.\n   */\n  export interface ReturnRequest {\n    /**\n     * @member {boolean} [cancellable]\n     */\n    cancellable?: boolean;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {Date} [creationTime]\n     */\n    creationTime?: Date;\n    /**\n     * @member {Price} [deliveryCost]\n     */\n    deliveryCost?: Price;\n    /**\n     * @member {order} [order]\n     */\n    order?: Order;\n    /**\n     * @member {boolean} [refundDeliveryCost]\n     */\n    refundDeliveryCost?: boolean;\n    /**\n     * @member {ReturnRequestEntry[]} [returnEntries]\n     */\n    returnEntries?: ReturnRequestEntry[];\n    /**\n     * @member {string} [returnLabelDownloadUrl]\n     */\n    returnLabelDownloadUrl?: string;\n    /**\n     * @member {string} [rma]\n     */\n    rma?: string;\n    /**\n     * @member {string} [status]\n     */\n    status?: string;\n    /**\n     * @member {Price} [subTotal]\n     */\n    subTotal?: Price;\n    /**\n     * @member {Price} [totalPrice]\n     */\n    totalPrice?: Price;\n  }\n\n  /**\n   *\n   * An interface representing ReturnRequestEntry.\n   */\n  export interface ReturnRequestEntry {\n    /**\n     * @member {OrderEntry} [orderEntry]\n     */\n    orderEntry?: OrderEntry;\n    /**\n     * @member {number} [expectedQuantity]\n     */\n    expectedQuantity?: number;\n    /**\n     * @member {Price} [refundAmount]\n     */\n    refundAmount?: Price;\n  }\n\n  /**\n   *\n   * An interface representing PaymentDetailsList.\n   */\n  export interface PaymentDetailsList {\n    /**\n     * @member {PaymentDetails[]} [payments]\n     */\n    payments?: PaymentDetails[];\n  }\n\n  /**\n   *\n   * An interface representing PointOfServiceStock.\n   */\n  export interface PointOfServiceStock {\n    /**\n     * @member {Address} [address]\n     */\n    address?: Address;\n    /**\n     * @member {string} [description]\n     */\n    description?: string;\n    /**\n     * @member {string} [displayName]\n     */\n    displayName?: string;\n    /**\n     * @member {number} [distanceKm]\n     */\n    distanceKm?: number;\n    /**\n     * @member {{ [propertyName: string]: string }} [features]\n     */\n    features?: { [propertyName: string]: string };\n    /**\n     * @member {string} [formattedDistance]\n     */\n    formattedDistance?: string;\n    /**\n     * @member {GeoPoint} [geoPoint]\n     */\n    geoPoint?: GeoPoint;\n    /**\n     * @member {Image} [mapIcon]\n     */\n    mapIcon?: Image;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {OpeningSchedule} [openingHours]\n     */\n    openingHours?: OpeningSchedule;\n    /**\n     * @member {Stock} [stockInfo]\n     */\n    stockInfo?: Stock;\n    /**\n     * @member {string} [storeContent]\n     */\n    storeContent?: string;\n    /**\n     * @member {Image[]} [storeImages]\n     */\n    storeImages?: Image[];\n    /**\n     * @member {string} [url]\n     */\n    url?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductExpressUpdateElement.\n   */\n  export interface ProductExpressUpdateElement {\n    /**\n     * @member {string} [catalogId]\n     */\n    catalogId?: string;\n    /**\n     * @member {string} [catalogVersion]\n     */\n    catalogVersion?: string;\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductExpressUpdateElementList.\n   */\n  export interface ProductExpressUpdateElementList {\n    /**\n     * @member {ProductExpressUpdateElement[]} [productExpressUpdateElements]\n     */\n    productExpressUpdateElements?: ProductExpressUpdateElement[];\n  }\n\n  /**\n   *\n   * An interface representing ProductList.\n   */\n  export interface ProductList {\n    /**\n     * @member {string} [catalog]\n     */\n    catalog?: string;\n    /**\n     * @member {number} [currentPage]\n     */\n    currentPage?: number;\n    /**\n     * @member {Product[]} [products]\n     */\n    products?: Product[];\n    /**\n     * @member {number} [totalPageCount]\n     */\n    totalPageCount?: number;\n    /**\n     * @member {number} [totalProductCount]\n     */\n    totalProductCount?: number;\n    /**\n     * @member {string} [version]\n     */\n    version?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductReferenceList.\n   */\n  export interface ProductReferenceList {\n    /**\n     * @member {ProductReference[]} [references]\n     */\n    references?: ProductReference[];\n  }\n\n  /**\n   *\n   * An interface representing SpellingSuggestion.\n   */\n  export interface SpellingSuggestion {\n    /**\n     * @member {string} [query]\n     */\n    query?: string;\n    /**\n     * @member {string} [suggestion]\n     */\n    suggestion?: string;\n  }\n\n  /**\n   *\n   * An interface representing ProductSearchPage.\n   */\n  export interface ProductSearchPage {\n    /**\n     * @member {Breadcrumb[]} [breadcrumbs]\n     */\n    breadcrumbs?: Breadcrumb[];\n    /**\n     * @member {string} [categoryCode]\n     */\n    categoryCode?: string;\n    /**\n     * @member {SearchState} [currentQuery]\n     */\n    currentQuery?: SearchState;\n    /**\n     * @member {Facet[]} [facets]\n     */\n    facets?: Facet[];\n    /**\n     * @member {string} [freeTextSearch]\n     */\n    freeTextSearch?: string;\n    /**\n     * @member {string} [keywordRedirectUrl]\n     */\n    keywordRedirectUrl?: string;\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {Product[]} [products]\n     */\n    products?: Product[];\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n    /**\n     * @member {SpellingSuggestion} [spellingSuggestion]\n     */\n    spellingSuggestion?: SpellingSuggestion;\n  }\n\n  /**\n   *\n   * An interface representing PromotionList.\n   */\n  export interface PromotionList {\n    /**\n     * @member {Promotion[]} [promotions]\n     */\n    promotions?: Promotion[];\n  }\n\n  /**\n   *\n   * An interface representing PromotionResultList.\n   */\n  export interface PromotionResultList {\n    /**\n     * @member {PromotionResult[]} [promotions]\n     */\n    promotions?: PromotionResult[];\n  }\n\n  /**\n   *\n   * An interface representing ReviewList.\n   */\n  export interface ReviewList {\n    /**\n     * @member {Review[]} [reviews]\n     */\n    reviews?: Review[];\n  }\n\n  /**\n   *\n   * An interface representing SaveCartResult.\n   */\n  export interface SaveCartResult {\n    /**\n     * @member {Cart} [savedCartData]\n     */\n    savedCartData?: Cart;\n  }\n\n  /**\n   *\n   * An interface representing StoreFinderSearchPage.\n   */\n  export interface StoreFinderSearchPage {\n    /**\n     * @member {number} [boundEastLongitude]\n     */\n    boundEastLongitude?: number;\n    /**\n     * @member {number} [boundNorthLatitude]\n     */\n    boundNorthLatitude?: number;\n    /**\n     * @member {number} [boundSouthLatitude]\n     */\n    boundSouthLatitude?: number;\n    /**\n     * @member {number} [boundWestLongitude]\n     */\n    boundWestLongitude?: number;\n    /**\n     * @member {string} [locationText]\n     */\n    locationText?: string;\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n    /**\n     * @member {number} [sourceLatitude]\n     */\n    sourceLatitude?: number;\n    /**\n     * @member {number} [sourceLongitude]\n     */\n    sourceLongitude?: number;\n    /**\n     * @member {PointOfService[]} [stores]\n     */\n    stores?: PointOfService[];\n  }\n\n  /**\n   *\n   * An interface representing StoreFinderStockSearchPage.\n   */\n  export interface StoreFinderStockSearchPage {\n    /**\n     * @member {number} [boundEastLongitude]\n     */\n    boundEastLongitude?: number;\n    /**\n     * @member {number} [boundNorthLatitude]\n     */\n    boundNorthLatitude?: number;\n    /**\n     * @member {number} [boundSouthLatitude]\n     */\n    boundSouthLatitude?: number;\n    /**\n     * @member {number} [boundWestLongitude]\n     */\n    boundWestLongitude?: number;\n    /**\n     * @member {string} [locationText]\n     */\n    locationText?: string;\n    /**\n     * @member {PaginationModel} [pagination]\n     */\n    pagination?: PaginationModel;\n    /**\n     * @member {Product} [product]\n     */\n    product?: Product;\n    /**\n     * @member {SortModel[]} [sorts]\n     */\n    sorts?: SortModel[];\n    /**\n     * @member {number} [sourceLatitude]\n     */\n    sourceLatitude?: number;\n    /**\n     * @member {number} [sourceLongitude]\n     */\n    sourceLongitude?: number;\n    /**\n     * @member {PointOfServiceStock[]} [stores]\n     */\n    stores?: PointOfServiceStock[];\n  }\n\n  /**\n   *\n   * An interface representing Suggestion.\n   */\n  export interface Suggestion {\n    /**\n     * @member {string} [value]\n     */\n    value?: string;\n  }\n\n  /**\n   *\n   * An interface representing SuggestionList.\n   */\n  export interface SuggestionList {\n    /**\n     * @member {Suggestion[]} [suggestions]\n     */\n    suggestions?: Suggestion[];\n  }\n\n  /**\n   *\n   * An interface representing Title.\n   */\n  export interface Title {\n    /**\n     * @member {string} [code]\n     */\n    code?: string;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n  }\n\n  /**\n   *\n   * An interface representing TitleList.\n   */\n  export interface TitleList {\n    /**\n     * @member {Title[]} [titles]\n     */\n    titles?: Title[];\n  }\n\n  /**\n   *\n   * An interface representing UserGroup.\n   */\n  export interface UserGroup {\n    /**\n     * @member {Principal[]} [members]\n     */\n    members?: Principal[];\n    /**\n     * @member {number} [membersCount]\n     */\n    membersCount?: number;\n    /**\n     * @member {string} [name]\n     */\n    name?: string;\n    /**\n     * @member {UserGroup[]} [subGroups]\n     */\n    subGroups?: UserGroup[];\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  /**\n   *\n   * An interface representing UserGroupList.\n   */\n  export interface UserGroupList {\n    /**\n     * @member {number} [currentPage]\n     */\n    currentPage?: number;\n    /**\n     * @member {number} [numberOfPages]\n     */\n    numberOfPages?: number;\n    /**\n     * @member {number} [pageSize]\n     */\n    pageSize?: number;\n    /**\n     * @member {number} [totalNumber]\n     */\n    totalNumber?: number;\n    /**\n     * @member {UserGroup[]} [userGroups]\n     */\n    userGroups?: UserGroup[];\n  }\n\n  /**\n   *\n   * An interface representing UserSignUp.\n   */\n  export interface UserSignUp {\n    /**\n     * @member {string} [firstName]\n     */\n    firstName?: string;\n    /**\n     * @member {string} [lastName]\n     */\n    lastName?: string;\n    /**\n     * @member {string} [password]\n     */\n    password?: string;\n    /**\n     * @member {string} [titleCode]\n     */\n    titleCode?: string;\n    /**\n     * @member {string} [uid]\n     */\n    uid?: string;\n  }\n\n  export interface StoreCount {\n    count?: number;\n    isoCode?: string;\n    name?: string;\n    type?: string;\n  }\n\n  export interface StoreCountList {\n    countriesAndRegionsStoreCount?: StoreCount[];\n  }\n\n  /**\n   *\n   * An interface representing VoucherList.\n   */\n  export interface VoucherList {\n    /**\n     * @member {Voucher[]} [vouchers]\n     */\n    vouchers?: Voucher[];\n  }\n\n  /**\n   * Defines values for PriceType.\n   * Possible values include: 'BUY', 'FROM'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: PriceType = <PriceType>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum PriceType {\n    BUY = 'BUY',\n    FROM = 'FROM',\n  }\n\n  /**\n   * Defines values for ImageType.\n   * Possible values include: 'PRIMARY', 'GALLERY'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: ImageType = <ImageType>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum ImageType {\n    PRIMARY = 'PRIMARY',\n    GALLERY = 'GALLERY',\n  }\n\n  /**\n   * Defines values for Fields.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields = <Fields>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields1.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields1 = <Fields1>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields1 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields2.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields2 = <Fields2>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields2 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields3.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields3 = <Fields3>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields3 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields4.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields4 = <Fields4>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields4 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields5.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields5 = <Fields5>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields5 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields6.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields6 = <Fields6>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields6 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for PageType.\n   * Possible values include: 'ContentPage', 'ProductPage', 'CategoryPage',\n   * 'CatalogPage'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: PageType = <PageType>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum PageType {\n    CONTENT_PAGE = 'ContentPage',\n    PRODUCT_PAGE = 'ProductPage',\n    CATEGORY_PAGE = 'CategoryPage',\n    CATALOG_PAGE = 'CatalogPage',\n  }\n\n  /**\n   * Defines values for Fields7.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields7 = <Fields7>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields7 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields8.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields8 = <Fields8>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields8 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields9.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields9 = <Fields9>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields9 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields10.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields10 = <Fields10>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields10 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields11.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields11 = <Fields11>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields11 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields12.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields12 = <Fields12>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields12 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields13.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields13 = <Fields13>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields13 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields14.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields14 = <Fields14>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields14 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields15.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields15 = <Fields15>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields15 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields16.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields16 = <Fields16>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields16 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for SortEnum.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: SortEnum = <SortEnum>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum SortEnum {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields17.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields17 = <Fields17>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields17 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields18.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields18 = <Fields18>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields18 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields19.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields19 = <Fields19>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields19 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields20.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields20 = <Fields20>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields20 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields21.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields21 = <Fields21>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields21 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields22.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields22 = <Fields22>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields22 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields23.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields23 = <Fields23>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields23 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields24.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields24 = <Fields24>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields24 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields25.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields25 = <Fields25>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields25 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields26.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields26 = <Fields26>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields26 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields27.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields27 = <Fields27>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields27 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields28.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields28 = <Fields28>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields28 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields29.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields29 = <Fields29>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields29 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields30.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields30 = <Fields30>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields30 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields31.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields31 = <Fields31>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields31 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields32.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields32 = <Fields32>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields32 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields33.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields33 = <Fields33>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields33 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields34.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields34 = <Fields34>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields34 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields35.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields35 = <Fields35>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields35 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields36.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields36 = <Fields36>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields36 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields37.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields37 = <Fields37>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields37 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields38.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields38 = <Fields38>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields38 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields39.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields39 = <Fields39>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields39 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields40.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields40 = <Fields40>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields40 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields41.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields41 = <Fields41>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields41 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields42.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields42 = <Fields42>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields42 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields43.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields43 = <Fields43>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields43 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields44.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields44 = <Fields44>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields44 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields45.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields45 = <Fields45>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields45 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields46.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields46 = <Fields46>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields46 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields47.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields47 = <Fields47>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields47 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields48.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields48 = <Fields48>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields48 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields49.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields49 = <Fields49>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields49 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields50.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields50 = <Fields50>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields50 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields51.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields51 = <Fields51>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields51 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields52.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields52 = <Fields52>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields52 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields53.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields53 = <Fields53>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields53 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields54.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields54 = <Fields54>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields54 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields55.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields55 = <Fields55>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields55 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields56.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields56 = <Fields56>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields56 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields57.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields57 = <Fields57>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields57 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields58.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields58 = <Fields58>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields58 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields59.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields59 = <Fields59>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields59 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields60.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields60 = <Fields60>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields60 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Fields61.\n   * Possible values include: 'BASIC', 'DEFAULT', 'FULL'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Fields61 = <Fields61>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Fields61 {\n    BASIC = 'BASIC',\n    DEFAULT = 'DEFAULT',\n    FULL = 'FULL',\n  }\n\n  /**\n   * Defines values for Type.\n   * Possible values include: 'all', 'product', 'order'\n   * There could be more values for this enum apart from the ones defined here.If\n   * you want to set a value that is not from the known values then you can do\n   * the following:\n   * let param: Type = <Type>\"someUnknownValueThatWillStillBeValid\";\n   * @readonly\n   * @enum {string}\n   */\n  export enum Type {\n    All = 'all',\n    Product = 'product',\n    Order = 'order',\n  }\n\n  export interface AnonymousConsent {\n    templateCode?: string;\n    version?: number;\n    consentState?: CONSENT_STATUS;\n  }\n\n  export enum CONSENT_STATUS {\n    ANONYMOUS_CONSENT_GIVEN = 'GIVEN',\n    ANONYMOUS_CONSENT_WITHDRAWN = 'WITHDRAWN',\n  }\n\n  export interface ConsentTemplate {\n    id?: string;\n    name?: string;\n    description?: string;\n    version?: number;\n    currentConsent?: Consent;\n  }\n\n  export interface Consent {\n    code?: string;\n    consentGivenDate?: Date;\n    consentWithdrawnDate?: Date;\n  }\n\n  export interface ConsentTemplateList {\n    consentTemplates?: ConsentTemplate[];\n  }\n\n  export interface BaseSites {\n    baseSites?: BaseSite[];\n  }\n\n  export interface BaseSite {\n    channel?: string;\n    defaultLanguage?: Language;\n    defaultPreviewCatalogId?: string;\n    defaultPreviewCategoryCode?: string;\n    defaultPreviewProductCode?: string;\n    locale?: string;\n    name?: string;\n    theme?: string;\n    uid?: string;\n    stores?: BaseStore[];\n    urlPatterns?: string[];\n    urlEncodingAttributes?: string[];\n  }\n\n  export interface BaseStore {\n    currencies?: Currency[];\n    defaultCurrency?: Currency;\n    languages?: Language[];\n    defaultLanguage?: Language;\n  }\n\n  export interface ProductInterestEntry {\n    interestType?: NotificationType;\n    dateAdded?: string;\n    expirationDate?: string;\n  }\n\n  export interface ProductInterestEntryRelation {\n    product?: Product;\n    productInterestEntry?: ProductInterestEntry[];\n  }\n\n  export interface ProductInterestSearchResult {\n    results?: ProductInterestEntryRelation[];\n    sorts?: Sort[];\n    pagination?: Pagination;\n  }\n\n  export enum NotificationType {\n    BACK_IN_STOCK = 'BACK_IN_STOCK',\n  }\n}\n","import { OccConfig } from './occ-config';\n\nexport const defaultOccConfig: OccConfig = {\n  backend: {\n    occ: {\n      prefix: '/rest/v2/',\n    },\n    media: {},\n  },\n};\n","import { OccConfig } from '../../occ';\n\nexport function occConfigValidator(config: OccConfig) {\n  if (\n    config.backend === undefined ||\n    config.backend.occ === undefined ||\n    config.backend.occ.baseUrl === undefined\n  ) {\n    return 'Please configure backend.occ.baseUrl before using storefront library!';\n  }\n}\n","import { InjectionToken, Provider } from '@angular/core';\n\nexport const ConfigValidatorToken = new InjectionToken(\n  'ConfigurationValidator'\n);\n\n/**\n * ConfigValidator is used to validate config and display warning messages in development mode.\n *\n * In case of failed validation, should return a string with error message.\n */\nexport type ConfigValidator = (config: any) => string | void;\n\n/**\n * Use to probide config validation at app bootstrap (when all config chunks are merged)\n *\n * @param configValidator\n */\nexport function provideConfigValidator(\n  configValidator: ConfigValidator\n): Provider {\n  return {\n    provide: ConfigValidatorToken,\n    useValue: configValidator,\n    multi: true,\n  };\n}\n\nexport function validateConfig(\n  config: any,\n  configValidators: ConfigValidator[]\n) {\n  for (const validate of configValidators) {\n    const warning = validate(config);\n    if (warning) {\n      console.warn(warning);\n    }\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { provideConfigValidator } from '../config/config-validator/config-validator';\nimport { AsmOccModule } from './adapters/asm/asm-occ.module';\nimport { CartOccModule } from './adapters/cart/cart-occ.module';\nimport { CheckoutOccModule } from './adapters/checkout/checkout-occ.module';\nimport { CmsOccModule } from './adapters/cms/cms-occ.module';\nimport { ProductOccModule } from './adapters/product/product-occ.module';\nimport { SiteContextOccModule } from './adapters/site-context/site-context-occ.module';\nimport { StoreFinderOccModule } from './adapters/store-finder/store-finder-occ.module';\nimport { UserOccModule } from './adapters/user/user-occ.module';\nimport { OccConfigLoaderModule } from './config-loader/occ-config-loader.module';\nimport { defaultOccConfig } from './config/default-occ-config';\nimport { OccConfig } from './config/occ-config';\nimport { occConfigValidator } from './config/occ-config-validator';\n\n@NgModule({\n  imports: [\n    AsmOccModule,\n    CmsOccModule,\n    CartOccModule,\n    CheckoutOccModule,\n    ProductOccModule,\n    SiteContextOccModule,\n    StoreFinderOccModule,\n    UserOccModule,\n    OccConfigLoaderModule.forRoot(),\n  ],\n})\nexport class OccModule {\n  static forRoot(): ModuleWithProviders<OccModule> {\n    return {\n      ngModule: OccModule,\n      providers: [\n        { provide: OccConfig, useExisting: Config },\n        provideDefaultConfig(defaultOccConfig),\n        provideConfigValidator(occConfigValidator),\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { OccConfig } from '../config/occ-config';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class LoadingScopesService {\n  constructor(protected config: OccConfig) {}\n\n  /**\n   * Aims to expand scopes based on loading scopes config.\n   *\n   * I.e. if 'details' scope includes 'list' scope by configuration, it'll return ['details', 'list']\n   *\n   * If scope data overlaps with each other, the data should be merged in the order of scopes provided,\n   * i.e. the last scope is merged last, overwriting parts of the data already provided by preceding scope.\n   * It should apply also to implicit scopes (that are included by configuration).\n   *\n   * @param model\n   * @param scopes\n   */\n  expand(model: string, scopes: string[]): string[] {\n    const scopesConfig =\n      this.config &&\n      this.config.backend &&\n      this.config.backend.loadingScopes &&\n      this.config.backend.loadingScopes[model];\n\n    if (scopesConfig) {\n      const expandedScopes = [...scopes];\n      let i = expandedScopes.length;\n\n      while (i > 0) {\n        i--;\n        const includedScopes =\n          scopesConfig[expandedScopes[i]] &&\n          scopesConfig[expandedScopes[i]].include;\n        if (includedScopes) {\n          for (const includedScope of includedScopes) {\n            if (!expandedScopes.includes(includedScope)) {\n              expandedScopes.splice(i, 0, includedScope);\n              i++;\n            }\n          }\n        }\n      }\n\n      return expandedScopes;\n    }\n\n    return scopes;\n  }\n\n  /**\n   * Return maxAge for product scope in milliseconds\n   *\n   * @param model\n   * @param scope\n   */\n  getMaxAge(model: string, scope: string): number {\n    const scopesConfig =\n      this.config &&\n      this.config.backend &&\n      this.config.backend.loadingScopes &&\n      this.config.backend.loadingScopes[model];\n    return (scopesConfig[scope] && scopesConfig[scope].maxAge) * 1000 || 0;\n  }\n}\n","import {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { iif, Observable } from 'rxjs';\nimport { switchMap, take, tap, withLatestFrom } from 'rxjs/operators';\nimport { AuthService } from '../../auth/index';\nimport {\n  ANONYMOUS_CONSENTS_FEATURE,\n  isFeatureEnabled,\n} from '../../features-config/index';\nimport { AnonymousConsent, ANONYMOUS_CONSENT_STATUS } from '../../model/index';\nimport { OccEndpointsService } from '../../occ/index';\nimport { AnonymousConsentsConfig } from '../config/anonymous-consents-config';\nimport { AnonymousConsentsService } from '../facade/anonymous-consents.service';\n\nexport const ANONYMOUS_CONSENTS_HEADER = 'X-Anonymous-Consents';\n\n@Injectable({ providedIn: 'root' })\nexport class AnonymousConsentsInterceptor implements HttpInterceptor {\n  constructor(\n    private anonymousConsentsService: AnonymousConsentsService,\n    private authService: AuthService,\n    private occEndpoints: OccEndpointsService,\n    private config: AnonymousConsentsConfig\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return iif(\n      () => isFeatureEnabled(this.config, ANONYMOUS_CONSENTS_FEATURE),\n      this.anonymousConsentsService.getConsents().pipe(\n        take(1),\n        withLatestFrom(this.authService.isUserLoggedIn()),\n        switchMap(([consents, isUserLoggedIn]) => {\n          if (!this.isOccUrl(request.url)) {\n            return next.handle(request);\n          }\n\n          const clonedRequest = this.handleRequest(consents, request);\n          return next.handle(clonedRequest).pipe(\n            tap(event => {\n              if (event instanceof HttpResponse) {\n                this.handleResponse(\n                  isUserLoggedIn,\n                  event.headers.get(ANONYMOUS_CONSENTS_HEADER),\n                  consents\n                );\n              }\n            })\n          );\n        })\n      ),\n      next.handle(request)\n    );\n  }\n\n  private handleResponse(\n    isUserLoggedIn: boolean,\n    newRawConsents: string,\n    previousConsents: AnonymousConsent[]\n  ): void {\n    if (!isUserLoggedIn && newRawConsents) {\n      let newConsents: AnonymousConsent[] = [];\n      newConsents = this.anonymousConsentsService.decodeAndDeserialize(\n        newRawConsents\n      );\n      newConsents = this.giveRequiredConsents(newConsents);\n\n      if (\n        this.anonymousConsentsService.consentsUpdated(\n          newConsents,\n          previousConsents\n        )\n      ) {\n        this.anonymousConsentsService.setConsents(newConsents);\n      }\n    }\n  }\n\n  private handleRequest(\n    consents: AnonymousConsent[],\n    request: HttpRequest<any>\n  ): HttpRequest<any> {\n    if (!consents) {\n      return request;\n    }\n\n    const rawConsents = this.anonymousConsentsService.serializeAndEncode(\n      consents\n    );\n    return request.clone({\n      setHeaders: {\n        [ANONYMOUS_CONSENTS_HEADER]: rawConsents,\n      },\n    });\n  }\n\n  private isOccUrl(url: string): boolean {\n    return url.includes(this.occEndpoints.getBaseEndpoint());\n  }\n\n  private giveRequiredConsents(\n    consents: AnonymousConsent[]\n  ): AnonymousConsent[] {\n    const givenConsents = [...consents];\n\n    if (\n      Boolean(this.config.anonymousConsents) &&\n      Boolean(this.config.anonymousConsents.requiredConsents)\n    ) {\n      for (const consent of givenConsents) {\n        if (\n          this.config.anonymousConsents.requiredConsents.includes(\n            consent.templateCode\n          )\n        ) {\n          consent.consentState = ANONYMOUS_CONSENT_STATUS.GIVEN;\n        }\n      }\n    }\n    return givenConsents;\n  }\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Provider } from '@angular/core';\nimport { AnonymousConsentsInterceptor } from './anonymous-consents-interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: AnonymousConsentsInterceptor,\n    multi: true,\n  },\n];\n","import { Injectable } from '@angular/core';\nimport { Observable, of, Subscription } from 'rxjs';\nimport { map, tap, withLatestFrom } from 'rxjs/operators';\nimport { StorageSyncType } from '../../state/config/state-config';\nimport {\n  getStorage,\n  persistToStorage,\n  readFromStorage,\n} from '../../state/reducers/storage-sync.reducer';\nimport { WindowRef } from '../../window/window-ref';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class StatePersistenceService {\n  constructor(protected winRef: WindowRef) {}\n\n  /**\n   * Helper to synchronize state to more persistent storage (localStorage, sessionStorage).\n   * It is context aware, so you can keep different state for te same feature based on specified context.\n   *\n   * Eg. cart is valid only under the same base site. So you want to synchronize cart only with the same base site.\n   * Usage for that case: `syncWithStorage({ key: 'cart', state$: activeCartSelector$, context$: this.siteContextParamsService.getValues([BASE_SITE_CONTEXT_ID]), onRead: (state) => setCorrectStateInStore(state) })`.\n   * Active cart for the `electronics` base site will be stored under `spartacus⚿electronics⚿cart` and for apparel under `spartacus⚿apparel⚿cart`.\n   *\n   * On each context change onRead function will be executed with state from storage provided as a parameter.\n   *\n   * Omitting context$ will trigger onRead only once at initialization.\n   *\n   * @param key Key to use in storage for the synchronized state. Should be unique for each feature.\n   * @param state$ State to be saved and later restored.\n   * @param context$ Context for state\n   * @param storageType Storage type to be used to persist state\n   * @param onRead Function to be executed on each storage read after context change\n   *\n   * @returns Subscriptions for reading/writing in storage on context/state change\n   */\n  syncWithStorage<T>({\n    key,\n    state$,\n    context$ = of(''),\n    storageType = StorageSyncType.LOCAL_STORAGE,\n    onRead = () => {},\n  }: {\n    key: string;\n    state$: Observable<T>;\n    context$?: Observable<string | Array<string>>;\n    storageType?: StorageSyncType;\n    onRead?: (stateFromStorage: T) => void;\n  }): Subscription {\n    const storage = getStorage(storageType, this.winRef);\n\n    const subscriptions = new Subscription();\n\n    // Do not change order of subscription! Read should happen before write on context change.\n    subscriptions.add(\n      context$\n        .pipe(\n          map(context => {\n            return readFromStorage(\n              storage,\n              this.generateKeyWithContext(context, key)\n            ) as T;\n          }),\n          tap(state => onRead(state))\n        )\n        .subscribe()\n    );\n\n    subscriptions.add(\n      state$.pipe(withLatestFrom(context$)).subscribe(([state, context]) => {\n        persistToStorage(\n          this.generateKeyWithContext(context, key),\n          state,\n          storage\n        );\n      })\n    );\n\n    return subscriptions;\n  }\n\n  protected generateKeyWithContext(\n    context: string | Array<string>,\n    key: string\n  ): string {\n    return `spartacus⚿${[].concat(context).join('⚿')}⚿${key}`;\n  }\n}\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateEntityLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderErrorSelector,\n  loaderLoadingSelector,\n  loaderSuccessSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { StateWithProcess } from '../process-state';\nimport { getProcessState } from './feature.selector';\n\nexport function getProcessStateFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, LoaderState<T>> {\n  return createSelector(getProcessState(), entityState =>\n    StateEntityLoaderSelectors.entityStateSelector(entityState, processId)\n  );\n}\n\nexport function getProcessLoadingFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, boolean> {\n  return createSelector(getProcessStateFactory(processId), loaderState =>\n    loaderLoadingSelector(loaderState)\n  );\n}\n\nexport function getProcessSuccessFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, boolean> {\n  return createSelector(getProcessStateFactory(processId), loaderState =>\n    loaderSuccessSelector(loaderState)\n  );\n}\n\nexport function getProcessErrorFactory<T>(\n  processId: string\n): MemoizedSelector<StateWithProcess<T>, boolean> {\n  return createSelector(getProcessStateFactory(processId), loaderState =>\n    loaderErrorSelector(loaderState)\n  );\n}\n","import { MemoizedSelector, createFeatureSelector } from '@ngrx/store';\n\nimport { StateWithProcess, PROCESS_FEATURE } from '../process-state';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\n\nexport function getProcessState<T>(): MemoizedSelector<\n  StateWithProcess<T>,\n  EntityLoaderState<T>\n> {\n  return createFeatureSelector<EntityLoaderState<T>>(PROCESS_FEATURE);\n}\n","import { EntityLoaderState } from '../../state/utils/entity-loader/entity-loader-state';\n\nexport const PROCESS_FEATURE = 'process';\n\nexport interface StateWithProcess<T> {\n  [PROCESS_FEATURE]: EntityLoaderState<T>;\n}\n","import { Action } from '@ngrx/store';\n\nexport const LOAD_BILLING_COUNTRIES = '[User] Load Billing Countries';\nexport const LOAD_BILLING_COUNTRIES_FAIL = '[User] Load Billing Countries Fail';\nexport const LOAD_BILLING_COUNTRIES_SUCCESS =\n  '[User] Load Billing Countries Success';\n\nexport class LoadBillingCountries implements Action {\n  readonly type = LOAD_BILLING_COUNTRIES;\n  constructor() {}\n}\n\nexport class LoadBillingCountriesFail implements Action {\n  readonly type = LOAD_BILLING_COUNTRIES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadBillingCountriesSuccess implements Action {\n  readonly type = LOAD_BILLING_COUNTRIES_SUCCESS;\n  constructor(public payload: any) {}\n}\n\nexport type BillingCountriesAction =\n  | LoadBillingCountries\n  | LoadBillingCountriesFail\n  | LoadBillingCountriesSuccess;\n","import { Action } from '@ngrx/store';\nimport { ConsignmentTracking } from '../../../model/index';\n\nexport const LOAD_CONSIGNMENT_TRACKING = '[User] Load Consignment Tracking';\nexport const LOAD_CONSIGNMENT_TRACKING_FAIL =\n  '[User] Load Consignment Tracking Fail';\nexport const LOAD_CONSIGNMENT_TRACKING_SUCCESS =\n  '[User] Load Consignment Tracking Success';\nexport const CLEAR_CONSIGNMENT_TRACKING = '[User] Clear Consignment Tracking';\n\nexport class LoadConsignmentTracking implements Action {\n  readonly type = LOAD_CONSIGNMENT_TRACKING;\n  constructor(\n    public payload: {\n      userId?: string;\n      orderCode: string;\n      consignmentCode: string;\n    }\n  ) {}\n}\n\nexport class LoadConsignmentTrackingFail implements Action {\n  readonly type = LOAD_CONSIGNMENT_TRACKING_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadConsignmentTrackingSuccess implements Action {\n  readonly type = LOAD_CONSIGNMENT_TRACKING_SUCCESS;\n  constructor(public payload: ConsignmentTracking) {}\n}\n\nexport class ClearConsignmentTracking {\n  readonly type = CLEAR_CONSIGNMENT_TRACKING;\n  constructor() {}\n}\n\nexport type ConsignmentTrackingAction =\n  | LoadConsignmentTracking\n  | LoadConsignmentTrackingFail\n  | LoadConsignmentTrackingSuccess\n  | ClearConsignmentTracking;\n","import { Action } from '@ngrx/store';\nimport { Country } from '../../../model/address.model';\n\nexport const LOAD_DELIVERY_COUNTRIES = '[User] Load Delivery Countries';\nexport const LOAD_DELIVERY_COUNTRIES_FAIL =\n  '[User] Load Delivery Countries Fail';\nexport const LOAD_DELIVERY_COUNTRIES_SUCCESS =\n  '[User] Load Delivery Countries Success';\n\nexport class LoadDeliveryCountries implements Action {\n  readonly type = LOAD_DELIVERY_COUNTRIES;\n  constructor() {}\n}\n\nexport class LoadDeliveryCountriesFail implements Action {\n  readonly type = LOAD_DELIVERY_COUNTRIES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadDeliveryCountriesSuccess implements Action {\n  readonly type = LOAD_DELIVERY_COUNTRIES_SUCCESS;\n  constructor(public payload: Country[]) {}\n}\n\nexport type DeliveryCountriesAction =\n  | LoadDeliveryCountries\n  | LoadDeliveryCountriesFail\n  | LoadDeliveryCountriesSuccess;\n","import { Action } from '@ngrx/store';\n\nexport const FORGOT_PASSWORD_EMAIL_REQUEST =\n  '[User] Forgot Password Email Request';\nexport const FORGOT_PASSWORD_EMAIL_REQUEST_SUCCESS =\n  '[User] Forgot Password Email Request Success';\nexport const FORGOT_PASSWORD_EMAIL_REQUEST_FAIL =\n  '[User] Forgot Password Email Request Fail';\n\nexport class ForgotPasswordEmailRequest implements Action {\n  readonly type = FORGOT_PASSWORD_EMAIL_REQUEST;\n  constructor(public payload: string) {}\n}\n\nexport class ForgotPasswordEmailRequestFail implements Action {\n  readonly type = FORGOT_PASSWORD_EMAIL_REQUEST_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class ForgotPasswordEmailRequestSuccess implements Action {\n  readonly type = FORGOT_PASSWORD_EMAIL_REQUEST_SUCCESS;\n}\n\nexport type ForgotPasswordEmailRequestAction =\n  | ForgotPasswordEmailRequest\n  | ForgotPasswordEmailRequestFail\n  | ForgotPasswordEmailRequestSuccess;\n","import { Address, Country, Region } from '../../model/address.model';\nimport { PaymentDetails } from '../../model/cart.model';\nimport { ConsentTemplate } from '../../model/consent.model';\nimport { ConsignmentTracking } from '../../model/consignment-tracking.model';\nimport { Title, User } from '../../model/misc.model';\nimport {\n  Order,\n  OrderHistoryList,\n  ReturnRequest,\n  ReturnRequestList,\n} from '../../model/order.model';\nimport { LoaderState } from '../../state';\nimport { CustomerCouponSearchResult } from '../../model/customer-coupon.model';\nimport { NotificationPreference } from '../../model';\nimport { ProductInterestSearchResult } from '../../model/product-interest.model';\n\nexport const USER_FEATURE = 'user';\nexport const UPDATE_EMAIL_PROCESS_ID = 'updateEmail';\nexport const UPDATE_PASSWORD_PROCESS_ID = 'updatePassword';\nexport const UPDATE_USER_DETAILS_PROCESS_ID = 'updateUserDetails';\nexport const REGISTER_USER_PROCESS_ID = 'registerUser';\nexport const REMOVE_USER_PROCESS_ID = 'removeUser';\nexport const GIVE_CONSENT_PROCESS_ID = 'giveConsent';\nexport const WITHDRAW_CONSENT_PROCESS_ID = 'withdrawConsent';\nexport const UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID =\n  'updateNotificationPreferences';\nexport const ADD_PRODUCT_INTEREST_PROCESS_ID = 'addProductInterests';\nexport const REMOVE_PRODUCT_INTERESTS_PROCESS_ID = 'removeProductInterests';\nexport const CANCEL_ORDER_PROCESS_ID = 'cancelOrder';\nexport const CANCEL_RETURN_PROCESS_ID = 'cancelReturn';\n\nexport const USER_CONSENTS = '[User] User Consents';\nexport const USER_PAYMENT_METHODS = '[User] User Payment Methods';\nexport const USER_ORDERS = '[User] User Orders';\nexport const USER_ADDRESSES = '[User] User Addresses';\nexport const USER_RETURN_REQUESTS = '[User] Order Return Requests';\nexport const USER_RETURN_REQUEST_DETAILS = '[User] Return Request Details';\nexport const USER_ORDER_DETAILS = '[User] User Order Details';\nexport const REGIONS = '[User] Regions';\n\nexport const CUSTOMER_COUPONS = '[User] Customer Coupons';\nexport const SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID = 'subscribeCustomerCoupon';\nexport const UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID =\n  'unsubscribeCustomerCoupon';\nexport const CLAIM_CUSTOMER_COUPON_PROCESS_ID = 'claimCustomerCoupon';\nexport const NOTIFICATION_PREFERENCES = '[User] Notification Preferences';\nexport const PRODUCT_INTERESTS = '[User] Product Interests';\n\nexport interface StateWithUser {\n  [USER_FEATURE]: UserState;\n}\n\nexport interface UserState {\n  account: UserDetailsState;\n  addresses: LoaderState<Address[]>;\n  consents: LoaderState<ConsentTemplate[]>;\n  billingCountries: BillingCountriesState;\n  countries: DeliveryCountriesState;\n  payments: LoaderState<PaymentDetails[]>;\n  orders: LoaderState<OrderHistoryList>;\n  order: LoaderState<Order>;\n  orderReturn: LoaderState<ReturnRequest>;\n  orderReturnList: LoaderState<ReturnRequestList>;\n  titles: TitlesState;\n  regions: LoaderState<RegionsState>;\n  resetPassword: boolean;\n  consignmentTracking: ConsignmentTrackingState;\n  customerCoupons: LoaderState<CustomerCouponSearchResult>;\n  notificationPreferences: LoaderState<NotificationPreference[]>;\n  productInterests: LoaderState<ProductInterestSearchResult>;\n}\n\nexport interface RegionsState {\n  entities: Region[];\n  country: string;\n}\n\nexport interface BillingCountryEntities {\n  [key: string]: Country;\n}\n\nexport interface BillingCountriesState {\n  entities: BillingCountryEntities;\n}\n\nexport interface DeliveryCountryEntities {\n  [key: string]: Country;\n}\n\nexport interface DeliveryCountriesState {\n  entities: DeliveryCountryEntities;\n}\n\nexport interface TitleEntities {\n  [key: string]: Title;\n}\n\nexport interface TitlesState {\n  entities: TitleEntities;\n}\n\nexport interface UserDetailsState {\n  details: User;\n}\n\nexport interface ConsignmentTrackingState {\n  tracking?: ConsignmentTracking;\n}\n","import {\n  Order,\n  CancellationRequestEntryInputList,\n} from '../../../model/order.model';\nimport {\n  LoaderFailAction,\n  LoaderLoadAction,\n  LoaderSuccessAction,\n  LoaderResetAction,\n} from '../../../state/utils/loader/loader.action';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateEntityLoaderActions } from '../../../state/utils/index';\nimport { USER_ORDER_DETAILS, CANCEL_ORDER_PROCESS_ID } from '../user-state';\n\nexport const LOAD_ORDER_DETAILS = '[User] Load Order Details';\nexport const LOAD_ORDER_DETAILS_FAIL = '[User] Load Order Details Fail';\nexport const LOAD_ORDER_DETAILS_SUCCESS = '[User] Load Order Details Success';\nexport const CLEAR_ORDER_DETAILS = '[User] Clear Order Details';\n\nexport const CANCEL_ORDER = '[User] Cancel Order';\nexport const CANCEL_ORDER_FAIL = '[User] Cancel Order Fail';\nexport const CANCEL_ORDER_SUCCESS = '[User] Cancel Order Success';\nexport const RESET_CANCEL_ORDER_PROCESS = '[User] Reset Cancel Order Process';\n\nexport class LoadOrderDetails extends LoaderLoadAction {\n  readonly type = LOAD_ORDER_DETAILS;\n  constructor(\n    public payload: {\n      userId: string;\n      orderCode: string;\n    }\n  ) {\n    super(USER_ORDER_DETAILS);\n  }\n}\n\nexport class LoadOrderDetailsFail extends LoaderFailAction {\n  readonly type = LOAD_ORDER_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ORDER_DETAILS, payload);\n  }\n}\n\nexport class LoadOrderDetailsSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_ORDER_DETAILS_SUCCESS;\n  constructor(public payload: Order) {\n    super(USER_ORDER_DETAILS);\n  }\n}\n\nexport class ClearOrderDetails extends LoaderResetAction {\n  readonly type = CLEAR_ORDER_DETAILS;\n  constructor() {\n    super(USER_ORDER_DETAILS);\n  }\n}\n\nexport class CancelOrder extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = CANCEL_ORDER;\n  constructor(\n    public payload: {\n      userId: string;\n      orderCode: string;\n      cancelRequestInput: CancellationRequestEntryInputList;\n    }\n  ) {\n    super(PROCESS_FEATURE, CANCEL_ORDER_PROCESS_ID);\n  }\n}\n\nexport class CancelOrderFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = CANCEL_ORDER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, CANCEL_ORDER_PROCESS_ID, payload);\n  }\n}\n\nexport class CancelOrderSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = CANCEL_ORDER_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, CANCEL_ORDER_PROCESS_ID);\n  }\n}\n\nexport class ResetCancelOrderProcess extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_CANCEL_ORDER_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, CANCEL_ORDER_PROCESS_ID);\n  }\n}\n\nexport type OrderDetailsAction =\n  | LoadOrderDetails\n  | LoadOrderDetailsFail\n  | LoadOrderDetailsSuccess\n  | ClearOrderDetails\n  | CancelOrder\n  | CancelOrderFail\n  | CancelOrderSuccess;\n","import { PaymentDetails } from '../../../model/cart.model';\nimport { StateLoaderActions } from '../../../state/utils/index';\nimport { USER_PAYMENT_METHODS } from '../user-state';\n\nexport const LOAD_USER_PAYMENT_METHODS = '[User] Load User Payment Methods';\nexport const LOAD_USER_PAYMENT_METHODS_FAIL =\n  '[User] Load User Payment Methods Fail';\nexport const LOAD_USER_PAYMENT_METHODS_SUCCESS =\n  '[User] Load User Payment Methods Success';\n\nexport const SET_DEFAULT_USER_PAYMENT_METHOD =\n  '[User] Set Default User Payment Method';\nexport const SET_DEFAULT_USER_PAYMENT_METHOD_FAIL =\n  '[User] Set Default User Payment Method Fail';\nexport const SET_DEFAULT_USER_PAYMENT_METHOD_SUCCESS =\n  '[User] Set Default User Payment Method Success';\n\nexport const DELETE_USER_PAYMENT_METHOD = '[User] Delete User Payment Method';\nexport const DELETE_USER_PAYMENT_METHOD_FAIL =\n  '[User] Delete User Payment Method Fail';\nexport const DELETE_USER_PAYMENT_METHOD_SUCCESS =\n  '[User] Delete User  Payment Method Success';\n\nexport class LoadUserPaymentMethods extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_USER_PAYMENT_METHODS;\n  constructor(public payload: string) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class LoadUserPaymentMethodsFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_USER_PAYMENT_METHODS_FAIL;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS, payload);\n  }\n}\n\nexport class LoadUserPaymentMethodsSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_USER_PAYMENT_METHODS_SUCCESS;\n  constructor(public payload: PaymentDetails[]) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class SetDefaultUserPaymentMethod extends StateLoaderActions.LoaderLoadAction {\n  readonly type = SET_DEFAULT_USER_PAYMENT_METHOD;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class SetDefaultUserPaymentMethodFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = SET_DEFAULT_USER_PAYMENT_METHOD_FAIL;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS, payload);\n  }\n}\n\nexport class SetDefaultUserPaymentMethodSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = SET_DEFAULT_USER_PAYMENT_METHOD_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class DeleteUserPaymentMethod extends StateLoaderActions.LoaderLoadAction {\n  readonly type = DELETE_USER_PAYMENT_METHOD;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\nexport class DeleteUserPaymentMethodFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = DELETE_USER_PAYMENT_METHOD_FAIL;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS, payload);\n  }\n}\n\nexport class DeleteUserPaymentMethodSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = DELETE_USER_PAYMENT_METHOD_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_PAYMENT_METHODS);\n  }\n}\n\n// action types\nexport type UserPaymentMethodsAction =\n  | LoadUserPaymentMethods\n  | LoadUserPaymentMethodsFail\n  | LoadUserPaymentMethodsSuccess\n  | SetDefaultUserPaymentMethod\n  | SetDefaultUserPaymentMethodFail\n  | SetDefaultUserPaymentMethodSuccess\n  | DeleteUserPaymentMethod\n  | DeleteUserPaymentMethodFail\n  | DeleteUserPaymentMethodSuccess;\n","import { Action } from '@ngrx/store';\nimport { Region } from '../../../model/address.model';\nimport { StateLoaderActions } from '../../../state/utils/index';\nimport { REGIONS } from '../user-state';\n\nexport const LOAD_REGIONS = '[User] Load Regions';\nexport const LOAD_REGIONS_SUCCESS = '[User] Load Regions Success';\nexport const LOAD_REGIONS_FAIL = '[User] Load Regions Fail';\nexport const CLEAR_REGIONS = '[User] Clear Regions';\n\nexport class LoadRegions extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_REGIONS;\n  constructor(public payload: string) {\n    super(REGIONS);\n  }\n}\n\nexport class LoadRegionsFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_REGIONS_FAIL;\n  constructor(public payload: any) {\n    super(REGIONS, payload);\n  }\n}\n\nexport class LoadRegionsSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_REGIONS_SUCCESS;\n  constructor(public payload: { entities: Region[]; country: string }) {\n    super(REGIONS);\n  }\n}\n\nexport class ClearRegions implements Action {\n  readonly type = CLEAR_REGIONS;\n  constructor() {}\n}\n\nexport type RegionsAction =\n  | LoadRegions\n  | LoadRegionsFail\n  | LoadRegionsSuccess\n  | ClearRegions;\n","import { Action } from '@ngrx/store';\n\nexport const RESET_PASSWORD = '[User] Reset Password';\nexport const RESET_PASSWORD_SUCCESS = '[User] Reset Password Success';\nexport const RESET_PASSWORD_FAIL = '[User] Reset Password Fail';\n\nexport class ResetPassword implements Action {\n  readonly type = RESET_PASSWORD;\n  constructor(public payload: { token: string; password: string }) {}\n}\n\nexport class ResetPasswordFail implements Action {\n  readonly type = RESET_PASSWORD_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class ResetPasswordSuccess implements Action {\n  readonly type = RESET_PASSWORD_SUCCESS;\n}\n\nexport type ResetPasswordAction =\n  | ResetPassword\n  | ResetPasswordFail\n  | ResetPasswordSuccess;\n","import { Action } from '@ngrx/store';\nimport { Title } from '../../../model/misc.model';\n\nexport const LOAD_TITLES = '[User] Load Tiltes';\nexport const LOAD_TITLES_FAIL = '[User] Load Titles Fail';\nexport const LOAD_TITLES_SUCCESS = '[User] Load Titles Success';\n\nexport class LoadTitles implements Action {\n  readonly type = LOAD_TITLES;\n  constructor() {}\n}\n\nexport class LoadTitlesFail implements Action {\n  readonly type = LOAD_TITLES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadTitlesSuccess implements Action {\n  readonly type = LOAD_TITLES_SUCCESS;\n  constructor(public payload: Title[]) {}\n}\n\nexport type TitlesAction = LoadTitles | LoadTitlesFail | LoadTitlesSuccess;\n","import { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateEntityLoaderActions } from '../../../state/utils/index';\nimport { UPDATE_EMAIL_PROCESS_ID } from '../user-state';\n\nexport const UPDATE_EMAIL = '[User] Update Email';\nexport const UPDATE_EMAIL_ERROR = '[User] Update Email Error';\nexport const UPDATE_EMAIL_SUCCESS = '[User] Update Email Success';\nexport const RESET_EMAIL = '[User] Reset Email';\n\nexport class UpdateEmailAction extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = UPDATE_EMAIL;\n  constructor(\n    public payload: {\n      uid: string;\n      password: string;\n      newUid: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID);\n  }\n}\n\nexport class UpdateEmailSuccessAction extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = UPDATE_EMAIL_SUCCESS;\n  constructor(public newUid: string) {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID);\n  }\n}\n\nexport class UpdateEmailErrorAction extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = UPDATE_EMAIL_ERROR;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID, payload);\n  }\n}\n\nexport class ResetUpdateEmailAction extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_EMAIL;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_EMAIL_PROCESS_ID);\n  }\n}\n\nexport type EmailActions =\n  | UpdateEmailAction\n  | UpdateEmailSuccessAction\n  | UpdateEmailErrorAction\n  | ResetUpdateEmailAction;\n","import { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateEntityLoaderActions } from '../../../state/utils/index';\nimport { UPDATE_PASSWORD_PROCESS_ID } from '../user-state';\n\nexport const UPDATE_PASSWORD = '[User] Update Password';\nexport const UPDATE_PASSWORD_FAIL = '[User] Update Password Fail';\nexport const UPDATE_PASSWORD_SUCCESS = '[User] Update Password Success';\nexport const UPDATE_PASSWORD_RESET =\n  '[User] Reset Update Password Process State';\n\nexport class UpdatePassword extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = UPDATE_PASSWORD;\n  constructor(\n    public payload: { userId: string; oldPassword: string; newPassword: string }\n  ) {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID);\n  }\n}\n\nexport class UpdatePasswordFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = UPDATE_PASSWORD_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID, payload);\n  }\n}\n\nexport class UpdatePasswordSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = UPDATE_PASSWORD_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID);\n  }\n}\n\nexport class UpdatePasswordReset extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = UPDATE_PASSWORD_RESET;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_PASSWORD_PROCESS_ID);\n  }\n}\n\n// action types\nexport type UpdatePasswordAction =\n  | UpdatePassword\n  | UpdatePasswordFail\n  | UpdatePasswordSuccess\n  | UpdatePasswordReset;\n","import { Address } from '../../../model/address.model';\nimport { StateLoaderActions } from '../../../state/utils/index';\nimport { USER_ADDRESSES } from '../user-state';\n\nexport const LOAD_USER_ADDRESSES = '[User] Load User Addresses';\nexport const LOAD_USER_ADDRESSES_FAIL = '[User] Load User Addresses Fail';\nexport const LOAD_USER_ADDRESSES_SUCCESS = '[User] Load User Addresses Success';\n\nexport const ADD_USER_ADDRESS = '[User] Add User Address';\nexport const ADD_USER_ADDRESS_FAIL = '[User] Add User Address Fail';\nexport const ADD_USER_ADDRESS_SUCCESS = '[User] Add User Address Success';\n\nexport const UPDATE_USER_ADDRESS = '[User] Update User Address';\nexport const UPDATE_USER_ADDRESS_FAIL = '[User] Update User Address Fail';\nexport const UPDATE_USER_ADDRESS_SUCCESS = '[User] Update User Address Success';\n\nexport const DELETE_USER_ADDRESS = '[User] Delete User Address';\nexport const DELETE_USER_ADDRESS_FAIL = '[User] Delete User Address Fail';\nexport const DELETE_USER_ADDRESS_SUCCESS = '[User] Delete User Address Success';\n\nexport class LoadUserAddresses extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_USER_ADDRESSES;\n  constructor(public payload: string) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class LoadUserAddressesFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_USER_ADDRESSES_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class LoadUserAddressesSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_USER_ADDRESSES_SUCCESS;\n  constructor(public payload: Address[]) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// Adding address actions\nexport class AddUserAddress extends StateLoaderActions.LoaderLoadAction {\n  readonly type = ADD_USER_ADDRESS;\n  constructor(public payload: { userId: string; address: Address }) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class AddUserAddressFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = ADD_USER_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class AddUserAddressSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = ADD_USER_ADDRESS_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// Updating address actions\nexport class UpdateUserAddress extends StateLoaderActions.LoaderLoadAction {\n  readonly type = UPDATE_USER_ADDRESS;\n  constructor(\n    public payload: { userId: string; addressId: string; address: Address }\n  ) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class UpdateUserAddressFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = UPDATE_USER_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class UpdateUserAddressSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = UPDATE_USER_ADDRESS_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// Deleting address actions\nexport class DeleteUserAddress extends StateLoaderActions.LoaderLoadAction {\n  readonly type = DELETE_USER_ADDRESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\nexport class DeleteUserAddressFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = DELETE_USER_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES, payload);\n  }\n}\n\nexport class DeleteUserAddressSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = DELETE_USER_ADDRESS_SUCCESS;\n  constructor(public payload: any) {\n    super(USER_ADDRESSES);\n  }\n}\n\n// action types\nexport type UserAddressesAction =\n  | LoadUserAddresses\n  | LoadUserAddressesFail\n  | LoadUserAddressesSuccess\n  | AddUserAddress\n  | AddUserAddressFail\n  | AddUserAddressSuccess\n  | UpdateUserAddress\n  | UpdateUserAddressFail\n  | UpdateUserAddressSuccess\n  | DeleteUserAddress\n  | DeleteUserAddressFail\n  | DeleteUserAddressSuccess;\n","import { ConsentTemplate } from '../../../model/consent.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  StateEntityLoaderActions,\n  StateLoaderActions,\n} from '../../../state/utils/index';\nimport {\n  GIVE_CONSENT_PROCESS_ID,\n  USER_CONSENTS,\n  WITHDRAW_CONSENT_PROCESS_ID,\n} from '../user-state';\n\nexport const LOAD_USER_CONSENTS = '[User] Load User Consents';\nexport const LOAD_USER_CONSENTS_SUCCESS = '[User] Load User Consents Success';\nexport const LOAD_USER_CONSENTS_FAIL = '[User] Load User Consents Fail';\nexport const RESET_LOAD_USER_CONSENTS = '[User] Reset Load User Consents';\n\nexport const GIVE_USER_CONSENT = '[User] Give User Consent';\nexport const GIVE_USER_CONSENT_FAIL = '[User] Give User Consent Fail';\nexport const GIVE_USER_CONSENT_SUCCESS = '[User] Give User Consent Success';\nexport const RESET_GIVE_USER_CONSENT_PROCESS =\n  '[User] Reset Give User Consent Process';\nexport const TRANSFER_ANONYMOUS_CONSENT = '[User] Transfer Anonymous Consent';\n\nexport const WITHDRAW_USER_CONSENT = '[User] Withdraw User Consent';\nexport const WITHDRAW_USER_CONSENT_FAIL = '[User] Withdraw User Consent Fail';\nexport const WITHDRAW_USER_CONSENT_SUCCESS =\n  '[User] Withdraw User Consent Success';\nexport const RESET_WITHDRAW_USER_CONSENT_PROCESS =\n  '[User] Reset Withdraw User Consent Process';\n\nexport class LoadUserConsents extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_USER_CONSENTS;\n  constructor(public payload: string) {\n    super(USER_CONSENTS);\n  }\n}\n\nexport class LoadUserConsentsFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_USER_CONSENTS_FAIL;\n  constructor(public payload: any) {\n    super(USER_CONSENTS, payload);\n  }\n}\n\nexport class LoadUserConsentsSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_USER_CONSENTS_SUCCESS;\n  constructor(public payload: ConsentTemplate[]) {\n    super(USER_CONSENTS);\n  }\n}\n\nexport class ResetLoadUserConsents extends StateLoaderActions.LoaderResetAction {\n  readonly type = RESET_LOAD_USER_CONSENTS;\n  constructor() {\n    super(USER_CONSENTS);\n  }\n}\n\nexport class GiveUserConsent extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = GIVE_USER_CONSENT;\n  constructor(\n    public payload: {\n      userId: string;\n      consentTemplateId: string;\n      consentTemplateVersion: number;\n    }\n  ) {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class GiveUserConsentFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = GIVE_USER_CONSENT_FAIL;\n  constructor(payload: any) {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID, payload);\n  }\n}\n\nexport class GiveUserConsentSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = GIVE_USER_CONSENT_SUCCESS;\n  constructor(public consentTemplate: ConsentTemplate) {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class ResetGiveUserConsentProcess extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_GIVE_USER_CONSENT_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, GIVE_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class TransferAnonymousConsent {\n  readonly type = TRANSFER_ANONYMOUS_CONSENT;\n  constructor(\n    public payload: {\n      userId: string;\n      consentTemplateId: string;\n      consentTemplateVersion: number;\n    }\n  ) {}\n}\n\nexport class WithdrawUserConsent extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = WITHDRAW_USER_CONSENT;\n  constructor(\n    public payload: {\n      userId: string;\n      consentCode: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class WithdrawUserConsentFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = WITHDRAW_USER_CONSENT_FAIL;\n  constructor(payload: any) {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID, payload);\n  }\n}\n\nexport class WithdrawUserConsentSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = WITHDRAW_USER_CONSENT_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID);\n  }\n}\n\nexport class ResetWithdrawUserConsentProcess extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_WITHDRAW_USER_CONSENT_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, WITHDRAW_CONSENT_PROCESS_ID);\n  }\n}\n\nexport type UserConsentsAction =\n  | LoadUserConsents\n  | LoadUserConsentsFail\n  | LoadUserConsentsSuccess\n  | ResetLoadUserConsents\n  | GiveUserConsent\n  | GiveUserConsentFail\n  | GiveUserConsentSuccess\n  | ResetGiveUserConsentProcess\n  | WithdrawUserConsent\n  | WithdrawUserConsentFail\n  | WithdrawUserConsentSuccess\n  | ResetWithdrawUserConsentProcess;\n","import { Action } from '@ngrx/store';\nimport { User } from '../../../model/misc.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateEntityLoaderActions } from '../../../state/utils/index';\nimport { UPDATE_USER_DETAILS_PROCESS_ID } from '../user-state';\n\nexport const LOAD_USER_DETAILS = '[User] Load User Details';\nexport const LOAD_USER_DETAILS_FAIL = '[User] Load User Details Fail';\nexport const LOAD_USER_DETAILS_SUCCESS = '[User] Load User Details Success';\n\nexport const UPDATE_USER_DETAILS = '[User] Update User Details';\nexport const UPDATE_USER_DETAILS_FAIL = '[User] Update User Details Fail';\nexport const UPDATE_USER_DETAILS_SUCCESS = '[User] Update User Details Success';\nexport const RESET_USER_DETAILS = '[User] Reset User Details';\n\nexport class LoadUserDetails implements Action {\n  readonly type = LOAD_USER_DETAILS;\n  constructor(public payload: string) {}\n}\n\nexport class LoadUserDetailsFail implements Action {\n  readonly type = LOAD_USER_DETAILS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadUserDetailsSuccess implements Action {\n  readonly type = LOAD_USER_DETAILS_SUCCESS;\n  constructor(public payload: User) {}\n}\n\nexport class UpdateUserDetails extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = UPDATE_USER_DETAILS;\n  constructor(public payload: { username: string; userDetails: User }) {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class UpdateUserDetailsFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = UPDATE_USER_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID, payload);\n  }\n}\n\nexport class UpdateUserDetailsSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = UPDATE_USER_DETAILS_SUCCESS;\n  constructor(public userUpdates: User) {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class ResetUpdateUserDetails extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_USER_DETAILS;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_USER_DETAILS_PROCESS_ID);\n  }\n}\n\n// action types\nexport type UserDetailsAction =\n  | LoadUserDetails\n  | LoadUserDetailsFail\n  | LoadUserDetailsSuccess\n  | UpdateUserDetails\n  | UpdateUserDetailsFail\n  | UpdateUserDetailsSuccess\n  | ResetUpdateUserDetails;\n","import { Action } from '@ngrx/store';\nexport const CLEAR_USER_MISCS_DATA = '[User] Clear User Misc Data';\n\nexport class ClearUserMiscsData implements Action {\n  readonly type = CLEAR_USER_MISCS_DATA;\n}\n","import { OrderHistoryList } from '../../../model/order.model';\nimport { StateLoaderActions } from '../../../state/utils/index';\nimport { USER_ORDERS } from '../user-state';\n\nexport const LOAD_USER_ORDERS = '[User] Load User Orders';\nexport const LOAD_USER_ORDERS_FAIL = '[User] Load User Orders Fail';\nexport const LOAD_USER_ORDERS_SUCCESS = '[User] Load User Orders Success';\nexport const CLEAR_USER_ORDERS = '[User] Clear User Orders';\n\nexport class LoadUserOrders extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_USER_ORDERS;\n  constructor(\n    public payload: {\n      userId: string;\n      pageSize: number;\n      currentPage?: number;\n      sort?: string;\n    }\n  ) {\n    super(USER_ORDERS);\n  }\n}\n\nexport class LoadUserOrdersFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_USER_ORDERS_FAIL;\n  constructor(public payload: any) {\n    super(USER_ORDERS, payload);\n  }\n}\n\nexport class LoadUserOrdersSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_USER_ORDERS_SUCCESS;\n  constructor(public payload: OrderHistoryList) {\n    super(USER_ORDERS);\n  }\n}\n\nexport class ClearUserOrders extends StateLoaderActions.LoaderResetAction {\n  readonly type = CLEAR_USER_ORDERS;\n  constructor() {\n    super(USER_ORDERS);\n  }\n}\n\nexport type UserOrdersAction =\n  | LoadUserOrders\n  | LoadUserOrdersFail\n  | LoadUserOrdersSuccess\n  | ClearUserOrders;\n","import { Action } from '@ngrx/store';\nimport { UserSignUp } from '../../../model/misc.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport { StateEntityLoaderActions } from '../../../state/utils/index';\nimport {\n  REGISTER_USER_PROCESS_ID,\n  REMOVE_USER_PROCESS_ID,\n} from '../user-state';\n\nexport const REGISTER_USER = '[User] Register User';\nexport const REGISTER_USER_FAIL = '[User] Register User Fail';\nexport const REGISTER_USER_SUCCESS = '[User] Register User Success';\nexport const RESET_REGISTER_USER_PROCESS = '[User] Reset Register User Process';\n\nexport const REGISTER_GUEST = '[User] Register Guest';\nexport const REGISTER_GUEST_FAIL = '[User] Register Guest Fail';\nexport const REGISTER_GUEST_SUCCESS = '[User] Register Guest Success';\n\nexport const REMOVE_USER = '[User] Remove User';\nexport const REMOVE_USER_FAIL = '[User] Remove User Fail';\nexport const REMOVE_USER_SUCCESS = '[User] Remove User Success';\nexport const REMOVE_USER_RESET = '[User] Reset Remove User Process State';\n\nexport class RegisterUser extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = REGISTER_USER;\n  constructor(public payload: UserSignUp) {\n    super(PROCESS_FEATURE, REGISTER_USER_PROCESS_ID);\n  }\n}\n\nexport class RegisterUserFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = REGISTER_USER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, REGISTER_USER_PROCESS_ID, payload);\n  }\n}\n\nexport class RegisterUserSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = REGISTER_USER_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, REGISTER_USER_PROCESS_ID);\n  }\n}\n\nexport class ResetRegisterUserProcess extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_REGISTER_USER_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, REGISTER_USER_PROCESS_ID);\n  }\n}\n\nexport class RegisterGuest implements Action {\n  readonly type = REGISTER_GUEST;\n  constructor(public payload: { guid: string; password: string }) {}\n}\n\nexport class RegisterGuestFail implements Action {\n  readonly type = REGISTER_GUEST_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class RegisterGuestSuccess implements Action {\n  readonly type = REGISTER_GUEST_SUCCESS;\n}\n\nexport class RemoveUser extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = REMOVE_USER;\n  constructor(public payload: string) {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID);\n  }\n}\n\nexport class RemoveUserFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = REMOVE_USER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID, payload);\n  }\n}\n\nexport class RemoveUserSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = REMOVE_USER_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID);\n  }\n}\n\nexport class RemoveUserReset extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = REMOVE_USER_RESET;\n  constructor() {\n    super(PROCESS_FEATURE, REMOVE_USER_PROCESS_ID);\n  }\n}\n\n// action types\nexport type UserRegisterOrRemoveAction =\n  | RegisterUser\n  | RegisterUserFail\n  | RegisterUserSuccess\n  | ResetRegisterUserProcess\n  | RegisterGuest\n  | RegisterGuestFail\n  | RegisterGuestSuccess\n  | RemoveUser\n  | RemoveUserFail\n  | RemoveUserSuccess\n  | RemoveUserReset;\n","import {\n  CUSTOMER_COUPONS,\n  SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID,\n  UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID,\n  CLAIM_CUSTOMER_COUPON_PROCESS_ID,\n} from '../user-state';\nimport {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n  LoaderResetAction,\n} from '../../../state/utils/loader/loader.action';\nimport {\n  CustomerCouponSearchResult,\n  CustomerCouponNotification,\n  CustomerCoupon2Customer,\n} from '../../../model/customer-coupon.model';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityResetAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport { PROCESS_FEATURE } from '../../../process/store';\n\nexport const LOAD_CUSTOMER_COUPONS = '[User] Load Customer Coupons';\nexport const LOAD_CUSTOMER_COUPONS_FAIL = '[User] Load Customer Coupons Fail';\nexport const LOAD_CUSTOMER_COUPONS_SUCCESS =\n  '[User] Load Customer Coupons Success';\nexport const RESET_LOAD_CUSTOMER_COUPONS = '[User] Reset Load Customer Coupons';\n\nexport const SUBSCRIBE_CUSTOMER_COUPON =\n  '[User] Subscribe Customer Notification Coupon';\nexport const SUBSCRIBE_CUSTOMER_COUPON_FAIL =\n  '[User] Subscribe Customer Coupon Notification Fail';\nexport const SUBSCRIBE_CUSTOMER_COUPON_SUCCESS =\n  '[User] Subscribe Customer Coupon Notification Success';\nexport const RESET_SUBSCRIBE_CUSTOMER_COUPON_PROCESS =\n  '[User] Reset Subscribe Customer Coupon Process';\n\nexport const UNSUBSCRIBE_CUSTOMER_COUPON =\n  '[User] Unsubscribe Customer Notification Coupon';\nexport const UNSUBSCRIBE_CUSTOMER_COUPON_FAIL =\n  '[User] Unsubscribe Customer Coupon Notification Fail';\nexport const UNSUBSCRIBE_CUSTOMER_COUPON_SUCCESS =\n  '[User] Unsubscribe Customer Coupon Notification Success';\nexport const RESET_UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS =\n  '[User] Reset Unsubscribe Customer Coupon Process';\n\nexport const CLAIM_CUSTOMER_COUPON = '[User] Claim Customer';\nexport const CLAIM_CUSTOMER_COUPON_FAIL = '[User] Claim Customer Fail';\nexport const CLAIM_CUSTOMER_COUPON_SUCCESS = '[User] Claim Customer Success';\n\nexport class LoadCustomerCoupons extends LoaderLoadAction {\n  readonly type = LOAD_CUSTOMER_COUPONS;\n  constructor(\n    public payload: {\n      userId: string;\n      pageSize: number;\n      currentPage?: number;\n      sort?: string;\n    }\n  ) {\n    super(CUSTOMER_COUPONS);\n  }\n}\n\nexport class LoadCustomerCouponsFail extends LoaderFailAction {\n  readonly type = LOAD_CUSTOMER_COUPONS_FAIL;\n  constructor(public payload: any) {\n    super(CUSTOMER_COUPONS, payload);\n  }\n}\n\nexport class LoadCustomerCouponsSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_CUSTOMER_COUPONS_SUCCESS;\n  constructor(public payload: CustomerCouponSearchResult) {\n    super(CUSTOMER_COUPONS);\n  }\n}\n\nexport class ResetLoadCustomerCoupons extends LoaderResetAction {\n  readonly type = RESET_LOAD_CUSTOMER_COUPONS;\n  constructor() {\n    super(CUSTOMER_COUPONS);\n  }\n}\n\n// Subscribe coupon notification actions\nexport class SubscribeCustomerCoupon extends EntityLoadAction {\n  readonly type = SUBSCRIBE_CUSTOMER_COUPON;\n  constructor(\n    public payload: {\n      userId: string;\n      couponCode: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID);\n  }\n}\n\nexport class SubscribeCustomerCouponFail extends EntityFailAction {\n  readonly type = SUBSCRIBE_CUSTOMER_COUPON_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\nexport class SubscribeCustomerCouponSuccess extends EntitySuccessAction {\n  readonly type = SUBSCRIBE_CUSTOMER_COUPON_SUCCESS;\n  constructor(public payload: CustomerCouponNotification) {\n    super(PROCESS_FEATURE, SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\nexport class ResetSubscribeCustomerCouponProcess extends EntityResetAction {\n  readonly type = RESET_SUBSCRIBE_CUSTOMER_COUPON_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID);\n  }\n}\n\nexport class UnsubscribeCustomerCoupon extends EntityLoadAction {\n  readonly type = UNSUBSCRIBE_CUSTOMER_COUPON;\n  constructor(\n    public payload: {\n      userId: string;\n      couponCode: string;\n    }\n  ) {\n    super(PROCESS_FEATURE, UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID);\n  }\n}\n\nexport class UnsubscribeCustomerCouponFail extends EntityFailAction {\n  readonly type = UNSUBSCRIBE_CUSTOMER_COUPON_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\nexport class UnsubscribeCustomerCouponSuccess extends EntitySuccessAction {\n  readonly type = UNSUBSCRIBE_CUSTOMER_COUPON_SUCCESS;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\nexport class ResetUnsubscribeCustomerCouponProcess extends EntityResetAction {\n  readonly type = RESET_UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID);\n  }\n}\n\nexport class ClaimCustomerCoupon extends EntityLoadAction {\n  readonly type = CLAIM_CUSTOMER_COUPON;\n  constructor(\n    public payload: {\n      userId: string;\n      couponCode;\n    }\n  ) {\n    super(PROCESS_FEATURE, CLAIM_CUSTOMER_COUPON_PROCESS_ID);\n  }\n}\n\nexport class ClaimCustomerCouponFail extends EntityFailAction {\n  readonly type = CLAIM_CUSTOMER_COUPON_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, CLAIM_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\nexport class ClaimCustomerCouponSuccess extends EntitySuccessAction {\n  readonly type = CLAIM_CUSTOMER_COUPON_SUCCESS;\n  constructor(public payload: CustomerCoupon2Customer) {\n    super(PROCESS_FEATURE, CLAIM_CUSTOMER_COUPON_PROCESS_ID, payload);\n  }\n}\n\n// action types\nexport type CustomerCouponAction =\n  | LoadCustomerCoupons\n  | LoadCustomerCouponsFail\n  | LoadCustomerCouponsSuccess\n  | ResetLoadCustomerCoupons\n  | SubscribeCustomerCoupon\n  | SubscribeCustomerCouponFail\n  | SubscribeCustomerCouponSuccess\n  | ResetSubscribeCustomerCouponProcess\n  | UnsubscribeCustomerCoupon\n  | UnsubscribeCustomerCouponFail\n  | UnsubscribeCustomerCouponSuccess\n  | ResetUnsubscribeCustomerCouponProcess\n  | ClaimCustomerCoupon\n  | ClaimCustomerCouponFail\n  | ClaimCustomerCouponSuccess;\n","import { StateLoaderActions } from '../../../state/utils/index';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityResetAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport {\n  UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID,\n  NOTIFICATION_PREFERENCES,\n} from '../user-state';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\n\nexport const LOAD_NOTIFICATION_PREFERENCES =\n  '[User] Load Notification Preferences';\nexport const LOAD_NOTIFICATION_PREFERENCES_FAIL =\n  '[User] Load Notification Preferences Fail';\nexport const LOAD_NOTIFICATION_PREFERENCES_SUCCESS =\n  '[User] Load Notification Preferences Success';\nexport const UPDATE_NOTIFICATION_PREFERENCES =\n  '[User] Update Notification Preferences';\nexport const UPDATE_NOTIFICATION_PREFERENCES_FAIL =\n  '[User] Update Notification Preferences Fail';\nexport const UPDATE_NOTIFICATION_PREFERENCES_SUCCESS =\n  '[User] Update Notification Preferences Success';\nexport const RESET_NOTIFICATION_PREFERENCES =\n  '[User] Reset Notification Preferences';\nexport const CLEAR_NOTIFICATION_PREFERENCES =\n  '[User] Clear Notification Preferences';\n\nexport class LoadNotificationPreferences extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_NOTIFICATION_PREFERENCES;\n  constructor(public payload: string) {\n    super(NOTIFICATION_PREFERENCES);\n  }\n}\n\nexport class LoadNotificationPreferencesFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_NOTIFICATION_PREFERENCES_FAIL;\n  constructor(public payload: any) {\n    super(NOTIFICATION_PREFERENCES, payload);\n  }\n}\n\nexport class LoadNotificationPreferencesSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_NOTIFICATION_PREFERENCES_SUCCESS;\n  constructor(public payload: NotificationPreference[]) {\n    super(NOTIFICATION_PREFERENCES);\n  }\n}\n\nexport class UpdateNotificationPreferences extends EntityLoadAction {\n  readonly type = UPDATE_NOTIFICATION_PREFERENCES;\n  constructor(\n    public payload: { userId: string; preferences: NotificationPreference[] }\n  ) {\n    super(PROCESS_FEATURE, UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID);\n  }\n}\n\nexport class UpdateNotificationPreferencesFail extends EntityFailAction {\n  readonly type = UPDATE_NOTIFICATION_PREFERENCES_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID, payload);\n  }\n}\n\nexport class UpdateNotificationPreferencesSuccess extends EntitySuccessAction {\n  readonly type = UPDATE_NOTIFICATION_PREFERENCES_SUCCESS;\n  constructor(public payload: NotificationPreference[]) {\n    super(PROCESS_FEATURE, UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID);\n  }\n}\n\nexport class ResetNotificationPreferences extends EntityResetAction {\n  readonly type = RESET_NOTIFICATION_PREFERENCES;\n  constructor() {\n    super(PROCESS_FEATURE, UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID);\n  }\n}\n\nexport class ClearNotificationPreferences extends StateLoaderActions.LoaderResetAction {\n  readonly type = CLEAR_NOTIFICATION_PREFERENCES;\n  constructor() {\n    super(NOTIFICATION_PREFERENCES);\n  }\n}\n\nexport type NotificationPreferenceAction =\n  | LoadNotificationPreferences\n  | LoadNotificationPreferencesFail\n  | LoadNotificationPreferencesSuccess\n  | UpdateNotificationPreferences\n  | UpdateNotificationPreferencesFail\n  | UpdateNotificationPreferencesSuccess\n  | ResetNotificationPreferences\n  | ClearNotificationPreferences;\n","import {\n  PRODUCT_INTERESTS,\n  REMOVE_PRODUCT_INTERESTS_PROCESS_ID,\n  ADD_PRODUCT_INTEREST_PROCESS_ID,\n} from '../user-state';\nimport {\n  ProductInterestSearchResult,\n  ProductInterestEntryRelation,\n  NotificationType,\n} from '../../../model/product-interest.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  LoaderLoadAction,\n  LoaderFailAction,\n  LoaderSuccessAction,\n  LoaderResetAction,\n} from '../../../state/utils/loader/loader.action';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntitySuccessAction,\n  EntityResetAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\n\nexport const LOAD_PRODUCT_INTERESTS = 'Load Product Interests';\nexport const LOAD_PRODUCT_INTERESTS_FAIL = 'Load Product Interests Fail';\nexport const LOAD_PRODUCT_INTERESTS_SUCCESS = 'Load Product Interests Success';\n\nexport const REMOVE_PRODUCT_INTEREST = 'Remove Product Interest';\nexport const REMOVE_PRODUCT_INTEREST_SUCCESS =\n  'Remove Product Interest Success';\nexport const REMOVE_PRODUCT_INTEREST_FAIL = 'Remove Product Interest Fail';\n\nexport const ADD_PRODUCT_INTEREST = 'Add Product Interest';\nexport const ADD_PRODUCT_INTEREST_FAIL = 'Add Product Interest Fail';\nexport const ADD_PRODUCT_INTEREST_SUCCESS = 'Add Product Interest Success';\n\nexport const ADD_PRODUCT_INTEREST_RESET = 'Add Product Interest Reset';\nexport const REMOVE_PRODUCT_INTEREST_RESET = 'Remove Product Interest Reset';\n\nexport const CLEAR_PRODUCT_INTERESTS = 'Clear Product Interests';\n\nexport class LoadProductInterests extends LoaderLoadAction {\n  readonly type = LOAD_PRODUCT_INTERESTS;\n  constructor(\n    public payload: {\n      userId: string;\n      pageSize?: number;\n      currentPage?: number;\n      sort?: string;\n      productCode?: string;\n      notificationType?: NotificationType;\n    }\n  ) {\n    super(PRODUCT_INTERESTS);\n  }\n}\n\nexport class LoadProductInterestsFail extends LoaderFailAction {\n  readonly type = LOAD_PRODUCT_INTERESTS_FAIL;\n  constructor(public payload: any) {\n    super(PRODUCT_INTERESTS, payload);\n  }\n}\n\nexport class LoadProductInterestsSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_PRODUCT_INTERESTS_SUCCESS;\n  constructor(public payload: ProductInterestSearchResult) {\n    super(PRODUCT_INTERESTS);\n  }\n}\n\nexport class RemoveProductInterest extends EntityLoadAction {\n  readonly type = REMOVE_PRODUCT_INTEREST;\n  constructor(\n    public payload: {\n      userId: string;\n      item: ProductInterestEntryRelation;\n      singleDelete?: boolean;\n    }\n  ) {\n    super(PROCESS_FEATURE, REMOVE_PRODUCT_INTERESTS_PROCESS_ID);\n  }\n}\n\nexport class RemoveProductInterestSuccess extends EntitySuccessAction {\n  readonly type = REMOVE_PRODUCT_INTEREST_SUCCESS;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, REMOVE_PRODUCT_INTERESTS_PROCESS_ID);\n  }\n}\n\nexport class RemoveProductInterestFail extends EntityFailAction {\n  readonly type = REMOVE_PRODUCT_INTEREST_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, REMOVE_PRODUCT_INTERESTS_PROCESS_ID, payload);\n  }\n}\n\nexport class AddProductInterest extends EntityLoadAction {\n  readonly type = ADD_PRODUCT_INTEREST;\n  constructor(\n    public payload: {\n      userId: string;\n      productCode: string;\n      notificationType: NotificationType;\n    }\n  ) {\n    super(PROCESS_FEATURE, ADD_PRODUCT_INTEREST_PROCESS_ID);\n  }\n}\n\nexport class AddProductInterestSuccess extends EntitySuccessAction {\n  readonly type = ADD_PRODUCT_INTEREST_SUCCESS;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, ADD_PRODUCT_INTEREST_PROCESS_ID);\n  }\n}\n\nexport class AddProductInterestFail extends EntityFailAction {\n  readonly type = ADD_PRODUCT_INTEREST_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, ADD_PRODUCT_INTEREST_PROCESS_ID, payload);\n  }\n}\n\nexport class ResetAddInterestState extends EntityResetAction {\n  readonly type = ADD_PRODUCT_INTEREST_RESET;\n  constructor() {\n    super(PROCESS_FEATURE, ADD_PRODUCT_INTEREST_PROCESS_ID);\n  }\n}\n\nexport class ResetRemoveInterestState extends EntityResetAction {\n  readonly type = REMOVE_PRODUCT_INTEREST_RESET;\n  constructor() {\n    super(PROCESS_FEATURE, REMOVE_PRODUCT_INTERESTS_PROCESS_ID);\n  }\n}\n\nexport class ClearProductInterests extends LoaderResetAction {\n  readonly type = CLEAR_PRODUCT_INTERESTS;\n  constructor() {\n    super(PRODUCT_INTERESTS);\n  }\n}\n\nexport type ProductInterestsAction =\n  | LoadProductInterests\n  | LoadProductInterestsFail\n  | LoadProductInterestsSuccess\n  | RemoveProductInterest\n  | RemoveProductInterestSuccess\n  | RemoveProductInterestFail\n  | AddProductInterest\n  | AddProductInterestFail\n  | AddProductInterestSuccess\n  | ResetAddInterestState\n  | ResetRemoveInterestState\n  | ClearProductInterests;\n","import {\n  ReturnRequest,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequestModification,\n} from '../../../model/order.model';\nimport {\n  USER_RETURN_REQUESTS,\n  USER_RETURN_REQUEST_DETAILS,\n  CANCEL_RETURN_PROCESS_ID,\n} from '../user-state';\nimport {\n  LoaderFailAction,\n  LoaderLoadAction,\n  LoaderSuccessAction,\n  LoaderResetAction,\n} from '../../../state/utils/loader/loader.action';\nimport { StateEntityLoaderActions } from '../../../state/utils/index';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\n\nexport const CREATE_ORDER_RETURN_REQUEST = '[User] Create Order Return Request';\nexport const CREATE_ORDER_RETURN_REQUEST_FAIL =\n  '[User] Create Order Return Request Fail';\nexport const CREATE_ORDER_RETURN_REQUEST_SUCCESS =\n  '[User] Create Order Return Request Success';\n\nexport const LOAD_ORDER_RETURN_REQUEST =\n  '[User] Load Order Return Request details';\nexport const LOAD_ORDER_RETURN_REQUEST_FAIL =\n  '[User] Load Order Return Request details Fail';\nexport const LOAD_ORDER_RETURN_REQUEST_SUCCESS =\n  '[User] Load Order Return Request details Success';\n\nexport const CANCEL_ORDER_RETURN_REQUEST = '[User] Cancel Order Return Request';\nexport const CANCEL_ORDER_RETURN_REQUEST_FAIL =\n  '[User] Cancel Order Return Request Fail';\nexport const CANCEL_ORDER_RETURN_REQUEST_SUCCESS =\n  '[User] Cancel Order Return Request Success';\n\nexport const LOAD_ORDER_RETURN_REQUEST_LIST =\n  '[User] Load User Order Return Request List';\nexport const LOAD_ORDER_RETURN_REQUEST_LIST_FAIL =\n  '[User] Load User Order Return Request List Fail';\nexport const LOAD_ORDER_RETURN_REQUEST_LIST_SUCCESS =\n  '[User] Load User Order Return Request List Success';\n\nexport const CLEAR_ORDER_RETURN_REQUEST =\n  '[User] Clear Order Return Request Details';\nexport const CLEAR_ORDER_RETURN_REQUEST_LIST =\n  '[User] Clear Order Return Request List';\nexport const RESET_CANCEL_RETURN_PROCESS =\n  '[User] Reset Cancel Return Request Process';\n\nexport class CreateOrderReturnRequest extends LoaderLoadAction {\n  readonly type = CREATE_ORDER_RETURN_REQUEST;\n  constructor(\n    public payload: {\n      userId: string;\n      returnRequestInput: ReturnRequestEntryInputList;\n    }\n  ) {\n    super(USER_RETURN_REQUEST_DETAILS);\n  }\n}\n\nexport class CreateOrderReturnRequestFail extends LoaderFailAction {\n  readonly type = CREATE_ORDER_RETURN_REQUEST_FAIL;\n  constructor(public payload: any) {\n    super(USER_RETURN_REQUEST_DETAILS, payload);\n  }\n}\n\nexport class CreateOrderReturnRequestSuccess extends LoaderSuccessAction {\n  readonly type = CREATE_ORDER_RETURN_REQUEST_SUCCESS;\n  constructor(public payload: ReturnRequest) {\n    super(USER_RETURN_REQUEST_DETAILS);\n  }\n}\n\nexport class LoadOrderReturnRequest extends LoaderLoadAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST;\n  constructor(\n    public payload: {\n      userId: string;\n      returnRequestCode: string;\n    }\n  ) {\n    super(USER_RETURN_REQUEST_DETAILS);\n  }\n}\n\nexport class LoadOrderReturnRequestFail extends LoaderFailAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST_FAIL;\n  constructor(public payload: any) {\n    super(USER_RETURN_REQUEST_DETAILS, payload);\n  }\n}\n\nexport class LoadOrderReturnRequestSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST_SUCCESS;\n  constructor(public payload: ReturnRequest) {\n    super(USER_RETURN_REQUEST_DETAILS);\n  }\n}\n\nexport class CancelOrderReturnRequest extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = CANCEL_ORDER_RETURN_REQUEST;\n  constructor(\n    public payload: {\n      userId: string;\n      returnRequestCode: string;\n      returnRequestModification: ReturnRequestModification;\n    }\n  ) {\n    super(PROCESS_FEATURE, CANCEL_RETURN_PROCESS_ID);\n  }\n}\n\nexport class CancelOrderReturnRequestFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = CANCEL_ORDER_RETURN_REQUEST_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, CANCEL_RETURN_PROCESS_ID, payload);\n  }\n}\n\nexport class CancelOrderReturnRequestSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = CANCEL_ORDER_RETURN_REQUEST_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, CANCEL_RETURN_PROCESS_ID);\n  }\n}\n\nexport class LoadOrderReturnRequestList extends LoaderLoadAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST_LIST;\n  constructor(\n    public payload: {\n      userId: string;\n      pageSize?: number;\n      currentPage?: number;\n      sort?: string;\n    }\n  ) {\n    super(USER_RETURN_REQUESTS);\n  }\n}\n\nexport class LoadOrderReturnRequestListFail extends LoaderFailAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST_LIST_FAIL;\n  constructor(public payload: any) {\n    super(USER_RETURN_REQUESTS, payload);\n  }\n}\n\nexport class LoadOrderReturnRequestListSuccess extends LoaderSuccessAction {\n  readonly type = LOAD_ORDER_RETURN_REQUEST_LIST_SUCCESS;\n  constructor(public payload: ReturnRequestList) {\n    super(USER_RETURN_REQUESTS);\n  }\n}\n\nexport class ClearOrderReturnRequest extends LoaderResetAction {\n  readonly type = CLEAR_ORDER_RETURN_REQUEST;\n  constructor() {\n    super(USER_RETURN_REQUEST_DETAILS);\n  }\n}\n\nexport class ClearOrderReturnRequestList extends LoaderResetAction {\n  readonly type = CLEAR_ORDER_RETURN_REQUEST_LIST;\n  constructor() {\n    super(USER_RETURN_REQUESTS);\n  }\n}\n\nexport class ResetCancelReturnProcess extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_CANCEL_RETURN_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, CANCEL_RETURN_PROCESS_ID);\n  }\n}\n\nexport type OrderReturnRequestAction =\n  | CreateOrderReturnRequest\n  | CreateOrderReturnRequestFail\n  | CreateOrderReturnRequestSuccess\n  | LoadOrderReturnRequest\n  | LoadOrderReturnRequestFail\n  | LoadOrderReturnRequestSuccess\n  | CancelOrderReturnRequest\n  | CancelOrderReturnRequestFail\n  | CancelOrderReturnRequestSuccess\n  | LoadOrderReturnRequestList\n  | LoadOrderReturnRequestListFail\n  | LoadOrderReturnRequestListSuccess\n  | ClearOrderReturnRequest\n  | ClearOrderReturnRequestList\n  | ResetCancelReturnProcess;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateWithUser, UserState, USER_FEATURE } from '../user-state';\n\nexport const getUserState: MemoizedSelector<\n  StateWithUser,\n  UserState\n> = createFeatureSelector<UserState>(USER_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Country } from '../../../model/address.model';\nimport {\n  BillingCountriesState,\n  BillingCountryEntities,\n  StateWithUser,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getBillingCountriesState: MemoizedSelector<\n  StateWithUser,\n  BillingCountriesState\n> = createSelector(getUserState, (state: UserState) => state.billingCountries);\n\nexport const getBillingCountriesEntites: MemoizedSelector<\n  StateWithUser,\n  BillingCountryEntities\n> = createSelector(\n  getBillingCountriesState,\n  (state: BillingCountriesState) => state.entities\n);\n\nexport const getAllBillingCountries: MemoizedSelector<\n  StateWithUser,\n  Country[]\n> = createSelector(getBillingCountriesEntites, entites =>\n  Object.keys(entites).map(isocode => entites[isocode])\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ConsignmentTracking } from '../../../model/index';\nimport {\n  ConsignmentTrackingState,\n  StateWithUser,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getConsignmentTrackingState: MemoizedSelector<\n  StateWithUser,\n  ConsignmentTrackingState\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.consignmentTracking\n);\n\nexport const getConsignmentTracking: MemoizedSelector<\n  StateWithUser,\n  ConsignmentTracking\n> = createSelector(\n  getConsignmentTrackingState,\n  (state: ConsignmentTrackingState) => state.tracking\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Country } from '../../../model/address.model';\nimport {\n  DeliveryCountriesState,\n  DeliveryCountryEntities,\n  StateWithUser,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getDeliveryCountriesState: MemoizedSelector<\n  StateWithUser,\n  DeliveryCountriesState\n> = createSelector(getUserState, (state: UserState) => state.countries);\n\nexport const getDeliveryCountriesEntites: MemoizedSelector<\n  StateWithUser,\n  DeliveryCountryEntities\n> = createSelector(\n  getDeliveryCountriesState,\n  (state: DeliveryCountriesState) => state.entities\n);\n\nexport const getAllDeliveryCountries: MemoizedSelector<\n  StateWithUser,\n  Country[]\n> = createSelector(getDeliveryCountriesEntites, entites =>\n  Object.keys(entites).map(isocode => entites[isocode])\n);\n\nexport const countrySelectorFactory = (\n  isocode: string\n): MemoizedSelector<StateWithUser, Country> =>\n  createSelector(getDeliveryCountriesEntites, entities =>\n    Object.keys(entities).length !== 0 ? entities[isocode] : null\n  );\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Order } from '../../../model/order.model';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\n\nexport const getOrderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<Order>\n> = createSelector(getUserState, (state: UserState) => state.order);\n\nexport const getOrderDetails: MemoizedSelector<\n  StateWithUser,\n  Order\n> = createSelector(getOrderState, (state: LoaderState<Order>) =>\n  StateLoaderSelectors.loaderValueSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ReturnRequest, ReturnRequestList } from '../../../model/order.model';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\n\nexport const getOrderReturnRequestState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ReturnRequest>\n> = createSelector(getUserState, (state: UserState) => state.orderReturn);\n\nexport const getOrderReturnRequest: MemoizedSelector<\n  StateWithUser,\n  ReturnRequest\n> = createSelector(\n  getOrderReturnRequestState,\n  (state: LoaderState<ReturnRequest>) =>\n    StateLoaderSelectors.loaderValueSelector(state)\n);\n\nexport const getOrderReturnRequestLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getOrderReturnRequestState,\n  (state: LoaderState<ReturnRequest>) =>\n    StateLoaderSelectors.loaderLoadingSelector(state)\n);\n\nexport const getOrderReturnRequestSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getOrderReturnRequestState,\n  (state: LoaderState<ReturnRequest>) =>\n    StateLoaderSelectors.loaderSuccessSelector(state) &&\n    !StateLoaderSelectors.loaderLoadingSelector(state)\n);\n\nexport const getOrderReturnRequestListState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ReturnRequestList>\n> = createSelector(getUserState, (state: UserState) => state.orderReturnList);\n\nexport const getOrderReturnRequestList: MemoizedSelector<\n  StateWithUser,\n  ReturnRequestList\n> = createSelector(\n  getOrderReturnRequestListState,\n  (state: LoaderState<ReturnRequestList>) =>\n    StateLoaderSelectors.loaderValueSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getPaymentMethodsState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<PaymentDetails[]>\n> = createSelector(getUserState, (state: UserState) => state.payments);\n\nexport const getPaymentMethods: MemoizedSelector<\n  StateWithUser,\n  PaymentDetails[]\n> = createSelector(\n  getPaymentMethodsState,\n  (state: LoaderState<PaymentDetails[]>) =>\n    StateLoaderSelectors.loaderValueSelector(state)\n);\n\nexport const getPaymentMethodsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getPaymentMethodsState,\n  (state: LoaderState<PaymentDetails[]>) =>\n    StateLoaderSelectors.loaderLoadingSelector(state)\n);\n\nexport const getPaymentMethodsLoadedSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getPaymentMethodsState,\n  (state: LoaderState<PaymentDetails[]>) =>\n    StateLoaderSelectors.loaderSuccessSelector(state) &&\n    !StateLoaderSelectors.loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Region } from '../../../model/address.model';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { RegionsState, StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getRegionsLoaderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<RegionsState>\n> = createSelector(getUserState, (state: UserState) => state.regions);\n\nexport const getAllRegions: MemoizedSelector<\n  StateWithUser,\n  Region[]\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) => {\n    return StateLoaderSelectors.loaderValueSelector(state).entities;\n  }\n);\n\nexport const getRegionsDataAndLoading: MemoizedSelector<\n  StateWithUser,\n  {\n    loaded: boolean;\n    loading: boolean;\n    regions: Region[];\n    country: string;\n  }\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) => ({\n    loaded: StateLoaderSelectors.loaderSuccessSelector(state),\n    loading: StateLoaderSelectors.loaderLoadingSelector(state),\n    regions: StateLoaderSelectors.loaderValueSelector(state).entities,\n    country: StateLoaderSelectors.loaderValueSelector(state).country,\n  })\n);\n\nexport const getRegionsCountry: MemoizedSelector<\n  StateWithUser,\n  string\n> = createSelector(\n  getRegionsLoaderState,\n  (state: LoaderState<RegionsState>) =>\n    StateLoaderSelectors.loaderValueSelector(state).country\n);\n\nexport const getRegionsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getRegionsLoaderState, (state: LoaderState<RegionsState>) =>\n  StateLoaderSelectors.loaderLoadingSelector(state)\n);\n\nexport const getRegionsLoaded: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getRegionsLoaderState, (state: LoaderState<RegionsState>) =>\n  StateLoaderSelectors.loaderSuccessSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getResetPassword: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getUserState, (state: UserState) => state.resetPassword);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Title } from '../../../model/misc.model';\nimport {\n  StateWithUser,\n  TitleEntities,\n  TitlesState,\n  UserState,\n} from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getTitlesState: MemoizedSelector<\n  StateWithUser,\n  TitlesState\n> = createSelector(getUserState, (state: UserState) => state.titles);\n\nexport const getTitlesEntites: MemoizedSelector<\n  StateWithUser,\n  TitleEntities\n> = createSelector(getTitlesState, (state: TitlesState) => state.entities);\n\nexport const getAllTitles: MemoizedSelector<\n  StateWithUser,\n  Title[]\n> = createSelector(getTitlesEntites, entites =>\n  Object.keys(entites).map(code => entites[code])\n);\n\nexport const titleSelectorFactory = (\n  code: string\n): MemoizedSelector<StateWithUser, Title> =>\n  createSelector(getTitlesEntites, entities =>\n    Object.keys(entities).length !== 0 ? entities[code] : null\n  );\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Address } from '../../../model/address.model';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getAddressesLoaderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<Address[]>\n> = createSelector(getUserState, (state: UserState) => state.addresses);\n\nexport const getAddresses: MemoizedSelector<\n  StateWithUser,\n  Address[]\n> = createSelector(getAddressesLoaderState, (state: LoaderState<Address[]>) =>\n  StateLoaderSelectors.loaderValueSelector(state)\n);\n\nexport const getAddressesLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getAddressesLoaderState, (state: LoaderState<Address[]>) =>\n  StateLoaderSelectors.loaderLoadingSelector(state)\n);\n\nexport const getAddressesLoadedSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getAddressesLoaderState,\n  (state: LoaderState<Address[]>) =>\n    StateLoaderSelectors.loaderSuccessSelector(state) &&\n    !StateLoaderSelectors.loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getConsentsState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ConsentTemplate[]>\n> = createSelector(getUserState, (state: UserState) => state.consents);\n\nexport const getConsentsValue: MemoizedSelector<\n  StateWithUser,\n  ConsentTemplate[]\n> = createSelector(getConsentsState, StateLoaderSelectors.loaderValueSelector);\n\nexport const getConsentByTemplateId = (\n  templateId: string\n): MemoizedSelector<StateWithUser, ConsentTemplate> =>\n  createSelector(getConsentsValue, templates =>\n    templates.find(template => template.id === templateId)\n  );\n\nexport const getConsentsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getConsentsState,\n  StateLoaderSelectors.loaderLoadingSelector\n);\n\nexport const getConsentsSuccess: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getConsentsState,\n  StateLoaderSelectors.loaderSuccessSelector\n);\n\nexport const getConsentsError: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getConsentsState, StateLoaderSelectors.loaderErrorSelector);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { User } from '../../../model/misc.model';\nimport { StateWithUser, UserDetailsState, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getDetailsState: MemoizedSelector<\n  StateWithUser,\n  UserDetailsState\n> = createSelector(getUserState, (state: UserState) => state.account);\n\nexport const getDetails: MemoizedSelector<StateWithUser, User> = createSelector(\n  getDetailsState,\n  (state: UserDetailsState) => state.details\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { OrderHistoryList } from '../../../model/order.model';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\n\nexport const getOrdersState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<OrderHistoryList>\n> = createSelector(getUserState, (state: UserState) => state.orders);\n\nexport const getOrdersLoaded: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(getOrdersState, (state: LoaderState<OrderHistoryList>) =>\n  StateLoaderSelectors.loaderSuccessSelector(state)\n);\n\nexport const getOrders: MemoizedSelector<\n  StateWithUser,\n  OrderHistoryList\n> = createSelector(getOrdersState, (state: LoaderState<OrderHistoryList>) =>\n  StateLoaderSelectors.loaderValueSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\n\nimport { UserState, StateWithUser } from '../user-state';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderValueSelector,\n  loaderSuccessSelector,\n  loaderLoadingSelector,\n} from '../../../state/utils/loader/loader.selectors';\n\nimport { getUserState } from './feature.selector';\nimport { CustomerCouponSearchResult } from '../../../model/customer-coupon.model';\n\nexport const getCustomerCouponsState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<CustomerCouponSearchResult>\n> = createSelector(getUserState, (state: UserState) => state.customerCoupons);\n\nexport const getCustomerCouponsLoaded: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getCustomerCouponsState,\n  (state: LoaderState<CustomerCouponSearchResult>) =>\n    loaderSuccessSelector(state)\n);\n\nexport const getCustomerCouponsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getCustomerCouponsState,\n  (state: LoaderState<CustomerCouponSearchResult>) =>\n    loaderLoadingSelector(state)\n);\n\nexport const getCustomerCoupons: MemoizedSelector<\n  StateWithUser,\n  CustomerCouponSearchResult\n> = createSelector(\n  getCustomerCouponsState,\n  (state: LoaderState<CustomerCouponSearchResult>) => loaderValueSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { StateWithUser, UserState } from '../user-state';\nimport { getUserState } from './feature.selector';\nimport {\n  loaderValueSelector,\n  loaderLoadingSelector,\n} from '../../../state/utils/loader/loader.selectors';\n\nexport const getPreferencesLoaderState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<NotificationPreference[]>\n> = createSelector(\n  getUserState,\n  (state: UserState) => state.notificationPreferences\n);\n\nexport const getPreferences: MemoizedSelector<\n  StateWithUser,\n  NotificationPreference[]\n> = createSelector(\n  getPreferencesLoaderState,\n  (state: LoaderState<NotificationPreference[]>) => loaderValueSelector(state)\n);\n\nexport const getEnabledPreferences: MemoizedSelector<\n  StateWithUser,\n  NotificationPreference[]\n> = createSelector(\n  getPreferencesLoaderState,\n  (state: LoaderState<NotificationPreference[]>) =>\n    loaderValueSelector(state).filter(p => p.enabled)\n);\n\nexport const getPreferencesLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getPreferencesLoaderState,\n  (state: LoaderState<NotificationPreference[]>) => loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { UserState, StateWithUser } from '../user-state';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  loaderValueSelector,\n  loaderLoadingSelector,\n} from '../../../state/utils/loader/loader.selectors';\nimport { getUserState } from './feature.selector';\nimport { ProductInterestSearchResult } from '../../../model/product-interest.model';\n\nexport const getInterestsState: MemoizedSelector<\n  StateWithUser,\n  LoaderState<ProductInterestSearchResult>\n> = createSelector(getUserState, (state: UserState) => state.productInterests);\n\nexport const getInterests: MemoizedSelector<\n  StateWithUser,\n  ProductInterestSearchResult\n> = createSelector(\n  getInterestsState,\n  (state: LoaderState<ProductInterestSearchResult>) =>\n    loaderValueSelector(state)\n);\n\nexport const getInterestsLoading: MemoizedSelector<\n  StateWithUser,\n  boolean\n> = createSelector(\n  getInterestsState,\n  (state: LoaderState<ProductInterestSearchResult>) =>\n    loaderLoadingSelector(state)\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { iif, Observable } from 'rxjs';\nimport {\n  filter,\n  map,\n  switchMap,\n  take,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { Consent, ConsentTemplate } from '../../model/consent.model';\nimport { OCC_USER_ID_CURRENT } from '../../occ/index';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  GIVE_CONSENT_PROCESS_ID,\n  StateWithUser,\n  WITHDRAW_CONSENT_PROCESS_ID,\n} from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserConsentService {\n  constructor(\n    store: Store<StateWithUser | StateWithProcess<void>>,\n    // tslint:disable-next-line:unified-signatures\n    authService: AuthService\n  );\n\n  /**\n   * @deprecated since version 1.3\n   *  Use constructor(store: Store<StateWithUser | StateWithProcess<void>>,\n   *  authService: AuthService) instead\n   *\n   *  TODO(issue:#5628) Deprecated since 1.3.0\n   */\n  constructor(store: Store<StateWithUser | StateWithProcess<void>>);\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected authService?: AuthService\n  ) {}\n\n  /**\n   * Retrieves all consents.\n   */\n  loadConsents(): void {\n    this.withUserId(userId =>\n      this.store.dispatch(new UserActions.LoadUserConsents(userId))\n    );\n  }\n\n  /**\n   * Returns all consent templates. If `loadIfMissing` parameter is set to `true`, the method triggers the load if consent templates.\n   * @param loadIfMissing is set to `true`, the method will load templates if those are not already present. The default value is `false`.\n   */\n  getConsents(loadIfMissing = false): Observable<ConsentTemplate[]> {\n    return iif(\n      () => loadIfMissing,\n      this.store.pipe(\n        select(UsersSelectors.getConsentsValue),\n        withLatestFrom(\n          this.getConsentsResultLoading(),\n          this.getConsentsResultSuccess()\n        ),\n        filter(([_templates, loading, _success]) => !loading),\n        tap(([templates, _loading, success]) => {\n          if (!templates || templates.length === 0) {\n            // avoid infite loop - if we've already attempted to load templates and we got an empty array as the response\n            if (!success) {\n              this.loadConsents();\n            }\n          }\n        }),\n        filter(([templates, _loading]) => Boolean(templates)),\n        map(([templates, _loading]) => templates)\n      ),\n      this.store.pipe(select(UsersSelectors.getConsentsValue))\n    );\n  }\n\n  /**\n   * Returns the consents loading flag\n   */\n  getConsentsResultLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getConsentsLoading));\n  }\n\n  /**\n   * Returns the consents success flag\n   */\n  getConsentsResultSuccess(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getConsentsSuccess));\n  }\n\n  /**\n   * Returns the consents error flag\n   */\n  getConsentsResultError(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getConsentsError));\n  }\n\n  /**\n   * Resets the processing state for consent retrieval\n   */\n  resetConsentsProcessState(): void {\n    this.store.dispatch(new UserActions.ResetLoadUserConsents());\n  }\n\n  /**\n   * Returns the registered consent for the given template ID.\n   *\n   * As a side-effect, the method will call `getConsents(true)` to load the templates if those are not present.\n   *\n   * @param templateId a template ID by which to filter the registered templates.\n   */\n  getConsent(templateId: string): Observable<Consent> {\n    return this.authService.isUserLoggedIn().pipe(\n      filter(Boolean),\n      tap(_ => this.getConsents(true)),\n      switchMap(_ =>\n        this.store.pipe(\n          select(UsersSelectors.getConsentByTemplateId(templateId))\n        )\n      ),\n      filter(template => Boolean(template)),\n      map(template => template.currentConsent)\n    );\n  }\n\n  /**\n   * Returns `true` if the consent is truthy and if `consentWithdrawnDate` doesn't exist.\n   * Otherwise, `false` is returned.\n   *\n   * @param consent to check\n   */\n  isConsentGiven(consent: Consent): boolean {\n    return (\n      Boolean(consent) &&\n      Boolean(consent.consentGivenDate) &&\n      !Boolean(consent.consentWithdrawnDate)\n    );\n  }\n\n  /**\n   * Returns `true` if the consent is either falsy or if `consentWithdrawnDate` is present.\n   * Otherwise, `false` is returned.\n   *\n   * @param consent to check\n   */\n  isConsentWithdrawn(consent: Consent): boolean {\n    if (Boolean(consent)) {\n      return Boolean(consent.consentWithdrawnDate);\n    }\n    return true;\n  }\n\n  /**\n   * Give consent for specified consent template ID and version.\n   * @param consentTemplateId a template ID for which to give a consent\n   * @param consentTemplateVersion a template version for which to give a consent\n   */\n  giveConsent(consentTemplateId: string, consentTemplateVersion: number): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.GiveUserConsent({\n          userId,\n          consentTemplateId,\n          consentTemplateVersion,\n        })\n      )\n    );\n  }\n\n  /**\n   * Returns the give consent process loading flag\n   */\n  getGiveConsentResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(GIVE_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the give consent process success flag\n   */\n  getGiveConsentResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(GIVE_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the give consent process error flag\n   */\n  getGiveConsentResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(GIVE_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resents the give consent process flags\n   */\n  resetGiveConsentProcessState(): void {\n    return this.store.dispatch(new UserActions.ResetGiveUserConsentProcess());\n  }\n\n  /**\n   * Withdraw consent for the given `consentCode`\n   * @param consentCode for which to withdraw the consent\n   */\n  withdrawConsent(consentCode: string): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.WithdrawUserConsent({\n          userId,\n          consentCode,\n        })\n      )\n    );\n  }\n\n  /**\n   * Returns the withdraw consent process loading flag\n   */\n  getWithdrawConsentResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(WITHDRAW_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the withdraw consent process success flag\n   */\n  getWithdrawConsentResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(WITHDRAW_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the withdraw consent process error flag\n   */\n  getWithdrawConsentResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(WITHDRAW_CONSENT_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the process flags for withdraw consent\n   */\n  resetWithdrawConsentProcessState(): void {\n    return this.store.dispatch(\n      new UserActions.ResetWithdrawUserConsentProcess()\n    );\n  }\n\n  /**\n   * Filters the provided `templateList`' templates by hiding the template IDs specified in `hideTemplateIds`.\n   * If the `hideTemplateIds` is empty, the provided `templateList` is returned.\n   *\n   * @param templateList a list of consent templates to filter\n   * @param hideTemplateIds template IDs to hide\n   */\n  filterConsentTemplates(\n    templateList: ConsentTemplate[],\n    hideTemplateIds: string[] = []\n  ): ConsentTemplate[] {\n    if (hideTemplateIds.length === 0) {\n      return templateList;\n    }\n\n    const updatedTemplateList: ConsentTemplate[] = [];\n    for (const template of templateList) {\n      const show = !hideTemplateIds.includes(template.id);\n      if (show) {\n        updatedTemplateList.push(template);\n      }\n    }\n\n    return updatedTemplateList;\n  }\n\n  /**\n   * Utility method to distinquish pre / post 1.3.0 in a convenient way.\n   *\n   */\n  private withUserId(callback: (userId: string) => void): void {\n    if (this.authService) {\n      this.authService\n        .getOccUserId()\n        .pipe(take(1))\n        .subscribe(userId => callback(userId));\n    } else {\n      // TODO(issue:#5628) Deprecated since 1.3.0\n      callback(OCC_USER_ID_CURRENT);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ConsentTemplate } from '../../model/consent.model';\nimport { AnonymousConsentTemplatesAdapter } from './anonymous-consent-templates.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AnonymousConsentTemplatesConnector {\n  constructor(protected adapter: AnonymousConsentTemplatesAdapter) {}\n\n  loadAnonymousConsentTemplates(): Observable<ConsentTemplate[]> {\n    return this.adapter.loadAnonymousConsentTemplates();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { EMPTY, Observable, of } from 'rxjs';\nimport {\n  catchError,\n  concatMap,\n  filter,\n  map,\n  mergeMap,\n  switchMap,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { AuthActions, AuthService } from '../../../auth/index';\nimport {\n  ANONYMOUS_CONSENTS_FEATURE,\n  isFeatureEnabled,\n} from '../../../features-config/index';\nimport { UserConsentService } from '../../../user/facade/user-consent.service';\nimport { UserActions } from '../../../user/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { AnonymousConsentsConfig } from '../../config/anonymous-consents-config';\nimport { AnonymousConsentTemplatesConnector } from '../../connectors/anonymous-consent-templates.connector';\nimport { AnonymousConsentsService } from '../../facade/index';\nimport { AnonymousConsentsActions } from '../actions/index';\n\n@Injectable()\nexport class AnonymousConsentsEffects {\n  @Effect()\n  loadAnonymousConsentTemplates$: Observable<\n    AnonymousConsentsActions.AnonymousConsentsActions\n  > = this.actions$.pipe(\n    ofType(AnonymousConsentsActions.LOAD_ANONYMOUS_CONSENT_TEMPLATES),\n    concatMap(_ =>\n      this.anonymousConsentTemplatesConnector\n        .loadAnonymousConsentTemplates()\n        .pipe(\n          withLatestFrom(this.anonymousConsentService.getTemplates()),\n          mergeMap(([newConsentTemplates, currentConsentTemplates]) => {\n            let updated = false;\n            if (\n              Boolean(currentConsentTemplates) &&\n              currentConsentTemplates.length !== 0\n            ) {\n              updated = this.anonymousConsentService.detectUpdatedTemplates(\n                currentConsentTemplates,\n                newConsentTemplates\n              );\n            }\n\n            return [\n              new AnonymousConsentsActions.LoadAnonymousConsentTemplatesSuccess(\n                newConsentTemplates\n              ),\n              new AnonymousConsentsActions.ToggleAnonymousConsentTemplatesUpdated(\n                updated\n              ),\n            ];\n          }),\n          catchError(error =>\n            of(\n              new AnonymousConsentsActions.LoadAnonymousConsentTemplatesFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    )\n  );\n\n  @Effect()\n  transferAnonymousConsentsToUser$: Observable<\n    UserActions.TransferAnonymousConsent | Observable<never>\n  > = this.actions$.pipe(\n    ofType<AuthActions.LoadUserTokenSuccess>(\n      AuthActions.LOAD_USER_TOKEN_SUCCESS\n    ),\n    filter(\n      () =>\n        isFeatureEnabled(\n          this.anonymousConsentsConfig,\n          ANONYMOUS_CONSENTS_FEATURE\n        ) && Boolean(this.anonymousConsentsConfig.anonymousConsents)\n    ),\n    withLatestFrom(\n      this.actions$.pipe(\n        ofType<UserActions.RegisterUserSuccess>(\n          UserActions.REGISTER_USER_SUCCESS\n        )\n      )\n    ),\n    filter(([, registerAction]) => Boolean(registerAction)),\n    switchMap(() =>\n      this.anonymousConsentService.getConsents().pipe(\n        withLatestFrom(\n          this.authService.getOccUserId(),\n          this.anonymousConsentService.getTemplates(),\n          this.authService.isUserLoggedIn()\n        ),\n        filter(([, , , loggedIn]) => loggedIn),\n        concatMap(([consents, userId, templates, _loggedIn]) => {\n          const actions: UserActions.TransferAnonymousConsent[] = [];\n          for (const consent of consents) {\n            if (\n              this.anonymousConsentService.isConsentGiven(consent) &&\n              (!this.anonymousConsentsConfig.anonymousConsents\n                .requiredConsents ||\n                !this.anonymousConsentsConfig.anonymousConsents.requiredConsents.includes(\n                  consent.templateCode\n                ))\n            ) {\n              for (const template of templates) {\n                if (template.id === consent.templateCode) {\n                  actions.push(\n                    new UserActions.TransferAnonymousConsent({\n                      userId,\n                      consentTemplateId: template.id,\n                      consentTemplateVersion: template.version,\n                    })\n                  );\n                  break;\n                }\n              }\n            }\n          }\n          if (actions.length > 0) {\n            return actions;\n          }\n          return EMPTY;\n        })\n      )\n    )\n  );\n\n  @Effect()\n  giveRequiredConsentsToUser$: Observable<\n    UserActions.GiveUserConsent | Observable<never>\n  > = this.actions$.pipe(\n    ofType<AuthActions.LoadUserTokenSuccess>(\n      AuthActions.LOAD_USER_TOKEN_SUCCESS\n    ),\n    filter(\n      action =>\n        isFeatureEnabled(\n          this.anonymousConsentsConfig,\n          ANONYMOUS_CONSENTS_FEATURE\n        ) &&\n        Boolean(this.anonymousConsentsConfig.anonymousConsents) &&\n        Boolean(\n          this.anonymousConsentsConfig.anonymousConsents.requiredConsents\n        ) &&\n        Boolean(action)\n    ),\n    concatMap(() =>\n      this.userConsentService.getConsentsResultSuccess().pipe(\n        withLatestFrom(\n          this.authService.getOccUserId(),\n          this.userConsentService.getConsents(),\n          this.authService.isUserLoggedIn()\n        ),\n        filter(([, , , loggedIn]) => loggedIn),\n        tap(([loaded, _userId, _templates, _loggedIn]) => {\n          if (!loaded) {\n            this.userConsentService.loadConsents();\n          }\n        }),\n        map(([_loaded, userId, templates, _loggedIn]) => {\n          return { userId, templates };\n        }),\n        concatMap(({ userId, templates }) => {\n          const actions: UserActions.GiveUserConsent[] = [];\n          for (const template of templates) {\n            if (\n              this.userConsentService.isConsentWithdrawn(\n                template.currentConsent\n              ) &&\n              this.anonymousConsentsConfig.anonymousConsents.requiredConsents.includes(\n                template.id\n              )\n            ) {\n              actions.push(\n                new UserActions.GiveUserConsent({\n                  userId,\n                  consentTemplateId: template.id,\n                  consentTemplateVersion: template.version,\n                })\n              );\n            }\n          }\n          if (actions.length > 0) {\n            return actions;\n          }\n          return EMPTY;\n        })\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private anonymousConsentTemplatesConnector: AnonymousConsentTemplatesConnector,\n    private authService: AuthService,\n    private anonymousConsentsConfig: AnonymousConsentsConfig,\n    private anonymousConsentService: AnonymousConsentsService,\n    private userConsentService: UserConsentService\n  ) {}\n}\n","import { AnonymousConsentsEffects } from './anonymous-consents.effect';\n\nexport const effects: any[] = [AnonymousConsentsEffects];\n\nexport * from './anonymous-consents.effect';\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Country, CountryType, Region } from '../../model/address.model';\nimport { BaseSite, Currency, Language } from '../../model/misc.model';\nimport { SiteAdapter } from './site.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SiteConnector {\n  constructor(protected adapter: SiteAdapter) {}\n\n  getLanguages(): Observable<Language[]> {\n    return this.adapter.loadLanguages();\n  }\n\n  getCurrencies(): Observable<Currency[]> {\n    return this.adapter.loadCurrencies();\n  }\n\n  getCountries(type?: CountryType): Observable<Country[]> {\n    return this.adapter.loadCountries(type);\n  }\n\n  getRegions(countryIsoCode: string): Observable<Region[]> {\n    return this.adapter.loadRegions(countryIsoCode);\n  }\n\n  getBaseSite(): Observable<BaseSite> {\n    return this.adapter.loadBaseSite();\n  }\n}\n","import { Provider, Type } from '@angular/core';\nimport { LanguageService } from '../facade/language.service';\nimport { CurrencyService } from '../facade/currency.service';\nimport { SiteContext } from '../facade/site-context.interface';\nimport { BaseSiteService } from '../facade/base-site.service';\nimport {\n  BASE_SITE_CONTEXT_ID,\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from './context-ids';\n\nexport abstract class ContextServiceMap {\n  [context: string]: Type<SiteContext<any>>;\n}\n\nexport function serviceMapFactory() {\n  return {\n    [LANGUAGE_CONTEXT_ID]: LanguageService,\n    [CURRENCY_CONTEXT_ID]: CurrencyService,\n    [BASE_SITE_CONTEXT_ID]: BaseSiteService,\n  };\n}\n\nexport const contextServiceMapProvider: Provider = {\n  provide: ContextServiceMap,\n  useFactory: serviceMapFactory,\n};\n","import { SiteContextConfig } from './site-context-config';\nimport { getContextParameterDefault } from './context-config-utils';\nimport { BASE_SITE_CONTEXT_ID } from '../providers/context-ids';\n\nexport function baseSiteConfigValidator(config: SiteContextConfig) {\n  if (getContextParameterDefault(config, BASE_SITE_CONTEXT_ID) === undefined) {\n    return 'Please configure context.parameters.baseSite before using storefront library!';\n  }\n}\n","import { SiteContextConfig } from './site-context-config';\nimport {\n  CURRENCY_CONTEXT_ID,\n  LANGUAGE_CONTEXT_ID,\n} from '../providers/context-ids';\n\nexport function defaultSiteContextConfigFactory(): SiteContextConfig {\n  return {\n    context: {\n      [LANGUAGE_CONTEXT_ID]: [\n        'en',\n        'de',\n        'ja',\n        'zh',\n        'ru',\n        'fr',\n        'tr',\n        'it',\n        'es',\n        'uk',\n        'pl',\n        'nl',\n        'hi',\n        'ar',\n        'pt',\n        'bn',\n        'pa',\n      ],\n      [CURRENCY_CONTEXT_ID]: [\n        'USD',\n        'EUR',\n        'JPY',\n        'GBP',\n        'AUD',\n        'CAD',\n        'CHF',\n        'CNY',\n        'SEK',\n        'NZD',\n        'MXN',\n        'SGD',\n        'HKD',\n        'NOK',\n        'KRW',\n        'TRY',\n        'RUB',\n        'INR',\n        'BRL',\n        'ZAR',\n      ],\n    },\n  };\n}\n","import { Inject, Injectable, isDevMode, Optional } from '@angular/core';\nimport {\n  CONFIG_INITIALIZER_FORROOT_GUARD,\n  ConfigInitializer,\n} from './config-initializer';\nimport { Config } from '../config.module';\nimport { BehaviorSubject } from 'rxjs';\nimport { filter, mapTo, take } from 'rxjs/operators';\nimport { deepMerge } from '../utils/deep-merge';\n\n/**\n * Provides support for CONFIG_INITIALIZERS\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConfigInitializerService {\n  constructor(\n    @Inject(Config) protected config: any,\n    @Optional()\n    @Inject(CONFIG_INITIALIZER_FORROOT_GUARD)\n    protected initializerGuard\n  ) {}\n\n  protected ongoingScopes$ = new BehaviorSubject<string[]>(undefined);\n\n  /**\n   * Returns true if config is stable, i.e. all CONFIG_INITIALIZERS resolved correctly\n   */\n  get isStable(): boolean {\n    return (\n      !this.initializerGuard ||\n      (this.ongoingScopes$.value && this.ongoingScopes$.value.length === 0)\n    );\n  }\n\n  /**\n   * Recommended way to get config for code that can run before app will finish\n   * initialization (APP_INITIALIZERS, selected service constructors)\n   *\n   * Used without parameters waits for the whole config to become stable\n   *\n   * Parameters allow to describe which part of the config should be stable using\n   * string describing config part, e.g.:\n   * 'siteContext', 'siteContext.language', etc.\n   *\n   * @param scopes String describing parts of the config we want to be sure are stable\n   */\n  async getStableConfig(...scopes: string[]): Promise<any> {\n    if (this.isStable) {\n      return this.config;\n    }\n    return this.ongoingScopes$\n      .pipe(\n        filter(\n          ongoingScopes => ongoingScopes && this.areReady(scopes, ongoingScopes)\n        ),\n        take(1),\n        mapTo(this.config)\n      )\n      .toPromise();\n  }\n\n  /**\n   * Removes provided scopes from currently ongoingScopes\n   *\n   * @param scopes\n   */\n  protected finishScopes(scopes: string[]) {\n    const newScopes = [...this.ongoingScopes$.value];\n    for (const scope of scopes) {\n      newScopes.splice(newScopes.indexOf(scope), 1);\n    }\n    this.ongoingScopes$.next(newScopes);\n  }\n\n  /**\n   * Return true if provided scopes are not part of ongoingScopes\n   *\n   * @param scopes\n   * @param ongoingScopes\n   */\n  protected areReady(scopes: string[], ongoingScopes: string[]): boolean {\n    if (!scopes.length) {\n      return !ongoingScopes.length;\n    }\n    for (const scope of scopes) {\n      for (const ongoingScope of ongoingScopes) {\n        if (this.scopesOverlap(scope, ongoingScope)) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Check if two scopes overlap.\n   *\n   * Example of scopes that overlap:\n   * 'test' and 'test', 'test.a' and 'test', 'test' and 'test.a'\n   *\n   * Example of scopes that do not overlap:\n   * 'test' and 'testA', 'test.a' and 'test.b', 'test.nested' and 'test.nest'\n   *\n   * @param a ScopeA\n   * @param b ScopeB\n   */\n  protected scopesOverlap(a: string, b: string): boolean {\n    if (b.length > a.length) {\n      [a, b] = [b, a];\n    }\n    return a.startsWith(b) && (a[b.length] || '.') === '.';\n  }\n\n  /**\n   * @internal\n   *\n   * Not a part of a public API, used by APP_INITIALIZER to initialize all provided CONFIG_INITIALIZERS\n   *\n   */\n  async initialize(initializers?: ConfigInitializer[]) {\n    if (this.ongoingScopes$.value) {\n      // guard for double initialization\n      return;\n    }\n\n    const ongoingScopes: string[] = [];\n\n    const asyncConfigs: Promise<void>[] = [];\n\n    for (const initializer of initializers || []) {\n      if (!initializer) {\n        continue;\n      }\n      if (!initializer.scopes || !initializer.scopes.length) {\n        throw new Error('CONFIG_INITIALIZER should provide scope!');\n      }\n\n      if (isDevMode() && !this.areReady(initializer.scopes, ongoingScopes)) {\n        console.warn(\n          'More than one CONFIG_INITIALIZER is initializing the same config scope.'\n        );\n      }\n\n      ongoingScopes.push(...initializer.scopes);\n\n      asyncConfigs.push(\n        (async () => {\n          deepMerge(this.config, await initializer.configFactory());\n          this.finishScopes(initializer.scopes);\n        })()\n      );\n    }\n    this.ongoingScopes$.next(ongoingScopes);\n\n    if (asyncConfigs.length) {\n      await Promise.all(asyncConfigs);\n    }\n  }\n}\n","import { APP_INITIALIZER, Provider } from '@angular/core';\nimport { ConfigInitializerService } from '../../config/config-initializer/config-initializer.service';\nimport { BaseSiteService } from '../facade/base-site.service';\nimport { CurrencyService } from '../facade/currency.service';\nimport { LanguageService } from '../facade/language.service';\n\nexport function initializeContext(\n  baseSiteService: BaseSiteService,\n  langService: LanguageService,\n  currService: CurrencyService,\n  configInit: ConfigInitializerService\n) {\n  return () => {\n    configInit.getStableConfig('context').then(() => {\n      baseSiteService.initialize();\n      langService.initialize();\n      currService.initialize();\n    });\n  };\n}\n\nexport const contextServiceProviders: Provider[] = [\n  BaseSiteService,\n  LanguageService,\n  CurrencyService,\n  {\n    provide: APP_INITIALIZER,\n    useFactory: initializeContext,\n    deps: [\n      BaseSiteService,\n      LanguageService,\n      CurrencyService,\n      ConfigInitializerService,\n    ],\n    multi: true,\n  },\n];\n","import { Injectable, Injector } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { distinctUntilChanged, filter } from 'rxjs/operators';\nimport {\n  getContextParameterDefault,\n  getContextParameterValues,\n} from '../config/context-config-utils';\nimport { SiteContextConfig } from '../config/site-context-config';\nimport { SiteContext } from '../facade/site-context.interface';\nimport { ContextServiceMap } from '../providers/context-service-map';\n\n@Injectable()\nexport class SiteContextParamsService {\n  constructor(\n    private config: SiteContextConfig,\n    private injector: Injector,\n    private serviceMap: ContextServiceMap\n  ) {}\n\n  getContextParameters(): string[] {\n    if (this.config.context) {\n      return Object.keys(this.config.context).filter(\n        param => param !== 'urlParameters'\n      );\n    }\n    return [];\n  }\n\n  getUrlEncodingParameters(): string[] {\n    return (this.config.context && this.config.context.urlParameters) || [];\n  }\n\n  getParamValues(param: string): string[] {\n    return getContextParameterValues(this.config, param);\n  }\n\n  getParamDefaultValue(param: string): string {\n    return getContextParameterDefault(this.config, param);\n  }\n\n  getSiteContextService(param: string): SiteContext<any> {\n    if (this.serviceMap[param]) {\n      return this.injector.get<SiteContext<any>>(this.serviceMap[param], null);\n    }\n  }\n\n  getValue(param: string): string {\n    let value: string;\n\n    const service = this.getSiteContextService(param);\n    if (service) {\n      service\n        .getActive()\n        .subscribe(val => (value = val))\n        .unsubscribe();\n    }\n\n    return value !== undefined ? value : this.getParamDefaultValue(param);\n  }\n\n  setValue(param: string, value: string) {\n    const service = this.getSiteContextService(param);\n    if (service) {\n      service.setActive(value);\n    }\n  }\n\n  /**\n   * Get active values for all provided context parameters\n   *\n   * @param params Context parameters\n   *\n   * @returns Observable emitting array of all passed active context values\n   */\n  getValues(params: string[]): Observable<Array<string>> {\n    if (params.length === 0) {\n      return of([]);\n    }\n\n    return combineLatest(\n      params.map(param =>\n        this.getSiteContextService(param)\n          .getActive()\n          .pipe(distinctUntilChanged())\n      )\n    ).pipe(filter(value => value.every(param => !!param)));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { DefaultUrlSerializer, UrlTree } from '@angular/router';\nimport { SiteContextParamsService } from './site-context-params.service';\n\nexport interface ParamValuesMap {\n  [name: string]: string;\n}\n\nexport interface UrlTreeWithSiteContext extends UrlTree {\n  siteContext?: ParamValuesMap;\n}\n\nconst UrlSplit = /(^[^#?]*)(.*)/; // used to split url into path and query/fragment parts\n\n@Injectable()\nexport class SiteContextUrlSerializer extends DefaultUrlSerializer {\n  private get urlEncodingParameters(): string[] {\n    return this.siteContextParams.getUrlEncodingParameters();\n  }\n\n  get hasContextInRoutes() {\n    return this.urlEncodingParameters.length > 0;\n  }\n\n  constructor(private siteContextParams: SiteContextParamsService) {\n    super();\n  }\n\n  parse(url: string): UrlTreeWithSiteContext {\n    if (this.hasContextInRoutes) {\n      const urlWithParams = this.urlExtractContextParameters(url);\n      const parsed = super.parse(urlWithParams.url) as UrlTreeWithSiteContext;\n      this.urlTreeIncludeContextParameters(parsed, urlWithParams.params);\n      return parsed;\n    } else {\n      return super.parse(url);\n    }\n  }\n\n  urlExtractContextParameters(\n    url: string\n  ): { url: string; params: ParamValuesMap } {\n    const [, urlPart, queryPart] = url.match(UrlSplit);\n\n    const segments = urlPart.split('/');\n    if (segments[0] === '') {\n      segments.shift();\n    }\n    const params = {};\n\n    let paramId = 0;\n    let segmentId = 0;\n    while (\n      paramId < this.urlEncodingParameters.length &&\n      segmentId < segments.length\n    ) {\n      const paramName = this.urlEncodingParameters[paramId];\n      const paramValues = this.siteContextParams.getParamValues(paramName);\n\n      if (paramValues.includes(segments[segmentId])) {\n        params[paramName] = segments[segmentId];\n        segmentId++;\n      }\n      paramId++;\n    }\n\n    url = segments.slice(Object.keys(params).length).join('/') + queryPart;\n    return { url, params };\n  }\n\n  private urlTreeIncludeContextParameters(\n    urlTree: UrlTreeWithSiteContext,\n    params: ParamValuesMap\n  ) {\n    urlTree.siteContext = params;\n  }\n\n  serialize(tree: UrlTreeWithSiteContext): string {\n    const params = this.urlTreeExtractContextParameters(tree);\n    const url = super.serialize(tree);\n    const serialized = this.urlIncludeContextParameters(url, params);\n    return serialized;\n  }\n\n  urlTreeExtractContextParameters(\n    urlTree: UrlTreeWithSiteContext\n  ): ParamValuesMap {\n    return urlTree.siteContext ? urlTree.siteContext : {};\n  }\n\n  private urlIncludeContextParameters(url: string, params: ParamValuesMap) {\n    const contextRoutePart = this.urlEncodingParameters\n      .map(param => {\n        return params[param]\n          ? params[param]\n          : this.siteContextParams.getValue(param);\n      })\n      .join('/');\n\n    return contextRoutePart + url;\n  }\n}\n","import { Location } from '@angular/common';\nimport { Injectable, Injector, OnDestroy } from '@angular/core';\nimport {\n  NavigationCancel,\n  NavigationEnd,\n  NavigationError,\n  NavigationStart,\n  Router,\n  RouterEvent,\n} from '@angular/router';\nimport { Subscription } from 'rxjs';\nimport { filter } from 'rxjs/operators';\nimport { SiteContextParamsService } from './site-context-params.service';\nimport { SiteContextUrlSerializer } from './site-context-url-serializer';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SiteContextRoutesHandler implements OnDestroy {\n  constructor(\n    private siteContextParams: SiteContextParamsService,\n    private serializer: SiteContextUrlSerializer,\n    private injector: Injector\n  ) {}\n\n  private subscription = new Subscription();\n\n  private contextValues: {\n    [param: string]: string;\n  } = {};\n\n  private router: Router;\n  private location: Location;\n  private isNavigating = false;\n\n  init() {\n    this.router = this.injector.get<Router>(Router);\n\n    this.location = this.injector.get<Location>(Location);\n    const routingParams = this.siteContextParams.getUrlEncodingParameters();\n\n    if (routingParams.length) {\n      this.setContextParamsFromRoute(this.router.url);\n      this.subscribeChanges(routingParams);\n      this.subscribeRouting();\n    }\n  }\n\n  private subscribeChanges(params: string[]) {\n    params.forEach(param => {\n      const service = this.siteContextParams.getSiteContextService(param);\n      if (service) {\n        this.subscription.add(\n          service.getActive().subscribe(value => {\n            if (\n              !this.isNavigating &&\n              this.contextValues[param] &&\n              this.contextValues[param] !== value\n            ) {\n              const parsed = this.router.parseUrl(this.router.url);\n              const serialized = this.router.serializeUrl(parsed);\n              this.location.replaceState(serialized);\n            }\n            this.contextValues[param] = value;\n          })\n        );\n      }\n    });\n  }\n\n  private subscribeRouting() {\n    this.subscription.add(\n      this.router.events\n        .pipe(\n          filter(\n            event =>\n              event instanceof NavigationStart ||\n              event instanceof NavigationEnd ||\n              event instanceof NavigationError ||\n              event instanceof NavigationCancel\n          )\n        )\n        .subscribe((event: RouterEvent) => {\n          this.isNavigating = event instanceof NavigationStart;\n          if (this.isNavigating) {\n            this.setContextParamsFromRoute(event.url);\n          }\n        })\n    );\n  }\n\n  private setContextParamsFromRoute(url: string) {\n    const { params } = this.serializer.urlExtractContextParameters(url);\n    Object.keys(params).forEach(param =>\n      this.siteContextParams.setValue(param, params[param])\n    );\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n}\n","import { APP_INITIALIZER, Provider } from '@angular/core';\nimport { UrlSerializer } from '@angular/router';\nimport { ConfigInitializerService } from '../../config/config-initializer/config-initializer.service';\nimport { SiteContextParamsService } from '../services/site-context-params.service';\nimport { SiteContextRoutesHandler } from '../services/site-context-routes-handler';\nimport { SiteContextUrlSerializer } from '../services/site-context-url-serializer';\n\n// functions below should not be exposed in public API:\n\nexport function initSiteContextRoutesHandler(\n  siteContextRoutesHandler: SiteContextRoutesHandler,\n  configInit: ConfigInitializerService\n) {\n  return () => {\n    configInit.getStableConfig('context').then(() => {\n      siteContextRoutesHandler.init();\n    });\n  };\n}\n\nexport const siteContextParamsProviders: Provider[] = [\n  SiteContextParamsService,\n  SiteContextUrlSerializer,\n  { provide: UrlSerializer, useExisting: SiteContextUrlSerializer },\n  {\n    provide: APP_INITIALIZER,\n    useFactory: initSiteContextRoutesHandler,\n    deps: [SiteContextRoutesHandler, ConfigInitializerService],\n    multi: true,\n  },\n];\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map, tap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { WindowRef } from '../../../window/window-ref';\nimport { SiteConnector } from '../../connectors/site.connector';\nimport { SiteContextActions } from '../actions/index';\n\n@Injectable()\nexport class LanguagesEffects {\n  @Effect()\n  loadLanguages$: Observable<\n    | SiteContextActions.LoadLanguagesSuccess\n    | SiteContextActions.LoadLanguagesFail\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LOAD_LANGUAGES),\n    exhaustMap(() => {\n      return this.siteConnector.getLanguages().pipe(\n        map(\n          languages => new SiteContextActions.LoadLanguagesSuccess(languages)\n        ),\n        catchError(error =>\n          of(\n            new SiteContextActions.LoadLanguagesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  activateLanguage$: Observable<\n    SiteContextActions.LanguageChange\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.SET_ACTIVE_LANGUAGE),\n    tap((action: SiteContextActions.SetActiveLanguage) => {\n      if (this.winRef.sessionStorage) {\n        this.winRef.sessionStorage.setItem('language', action.payload);\n      }\n    }),\n    map(() => new SiteContextActions.LanguageChange())\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector,\n    private winRef: WindowRef\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map, tap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { WindowRef } from '../../../window/window-ref';\nimport { SiteConnector } from '../../connectors/site.connector';\nimport { SiteContextActions } from '../actions/index';\n\n@Injectable()\nexport class CurrenciesEffects {\n  @Effect()\n  loadCurrencies$: Observable<\n    | SiteContextActions.LoadCurrenciesSuccess\n    | SiteContextActions.LoadCurrenciesFail\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LOAD_CURRENCIES),\n    exhaustMap(() => {\n      return this.siteConnector.getCurrencies().pipe(\n        map(\n          currencies => new SiteContextActions.LoadCurrenciesSuccess(currencies)\n        ),\n        catchError(error =>\n          of(\n            new SiteContextActions.LoadCurrenciesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  activateCurrency$: Observable<\n    SiteContextActions.CurrencyChange\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.SET_ACTIVE_CURRENCY),\n    tap((action: SiteContextActions.SetActiveCurrency) => {\n      if (this.winRef.sessionStorage) {\n        this.winRef.sessionStorage.setItem('currency', action.payload);\n      }\n    }),\n    map(() => new SiteContextActions.CurrencyChange())\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector,\n    private winRef: WindowRef\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { SiteConnector } from '../../connectors/site.connector';\nimport { SiteContextActions } from '../actions/index';\n\n@Injectable()\nexport class BaseSiteEffects {\n  @Effect()\n  loadBaseSite$: Observable<\n    SiteContextActions.LoadBaseSiteSuccess | SiteContextActions.LoadBaseSiteFail\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LOAD_BASE_SITE),\n    exhaustMap(() => {\n      return this.siteConnector.getBaseSite().pipe(\n        map(baseSite => new SiteContextActions.LoadBaseSiteSuccess(baseSite)),\n        catchError(error =>\n          of(\n            new SiteContextActions.LoadBaseSiteFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { LanguagesEffects } from './languages.effect';\nimport { CurrenciesEffects } from './currencies.effect';\nimport { BaseSiteEffects } from './base-site.effect';\n\nexport const effects: any[] = [\n  LanguagesEffects,\n  CurrenciesEffects,\n  BaseSiteEffects,\n];\n\nexport * from './languages.effect';\nexport * from './currencies.effect';\nexport * from './base-site.effect';\n","import { SiteContextActions } from '../actions/index';\nimport { BaseSiteState } from '../state';\n\nexport const initialState: BaseSiteState = {\n  details: {},\n  activeSite: '',\n};\n\nexport function reducer(\n  state = initialState,\n  action: SiteContextActions.BaseSiteAction\n): BaseSiteState {\n  switch (action.type) {\n    case SiteContextActions.LOAD_BASE_SITE_SUCCESS: {\n      return {\n        ...state,\n        details: action.payload,\n      };\n    }\n\n    case SiteContextActions.SET_ACTIVE_BASE_SITE: {\n      return {\n        ...state,\n        activeSite: action.payload,\n      };\n    }\n  }\n\n  return state;\n}\n","import { Currency } from '../../../model/misc.model';\nimport { SiteContextActions } from '../actions/index';\nimport { CurrenciesState } from '../state';\n\nexport const initialState: CurrenciesState = {\n  entities: null,\n  activeCurrency: null,\n};\n\nexport function reducer(\n  state = initialState,\n  action: SiteContextActions.CurrenciesAction\n): CurrenciesState {\n  switch (action.type) {\n    case SiteContextActions.LOAD_CURRENCIES_SUCCESS: {\n      const currencies: Currency[] = action.payload;\n      const entities = currencies.reduce(\n        (currEntities: { [isocode: string]: Currency }, currency: Currency) => {\n          return {\n            ...currEntities,\n            [currency.isocode]: currency,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case SiteContextActions.SET_ACTIVE_CURRENCY: {\n      const isocode: string = action.payload;\n\n      return {\n        ...state,\n        activeCurrency: isocode,\n      };\n    }\n  }\n\n  return state;\n}\n","import { Language } from '../../../model/misc.model';\nimport { SiteContextActions } from '../actions/index';\nimport { LanguagesState } from '../state';\n\nexport const initialState: LanguagesState = {\n  entities: null,\n  activeLanguage: null,\n};\n\nexport function reducer(\n  state = initialState,\n  action: SiteContextActions.LanguagesAction\n): LanguagesState {\n  switch (action.type) {\n    case SiteContextActions.LOAD_LANGUAGES_SUCCESS: {\n      const languages: Language[] = action.payload;\n      const entities = languages.reduce(\n        (langEntities: { [isocode: string]: Language }, language: Language) => {\n          return {\n            ...langEntities,\n            [language.isocode]: language,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case SiteContextActions.SET_ACTIVE_LANGUAGE: {\n      const isocode = action.payload;\n\n      return {\n        ...state,\n        activeLanguage: isocode,\n      };\n    }\n  }\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducerMap } from '@ngrx/store';\nimport { SiteContextState } from '../state';\nimport * as fromBaseSite from './base-site.reducer';\nimport * as fromCurrencies from './currencies.reducer';\nimport * as fromLanguages from './languages.reducer';\n\nexport function getReducers(): ActionReducerMap<SiteContextState> {\n  return {\n    languages: fromLanguages.reducer,\n    currencies: fromCurrencies.reducer,\n    baseSite: fromBaseSite.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  SiteContextState\n>> = new InjectionToken<ActionReducerMap<SiteContextState>>(\n  'SiteContextReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { provideDefaultConfigFactory } from '../../config/config.module';\nimport {\n  StateConfig,\n  StateTransferType,\n} from '../../state/config/state-config';\nimport { effects } from './effects/index';\nimport { reducerProvider, reducerToken } from './reducers/index';\nimport { SITE_CONTEXT_FEATURE } from './state';\n\nexport function siteContextStoreConfigFactory(): StateConfig {\n  // if we want to reuse SITE_CONTEXT_FEATURE const in config, we have to use factory instead of plain object\n  const config: StateConfig = {\n    state: {\n      ssrTransfer: {\n        keys: { [SITE_CONTEXT_FEATURE]: StateTransferType.TRANSFER_STATE },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StoreModule.forFeature(SITE_CONTEXT_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(siteContextStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class SiteContextStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config, provideDefaultConfigFactory } from '../config/config.module';\nimport { provideConfigValidator } from '../config/config-validator/config-validator';\nimport { StateModule } from '../state/index';\nimport { baseSiteConfigValidator } from './config/base-site-config-validator';\nimport { defaultSiteContextConfigFactory } from './config/default-site-context-config';\nimport { SiteContextConfig } from './config/site-context-config';\nimport { contextServiceMapProvider } from './providers/context-service-map';\nimport { contextServiceProviders } from './providers/context-service-providers';\nimport { siteContextParamsProviders } from './providers/site-context-params-providers';\nimport { SiteContextStoreModule } from './store/site-context-store.module';\n\n// @dynamic\n@NgModule({\n  imports: [StateModule, SiteContextStoreModule],\n})\nexport class SiteContextModule {\n  static forRoot(): ModuleWithProviders<SiteContextModule> {\n    return {\n      ngModule: SiteContextModule,\n      providers: [\n        provideDefaultConfigFactory(defaultSiteContextConfigFactory),\n        contextServiceMapProvider,\n        ...contextServiceProviders,\n        ...siteContextParamsProviders,\n        { provide: SiteContextConfig, useExisting: Config },\n        provideConfigValidator(baseSiteConfigValidator),\n      ],\n    };\n  }\n}\n","import { AnonymousConsentsActions } from '../actions/index';\n\nexport const initialState = false;\n\nexport function reducer(\n  state = initialState,\n  action: AnonymousConsentsActions.ToggleAnonymousConsentsBannerDissmissed\n): boolean {\n  switch (action.type) {\n    case AnonymousConsentsActions.TOGGLE_ANONYMOUS_CONSENTS_BANNER_DISMISSED: {\n      return action.dismissed;\n    }\n  }\n\n  return state;\n}\n","import { AnonymousConsentsActions } from '../actions/index';\n\nexport const initialState = false;\n\nexport function reducer(\n  state = initialState,\n  action: AnonymousConsentsActions.ToggleAnonymousConsentTemplatesUpdated\n): boolean {\n  switch (action.type) {\n    case AnonymousConsentsActions.TOGGLE_ANONYMOUS_CONSENT_TEMPLATES_UPDATED: {\n      return action.updated;\n    }\n  }\n\n  return state;\n}\n","import {\n  AnonymousConsent,\n  ANONYMOUS_CONSENT_STATUS,\n} from '../../../model/consent.model';\nimport { AnonymousConsentsActions } from '../actions/index';\n\nexport const initialState: AnonymousConsent[] = [];\n\nexport function toggleConsentStatus(\n  consents: AnonymousConsent[],\n  templateCode: string,\n  status: ANONYMOUS_CONSENT_STATUS\n): AnonymousConsent[] {\n  if (!consents) {\n    return [];\n  }\n\n  return consents.map(consent => {\n    if (consent.templateCode === templateCode) {\n      consent = {\n        ...consent,\n        consentState: status,\n      };\n    }\n    return consent;\n  });\n}\n\nexport function reducer(\n  state = initialState,\n  action: AnonymousConsentsActions.AnonymousConsentsActions\n): AnonymousConsent[] {\n  switch (action.type) {\n    case AnonymousConsentsActions.GIVE_ANONYMOUS_CONSENT: {\n      return toggleConsentStatus(\n        state,\n        action.templateCode,\n        ANONYMOUS_CONSENT_STATUS.GIVEN\n      );\n    }\n\n    case AnonymousConsentsActions.WITHDRAW_ANONYMOUS_CONSENT: {\n      return toggleConsentStatus(\n        state,\n        action.templateCode,\n        ANONYMOUS_CONSENT_STATUS.WITHDRAWN\n      );\n    }\n\n    case AnonymousConsentsActions.SET_ANONYMOUS_CONSENTS: {\n      return action.payload;\n    }\n  }\n\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  Action,\n  ActionReducer,\n  ActionReducerMap,\n  combineReducers,\n  MetaReducer,\n} from '@ngrx/store';\nimport { AuthActions } from '../../../auth/index';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { SiteContextActions } from '../../../site-context/index';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport {\n  AnonymousConsentsState,\n  ANONYMOUS_CONSENTS,\n} from '../anonymous-consents-state';\nimport * as fromAnonymousConsentsBanner from './anonymous-consents-banner.reducer';\nimport * as fromAnonymousConsentsUpdate from './anonymous-consents-update.reducer';\nimport * as fromAnonymousConsents from './anonymous-consents.reducer';\n\nexport function getReducers(): ActionReducerMap<AnonymousConsentsState> {\n  return {\n    templates: loaderReducer<ConsentTemplate[]>(ANONYMOUS_CONSENTS),\n    consents: fromAnonymousConsents.reducer,\n    ui: combineReducers({\n      bannerDismissed: fromAnonymousConsentsBanner.reducer,\n      updated: fromAnonymousConsentsUpdate.reducer,\n    }),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  AnonymousConsentsState\n>> = new InjectionToken<ActionReducerMap<AnonymousConsentsState>>(\n  'AnonymousConsentsReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearAnonymousConsentTemplates(\n  reducer: ActionReducer<AnonymousConsentsState, Action>\n): ActionReducer<AnonymousConsentsState, Action> {\n  return function(state, action) {\n    if (\n      action.type === AuthActions.LOGOUT ||\n      action.type === SiteContextActions.LANGUAGE_CHANGE\n    ) {\n      state = {\n        ...state,\n        templates: undefined,\n      };\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [\n  clearAnonymousConsentTemplates,\n];\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { provideDefaultConfigFactory } from '../../config/config.module';\nimport { StateConfig, StorageSyncType } from '../../state/index';\nimport { StateModule } from '../../state/state.module';\nimport { ANONYMOUS_CONSENTS_STORE_FEATURE } from './anonymous-consents-state';\nimport { effects } from './effects/index';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function anonymousConsentsStoreConfigFactory(): StateConfig {\n  const config: StateConfig = {\n    state: {\n      storageSync: {\n        keys: {\n          [ANONYMOUS_CONSENTS_STORE_FEATURE]: StorageSyncType.LOCAL_STORAGE,\n        },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n    StateModule,\n    StoreModule.forFeature(ANONYMOUS_CONSENTS_STORE_FEATURE, reducerToken, {\n      metaReducers,\n    }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(anonymousConsentsStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class AnonymousConsentsStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { AnonymousConsentsConfig } from './config/anonymous-consents-config';\nimport { defaultAnonymousConsentsConfig } from './config/default-anonymous-consents-config';\nimport { AnonymousConsentsService } from './facade/anonymous-consents.service';\nimport { interceptors } from './http-interceptors/index';\nimport { AnonymousConsentsStoreModule } from './store/anonymous-consents-store.module';\n\n@NgModule({\n  imports: [AnonymousConsentsStoreModule],\n})\nexport class AnonymousConsentsModule {\n  static forRoot(): ModuleWithProviders<AnonymousConsentsModule> {\n    return {\n      ngModule: AnonymousConsentsModule,\n      providers: [\n        ...interceptors,\n        AnonymousConsentsService,\n        { provide: AnonymousConsentsConfig, useExisting: Config },\n        provideDefaultConfig(defaultAnonymousConsentsConfig),\n      ],\n    };\n  }\n}\n","import { AsmConfig } from './asm-config';\n\nexport const defaultAsmConfig: AsmConfig = {\n  asm: {\n    agentSessionTimer: {\n      startingDelayInSeconds: 600,\n    },\n    customerSearch: {\n      maxResults: 20,\n    },\n  },\n};\n","import { LoaderState } from '../../state/utils/loader/loader-state';\nimport { AsmUi, CustomerSearchPage } from '../models/asm.models';\nimport { UserToken } from '../../auth';\n\nexport const ASM_FEATURE = 'asm';\nexport const CUSTOMER_SEARCH_DATA = '[asm] Customer search data';\nexport const CSAGENT_TOKEN_DATA = '[Auth] Customer Support Agent Token Data';\n\nexport interface StateWithAsm {\n  [ASM_FEATURE]: AsmState;\n}\n\nexport interface AsmState {\n  customerSearchResult: LoaderState<CustomerSearchPage>;\n  asmUi: AsmUi;\n  csagentToken: LoaderState<UserToken>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport {\n  CustomerSearchOptions,\n  CustomerSearchPage,\n} from '../models/asm.models';\nimport { AsmAdapter } from './asm.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AsmConnector {\n  constructor(protected asmAdapter: AsmAdapter) {}\n\n  customerSearch(\n    options: CustomerSearchOptions\n  ): Observable<CustomerSearchPage> {\n    return this.asmAdapter.customerSearch(options);\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { AsmUi } from '../../models/asm.models';\n\nexport const ASM_UI_UPDATE = '[Asm] UI Update';\n\nexport class AsmUiUpdate implements Action {\n  readonly type = ASM_UI_UPDATE;\n  constructor(public payload: AsmUi) {}\n}\n// action types\nexport type AsmUiAction = AsmUiUpdate;\n","import { StateLoaderActions } from '../../../state/utils/index';\nimport {\n  CustomerSearchOptions,\n  CustomerSearchPage,\n} from '../../models/asm.models';\nimport { CUSTOMER_SEARCH_DATA } from '../asm-state';\n\nexport const CUSTOMER_SEARCH = '[Asm] Customer Search';\nexport const CUSTOMER_SEARCH_FAIL = '[Asm] Customer Search Fail';\nexport const CUSTOMER_SEARCH_SUCCESS = '[Asm] Customer Search Success';\nexport const CUSTOMER_SEARCH_RESET = '[Asm] Customer Search Reset';\n\nexport class CustomerSearch extends StateLoaderActions.LoaderLoadAction {\n  readonly type = CUSTOMER_SEARCH;\n  constructor(public payload: CustomerSearchOptions) {\n    super(CUSTOMER_SEARCH_DATA);\n  }\n}\n\nexport class CustomerSearchFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = CUSTOMER_SEARCH_FAIL;\n  constructor(public payload: any) {\n    super(CUSTOMER_SEARCH_DATA);\n  }\n}\n\nexport class CustomerSearchSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = CUSTOMER_SEARCH_SUCCESS;\n  constructor(public payload: CustomerSearchPage) {\n    super(CUSTOMER_SEARCH_DATA);\n  }\n}\n\nexport class CustomerSearchReset extends StateLoaderActions.LoaderResetAction {\n  readonly type = CUSTOMER_SEARCH_RESET;\n  constructor() {\n    super(CUSTOMER_SEARCH_DATA);\n  }\n}\n\n// action types\nexport type CustomerAction =\n  | CustomerSearch\n  | CustomerSearchFail\n  | CustomerSearchSuccess\n  | CustomerSearchReset;\n","import { StateLoaderActions } from '../../../state/utils/index';\nimport { UserToken } from '../../../auth/models/token-types.model';\nimport { CSAGENT_TOKEN_DATA } from '../asm-state';\nimport { Action } from '@ngrx/store';\nimport { LOGOUT_CUSTOMER_SUPPORT_AGENT } from '../../../auth/store/actions/login-logout.action';\n\nexport const LOAD_CUSTOMER_SUPPORT_AGENT_TOKEN =\n  '[Auth] Load Customer Service Agent Token';\nexport const LOAD_CUSTOMER_SUPPORT_AGENT_TOKEN_FAIL =\n  '[Auth] Load Customer Service Agent Token Fail';\nexport const LOAD_CUSTOMER_SUPPORT_AGENT_TOKEN_SUCCESS =\n  '[Auth] Load Customer Service Agent Token Success';\n\nexport class LoadCustomerSupportAgentToken extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_CUSTOMER_SUPPORT_AGENT_TOKEN;\n\n  constructor(public payload: { userId: string; password: string }) {\n    super(CSAGENT_TOKEN_DATA);\n  }\n}\n\nexport class LoadCustomerSupportAgentTokenFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_CUSTOMER_SUPPORT_AGENT_TOKEN_FAIL;\n  constructor(public payload: any) {\n    super(CSAGENT_TOKEN_DATA);\n  }\n}\n\nexport class LoadCustomerSupportAgentTokenSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_CUSTOMER_SUPPORT_AGENT_TOKEN_SUCCESS;\n  constructor(public payload: UserToken) {\n    super(CSAGENT_TOKEN_DATA);\n  }\n}\n\nexport class LogoutCustomerSupportAgent implements Action {\n  readonly type = LOGOUT_CUSTOMER_SUPPORT_AGENT;\n}\n\n// action types\nexport type CustomerSupportAgentTokenAction =\n  | LoadCustomerSupportAgentToken\n  | LoadCustomerSupportAgentTokenFail\n  | LoadCustomerSupportAgentTokenSuccess\n  | LogoutCustomerSupportAgent;\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { AsmConnector } from '../../connectors/asm.connector';\nimport { CustomerSearchPage } from '../../models/asm.models';\nimport { AsmActions } from '../actions/index';\n\n@Injectable()\nexport class CustomerEffects {\n  @Effect()\n  customerSearch$: Observable<AsmActions.CustomerAction> = this.actions$.pipe(\n    ofType(AsmActions.CUSTOMER_SEARCH),\n    map((action: AsmActions.CustomerSearch) => action.payload),\n    switchMap(options =>\n      this.asmConnector.customerSearch(options).pipe(\n        map((customerSearchResults: CustomerSearchPage) => {\n          return new AsmActions.CustomerSearchSuccess(customerSearchResults);\n        }),\n        catchError(error =>\n          of(new AsmActions.CustomerSearchFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  constructor(private actions$: Actions, private asmConnector: AsmConnector) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserToken } from '../../../auth/models/token-types.model';\nimport { UserAuthenticationTokenService } from '../../../auth/services/user-authentication/user-authentication-token.service';\nimport { AsmActions } from '../actions/index';\n\n@Injectable()\nexport class CustomerSupportAgentTokenEffects {\n  @Effect()\n  loadCustomerSupportAgentToken$: Observable<\n    AsmActions.CustomerSupportAgentTokenAction\n  > = this.actions$.pipe(\n    ofType(AsmActions.LOAD_CUSTOMER_SUPPORT_AGENT_TOKEN),\n    map((action: AsmActions.LoadCustomerSupportAgentToken) => action.payload),\n    switchMap(({ userId, password }) =>\n      this.userTokenService.loadToken(userId, password).pipe(\n        map((token: UserToken) => {\n          const date = new Date();\n          date.setSeconds(date.getSeconds() + token.expires_in);\n          token.expiration_time = date.toJSON();\n          return new AsmActions.LoadCustomerSupportAgentTokenSuccess(token);\n        }),\n        catchError(error =>\n          of(\n            new AsmActions.LoadCustomerSupportAgentTokenFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userTokenService: UserAuthenticationTokenService\n  ) {}\n}\n","import { CustomerEffects } from './customer.effect';\nimport { CustomerSupportAgentTokenEffects } from './csagent-token.effect';\n\nexport const effects: any[] = [\n  CustomerEffects,\n  CustomerSupportAgentTokenEffects,\n];\n\nexport * from './customer.effect';\n","import { AsmUi } from '../../models/asm.models';\nimport { AsmActions } from '../actions/index';\n\nexport const initialState: AsmUi = <AsmUi>{ collapsed: false };\n\nexport function reducer(\n  state = initialState,\n  action: AsmActions.AsmUiAction\n): AsmUi {\n  switch (action.type) {\n    case AsmActions.ASM_UI_UPDATE: {\n      return {\n        ...state,\n        ...action.payload,\n      };\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  Action,\n  ActionReducer,\n  ActionReducerMap,\n  MetaReducer,\n} from '@ngrx/store';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport { CustomerSearchPage } from '../../models/asm.models';\nimport {\n  AsmState,\n  CSAGENT_TOKEN_DATA,\n  CUSTOMER_SEARCH_DATA,\n} from '../asm-state';\nimport * as fromAsmUiReducer from './asm-ui.reducer';\nimport { UserToken } from '../../../auth/models/token-types.model';\n\nexport function getReducers(): ActionReducerMap<AsmState> {\n  return {\n    customerSearchResult: loaderReducer<CustomerSearchPage>(\n      CUSTOMER_SEARCH_DATA\n    ),\n    asmUi: fromAsmUiReducer.reducer,\n    csagentToken: loaderReducer<UserToken>(CSAGENT_TOKEN_DATA),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  AsmState\n>> = new InjectionToken<ActionReducerMap<AsmState>>('AsmReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearCustomerSupportAgentAsmState(\n  reducer: ActionReducer<AsmState, Action>\n): ActionReducer<AsmState, Action> {\n  return function(state, action) {\n    if (action.type === AuthActions.LOGOUT_CUSTOMER_SUPPORT_AGENT) {\n      state = {\n        ...state,\n        customerSearchResult: undefined,\n        csagentToken: undefined,\n      };\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [\n  clearCustomerSupportAgentAsmState,\n];\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { provideDefaultConfigFactory } from '../../config/config.module';\nimport { StateConfig, StorageSyncType } from '../../state/config/state-config';\nimport { StateModule } from '../../state/state.module';\nimport { ASM_FEATURE } from './asm-state';\nimport { effects } from './effects/index';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function asmStoreConfigFactory(): StateConfig {\n  const config: StateConfig = {\n    state: {\n      storageSync: {\n        keys: {\n          'asm.asmUi': StorageSyncType.LOCAL_STORAGE,\n          'asm.csagentToken.value.access_token': StorageSyncType.LOCAL_STORAGE,\n          'asm.csagentToken.value.token_type': StorageSyncType.LOCAL_STORAGE,\n          'asm.csagentToken.value.expires_in': StorageSyncType.LOCAL_STORAGE,\n          'asm.csagentToken.value.expiration_time':\n            StorageSyncType.LOCAL_STORAGE,\n          'asm.csagentToken.value.scope': StorageSyncType.LOCAL_STORAGE,\n          'asm.csagentToken.value.userId': StorageSyncType.LOCAL_STORAGE,\n        },\n      },\n    },\n  };\n  return config;\n}\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StateModule,\n    StoreModule.forFeature(ASM_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(asmStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class AsmStoreModule {}\n","import { Translatable } from '../../i18n/translatable';\n\nexport enum GlobalMessageType {\n  MSG_TYPE_CONFIRMATION = '[GlobalMessage] Confirmation',\n  MSG_TYPE_ERROR = '[GlobalMessage] Error',\n  MSG_TYPE_INFO = '[GlobalMessage] Information',\n  MSG_TYPE_WARNING = '[GlobalMessage] Warning',\n}\n\nexport interface GlobalMessage {\n  text: Translatable;\n  type: GlobalMessageType;\n  timeout?: number;\n}\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { AsmState, ASM_FEATURE, StateWithAsm } from '../asm-state';\n\nexport const getAsmState: MemoizedSelector<\n  StateWithAsm,\n  AsmState\n> = createFeatureSelector<AsmState>(ASM_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { AsmUi } from '../../models/asm.models';\nimport { AsmState, StateWithAsm } from '../asm-state';\nimport { getAsmState } from './feature.selector';\n\nexport const getAsmUi: MemoizedSelector<StateWithAsm, AsmUi> = createSelector(\n  getAsmState,\n  (state: AsmState) => state.asmUi\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateLoaderSelectors } from '../../../state/utils/loader/loader-group.selectors';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { CustomerSearchPage } from '../../models/asm.models';\nimport { AsmState, StateWithAsm } from '../asm-state';\nimport { getAsmState } from './feature.selector';\n\nexport const getCustomerSearchResultsLoaderState: MemoizedSelector<\n  StateWithAsm,\n  LoaderState<CustomerSearchPage>\n> = createSelector(\n  getAsmState,\n  (state: AsmState) => state.customerSearchResult\n);\n\nexport const getCustomerSearchResults: MemoizedSelector<\n  StateWithAsm,\n  CustomerSearchPage\n> = createSelector(getCustomerSearchResultsLoaderState, state =>\n  StateLoaderSelectors.loaderValueSelector(state)\n);\n\nexport const getCustomerSearchResultsLoading: MemoizedSelector<\n  StateWithAsm,\n  boolean\n> = createSelector(getCustomerSearchResultsLoaderState, state =>\n  StateLoaderSelectors.loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateLoaderSelectors } from '../../../state/utils/loader/loader-group.selectors';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { UserToken } from '../../../auth/models/token-types.model';\nimport { getAsmState } from './feature.selector';\nimport { AsmState, StateWithAsm } from '../asm-state';\n\nexport const getCustomerSupportAgentTokenState: MemoizedSelector<\n  StateWithAsm,\n  LoaderState<UserToken>\n> = createSelector(getAsmState, (state: AsmState) => state.csagentToken);\n\nexport const getCustomerSupportAgentToken: MemoizedSelector<\n  StateWithAsm,\n  UserToken\n> = createSelector(getCustomerSupportAgentTokenState, state =>\n  StateLoaderSelectors.loaderValueSelector(state)\n);\n\nexport const getCustomerSupportAgentTokenLoading: MemoizedSelector<\n  StateWithAsm,\n  boolean\n> = createSelector(getCustomerSupportAgentTokenState, state =>\n  StateLoaderSelectors.loaderLoadingSelector(state)\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { UserToken } from '../../auth/models/token-types.model';\nimport { AuthActions } from '../../auth/store/actions';\nimport { OCC_USER_ID_CURRENT } from '../../occ/utils/occ-constants';\nimport { AsmActions } from '../store/actions/index';\nimport { StateWithAsm } from '../store/asm-state';\nimport { AsmSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AsmAuthService {\n  constructor(\n    protected store: Store<StateWithAsm>,\n    protected authService: AuthService\n  ) {}\n\n  /**\n   * Loads a user token for a customer support agent\n   * @param userId\n   * @param password\n   */\n  authorizeCustomerSupportAgent(userId: string, password: string): void {\n    this.store.dispatch(\n      new AsmActions.LoadCustomerSupportAgentToken({\n        userId: userId,\n        password: password,\n      })\n    );\n  }\n\n  /**\n   * Starts an ASM customer emulation session.\n   * A customer emulation session is stoped by calling logout().\n   * @param customerSupportAgentToken\n   * @param customerId\n   */\n  public startCustomerEmulationSession(\n    customerSupportAgentToken: UserToken,\n    customerId: string\n  ): void {\n    this.authService.authorizeWithToken({\n      ...customerSupportAgentToken,\n      userId: customerId,\n    });\n  }\n\n  /**\n   * Utility function to determine if a given token is a customer emulation session token.\n   * @param userToken\n   */\n  isCustomerEmulationToken(userToken: UserToken): boolean {\n    return (\n      Boolean(userToken) &&\n      Boolean(userToken.userId) &&\n      userToken.userId !== OCC_USER_ID_CURRENT\n    );\n  }\n\n  /**\n   * Returns the customer support agent's token\n   */\n  getCustomerSupportAgentToken(): Observable<UserToken> {\n    return this.store.pipe(select(AsmSelectors.getCustomerSupportAgentToken));\n  }\n\n  /**\n   * Returns the customer support agent's token loading status\n   */\n  getCustomerSupportAgentTokenLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(AsmSelectors.getCustomerSupportAgentTokenLoading)\n    );\n  }\n\n  /**\n   * Logout a customer support agent\n   */\n  logoutCustomerSupportAgent(): void {\n    this.getCustomerSupportAgentToken()\n      .pipe(take(1))\n      .subscribe(userToken => {\n        this.store.dispatch(new AsmActions.LogoutCustomerSupportAgent());\n        this.store.dispatch(new AuthActions.RevokeUserToken(userToken));\n      });\n  }\n}\n","import {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\nimport {\n  InterceptorUtil,\n  USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n} from '../../occ/utils/interceptor-util';\nimport { AsmAuthService } from '../facade/asm-auth.service';\nimport { UserToken } from '../../auth/models/token-types.model';\n\n@Injectable({ providedIn: 'root' })\nexport class CustomerSupportAgentTokenInterceptor implements HttpInterceptor {\n  constructor(private asmAuthService: AsmAuthService) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return this.getCustomerSupportAgentToken(request).pipe(\n      take(1),\n      switchMap((token: UserToken) => {\n        if (token) {\n          request = request.clone({\n            setHeaders: {\n              Authorization: `${token.token_type} ${token.access_token}`,\n            },\n          });\n        }\n        return next.handle(request);\n      })\n    );\n  }\n\n  private getCustomerSupportAgentToken(\n    request: HttpRequest<any>\n  ): Observable<UserToken> {\n    if (\n      InterceptorUtil.getInterceptorParam(\n        USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n        request.headers\n      )\n    ) {\n      return this.asmAuthService.getCustomerSupportAgentToken();\n    }\n    return of(null);\n  }\n}\n","export enum HttpResponseStatus {\n  UNKNOWN = -1,\n  BAD_REQUEST = 400,\n  FORBIDDEN = 403,\n  NOT_FOUND = 404,\n  CONFLICT = 409,\n  BAD_GATEWAY = 502,\n  GATEWAY_TIMEOUT = 504,\n  INTERNAL_SERVER_ERROR = 500,\n}\n","import { GlobalMessageType } from '../models/global-message.model';\n\nexport type GlobalMessageTypeConfig = {\n  timeout?: number;\n};\n\nexport abstract class GlobalMessageConfig {\n  globalMessages: {\n    [GlobalMessageType.MSG_TYPE_CONFIRMATION]?: GlobalMessageTypeConfig;\n    [GlobalMessageType.MSG_TYPE_INFO]?: GlobalMessageTypeConfig;\n    [GlobalMessageType.MSG_TYPE_ERROR]?: GlobalMessageTypeConfig;\n    [GlobalMessageType.MSG_TYPE_WARNING]?: GlobalMessageTypeConfig;\n  };\n}\n","import { Action } from '@ngrx/store';\nimport {\n  GlobalMessage,\n  GlobalMessageType,\n} from '../../models/global-message.model';\n\nexport const ADD_MESSAGE = '[Global-message] Add a Message';\nexport const REMOVE_MESSAGE = '[Global-message] Remove a Message';\nexport const REMOVE_MESSAGES_BY_TYPE =\n  '[Global-message] Remove messages by type';\n\nexport class AddMessage implements Action {\n  readonly type = ADD_MESSAGE;\n  constructor(public payload: GlobalMessage) {}\n}\n\nexport class RemoveMessage implements Action {\n  readonly type = REMOVE_MESSAGE;\n  constructor(public payload: { type: GlobalMessageType; index: number }) {}\n}\n\nexport class RemoveMessagesByType implements Action {\n  readonly type = REMOVE_MESSAGES_BY_TYPE;\n  constructor(public payload: GlobalMessageType) {}\n}\n\nexport type GlobalMessageAction =\n  | AddMessage\n  | RemoveMessage\n  | RemoveMessagesByType;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  GlobalMessageState,\n  GLOBAL_MESSAGE_FEATURE,\n  StateWithGlobalMessage,\n} from '../global-message-state';\n\nexport const getGlobalMessageState: MemoizedSelector<\n  StateWithGlobalMessage,\n  GlobalMessageState\n> = createFeatureSelector<GlobalMessageState>(GLOBAL_MESSAGE_FEATURE);\n","import { Translatable } from '../../i18n/translatable';\n\nexport const GLOBAL_MESSAGE_FEATURE = 'global-message';\n\nexport interface StateWithGlobalMessage {\n  [GLOBAL_MESSAGE_FEATURE]: GlobalMessageState;\n}\n\nexport interface GlobalMessageState {\n  entities: GlobalMessageEntities;\n}\n\nexport interface GlobalMessageEntities {\n  [messageType: string]: Translatable[];\n}\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Translatable } from '../../../i18n/translatable';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport {\n  GlobalMessageEntities,\n  GlobalMessageState,\n  StateWithGlobalMessage,\n} from '../global-message-state';\nimport { getGlobalMessageState } from './feature.selector';\n\nexport const getGlobalMessageEntities: MemoizedSelector<\n  StateWithGlobalMessage,\n  GlobalMessageEntities\n> = createSelector(\n  getGlobalMessageState,\n  (state: GlobalMessageState) => state.entities\n);\n\nexport const getGlobalMessageEntitiesByType = (\n  type: GlobalMessageType\n): MemoizedSelector<StateWithGlobalMessage, Translatable[]> => {\n  return createSelector(\n    getGlobalMessageEntities,\n    entities => entities && entities[type]\n  );\n};\n\nexport const getGlobalMessageCountByType = (\n  type: GlobalMessageType\n): MemoizedSelector<StateWithGlobalMessage, number> => {\n  return createSelector(\n    getGlobalMessageEntitiesByType(type),\n    entities => entities && entities.length\n  );\n};\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { filter } from 'rxjs/operators';\nimport { Translatable } from '../../i18n/translatable';\nimport { GlobalMessageType } from '../models/global-message.model';\nimport { GlobalMessageActions } from '../store/actions/index';\nimport {\n  GlobalMessageEntities,\n  StateWithGlobalMessage,\n} from '../store/global-message-state';\nimport { GlobalMessageSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class GlobalMessageService {\n  constructor(protected store: Store<StateWithGlobalMessage>) {}\n\n  /**\n   * Get all global messages\n   */\n  get(): Observable<GlobalMessageEntities> {\n    return this.store.pipe(\n      select(GlobalMessageSelectors.getGlobalMessageEntities),\n      filter(data => data !== undefined)\n    );\n  }\n\n  /**\n   * Add one message into store\n   * @param text: string | Translatable\n   * @param type: GlobalMessageType object\n   * @param timeout: number\n   */\n  add(\n    text: string | Translatable,\n    type: GlobalMessageType,\n    timeout?: number\n  ): void {\n    this.store.dispatch(\n      new GlobalMessageActions.AddMessage({\n        text: typeof text === 'string' ? { raw: text } : text,\n        type,\n        timeout,\n      })\n    );\n  }\n\n  /**\n   * Remove message(s) from store\n   * @param type: GlobalMessageType\n   * @param index:optional. Without it, messages will be removed by type; otherwise,\n   * message will be removed from list by index.\n   */\n  remove(type: GlobalMessageType, index?: number): void {\n    this.store.dispatch(\n      index !== undefined\n        ? new GlobalMessageActions.RemoveMessage({\n            type: type,\n            index: index,\n          })\n        : new GlobalMessageActions.RemoveMessagesByType(type)\n    );\n  }\n}\n","import { HttpErrorResponse, HttpRequest } from '@angular/common/http';\nimport { GlobalMessageService } from '../../facade/global-message.service';\nimport { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport abstract class HttpErrorHandler {\n  constructor(protected globalMessageService: GlobalMessageService) {}\n\n  /**\n   * The http response status number which is handled by this handler.\n   * Implementations can set the response status number, i.e. 404, so that\n   * the handler can be found by the error interceptor.\n   */\n  abstract responseStatus: number;\n\n  /**\n   * Handles the error response for the respose status that is register for the handler\n   * @param { HttpRequest<any> } request : http request\n   * @param { HttpErrorResponse } errorResponse : Http error response\n   */\n  abstract handleError(\n    request: HttpRequest<any>,\n    errorResponse: HttpErrorResponse\n  ): void;\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class BadGatewayHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.BAD_GATEWAY;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.badGateway' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n}\n","import { HttpErrorResponse, HttpRequest } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { Translatable } from '../../../i18n/translatable';\n\nconst OAUTH_ENDPOINT = '/authorizationserver/oauth/token';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class BadRequestHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.BAD_REQUEST;\n\n  handleError(request: HttpRequest<any>, response: HttpErrorResponse): void {\n    if (\n      response.url.includes(OAUTH_ENDPOINT) &&\n      response.error &&\n      response.error.error === 'invalid_grant' &&\n      request.body.get('grant_type') === 'password'\n    ) {\n      this.globalMessageService.add(\n        {\n          key: 'httpHandlers.badRequestPleaseLoginAgain',\n          params: {\n            errorMessage:\n              response.error.error_description || response.message || '',\n          },\n        },\n        GlobalMessageType.MSG_TYPE_ERROR\n      );\n      this.globalMessageService.remove(GlobalMessageType.MSG_TYPE_CONFIRMATION);\n    } else {\n      if (\n        response.error &&\n        response.error.errors &&\n        response.error.errors instanceof Array\n      ) {\n        response.error.errors.forEach((error: ErrorModel) => {\n          let errorMessage: Translatable;\n          if (error.type === 'PasswordMismatchError') {\n            // uses en translation error message instead of backend exception error\n            // @todo: this condition could be removed if backend gives better message\n            errorMessage = {\n              key: 'httpHandlers.badRequestOldPasswordIncorrect',\n            };\n          } else if (\n            error.subjectType === 'cart' &&\n            error.reason === 'notFound'\n          ) {\n            errorMessage = { key: 'httpHandlers.cartNotFound' };\n          } else if (error.type === 'ValidationError') {\n            // build translation key in case of backend field validation error\n            errorMessage = {\n              key: `httpHandlers.validationErrors.${error.reason}.${error.subject}`,\n            };\n          } else {\n            // this is currently showing up in case we have a page not found. It should be a 404.\n            // see https://jira.hybris.com/browse/CMSX-8516\n            errorMessage = { raw: error.message || '' };\n          }\n          // @todo: remove this condition once backend is improved, see:\n          // https://github.com/SAP/cloud-commerce-spartacus-storefront/issues/6679\n          if (error.type !== 'JaloObjectNoLongerValidError') {\n            this.globalMessageService.add(\n              errorMessage,\n              GlobalMessageType.MSG_TYPE_ERROR\n            );\n          }\n        });\n      }\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConflictHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.CONFLICT;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.conflict' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ForbiddenHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.FORBIDDEN;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.forbidden' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class GatewayTimeoutHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.GATEWAY_TIMEOUT;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.gatewayTimeout' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { GlobalMessageType } from '../../models/global-message.model';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class InternalServerErrorHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.INTERNAL_SERVER_ERROR;\n\n  handleError() {\n    this.globalMessageService.add(\n      { key: 'httpHandlers.internalServerError' },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class NotFoundHandler extends HttpErrorHandler {\n  responseStatus = HttpResponseStatus.NOT_FOUND;\n\n  // empty error handler to avoid we fallabck to the unknown error handler\n  handleError(): void {}\n}\n","import { Injectable, isDevMode } from '@angular/core';\nimport { GlobalMessageService } from '../../facade/global-message.service';\nimport { HttpResponseStatus } from '../../models/response-status.model';\nimport { HttpErrorHandler } from './http-error.handler';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UnknownErrorHandler extends HttpErrorHandler {\n  constructor(protected globalMessageService: GlobalMessageService) {\n    super(globalMessageService);\n  }\n  responseStatus = HttpResponseStatus.UNKNOWN;\n\n  handleError() {\n    if (isDevMode()) {\n      console.warn(`Unknown http response error: ${this.responseStatus}`);\n    }\n  }\n}\n","import {\n  HttpErrorResponse,\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Inject, Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { HttpResponseStatus } from '../models/response-status.model';\nimport { HttpErrorHandler } from './handlers/http-error.handler';\n\n@Injectable({ providedIn: 'root' })\nexport class HttpErrorInterceptor implements HttpInterceptor {\n  constructor(\n    @Inject(HttpErrorHandler) protected handlers: HttpErrorHandler[]\n  ) {\n    // We reverse the handlers to allow for custom handlers\n    // that replace standard handlers\n    this.handlers.reverse();\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    return next.handle(request).pipe(\n      catchError((response: any) => {\n        if (response instanceof HttpErrorResponse) {\n          this.handleErrorResponse(request, response);\n          return throwError(response);\n        }\n      })\n    );\n  }\n\n  protected handleErrorResponse(\n    request: HttpRequest<any>,\n    response: HttpErrorResponse\n  ): void {\n    const handler = this.getResponseHandler(response);\n    if (handler) {\n      handler.handleError(request, response);\n    }\n  }\n\n  /**\n   * return the error handler that matches the `HttpResponseStatus` code.\n   * If no handler is available, the UNKNOWN handler is returned.\n   */\n  protected getResponseHandler(response: HttpErrorResponse): HttpErrorHandler {\n    const status = response.status;\n    let handler = this.handlers.find(h => h.responseStatus === status);\n    if (!handler) {\n      handler = this.handlers.find(\n        h => h.responseStatus === HttpResponseStatus.UNKNOWN\n      );\n    }\n    return handler;\n  }\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Provider } from '@angular/core';\nimport { BadGatewayHandler } from './handlers/bad-gateway.handler';\nimport { BadRequestHandler } from './handlers/bad-request.handler';\nimport { ConflictHandler } from './handlers/conflict.handler';\nimport { ForbiddenHandler } from './handlers/forbidden.handler';\nimport { GatewayTimeoutHandler } from './handlers/gateway-timeout.handler';\nimport { HttpErrorHandler } from './handlers/http-error.handler';\nimport { InternalServerErrorHandler } from './handlers/internal-server-error.handler';\nimport { NotFoundHandler } from './handlers/not-found.handler';\nimport { UnknownErrorHandler } from './handlers/unknown-error.handler';\nimport { HttpErrorInterceptor } from './http-error.interceptor';\n\nexport const errorHandlers: Provider[] = [\n  {\n    provide: HttpErrorHandler,\n    useExisting: UnknownErrorHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: BadGatewayHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: BadRequestHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: ConflictHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: ForbiddenHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: GatewayTimeoutHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: InternalServerErrorHandler,\n    multi: true,\n  },\n  {\n    provide: HttpErrorHandler,\n    useExisting: NotFoundHandler,\n    multi: true,\n  },\n];\n\nexport const httpErrorInterceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: HttpErrorInterceptor,\n    multi: true,\n  },\n];\n","import { Translatable } from '../../../i18n/translatable';\nimport {\n  GlobalMessage,\n  GlobalMessageType,\n} from '../../models/global-message.model';\nimport { GlobalMessageActions } from '../actions/index';\nimport { GlobalMessageState } from '../global-message-state';\n\nexport const initialState: GlobalMessageState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: GlobalMessageActions.GlobalMessageAction\n): GlobalMessageState {\n  switch (action.type) {\n    case GlobalMessageActions.ADD_MESSAGE: {\n      const message: GlobalMessage = action.payload;\n\n      if (state.entities[message.type] === undefined) {\n        return {\n          ...state,\n          entities: {\n            ...state.entities,\n            [message.type]: [message.text],\n          },\n        };\n      } else {\n        const currentMessages: Translatable[] = state.entities[message.type];\n        return {\n          ...state,\n          entities: {\n            ...state.entities,\n            [message.type]: [...currentMessages, message.text],\n          },\n        };\n      }\n    }\n\n    case GlobalMessageActions.REMOVE_MESSAGE: {\n      const msgType: GlobalMessageType = action.payload.type;\n      const msgIndex: number = action.payload.index;\n      if (\n        Object.keys(state.entities).length === 0 ||\n        !state.entities[msgType]\n      ) {\n        return state;\n      }\n\n      const messages = [...state.entities[msgType]];\n      messages.splice(msgIndex, 1);\n\n      return {\n        ...state,\n        entities: {\n          ...state.entities,\n          [msgType]: messages,\n        },\n      };\n    }\n\n    case GlobalMessageActions.REMOVE_MESSAGES_BY_TYPE: {\n      const entities = {\n        ...state.entities,\n        [action.payload]: [],\n      };\n      return {\n        ...state,\n        entities,\n      };\n    }\n  }\n\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport * as fromGlobalMessage from './global-message.reducer';\nimport { GlobalMessageState } from '../global-message-state';\nimport { ActionReducer } from '@ngrx/store';\n\nexport function getReducers(): ActionReducer<GlobalMessageState> {\n  return fromGlobalMessage.reducer;\n}\n\nexport const reducerToken: InjectionToken<ActionReducer<\n  GlobalMessageState\n>> = new InjectionToken<ActionReducer<GlobalMessageState>>(\n  'GlobalMessageReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { NgModule } from '@angular/core';\nimport { StoreModule } from '@ngrx/store';\n\nimport { reducerToken, reducerProvider } from './reducers/index';\nimport { GLOBAL_MESSAGE_FEATURE } from './global-message-state';\nimport { StateModule } from '../../state/state.module';\n\n@NgModule({\n  imports: [\n    StateModule,\n    StoreModule.forFeature(GLOBAL_MESSAGE_FEATURE, reducerToken),\n  ],\n  providers: [reducerProvider],\n})\nexport class GlobalMessageStoreModule {}\n","export function shallowEqualObjects(objA: object, objB: object): boolean {\n  if (objA === objB) {\n    return true;\n  }\n  if (!objA || !objB) {\n    return false;\n  }\n  const aKeys = Object.keys(objA);\n  const bKeys = Object.keys(objB);\n  const aKeysLen = aKeys.length;\n  const bKeysLen = bKeys.length;\n\n  if (aKeysLen !== bKeysLen) {\n    return false;\n  }\n  for (let i = 0; i < aKeysLen; i++) {\n    const key = aKeys[i];\n    if (objA[key] !== objB[key]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function deepEqualObjects(objA: object, objB: object): boolean {\n  if (objA === objB) {\n    return true; // if both objA and objB are null or undefined and exactly the same\n  } else if (!(objA instanceof Object) || !(objB instanceof Object)) {\n    return false; // if they are not strictly equal, they both need to be Objects\n  } else if (objA.constructor !== objB.constructor) {\n    // they must have the exact same prototype chain, the closest we can do is\n    // test their constructor.\n    return false;\n  } else {\n    for (const key in objA) {\n      if (!objA.hasOwnProperty(key)) {\n        continue; // other properties were tested using objA.constructor === y.constructor\n      }\n      if (!objB.hasOwnProperty(key)) {\n        return false; // allows to compare objA[ key ] and objB[ key ] when set to undefined\n      }\n      if (objA[key] === objB[key]) {\n        continue; // if they have the same strict value or identity then they are equal\n      }\n      if (typeof objA[key] !== 'object') {\n        return false; // Numbers, Strings, Functions, Booleans must be strictly equal\n      }\n      if (!deepEqualObjects(objA[key], objB[key])) {\n        return false;\n      }\n    }\n    for (const key in objB) {\n      if (objB.hasOwnProperty(key) && !objA.hasOwnProperty(key)) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\nexport function countOfDeepEqualObjects(obj: any, arr: Array<any>): number {\n  return arr.reduce((acc, curr) => {\n    if (deepEqualObjects(obj, curr)) {\n      acc++;\n    }\n    return acc;\n  }, 0);\n}\n\nexport function indexOfFirstOccurrence(\n  obj: any,\n  arr: Array<any>\n): number | undefined {\n  for (let index = 0; index < arr.length; index++) {\n    if (deepEqualObjects(arr[index], obj)) {\n      return index;\n    }\n  }\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { select, Store } from '@ngrx/store';\nimport { EMPTY, Observable, of } from 'rxjs';\nimport {\n  concatMap,\n  delay,\n  filter,\n  map,\n  pluck,\n  switchMap,\n  take,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { Translatable } from '../../../i18n/translatable';\nimport {\n  countOfDeepEqualObjects,\n  indexOfFirstOccurrence,\n} from '../../../util/compare-equal-objects';\nimport { GlobalMessageConfig } from '../../config/global-message-config';\nimport { GlobalMessage } from '../../models/global-message.model';\nimport { GlobalMessageActions } from '../actions/index';\nimport { StateWithGlobalMessage } from '../global-message-state';\nimport { GlobalMessageSelectors } from '../selectors/index';\n\n@Injectable()\nexport class GlobalMessageEffect {\n  @Effect()\n  removeDuplicated$: Observable<\n    GlobalMessageActions.RemoveMessage\n  > = this.actions$.pipe(\n    ofType(GlobalMessageActions.ADD_MESSAGE),\n    pluck('payload'),\n    switchMap((message: GlobalMessage) =>\n      of(message.text).pipe(\n        withLatestFrom(\n          this.store.pipe(\n            select(\n              GlobalMessageSelectors.getGlobalMessageEntitiesByType(\n                message.type\n              )\n            )\n          )\n        ),\n        filter(\n          ([text, messages]: [Translatable, Translatable[]]) =>\n            countOfDeepEqualObjects(text, messages) > 1\n        ),\n        map(\n          ([text, messages]: [Translatable, Translatable[]]) =>\n            new GlobalMessageActions.RemoveMessage({\n              type: message.type,\n              index: indexOfFirstOccurrence(text, messages),\n            })\n        )\n      )\n    )\n  );\n\n  @Effect()\n  hideAfterDelay$: Observable<\n    GlobalMessageActions.RemoveMessage\n  > = isPlatformBrowser(this.platformId) // we don't want to run this logic when doing SSR\n    ? this.actions$.pipe(\n        ofType(GlobalMessageActions.ADD_MESSAGE),\n        pluck('payload'),\n        concatMap((message: GlobalMessage) => {\n          const config = this.config.globalMessages[message.type];\n          return this.store.pipe(\n            select(\n              GlobalMessageSelectors.getGlobalMessageCountByType(message.type)\n            ),\n            take(1),\n            filter(\n              (count: number) =>\n                ((config && config.timeout !== undefined) || message.timeout) &&\n                count &&\n                count > 0\n            ),\n            delay(message.timeout || config.timeout),\n            switchMap(() =>\n              of(\n                new GlobalMessageActions.RemoveMessage({\n                  type: message.type,\n                  index: 0,\n                })\n              )\n            )\n          );\n        })\n      )\n    : EMPTY;\n\n  constructor(\n    private actions$: Actions,\n    private store: Store<StateWithGlobalMessage>,\n    private config: GlobalMessageConfig,\n    @Inject(PLATFORM_ID) private platformId: any\n  ) {}\n}\n","import { GlobalMessageType } from '../models/global-message.model';\nimport { GlobalMessageConfig } from './global-message-config';\n\nexport function defaultGlobalMessageConfigFactory(): GlobalMessageConfig {\n  return {\n    globalMessages: {\n      [GlobalMessageType.MSG_TYPE_CONFIRMATION]: {\n        timeout: 3000,\n      },\n      [GlobalMessageType.MSG_TYPE_INFO]: {\n        timeout: 3000,\n      },\n      [GlobalMessageType.MSG_TYPE_ERROR]: {\n        timeout: 7000,\n      },\n      [GlobalMessageType.MSG_TYPE_WARNING]: {\n        timeout: 7000,\n      },\n    },\n  };\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\n\nimport { GlobalMessageService } from './facade/global-message.service';\nimport {\n  errorHandlers,\n  httpErrorInterceptors,\n} from './http-interceptors/index';\nimport { GlobalMessageStoreModule } from './store/global-message-store.module';\nimport { GlobalMessageEffect } from './store/effects/global-message.effect';\n\nimport { Config, provideDefaultConfigFactory } from '../config/config.module';\nimport { defaultGlobalMessageConfigFactory } from './config/default-global-message-config';\nimport { GlobalMessageConfig } from './config/global-message-config';\n\n@NgModule({\n  imports: [\n    GlobalMessageStoreModule,\n    EffectsModule.forFeature([GlobalMessageEffect]),\n  ],\n  providers: [\n    provideDefaultConfigFactory(defaultGlobalMessageConfigFactory),\n    GlobalMessageService,\n    { provide: GlobalMessageConfig, useExisting: Config },\n  ],\n})\nexport class GlobalMessageModule {\n  static forRoot(): ModuleWithProviders<GlobalMessageModule> {\n    return {\n      ngModule: GlobalMessageModule,\n      providers: [...errorHandlers, ...httpErrorInterceptors],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  GlobalMessageService,\n  GlobalMessageType,\n} from '../../global-message/index';\nimport { AsmAuthService } from '../facade/asm-auth.service';\n\n@Injectable({ providedIn: 'root' })\nexport class CustomerSupportAgentErrorHandlingService {\n  constructor(\n    protected asmAuthService: AsmAuthService,\n    protected globalMessageService: GlobalMessageService\n  ) {}\n\n  terminateCustomerSupportAgentExpiredSession(): void {\n    this.asmAuthService.logoutCustomerSupportAgent();\n    this.globalMessageService.add(\n      {\n        key: 'asm.csagentTokenExpired',\n      },\n      GlobalMessageType.MSG_TYPE_ERROR\n    );\n  }\n}\n","import {\n  HttpErrorResponse,\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport {\n  InterceptorUtil,\n  USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n} from '../../occ/utils/interceptor-util';\nimport { CustomerSupportAgentErrorHandlingService } from '../../asm/services/csagent-error-handling.service';\n\n@Injectable({ providedIn: 'root' })\nexport class CustomerSupportAgentAuthErrorInterceptor\n  implements HttpInterceptor {\n  constructor(\n    private csagentErrorHandlingService: CustomerSupportAgentErrorHandlingService\n  ) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    const isCustomerSupportAgentRequest = this.isCustomerSupportAgentRequest(\n      request\n    );\n    if (isCustomerSupportAgentRequest) {\n      request = InterceptorUtil.removeHeader(\n        USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n        request\n      );\n    }\n\n    return next.handle(request).pipe(\n      catchError((errResponse: any) => {\n        if (errResponse instanceof HttpErrorResponse) {\n          // Unauthorized\n          if (isCustomerSupportAgentRequest && errResponse.status === 401) {\n            this.csagentErrorHandlingService.terminateCustomerSupportAgentExpiredSession();\n            return of(undefined as any);\n          }\n        }\n        return throwError(errResponse);\n      })\n    );\n  }\n\n  private isCustomerSupportAgentRequest(request: HttpRequest<any>): boolean {\n    const isRequestMapping = InterceptorUtil.getInterceptorParam(\n      USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n      request.headers\n    );\n    return Boolean(isRequestMapping);\n  }\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Provider } from '@angular/core';\nimport { CustomerSupportAgentTokenInterceptor } from './csagent-token.interceptor';\nimport { CustomerSupportAgentAuthErrorInterceptor } from './csagent-auth-error.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: CustomerSupportAgentTokenInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: CustomerSupportAgentAuthErrorInterceptor,\n    multi: true,\n  },\n];\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { AsmConfig } from './config/asm-config';\nimport { defaultAsmConfig } from './config/default-asm-config';\nimport { AsmStoreModule } from './store/asm-store.module';\nimport { interceptors } from './http-interceptors/index';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule, AsmStoreModule],\n})\nexport class AsmModule {\n  static forRoot(): ModuleWithProviders<AsmModule> {\n    return {\n      ngModule: AsmModule,\n      providers: [\n        { provide: AsmConfig, useExisting: Config },\n        ...interceptors,\n        provideDefaultConfig(defaultAsmConfig),\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport {\n  AsmUi,\n  CustomerSearchOptions,\n  CustomerSearchPage,\n} from '../models/asm.models';\nimport { AsmActions } from '../store/actions/index';\nimport { StateWithAsm } from '../store/asm-state';\nimport { AsmSelectors } from '../store/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AsmService {\n  constructor(protected store: Store<StateWithAsm>) {}\n\n  /**\n   * Search for customers\n   * @param options\n   */\n  customerSearch(options: CustomerSearchOptions): void {\n    this.store.dispatch(new AsmActions.CustomerSearch(options));\n  }\n\n  /**\n   * Reset the customer search result data to the initial state.\n   */\n  customerSearchReset(): void {\n    this.store.dispatch(new AsmActions.CustomerSearchReset());\n  }\n\n  /**\n   * Returns the customer search result data.\n   */\n  getCustomerSearchResults(): Observable<CustomerSearchPage> {\n    return this.store.pipe(select(AsmSelectors.getCustomerSearchResults));\n  }\n\n  /**\n   * Returns the customer search result loading status.\n   */\n  getCustomerSearchResultsLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(AsmSelectors.getCustomerSearchResultsLoading)\n    );\n  }\n\n  /**\n   * Updates the state of the ASM UI\n   */\n  updateAsmUiState(asmUi: AsmUi) {\n    this.store.dispatch(new AsmActions.AsmUiUpdate(asmUi));\n  }\n\n  /**\n   * Get the state of the ASM UI\n   */\n  getAsmUiState(): Observable<AsmUi> {\n    return this.store.pipe(select(AsmSelectors.getAsmUi));\n  }\n}\n","import { Observable } from 'rxjs';\nimport { PageType } from '../../model/cms.model';\nimport { Page, PageMeta } from '../model/page.model';\n\nexport abstract class PageMetaResolver {\n  pageType: PageType;\n  pageTemplate: string;\n\n  /**\n   * The resolve method is no longer preferred and will be removed with release 2.0.\n   * The caller `PageMetaService` service is improved to expect all individual resolvers\n   * instead, so that the code is easier extensible.\n   *\n   * @deprecated since version 1.3\n   */\n  abstract resolve(): Observable<PageMeta>;\n\n  getScore(page: Page): number {\n    let score = 0;\n\n    if (this.pageType) {\n      score += page.type === this.pageType ? 1 : -1;\n    }\n    if (this.pageTemplate) {\n      score += page.template === this.pageTemplate ? 1 : -1;\n    }\n    return score;\n  }\n}\n","// Email Standard RFC 5322:\nexport const EMAIL_PATTERN = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/; // tslint:disable-line\n\nexport const PASSWORD_PATTERN = /^(?=.*?[A-Z])(?=.*?[0-9])(?=.*?[!@#$%^*()_\\-+{};:.,]).{6,}$/;\n","import { Cart } from '../../model/cart.model';\nimport { OrderEntry } from '../../model/order.model';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\n\nexport const CART_FEATURE = 'cart';\nexport const CART_DATA = '[Cart] Cart Data';\nexport const ADD_VOUCHER_PROCESS_ID = 'addVoucher';\n\nexport interface StateWithCart {\n  [CART_FEATURE]: CartsState;\n}\n\nexport interface CartsState {\n  active: LoaderState<CartState>;\n}\n\nexport interface CartState {\n  content: Cart;\n  entries: { [code: string]: OrderEntry };\n  refresh: boolean;\n  cartMergeComplete: boolean;\n}\n","import {\n  createFeatureSelector,\n  createSelector,\n  MemoizedSelector,\n} from '@ngrx/store';\nimport { Cart } from '../../../model/cart.model';\nimport { OrderEntry } from '../../../model/order.model';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  CartsState,\n  CartState,\n  CART_FEATURE,\n  StateWithCart,\n} from '../cart-state';\nimport { User } from '../../../model/misc.model';\n\nconst getCartContentSelector = (state: CartState) => state.content;\nconst getCartRefreshSelector = (state: CartState) => state.refresh;\nconst getCartEntriesSelector = (state: CartState) => state.entries;\nconst getCartMergeCompleteSelector = (state: CartState) =>\n  state.cartMergeComplete;\n\nexport const getCartsState: MemoizedSelector<\n  StateWithCart,\n  CartsState\n> = createFeatureSelector<CartsState>(CART_FEATURE);\n\nexport const getActiveCartState: MemoizedSelector<\n  StateWithCart,\n  LoaderState<CartState>\n> = createSelector(\n  getCartsState,\n  (cartsState: CartsState) => cartsState.active\n);\n\nexport const getCartState: MemoizedSelector<\n  StateWithCart,\n  CartState\n> = createSelector(getActiveCartState, state =>\n  StateLoaderSelectors.loaderValueSelector(state)\n);\n\nexport const getCartContent: MemoizedSelector<\n  StateWithCart,\n  Cart\n> = createSelector(getCartState, getCartContentSelector);\n\nexport const getCartRefresh: MemoizedSelector<\n  StateWithCart,\n  boolean\n> = createSelector(getCartState, getCartRefreshSelector);\n\nexport const getCartLoaded: MemoizedSelector<\n  StateWithCart,\n  boolean\n> = createSelector(\n  getActiveCartState,\n  state =>\n    (StateLoaderSelectors.loaderSuccessSelector(state) &&\n      !StateLoaderSelectors.loaderLoadingSelector(state) &&\n      !StateLoaderSelectors.loaderValueSelector(state).refresh) ||\n    (StateLoaderSelectors.loaderErrorSelector(state) &&\n      !StateLoaderSelectors.loaderLoadingSelector(state) &&\n      !StateLoaderSelectors.loaderValueSelector(state).refresh)\n);\n\nexport const getCartLoading: MemoizedSelector<\n  any,\n  boolean\n> = createSelector(getActiveCartState, state =>\n  StateLoaderSelectors.loaderLoadingSelector(state)\n);\n\nexport const getCartMergeComplete: MemoizedSelector<\n  StateWithCart,\n  boolean\n> = createSelector(getCartState, getCartMergeCompleteSelector);\n\nexport const getCartEntriesMap: MemoizedSelector<\n  StateWithCart,\n  { [code: string]: OrderEntry }\n> = createSelector(getCartState, getCartEntriesSelector);\n\nexport const getCartEntrySelectorFactory = (\n  productCode: string\n): MemoizedSelector<StateWithCart, OrderEntry> => {\n  return createSelector(getCartEntriesMap, entries => {\n    if (entries) {\n      return entries[productCode];\n    }\n  });\n};\n\nexport const getCartEntries: MemoizedSelector<\n  StateWithCart,\n  OrderEntry[]\n> = createSelector(getCartEntriesMap, entities => {\n  return Object.keys(entities).map(code => entities[code]);\n});\n\nexport const getCartUser: MemoizedSelector<\n  StateWithCart,\n  User\n> = createSelector(getCartContent, content => content.user);\n","import {\n  createFeatureSelector,\n  createSelector,\n  MemoizedSelector,\n} from '@ngrx/store';\nimport { Cart } from '../../../model/cart.model';\nimport { OrderEntry } from '../../../model/order.model';\nimport { entityValueSelector } from '../../../state/utils/entity-loader/entity-loader.selectors';\nimport { EntityProcessesLoaderState } from '../../../state/utils/entity-processes-loader/entity-processes-loader-state';\nimport {\n  entityHasPendingProcessesSelector,\n  entityIsStableSelector,\n  entityProcessesLoaderStateSelector,\n} from '../../../state/utils/entity-processes-loader/entity-processes-loader.selectors';\nimport { ProcessesLoaderState } from '../../../state/utils/processes-loader/processes-loader-state';\nimport {\n  MultiCartState,\n  MULTI_CART_FEATURE,\n  StateWithMultiCart,\n} from '../multi-cart-state';\n\nexport const getMultiCartState: MemoizedSelector<\n  StateWithMultiCart,\n  MultiCartState\n> = createFeatureSelector<MultiCartState>(MULTI_CART_FEATURE);\n\nexport const getMultiCartEntities: MemoizedSelector<\n  StateWithMultiCart,\n  EntityProcessesLoaderState<Cart>\n> = createSelector(getMultiCartState, (state: MultiCartState) => state.carts);\n\nexport const getCartEntitySelectorFactory = (\n  cartId: string\n): MemoizedSelector<StateWithMultiCart, ProcessesLoaderState<Cart>> => {\n  return createSelector(\n    getMultiCartEntities,\n    (state: EntityProcessesLoaderState<Cart>) =>\n      entityProcessesLoaderStateSelector(state, cartId)\n  );\n};\n\nexport const getCartSelectorFactory = (\n  cartId: string\n): MemoizedSelector<StateWithMultiCart, Cart> => {\n  return createSelector(\n    getMultiCartEntities,\n    (state: EntityProcessesLoaderState<Cart>) =>\n      entityValueSelector(state, cartId)\n  );\n};\n\nexport const getCartIsStableSelectorFactory = (\n  cartId: string\n): MemoizedSelector<StateWithMultiCart, boolean> => {\n  return createSelector(\n    getMultiCartEntities,\n    (state: EntityProcessesLoaderState<Cart>) =>\n      entityIsStableSelector(state, cartId)\n  );\n};\n\nexport const getCartHasPendingProcessesSelectorFactory = (\n  cartId: string\n): MemoizedSelector<StateWithMultiCart, boolean> => {\n  return createSelector(\n    getMultiCartEntities,\n    (state: EntityProcessesLoaderState<Cart>) =>\n      entityHasPendingProcessesSelector(state, cartId)\n  );\n};\n\nexport const getCartEntriesSelectorFactory = (\n  cartId: string\n): MemoizedSelector<StateWithMultiCart, OrderEntry[]> => {\n  return createSelector(getCartSelectorFactory(cartId), (state: Cart) => {\n    return state && state.entries ? state.entries : [];\n  });\n};\n\nexport const getCartEntrySelectorFactory = (\n  cartId: string,\n  productCode: string\n): MemoizedSelector<StateWithMultiCart, OrderEntry> => {\n  return createSelector(\n    getCartEntriesSelectorFactory(cartId),\n    (state: OrderEntry[]) => {\n      return state\n        ? state.find(entry => entry.product.code === productCode)\n        : undefined;\n    }\n  );\n};\n\nexport const getActiveCartId: MemoizedSelector<\n  StateWithMultiCart,\n  string\n> = createSelector(getMultiCartState, (state: MultiCartState) => state.active);\n\nexport const getWishListId: MemoizedSelector<\n  StateWithMultiCart,\n  string\n> = createSelector(\n  getMultiCartState,\n  (state: MultiCartState) => state.wishList\n);\n","import { Cart } from '../../model/cart.model';\nimport { EntityProcessesLoaderState } from '../../state/utils/entity-processes-loader/entity-processes-loader-state';\n\nexport const MULTI_CART_FEATURE = 'multi-cart';\nexport const MULTI_CART_DATA = '[Multi Cart] Multi Cart Data';\n\nexport interface StateWithMultiCart {\n  [MULTI_CART_FEATURE]: MultiCartState;\n}\n\nexport interface MultiCartState {\n  carts: EntityProcessesLoaderState<Cart>;\n  active: string;\n  wishList: string;\n}\n","import { Cart } from '../../model/cart.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\n\nexport function getCartIdByUserId(cart: Cart, userId: string): string {\n  if (userId === OCC_USER_ID_ANONYMOUS) {\n    return cart.guid;\n  }\n  return cart.code;\n}\n\n/**\n * What is a temporary cart?\n * - frontend only cart entity!\n * - can be identified in store by `temp-` prefix with some unique id (multiple carts can be created at the same time eg. active cart, wishlist)\n *\n * Why we need temporary carts?\n * - to have information about cart creation process (meta flags: loading, error - for showing loader, error message)\n * - to know if there is currently a cart creation process in progress (eg. so, we don't create more than one active cart at the same time)\n * - cart identifiers are created in the backend, so those are only known after cart is created\n *\n * Temporary cart lifecycle\n * - create cart method invoked\n * - new `temp-${uuid}` cart is created with `loading=true` state\n * - backend returns created cart\n * - normal cart entity is saved under correct id (eg. for logged user under cart `code` key)\n * - temporary cart value is set to backend response (anyone observing this cart can read code/guid from it and switch selector to normal cart)\n * - in next tick temporary cart is removed\n */\nexport function isTempCartId(cartId: string): boolean {\n  return cartId.startsWith('temp-');\n}\n","import { Action } from '@ngrx/store';\nimport { StateLoaderActions } from '../../../state/utils/index';\nimport { CART_DATA } from '../cart-state';\n\nexport const CREATE_CART = '[Cart] Create Cart';\nexport const CREATE_CART_FAIL = '[Cart] Create Cart Fail';\nexport const CREATE_CART_SUCCESS = '[Cart] Create Cart Success';\n\nexport const LOAD_CART = '[Cart] Load Cart';\nexport const LOAD_CART_FAIL = '[Cart] Load Cart Fail';\nexport const LOAD_CART_SUCCESS = '[Cart] Load Cart Success';\n\nexport const ADD_EMAIL_TO_CART = '[Cart] Add Email to Cart';\nexport const ADD_EMAIL_TO_CART_FAIL = '[Cart] Add Email to Cart Fail';\nexport const ADD_EMAIL_TO_CART_SUCCESS = '[Cart] Add Email to Cart Success';\n\nexport const MERGE_CART = '[Cart] Merge Cart';\nexport const MERGE_CART_SUCCESS = '[Cart] Merge Cart Success';\n\nexport const RESET_CART_DETAILS = '[Cart] Reset Cart Details';\n\nexport const CLEAR_EXPIRED_COUPONS = '[Cart] Clear Expired Coupon';\n\nexport const CLEAR_CART = '[Cart] Clear Cart';\n\nexport const DELETE_CART = '[Cart] Delete Cart';\nexport const DELETE_CART_FAIL = '[Cart] Delete Cart Fail';\n\nexport class CreateCart extends StateLoaderActions.LoaderLoadAction {\n  readonly type = CREATE_CART;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class CreateCartFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = CREATE_CART_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport class CreateCartSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = CREATE_CART_SUCCESS;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class AddEmailToCart extends StateLoaderActions.LoaderLoadAction {\n  readonly type = ADD_EMAIL_TO_CART;\n  constructor(\n    public payload: { userId: string; cartId: string; email: string }\n  ) {\n    super(CART_DATA);\n  }\n}\n\nexport class AddEmailToCartFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = ADD_EMAIL_TO_CART_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport class AddEmailToCartSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = ADD_EMAIL_TO_CART_SUCCESS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(CART_DATA);\n  }\n}\n\nexport class LoadCart extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_CART;\n  constructor(\n    public payload: { userId: string; cartId: string; extraData?: any }\n  ) {\n    super(CART_DATA);\n  }\n}\n\nexport class LoadCartFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_CART_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport class LoadCartSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_CART_SUCCESS;\n  constructor(public payload: any) {\n    super(CART_DATA);\n  }\n}\n\nexport class MergeCart implements Action {\n  readonly type = MERGE_CART;\n  constructor(public payload: any) {}\n}\n\nexport class MergeCartSuccess implements Action {\n  readonly type = MERGE_CART_SUCCESS;\n  constructor(public payload: { cartId: string; userId: string }) {}\n}\n\nexport class ResetCartDetails implements Action {\n  readonly type = RESET_CART_DETAILS;\n  constructor() {}\n}\n\nexport class ClearExpiredCoupons implements Action {\n  readonly type = CLEAR_EXPIRED_COUPONS;\n  constructor(public payload: any) {}\n}\n\nexport class ClearCart extends StateLoaderActions.LoaderResetAction {\n  readonly type = CLEAR_CART;\n  constructor() {\n    super(CART_DATA);\n  }\n}\n\nexport class DeleteCart extends StateLoaderActions.LoaderLoadAction {\n  readonly type = DELETE_CART;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(CART_DATA);\n  }\n}\n\nexport class DeleteCartFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = DELETE_CART_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport type CartAction =\n  | CreateCart\n  | CreateCartFail\n  | CreateCartSuccess\n  | LoadCart\n  | LoadCartFail\n  | LoadCartSuccess\n  | MergeCart\n  | MergeCartSuccess\n  | ResetCartDetails\n  | AddEmailToCart\n  | AddEmailToCartFail\n  | AddEmailToCartSuccess\n  | DeleteCart\n  | DeleteCartFail\n  | ClearExpiredCoupons\n  | ClearCart;\n","import { StateLoaderActions } from '../../../state/utils/index';\nimport { CART_DATA } from '../cart-state';\n\nexport const CART_ADD_ENTRY = '[Cart-entry] Add Entry';\nexport const CART_ADD_ENTRY_SUCCESS = '[Cart-entry] Add Entry Success';\nexport const CART_ADD_ENTRY_FAIL = '[Cart-entry] Add Entry Fail';\nexport const CART_REMOVE_ENTRY = '[Cart-entry] Remove Entry';\nexport const CART_REMOVE_ENTRY_SUCCESS = '[Cart-entry] Remove Entry Success';\nexport const CART_REMOVE_ENTRY_FAIL = '[Cart-entry] Remove Entry Fail';\n\nexport const CART_UPDATE_ENTRY = '[Cart-entry] Update Entry';\nexport const CART_UPDATE_ENTRY_SUCCESS = '[Cart-entry] Update Entry Success';\nexport const CART_UPDATE_ENTRY_FAIL = '[Cart-entry] Update Entry Fail';\n\nexport class CartAddEntry extends StateLoaderActions.LoaderLoadAction {\n  readonly type = CART_ADD_ENTRY;\n  constructor(\n    public payload: {\n      cartId: string;\n      userId: string;\n      productCode: string;\n      quantity: number;\n    }\n  ) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartAddEntrySuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = CART_ADD_ENTRY_SUCCESS;\n  constructor(\n    public payload: { userId: string; cartId: string; [key: string]: any }\n  ) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartAddEntryFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = CART_ADD_ENTRY_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport class CartRemoveEntry extends StateLoaderActions.LoaderLoadAction {\n  readonly type = CART_REMOVE_ENTRY;\n  constructor(\n    public payload: { cartId: string; userId: string; entry: string }\n  ) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartRemoveEntrySuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = CART_REMOVE_ENTRY_SUCCESS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartRemoveEntryFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = CART_REMOVE_ENTRY_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport class CartUpdateEntry extends StateLoaderActions.LoaderLoadAction {\n  readonly type = CART_UPDATE_ENTRY;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      entry: string;\n      qty: number;\n    }\n  ) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartUpdateEntrySuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = CART_UPDATE_ENTRY_SUCCESS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartUpdateEntryFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = CART_UPDATE_ENTRY_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport type CartEntryAction =\n  | CartAddEntry\n  | CartAddEntrySuccess\n  | CartAddEntryFail\n  | CartRemoveEntry\n  | CartRemoveEntrySuccess\n  | CartRemoveEntryFail\n  | CartUpdateEntry\n  | CartUpdateEntrySuccess\n  | CartUpdateEntryFail;\n","import { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntityResetAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport {\n  LoaderFailAction,\n  LoaderLoadAction,\n  LoaderSuccessAction,\n} from '../../../state/utils/loader/loader.action';\nimport { ADD_VOUCHER_PROCESS_ID, CART_DATA } from '../cart-state';\n\nexport const CART_ADD_VOUCHER = '[Cart-voucher] Add Cart Vouchers';\nexport const CART_ADD_VOUCHER_FAIL = '[Cart-voucher] Add Cart Voucher Fail';\nexport const CART_ADD_VOUCHER_SUCCESS =\n  '[Cart-voucher] Add Cart Voucher Success';\nexport const CART_RESET_ADD_VOUCHER = '[Cart-voucher] Reset Add Cart Voucher';\n\nexport const CART_REMOVE_VOUCHER = '[Cart-voucher] Remove Cart Voucher';\nexport const CART_REMOVE_VOUCHER_FAIL =\n  '[Cart-voucher] Remove Cart Voucher Fail';\nexport const CART_REMOVE_VOUCHER_SUCCESS =\n  '[Cart-voucher] Remove Cart Voucher Success';\n\n// Adding cart voucher actions\nexport class CartAddVoucher extends EntityLoadAction {\n  readonly type = CART_ADD_VOUCHER;\n  constructor(\n    public payload: { userId: string; cartId: string; voucherId: string }\n  ) {\n    super(PROCESS_FEATURE, ADD_VOUCHER_PROCESS_ID);\n  }\n}\n\nexport class CartAddVoucherFail extends EntityFailAction {\n  readonly type = CART_ADD_VOUCHER_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, ADD_VOUCHER_PROCESS_ID, payload);\n  }\n}\n\nexport class CartAddVoucherSuccess extends EntitySuccessAction {\n  readonly type = CART_ADD_VOUCHER_SUCCESS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(PROCESS_FEATURE, ADD_VOUCHER_PROCESS_ID);\n  }\n}\n\nexport class CartResetAddVoucher extends EntityResetAction {\n  readonly type = CART_RESET_ADD_VOUCHER;\n  constructor() {\n    super(PROCESS_FEATURE, ADD_VOUCHER_PROCESS_ID);\n  }\n}\n\n// Deleting cart voucher\nexport class CartRemoveVoucher extends LoaderLoadAction {\n  readonly type = CART_REMOVE_VOUCHER;\n  constructor(\n    public payload: { userId: string; cartId: string; voucherId: string }\n  ) {\n    super(CART_DATA);\n  }\n}\n\nexport class CartRemoveVoucherFail extends LoaderFailAction {\n  readonly type = CART_REMOVE_VOUCHER_FAIL;\n  constructor(public payload: any) {\n    super(CART_DATA, payload);\n  }\n}\n\nexport class CartRemoveVoucherSuccess extends LoaderSuccessAction {\n  readonly type = CART_REMOVE_VOUCHER_SUCCESS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(CART_DATA);\n  }\n}\n\n// action types\nexport type CartVoucherAction =\n  | CartAddVoucher\n  | CartAddVoucherFail\n  | CartAddVoucherSuccess\n  | CartResetAddVoucher\n  | CartRemoveVoucher\n  | CartRemoveVoucherFail\n  | CartRemoveVoucherSuccess;\n","import { Action } from '@ngrx/store';\nimport { Cart } from '../../../model/cart.model';\nimport {\n  EntityFailAction,\n  EntityLoadAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport {\n  EntityProcessesDecrementAction,\n  EntityProcessesIncrementAction,\n  EntityProcessesLoaderResetAction,\n} from '../../../state/utils/entity-processes-loader/entity-processes-loader.action';\nimport { EntityRemoveAction } from '../../../state/utils/entity/entity.action';\nimport { getCartIdByUserId } from '../../utils/utils';\nimport { MULTI_CART_FEATURE } from '../multi-cart-state';\n\nexport const REMOVE_TEMP_CART = '[Multi Cart] Remove Temp Cart';\n\nexport const CREATE_MULTI_CART = '[Multi Cart] Create Cart';\nexport const CREATE_MULTI_CART_FAIL = '[Multi Cart] Create Cart Fail';\nexport const CREATE_MULTI_CART_SUCCESS = '[Multi Cart] Create Cart Success';\n\nexport const LOAD_MULTI_CART = '[Multi Cart] Load Cart';\nexport const LOAD_MULTI_CART_FAIL = '[Multi Cart] Load Cart Fail';\nexport const LOAD_MULTI_CART_SUCCESS = '[Multi Cart] Load Cart Success';\n\nexport const MERGE_MULTI_CART = '[Multi Cart] Merge Cart';\nexport const MERGE_MULTI_CART_SUCCESS = '[Multi Cart] Merge Cart Success';\n\nexport const RESET_MULTI_CART_DETAILS = '[Multi Cart] Reset Cart Details';\n\nexport const SET_TEMP_CART = '[Multi Cart] Set Temp Cart';\n\nexport const REMOVE_CART = '[Multi Cart] Remove Cart';\n\nexport const ADD_EMAIL_TO_MULTI_CART = '[Multi Cart] Add Email';\nexport const ADD_EMAIL_TO_MULTI_CART_FAIL = '[Multi Cart] Add Email Fail';\nexport const ADD_EMAIL_TO_MULTI_CART_SUCCESS = '[Multi Cart] Add Email Success';\n\nexport const CART_PROCESSES_INCREMENT = '[Multi Cart] Cart Processes Increment';\nexport const CART_PROCESSES_DECREMENT = '[Multi Cart] Cart Processes Decrement';\n\nexport const SET_ACTIVE_CART_ID = '[Multi Cart] Set Active Cart Id';\n\nexport const CLEAR_MULTI_CART_STATE = '[Multi Cart] Clear Cart State';\n\n/**\n * To keep track of cart creation process we use cart with `temp-${uuid}` id.\n * After creating cart we switch to entity with `code` or `guid`.\n * We need `temp-${uuid}` cart entities for loading/error state.\n */\nexport class RemoveTempCart extends EntityRemoveAction {\n  readonly type = REMOVE_TEMP_CART;\n  constructor(public payload: { tempCartId: string }) {\n    super(MULTI_CART_FEATURE, payload.tempCartId);\n  }\n}\n\nexport class SetTempCart extends EntitySuccessAction {\n  readonly type = SET_TEMP_CART;\n  constructor(public payload: { cart: Cart; tempCartId: string }) {\n    super(MULTI_CART_FEATURE, payload.tempCartId, payload.cart);\n  }\n}\n\nexport class CreateMultiCart extends EntityLoadAction {\n  readonly type = CREATE_MULTI_CART;\n  constructor(public payload: any) {\n    super(MULTI_CART_FEATURE, payload.tempCartId);\n  }\n}\n\nexport class CreateMultiCartFail extends EntityFailAction {\n  readonly type = CREATE_MULTI_CART_FAIL;\n  constructor(public payload: any) {\n    super(MULTI_CART_FEATURE, payload.tempCartId);\n  }\n}\n\nexport class CreateMultiCartSuccess extends EntitySuccessAction {\n  readonly type = CREATE_MULTI_CART_SUCCESS;\n  constructor(public payload: { cart: Cart; userId: string; extraData?: any }) {\n    super(MULTI_CART_FEATURE, getCartIdByUserId(payload.cart, payload.userId));\n  }\n}\n\nexport class LoadMultiCart extends EntityLoadAction {\n  readonly type = LOAD_MULTI_CART;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(MULTI_CART_FEATURE, payload.cartId);\n  }\n}\n\nexport class LoadMultiCartFail extends EntityFailAction {\n  readonly type = LOAD_MULTI_CART_FAIL;\n  constructor(public payload: { cartId: string; error?: any }) {\n    super(MULTI_CART_FEATURE, payload.cartId, payload.error);\n  }\n}\n\nexport class LoadMultiCartSuccess extends EntitySuccessAction {\n  readonly type = LOAD_MULTI_CART_SUCCESS;\n  constructor(public payload: { cart: Cart; userId: string; extraData?: any }) {\n    super(MULTI_CART_FEATURE, getCartIdByUserId(payload.cart, payload.userId));\n  }\n}\n\nexport class MergeMultiCart implements Action {\n  readonly type = MERGE_MULTI_CART;\n  constructor(public payload: any) {}\n}\n\nexport class MergeMultiCartSuccess extends EntityRemoveAction {\n  readonly type = MERGE_MULTI_CART_SUCCESS;\n  constructor(\n    public payload: { oldCartId: string; cartId: string; userId: string }\n  ) {\n    super(MULTI_CART_FEATURE, payload.oldCartId);\n  }\n}\n\nexport class ResetMultiCartDetails extends EntityProcessesLoaderResetAction {\n  readonly type = RESET_MULTI_CART_DETAILS;\n  constructor() {\n    super(MULTI_CART_FEATURE, undefined);\n  }\n}\n\nexport class RemoveCart extends EntityRemoveAction {\n  readonly type = REMOVE_CART;\n  constructor(public payload: string) {\n    super(MULTI_CART_FEATURE, payload);\n  }\n}\n\nexport class AddEmailToMultiCart extends EntityLoadAction {\n  readonly type = ADD_EMAIL_TO_MULTI_CART;\n  constructor(\n    public payload: { userId: string; cartId: string; email: string }\n  ) {\n    super(MULTI_CART_FEATURE, payload.cartId);\n  }\n}\n\nexport class AddEmailToMultiCartFail extends EntityFailAction {\n  readonly type = ADD_EMAIL_TO_MULTI_CART_FAIL;\n  constructor(public payload: { userId: string; cartId: string; error: any }) {\n    super(MULTI_CART_FEATURE, payload.cartId, payload.error);\n  }\n}\n\nexport class AddEmailToMultiCartSuccess extends EntitySuccessAction {\n  readonly type = ADD_EMAIL_TO_MULTI_CART_SUCCESS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(MULTI_CART_FEATURE, payload.cartId);\n  }\n}\n\nexport class CartProcessesIncrement extends EntityProcessesIncrementAction {\n  readonly type = CART_PROCESSES_INCREMENT;\n  constructor(public payload: string) {\n    super(MULTI_CART_FEATURE, payload);\n  }\n}\n\nexport class CartProcessesDecrement extends EntityProcessesDecrementAction {\n  readonly type = CART_PROCESSES_DECREMENT;\n  constructor(public payload: string) {\n    super(MULTI_CART_FEATURE, payload);\n  }\n}\n\nexport class SetActiveCartId implements Action {\n  readonly type = SET_ACTIVE_CART_ID;\n  constructor(public payload: string) {}\n}\n\nexport class ClearMultiCartState extends EntityRemoveAction {\n  readonly type = CLEAR_MULTI_CART_STATE;\n  constructor() {\n    super(MULTI_CART_FEATURE, null);\n  }\n}\n\nexport type MultiCartActions =\n  | RemoveTempCart\n  | SetTempCart\n  | CreateMultiCart\n  | CreateMultiCartFail\n  | CreateMultiCartSuccess\n  | LoadMultiCart\n  | LoadMultiCartFail\n  | LoadMultiCartSuccess\n  | MergeMultiCart\n  | MergeMultiCartSuccess\n  | ResetMultiCartDetails\n  | RemoveCart\n  | AddEmailToMultiCart\n  | AddEmailToMultiCartFail\n  | AddEmailToMultiCartSuccess\n  | CartProcessesIncrement\n  | CartProcessesDecrement\n  | SetActiveCartId\n  | ClearMultiCartState;\n","import { Action } from '@ngrx/store';\nimport { Cart } from '../../../model/cart.model';\nimport {\n  EntityFailAction,\n  EntitySuccessAction,\n} from '../../../state/utils/entity-loader/entity-loader.action';\nimport { getCartIdByUserId } from '../../utils/utils';\nimport { MULTI_CART_FEATURE } from '../multi-cart-state';\n\nexport const CREATE_WISH_LIST = '[Wish List] Create Wish List';\nexport const CREATE_WISH_LIST_FAIL = '[Wish List] Create Wish List Fail';\nexport const CREATE_WISH_LIST_SUCCESS = '[Wish List] Create Wish List Success';\n\nexport const LOAD_WISH_LIST = '[Wish List] Load Wish List';\nexport const LOAD_WISH_LIST_SUCCESS = '[Wish List] Load Wish List Success';\n\nexport const RESET_WISH_LIST_DETAILS = '[Wish List] Reset Wish List';\n\nexport class CreateWishList implements Action {\n  readonly type = CREATE_WISH_LIST;\n  constructor(\n    public payload: {\n      userId: string;\n      name: string;\n      description?: string;\n    }\n  ) {}\n}\n\nexport class CreateWishListSuccess extends EntitySuccessAction {\n  readonly type = CREATE_WISH_LIST_SUCCESS;\n  constructor(public payload: { cart: Cart; userId: string }) {\n    super(MULTI_CART_FEATURE, getCartIdByUserId(payload.cart, payload.userId));\n  }\n}\n\nexport class CreateWishListFail extends EntityFailAction {\n  readonly type = CREATE_WISH_LIST_FAIL;\n  constructor(public payload: { cartId: string; error?: any }) {\n    super(MULTI_CART_FEATURE, payload.cartId, payload.error);\n  }\n}\n\nexport class LoadWishList implements Action {\n  readonly type = LOAD_WISH_LIST;\n  constructor(public payload: { userId: string; customerId: string }) {}\n}\n\nexport class LoadWishListSuccess extends EntitySuccessAction {\n  readonly type = LOAD_WISH_LIST_SUCCESS;\n  constructor(public payload: { cart: Cart; userId: string; extraData?: any }) {\n    super(MULTI_CART_FEATURE, getCartIdByUserId(payload.cart, payload.userId));\n  }\n}\n\nexport type WishListActions =\n  | CreateWishList\n  | CreateWishListSuccess\n  | CreateWishListFail\n  | LoadWishList\n  | LoadWishListSuccess;\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { EMPTY, Observable, timer } from 'rxjs';\nimport { debounce, distinctUntilChanged } from 'rxjs/operators';\nimport { Cart } from '../../model/cart.model';\nimport { OrderEntry } from '../../model/order.model';\nimport { ProcessesLoaderState } from '../../state/utils/processes-loader/processes-loader-state';\nimport * as DeprecatedCartActions from '../store/actions/cart.action';\nimport { CartActions } from '../store/actions/index';\nimport { StateWithMultiCart } from '../store/multi-cart-state';\nimport { MultiCartSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class MultiCartService {\n  constructor(protected store: Store<StateWithMultiCart>) {}\n\n  /**\n   * Returns cart from store as an observable\n   *\n   * @param cartId\n   */\n  getCart(cartId: string): Observable<Cart> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getCartSelectorFactory(cartId))\n    );\n  }\n\n  /**\n   * Returns cart entity from store (cart with loading, error, success flags) as an observable\n   *\n   * @param cartId\n   */\n  getCartEntity(cartId: string): Observable<ProcessesLoaderState<Cart>> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getCartEntitySelectorFactory(cartId))\n    );\n  }\n\n  /**\n   * Returns true when there are no operations on that in progress and it is not currently loading\n   *\n   * @param cartId\n   */\n  isStable(cartId: string): Observable<boolean> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getCartIsStableSelectorFactory(cartId)),\n      // We dispatch a lot of actions just after finishing some process or loading, so we want this flag not to flicker.\n      // This flickering should only be avoided when switching from false to true\n      // Start of loading should be showed instantly (no debounce)\n      // Extra actions are only dispatched after some loading\n      debounce(isStable => (isStable ? timer(0) : EMPTY)),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Simple random temp cart id generator\n   */\n  private generateTempCartId(): string {\n    const pseudoUuid = Math.random()\n      .toString(36)\n      .substr(2, 9);\n    return `temp-${pseudoUuid}`;\n  }\n\n  /**\n   * Create or merge cart\n   *\n   * @param params Object with userId, oldCartId, toMergeCartGuid and extraData\n   */\n  createCart({\n    userId,\n    oldCartId,\n    toMergeCartGuid,\n    extraData,\n  }: {\n    userId: string;\n    oldCartId?: string;\n    toMergeCartGuid?: string;\n    extraData?: any;\n  }): Observable<ProcessesLoaderState<Cart>> {\n    // to support creating multiple carts at the same time we need to use different entity for every process\n    // simple random uuid generator is used here for entity names\n    const tempCartId = this.generateTempCartId();\n    this.store.dispatch(\n      new DeprecatedCartActions.CreateCart({\n        extraData,\n        userId,\n        oldCartId,\n        toMergeCartGuid,\n        tempCartId,\n      })\n    );\n    return this.getCartEntity(tempCartId);\n  }\n\n  /**\n   * Merge provided cart to current user cart\n   *\n   * @param params Object with userId, cartId and extraData\n   */\n  mergeToCurrentCart({ userId, cartId, extraData }) {\n    const tempCartId = this.generateTempCartId();\n    this.store.dispatch(\n      new DeprecatedCartActions.MergeCart({\n        userId,\n        cartId,\n        extraData,\n        tempCartId,\n      })\n    );\n  }\n\n  /**\n   * Load cart\n   *\n   * @param params Object with userId, cartId and extraData\n   */\n  loadCart({\n    cartId,\n    userId,\n    extraData,\n  }: {\n    cartId: string;\n    userId: string;\n    extraData?: any;\n  }): void {\n    this.store.dispatch(\n      new DeprecatedCartActions.LoadCart({\n        userId,\n        cartId,\n        extraData,\n      })\n    );\n  }\n\n  /**\n   * Get cart entries as an observable\n   * @param cartId\n   */\n  getEntries(cartId: string): Observable<OrderEntry[]> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getCartEntriesSelectorFactory(cartId))\n    );\n  }\n\n  /**\n   * Add entry to cart\n   *\n   * @param userId\n   * @param cartId\n   * @param productCode\n   * @param quantity\n   */\n  addEntry(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity: number\n  ): void {\n    this.store.dispatch(\n      new CartActions.CartAddEntry({\n        userId,\n        cartId,\n        productCode,\n        quantity,\n      })\n    );\n  }\n\n  /**\n   * Add multiple entries to cart\n   *\n   * @param userId\n   * @param cartId\n   * @param products Array with items (productCode and quantity)\n   */\n  addEntries(\n    userId: string,\n    cartId: string,\n    products: Array<{ productCode: string; quantity: number }>\n  ): void {\n    products.forEach(product => {\n      this.store.dispatch(\n        new CartActions.CartAddEntry({\n          userId,\n          cartId,\n          productCode: product.productCode,\n          quantity: product.quantity,\n        })\n      );\n    });\n  }\n\n  /**\n   * Remove entry from cart\n   *\n   * @param userId\n   * @param cartId\n   * @param entryNumber\n   */\n  removeEntry(userId: string, cartId: string, entryNumber: number): void {\n    this.store.dispatch(\n      new CartActions.CartRemoveEntry({\n        userId,\n        cartId,\n        entry: `${entryNumber}`,\n      })\n    );\n  }\n\n  /**\n   * Update entry in cart. For quantity = 0 it removes entry\n   *\n   * @param userId\n   * @param cartId\n   * @param entryNumber\n   * @param quantity\n   */\n  updateEntry(\n    userId: string,\n    cartId: string,\n    entryNumber: number,\n    quantity: number\n  ): void {\n    if (quantity > 0) {\n      this.store.dispatch(\n        new CartActions.CartUpdateEntry({\n          userId,\n          cartId,\n          entry: `${entryNumber}`,\n          qty: quantity,\n        })\n      );\n    } else {\n      this.removeEntry(userId, cartId, entryNumber);\n    }\n  }\n\n  /**\n   * Get specific entry from cart\n   *\n   * @param cartId\n   * @param productCode\n   */\n  getEntry(cartId: string, productCode: string): Observable<OrderEntry | null> {\n    return this.store.pipe(\n      select(\n        MultiCartSelectors.getCartEntrySelectorFactory(cartId, productCode)\n      )\n    );\n  }\n\n  /**\n   * Assign email to the cart\n   *\n   * @param cartId\n   * @param userId\n   * @param email\n   */\n  assignEmail(cartId: string, userId: string, email: string): void {\n    this.store.dispatch(\n      new DeprecatedCartActions.AddEmailToCart({\n        userId,\n        cartId,\n        email,\n      })\n    );\n  }\n\n  /**\n   * Delete cart\n   *\n   * @param cartId\n   * @param userId\n   */\n  deleteCart(cartId: string, userId: string) {\n    this.store.dispatch(\n      new DeprecatedCartActions.DeleteCart({\n        userId,\n        cartId,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { EMPTY, Observable, timer } from 'rxjs';\nimport {\n  debounce,\n  distinctUntilChanged,\n  filter,\n  map,\n  shareReplay,\n  switchMap,\n  take,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { AuthService } from '../../auth/index';\nimport { Cart } from '../../model/cart.model';\nimport { User } from '../../model/misc.model';\nimport { OrderEntry } from '../../model/order.model';\nimport {\n  OCC_CART_ID_CURRENT,\n  OCC_USER_ID_ANONYMOUS,\n  OCC_USER_ID_GUEST,\n} from '../../occ/utils/occ-constants';\nimport { ProcessesLoaderState } from '../../state/utils/processes-loader/processes-loader-state';\nimport { EMAIL_PATTERN } from '../../util/regex-pattern';\nimport { StateWithMultiCart } from '../store/multi-cart-state';\nimport { MultiCartSelectors } from '../store/selectors/index';\nimport { getCartIdByUserId, isTempCartId } from '../utils/utils';\nimport { MultiCartService } from './multi-cart.service';\n\n@Injectable()\nexport class ActiveCartService {\n  private readonly PREVIOUS_USER_ID_INITIAL_VALUE =\n    'PREVIOUS_USER_ID_INITIAL_VALUE';\n  private previousUserId = this.PREVIOUS_USER_ID_INITIAL_VALUE;\n  private activeCart$: Observable<Cart>;\n\n  private userId = OCC_USER_ID_ANONYMOUS;\n  private cartId;\n  private cartUser: User;\n\n  private activeCartId$ = this.store.pipe(\n    select(MultiCartSelectors.getActiveCartId),\n    map(cartId => {\n      if (!cartId) {\n        return OCC_CART_ID_CURRENT;\n      }\n      return cartId;\n    })\n  );\n  private cartSelector$ = this.activeCartId$.pipe(\n    switchMap(cartId => this.multiCartService.getCartEntity(cartId))\n  );\n\n  constructor(\n    protected store: Store<StateWithMultiCart>,\n    protected authService: AuthService,\n    protected multiCartService: MultiCartService\n  ) {\n    this.authService.getOccUserId().subscribe(userId => {\n      this.userId = userId;\n      if (this.userId !== OCC_USER_ID_ANONYMOUS) {\n        if (this.isJustLoggedIn(userId)) {\n          this.loadOrMerge(this.cartId);\n        }\n      }\n      this.previousUserId = userId;\n    });\n\n    this.activeCartId$.subscribe(cartId => {\n      this.cartId = cartId;\n    });\n\n    this.initActiveCart();\n  }\n\n  private initActiveCart() {\n    this.activeCart$ = this.cartSelector$.pipe(\n      withLatestFrom(this.activeCartId$),\n      map(([cartEntity, activeCartId]: [ProcessesLoaderState<Cart>, string]): {\n        cart: Cart;\n        cartId: string;\n        isStable: boolean;\n        loaded: boolean;\n      } => {\n        return {\n          cart: cartEntity.value,\n          cartId: activeCartId,\n          isStable: !cartEntity.loading && cartEntity.processesCount === 0,\n          loaded:\n            (cartEntity.error || cartEntity.success) && !cartEntity.loading,\n        };\n      }),\n      // we want to emit empty carts even if those are not stable\n      // on merge cart action we want to switch to empty cart so no one would use old cartId which can be already obsolete\n      // so on merge action the resulting stream looks like this: old_cart -> {} -> new_cart\n      filter(({ isStable, cart }) => isStable || this.isEmpty(cart)),\n      tap(({ cart, cartId, loaded, isStable }) => {\n        if (\n          isStable &&\n          this.isEmpty(cart) &&\n          !loaded &&\n          !isTempCartId(cartId)\n        ) {\n          this.load(cartId);\n        }\n      }),\n      map(({ cart }) => (cart ? cart : {})),\n      tap(cart => {\n        if (cart) {\n          this.cartUser = cart.user;\n        }\n      }),\n      distinctUntilChanged(),\n      shareReplay({ bufferSize: 1, refCount: true })\n    );\n  }\n\n  /**\n   * Returns active cart\n   */\n  getActive(): Observable<Cart> {\n    return this.activeCart$;\n  }\n\n  /**\n   * Returns active cart id\n   */\n  getActiveCartId(): Observable<string> {\n    return this.activeCart$.pipe(\n      map(cart => getCartIdByUserId(cart, this.userId)),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Returns cart entries\n   */\n  getEntries(): Observable<OrderEntry[]> {\n    return this.activeCartId$.pipe(\n      switchMap(cartId => this.multiCartService.getEntries(cartId)),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Returns true when cart is stable (not loading and not pending processes on cart)\n   */\n  getLoaded(): Observable<boolean> {\n    // Debounce is used here, to avoid flickering when we switch between different cart entities.\n    // For example during `addEntry` method. We might try to load current cart, so `current cart will be then active id.\n    // After load fails we might create new cart so we switch to `temp-${uuid}` cart entity used when creating cart.\n    // At the end we finally switch to cart `code` for cart id. Between those switches cart `getLoaded` function should not flicker.\n    return this.activeCartId$.pipe(\n      switchMap(cartId => this.multiCartService.isStable(cartId)),\n      debounce(state => (state ? timer(0) : EMPTY)),\n      distinctUntilChanged()\n    );\n  }\n\n  private loadOrMerge(cartId: string): void {\n    // for login user, whenever there's an existing cart, we will load the user\n    // current cart and merge it into the existing cart\n    if (!cartId || cartId === OCC_CART_ID_CURRENT) {\n      this.multiCartService.loadCart({\n        userId: this.userId,\n        cartId: OCC_CART_ID_CURRENT,\n        extraData: {\n          active: true,\n        },\n      });\n    } else if (this.isGuestCart()) {\n      this.guestCartMerge(cartId);\n    } else {\n      this.multiCartService.mergeToCurrentCart({\n        userId: this.userId,\n        cartId,\n        extraData: {\n          active: true,\n        },\n      });\n    }\n  }\n\n  private load(cartId: string): void {\n    if (this.userId !== OCC_USER_ID_ANONYMOUS) {\n      this.multiCartService.loadCart({\n        userId: this.userId,\n        cartId: cartId ? cartId : OCC_CART_ID_CURRENT,\n        extraData: {\n          active: true,\n        },\n      });\n    } else if (cartId && cartId !== OCC_CART_ID_CURRENT) {\n      this.multiCartService.loadCart({\n        userId: this.userId,\n        cartId: cartId,\n        extraData: {\n          active: true,\n        },\n      });\n    }\n  }\n\n  private addEntriesGuestMerge(cartEntries: OrderEntry[]) {\n    const entriesToAdd = cartEntries.map(entry => ({\n      productCode: entry.product.code,\n      quantity: entry.quantity,\n    }));\n    this.requireLoadedCartForGuestMerge().subscribe(cartState => {\n      this.multiCartService.addEntries(\n        this.userId,\n        getCartIdByUserId(cartState.value, this.userId),\n        entriesToAdd\n      );\n    });\n  }\n\n  private requireLoadedCartForGuestMerge() {\n    return this.requireLoadedCart(\n      this.cartSelector$.pipe(filter(() => !this.isGuestCart()))\n    );\n  }\n\n  private isCartCreating(cartState) {\n    // cart creating is always represented with loading flags\n    // when all loading flags are false it means that we restored wrong cart id\n    // could happen on context change or reload right in the middle on cart create call\n    return (\n      isTempCartId(this.cartId) &&\n      (cartState.loading || cartState.success || cartState.error)\n    );\n  }\n\n  private requireLoadedCart(\n    customCartSelector$?: Observable<ProcessesLoaderState<Cart>>\n  ): Observable<ProcessesLoaderState<Cart>> {\n    // For guest cart merge we want to filter guest cart in the whole stream\n    // We have to wait with load/create/addEntry after guest cart will be deleted.\n    // That's why you can provide custom selector with this filter applied.\n    const cartSelector$ = customCartSelector$\n      ? customCartSelector$\n      : this.cartSelector$;\n\n    return cartSelector$.pipe(\n      filter(cartState => !cartState.loading),\n      // Avoid load/create call when there are new cart creating at the moment\n      filter(cartState => !this.isCartCreating(cartState)),\n      take(1),\n      switchMap(cartState => {\n        // Try to load the cart, because it might have been created on another device between our login and add entry call\n        if (\n          this.isEmpty(cartState.value) &&\n          this.userId !== OCC_USER_ID_ANONYMOUS\n        ) {\n          this.load(undefined);\n        }\n        return cartSelector$;\n      }),\n      filter(cartState => !cartState.loading),\n      // create cart can happen to anonymous user if it is not empty or to any other user if it is loaded and empty\n      filter(\n        cartState =>\n          this.userId === OCC_USER_ID_ANONYMOUS ||\n          cartState.success ||\n          cartState.error\n      ),\n      take(1),\n      switchMap(cartState => {\n        if (this.isEmpty(cartState.value)) {\n          this.multiCartService.createCart({\n            userId: this.userId,\n            extraData: {\n              active: true,\n            },\n          });\n        }\n        return cartSelector$;\n      }),\n      filter(cartState => !cartState.loading),\n      filter(cartState => cartState.success || cartState.error),\n      // wait for active cart id to point to code/guid to avoid some work on temp cart entity\n      filter(cartState => !this.isCartCreating(cartState)),\n      filter(cartState => !this.isEmpty(cartState.value)),\n      take(1)\n    );\n  }\n\n  /**\n   * Add entry to active cart\n   *\n   * @param productCode\n   * @param quantity\n   */\n  addEntry(productCode: string, quantity: number): void {\n    this.requireLoadedCart().subscribe(cartState => {\n      this.multiCartService.addEntry(\n        this.userId,\n        getCartIdByUserId(cartState.value, this.userId),\n        productCode,\n        quantity\n      );\n    });\n  }\n\n  /**\n   * Remove entry\n   *\n   * @param entry\n   */\n  removeEntry(entry: OrderEntry): void {\n    this.multiCartService.removeEntry(\n      this.userId,\n      this.cartId,\n      entry.entryNumber\n    );\n  }\n\n  /**\n   * Update entry\n   *\n   * @param entryNumber\n   * @param quantity\n   */\n  updateEntry(entryNumber: number, quantity: number): void {\n    this.multiCartService.updateEntry(\n      this.userId,\n      this.cartId,\n      entryNumber,\n      quantity\n    );\n  }\n\n  /**\n   * Returns cart entry\n   *\n   * @param productCode\n   */\n  getEntry(productCode: string): Observable<OrderEntry> {\n    return this.activeCartId$.pipe(\n      switchMap(cartId => this.multiCartService.getEntry(cartId, productCode)),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Assign email to cart\n   *\n   * @param email\n   */\n  addEmail(email: string): void {\n    this.multiCartService.assignEmail(this.cartId, this.userId, email);\n  }\n\n  /**\n   * Get assigned user to cart\n   */\n  getAssignedUser(): Observable<User> {\n    return this.getActive().pipe(map(cart => cart.user));\n  }\n\n  /**\n   * Returns true for guest cart\n   */\n  isGuestCart(): boolean {\n    return (\n      this.cartUser &&\n      (this.cartUser.name === OCC_USER_ID_GUEST ||\n        this.isEmail(\n          this.cartUser.uid\n            .split('|')\n            .slice(1)\n            .join('|')\n        ))\n    );\n  }\n\n  /**\n   * Add multiple entries to a cart\n   *\n   * @param cartEntries : list of entries to add (OrderEntry[])\n   */\n  addEntries(cartEntries: OrderEntry[]): void {\n    cartEntries.forEach(entry => {\n      this.addEntry(entry.product.code, entry.quantity);\n    });\n  }\n\n  private isEmail(str: string): boolean {\n    if (str) {\n      return str.match(EMAIL_PATTERN) ? true : false;\n    }\n    return false;\n  }\n\n  // TODO: Remove once backend is updated\n  /**\n   * Temporary method to merge guest cart with user cart because of backend limitation\n   * This is for an edge case\n   */\n  private guestCartMerge(cartId: string): void {\n    let cartEntries: OrderEntry[];\n    this.getEntries()\n      .pipe(take(1))\n      .subscribe(entries => {\n        cartEntries = entries;\n      });\n\n    this.multiCartService.deleteCart(cartId, OCC_USER_ID_ANONYMOUS);\n\n    this.addEntriesGuestMerge(cartEntries);\n  }\n\n  private isEmpty(cart: Cart): boolean {\n    return (\n      !cart || (typeof cart === 'object' && Object.keys(cart).length === 0)\n    );\n  }\n\n  private isJustLoggedIn(userId: string): boolean {\n    return (\n      this.previousUserId !== userId && // *just* logged in\n      this.previousUserId !== this.PREVIOUS_USER_ID_INITIAL_VALUE // not app initialization\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable, combineLatest } from 'rxjs';\nimport { take, map } from 'rxjs/operators';\nimport { AuthService } from '../../auth/index';\nimport * as fromProcessStore from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { CartActions } from '../store/actions/index';\nimport { ADD_VOUCHER_PROCESS_ID, StateWithCart } from '../store/cart-state';\nimport { CartSelectors } from '../store/selectors/index';\nimport { Cart } from '../../model/cart.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\n\n@Injectable()\nexport class CartVoucherService {\n  constructor(\n    protected store: Store<\n      StateWithCart | fromProcessStore.StateWithProcess<void>\n    >,\n    protected authService: AuthService\n  ) {}\n\n  addVoucher(voucherId: string, cartId?: string): void {\n    this.combineUserAndCartId(cartId).subscribe(([occUserId, cartIdentifier]) =>\n      this.store.dispatch(\n        new CartActions.CartAddVoucher({\n          userId: occUserId,\n          cartId: cartIdentifier,\n          voucherId: voucherId,\n        })\n      )\n    );\n  }\n\n  removeVoucher(voucherId: string, cartId?: string): void {\n    this.combineUserAndCartId(cartId).subscribe(([occUserId, cartIdentifier]) =>\n      this.store.dispatch(\n        new CartActions.CartRemoveVoucher({\n          userId: occUserId,\n          cartId: cartIdentifier,\n          voucherId: voucherId,\n        })\n      )\n    );\n  }\n\n  getAddVoucherResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(ADD_VOUCHER_PROCESS_ID))\n    );\n  }\n\n  getAddVoucherResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(ADD_VOUCHER_PROCESS_ID))\n    );\n  }\n\n  getAddVoucherResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(ADD_VOUCHER_PROCESS_ID))\n    );\n  }\n\n  resetAddVoucherProcessingState(): void {\n    this.store.dispatch(new CartActions.CartResetAddVoucher());\n  }\n\n  private combineUserAndCartId(cartId: string): Observable<[string, string]> {\n    if (cartId) {\n      return this.authService.getOccUserId().pipe(\n        take(1),\n        map(userId => [userId, cartId])\n      );\n    } else {\n      return combineLatest([\n        this.authService.getOccUserId(),\n        this.store.pipe(\n          select(CartSelectors.getCartContent),\n          map(cart => cart)\n        ),\n      ]).pipe(\n        take(1),\n        map(([userId, cart]: [string, Cart]) => [\n          userId,\n          userId === OCC_USER_ID_ANONYMOUS ? cart.guid : cart.code,\n        ])\n      );\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { take, tap } from 'rxjs/operators';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { Title, User, UserSignUp } from '../../model/misc.model';\nimport { OCC_USER_ID_ANONYMOUS, OCC_USER_ID_CURRENT } from '../../occ/index';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  REGISTER_USER_PROCESS_ID,\n  REMOVE_USER_PROCESS_ID,\n  StateWithUser,\n  UPDATE_EMAIL_PROCESS_ID,\n  UPDATE_PASSWORD_PROCESS_ID,\n  UPDATE_USER_DETAILS_PROCESS_ID,\n} from '../store/user-state';\n\n@Injectable({ providedIn: 'root' })\nexport class UserService {\n  constructor(\n    store: Store<StateWithUser | StateWithProcess<void>>,\n    // tslint:disable-next-line:unified-signatures\n    authService: AuthService\n  );\n  /**\n   * @deprecated since version 1.3\n   *  Use constructor(store: Store<StateWithUser | StateWithProcess<void>>,\n   *  authService: AuthService) instead\n   *\n   *  TODO(issue:#5628) Deprecated since 1.3.0\n   */\n  constructor(store: Store<StateWithUser | StateWithProcess<void>>);\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected authService?: AuthService\n  ) {}\n\n  /**\n   * Returns a user\n   */\n  get(): Observable<User> {\n    return this.store.pipe(\n      select(UsersSelectors.getDetails),\n      tap(details => {\n        if (Object.keys(details).length === 0) {\n          this.load();\n        }\n      })\n    );\n  }\n\n  /**\n   * Loads the user's details\n   */\n  load(): void {\n    this.withUserId(userId => {\n      if (userId !== OCC_USER_ID_ANONYMOUS) {\n        this.store.dispatch(new UserActions.LoadUserDetails(userId));\n      }\n    });\n  }\n\n  /**\n   * Register a new user\n   *\n   * @param submitFormData as UserRegisterFormData\n   */\n  register(userRegisterFormData: UserSignUp): void {\n    this.store.dispatch(new UserActions.RegisterUser(userRegisterFormData));\n  }\n\n  /**\n   * Register a new user from guest\n   *\n   * @param guid\n   * @param password\n   */\n  registerGuest(guid: string, password: string): void {\n    this.store.dispatch(new UserActions.RegisterGuest({ guid, password }));\n  }\n\n  /**\n   * Returns the register user process loading flag\n   */\n  getRegisterUserResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(REGISTER_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the register user process success flag\n   */\n  getRegisterUserResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(REGISTER_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the register user process error flag\n   */\n  getRegisterUserResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(REGISTER_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the register user process flags\n   */\n  resetRegisterUserProcessState(): void {\n    return this.store.dispatch(new UserActions.ResetRegisterUserProcess());\n  }\n\n  /**\n   * Remove user account, that's also called close user's account\n   */\n  remove(): void {\n    this.withUserId(userId =>\n      this.store.dispatch(new UserActions.RemoveUser(userId))\n    );\n  }\n\n  /**\n   * Returns the remove user loading flag\n   */\n  getRemoveUserResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(REMOVE_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the remove user failure outcome.\n   */\n  getRemoveUserResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(REMOVE_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the remove user process success outcome.\n   */\n  getRemoveUserResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(REMOVE_USER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the remove user process state. The state needs to be reset after the process\n   * concludes, regardless if it's a success or an error\n   */\n  resetRemoveUserProcessState(): void {\n    this.store.dispatch(new UserActions.RemoveUserReset());\n  }\n\n  /**\n   * Returns titles\n   */\n  getTitles(): Observable<Title[]> {\n    return this.store.pipe(select(UsersSelectors.getAllTitles));\n  }\n\n  /**\n   * Retrieves titles\n   */\n  loadTitles(): void {\n    this.store.dispatch(new UserActions.LoadTitles());\n  }\n\n  /**\n   * Return whether user's password is successfully reset\n   */\n  isPasswordReset(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getResetPassword));\n  }\n\n  /**\n   * Updates the user's details\n   * @param userDetails to be updated\n   */\n  updatePersonalDetails(userDetails: User): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.UpdateUserDetails({\n          username: userId,\n          userDetails,\n        })\n      )\n    );\n  }\n\n  /**\n   * Returns the update user's personal details loading flag\n   */\n  getUpdatePersonalDetailsResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(UPDATE_USER_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's personal details error flag\n   */\n  getUpdatePersonalDetailsResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(UPDATE_USER_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's personal details success flag\n   */\n  getUpdatePersonalDetailsResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(UPDATE_USER_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the update user details processing state\n   */\n  resetUpdatePersonalDetailsProcessingState(): void {\n    this.store.dispatch(new UserActions.ResetUpdateUserDetails());\n  }\n\n  /**\n   * Reset new password.  Part of the forgot password flow.\n   * @param token\n   * @param password\n   */\n  resetPassword(token: string, password: string): void {\n    this.store.dispatch(new UserActions.ResetPassword({ token, password }));\n  }\n\n  /*\n   * Request an email to reset a forgotten password.\n   */\n  requestForgotPasswordEmail(userEmailAddress: string): void {\n    this.store.dispatch(\n      new UserActions.ForgotPasswordEmailRequest(userEmailAddress)\n    );\n  }\n\n  /**\n   * Updates the user's email\n   */\n  updateEmail(password: string, newUid: string): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.UpdateEmailAction({\n          uid: userId,\n          password,\n          newUid,\n        })\n      )\n    );\n  }\n\n  /**\n   * Returns the update user's email success flag\n   */\n  getUpdateEmailResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(UPDATE_EMAIL_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's email error flag\n   */\n  getUpdateEmailResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(UPDATE_EMAIL_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update user's email loading flag\n   */\n  getUpdateEmailResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(UPDATE_EMAIL_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the update user's email processing state\n   */\n  resetUpdateEmailResultState(): void {\n    this.store.dispatch(new UserActions.ResetUpdateEmailAction());\n  }\n\n  /**\n   * Updates the password for the user\n   * @param oldPassword the current password that will be changed\n   * @param newPassword the new password\n   */\n  updatePassword(oldPassword: string, newPassword: string): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.UpdatePassword({\n          userId,\n          oldPassword,\n          newPassword,\n        })\n      )\n    );\n  }\n\n  /**\n   * Returns the update password loading flag\n   */\n  getUpdatePasswordResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(UPDATE_PASSWORD_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update password failure outcome.\n   */\n  getUpdatePasswordResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(UPDATE_PASSWORD_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the update password process success outcome.\n   */\n  getUpdatePasswordResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(UPDATE_PASSWORD_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the update password process state. The state needs to be reset after the process\n   * concludes, regardless if it's a success or an error\n   */\n  resetUpdatePasswordProcessState(): void {\n    this.store.dispatch(new UserActions.UpdatePasswordReset());\n  }\n\n  /**\n   * Utility method to distinquish pre / post 1.3.0 in a convenient way.\n   *\n   */\n  private withUserId(callback: (userId: string) => void): void {\n    if (this.authService) {\n      this.authService\n        .getOccUserId()\n        .pipe(take(1))\n        .subscribe(userId => callback(userId));\n    } else {\n      // TODO(issue:#5628) Deprecated since 1.3.0\n      callback(OCC_USER_ID_CURRENT);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport { StateWithMultiCart } from '../store/multi-cart-state';\nimport { MultiCartService } from './multi-cart.service';\nimport { UserService } from '../../user/facade/user.service';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { Observable, of, BehaviorSubject, combineLatest } from 'rxjs';\nimport { Cart } from '../../model/cart.model';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { map, filter, tap, shareReplay, switchMap, take } from 'rxjs/operators';\nimport { OrderEntry } from '../../model/order.model';\nimport { BaseSiteService } from '../../site-context/facade/base-site.service';\n\n@Injectable()\nexport class SelectiveCartService {\n  private customerId: string;\n  private userId: string;\n  private cartId: string;\n  private selectiveCart$: Observable<Cart>;\n  private cartId$: BehaviorSubject<string> = new BehaviorSubject<string>(\n    undefined\n  );\n\n  private readonly PREVIOUS_USER_ID_INITIAL_VALUE =\n    'PREVIOUS_USER_ID_INITIAL_VALUE';\n  private previousUserId = this.PREVIOUS_USER_ID_INITIAL_VALUE;\n\n  private cartSelector$ = this.cartId$.pipe(\n    switchMap(cartId => {\n      this.cartId = cartId;\n      return this.multiCartService.getCartEntity(cartId);\n    })\n  );\n\n  constructor(\n    protected store: Store<StateWithMultiCart>,\n    protected userService: UserService,\n    protected authService: AuthService,\n    protected multiCartService: MultiCartService,\n    protected baseSiteService: BaseSiteService\n  ) {\n    combineLatest([\n      this.userService.get(),\n      this.baseSiteService.getActive(),\n    ]).subscribe(([user, activeBaseSite]) => {\n      if (user && user.customerId && activeBaseSite) {\n        this.customerId = user.customerId;\n        this.cartId$.next(`selectivecart${activeBaseSite}${this.customerId}`);\n      } else if (user && !user.customerId) {\n        this.cartId$.next(undefined);\n      }\n    });\n\n    this.authService.getOccUserId().subscribe(userId => {\n      this.userId = userId;\n\n      if (this.isJustLoggedIn(userId)) {\n        this.load();\n      }\n\n      this.previousUserId = userId;\n    });\n\n    this.selectiveCart$ = this.cartSelector$.pipe(\n      map((cartEntity: LoaderState<Cart>): {\n        cart: Cart;\n        loading: boolean;\n        loaded: boolean;\n      } => {\n        return {\n          cart: cartEntity.value,\n          loading: cartEntity.loading,\n          loaded:\n            (cartEntity.error || cartEntity.success) && !cartEntity.loading,\n        };\n      }),\n      filter(({ loading }) => !loading),\n      tap(({ cart, loaded }) => {\n        if (this.cartId && this.isEmpty(cart) && !loaded) {\n          this.load();\n        }\n      }),\n      map(({ cart }) => (cart ? cart : {})),\n      shareReplay({ bufferSize: 1, refCount: true })\n    );\n  }\n\n  getCart(): Observable<Cart> {\n    return this.selectiveCart$;\n  }\n\n  getEntries(): Observable<OrderEntry[]> {\n    return this.multiCartService.getEntries(this.cartId);\n  }\n\n  getLoaded(): Observable<boolean> {\n    return this.cartSelector$.pipe(\n      map(cart => (cart.success || cart.error) && !cart.loading)\n    );\n  }\n\n  private load() {\n    if (this.isLoggedIn(this.userId) && this.cartId) {\n      this.multiCartService.loadCart({\n        userId: this.userId,\n        cartId: this.cartId,\n      });\n    }\n  }\n\n  addEntry(productCode: string, quantity: number): void {\n    let loadAttempted = false;\n    this.cartSelector$\n      .pipe(\n        filter(() => !loadAttempted),\n        switchMap(cartState => {\n          if (this.isEmpty(cartState.value) && !cartState.loading) {\n            loadAttempted = true;\n            this.load();\n          }\n          return of(cartState);\n        }),\n        filter(cartState => !this.isEmpty(cartState.value)),\n        take(1)\n      )\n      .subscribe(_ => {\n        this.multiCartService.addEntry(\n          this.userId,\n          this.cartId,\n          productCode,\n          quantity\n        );\n      });\n  }\n\n  removeEntry(entry: OrderEntry): void {\n    this.multiCartService.removeEntry(\n      this.userId,\n      this.cartId,\n      entry.entryNumber\n    );\n  }\n\n  updateEntry(entryNumber: number, quantity: number): void {\n    this.multiCartService.updateEntry(\n      this.userId,\n      this.cartId,\n      entryNumber,\n      quantity\n    );\n  }\n\n  getEntry(productCode: string): Observable<OrderEntry> {\n    return this.multiCartService.getEntry(this.cartId, productCode);\n  }\n\n  private isEmpty(cart: Cart): boolean {\n    return (\n      !cart || (typeof cart === 'object' && Object.keys(cart).length === 0)\n    );\n  }\n\n  private isJustLoggedIn(userId: string): boolean {\n    return (\n      this.isLoggedIn(userId) &&\n      this.previousUserId !== userId && // *just* logged in\n      this.previousUserId !== this.PREVIOUS_USER_ID_INITIAL_VALUE // not app initialization\n    );\n  }\n\n  private isLoggedIn(userId: string): boolean {\n    return typeof userId !== 'undefined' && userId !== OCC_USER_ID_ANONYMOUS;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, Observable } from 'rxjs';\nimport {\n  distinctUntilChanged,\n  filter,\n  map,\n  switchMap,\n  take,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { Cart, OrderEntry } from '../../model/index';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { UserService } from '../../user/facade/user.service';\nimport { CartActions } from '../store/actions/index';\nimport { StateWithMultiCart } from '../store/multi-cart-state';\nimport { MultiCartSelectors } from '../store/selectors/index';\nimport { MultiCartService } from './multi-cart.service';\n\n@Injectable()\nexport class WishListService {\n  constructor(\n    protected store: Store<StateWithMultiCart>,\n    protected authService: AuthService,\n    protected userService: UserService,\n    protected multiCartService: MultiCartService\n  ) {}\n\n  createWishList(userId: string, name?: string, description?: string): void {\n    this.store.dispatch(\n      new CartActions.CreateWishList({ userId, name, description })\n    );\n  }\n\n  getWishList(): Observable<Cart> {\n    return combineLatest([\n      this.getWishListId(),\n      this.userService.get(),\n      this.authService.getOccUserId(),\n    ]).pipe(\n      distinctUntilChanged(),\n      tap(([wishListId, user, userId]) => {\n        if (\n          !Boolean(wishListId) &&\n          userId !== OCC_USER_ID_ANONYMOUS &&\n          Boolean(user) &&\n          Boolean(user.customerId)\n        ) {\n          this.loadWishList(userId, user.customerId);\n        }\n      }),\n      filter(([wishListId]) => Boolean(wishListId)),\n      switchMap(([wishListId]) => this.multiCartService.getCart(wishListId))\n    );\n  }\n\n  loadWishList(userId: string, customerId: string): void {\n    this.store.dispatch(new CartActions.LoadWishList({ userId, customerId }));\n  }\n\n  addEntry(productCode: string): void {\n    this.getWishListId()\n      .pipe(\n        distinctUntilChanged(),\n        withLatestFrom(this.authService.getOccUserId(), this.userService.get()),\n        tap(([wishListId, userId, user]) => {\n          if (\n            !Boolean(wishListId) &&\n            Boolean(user) &&\n            Boolean(user.customerId)\n          ) {\n            this.loadWishList(userId, user.customerId);\n          }\n        }),\n        filter(([wishListId]) => Boolean(wishListId)),\n        take(1)\n      )\n      .subscribe(([wishListId, userId]) =>\n        this.multiCartService.addEntry(userId, wishListId, productCode, 1)\n      );\n  }\n\n  removeEntry(entry: OrderEntry): void {\n    this.getWishListId()\n      .pipe(\n        distinctUntilChanged(),\n        withLatestFrom(this.authService.getOccUserId(), this.userService.get()),\n        tap(([wishListId, userId, user]) => {\n          if (\n            !Boolean(wishListId) &&\n            Boolean(user) &&\n            Boolean(user.customerId)\n          ) {\n            this.loadWishList(userId, user.customerId);\n          }\n        }),\n        filter(([wishListId]) => Boolean(wishListId)),\n        take(1)\n      )\n      .subscribe(([wishListId, userId]) =>\n        this.multiCartService.removeEntry(userId, wishListId, entry.entryNumber)\n      );\n  }\n\n  getWishListLoading(): Observable<boolean> {\n    return this.getWishListId().pipe(\n      switchMap(wishListId =>\n        this.multiCartService.isStable(wishListId).pipe(map(stable => !stable))\n      )\n    );\n  }\n\n  protected getWishListId(): Observable<string> {\n    return this.store.pipe(select(MultiCartSelectors.getWishListId));\n  }\n}\n","import { CmsComponent } from '../../model';\nimport { EntityState, LoaderState } from '../../state/index';\nimport { EntityLoaderState } from '../../state/utils/entity-loader/entity-loader-state';\nimport { NodeItem } from '../model/node-item.model';\nimport { Page } from '../model/page.model';\n\nexport const CMS_FEATURE = 'cms';\nexport const NAVIGATION_DETAIL_ENTITY = '[Cms] Navigation Entity';\nexport const COMPONENT_ENTITY = '[Cms] Component Entity';\n\nexport interface StateWithCms {\n  [CMS_FEATURE]: CmsState;\n}\n\nexport type ComponentsState = EntityState<ComponentsContext>;\n\nexport interface ComponentsContext {\n  component: CmsComponent;\n  /**\n   * Page context stores an information for which context does the component exist.\n   * For example, if `SiteLogoComponent` was successfully loaded for a product page with an ID of 1776948, then this object will contain:\n   *\n   * ```ts\n   * ProductPage-1776948: {\n   *  success: true,\n   *  loading: false,\n   *  error: false,\n   *  // The `value` property indicates that the component exists for the given page context.\n   *  value: true\n   * }\n   * ```\n   *\n   * If the same `SiteLogoComponent` component was tried to be loaded on homepage (page context id is `homepage`),\n   * and it doesn't exist for some reason (maybe it has a restriction), then this object will contain:\n   *\n   * ```ts\n   * ProductPage-1776948: {\n   *  success: true,\n   *  loading: false,\n   *  error: false,\n   *  // The `value` property indicates that the component exists for the given page context.\n   *  value: true\n   * },\n   * ContentPage-homepage: {\n   *  success: true,\n   *  loading: false,\n   *  error: false,\n   *  // The `value` in this case is `false` indicating that the component was tried to be loaded, but it doesn't exist or has a restriction.\n   *  value: false\n   * }\n   * ```\n   *\n   */\n  pageContext: {\n    [context: string]: LoaderState<boolean>;\n  };\n}\n\nexport type IndexType = {\n  content: EntityLoaderState<string>;\n  product: EntityLoaderState<string>;\n  category: EntityLoaderState<string>;\n  catalog: EntityLoaderState<string>;\n};\n\nexport interface NavigationNodes {\n  [nodeId: string]: NodeItem;\n}\n\nexport interface PageState {\n  pageData: EntityState<Page>;\n  index: IndexType;\n}\n\nexport interface CmsState {\n  page: PageState;\n  components: ComponentsState;\n  navigation: EntityLoaderState<NodeItem>;\n}\n","import { CmsComponent } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing/index';\nimport { StateEntityLoaderActions } from '../../../state/utils/index';\nimport { COMPONENT_ENTITY } from '../cms-state';\n\nexport const LOAD_CMS_COMPONENT = '[Cms] Load Component';\nexport const LOAD_CMS_COMPONENT_FAIL = '[Cms] Load Component Fail';\nexport const LOAD_CMS_COMPONENT_SUCCESS = '[Cms] Load Component Success';\nexport const CMS_GET_COMPONENT_FROM_PAGE = '[Cms] Get Component from Page';\n\nexport class LoadCmsComponent extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = LOAD_CMS_COMPONENT;\n  constructor(\n    public payload: {\n      uid: string;\n      pageContext: PageContext;\n    }\n  ) {\n    super(COMPONENT_ENTITY, payload.uid);\n  }\n}\n\nexport class LoadCmsComponentFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = LOAD_CMS_COMPONENT_FAIL;\n  constructor(\n    public payload: { uid: string; error: any; pageContext: PageContext }\n  ) {\n    super(COMPONENT_ENTITY, payload.uid, payload.error);\n  }\n}\n\nexport class LoadCmsComponentSuccess<\n  T extends CmsComponent\n> extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = LOAD_CMS_COMPONENT_SUCCESS;\n  constructor(\n    public payload: {\n      component: T;\n      uid?: string;\n      pageContext: PageContext;\n    }\n  ) {\n    super(COMPONENT_ENTITY, payload.uid || payload.component.uid || '');\n  }\n}\n\nexport class CmsGetComponentFromPage<\n  T extends CmsComponent\n> extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = CMS_GET_COMPONENT_FROM_PAGE;\n  constructor(\n    public payload:\n      | { component: T; pageContext: PageContext }\n      | { component: T; pageContext: PageContext }[]\n  ) {\n    super(\n      COMPONENT_ENTITY,\n      [].concat(payload).map(cmp => cmp.component.uid)\n    );\n  }\n}\n\n// action types\nexport type CmsComponentAction<T extends CmsComponent> =\n  | LoadCmsComponent\n  | LoadCmsComponentFail\n  | LoadCmsComponentSuccess<T>\n  | CmsGetComponentFromPage<T>;\n","import { StateEntityLoaderActions } from '../../../state/utils/index';\nimport { NAVIGATION_DETAIL_ENTITY } from '../cms-state';\n\nexport const LOAD_CMS_NAVIGATION_ITEMS = '[Cms] Load NavigationEntry items';\nexport const LOAD_CMS_NAVIGATION_ITEMS_FAIL =\n  '[Cms] Load NavigationEntry items Fail';\nexport const LOAD_CMS_NAVIGATION_ITEMS_SUCCESS =\n  '[Cms] Load NavigationEntry items Success';\n\nexport class LoadCmsNavigationItems extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = LOAD_CMS_NAVIGATION_ITEMS;\n  constructor(public payload: { nodeId: string; items: any[] }) {\n    super(NAVIGATION_DETAIL_ENTITY, payload.nodeId);\n  }\n}\n\nexport class LoadCmsNavigationItemsFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = LOAD_CMS_NAVIGATION_ITEMS_FAIL;\n  constructor(nodeId: string, public payload: any) {\n    super(NAVIGATION_DETAIL_ENTITY, nodeId, payload);\n  }\n}\n\nexport class LoadCmsNavigationItemsSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = LOAD_CMS_NAVIGATION_ITEMS_SUCCESS;\n  constructor(public payload: { nodeId: string; components: any[] }) {\n    super(NAVIGATION_DETAIL_ENTITY, payload.nodeId);\n  }\n}\n\n// action types\nexport type CmsNavigationEntryItemAction =\n  | LoadCmsNavigationItems\n  | LoadCmsNavigationItemsFail\n  | LoadCmsNavigationItemsSuccess;\n","import { PageContext } from '../../../routing/index';\nimport { StateEntityLoaderActions } from '../../../state/utils/index';\nimport { Page } from '../../model/page.model';\n\nexport const LOAD_CMS_PAGE_DATA = '[Cms] Load Page Data';\nexport const LOAD_CMS_PAGE_DATA_FAIL = '[Cms] Load Page Data Fail';\nexport const LOAD_CMS_PAGE_DATA_SUCCESS = '[Cms] Load Page Data Success';\nexport const CMS_SET_PAGE_SUCCESS_INDEX = '[Cms] Set Page Success Index';\nexport const CMS_SET_PAGE_FAIL_INDEX = '[Cms] Set Page Fail Index';\n\nexport class LoadCmsPageData extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = LOAD_CMS_PAGE_DATA;\n  constructor(public payload: PageContext) {\n    super(payload.type, payload.id);\n  }\n}\n\nexport class LoadCmsPageDataFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = LOAD_CMS_PAGE_DATA_FAIL;\n  constructor(pageContext: PageContext, error: any) {\n    super(pageContext.type, pageContext.id, error);\n  }\n}\n\nexport class LoadCmsPageDataSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = LOAD_CMS_PAGE_DATA_SUCCESS;\n  constructor(pageContext: PageContext, payload: Page) {\n    super(pageContext.type, pageContext.id, payload);\n  }\n}\n\nexport class CmsSetPageSuccessIndex extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = CMS_SET_PAGE_SUCCESS_INDEX;\n  constructor(pageContext: PageContext, payload: Page) {\n    super(pageContext.type, pageContext.id, payload);\n  }\n}\n\nexport class CmsSetPageFailIndex extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = CMS_SET_PAGE_FAIL_INDEX;\n  constructor(pageContext: PageContext, public payload: string) {\n    super(pageContext.type, pageContext.id);\n  }\n}\n\n// action types\nexport type CmsPageAction =\n  | LoadCmsPageData\n  | LoadCmsPageDataFail\n  | LoadCmsPageDataSuccess\n  | CmsSetPageFailIndex;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { CmsState, CMS_FEATURE, StateWithCms } from '../cms-state';\n\nexport const getCmsState: MemoizedSelector<\n  StateWithCms,\n  CmsState\n> = createFeatureSelector<CmsState>(CMS_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { CmsComponent } from '../../../model/cms.model';\nimport {\n  initialLoaderState,\n  LoaderState,\n  StateEntitySelectors,\n  StateLoaderSelectors,\n} from '../../../state/utils/index';\nimport { ComponentsContext, ComponentsState, StateWithCms } from '../cms-state';\nimport { getCmsState } from './feature.selectors';\n\nexport const getComponentsState: MemoizedSelector<\n  StateWithCms,\n  ComponentsState\n> = createSelector(getCmsState, state => state.components);\n\nexport const componentsContextSelectorFactory = (\n  uid: string\n): MemoizedSelector<StateWithCms, ComponentsContext> => {\n  return createSelector(getComponentsState, componentsState =>\n    StateEntitySelectors.entitySelector(componentsState, uid)\n  );\n};\n\nexport const componentsLoaderStateSelectorFactory = (\n  uid: string,\n  context: string\n): MemoizedSelector<StateWithCms, LoaderState<boolean>> => {\n  return createSelector(\n    componentsContextSelectorFactory(uid),\n    componentsContext =>\n      (componentsContext &&\n        componentsContext.pageContext &&\n        componentsContext.pageContext[context]) ||\n      initialLoaderState\n  );\n};\n\nexport const componentsContextExistsSelectorFactory = (\n  uid: string,\n  context: string\n): MemoizedSelector<StateWithCms, boolean> => {\n  return createSelector(\n    componentsLoaderStateSelectorFactory(uid, context),\n    loaderState =>\n      StateLoaderSelectors.loaderValueSelector(loaderState) || false\n  );\n};\n\nexport const componentsDataSelectorFactory = (\n  uid: string\n): MemoizedSelector<StateWithCms, CmsComponent> => {\n  return createSelector(componentsContextSelectorFactory(uid), state =>\n    state ? state.component : undefined\n  );\n};\n\nexport const componentsSelectorFactory = (\n  uid: string,\n  context: string\n): MemoizedSelector<StateWithCms, CmsComponent> => {\n  return createSelector(\n    componentsDataSelectorFactory(uid),\n    componentsContextExistsSelectorFactory(uid, context),\n    (componentState, exists) => {\n      if (componentState && exists) {\n        return componentState;\n      } else {\n        return undefined;\n      }\n    }\n  );\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\nimport {\n  StateEntityLoaderSelectors,\n  StateLoaderSelectors,\n} from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { NodeItem } from '../../model/node-item.model';\nimport { CmsState, StateWithCms } from '../cms-state';\nimport { getCmsState } from './feature.selectors';\n\nexport const getNavigationEntryItemState: MemoizedSelector<\n  StateWithCms,\n  EntityLoaderState<NodeItem>\n> = createSelector(getCmsState, (state: CmsState) => state.navigation);\n\nexport const getSelectedNavigationEntryItemState = (\n  nodeId: string\n): MemoizedSelector<StateWithCms, LoaderState<NodeItem>> => {\n  return createSelector(getNavigationEntryItemState, nodes =>\n    StateEntityLoaderSelectors.entityStateSelector(nodes, nodeId)\n  );\n};\n\nexport const getNavigationEntryItems = (\n  nodeId: string\n): MemoizedSelector<StateWithCms, NodeItem> => {\n  return createSelector(\n    getSelectedNavigationEntryItemState(nodeId),\n    itemState => StateLoaderSelectors.loaderValueSelector(itemState)\n  );\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { PageType } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\nimport {\n  StateEntityLoaderSelectors,\n  StateLoaderSelectors,\n} from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { ContentSlotData } from '../../model/content-slot-data.model';\nimport { Page } from '../../model/page.model';\nimport { CmsState, IndexType, PageState, StateWithCms } from '../cms-state';\nimport { getCmsState } from './feature.selectors';\n\nconst getPageEntitiesSelector = (state: PageState) => state.pageData.entities;\nconst getIndexByType = (\n  index: IndexType,\n  type: PageType\n): EntityLoaderState<string> => {\n  switch (type) {\n    case PageType.CONTENT_PAGE: {\n      return index.content;\n    }\n    case PageType.PRODUCT_PAGE: {\n      return index.product;\n    }\n    case PageType.CATEGORY_PAGE: {\n      return index.category;\n    }\n    case PageType.CATALOG_PAGE: {\n      return index.catalog;\n    }\n  }\n  return { entities: {} };\n};\n\nconst getPageComponentTypesSelector: (page: Page) => string[] = (\n  page: Page\n) => {\n  const componentTypes = new Set<string>();\n  if (page && page.slots) {\n    for (const slot of Object.keys(page.slots)) {\n      for (const component of page.slots[slot].components || []) {\n        componentTypes.add(component.flexType);\n      }\n    }\n  }\n  return Array.from(componentTypes);\n};\n\nexport const getPageState: MemoizedSelector<\n  StateWithCms,\n  PageState\n> = createSelector(getCmsState, (state: CmsState) => state.page);\n\nexport const getPageStateIndex: MemoizedSelector<\n  StateWithCms,\n  IndexType\n> = createSelector(getPageState, (page: PageState) => page.index);\n\nexport const getPageStateIndexEntityLoaderState = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, EntityLoaderState<string>> =>\n  createSelector(getPageStateIndex, (index: IndexType) =>\n    getIndexByType(index, pageContext.type)\n  );\n\nexport const getPageStateIndexLoaderState = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, LoaderState<string>> =>\n  createSelector(getPageStateIndexEntityLoaderState(pageContext), indexState =>\n    StateEntityLoaderSelectors.entityStateSelector(indexState, pageContext.id)\n  );\n\nexport const getPageStateIndexValue = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, string> =>\n  createSelector(getPageStateIndexLoaderState(pageContext), entity =>\n    StateLoaderSelectors.loaderValueSelector<string>(entity)\n  );\n\nexport const getPageEntities: MemoizedSelector<\n  StateWithCms,\n  { [id: string]: Page }\n> = createSelector(getPageState, getPageEntitiesSelector);\n\nexport const getPageData = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, Page> =>\n  createSelector(\n    getPageEntities,\n    getPageStateIndexValue(pageContext),\n    (entities: { [id: string]: Page }, indexValue: string) =>\n      entities[indexValue]\n  );\n\nexport const getPageComponentTypes = (\n  pageContext: PageContext\n): MemoizedSelector<StateWithCms, string[]> =>\n  createSelector(getPageData(pageContext), pageData =>\n    getPageComponentTypesSelector(pageData)\n  );\n\nexport const getCurrentSlotSelectorFactory = (\n  pageContext: PageContext,\n  position: string\n): MemoizedSelector<StateWithCms, ContentSlotData> => {\n  return createSelector(getPageData(pageContext), entity => {\n    if (entity) {\n      return entity.slots[position] || { components: [] };\n    }\n  });\n};\n","import { PageType } from '../../model/cms.model';\nimport { PageContext } from '../../routing/models/page-context.model';\n\nexport const CURRENT_CONTEXT_KEY = 'current';\n\n/**\n *\n * Serializes the provided page context.\n * The pattern used for serialization is: `pageContext.type-pageContext.id`.\n *\n * @param pageContext to serialize\n * @param ignoreContentPageId if set to true, and the PageType is of type ContentPage, then the serialized page context will not contain the ID.\n * Otherwise, the page context if fully serialized.\n */\nexport function serializePageContext(\n  pageContext: PageContext,\n  ignoreContentPageId?: boolean\n): string {\n  if (!pageContext) {\n    return CURRENT_CONTEXT_KEY;\n  }\n\n  if (ignoreContentPageId && pageContext.type === PageType.CONTENT_PAGE) {\n    return `${pageContext.type}`;\n  }\n\n  return `${pageContext.type}-${pageContext.id}`;\n}\n","import { CmsComponent } from '../../model/cms.model';\nimport { ContentSlotData } from './content-slot-data.model';\n\nexport interface Page {\n  pageId?: string;\n  name?: string;\n  type?: string;\n  title?: string;\n  template?: string;\n  loadTime?: number;\n  slots: { [key: string]: ContentSlotData };\n  properties?: any;\n  label?: string;\n}\n\n/**\n * Represents the cms structure for pages, slots and components.\n */\nexport interface CmsStructureModel {\n  page?: Page;\n  components?: CmsComponent[];\n}\n\n/**\n * Represents the page meta data that can be used\n * to resolve page data and seo related data.\n */\nexport interface PageMeta {\n  /**\n   * the page title is used for the page title tag which\n   * is visible in the browser navigation as well as in the\n   * Search Engine Result Page\n   */\n  title?: string;\n\n  /**\n   * the page heading is typically used in the UI\n   */\n  heading?: string;\n\n  /**\n   * the page description is used in the Search Engine Result Page\n   */\n  description?: string;\n\n  /**\n   * the robots information drives search engines to index the page and\n   * follow links in the page\n   */\n  robots?: PageRobotsMeta[];\n\n  /**\n   * image that can be added to the og:image metatag\n   */\n  image?: string;\n\n  /**\n   * the list of breadcrumbs that can be rendered in the page UI.\n   */\n  breadcrumbs?: BreadcrumbMeta[];\n}\n\nexport interface BreadcrumbMeta {\n  label: string;\n  link: string;\n}\n\nexport enum PageRobotsMeta {\n  INDEX = 'INDEX',\n  NOINDEX = 'NOINDEX',\n  FOLLOW = 'FOLLOW',\n  NOFOLLOW = 'NOFOLLOW',\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { combineLatest, Observable, of, queueScheduler, using } from 'rxjs';\nimport {\n  catchError,\n  filter,\n  observeOn,\n  pluck,\n  shareReplay,\n  switchMap,\n  take,\n  tap,\n} from 'rxjs/operators';\nimport { CmsComponent } from '../../model/cms.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { PageContext } from '../../routing/models/page-context.model';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { ContentSlotData } from '../model/content-slot-data.model';\nimport { NodeItem } from '../model/node-item.model';\nimport { Page } from '../model/page.model';\nimport { CmsActions } from '../store/actions/index';\nimport { StateWithCms } from '../store/cms-state';\nimport { CmsSelectors } from '../store/selectors/index';\nimport { serializePageContext } from '../utils/cms-utils';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CmsService {\n  private _launchInSmartEdit = false;\n\n  private components: {\n    [uid: string]: {\n      [pageContext: string]: Observable<CmsComponent>;\n    };\n  } = {};\n\n  constructor(\n    protected store: Store<StateWithCms>,\n    protected routingService: RoutingService\n  ) {}\n\n  /**\n   * Set _launchInSmartEdit value\n   */\n  set launchInSmartEdit(value: boolean) {\n    this._launchInSmartEdit = value;\n  }\n\n  /**\n   * Whether the app launched in smart edit\n   */\n  isLaunchInSmartEdit(): boolean {\n    return this._launchInSmartEdit;\n  }\n\n  /**\n   * Get current CMS page data\n   */\n  getCurrentPage(): Observable<Page> {\n    return this.routingService\n      .getPageContext()\n      .pipe(\n        switchMap(pageContext =>\n          this.store.select(CmsSelectors.getPageData(pageContext))\n        )\n      );\n  }\n\n  /**\n   * Get CMS component data by uid\n   *\n   * This method can be safely and optimally used to load multiple components data at the same time.\n   * Calling getComponentData multiple times for different components will always result in optimized\n   * back-end request: all components requested at the same time (in one event loop) will be loaded in one network call.\n   *\n   * In case the component data is not present, the method will load it.\n   * Otherwise, if the page context is not provided, the current page context from the router state will be used instead.\n   *\n   * @param uid CMS component uid\n   * @param pageContext if provided, it will be used to lookup the component data.\n   */\n  getComponentData<T extends CmsComponent>(\n    uid: string,\n    pageContext?: PageContext\n  ): Observable<T> {\n    const context = serializePageContext(pageContext, true);\n    if (!this.components[uid]) {\n      // create the component data structure, if it doesn't already exist\n      this.components[uid] = {};\n    }\n\n    const component = this.components[uid];\n    if (!component[context]) {\n      // create the component data and assign it to the component's context\n      component[context] = this.createComponentData(uid, pageContext);\n    }\n\n    return component[context] as Observable<T>;\n  }\n\n  private createComponentData<T extends CmsComponent>(\n    uid: string,\n    pageContext?: PageContext\n  ): Observable<T> {\n    if (!pageContext) {\n      return this.routingService.getPageContext().pipe(\n        filter(currentContext => !!currentContext),\n        switchMap(currentContext =>\n          this.getComponentData<T>(uid, currentContext)\n        )\n      );\n    }\n\n    const context = serializePageContext(pageContext, true);\n\n    const loading$ = combineLatest([\n      this.routingService.getNextPageContext(),\n      this.store.pipe(\n        select(CmsSelectors.componentsLoaderStateSelectorFactory(uid, context))\n      ),\n    ]).pipe(\n      observeOn(queueScheduler),\n      tap(([nextContext, loadingState]) => {\n        const attemptedLoad =\n          loadingState.loading || loadingState.success || loadingState.error;\n        // if the requested context is the same as the one that's currently being navigated to\n        // (as it might already been triggered and might be available shortly from page data)\n        // TODO(issue:3649), TODO(issue:3668) - this optimization could be removed\n        const couldBeLoadedWithPageData = nextContext\n          ? serializePageContext(nextContext, true) === context\n          : false;\n\n        if (!attemptedLoad && !couldBeLoadedWithPageData) {\n          this.store.dispatch(\n            new CmsActions.LoadCmsComponent({ uid, pageContext })\n          );\n        }\n      })\n    );\n\n    const component$ = this.store.pipe(\n      select(CmsSelectors.componentsSelectorFactory(uid, context)),\n      // TODO(issue:6431) - this `filter` should be removed.\n      // The reason for removal: with `filter` in place, when moving to a page that has restrictions, the component data will still emit the previous value.\n      // Removing it causes some components to fail, because they are not checking\n      // if the data is actually there. I noticed these that this component is failing, but there are possibly more:\n      // - `tab-paragraph-container.component.ts` when visiting any PDP page\n      filter(component => !!component)\n    ) as Observable<T>;\n\n    return using(\n      () => loading$.subscribe(),\n      () => component$\n    ).pipe(shareReplay({ bufferSize: 1, refCount: true }));\n  }\n\n  /**\n   * Given the position, get the content slot data\n   * @param position : content slot position\n   */\n  getContentSlot(position: string): Observable<ContentSlotData> {\n    return this.routingService\n      .getPageContext()\n      .pipe(\n        switchMap(pageContext =>\n          this.store.pipe(\n            select(\n              CmsSelectors.getCurrentSlotSelectorFactory(pageContext, position)\n            ),\n            filter(Boolean)\n          )\n        )\n      );\n  }\n\n  /**\n   * Given navigation node uid, get items (with id and type) inside the navigation entries\n   * @param navigationNodeUid : uid of the navigation node\n   */\n  getNavigationEntryItems(navigationNodeUid: string): Observable<NodeItem> {\n    return this.store.pipe(\n      select(CmsSelectors.getNavigationEntryItems(navigationNodeUid))\n    );\n  }\n\n  /**\n   * Load navigation items data\n   * @param rootUid : the uid of the root navigation node\n   * @param itemList : list of items (with id and type)\n   */\n  loadNavigationItems(\n    rootUid: string,\n    itemList: { id: string; superType: string }[]\n  ): void {\n    this.store.dispatch(\n      new CmsActions.LoadCmsNavigationItems({\n        nodeId: rootUid,\n        items: itemList,\n      })\n    );\n  }\n\n  /**\n   * Refresh the content of the latest cms page\n   */\n  refreshLatestPage(): void {\n    this.routingService\n      .getPageContext()\n      .pipe(take(1))\n      .subscribe(pageContext =>\n        this.store.dispatch(new CmsActions.LoadCmsPageData(pageContext))\n      );\n  }\n\n  /**\n   * Refresh the cms page content by page Id\n   * @param pageId\n   */\n  refreshPageById(pageId: string): void {\n    const pageContext: PageContext = { id: pageId };\n    this.store.dispatch(new CmsActions.LoadCmsPageData(pageContext));\n  }\n\n  /**\n   * Refresh cms component's content\n   * @param uid component uid\n   * @param pageContext an optional parameter that enables the caller to specify for which context the component should be refreshed.\n   * If not specified, 'current' page context is used.\n   */\n  refreshComponent(uid: string, pageContext?: PageContext): void {\n    this.store.dispatch(new CmsActions.LoadCmsComponent({ uid, pageContext }));\n  }\n\n  /**\n   * Given pageContext, return the CMS page data\n   * @param pageContext\n   */\n  getPageState(pageContext: PageContext): Observable<Page> {\n    return this.store.pipe(select(CmsSelectors.getPageData(pageContext)));\n  }\n\n  /**\n   * Given pageContext, return the CMS page data\n   * @param pageContext\n   */\n  getPageComponentTypes(pageContext: PageContext): Observable<string[]> {\n    return this.store.pipe(\n      select(CmsSelectors.getPageComponentTypes(pageContext))\n    );\n  }\n\n  /**\n   * Given pageContext, return whether the CMS page data exists or not\n   * @param pageContext\n   */\n  hasPage(pageContext: PageContext, forceReload = false): Observable<boolean> {\n    return this.store.pipe(\n      select(CmsSelectors.getPageStateIndexLoaderState(pageContext)),\n      tap((entity: LoaderState<string>) => {\n        const attemptedLoad = entity.loading || entity.success || entity.error;\n        const shouldReload = forceReload && !entity.loading;\n        if (!attemptedLoad || shouldReload) {\n          this.store.dispatch(new CmsActions.LoadCmsPageData(pageContext));\n          forceReload = false;\n        }\n      }),\n      filter(entity => {\n        if (!entity.hasOwnProperty('value')) {\n          // if we have incomplete state from SSR failed load transfer state,\n          // we should wait for reload and actual value\n          return false;\n        }\n        return entity.success || (entity.error && !entity.loading);\n      }),\n      pluck('success'),\n      catchError(() => of(false))\n    );\n  }\n\n  /**\n   * Given pageContext, return the CMS page data\n   **/\n  getPage(pageContext: PageContext, forceReload = false): Observable<Page> {\n    return this.hasPage(pageContext, forceReload).pipe(\n      switchMap(hasPage =>\n        hasPage ? this.getPageState(pageContext) : of(null)\n      )\n    );\n  }\n\n  getPageIndex(pageContext: PageContext): Observable<string> {\n    return this.store.pipe(\n      select(CmsSelectors.getPageStateIndexValue(pageContext))\n    );\n  }\n\n  setPageFailIndex(pageContext: PageContext, value: string): void {\n    this.store.dispatch(new CmsActions.CmsSetPageFailIndex(pageContext, value));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { Page, PageMeta, PageRobotsMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageRobotsResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { PageType } from '../../model/cms.model';\n\n/**\n * Resolves the page data for all Content Pages based on the `PageType.CONTENT_PAGE`\n * and the `CartPageTemplate`. If the cart page matches this template, the more generic\n * `ContentPageMetaResolver` is overriden by this resolver.\n *\n * The page title and robots are resolved in this implementation only.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartPageMetaResolver extends PageMetaResolver\n  implements PageTitleResolver, PageRobotsResolver {\n  cms$: Observable<Page> = this.cms\n    .getCurrentPage()\n    .pipe(filter(page => !!page));\n\n  constructor(protected cms: CmsService) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'CartPageTemplate';\n  }\n\n  /**\n   * @deprecated since version 1.3\n   *\n   * The resolve method is no longer preferred and will be removed with release 2.0.\n   * The caller `PageMetaService` service is improved to expect all individual resolvers\n   * instead, so that the code is easier extensible.\n   */\n  resolve(): Observable<PageMeta> | any {\n    return this.cms$.pipe(\n      switchMap(page =>\n        combineLatest([this.resolveTitle(page), this.resolveRobots()])\n      ),\n      map(([title, robots]: [string, any[]]) => ({ title, robots }))\n    );\n  }\n\n  resolveTitle(): Observable<string>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveTitle()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveTitle(page: Page): Observable<string>;\n  resolveTitle(page?: Page): Observable<string> {\n    return page ? of(page.title) : this.cms$.pipe(map(p => p.title));\n  }\n\n  resolveRobots(): Observable<PageRobotsMeta[]> {\n    return of([PageRobotsMeta.NOFOLLOW, PageRobotsMeta.NOINDEX]);\n  }\n}\n","import { Observable, OperatorFunction } from 'rxjs';\nimport { startWith, switchMapTo } from 'rxjs/operators';\n\n/**\n *\n * Withdraw from the source observable when notifier emits a value\n *\n * Withdraw will result in resubscribing to the source observable\n * Operator is useful to kill ongoing emission transformation on notifier emission\n *\n * @param notifier\n */\nexport function withdrawOn<T>(\n  notifier: Observable<any>\n): OperatorFunction<T, T> {\n  return (source: Observable<T>) =>\n    notifier.pipe(startWith(undefined), switchMapTo(source));\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { CartEntryAdapter } from './cart-entry.adapter';\nimport { CartModification } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartEntryConnector {\n  constructor(protected adapter: CartEntryAdapter) {}\n\n  public add(\n    userId: string,\n    cartId: string,\n    productCode: string,\n    quantity?: number\n  ): Observable<CartModification> {\n    return this.adapter.add(userId, cartId, productCode, quantity);\n  }\n\n  public update(\n    userId: string,\n    cartId: string,\n    entryNumber: string,\n    qty: number,\n    pickupStore?: string\n  ): Observable<CartModification> {\n    return this.adapter.update(userId, cartId, entryNumber, qty, pickupStore);\n  }\n\n  public remove(\n    userId: string,\n    cartId: string,\n    entryNumber: string\n  ): Observable<any> {\n    return this.adapter.remove(userId, cartId, entryNumber);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { from, Observable } from 'rxjs';\nimport { catchError, concatMap, map } from 'rxjs/operators';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { withdrawOn } from '../../../util/withdraw-on';\nimport { CartEntryConnector } from '../../connectors/entry/cart-entry.connector';\nimport * as DeprecatedCartActions from '../actions/cart.action';\nimport { CartActions } from '../actions/index';\n\n@Injectable()\nexport class CartEntryEffects {\n  private contextChange$ = this.actions$.pipe(\n    ofType(\n      SiteContextActions.CURRENCY_CHANGE,\n      SiteContextActions.LANGUAGE_CHANGE\n    )\n  );\n\n  @Effect()\n  addEntry$: Observable<\n    | CartActions.CartAddEntrySuccess\n    | CartActions.CartAddEntryFail\n    | DeprecatedCartActions.LoadCart\n    | CartActions.CartProcessesDecrement\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_ADD_ENTRY),\n    map((action: CartActions.CartAddEntry) => action.payload),\n    concatMap(payload => {\n      return this.cartEntryConnector\n        .add(\n          payload.userId,\n          payload.cartId,\n          payload.productCode,\n          payload.quantity\n        )\n        .pipe(\n          map(\n            (entry: any) =>\n              new CartActions.CartAddEntrySuccess({\n                ...entry,\n                userId: payload.userId,\n                cartId: payload.cartId,\n              })\n          ),\n          catchError(error =>\n            from([\n              new CartActions.CartAddEntryFail(makeErrorSerializable(error)),\n              new CartActions.CartProcessesDecrement(payload.cartId),\n              new DeprecatedCartActions.LoadCart({\n                cartId: payload.cartId,\n                userId: payload.userId,\n              }),\n            ])\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  removeEntry$: Observable<\n    | CartActions.CartRemoveEntrySuccess\n    | CartActions.CartRemoveEntryFail\n    | CartActions.CartProcessesDecrement\n    | DeprecatedCartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_REMOVE_ENTRY),\n    map((action: CartActions.CartRemoveEntry) => action.payload),\n    concatMap(payload =>\n      this.cartEntryConnector\n        .remove(payload.userId, payload.cartId, payload.entry)\n        .pipe(\n          map(() => {\n            return new CartActions.CartRemoveEntrySuccess({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            });\n          }),\n          catchError(error =>\n            from([\n              new CartActions.CartRemoveEntryFail(makeErrorSerializable(error)),\n              new CartActions.CartProcessesDecrement(payload.cartId),\n              new DeprecatedCartActions.LoadCart({\n                cartId: payload.cartId,\n                userId: payload.userId,\n              }),\n            ])\n          )\n        )\n    ),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  updateEntry$: Observable<\n    | CartActions.CartUpdateEntrySuccess\n    | CartActions.CartUpdateEntryFail\n    | CartActions.CartProcessesDecrement\n    | DeprecatedCartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_UPDATE_ENTRY),\n    map((action: CartActions.CartUpdateEntry) => action.payload),\n    concatMap(payload =>\n      this.cartEntryConnector\n        .update(payload.userId, payload.cartId, payload.entry, payload.qty)\n        .pipe(\n          map(() => {\n            return new CartActions.CartUpdateEntrySuccess({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            });\n          }),\n          catchError(error =>\n            from([\n              new CartActions.CartUpdateEntryFail(makeErrorSerializable(error)),\n              new CartActions.CartProcessesDecrement(payload.cartId),\n              new DeprecatedCartActions.LoadCart({\n                cartId: payload.cartId,\n                userId: payload.userId,\n              }),\n            ])\n          )\n        )\n    ),\n    withdrawOn(this.contextChange$)\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cartEntryConnector: CartEntryConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CartVoucherAdapter } from './cart-voucher.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartVoucherConnector {\n  constructor(protected adapter: CartVoucherAdapter) {}\n\n  public add(\n    userId: string,\n    cartId: string,\n    voucherId: string\n  ): Observable<{}> {\n    return this.adapter.add(userId, cartId, voucherId);\n  }\n\n  public remove(\n    userId: string,\n    cartId: string,\n    voucherId: string\n  ): Observable<{}> {\n    return this.adapter.remove(userId, cartId, voucherId);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { from, Observable } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { GlobalMessageService } from '../../../global-message/facade/global-message.service';\nimport { GlobalMessageType } from '../../../global-message/models/global-message.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CartVoucherConnector } from '../../connectors/voucher/cart-voucher.connector';\nimport { CartActions } from '../actions/index';\n\n@Injectable()\nexport class CartVoucherEffects {\n  constructor(\n    private actions$: Actions,\n    private cartVoucherConnector: CartVoucherConnector,\n    private messageService: GlobalMessageService\n  ) {}\n\n  @Effect()\n  addCartVoucher$: Observable<\n    | CartActions.CartVoucherAction\n    | CartActions.LoadCart\n    | CartActions.CartProcessesDecrement\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_ADD_VOUCHER),\n    map((action: CartActions.CartAddVoucher) => action.payload),\n    mergeMap(payload => {\n      return this.cartVoucherConnector\n        .add(payload.userId, payload.cartId, payload.voucherId)\n        .pipe(\n          map(() => {\n            this.showGlobalMessage(\n              'voucher.applyVoucherSuccess',\n              payload.voucherId,\n              GlobalMessageType.MSG_TYPE_CONFIRMATION\n            );\n            return new CartActions.CartAddVoucherSuccess({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            });\n          }),\n          catchError(error =>\n            from([\n              new CartActions.CartAddVoucherFail(makeErrorSerializable(error)),\n              new CartActions.CartProcessesDecrement(payload.cartId),\n              new CartActions.LoadCart({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ])\n          )\n        );\n    })\n  );\n\n  @Effect()\n  removeCartVoucher$: Observable<\n    | CartActions.CartVoucherAction\n    | CartActions.CartProcessesDecrement\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CartActions.CART_REMOVE_VOUCHER),\n    map((action: CartActions.CartRemoveVoucher) => action.payload),\n    mergeMap(payload => {\n      return this.cartVoucherConnector\n        .remove(payload.userId, payload.cartId, payload.voucherId)\n        .pipe(\n          map(() => {\n            this.showGlobalMessage(\n              'voucher.removeVoucherSuccess',\n              payload.voucherId,\n              GlobalMessageType.MSG_TYPE_INFO\n            );\n            return new CartActions.CartRemoveVoucherSuccess({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            });\n          }),\n          catchError(error =>\n            from([\n              new CartActions.CartRemoveVoucherFail(\n                makeErrorSerializable(error)\n              ),\n              new CartActions.CartProcessesDecrement(payload.cartId),\n              new CartActions.LoadCart({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ])\n          )\n        );\n    })\n  );\n\n  private showGlobalMessage(\n    text: string,\n    param: string,\n    messageType: GlobalMessageType\n  ) {\n    this.messageService.add(\n      { key: text, params: { voucherCode: param } },\n      messageType\n    );\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\nexport const VERIFY_ADDRESS = '[Checkout] Verify Address';\nexport const VERIFY_ADDRESS_FAIL = '[Checkout] Verify Address Fail';\nexport const VERIFY_ADDRESS_SUCCESS = '[Checkout] Verify Address Success';\n\nexport const CLEAR_ADDRESS_VERIFICATION_RESULTS =\n  '[Checkout] Clear Address Verification Results';\n\nexport class VerifyAddress implements Action {\n  readonly type = VERIFY_ADDRESS;\n  constructor(public payload: { userId: string; address: Address }) {}\n}\n\nexport class VerifyAddressFail implements Action {\n  readonly type = VERIFY_ADDRESS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class VerifyAddressSuccess implements Action {\n  readonly type = VERIFY_ADDRESS_SUCCESS;\n  constructor(public payload: AddressValidation) {}\n}\n\nexport class ClearAddressVerificationResults implements Action {\n  readonly type = CLEAR_ADDRESS_VERIFICATION_RESULTS;\n  constructor() {}\n}\n\nexport type AddressVerificationActions =\n  | VerifyAddress\n  | VerifyAddressFail\n  | VerifyAddressSuccess\n  | ClearAddressVerificationResults;\n","import { Action } from '@ngrx/store';\nimport { CardType } from '../../../model/cart.model';\n\nexport const LOAD_CARD_TYPES = '[Checkout] Load Card Types';\nexport const LOAD_CARD_TYPES_FAIL = '[Checkout] Load Card Fail';\nexport const LOAD_CARD_TYPES_SUCCESS = '[Checkout] Load Card Success';\n\nexport class LoadCardTypes implements Action {\n  readonly type = LOAD_CARD_TYPES;\n  constructor() {}\n}\n\nexport class LoadCardTypesFail implements Action {\n  readonly type = LOAD_CARD_TYPES_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class LoadCardTypesSuccess implements Action {\n  readonly type = LOAD_CARD_TYPES_SUCCESS;\n  constructor(public payload: CardType[]) {}\n}\n\nexport type CardTypesAction =\n  | LoadCardTypes\n  | LoadCardTypesFail\n  | LoadCardTypesSuccess;\n","import { LoaderState } from '../../state/utils/loader/loader-state';\nimport { CardType, PaymentDetails } from '../../model/cart.model';\nimport { Address, AddressValidation } from '../../model/address.model';\nimport { DeliveryMode, Order } from '../../model/order.model';\n\nexport const CHECKOUT_FEATURE = 'checkout';\nexport const CHECKOUT_DETAILS = '[Checkout] Checkout Details';\n\nexport const SET_DELIVERY_ADDRESS_PROCESS_ID = 'setDeliveryAddress';\nexport const SET_DELIVERY_MODE_PROCESS_ID = 'setDeliveryMode';\nexport const SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID =\n  'setSupportedDeliveryMode';\nexport const SET_PAYMENT_DETAILS_PROCESS_ID = 'setPaymentDetails';\n\nexport interface StateWithCheckout {\n  [CHECKOUT_FEATURE]: CheckoutState;\n}\n\nexport interface AddressVerificationState {\n  results: AddressValidation | string;\n}\n\nexport interface CardTypesState {\n  entities: { [code: string]: CardType };\n}\n\nexport interface CheckoutStepsState {\n  address: Address;\n  deliveryMode: {\n    supported: { [code: string]: DeliveryMode };\n    selected: string;\n  };\n  paymentDetails: PaymentDetails;\n  orderDetails: Order;\n}\n\nexport interface CheckoutState {\n  steps: LoaderState<CheckoutStepsState>;\n  cardTypes: CardTypesState;\n  addressVerification: AddressVerificationState;\n}\n","import { Action } from '@ngrx/store';\nimport { Address } from '../../../model/address.model';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { DeliveryMode, Order } from '../../../model/order.model';\nimport { PROCESS_FEATURE } from '../../../process/store/process-state';\nimport {\n  StateEntityLoaderActions,\n  StateLoaderActions,\n} from '../../../state/utils/index';\nimport { CheckoutDetails } from '../../models/checkout.model';\nimport {\n  CHECKOUT_DETAILS,\n  SET_DELIVERY_ADDRESS_PROCESS_ID,\n  SET_DELIVERY_MODE_PROCESS_ID,\n  SET_PAYMENT_DETAILS_PROCESS_ID,\n  SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID,\n} from '../checkout-state';\n\nexport const CLEAR_CHECKOUT_DELIVERY_ADDRESS =\n  '[Checkout] Clear Checkout Delivery Address';\nexport const CLEAR_CHECKOUT_DELIVERY_ADDRESS_SUCCESS =\n  '[Checkout] Clear Checkout Delivery Address Success';\nexport const CLEAR_CHECKOUT_DELIVERY_ADDRESS_FAIL =\n  '[Checkout] Clear Checkout Delivery Address Fail';\n\nexport const CLEAR_CHECKOUT_DELIVERY_MODE =\n  '[Checkout] Clear Checkout Delivery Mode';\nexport const CLEAR_CHECKOUT_DELIVERY_MODE_SUCCESS =\n  '[Checkout] Clear Checkout Delivery Mode Success';\nexport const CLEAR_CHECKOUT_DELIVERY_MODE_FAIL =\n  '[Checkout] Clear Checkout Delivery Mode Fail';\n\nexport const ADD_DELIVERY_ADDRESS = '[Checkout] Add Delivery Address';\nexport const ADD_DELIVERY_ADDRESS_FAIL = '[Checkout] Add Delivery Address Fail';\nexport const ADD_DELIVERY_ADDRESS_SUCCESS =\n  '[Checkout] Add Delivery Address Success';\n\nexport const SET_DELIVERY_ADDRESS = '[Checkout] Set Delivery Address';\nexport const SET_DELIVERY_ADDRESS_FAIL = '[Checkout] Set Delivery Address Fail';\nexport const SET_DELIVERY_ADDRESS_SUCCESS =\n  '[Checkout] Set Delivery Address Success';\nexport const RESET_SET_DELIVERY_ADDRESS_PROCESS =\n  '[Checkout] Reset Set Delivery Address Process';\n\nexport const LOAD_SUPPORTED_DELIVERY_MODES =\n  '[Checkout] Load Supported Delivery Modes';\nexport const LOAD_SUPPORTED_DELIVERY_MODES_FAIL =\n  '[Checkout] Load Supported Delivery Modes Fail';\nexport const LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS =\n  '[Checkout] Load Supported Delivery Modes Success';\nexport const CLEAR_SUPPORTED_DELIVERY_MODES =\n  '[Checkout] Clear Supported Delivery Modes';\n\nexport const SET_DELIVERY_MODE = '[Checkout] Set Delivery Mode';\nexport const SET_DELIVERY_MODE_FAIL = '[Checkout] Set Delivery Mode Fail';\nexport const SET_DELIVERY_MODE_SUCCESS = '[Checkout] Set Delivery Mode Success';\nexport const RESET_SET_DELIVERY_MODE_PROCESS =\n  '[Checkout] Reset Set Delivery Mode Process';\n\nexport const SET_SUPPORTED_DELIVERY_MODES =\n  '[Checkout] Set Supported Delivery Modes';\nexport const SET_SUPPORTED_DELIVERY_MODES_FAIL =\n  '[Checkout] Set Supported Delivery Modes Fail';\nexport const SET_SUPPORTED_DELIVERY_MODES_SUCCESS =\n  '[Checkout] Set Supported Delivery Modes Success';\nexport const RESET_SUPPORTED_SET_DELIVERY_MODES_PROCESS =\n  '[Checkout] Reset Set Supported Delivery Modes Process';\n\nexport const CREATE_PAYMENT_DETAILS = '[Checkout] Create Payment Details';\nexport const CREATE_PAYMENT_DETAILS_FAIL =\n  '[Checkout] Create Payment Details Fail';\nexport const CREATE_PAYMENT_DETAILS_SUCCESS =\n  '[Checkout] Create Payment Details Success';\n\nexport const SET_PAYMENT_DETAILS = '[Checkout] Set Payment Details';\nexport const SET_PAYMENT_DETAILS_FAIL = '[Checkout] Set Payment Details Fail';\nexport const SET_PAYMENT_DETAILS_SUCCESS =\n  '[Checkout] Set Payment Details Success';\nexport const RESET_SET_PAYMENT_DETAILS_PROCESS =\n  '[Checkout] Reset Set Payment Details Process';\n\nexport const PLACE_ORDER = '[Checkout] Place Order';\nexport const PLACE_ORDER_FAIL = '[Checkout] Place Order Fail';\nexport const PLACE_ORDER_SUCCESS = '[Checkout] Place Order Success';\n\nexport const CLEAR_CHECKOUT_STEP = '[Checkout] Clear One Checkout Step';\nexport const CLEAR_CHECKOUT_DATA = '[Checkout] Clear Checkout Data';\n\nexport const LOAD_CHECKOUT_DETAILS = '[Checkout] Load Checkout Details';\nexport const LOAD_CHECKOUT_DETAILS_FAIL =\n  '[Checkout] Load Checkout Details Fail';\nexport const LOAD_CHECKOUT_DETAILS_SUCCESS =\n  '[Checkout] Load Checkout Details Success';\n\nexport const CHECKOUT_CLEAR_MISCS_DATA = '[Checkout] Clear Miscs Data';\nexport const PAYMENT_PROCESS_SUCCESS = '[Checkout] Payment Process Success';\n\nexport class AddDeliveryAddress implements Action {\n  readonly type = ADD_DELIVERY_ADDRESS;\n  constructor(\n    public payload: { userId: string; cartId: string; address: Address }\n  ) {}\n}\n\nexport class AddDeliveryAddressFail implements Action {\n  readonly type = ADD_DELIVERY_ADDRESS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class AddDeliveryAddressSuccess implements Action {\n  readonly type = ADD_DELIVERY_ADDRESS_SUCCESS;\n  constructor(public payload: Address) {}\n}\n\nexport class SetDeliveryAddress extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = SET_DELIVERY_ADDRESS;\n  constructor(\n    public payload: { userId: string; cartId: string; address: Address }\n  ) {\n    super(PROCESS_FEATURE, SET_DELIVERY_ADDRESS_PROCESS_ID);\n  }\n}\n\nexport class SetDeliveryAddressFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = SET_DELIVERY_ADDRESS_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_DELIVERY_ADDRESS_PROCESS_ID, payload);\n  }\n}\n\nexport class SetDeliveryAddressSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = SET_DELIVERY_ADDRESS_SUCCESS;\n  constructor(public payload: Address) {\n    super(PROCESS_FEATURE, SET_DELIVERY_ADDRESS_PROCESS_ID);\n  }\n}\n\nexport class ResetSetDeliveryAddressProcess extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_SET_DELIVERY_ADDRESS_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_DELIVERY_ADDRESS_PROCESS_ID);\n  }\n}\n\nexport class LoadSupportedDeliveryModes extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = LOAD_SUPPORTED_DELIVERY_MODES;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(PROCESS_FEATURE, SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class LoadSupportedDeliveryModesFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = LOAD_SUPPORTED_DELIVERY_MODES_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class LoadSupportedDeliveryModesSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS;\n  constructor(public payload: DeliveryMode[]) {\n    super(PROCESS_FEATURE, SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class ResetLoadSupportedDeliveryModesProcess extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_SUPPORTED_SET_DELIVERY_MODES_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class SetDeliveryMode extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = SET_DELIVERY_MODE;\n  constructor(\n    public payload: { userId: string; cartId: string; selectedModeId: string }\n  ) {\n    super(PROCESS_FEATURE, SET_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class SetDeliveryModeFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = SET_DELIVERY_MODE_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_DELIVERY_MODE_PROCESS_ID, payload);\n  }\n}\n\nexport class SetDeliveryModeSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = SET_DELIVERY_MODE_SUCCESS;\n  constructor(public payload: string) {\n    super(PROCESS_FEATURE, SET_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class ResetSetDeliveryModeProcess extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_SET_DELIVERY_MODE_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_DELIVERY_MODE_PROCESS_ID);\n  }\n}\n\nexport class CreatePaymentDetails extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = CREATE_PAYMENT_DETAILS;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      paymentDetails: PaymentDetails;\n    }\n  ) {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class CreatePaymentDetailsFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = CREATE_PAYMENT_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class CreatePaymentDetailsSuccess implements Action {\n  readonly type = CREATE_PAYMENT_DETAILS_SUCCESS;\n  constructor(public payload: PaymentDetails) {}\n}\n\nexport class PaymentProcessSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = PAYMENT_PROCESS_SUCCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class SetPaymentDetails extends StateEntityLoaderActions.EntityLoadAction {\n  readonly type = SET_PAYMENT_DETAILS;\n  constructor(\n    public payload: {\n      userId: string;\n      cartId: string;\n      paymentDetails: PaymentDetails;\n    }\n  ) {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class SetPaymentDetailsFail extends StateEntityLoaderActions.EntityFailAction {\n  readonly type = SET_PAYMENT_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID, payload);\n  }\n}\n\nexport class SetPaymentDetailsSuccess extends StateEntityLoaderActions.EntitySuccessAction {\n  readonly type = SET_PAYMENT_DETAILS_SUCCESS;\n  constructor(public payload: PaymentDetails) {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class ResetSetPaymentDetailsProcess extends StateEntityLoaderActions.EntityResetAction {\n  readonly type = RESET_SET_PAYMENT_DETAILS_PROCESS;\n  constructor() {\n    super(PROCESS_FEATURE, SET_PAYMENT_DETAILS_PROCESS_ID);\n  }\n}\n\nexport class PlaceOrder implements Action {\n  readonly type = PLACE_ORDER;\n  constructor(public payload: { userId: string; cartId: string }) {}\n}\n\nexport class PlaceOrderFail implements Action {\n  readonly type = PLACE_ORDER_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class PlaceOrderSuccess implements Action {\n  readonly type = PLACE_ORDER_SUCCESS;\n  constructor(public payload: Order) {}\n}\n\nexport class ClearSupportedDeliveryModes implements Action {\n  readonly type = CLEAR_SUPPORTED_DELIVERY_MODES;\n}\n\nexport class ClearCheckoutStep implements Action {\n  readonly type = CLEAR_CHECKOUT_STEP;\n  constructor(public payload: number) {}\n}\n\nexport class ClearCheckoutData implements Action {\n  readonly type = CLEAR_CHECKOUT_DATA;\n}\n\nexport class LoadCheckoutDetails extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_CHECKOUT_DETAILS;\n  constructor(public payload: { userId: string; cartId: string }) {\n    super(CHECKOUT_DETAILS);\n  }\n}\n\nexport class LoadCheckoutDetailsFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_CHECKOUT_DETAILS_FAIL;\n  constructor(public payload: any) {\n    super(CHECKOUT_DETAILS, payload);\n  }\n}\n\nexport class LoadCheckoutDetailsSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_CHECKOUT_DETAILS_SUCCESS;\n  constructor(public payload: CheckoutDetails) {\n    super(CHECKOUT_DETAILS);\n  }\n}\n\nexport class CheckoutClearMiscsData implements Action {\n  readonly type = CHECKOUT_CLEAR_MISCS_DATA;\n}\n\nexport class ClearCheckoutDeliveryAddress implements Action {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_ADDRESS;\n  constructor(public payload: { userId: string; cartId: string }) {}\n}\n\nexport class ClearCheckoutDeliveryAddressSuccess implements Action {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_ADDRESS_SUCCESS;\n  constructor() {}\n}\n\nexport class ClearCheckoutDeliveryAddressFail implements Action {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_ADDRESS_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport class ClearCheckoutDeliveryMode implements Action {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_MODE;\n  constructor(public payload: { userId: string; cartId: string }) {}\n}\n\nexport class ClearCheckoutDeliveryModeSuccess implements Action {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_MODE_SUCCESS;\n  constructor(public payload: { userId: string; cartId: string }) {}\n}\n\nexport class ClearCheckoutDeliveryModeFail implements Action {\n  readonly type = CLEAR_CHECKOUT_DELIVERY_MODE_FAIL;\n  constructor(public payload: any) {}\n}\n\nexport type CheckoutAction =\n  | AddDeliveryAddress\n  | AddDeliveryAddressFail\n  | AddDeliveryAddressSuccess\n  | SetDeliveryAddress\n  | SetDeliveryAddressFail\n  | SetDeliveryAddressSuccess\n  | ResetSetDeliveryAddressProcess\n  | LoadSupportedDeliveryModes\n  | LoadSupportedDeliveryModesFail\n  | LoadSupportedDeliveryModesSuccess\n  | SetDeliveryMode\n  | SetDeliveryModeFail\n  | SetDeliveryModeSuccess\n  | ResetSetDeliveryModeProcess\n  | ClearSupportedDeliveryModes\n  | CreatePaymentDetails\n  | CreatePaymentDetailsFail\n  | CreatePaymentDetailsSuccess\n  | SetPaymentDetails\n  | SetPaymentDetailsFail\n  | SetPaymentDetailsSuccess\n  | ResetSetPaymentDetailsProcess\n  | PlaceOrder\n  | PlaceOrderFail\n  | PlaceOrderSuccess\n  | ClearCheckoutStep\n  | ClearCheckoutData\n  | ClearCheckoutDeliveryAddress\n  | ClearCheckoutDeliveryAddressFail\n  | ClearCheckoutDeliveryAddressSuccess\n  | ClearCheckoutDeliveryMode\n  | ClearCheckoutDeliveryModeFail\n  | ClearCheckoutDeliveryModeSuccess\n  | LoadCheckoutDetails\n  | LoadCheckoutDetailsFail\n  | LoadCheckoutDetailsSuccess\n  | CheckoutClearMiscsData;\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Cart } from '../../../model/cart.model';\nimport { CartAdapter } from './cart.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CartConnector {\n  constructor(protected adapter: CartAdapter) {}\n\n  public loadAll(userId: string): Observable<Cart[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  public load(userId: string, cartId: string): Observable<Cart> {\n    return this.adapter.load(userId, cartId);\n  }\n\n  public create(\n    userId: string,\n    oldCartId?: string,\n    toMergeCartGuid?: string\n  ): Observable<Cart> {\n    return this.adapter.create(userId, oldCartId, toMergeCartGuid);\n  }\n\n  public delete(userId: string, cartId: string): Observable<{}> {\n    return this.adapter.delete(userId, cartId);\n  }\n\n  public addEmail(\n    userId: string,\n    cartId: string,\n    email: string\n  ): Observable<{}> {\n    return this.adapter.addEmail(userId, cartId, email);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { select, Store } from '@ngrx/store';\nimport { from, Observable, of } from 'rxjs';\nimport {\n  catchError,\n  concatMap,\n  exhaustMap,\n  filter,\n  groupBy,\n  map,\n  mergeMap,\n  switchMap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { CheckoutActions } from '../../../checkout/store/actions/index';\nimport { Cart } from '../../../model/cart.model';\nimport { OCC_CART_ID_CURRENT } from '../../../occ/utils/occ-constants';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { withdrawOn } from '../../../util/withdraw-on';\nimport { CartConnector } from '../../connectors/cart/cart.connector';\nimport * as DeprecatedCartActions from '../actions/cart.action';\nimport { CartActions } from '../actions/index';\nimport { StateWithMultiCart } from '../multi-cart-state';\nimport {\n  getActiveCartId,\n  getCartHasPendingProcessesSelectorFactory,\n} from '../selectors/multi-cart.selector';\n\n@Injectable()\nexport class CartEffects {\n  private contextChange$ = this.actions$.pipe(\n    ofType(\n      SiteContextActions.CURRENCY_CHANGE,\n      SiteContextActions.LANGUAGE_CHANGE\n    )\n  );\n\n  @Effect()\n  loadCart$: Observable<\n    | DeprecatedCartActions.LoadCartFail\n    | CartActions.LoadMultiCartFail\n    | DeprecatedCartActions.LoadCartSuccess\n    | CartActions.LoadMultiCartSuccess\n    | CartActions.ClearExpiredCoupons\n    | DeprecatedCartActions.ClearCart\n    | CartActions.RemoveCart\n  > = this.actions$.pipe(\n    ofType(DeprecatedCartActions.LOAD_CART),\n    map((action: DeprecatedCartActions.LoadCart) => action.payload),\n    groupBy(payload => payload.cartId),\n    mergeMap(group$ =>\n      group$.pipe(\n        switchMap(payload => {\n          return of(payload).pipe(\n            withLatestFrom(\n              this.store.pipe(\n                select(\n                  getCartHasPendingProcessesSelectorFactory(payload.cartId)\n                )\n              )\n            )\n          );\n        }),\n        filter(([_, hasPendingProcesses]) => !hasPendingProcesses),\n        map(([payload]) => payload),\n        switchMap(payload => {\n          return this.cartConnector.load(payload.userId, payload.cartId).pipe(\n            // TODO: remove with the `cart` store feature\n            withLatestFrom(this.store.pipe(select(getActiveCartId))),\n            mergeMap(([cart, activeCartId]: [Cart, string]) => {\n              let actions = [];\n              if (cart) {\n                // `cart` store branch should only be updated for active cart\n                // avoid dispatching LoadCartSuccess action on different cart loads\n                if (\n                  payload.cartId === activeCartId ||\n                  payload.cartId === OCC_CART_ID_CURRENT\n                ) {\n                  actions.push(new DeprecatedCartActions.LoadCartSuccess(cart));\n                }\n                actions.push(\n                  new CartActions.LoadMultiCartSuccess({\n                    cart,\n                    userId: payload.userId,\n                    extraData: payload.extraData,\n                  })\n                );\n                if (payload.cartId === OCC_CART_ID_CURRENT) {\n                  // Removing cart from entity object under `current` key as it is no longer needed.\n                  // Current cart is loaded under it's code entity.\n                  actions.push(new CartActions.RemoveCart(OCC_CART_ID_CURRENT));\n                }\n              } else {\n                actions = [\n                  new DeprecatedCartActions.LoadCartFail({}),\n                  new CartActions.LoadMultiCartFail({\n                    cartId: payload.cartId,\n                  }),\n                ];\n              }\n              return actions;\n            }),\n            catchError(error => {\n              if (error?.error?.errors) {\n                const couponExpiredErrors = error.error.errors.filter(\n                  err => err.reason === 'invalid'\n                );\n                if (couponExpiredErrors.length > 0) {\n                  // clear coupons actions just wanted to reload cart again\n                  // no need to do it in refresh or keep that action\n                  // however removing this action will be a breaking change\n                  // remove that action in 2.0 release\n                  // @deprecated since 1.4\n                  return from([\n                    new CartActions.LoadCart({ ...payload }),\n                    new CartActions.ClearExpiredCoupons({}),\n                  ]);\n                }\n\n                const cartNotFoundErrors = error.error.errors.filter(\n                  err => err.reason === 'notFound' || 'UnknownResourceError'\n                );\n                if (\n                  cartNotFoundErrors.length > 0 &&\n                  payload.extraData &&\n                  payload.extraData.active\n                ) {\n                  // Clear cart is responsible for removing cart in `cart` store feature.\n                  // Remove cart does the same thing, but in `multi-cart` store feature.\n                  return from([\n                    new DeprecatedCartActions.ClearCart(),\n                    new CartActions.RemoveCart(payload.cartId),\n                  ]);\n                }\n              }\n              return from([\n                new DeprecatedCartActions.LoadCartFail(\n                  makeErrorSerializable(error)\n                ),\n                new CartActions.LoadMultiCartFail({\n                  cartId: payload.cartId,\n                  error: makeErrorSerializable(error),\n                }),\n              ]);\n            })\n          );\n        })\n      )\n    ),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  createCart$: Observable<\n    | DeprecatedCartActions.MergeCartSuccess\n    | CartActions.MergeMultiCartSuccess\n    | DeprecatedCartActions.CreateCartSuccess\n    | CartActions.CreateMultiCartSuccess\n    | DeprecatedCartActions.CreateCartFail\n    | CartActions.CreateMultiCartFail\n    | CartActions.SetTempCart\n  > = this.actions$.pipe(\n    ofType(DeprecatedCartActions.CREATE_CART),\n    map((action: DeprecatedCartActions.CreateCart) => action.payload),\n    mergeMap(payload => {\n      return this.cartConnector\n        .create(payload.userId, payload.oldCartId, payload.toMergeCartGuid)\n        .pipe(\n          switchMap((cart: Cart) => {\n            const conditionalActions = [];\n            if (payload.oldCartId) {\n              conditionalActions.push(\n                new DeprecatedCartActions.MergeCartSuccess({\n                  userId: payload.userId,\n                  cartId: cart.code,\n                })\n              );\n              conditionalActions.push(\n                new CartActions.MergeMultiCartSuccess({\n                  userId: payload.userId,\n                  cartId: cart.code,\n                  oldCartId: payload.oldCartId,\n                })\n              );\n            }\n            // `cart` store branch should only be updated for active cart\n            // avoid dispatching CreateCartSuccess action on different cart loads\n            if (payload.extraData && payload.extraData.active) {\n              conditionalActions.push(\n                new DeprecatedCartActions.CreateCartSuccess(cart)\n              );\n            }\n            return [\n              new CartActions.CreateMultiCartSuccess({\n                cart,\n                userId: payload.userId,\n                extraData: payload.extraData,\n              }),\n              new CartActions.SetTempCart({\n                cart,\n                tempCartId: payload.tempCartId,\n              }),\n              ...conditionalActions,\n            ];\n          }),\n          catchError(error =>\n            from([\n              new DeprecatedCartActions.CreateCartFail(\n                makeErrorSerializable(error)\n              ),\n              new CartActions.CreateMultiCartFail({\n                tempCartId: payload.tempCartId,\n                error: makeErrorSerializable(error),\n              }),\n            ])\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  mergeCart$: Observable<DeprecatedCartActions.CreateCart> = this.actions$.pipe(\n    ofType(DeprecatedCartActions.MERGE_CART),\n    map((action: DeprecatedCartActions.MergeCart) => action.payload),\n    mergeMap(payload => {\n      return this.cartConnector.load(payload.userId, OCC_CART_ID_CURRENT).pipe(\n        mergeMap(currentCart => {\n          return [\n            new DeprecatedCartActions.CreateCart({\n              userId: payload.userId,\n              oldCartId: payload.cartId,\n              toMergeCartGuid: currentCart ? currentCart.guid : undefined,\n              extraData: payload.extraData,\n              tempCartId: payload.tempCartId,\n            }),\n          ];\n        })\n      );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  refresh$: Observable<\n    DeprecatedCartActions.LoadCart | CartActions.CartProcessesDecrement\n  > = this.actions$.pipe(\n    ofType(\n      CartActions.CART_ADD_ENTRY_SUCCESS,\n      CartActions.CART_UPDATE_ENTRY_SUCCESS,\n      CartActions.CART_REMOVE_ENTRY_SUCCESS,\n      DeprecatedCartActions.ADD_EMAIL_TO_CART_SUCCESS,\n      CheckoutActions.CLEAR_CHECKOUT_DELIVERY_MODE_SUCCESS,\n      CartActions.CART_ADD_VOUCHER_SUCCESS,\n      CartActions.CART_REMOVE_VOUCHER_SUCCESS\n    ),\n    map(\n      (\n        action:\n          | CartActions.CartAddEntrySuccess\n          | CartActions.CartUpdateEntrySuccess\n          | CartActions.CartRemoveEntrySuccess\n          | DeprecatedCartActions.AddEmailToCartSuccess\n          | CheckoutActions.ClearCheckoutDeliveryModeSuccess\n          | CartActions.CartAddVoucherSuccess\n          | CartActions.CartRemoveVoucherSuccess\n      ) => action.payload\n    ),\n    concatMap(payload =>\n      from([\n        new CartActions.CartProcessesDecrement(payload.cartId),\n        new DeprecatedCartActions.LoadCart({\n          userId: payload.userId,\n          cartId: payload.cartId,\n        }),\n      ])\n    )\n  );\n\n  @Effect()\n  refreshWithoutProcesses$: Observable<\n    DeprecatedCartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(DeprecatedCartActions.MERGE_CART_SUCCESS),\n    map((action: DeprecatedCartActions.MergeCartSuccess) => action.payload),\n    map(\n      payload =>\n        new DeprecatedCartActions.LoadCart({\n          userId: payload.userId,\n          cartId: payload.cartId,\n        })\n    )\n  );\n\n  @Effect()\n  resetCartDetailsOnSiteContextChange$: Observable<\n    DeprecatedCartActions.ResetCartDetails | CartActions.ResetMultiCartDetails\n  > = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      SiteContextActions.CURRENCY_CHANGE\n    ),\n    mergeMap(() => {\n      return [\n        new DeprecatedCartActions.ResetCartDetails(),\n        new CartActions.ResetMultiCartDetails(),\n      ];\n    })\n  );\n\n  @Effect()\n  addEmail$: Observable<\n    | DeprecatedCartActions.AddEmailToCartSuccess\n    | DeprecatedCartActions.AddEmailToCartFail\n    | CartActions.AddEmailToMultiCartFail\n    | CartActions.AddEmailToMultiCartSuccess\n    | CartActions.CartProcessesDecrement\n    | DeprecatedCartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(DeprecatedCartActions.ADD_EMAIL_TO_CART),\n    map((action: DeprecatedCartActions.AddEmailToCart) => action.payload),\n    mergeMap(payload =>\n      this.cartConnector\n        .addEmail(payload.userId, payload.cartId, payload.email)\n        .pipe(\n          mergeMap(() => {\n            return [\n              new DeprecatedCartActions.AddEmailToCartSuccess({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n              new CartActions.AddEmailToMultiCartSuccess({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ];\n          }),\n          catchError(error =>\n            from([\n              new DeprecatedCartActions.AddEmailToCartFail(\n                makeErrorSerializable(error)\n              ),\n              new CartActions.AddEmailToMultiCartFail({\n                error: makeErrorSerializable(error),\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n              new CartActions.CartProcessesDecrement(payload.cartId),\n              new DeprecatedCartActions.LoadCart({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ])\n          )\n        )\n    ),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  deleteCart$: Observable<any> = this.actions$.pipe(\n    ofType(DeprecatedCartActions.DELETE_CART),\n    map((action: DeprecatedCartActions.DeleteCart) => action.payload),\n    exhaustMap(payload =>\n      this.cartConnector.delete(payload.userId, payload.cartId).pipe(\n        map(() => {\n          return new DeprecatedCartActions.ClearCart();\n        }),\n        catchError(error =>\n          of(\n            new DeprecatedCartActions.DeleteCartFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cartConnector: CartConnector,\n    private store: Store<StateWithMultiCart>\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { SaveCartResult } from '../../../model/cart.model';\nimport { SaveCartAdapter } from './save-cart.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SaveCartConnector {\n  constructor(protected adapter: SaveCartAdapter) {}\n\n  public saveCart(\n    userId: string,\n    cartId: string,\n    saveCartName?: string,\n    saveCartDescription?: string\n  ): Observable<SaveCartResult> {\n    return this.adapter.saveCart(\n      userId,\n      cartId,\n      saveCartName,\n      saveCartDescription\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { select, Store } from '@ngrx/store';\nimport { EMPTY, from, Observable } from 'rxjs';\nimport {\n  catchError,\n  concatMap,\n  map,\n  switchMap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { AuthService } from '../../../auth/facade/auth.service';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CartConnector } from '../../connectors/cart/cart.connector';\nimport { SaveCartConnector } from '../../connectors/save-cart/save-cart.connecter';\nimport { CartActions } from '../actions';\nimport { StateWithMultiCart } from '../multi-cart-state';\nimport { MultiCartSelectors } from '../selectors';\n\n@Injectable()\nexport class WishListEffects {\n  @Effect()\n  createWishList$: Observable<\n    CartActions.CreateWishListSuccess | CartActions.CreateWishListFail\n  > = this.actions$.pipe(\n    ofType(CartActions.CREATE_WISH_LIST),\n    map((action: CartActions.CreateWishList) => action.payload),\n    switchMap(payload => {\n      return this.cartConnector.create(payload.userId).pipe(\n        switchMap(cart => {\n          return this.saveCartConnector\n            .saveCart(\n              payload.userId,\n              cart.code,\n              payload.name,\n              payload.description\n            )\n            .pipe(\n              switchMap(saveCartResult => [\n                new CartActions.CreateWishListSuccess({\n                  cart: saveCartResult.savedCartData,\n                  userId: payload.userId,\n                }),\n              ]),\n              catchError(error =>\n                from([\n                  new CartActions.CreateWishListFail({\n                    cartId: cart.code,\n                    error: makeErrorSerializable(error),\n                  }),\n                ])\n              )\n            );\n        })\n      );\n    })\n  );\n\n  @Effect()\n  loadWishList$: Observable<\n    | CartActions.LoadWishListSuccess\n    | CartActions.CreateWishList\n    | CartActions.LoadCartFail\n  > = this.actions$.pipe(\n    ofType(CartActions.LOAD_WISH_LIST),\n    map((action: CartActions.LoadWishList) => action.payload),\n    concatMap(payload => {\n      const { userId, customerId } = payload;\n      return this.cartConnector.loadAll(userId).pipe(\n        switchMap(carts => {\n          if (carts) {\n            const wishList = carts.find(\n              cart => cart.name === `wishlist${customerId}`\n            );\n            if (Boolean(wishList)) {\n              return [\n                new CartActions.LoadWishListSuccess({\n                  cart: wishList,\n                  userId,\n                }),\n              ];\n            } else {\n              return [\n                new CartActions.CreateWishList({\n                  userId,\n                  name: `wishlist${customerId}`,\n                }),\n              ];\n            }\n          }\n        }),\n        catchError(error =>\n          from([new CartActions.LoadCartFail(makeErrorSerializable(error))])\n        )\n      );\n    })\n  );\n\n  @Effect()\n  resetWishList$: Observable<\n    CartActions.LoadWishListSuccess | CartActions.LoadCartFail\n  > = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      SiteContextActions.CURRENCY_CHANGE\n    ),\n    withLatestFrom(\n      this.authService.getOccUserId(),\n      this.store.pipe(select(MultiCartSelectors.getWishListId))\n    ),\n    switchMap(([, userId, wishListId]) => {\n      if (Boolean(wishListId)) {\n        return this.cartConnector.load(userId, wishListId).pipe(\n          switchMap(wishList => [\n            new CartActions.LoadWishListSuccess({ cart: wishList, userId }),\n          ]),\n          catchError(error =>\n            from([new CartActions.LoadCartFail(makeErrorSerializable(error))])\n          )\n        );\n      }\n      return EMPTY;\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cartConnector: CartConnector,\n    private saveCartConnector: SaveCartConnector,\n    private authService: AuthService,\n    private store: Store<StateWithMultiCart>\n  ) {}\n}\n","import { OrderEntry } from '../../../model/order.model';\nimport * as DeprecatedCartActions from '../actions/cart.action';\nimport { CartActions } from '../actions/index';\nimport { CartState } from '../cart-state';\n\nexport const initialState: CartState = {\n  content: {},\n  entries: {},\n  refresh: false,\n  cartMergeComplete: false,\n};\n\nexport function reducer(\n  state = initialState,\n  action:\n    | CartActions.CartAction\n    | CartActions.CartEntryAction\n    | CartActions.CartVoucherAction\n): CartState {\n  switch (action.type) {\n    case DeprecatedCartActions.MERGE_CART: {\n      return {\n        ...state,\n        cartMergeComplete: false,\n      };\n    }\n\n    case DeprecatedCartActions.MERGE_CART_SUCCESS: {\n      return {\n        ...state,\n        cartMergeComplete: true,\n        refresh: true,\n      };\n    }\n\n    case DeprecatedCartActions.LOAD_CART_SUCCESS:\n    case DeprecatedCartActions.CREATE_CART_SUCCESS: {\n      const content = { ...action.payload };\n      let entries = {};\n      if (content.entries) {\n        entries = content.entries.reduce(\n          (entryMap: { [code: string]: any }, entry: OrderEntry) => {\n            return {\n              ...entryMap,\n              /*\n              If we refresh the page from cart details page, 2 load cart\n              Actions gets dispatched. One is non-detail, and the second is detailed.\n              In the case where the detailed once get resolved first, we merge the existing\n              data with the new data from the response (to not delete existing detailed data).\n              */\n              [entry.product.code]:\n                state.entries && state.entries[entry.product.code]\n                  ? {\n                      ...state.entries[entry.product.code],\n                      ...entry,\n                    }\n                  : entry,\n            };\n          },\n          {\n            ...entries,\n          }\n        );\n        delete content['entries'];\n      }\n      return {\n        ...state,\n        content,\n        entries,\n        refresh: false,\n      };\n    }\n\n    case CartActions.CART_ADD_VOUCHER_SUCCESS:\n    case CartActions.CART_REMOVE_VOUCHER_SUCCESS:\n    case CartActions.CART_REMOVE_ENTRY_SUCCESS:\n    case CartActions.CART_UPDATE_ENTRY_SUCCESS:\n    case CartActions.CART_ADD_ENTRY_SUCCESS:\n    case DeprecatedCartActions.ADD_EMAIL_TO_CART_SUCCESS: {\n      return {\n        ...state,\n        refresh: true,\n      };\n    }\n\n    case DeprecatedCartActions.RESET_CART_DETAILS: {\n      return {\n        content: {\n          guid: state.content.guid,\n          code: state.content.code,\n          user: state.content.user,\n        },\n        entries: {},\n        refresh: false,\n        cartMergeComplete: false,\n      };\n    }\n\n    case DeprecatedCartActions.CLEAR_CART: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { Cart } from '../../../model/cart.model';\nimport { LoaderAction } from '../../../state/utils/loader/loader.action';\nimport { CartActions } from '../actions/index';\n\nexport const activeCartInitialState = '';\nexport const wishListInitialState = '';\n\nexport function activeCartReducer(\n  state = activeCartInitialState,\n  action: CartActions.CartAction | CartActions.MultiCartActions\n): string {\n  switch (action.type) {\n    case CartActions.LOAD_MULTI_CART_SUCCESS:\n    case CartActions.CREATE_MULTI_CART_SUCCESS:\n    // point to `temp-${uuid}` cart when we are creating/merging cart\n    case CartActions.CREATE_MULTI_CART:\n      if (\n        action.payload &&\n        action.payload.extraData &&\n        action.payload.extraData.active\n      ) {\n        return action.meta.entityId as string;\n      } else {\n        return state;\n      }\n    case CartActions.SET_ACTIVE_CART_ID:\n      return action.payload;\n    case CartActions.REMOVE_CART:\n      if (action.payload === state) {\n        return activeCartInitialState;\n      } else {\n        return state;\n      }\n    case CartActions.CLEAR_MULTI_CART_STATE:\n      return activeCartInitialState;\n  }\n  return state;\n}\n\nexport const cartEntitiesInitialState = undefined;\n\nexport function cartEntitiesReducer(\n  state = cartEntitiesInitialState,\n  action: LoaderAction\n): Cart {\n  switch (action.type) {\n    case CartActions.LOAD_MULTI_CART_SUCCESS:\n    case CartActions.CREATE_MULTI_CART_SUCCESS:\n    case CartActions.CREATE_WISH_LIST_SUCCESS:\n    case CartActions.LOAD_WISH_LIST_SUCCESS:\n    case CartActions.SET_TEMP_CART:\n      return action.payload.cart;\n  }\n  return state;\n}\n\nexport function wishListReducer(\n  state = wishListInitialState,\n  action: CartActions.WishListActions | CartActions.ClearMultiCartState\n): string {\n  switch (action.type) {\n    case CartActions.CREATE_WISH_LIST_SUCCESS:\n    case CartActions.LOAD_WISH_LIST_SUCCESS:\n      return action.meta.entityId as string;\n    case CartActions.CLEAR_MULTI_CART_STATE:\n      return wishListInitialState;\n  }\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducer, ActionReducerMap, MetaReducer } from '@ngrx/store';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { CheckoutActions } from '../../../checkout/store/actions/index';\nimport { Cart } from '../../../model/cart.model';\nimport { entityProcessesLoaderReducer } from '../../../state/utils/entity-processes-loader/entity-processes-loader.reducer';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport { CartsState, CartState, CART_DATA } from '../cart-state';\nimport { MultiCartState, MULTI_CART_FEATURE } from '../multi-cart-state';\nimport { reducer as cartReducer } from './cart.reducer';\nimport {\n  activeCartReducer,\n  cartEntitiesReducer,\n  wishListReducer,\n} from './multi-cart.reducer';\n\nexport function getReducers(): ActionReducerMap<CartsState> {\n  return {\n    active: loaderReducer<CartState>(CART_DATA, cartReducer),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  CartsState\n>> = new InjectionToken<ActionReducerMap<CartsState>>('CartReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearCartState(\n  reducer: ActionReducer<any>\n): ActionReducer<any> {\n  return function(state, action) {\n    if (\n      action.type === AuthActions.LOGOUT ||\n      action.type === CheckoutActions.PLACE_ORDER_SUCCESS\n    ) {\n      state = undefined;\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearCartState];\n\nexport function clearMultiCartState(\n  reducer: ActionReducer<any>\n): ActionReducer<any> {\n  return function(state, action) {\n    if (action.type === AuthActions.LOGOUT) {\n      state = undefined;\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const multiCartMetaReducers: MetaReducer<any>[] = [clearMultiCartState];\n\nexport const multiCartReducerToken: InjectionToken<ActionReducerMap<\n  MultiCartState\n>> = new InjectionToken<ActionReducerMap<MultiCartState>>('MultiCartReducers');\n\nexport function getMultiCartReducers(): ActionReducerMap<MultiCartState> {\n  return {\n    carts: entityProcessesLoaderReducer<Cart>(\n      MULTI_CART_FEATURE,\n      cartEntitiesReducer\n    ),\n    active: activeCartReducer,\n    wishList: wishListReducer,\n  };\n}\n\nexport const multiCartReducerProvider: Provider = {\n  provide: multiCartReducerToken,\n  useFactory: getMultiCartReducers,\n};\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { distinctUntilKeyChanged, filter, map } from 'rxjs/operators';\nimport { BASE_SITE_CONTEXT_ID } from '../../site-context';\nimport { SiteContextParamsService } from '../../site-context/services/site-context-params.service';\nimport { StatePersistenceService } from '../../state/services/state-persistence.service';\nimport { CartActions, MultiCartSelectors } from '../store';\nimport { StateWithMultiCart } from '../store/multi-cart-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class MultiCartStatePersistenceService {\n  constructor(\n    protected statePersistenceService: StatePersistenceService,\n    protected store: Store<StateWithMultiCart>,\n    protected siteContextParamsService: SiteContextParamsService\n  ) {}\n\n  public sync() {\n    this.statePersistenceService.syncWithStorage({\n      key: 'cart',\n      state$: this.getCartState(),\n      context$: this.siteContextParamsService.getValues([BASE_SITE_CONTEXT_ID]),\n      onRead: state => this.onRead(state),\n    });\n  }\n\n  protected getCartState(): Observable<{ active: string }> {\n    return this.store.pipe(\n      select(MultiCartSelectors.getMultiCartState),\n      filter(state => !!state),\n      distinctUntilKeyChanged('active'),\n      map(state => {\n        return {\n          active: state.active,\n        };\n      })\n    );\n  }\n\n  protected onRead(state: { active: string }) {\n    this.store.dispatch(new CartActions.ClearCart());\n    this.store.dispatch(new CartActions.ClearMultiCartState());\n    if (state) {\n      this.store.dispatch(new CartActions.SetActiveCartId(state.active));\n    }\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { provideDefaultConfigFactory } from '../../config/config.module';\nimport { StateConfig, StorageSyncType } from '../../state/config/state-config';\nimport { StateModule } from '../../state/state.module';\nimport { CART_FEATURE } from './cart-state';\nimport { CartEntryEffects } from './effects/cart-entry.effect';\nimport { CartVoucherEffects } from './effects/cart-voucher.effect';\nimport { CartEffects } from './effects/cart.effect';\nimport { WishListEffects } from './effects/wish-list.effect';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nconst effects: any[] = [\n  CartEffects,\n  CartEntryEffects,\n  CartVoucherEffects,\n  WishListEffects,\n];\n\nexport function cartStoreConfigFactory(): StateConfig {\n  const config: StateConfig = {\n    state: {\n      storageSync: {\n        keys: {\n          [`${CART_FEATURE}.active.value.content.guid`]: StorageSyncType.LOCAL_STORAGE,\n          [`${CART_FEATURE}.active.value.content.code`]: StorageSyncType.LOCAL_STORAGE,\n          [`${CART_FEATURE}.active.value.content.user`]: StorageSyncType.LOCAL_STORAGE,\n        },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StateModule,\n    StoreModule.forFeature(CART_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(cartStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class CartStoreModule {}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { CheckoutActions } from '../../../checkout/store/actions';\nimport * as DeprecatedCartActions from '../actions/cart.action';\nimport { CartActions } from '../actions/index';\n\n@Injectable()\nexport class MultiCartEffects {\n  @Effect()\n  loadCart2$: Observable<CartActions.LoadMultiCart> = this.actions$.pipe(\n    ofType(DeprecatedCartActions.LOAD_CART),\n    map(\n      (action: DeprecatedCartActions.LoadCart) =>\n        new CartActions.LoadMultiCart(action.payload)\n    )\n  );\n\n  @Effect()\n  createCart2$: Observable<CartActions.CreateMultiCart> = this.actions$.pipe(\n    ofType(DeprecatedCartActions.CREATE_CART),\n    map(\n      (action: CartActions.CreateCart) =>\n        new CartActions.CreateMultiCart(action.payload)\n    )\n  );\n\n  @Effect()\n  setTempCart$ = this.actions$.pipe(\n    ofType(CartActions.SET_TEMP_CART),\n    map((action: CartActions.SetTempCart) => {\n      return new CartActions.RemoveTempCart(action.payload);\n    })\n  );\n\n  @Effect()\n  mergeCart2$: Observable<CartActions.MergeMultiCart> = this.actions$.pipe(\n    ofType(DeprecatedCartActions.MERGE_CART),\n    map(\n      (action: DeprecatedCartActions.MergeCart) =>\n        new CartActions.MergeMultiCart(action.payload)\n    )\n  );\n\n  @Effect()\n  addEmail2$: Observable<CartActions.AddEmailToMultiCart> = this.actions$.pipe(\n    ofType(DeprecatedCartActions.ADD_EMAIL_TO_CART),\n    map(\n      (action: CartActions.AddEmailToCart) =>\n        new CartActions.AddEmailToMultiCart(action.payload)\n    )\n  );\n\n  @Effect()\n  removeCart$: Observable<CartActions.RemoveCart> = this.actions$.pipe(\n    ofType(DeprecatedCartActions.DELETE_CART),\n    map((action: DeprecatedCartActions.DeleteCart) => action.payload),\n    map(payload => new CartActions.RemoveCart(payload.cartId))\n  );\n\n  // TODO: Change actions to extend Increment action instead of doing extra dispatch in this effect\n  // Change for 2.0 release\n  @Effect()\n  processesIncrement$: Observable<\n    CartActions.CartProcessesIncrement\n  > = this.actions$.pipe(\n    ofType(\n      CartActions.CART_ADD_ENTRY,\n      CartActions.CART_UPDATE_ENTRY,\n      CartActions.CART_REMOVE_ENTRY,\n      DeprecatedCartActions.ADD_EMAIL_TO_CART,\n      CheckoutActions.CLEAR_CHECKOUT_DELIVERY_MODE,\n      CartActions.CART_ADD_VOUCHER,\n      CartActions.CART_REMOVE_VOUCHER\n    ),\n    map(\n      (\n        action:\n          | CartActions.CartAddEntry\n          | CartActions.CartUpdateEntry\n          | CartActions.CartRemoveEntry\n          | DeprecatedCartActions.AddEmailToCart\n          | CheckoutActions.ClearCheckoutDeliveryMode\n          | CartActions.CartAddVoucher\n          | CartActions.CartRemoveVoucher\n      ) => action.payload\n    ),\n    map(payload => new CartActions.CartProcessesIncrement(payload.cartId))\n  );\n\n  constructor(private actions$: Actions) {}\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { StateModule } from '../../state/state.module';\nimport { MultiCartEffects } from './effects/multi-cart.effect';\nimport { MULTI_CART_FEATURE } from './multi-cart-state';\nimport {\n  multiCartMetaReducers,\n  multiCartReducerProvider,\n  multiCartReducerToken,\n} from './reducers/index';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    StateModule,\n    StoreModule.forFeature(MULTI_CART_FEATURE, multiCartReducerToken, {\n      metaReducers: multiCartMetaReducers,\n    }),\n    EffectsModule.forFeature([MultiCartEffects]),\n  ],\n  providers: [multiCartReducerProvider],\n})\nexport class MultiCartStoreModule {}\n","import { APP_INITIALIZER, ModuleWithProviders, NgModule } from '@angular/core';\nimport { PageMetaResolver } from '../cms/page/page-meta.resolver';\nimport { ConfigInitializerService } from '../config/config-initializer/config-initializer.service';\nimport { ActiveCartService } from './facade/active-cart.service';\nimport {\n  CartVoucherService,\n  SelectiveCartService,\n  WishListService,\n} from './facade/index';\nimport { MultiCartService } from './facade/multi-cart.service';\nimport { CartPageMetaResolver } from './services/cart-page-meta.resolver';\nimport { MultiCartStatePersistenceService } from './services/multi-cart-state-persistence.service';\nimport { CartStoreModule } from './store/cart-store.module';\nimport { MultiCartStoreModule } from './store/multi-cart-store.module';\n\nexport function cartStatePersistenceFactory(\n  cartStatePersistenceService: MultiCartStatePersistenceService,\n  configInit: ConfigInitializerService\n) {\n  const result = () =>\n    configInit.getStableConfig('context').then(() => {\n      cartStatePersistenceService.sync();\n    });\n  return result;\n}\n\n@NgModule({\n  imports: [CartStoreModule, MultiCartStoreModule],\n})\nexport class CartModule {\n  static forRoot(): ModuleWithProviders<CartModule> {\n    return {\n      ngModule: CartModule,\n      providers: [\n        CartVoucherService,\n        MultiCartService,\n        WishListService,\n        ActiveCartService,\n        SelectiveCartService,\n        {\n          provide: PageMetaResolver,\n          useExisting: CartPageMetaResolver,\n          multi: true,\n        },\n        {\n          provide: APP_INITIALIZER,\n          useFactory: cartStatePersistenceFactory,\n          deps: [MultiCartStatePersistenceService, ConfigInitializerService],\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import { CheckoutActions } from '../actions/index';\nimport { AddressVerificationState } from '../checkout-state';\n\nexport const initialState: AddressVerificationState = {\n  results: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: CheckoutActions.AddressVerificationActions\n): AddressVerificationState {\n  switch (action.type) {\n    case CheckoutActions.VERIFY_ADDRESS_SUCCESS: {\n      const results = action.payload;\n\n      return {\n        ...state,\n        results,\n      };\n    }\n\n    case CheckoutActions.VERIFY_ADDRESS_FAIL: {\n      return {\n        ...state,\n        results: 'FAIL',\n      };\n    }\n\n    case CheckoutActions.CLEAR_ADDRESS_VERIFICATION_RESULTS: {\n      return {\n        ...state,\n        results: {},\n      };\n    }\n  }\n\n  return state;\n}\n\nexport const getAddressVerificationResults = (\n  state: AddressVerificationState\n) => state.results;\n","import {\n  createFeatureSelector,\n  createSelector,\n  MemoizedSelector,\n} from '@ngrx/store';\nimport { Address } from '../../../model/address.model';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { DeliveryMode, Order } from '../../../model/order.model';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  CheckoutState,\n  CheckoutStepsState,\n  CHECKOUT_FEATURE,\n  StateWithCheckout,\n} from '../checkout-state';\n\nconst getDeliveryAddressSelector = (state: CheckoutStepsState) => state.address;\nconst getDeliveryModeSelector = (state: CheckoutStepsState) =>\n  state.deliveryMode;\nconst getPaymentDetailsSelector = (state: CheckoutStepsState) =>\n  state.paymentDetails;\nconst getOrderDetailsSelector = (state: CheckoutStepsState) =>\n  state.orderDetails;\n\nexport const getCheckoutState: MemoizedSelector<\n  StateWithCheckout,\n  CheckoutState\n> = createFeatureSelector<CheckoutState>(CHECKOUT_FEATURE);\n\nexport const getCheckoutStepsState: MemoizedSelector<\n  StateWithCheckout,\n  LoaderState<CheckoutStepsState>\n> = createSelector(\n  getCheckoutState,\n  (checkoutState: CheckoutState) => checkoutState.steps\n);\n\nexport const getCheckoutSteps: MemoizedSelector<\n  StateWithCheckout,\n  CheckoutStepsState\n> = createSelector(getCheckoutStepsState, state =>\n  StateLoaderSelectors.loaderValueSelector(state)\n);\n\nexport const getDeliveryAddress: MemoizedSelector<\n  StateWithCheckout,\n  Address\n> = createSelector(getCheckoutSteps, getDeliveryAddressSelector);\n\nexport const getDeliveryMode: MemoizedSelector<\n  StateWithCheckout,\n  {\n    supported: { [code: string]: DeliveryMode };\n    selected: string;\n  }\n> = createSelector(getCheckoutSteps, getDeliveryModeSelector);\n\nexport const getSupportedDeliveryModes: MemoizedSelector<\n  StateWithCheckout,\n  DeliveryMode[]\n> = createSelector(getDeliveryMode, deliveryMode => {\n  return (\n    deliveryMode &&\n    Object.keys(deliveryMode.supported).map(\n      code => deliveryMode.supported[code]\n    )\n  );\n});\n\nexport const getSelectedDeliveryModeCode: MemoizedSelector<\n  StateWithCheckout,\n  string\n> = createSelector(getDeliveryMode, deliveryMode => {\n  return deliveryMode && deliveryMode.selected;\n});\n\nexport const getSelectedDeliveryMode: MemoizedSelector<\n  StateWithCheckout,\n  DeliveryMode\n> = createSelector(getDeliveryMode, deliveryMode => {\n  if (deliveryMode.selected !== '') {\n    if (Object.keys(deliveryMode.supported).length === 0) {\n      return null;\n    }\n    return deliveryMode.supported[deliveryMode.selected];\n  }\n});\n\nexport const getPaymentDetails: MemoizedSelector<\n  StateWithCheckout,\n  PaymentDetails\n> = createSelector(getCheckoutSteps, getPaymentDetailsSelector);\n\nexport const getCheckoutOrderDetails: MemoizedSelector<\n  StateWithCheckout,\n  Order\n> = createSelector(getCheckoutSteps, getOrderDetailsSelector);\n\nexport const getCheckoutDetailsLoaded: MemoizedSelector<\n  StateWithCheckout,\n  boolean\n> = createSelector(\n  getCheckoutStepsState,\n  state =>\n    StateLoaderSelectors.loaderSuccessSelector(state) &&\n    !StateLoaderSelectors.loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { AddressValidation } from '../../../model/address.model';\nimport {\n  AddressVerificationState,\n  CheckoutState,\n  StateWithCheckout,\n} from '../checkout-state';\nimport * as fromReducer from './../reducers/address-verification.reducer';\nimport { getCheckoutState } from './checkout.selectors';\n\nexport const getAddressVerificationResultsState: MemoizedSelector<\n  StateWithCheckout,\n  AddressVerificationState\n> = createSelector(\n  getCheckoutState,\n  (state: CheckoutState) => state.addressVerification\n);\n\nexport const getAddressVerificationResults: MemoizedSelector<\n  StateWithCheckout,\n  string | AddressValidation\n> = createSelector(\n  getAddressVerificationResultsState,\n  fromReducer.getAddressVerificationResults\n);\n","import { CardType } from '../../../model/cart.model';\nimport { CheckoutActions } from '../actions/index';\nimport { CardTypesState } from '../checkout-state';\n\nexport const initialState: CardTypesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action:\n    | CheckoutActions.CardTypesAction\n    | CheckoutActions.CheckoutClearMiscsData\n): CardTypesState {\n  switch (action.type) {\n    case CheckoutActions.LOAD_CARD_TYPES_SUCCESS: {\n      const cardTypes: CardType[] = action.payload;\n      const entities = cardTypes.reduce(\n        (cardTypesEntities: { [code: string]: CardType }, name: CardType) => {\n          return {\n            ...cardTypesEntities,\n            [name.code]: name,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case CheckoutActions.CHECKOUT_CLEAR_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n\nexport const getCardTypesEntites = (state: CardTypesState) => state.entities;\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { CardType } from '../../../model/cart.model';\nimport {\n  CardTypesState,\n  CheckoutState,\n  StateWithCheckout,\n} from '../checkout-state';\nimport * as fromReducer from './../reducers/card-types.reducer';\nimport { getCheckoutState } from './checkout.selectors';\n\nexport const getCardTypesState: MemoizedSelector<\n  StateWithCheckout,\n  CardTypesState\n> = createSelector(getCheckoutState, (state: CheckoutState) => state.cardTypes);\n\nexport const getCardTypesEntites: MemoizedSelector<\n  StateWithCheckout,\n  { [code: string]: CardType }\n> = createSelector(getCardTypesState, fromReducer.getCardTypesEntites);\n\nexport const getAllCardTypes: MemoizedSelector<\n  StateWithCheckout,\n  CardType[]\n> = createSelector(getCardTypesEntites, entites => {\n  return Object.keys(entites).map(code => entites[code]);\n});\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { ActiveCartService } from '../../cart/facade/active-cart.service';\nimport { Order } from '../../model/order.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { CheckoutActions } from '../store/actions/index';\nimport { StateWithCheckout } from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class CheckoutService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout>,\n    protected authService: AuthService,\n    protected activeCartService: ActiveCartService\n  ) {}\n\n  /**\n   * Places an order\n   */\n  placeOrder(): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.authService\n        .getOccUserId()\n        .subscribe(occUserId => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe(activeCartId => (cartId = activeCartId))\n        .unsubscribe();\n\n      if (userId && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.PlaceOrder({\n            userId,\n            cartId,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Clear checkout data\n   */\n  clearCheckoutData(): void {\n    this.checkoutStore.dispatch(new CheckoutActions.ClearCheckoutData());\n  }\n\n  /**\n   * Clear checkout step\n   * @param stepNumber : the step number to be cleared\n   */\n  clearCheckoutStep(stepNumber: number): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ClearCheckoutStep(stepNumber)\n    );\n  }\n\n  /**\n   * Load checkout details data\n   * @param cartId : string Cart ID of loaded cart\n   */\n  loadCheckoutDetails(cartId: string) {\n    let userId;\n    this.authService\n      .getOccUserId()\n      .subscribe(occUserId => (userId = occUserId))\n      .unsubscribe();\n    if (userId) {\n      this.checkoutStore.dispatch(\n        new CheckoutActions.LoadCheckoutDetails({\n          userId,\n          cartId,\n        })\n      );\n    }\n  }\n\n  /**\n   * Get status of checkout details loaded\n   */\n  getCheckoutDetailsLoaded(): Observable<boolean> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getCheckoutDetailsLoaded)\n    );\n  }\n\n  /**\n   * Get order details\n   */\n  getOrderDetails(): Observable<Order> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getCheckoutOrderDetails)\n    );\n  }\n\n  protected actionAllowed(): boolean {\n    let userId;\n    this.authService\n      .getOccUserId()\n      .subscribe(occUserId => (userId = occUserId))\n      .unsubscribe();\n    return (\n      (userId && userId !== OCC_USER_ID_ANONYMOUS) ||\n      this.activeCartService.isGuestCart()\n    );\n  }\n}\n","import { Observable } from 'rxjs';\n\nexport abstract class TranslationService {\n  /**\n   * Translates given key with options.\n   * If key is missing, it tries to load the chunk and emits a value when chunk is loaded.\n   * If key is missing after loaded chunk, a fallback value is emitted\n   *\n   * @param key translation key\n   * @param options values for interpolation in translation\n   * @param whitespaceUntilLoaded if true, immediately emits a non-breaking space\n   */\n  translate: (\n    key: string,\n    options?: any,\n    whitespaceUntilLoaded?: boolean\n  ) => Observable<string>;\n\n  /**\n   * Loads chunks with translations\n   *\n   * @param chunkNames array of chunk names to be loaded\n   */\n  loadChunks: (chunkNames: string | string[]) => Promise<any>;\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { ActiveCartService } from '../../cart/facade/active-cart.service';\nimport { PageMeta, PageRobotsMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageRobotsResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { Cart } from '../../model/cart.model';\nimport { PageType } from '../../model/cms.model';\n\n/**\n * Resolves the page data for all Content Pages based on the `PageType.CONTENT_PAGE`\n * and the `MultiStepCheckoutSummaryPageTemplate`. If the checkout page matches this template,\n * the more generic `ContentPageMetaResolver` is overriden by this resolver.\n *\n * The page title and robots are resolved in this implementation only.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutPageMetaResolver extends PageMetaResolver\n  implements PageTitleResolver, PageRobotsResolver {\n  private cart$ = this.activeCartService.getActive();\n\n  constructor(\n    protected translation: TranslationService,\n    protected activeCartService: ActiveCartService\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'MultiStepCheckoutSummaryPageTemplate';\n  }\n\n  /**\n   * @deprecated since version 1.3\n   *\n   * The resolve method is no longer preferred and will be removed with release 2.0.\n   * The caller `PageMetaService` service is improved to expect all individual resolvers\n   * instead, so that the code is easier extensible.\n   */\n  resolve(): Observable<PageMeta> | any {\n    return this.cart$.pipe(\n      switchMap(cart =>\n        combineLatest([this.resolveTitle(cart), this.resolveRobots()])\n      ),\n      map(([title, robots]) => ({ title, robots }))\n    );\n  }\n\n  resolveTitle(): Observable<string>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveTitle()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveTitle(cart: Cart): Observable<string>;\n  resolveTitle(cart?: Cart): Observable<string> {\n    const cart$: Observable<Cart> = cart ? of(cart) : this.cart$;\n    return cart$.pipe(\n      switchMap(c =>\n        this.translation.translate('pageMetaResolver.checkout.title', {\n          count: c.totalItems,\n        })\n      )\n    );\n  }\n\n  resolveRobots(): Observable<PageRobotsMeta[]> {\n    return of([PageRobotsMeta.NOFOLLOW, PageRobotsMeta.NOINDEX]);\n  }\n}\n","import { Address } from '../../../model/address.model';\nimport { DeliveryMode, Order } from '../../../model/order.model';\nimport { CheckoutStepsState } from '../checkout-state';\nimport { CheckoutActions } from './../actions/index';\n\nexport const initialState: CheckoutStepsState = {\n  address: {},\n  deliveryMode: {\n    supported: {},\n    selected: '',\n  },\n  paymentDetails: {},\n  orderDetails: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action:\n    | CheckoutActions.CheckoutAction\n    | CheckoutActions.CheckoutClearMiscsData\n): CheckoutStepsState {\n  switch (action.type) {\n    case CheckoutActions.ADD_DELIVERY_ADDRESS_SUCCESS:\n    case CheckoutActions.SET_DELIVERY_ADDRESS_SUCCESS: {\n      const address: Address = action.payload;\n\n      return {\n        ...state,\n        address,\n      };\n    }\n\n    case CheckoutActions.LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS: {\n      const supportedModes = action.payload;\n      if (!supportedModes) {\n        return state;\n      }\n\n      const supported = supportedModes.reduce(\n        (modes: { [code: string]: DeliveryMode }, mode: DeliveryMode) => {\n          return {\n            ...modes,\n            [mode.code]: mode,\n          };\n        },\n        {\n          ...state.deliveryMode.supported,\n        }\n      );\n\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          supported,\n        },\n      };\n    }\n\n    case CheckoutActions.SET_DELIVERY_MODE_SUCCESS: {\n      const selected = action.payload;\n\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          selected,\n        },\n      };\n    }\n\n    case CheckoutActions.CREATE_PAYMENT_DETAILS_SUCCESS:\n    case CheckoutActions.SET_PAYMENT_DETAILS_SUCCESS: {\n      return {\n        ...state,\n        paymentDetails: action.payload,\n      };\n    }\n\n    case CheckoutActions.CREATE_PAYMENT_DETAILS_FAIL: {\n      const paymentDetails = action.payload;\n      if (paymentDetails['hasError']) {\n        return {\n          ...state,\n          paymentDetails,\n        };\n      }\n\n      return state;\n    }\n\n    case CheckoutActions.PLACE_ORDER_SUCCESS: {\n      const orderDetails: Order = action.payload;\n\n      return {\n        ...state,\n        orderDetails,\n      };\n    }\n\n    case CheckoutActions.CLEAR_CHECKOUT_DATA: {\n      return initialState;\n    }\n\n    case CheckoutActions.CLEAR_CHECKOUT_STEP: {\n      const stepNumber = action.payload;\n      switch (stepNumber) {\n        case 1: {\n          return {\n            ...state,\n            address: {},\n          };\n        }\n\n        case 2: {\n          return {\n            ...state,\n            deliveryMode: {\n              ...state.deliveryMode,\n              supported: {},\n              selected: '',\n            },\n          };\n        }\n\n        case 3: {\n          return {\n            ...state,\n            paymentDetails: {},\n          };\n        }\n      }\n\n      return state;\n    }\n\n    case CheckoutActions.CLEAR_SUPPORTED_DELIVERY_MODES:\n    case CheckoutActions.CHECKOUT_CLEAR_MISCS_DATA: {\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          supported: {},\n        },\n      };\n    }\n    case CheckoutActions.LOAD_CHECKOUT_DETAILS_SUCCESS: {\n      return {\n        ...state,\n        address: action.payload.deliveryAddress,\n        deliveryMode: {\n          ...state.deliveryMode,\n          selected:\n            action.payload.deliveryMode && action.payload.deliveryMode.code,\n        },\n        paymentDetails: action.payload.paymentInfo,\n      };\n    }\n\n    case CheckoutActions.CLEAR_CHECKOUT_DELIVERY_ADDRESS: {\n      return {\n        ...state,\n        address: {},\n      };\n    }\n\n    case CheckoutActions.CLEAR_CHECKOUT_DELIVERY_MODE: {\n      return {\n        ...state,\n        deliveryMode: {\n          ...state.deliveryMode,\n          selected: '',\n        },\n      };\n    }\n  }\n\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\n\nimport { ActionReducerMap } from '@ngrx/store';\n\nimport {\n  CheckoutState,\n  CHECKOUT_DETAILS,\n  CheckoutStepsState,\n} from '../checkout-state';\n\nimport * as fromAddressVerification from './address-verification.reducer';\nimport * as fromCardTypes from './card-types.reducer';\nimport * as fromCheckout from './checkout.reducer';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\n\nexport function getReducers(): ActionReducerMap<CheckoutState> {\n  return {\n    steps: loaderReducer<CheckoutStepsState>(\n      CHECKOUT_DETAILS,\n      fromCheckout.reducer\n    ),\n    cardTypes: fromCardTypes.reducer,\n    addressVerification: fromAddressVerification.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  CheckoutState\n>> = new InjectionToken<ActionReducerMap<CheckoutState>>('CheckoutReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import { Injectable } from '@angular/core';\nimport { UserAddressAdapter } from './user-address.adapter';\nimport { Observable } from 'rxjs';\nimport { Address, AddressValidation } from '../../../model/address.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserAddressConnector {\n  constructor(protected adapter: UserAddressAdapter) {}\n\n  getAll(userId: string): Observable<Address[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  add(userId: string, address: Address): Observable<{}> {\n    return this.adapter.add(userId, address);\n  }\n\n  update(userId: string, addressId: string, address: Address): Observable<{}> {\n    return this.adapter.update(userId, addressId, address);\n  }\n\n  verify(userId: string, address: Address): Observable<AddressValidation> {\n    return this.adapter.verify(userId, address);\n  }\n\n  delete(userId: string, addressId: string): Observable<{}> {\n    return this.adapter.delete(userId, addressId);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { UserAddressConnector } from '../../../user/connectors/address/user-address.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CheckoutActions } from '../actions/index';\n\n@Injectable()\nexport class AddressVerificationEffect {\n  @Effect()\n  verifyAddress$: Observable<\n    CheckoutActions.VerifyAddressSuccess | CheckoutActions.VerifyAddressFail\n  > = this.actions$.pipe(\n    ofType<CheckoutActions.VerifyAddress>(CheckoutActions.VERIFY_ADDRESS),\n    map(action => action.payload),\n    mergeMap(payload =>\n      this.userAddressConnector.verify(payload.userId, payload.address).pipe(\n        map(data => new CheckoutActions.VerifyAddressSuccess(data)),\n        catchError(error =>\n          of(\n            new CheckoutActions.VerifyAddressFail(makeErrorSerializable(error))\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAddressConnector: UserAddressConnector\n  ) {}\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { CheckoutPaymentAdapter } from './checkout-payment.adapter';\nimport { CardType, PaymentDetails } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutPaymentConnector {\n  constructor(protected adapter: CheckoutPaymentAdapter) {}\n\n  public create(\n    userId: string,\n    cartId: string,\n    paymentDetails: PaymentDetails\n  ): Observable<PaymentDetails> {\n    return this.adapter.create(userId, cartId, paymentDetails);\n  }\n\n  public set(\n    userId: string,\n    cartId: string,\n    paymentDetailsId: string\n  ): Observable<any> {\n    return this.adapter.set(userId, cartId, paymentDetailsId);\n  }\n\n  getCardTypes(): Observable<CardType[]> {\n    return this.adapter.loadCardTypes();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CheckoutPaymentConnector } from '../../connectors/payment/checkout-payment.connector';\nimport { CheckoutActions } from '../actions/index';\n\n@Injectable()\nexport class CardTypesEffects {\n  @Effect()\n  loadCardTypes$: Observable<\n    CheckoutActions.LoadCardTypesSuccess | CheckoutActions.LoadCardTypesFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.LOAD_CARD_TYPES),\n    switchMap(() => {\n      return this.checkoutPaymentConnector.getCardTypes().pipe(\n        map(cardTypes => new CheckoutActions.LoadCardTypesSuccess(cardTypes)),\n        catchError(error =>\n          of(\n            new CheckoutActions.LoadCardTypesFail(makeErrorSerializable(error))\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private checkoutPaymentConnector: CheckoutPaymentConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CheckoutAdapter } from './checkout.adapter';\nimport { Order } from '../../../model/order.model';\nimport { CheckoutDetails } from '../../models/checkout.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutConnector {\n  constructor(protected adapter: CheckoutAdapter) {}\n\n  public placeOrder(userId: string, cartId: string): Observable<Order> {\n    return this.adapter.placeOrder(userId, cartId);\n  }\n\n  public loadCheckoutDetails(\n    userId: string,\n    cartId: string\n  ): Observable<CheckoutDetails> {\n    return this.adapter.loadCheckoutDetails(userId, cartId);\n  }\n\n  public clearCheckoutDeliveryAddress(\n    userId: string,\n    cartId: string\n  ): Observable<any> {\n    return this.adapter.clearCheckoutDeliveryAddress(userId, cartId);\n  }\n\n  public clearCheckoutDeliveryMode(\n    userId: string,\n    cartId: string\n  ): Observable<any> {\n    return this.adapter.clearCheckoutDeliveryMode(userId, cartId);\n  }\n}\n","import { Observable } from 'rxjs';\nimport { Injectable } from '@angular/core';\nimport { CheckoutDeliveryAdapter } from './checkout-delivery.adapter';\nimport { Address } from '../../../model/address.model';\nimport { DeliveryMode } from '../../../model/order.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutDeliveryConnector {\n  constructor(protected adapter: CheckoutDeliveryAdapter) {}\n\n  public createAddress(\n    userId: string,\n    cartId: string,\n    address: Address\n  ): Observable<Address> {\n    return this.adapter.createAddress(userId, cartId, address);\n  }\n\n  public setAddress(\n    userId: string,\n    cartId: string,\n    addressId: string\n  ): Observable<any> {\n    return this.adapter.setAddress(userId, cartId, addressId);\n  }\n\n  public setMode(\n    userId: string,\n    cartId: string,\n    deliveryModeId: string\n  ): Observable<any> {\n    return this.adapter.setMode(userId, cartId, deliveryModeId);\n  }\n\n  public getMode(userId: string, cartId: string): Observable<DeliveryMode> {\n    return this.adapter.getMode(userId, cartId);\n  }\n\n  public getSupportedModes(\n    userId: string,\n    cartId: string\n  ): Observable<DeliveryMode[]> {\n    return this.adapter.getSupportedModes(userId, cartId);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { from, Observable, of } from 'rxjs';\nimport {\n  catchError,\n  concatMap,\n  filter,\n  map,\n  mergeMap,\n  switchMap,\n} from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport * as DeprecatedCartActions from '../../../cart/store/actions/cart.action';\nimport { CartActions } from '../../../cart/store/actions/index';\nimport { CheckoutDetails } from '../../../checkout/models/checkout.model';\nimport { GlobalMessageActions } from '../../../global-message/store/actions/index';\nimport {\n  OCC_CART_ID_CURRENT,\n  OCC_USER_ID_ANONYMOUS,\n} from '../../../occ/utils/occ-constants';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { UserActions } from '../../../user/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { withdrawOn } from '../../../util/withdraw-on';\nimport { CheckoutConnector } from '../../connectors/checkout/checkout.connector';\nimport { CheckoutDeliveryConnector } from '../../connectors/delivery/checkout-delivery.connector';\nimport { CheckoutPaymentConnector } from '../../connectors/payment/checkout-payment.connector';\nimport { CheckoutActions } from '../actions/index';\n\n@Injectable()\nexport class CheckoutEffects {\n  private contextChange$ = this.actions$.pipe(\n    ofType(\n      SiteContextActions.CURRENCY_CHANGE,\n      SiteContextActions.LANGUAGE_CHANGE\n    )\n  );\n\n  @Effect()\n  addDeliveryAddress$: Observable<\n    | UserActions.LoadUserAddresses\n    | CheckoutActions.SetDeliveryAddress\n    | CheckoutActions.AddDeliveryAddressFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.ADD_DELIVERY_ADDRESS),\n    map((action: CheckoutActions.AddDeliveryAddress) => action.payload),\n    mergeMap(payload =>\n      this.checkoutDeliveryConnector\n        .createAddress(payload.userId, payload.cartId, payload.address)\n        .pipe(\n          mergeMap(address => {\n            address['titleCode'] = payload.address.titleCode;\n            if (payload.address.region && payload.address.region.isocodeShort) {\n              Object.assign(address.region, {\n                isocodeShort: payload.address.region.isocodeShort,\n              });\n            }\n            if (payload.userId === OCC_USER_ID_ANONYMOUS) {\n              return [\n                new CheckoutActions.SetDeliveryAddress({\n                  userId: payload.userId,\n                  cartId: payload.cartId,\n                  address: address,\n                }),\n              ];\n            } else {\n              return [\n                new UserActions.LoadUserAddresses(payload.userId),\n                new CheckoutActions.SetDeliveryAddress({\n                  userId: payload.userId,\n                  cartId: payload.cartId,\n                  address: address,\n                }),\n              ];\n            }\n          }),\n          catchError(error =>\n            of(\n              new CheckoutActions.AddDeliveryAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    ),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  setDeliveryAddress$: Observable<\n    | CheckoutActions.SetDeliveryAddressSuccess\n    | CheckoutActions.ClearSupportedDeliveryModes\n    | CheckoutActions.ClearCheckoutDeliveryMode\n    | CheckoutActions.ResetLoadSupportedDeliveryModesProcess\n    | CheckoutActions.LoadSupportedDeliveryModes\n    | CheckoutActions.SetDeliveryAddressFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.SET_DELIVERY_ADDRESS),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutDeliveryConnector\n        .setAddress(payload.userId, payload.cartId, payload.address.id)\n        .pipe(\n          mergeMap(() => [\n            new CheckoutActions.SetDeliveryAddressSuccess(payload.address),\n            new CheckoutActions.ClearCheckoutDeliveryMode({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            }),\n            new CheckoutActions.ClearSupportedDeliveryModes(),\n            new CheckoutActions.ResetLoadSupportedDeliveryModesProcess(),\n            new CheckoutActions.LoadSupportedDeliveryModes({\n              userId: payload.userId,\n              cartId: payload.cartId,\n            }),\n          ]),\n          catchError(error =>\n            of(\n              new CheckoutActions.SetDeliveryAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  loadSupportedDeliveryModes$: Observable<\n    | CheckoutActions.LoadSupportedDeliveryModesSuccess\n    | CheckoutActions.LoadSupportedDeliveryModesFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.LOAD_SUPPORTED_DELIVERY_MODES),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutDeliveryConnector\n        .getSupportedModes(payload.userId, payload.cartId)\n        .pipe(\n          map(data => {\n            return new CheckoutActions.LoadSupportedDeliveryModesSuccess(data);\n          }),\n          catchError(error =>\n            of(\n              new CheckoutActions.LoadSupportedDeliveryModesFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  clearCheckoutMiscsDataOnLanguageChange$: Observable<\n    | CheckoutActions.CheckoutClearMiscsData\n    | CheckoutActions.ResetLoadSupportedDeliveryModesProcess\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LANGUAGE_CHANGE),\n    mergeMap(() => [\n      new CheckoutActions.CheckoutClearMiscsData(),\n      new CheckoutActions.ResetLoadSupportedDeliveryModesProcess(),\n    ])\n  );\n\n  @Effect()\n  clearDeliveryModesOnCurrencyChange$: Observable<\n    CheckoutActions.ClearSupportedDeliveryModes\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.CURRENCY_CHANGE),\n    map(() => new CheckoutActions.ClearSupportedDeliveryModes())\n  );\n\n  @Effect()\n  clearCheckoutDataOnLogout$: Observable<\n    CheckoutActions.ClearCheckoutData\n  > = this.actions$.pipe(\n    ofType(AuthActions.LOGOUT),\n    map(() => new CheckoutActions.ClearCheckoutData())\n  );\n\n  @Effect()\n  clearCheckoutDataOnLogin$: Observable<\n    CheckoutActions.ClearCheckoutData\n  > = this.actions$.pipe(\n    ofType(AuthActions.LOGIN),\n    map(() => new CheckoutActions.ClearCheckoutData())\n  );\n\n  @Effect()\n  setDeliveryMode$: Observable<\n    | CheckoutActions.SetDeliveryModeSuccess\n    | CheckoutActions.SetDeliveryModeFail\n    | DeprecatedCartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.SET_DELIVERY_MODE),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutDeliveryConnector\n        .setMode(payload.userId, payload.cartId, payload.selectedModeId)\n        .pipe(\n          mergeMap(() => {\n            return [\n              new CheckoutActions.SetDeliveryModeSuccess(\n                payload.selectedModeId\n              ),\n              new DeprecatedCartActions.LoadCart({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              }),\n            ];\n          }),\n          catchError(error =>\n            of(\n              new CheckoutActions.SetDeliveryModeFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  createPaymentDetails$: Observable<\n    | UserActions.LoadUserPaymentMethods\n    | CheckoutActions.CreatePaymentDetailsSuccess\n    | CheckoutActions.CreatePaymentDetailsFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.CREATE_PAYMENT_DETAILS),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      // get information for creating a subscription directly with payment provider\n      return this.checkoutPaymentConnector\n        .create(payload.userId, payload.cartId, payload.paymentDetails)\n        .pipe(\n          mergeMap(details => {\n            if (payload.userId === OCC_USER_ID_ANONYMOUS) {\n              return [new CheckoutActions.CreatePaymentDetailsSuccess(details)];\n            } else {\n              return [\n                new UserActions.LoadUserPaymentMethods(payload.userId),\n                new CheckoutActions.CreatePaymentDetailsSuccess(details),\n              ];\n            }\n          }),\n          catchError(error =>\n            of(\n              new CheckoutActions.CreatePaymentDetailsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  setPaymentDetails$: Observable<\n    | CheckoutActions.SetPaymentDetailsSuccess\n    | CheckoutActions.SetPaymentDetailsFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.SET_PAYMENT_DETAILS),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutPaymentConnector\n        .set(payload.userId, payload.cartId, payload.paymentDetails.id)\n        .pipe(\n          map(\n            () =>\n              new CheckoutActions.SetPaymentDetailsSuccess(\n                payload.paymentDetails\n              )\n          ),\n          catchError(error =>\n            of(\n              new CheckoutActions.SetPaymentDetailsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  placeOrder$: Observable<\n    | CheckoutActions.PlaceOrderSuccess\n    | GlobalMessageActions.AddMessage\n    | CheckoutActions.PlaceOrderFail\n    | CartActions.RemoveCart\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.PLACE_ORDER),\n    map((action: any) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutConnector\n        .placeOrder(payload.userId, payload.cartId)\n        .pipe(\n          switchMap(data => [\n            new CartActions.RemoveCart(payload.cartId),\n            new CheckoutActions.PlaceOrderSuccess(data),\n          ]),\n          catchError(error =>\n            of(new CheckoutActions.PlaceOrderFail(makeErrorSerializable(error)))\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  loadCheckoutDetails$: Observable<\n    | CheckoutActions.LoadCheckoutDetailsSuccess\n    | CheckoutActions.LoadCheckoutDetailsFail\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.LOAD_CHECKOUT_DETAILS),\n    map((action: CheckoutActions.LoadCheckoutDetails) => action.payload),\n    mergeMap(payload => {\n      return this.checkoutConnector\n        .loadCheckoutDetails(payload.userId, payload.cartId)\n        .pipe(\n          map(\n            (data: CheckoutDetails) =>\n              new CheckoutActions.LoadCheckoutDetailsSuccess(data)\n          ),\n          catchError(error =>\n            of(\n              new CheckoutActions.LoadCheckoutDetailsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  reloadDetailsOnMergeCart$: Observable<\n    CheckoutActions.LoadCheckoutDetails\n  > = this.actions$.pipe(\n    ofType(DeprecatedCartActions.MERGE_CART_SUCCESS),\n    map((action: DeprecatedCartActions.MergeCartSuccess) => action.payload),\n    map(payload => {\n      return new CheckoutActions.LoadCheckoutDetails({\n        userId: payload.userId,\n        cartId: payload.cartId ? payload.cartId : OCC_CART_ID_CURRENT,\n      });\n    })\n  );\n\n  @Effect()\n  clearCheckoutDeliveryAddress$: Observable<\n    | CheckoutActions.ClearCheckoutDeliveryAddressFail\n    | CheckoutActions.ClearCheckoutDeliveryAddressSuccess\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.CLEAR_CHECKOUT_DELIVERY_ADDRESS),\n    map(\n      (action: CheckoutActions.ClearCheckoutDeliveryAddress) => action.payload\n    ),\n    filter(payload => Boolean(payload.cartId)),\n    switchMap(payload => {\n      return this.checkoutConnector\n        .clearCheckoutDeliveryAddress(payload.userId, payload.cartId)\n        .pipe(\n          map(() => new CheckoutActions.ClearCheckoutDeliveryAddressSuccess()),\n          catchError(error =>\n            of(\n              new CheckoutActions.ClearCheckoutDeliveryAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  @Effect()\n  clearCheckoutDeliveryMode$: Observable<\n    | CheckoutActions.ClearCheckoutDeliveryModeFail\n    | CheckoutActions.ClearCheckoutDeliveryModeSuccess\n    | CartActions.CartProcessesDecrement\n    | CartActions.LoadCart\n  > = this.actions$.pipe(\n    ofType(CheckoutActions.CLEAR_CHECKOUT_DELIVERY_MODE),\n    map((action: CheckoutActions.ClearCheckoutDeliveryMode) => action.payload),\n    filter(payload => Boolean(payload.cartId)),\n    concatMap(payload => {\n      return this.checkoutConnector\n        .clearCheckoutDeliveryMode(payload.userId, payload.cartId)\n        .pipe(\n          map(\n            () =>\n              new CheckoutActions.ClearCheckoutDeliveryModeSuccess({\n                userId: payload.userId,\n                cartId: payload.cartId,\n              })\n          ),\n          catchError(error =>\n            from([\n              new CheckoutActions.ClearCheckoutDeliveryModeFail(\n                makeErrorSerializable(error)\n              ),\n              new CartActions.CartProcessesDecrement(payload.cartId),\n              new CartActions.LoadCart({\n                cartId: payload.cartId,\n                userId: payload.userId,\n              }),\n            ])\n          )\n        );\n    }),\n    withdrawOn(this.contextChange$)\n  );\n\n  constructor(\n    private actions$: Actions,\n    private checkoutDeliveryConnector: CheckoutDeliveryConnector,\n    private checkoutPaymentConnector: CheckoutPaymentConnector,\n    private checkoutConnector: CheckoutConnector\n  ) {}\n}\n","import { AddressVerificationEffect } from './address-verification.effect';\nimport { CardTypesEffects } from './card-types.effect';\nimport { CheckoutEffects } from './checkout.effect';\n\nexport const effects: any[] = [\n  CheckoutEffects,\n  AddressVerificationEffect,\n  CardTypesEffects,\n];\n\nexport * from './address-verification.effect';\nexport * from './card-types.effect';\nexport * from './checkout.effect';\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\n\nimport { StoreModule } from '@ngrx/store';\nimport { EffectsModule } from '@ngrx/effects';\n\nimport { reducerToken, reducerProvider } from './reducers/index';\nimport { effects } from './effects/index';\nimport { CHECKOUT_FEATURE } from './checkout-state';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StoreModule.forFeature(CHECKOUT_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [reducerProvider],\n})\nexport class CheckoutStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { PageMetaResolver } from '../cms/page/page-meta.resolver';\nimport { CheckoutService } from './facade/checkout.service';\nimport { CheckoutPageMetaResolver } from './services/checkout-page-meta.resolver';\nimport { CheckoutStoreModule } from './store/checkout-store.module';\n\n@NgModule({\n  imports: [CheckoutStoreModule],\n})\nexport class CheckoutModule {\n  static forRoot(): ModuleWithProviders<CheckoutModule> {\n    return {\n      ngModule: CheckoutModule,\n      providers: [\n        CheckoutService,\n        {\n          provide: PageMetaResolver,\n          useExisting: CheckoutPageMetaResolver,\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport {\n  filter,\n  pluck,\n  shareReplay,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { ActiveCartService } from '../../cart/facade/active-cart.service';\nimport { Address, AddressValidation } from '../../model/address.model';\nimport { DeliveryMode } from '../../model/order.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { getProcessStateFactory } from '../../process/store/selectors/process-group.selectors';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { CheckoutActions } from '../store/actions/index';\nimport {\n  SET_DELIVERY_ADDRESS_PROCESS_ID,\n  SET_DELIVERY_MODE_PROCESS_ID,\n  SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID,\n  StateWithCheckout,\n} from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutDeliveryService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout | StateWithProcess<void>>,\n    protected authService: AuthService,\n    protected activeCartService: ActiveCartService\n  ) {}\n\n  /**\n   * Get supported delivery modes\n   */\n  getSupportedDeliveryModes(): Observable<DeliveryMode[]> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getSupportedDeliveryModes),\n      withLatestFrom(\n        this.checkoutStore.pipe(\n          select(getProcessStateFactory(SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID))\n        )\n      ),\n      tap(([, loadingState]) => {\n        if (\n          !(loadingState.loading || loadingState.success || loadingState.error)\n        ) {\n          this.loadSupportedDeliveryModes();\n        }\n      }),\n      pluck(0),\n      shareReplay({ bufferSize: 1, refCount: true })\n    );\n  }\n\n  /**\n   * Get selected delivery mode\n   */\n  getSelectedDeliveryMode(): Observable<DeliveryMode> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getSelectedDeliveryMode)\n    );\n  }\n\n  /**\n   * Get selected delivery mode code\n   */\n  getSelectedDeliveryModeCode(): Observable<string> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getSelectedDeliveryModeCode)\n    );\n  }\n\n  /**\n   * Get delivery address\n   */\n  getDeliveryAddress(): Observable<Address> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getDeliveryAddress)\n    );\n  }\n\n  /**\n   * Get status about successfully set Delivery Address\n   */\n  getSetDeliveryAddressProcess(): Observable<LoaderState<void>> {\n    return this.checkoutStore.pipe(\n      select(getProcessStateFactory(SET_DELIVERY_ADDRESS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Clear info about process of setting Delivery Address\n   */\n  resetSetDeliveryAddressProcess(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ResetSetDeliveryAddressProcess()\n    );\n  }\n\n  /**\n   * Get status about of set Delivery Mode process\n   */\n  getSetDeliveryModeProcess(): Observable<LoaderState<void>> {\n    return this.checkoutStore.pipe(\n      select(getProcessStateFactory(SET_DELIVERY_MODE_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Clear info about process of setting Delivery Mode\n   */\n  resetSetDeliveryModeProcess(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ResetSetDeliveryModeProcess()\n    );\n  }\n\n  /**\n   * Clear info about process of setting Supported Delivery Modes\n   */\n  resetLoadSupportedDeliveryModesProcess(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ResetLoadSupportedDeliveryModesProcess()\n    );\n  }\n\n  /**\n   * Get status about of set supported Delivery Modes process\n   */\n  getLoadSupportedDeliveryModeProcess(): Observable<LoaderState<void>> {\n    return this.checkoutStore.pipe(\n      select(getProcessStateFactory(SET_SUPPORTED_DELIVERY_MODE_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Clear supported delivery modes loaded in last checkout process\n   */\n  clearCheckoutDeliveryModes(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ClearSupportedDeliveryModes()\n    );\n  }\n\n  /**\n   * Get address verification results\n   */\n  getAddressVerificationResults(): Observable<AddressValidation | string> {\n    return this.checkoutStore.pipe(\n      select(CheckoutSelectors.getAddressVerificationResults),\n      filter(results => Object.keys(results).length !== 0)\n    );\n  }\n\n  /**\n   * Create and set a delivery address using the address param\n   * @param address : the Address to be created and set\n   */\n  createAndSetAddress(address: Address): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.authService\n        .getOccUserId()\n        .subscribe(occUserId => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe(activeCartId => (cartId = activeCartId))\n        .unsubscribe();\n      if (userId && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.AddDeliveryAddress({\n            userId,\n            cartId,\n            address: address,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Load supported delivery modes\n   */\n  loadSupportedDeliveryModes(): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.authService\n        .getOccUserId()\n        .subscribe(occUserId => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe(activeCartId => (cartId = activeCartId))\n        .unsubscribe();\n      if (userId && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.LoadSupportedDeliveryModes({\n            userId,\n            cartId,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Set delivery mode\n   * @param mode : The delivery mode to be set\n   */\n  setDeliveryMode(mode: string): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.authService\n        .getOccUserId()\n        .subscribe(occUserId => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe(activeCartId => (cartId = activeCartId))\n        .unsubscribe();\n      if (userId && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.SetDeliveryMode({\n            userId,\n            cartId,\n            selectedModeId: mode,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Verifies the address\n   * @param address : the address to be verified\n   */\n  verifyAddress(address: Address): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.authService\n        .getOccUserId()\n        .subscribe(occUserId => (userId = occUserId))\n        .unsubscribe();\n      if (userId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.VerifyAddress({\n            userId,\n            address,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Set delivery address\n   * @param address : The address to be set\n   */\n  setDeliveryAddress(address: Address): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.authService\n        .getOccUserId()\n        .subscribe(occUserId => (userId = occUserId))\n        .unsubscribe();\n\n      let cart;\n      this.activeCartService\n        .getActive()\n        .subscribe(activeCart => (cart = activeCart))\n        .unsubscribe();\n      if (cart && userId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.SetDeliveryAddress({\n            userId,\n            cartId: cart.code,\n            address: address,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Clear address verification results\n   */\n  clearAddressVerificationResults(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ClearAddressVerificationResults()\n    );\n  }\n\n  /**\n   * Clear address already setup in last checkout process\n   */\n  clearCheckoutDeliveryAddress(): void {\n    let userId;\n    this.authService\n      .getOccUserId()\n      .subscribe(occUserId => (userId = occUserId))\n      .unsubscribe();\n\n    let cartId;\n    this.activeCartService\n      .getActiveCartId()\n      .subscribe(activeCartId => (cartId = activeCartId))\n      .unsubscribe();\n    if (userId && cartId) {\n      this.checkoutStore.dispatch(\n        new CheckoutActions.ClearCheckoutDeliveryAddress({\n          userId,\n          cartId,\n        })\n      );\n    }\n  }\n\n  /**\n   * Clear selected delivery mode setup in last checkout process\n   */\n  clearCheckoutDeliveryMode(): void {\n    let userId;\n    this.authService\n      .getOccUserId()\n      .subscribe(occUserId => (userId = occUserId))\n      .unsubscribe();\n\n    let cartId;\n    this.activeCartService\n      .getActiveCartId()\n      .subscribe(activeCartId => (cartId = activeCartId))\n      .unsubscribe();\n    if (userId && cartId) {\n      this.checkoutStore.dispatch(\n        new CheckoutActions.ClearCheckoutDeliveryMode({\n          userId,\n          cartId,\n        })\n      );\n    }\n  }\n\n  /**\n   * Clear address and delivery mode already setup in last checkout process\n   */\n  clearCheckoutDeliveryDetails(): void {\n    this.clearCheckoutDeliveryAddress();\n    this.clearCheckoutDeliveryMode();\n    this.clearCheckoutDeliveryModes();\n  }\n\n  protected actionAllowed(): boolean {\n    let userId;\n    this.authService\n      .getOccUserId()\n      .subscribe(occUserId => (userId = occUserId))\n      .unsubscribe();\n    return (\n      (userId && userId !== OCC_USER_ID_ANONYMOUS) ||\n      this.activeCartService.isGuestCart()\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { ActiveCartService } from '../../cart/facade/active-cart.service';\nimport { CardType, PaymentDetails } from '../../model/cart.model';\nimport { OCC_USER_ID_ANONYMOUS } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { getProcessStateFactory } from '../../process/store/selectors/process-group.selectors';\nimport { LoaderState } from '../../state/utils/loader/loader-state';\nimport { CheckoutActions } from '../store/actions/index';\nimport {\n  SET_PAYMENT_DETAILS_PROCESS_ID,\n  StateWithCheckout,\n} from '../store/checkout-state';\nimport { CheckoutSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CheckoutPaymentService {\n  constructor(\n    protected checkoutStore: Store<StateWithCheckout | StateWithProcess<void>>,\n    protected authService: AuthService,\n    protected activeCartService: ActiveCartService\n  ) {}\n\n  /**\n   * Get card types\n   */\n  getCardTypes(): Observable<CardType[]> {\n    return this.checkoutStore.pipe(select(CheckoutSelectors.getAllCardTypes));\n  }\n\n  /**\n   * Get payment details\n   */\n  getPaymentDetails(): Observable<PaymentDetails> {\n    return this.checkoutStore.pipe(select(CheckoutSelectors.getPaymentDetails));\n  }\n\n  /**\n   * Get status about set Payment Details process\n   */\n  getSetPaymentDetailsResultProcess(): Observable<LoaderState<void>> {\n    return this.checkoutStore.pipe(\n      select(getProcessStateFactory(SET_PAYMENT_DETAILS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Clear info about process of setting Payment Details\n   */\n  resetSetPaymentDetailsProcess(): void {\n    this.checkoutStore.dispatch(\n      new CheckoutActions.ResetSetPaymentDetailsProcess()\n    );\n  }\n\n  /**\n   * Load the supported card types\n   */\n  loadSupportedCardTypes(): void {\n    this.checkoutStore.dispatch(new CheckoutActions.LoadCardTypes());\n  }\n\n  /**\n   * Create payment details using the given paymentDetails param\n   * @param paymentDetails: the PaymentDetails to be created\n   */\n  createPaymentDetails(paymentDetails: PaymentDetails): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.authService\n        .getOccUserId()\n        .subscribe(occUserId => (userId = occUserId))\n        .unsubscribe();\n\n      let cartId;\n      this.activeCartService\n        .getActiveCartId()\n        .subscribe(activeCartId => (cartId = activeCartId))\n        .unsubscribe();\n\n      if (userId && cartId) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.CreatePaymentDetails({\n            userId,\n            cartId,\n            paymentDetails,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Set payment details\n   * @param paymentDetails : the PaymentDetails to be set\n   */\n  setPaymentDetails(paymentDetails: PaymentDetails): void {\n    if (this.actionAllowed()) {\n      let userId;\n      this.authService\n        .getOccUserId()\n        .subscribe(occUserId => (userId = occUserId))\n        .unsubscribe();\n\n      let cart;\n      this.activeCartService\n        .getActive()\n        .subscribe(activeCart => (cart = activeCart))\n        .unsubscribe();\n      if (userId && cart) {\n        this.checkoutStore.dispatch(\n          new CheckoutActions.SetPaymentDetails({\n            userId,\n            cartId: cart.code,\n            paymentDetails: paymentDetails,\n          })\n        );\n      }\n    }\n  }\n\n  /**\n   * Sets payment loading to true without having the flicker issue (GH-3102)\n   */\n  paymentProcessSuccess() {\n    this.checkoutStore.dispatch(new CheckoutActions.PaymentProcessSuccess());\n  }\n\n  protected actionAllowed(): boolean {\n    let userId;\n    this.authService\n      .getOccUserId()\n      .subscribe(occUserId => (userId = occUserId))\n      .unsubscribe();\n    return (\n      (userId && userId !== OCC_USER_ID_ANONYMOUS) ||\n      this.activeCartService.isGuestCart()\n    );\n  }\n}\n","import { ContentSlotComponentData } from '../model/content-slot-component-data.model';\nimport { CmsConfig } from './cms-config';\n\n/**\n * The `CmsPageConfig` is used to build pages by configuration.\n * The interfaces are designed to have a clean configuration for\n * static CMS structure. Ordinary attributes that are not\n * required for configurable pages have been left out and\n * will not be serialized in the adapter logic.\n */\nexport interface CmsPageConfig {\n  /**\n   * When the `ignoreBackend` is set to true, the CMS backend\n   * will not be consumed. This saves network latency and is\n   * useful for commodity commerce pages.\n   * */\n  ignoreBackend?: boolean;\n\n  pageId?: string;\n\n  type?: string;\n\n  /**\n   * The page title is typically used to display the page heading\n   * as well as for the page title tag. The latter is used for browser\n   * navigation as well as SEO and social share platforms.\n   */\n  title?: string;\n\n  /**\n   * the template is used to bind to the layout\n   * configuration and css layout class\n   */\n  template?: string;\n\n  /**\n   * The page slots represent various sections on the page that\n   * can contain components.\n   */\n  slots: { [key: string]: CmsPageSlotConfig };\n}\n\n/**\n * The `CmsPageSlotsConfig` (plural) holds `CmsPageSlotConfig` objects.\n */\nexport interface CmsPageSlotsConfig {\n  [key: string]: CmsPageSlotConfig;\n}\n\n/**\n * The `CmsPageSlotConfig` is a simplified configuration model\n * that can be used to configure slots in static configuration,\n * rather than loading from a backend.\n */\nexport interface CmsPageSlotConfig {\n  componentIds?: string[];\n  properties?: any;\n}\n\n/**\n * The `CmsStructureConfig` is used to build pages in Spartacus by configuration\n * instead of using a backend CMS system. The configuration can be used to build\n * complete pages or parts of a page. The `CmsStructureConfig` is optimized to\n * only require the necessary properties. Adapter logic is applied to serialize\n * the `CmsStructureConfig` into the required UI model.\n */\nexport abstract class CmsStructureConfig extends CmsConfig {\n  cmsStructure: {\n    components?: { [key: string]: ContentSlotComponentData | any };\n    pages?: CmsPageConfig[];\n    slots?: CmsPageSlotsConfig;\n  };\n}\n","import { CmsConfig } from './cms-config';\n\nexport const defaultCmsModuleConfig: CmsConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        component: 'cms/components/${id}',\n        components: 'cms/components',\n        pages: 'cms/pages',\n        page: 'cms/pages/${id}',\n      },\n      legacy: false,\n    },\n  },\n  cmsComponents: {},\n};\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { CmsService } from '../facade/cms.service';\nimport { Page, PageMeta } from '../model/page.model';\nimport { PageMetaResolver } from './page-meta.resolver';\nimport { PageBreadcrumbResolver, PageTitleResolver } from './page.resolvers';\n\n/**\n * Resolves the page data for all Content Pages based on the `PageType.CONTENT_PAGE`.\n * More specific resolvers for content pages can be implemented by making them more\n * specific, for example by using the page template (see `CartPageMetaResolver`).\n *\n * The page title, and breadcrumbs are resolved in this implementation only.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ContentPageMetaResolver extends PageMetaResolver\n  implements PageTitleResolver, PageBreadcrumbResolver {\n  private cms$: Observable<Page> = this.cms\n    .getCurrentPage()\n    .pipe(filter(p => !!p));\n\n  constructor(\n    protected cms: CmsService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n  }\n\n  /**\n   * @deprecated since version 1.3\n   *\n   * The resolve method is no longer preferred and will be removed with release 2.0.\n   * The caller `PageMetaService` service is improved to expect all individual resolvers\n   * instead, so that the code is easier extensible.\n   */\n  resolve(): Observable<PageMeta> | any {\n    return this.cms$.pipe(\n      switchMap((page: Page) =>\n        combineLatest([\n          this.resolveTitle(page),\n          this.resolveBreadcrumbLabel().pipe(\n            switchMap(label => this.resolveBreadcrumbs(page, label))\n          ),\n        ])\n      ),\n      map(([title, breadcrumbs]: [string, any[]]) => ({ title, breadcrumbs }))\n    );\n  }\n\n  resolveTitle(): Observable<string>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveTitle()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveTitle(page: Page): Observable<string>;\n  resolveTitle(page?: Page): Observable<string> {\n    return page ? of(page.title) : this.cms$.pipe(map(p => p.title));\n  }\n\n  /**\n   * @deprecated since version 1.3\n   * This method will removed with with 2.0\n   */\n  resolveBreadcrumbLabel(): Observable<string> {\n    return this.translation.translate('common.home');\n  }\n\n  resolveBreadcrumbs(): Observable<any[]>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveBreadcrumbs()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveBreadcrumbs(_page: Page, breadcrumbLabel: string): Observable<any[]>;\n  resolveBreadcrumbs(\n    _page?: Page,\n    breadcrumbLabel?: string\n  ): Observable<any[]> {\n    if (breadcrumbLabel) {\n      return of([{ label: breadcrumbLabel, link: '/' }]);\n    } else {\n      return this.translation\n        .translate('common.home')\n        .pipe(map(label => [{ label: label, link: '/' }]));\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { PageMetaResolver } from './page-meta.resolver';\nimport { ContentPageMetaResolver } from './content-page-meta.resolver';\n\n@NgModule({\n  providers: [\n    {\n      provide: PageMetaResolver,\n      useExisting: ContentPageMetaResolver,\n      multi: true,\n    },\n  ],\n})\nexport class CmsPageTitleModule {}\n","import { Observable, OperatorFunction, SchedulerLike } from 'rxjs';\nimport { debounceTime, map, tap } from 'rxjs/operators';\n\nexport function bufferDebounceTime<T>(\n  time: number = 0,\n  scheduler?: SchedulerLike\n): OperatorFunction<T, T[]> {\n  return (source: Observable<T>) => {\n    let bufferedValues: T[] = [];\n\n    return source.pipe(\n      tap(value => bufferedValues.push(value)),\n      debounceTime(time, scheduler),\n      map(() => bufferedValues),\n      tap(() => (bufferedValues = []))\n    );\n  };\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport {\n  CmsPageConfig,\n  CmsPageSlotsConfig,\n  CmsStructureConfig,\n} from '../config/cms-structure.config';\nimport { ContentSlotComponentData } from '../model/content-slot-component-data.model';\nimport { CmsStructureModel } from '../model/page.model';\n\n/**\n * Service that provides access to CMS structure from a static\n * configuration or configuration file. This class uses static\n * configuration is designed in async fashion so that configurations\n * can be loaded from a file or stream.\n *\n * The intent of the `CmsStructureConfigService` however is to provide\n * fast loading pages and default cms structure for commodity commerce.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport abstract class CmsStructureConfigService {\n  constructor(protected cmsDataConfig: CmsStructureConfig) {}\n\n  /**\n   * Merge the cms structure to the pageStructure. The page structure\n   * can either hold complete page structures or global structures that\n   * might apply to all pages (such has header coponents).\n   */\n  mergePageStructure(\n    pageId: string,\n    pageStructure: CmsStructureModel\n  ): Observable<CmsStructureModel> {\n    return this.mergePage(pageId, pageStructure).pipe(\n      switchMap(page => this.mergeSlots(page))\n    );\n  }\n\n  /**\n   *\n   * Returns boolean observable to indicate whether the page should not be\n   * loaded from the backend. This is useful for pages which are comoditized\n   * and follow best practice.\n   *\n   * By default, configurable pages are driven by static configuration,\n   * in order to allow for fast loading pages (preventing network delays).\n   */\n  shouldIgnoreBackend(pageId: string): Observable<boolean> {\n    return this.getPageFromConfig(pageId).pipe(\n      map(page => !!page && !!page.ignoreBackend)\n    );\n  }\n\n  /**\n   * returns an Observable component data from the static configuration.\n   */\n  getComponentFromConfig(\n    componentId: string\n  ): Observable<ContentSlotComponentData | any> {\n    return of(this.getComponentById(componentId));\n  }\n\n  /**\n   * returns an Observable components data from the static configuration.\n   */\n  getComponentsFromConfig(\n    ids: string[]\n  ): Observable<ContentSlotComponentData[]> {\n    return of(ids.map(id => this.getComponentById(id)));\n  }\n\n  /**\n   * returns an observable with the `PageConfig`.\n   */\n  protected getPageFromConfig(pageId: string): Observable<CmsPageConfig> {\n    return of(\n      this.cmsDataConfig.cmsStructure && this.cmsDataConfig.cmsStructure.pages\n        ? this.cmsDataConfig.cmsStructure.pages.find(p => p.pageId === pageId)\n        : null\n    );\n  }\n\n  /**\n   * Merge page data from the configuration into the given structure, if any.\n   * If the given page structure is empty, a page is created and the page slots are\n   * are merged into the page.\n   */\n  protected mergePage(\n    pageId: string,\n    pageStructure: CmsStructureModel\n  ): Observable<CmsStructureModel> {\n    return this.getPageFromConfig(pageId).pipe(\n      switchMap(page => {\n        if (page) {\n          // serialize page data\n          if (!pageStructure.page) {\n            pageStructure.page = {\n              ...page,\n            };\n            pageStructure.page.slots = {};\n          }\n          if (!pageStructure.page.slots) {\n            pageStructure.page.slots = {};\n          }\n          return this.mergeSlots(pageStructure, page.slots);\n        } else {\n          return of(pageStructure);\n        }\n      })\n    );\n  }\n\n  /**\n   * Adds any pre-configured slots for pages that do not use them.\n   * If pages have a slot for the given position, the configiuration\n   * is ingored. Even if the slot does not have inner structure (such as\n   * components), so that the cms structure is able to override the (static)\n   * configuration.\n   */\n  protected mergeSlots(\n    pageStructure: CmsStructureModel,\n    slots?: CmsPageSlotsConfig\n  ): Observable<CmsStructureModel> {\n    // if no slots have been given, we use the global configured slots\n    if (\n      !slots &&\n      this.cmsDataConfig.cmsStructure &&\n      this.cmsDataConfig.cmsStructure.slots\n    ) {\n      slots = this.cmsDataConfig.cmsStructure.slots;\n    }\n\n    if (!slots) {\n      return of(pageStructure);\n    }\n\n    for (const position of Object.keys(slots)) {\n      if (!Object.keys(pageStructure.page.slots).includes(position)) {\n        // the global slot isn't yet part of the page structure\n        pageStructure.page.slots[position] = {};\n\n        for (const component of this.getComponentsByPosition(slots, position)) {\n          if (!pageStructure.page.slots[position].components) {\n            pageStructure.page.slots[position].components = [];\n          }\n          pageStructure.page.slots[position].components.push({\n            uid: component.uid,\n            flexType: component.flexType,\n            typeCode: component.typeCode,\n          });\n          if (!pageStructure.components) {\n            pageStructure.components = [];\n          }\n\n          pageStructure.components.push(component);\n        }\n      }\n    }\n\n    return of(pageStructure);\n  }\n\n  protected getComponentsByPosition(\n    slots: CmsPageSlotsConfig,\n    position: string\n  ): ContentSlotComponentData[] {\n    const components = [];\n    if (slots[position] && slots[position].componentIds) {\n      for (const componentId of slots[position].componentIds) {\n        if (\n          this.cmsDataConfig.cmsStructure &&\n          this.cmsDataConfig.cmsStructure.components\n        ) {\n          const component = this.cmsDataConfig.cmsStructure.components[\n            componentId\n          ];\n          if (component) {\n            components.push({ uid: componentId, ...component });\n          }\n        }\n      }\n    }\n    return components;\n  }\n\n  protected getComponentById(componentId: string): ContentSlotComponentData {\n    return this.cmsDataConfig.cmsStructure &&\n      this.cmsDataConfig.cmsStructure.components\n      ? this.cmsDataConfig.cmsStructure.components[componentId]\n      : undefined;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { OccConfig } from '../../../occ/config/occ-config';\nimport { PageContext } from '../../../routing/models/page-context.model';\nimport { CmsStructureConfigService } from '../../services/cms-structure-config.service';\nimport { CmsComponentAdapter } from './cms-component.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CmsComponentConnector {\n  constructor(\n    protected cmsStructureConfigService: CmsStructureConfigService,\n    protected adapter: CmsComponentAdapter,\n    protected config: OccConfig\n  ) {}\n\n  get<T extends CmsComponent>(\n    id: string,\n    pageContext: PageContext\n  ): Observable<T> {\n    return this.cmsStructureConfigService\n      .getComponentFromConfig(id)\n      .pipe(\n        switchMap(configuredComponent =>\n          configuredComponent\n            ? of(configuredComponent)\n            : this.adapter.load(id, pageContext)\n        )\n      );\n  }\n\n  getList(ids: string[], pageContext: PageContext): Observable<CmsComponent[]> {\n    return this.cmsStructureConfigService.getComponentsFromConfig(ids).pipe(\n      switchMap(configuredComponents => {\n        // check if we have some components that are not loaded from configuration\n        const missingIds = configuredComponents.reduce(\n          (acc, component, index) => {\n            if (component === undefined) {\n              acc.push(ids[index]);\n            }\n            return acc;\n          },\n          []\n        );\n\n        if (missingIds.length > 0) {\n          return (this.config.backend.occ.legacy\n            ? this.adapter.findComponentsByIdsLegacy(missingIds, pageContext)\n            : this.adapter.findComponentsByIds(missingIds, pageContext)\n          ).pipe(\n            map(loadedComponents => [\n              ...configuredComponents.filter(Boolean),\n              ...loadedComponents,\n            ])\n          );\n        } else {\n          return of(configuredComponents);\n        }\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, createEffect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { from, merge, Observable, of } from 'rxjs';\nimport { catchError, groupBy, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { FeatureConfigService } from '../../../features-config/services/feature-config.service';\nimport { CmsComponent } from '../../../model/cms.model';\nimport { PageContext } from '../../../routing/index';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { bufferDebounceTime } from '../../../util/buffer-debounce-time';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { withdrawOn } from '../../../util/withdraw-on';\nimport { CmsComponentConnector } from '../../connectors/component/cms-component.connector';\nimport { serializePageContext } from '../../utils/cms-utils';\nimport { CmsActions } from '../actions/index';\n\n@Injectable()\nexport class ComponentsEffects {\n  constructor(\n    private actions$: Actions,\n    private cmsComponentLoader: CmsComponentConnector,\n    private featureConfigService: FeatureConfigService\n  ) {}\n\n  private contextChange$: Observable<Action> = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      AuthActions.LOGOUT,\n      AuthActions.LOGIN\n    )\n  );\n\n  loadComponent$ = createEffect(\n    () => ({ scheduler, debounce = 0 } = {}): Observable<\n      | CmsActions.LoadCmsComponentSuccess<CmsComponent>\n      | CmsActions.LoadCmsComponentFail\n    > =>\n      this.actions$.pipe(\n        ofType<CmsActions.LoadCmsComponent>(CmsActions.LOAD_CMS_COMPONENT),\n        groupBy(actions => serializePageContext(actions.payload.pageContext)),\n        mergeMap(actionGroup =>\n          actionGroup.pipe(\n            bufferDebounceTime(debounce, scheduler),\n            mergeMap(actions =>\n              this.loadComponentsEffect(\n                actions.map(action => action.payload.uid),\n                actions[0].payload.pageContext\n              )\n            )\n          )\n        ),\n        withdrawOn(this.contextChange$)\n      )\n  );\n\n  private loadComponentsEffect(\n    componentUids: string[],\n    pageContext: PageContext\n  ): Observable<\n    | CmsActions.LoadCmsComponentSuccess<CmsComponent>\n    | CmsActions.LoadCmsComponentFail\n  > {\n    // TODO: remove, deprecated behavior since 1.4\n    if (!this.featureConfigService.isLevel('1.4')) {\n      return merge(\n        ...componentUids.map(uid =>\n          this.cmsComponentLoader.get(uid, pageContext).pipe(\n            map(\n              component =>\n                new CmsActions.LoadCmsComponentSuccess({\n                  component,\n                  uid: component.uid,\n                  pageContext,\n                })\n            ),\n            catchError(error =>\n              of(\n                new CmsActions.LoadCmsComponentFail({\n                  uid,\n                  error: makeErrorSerializable(error),\n                  pageContext,\n                })\n              )\n            )\n          )\n        )\n      );\n    }\n    // END OF (TODO: remove, deprecated behavior since 1.4)\n\n    return this.cmsComponentLoader.getList(componentUids, pageContext).pipe(\n      switchMap(components =>\n        from(\n          components.map(\n            component =>\n              new CmsActions.LoadCmsComponentSuccess({\n                component,\n                uid: component.uid,\n                pageContext,\n              })\n          )\n        )\n      ),\n      catchError(error =>\n        from(\n          componentUids.map(\n            uid =>\n              new CmsActions.LoadCmsComponentFail({\n                uid,\n                error: makeErrorSerializable(error),\n                pageContext,\n              })\n          )\n        )\n      )\n    );\n  }\n}\n","/**\n * @license\n * The MIT License\n * Copyright (c) 2010-2019 Google LLC. http://angular.io/license\n *\n * See:\n * - https://github.com/angular/angular/blob/6f5f481fdae03f1d8db36284b64c7b82d9519d85/packages/service-worker/config/src/glob.ts\n * - https://github.com/angular/angular/blob/6f5f481fdae03f1d8db36284b64c7b82d9519d85/aio/tests/deployment/shared/helpers.ts#L17\n * - https://github.com/angular/angular/blob/6f5f481fdae03f1d8db36284b64c7b82d9519d85/packages/service-worker/config/src/generator.ts#L86\n */\n\nconst QUESTION_MARK = '[^/]';\nconst WILD_SINGLE = '[^/]*';\nconst WILD_OPEN = '(?:.+\\\\/)?';\nconst TO_ESCAPE_BASE = [\n  { replace: /\\./g, with: '\\\\.' },\n  { replace: /\\+/g, with: '\\\\+' },\n  { replace: /\\*/g, with: WILD_SINGLE },\n];\nconst TO_ESCAPE_WILDCARD_QM = [\n  ...TO_ESCAPE_BASE,\n  { replace: /\\?/g, with: QUESTION_MARK },\n];\nconst TO_ESCAPE_LITERAL_QM = [\n  ...TO_ESCAPE_BASE,\n  { replace: /\\?/g, with: '\\\\?' },\n];\n\n/**\n * Converts the glob-like pattern into regex string.\n *\n * Patterns use a limited glob format:\n * `**` matches 0 or more path segments\n * `*` matches 0 or more characters excluding `/`\n * `?` matches exactly one character excluding `/` (but when @param literalQuestionMark is true, `?` is treated as normal character)\n * The `!` prefix marks the pattern as being negative, meaning that only URLs that don't match the pattern will be included\n *\n * @param glob glob-like pattern\n * @param literalQuestionMark when true, it tells that `?` is treated as a normal character\n */\nexport function globToRegex(glob: string, literalQuestionMark = false): string {\n  const toEscape = literalQuestionMark\n    ? TO_ESCAPE_LITERAL_QM\n    : TO_ESCAPE_WILDCARD_QM;\n  const segments = glob.split('/').reverse();\n  let regex = '';\n  while (segments.length > 0) {\n    const segment = segments.pop();\n    if (segment === '**') {\n      if (segments.length > 0) {\n        regex += WILD_OPEN;\n      } else {\n        regex += '.*';\n      }\n    } else {\n      const processed = toEscape.reduce(\n        (seg, escape) => seg.replace(escape.replace, escape.with),\n        segment\n      );\n      regex += processed;\n      if (segments.length > 0) {\n        regex += '\\\\/';\n      }\n    }\n  }\n  return regex;\n}\n\n/**\n * For given list of glob-like patterns, returns a matcher function.\n *\n * The matcher returns true for given URL only when ANY of the positive patterns is matched and NONE of the negative ones.\n */\nexport function getGlobMatcher(patterns: string[]): (url: string) => boolean {\n  const processedPatterns: {\n    positive: boolean;\n    regex: RegExp;\n  }[] = processGlobPatterns(patterns).map(({ positive, regex }) => ({\n    positive,\n    regex: new RegExp(regex),\n  }));\n\n  const includePatterns = processedPatterns.filter(spec => spec.positive);\n  const excludePatterns = processedPatterns.filter(spec => !spec.positive);\n\n  return (url: string) =>\n    includePatterns.some(pattern => pattern.regex.test(url)) &&\n    !excludePatterns.some(pattern => pattern.regex.test(url));\n}\n\n/**\n * Converts list of glob-like patterns into list of RegExps with information whether the glob pattern is positive or negative\n */\nexport function processGlobPatterns(\n  urls: string[]\n): { positive: boolean; regex: string }[] {\n  return urls.map(url => {\n    const positive = !url.startsWith('!');\n    url = positive ? url : url.substr(1);\n    return { positive, regex: `^${globToRegex(url)}$` };\n  });\n}\n","import { Injectable } from '@angular/core';\nimport { processGlobPatterns } from './glob-utils';\n\n@Injectable({ providedIn: 'root' })\nexport class GlobService {\n  /**\n   * For given list of glob-like patterns, returns a validator function.\n   *\n   * The validator returns true for given URL only when ANY of the positive patterns is matched and NONE of the negative ones.\n   */\n  getValidator(patterns: string[]): (url: string) => boolean {\n    const processedPatterns: {\n      positive: boolean;\n      regex: RegExp;\n    }[] = processGlobPatterns(patterns).map(({ positive, regex }) => ({\n      positive,\n      regex: new RegExp(regex),\n    }));\n\n    const includePatterns = processedPatterns.filter(spec => spec.positive);\n    const excludePatterns = processedPatterns.filter(spec => !spec.positive);\n\n    return (url: string) =>\n      includePatterns.some(pattern => pattern.regex.test(url)) &&\n      !excludePatterns.some(pattern => pattern.regex.test(url));\n  }\n}\n","import { Injectable, isDevMode } from '@angular/core';\nimport {\n  Route,\n  UrlMatcher,\n  UrlMatchResult,\n  UrlSegment,\n  UrlSegmentGroup,\n} from '@angular/router';\nimport { GlobService } from '../../util/glob.service';\n\n@Injectable({ providedIn: 'root' })\nexport class UrlMatcherService {\n  constructor(protected globService: GlobService) {}\n\n  /**\n   * Returns a matcher that is always fails\n   */\n  getFalsy(): UrlMatcher {\n    return function falsyUrlMatcher(): null {\n      return null;\n    };\n  }\n\n  /**\n   * Returns a matcher for given list of paths\n   */\n  getFromPaths(paths: string[]): UrlMatcher {\n    const matchers = paths.map(path => this.getFromPath(path));\n    const matcher = this.getCombined(matchers);\n    if (isDevMode()) {\n      matcher['_paths'] = paths; // property added for easier debugging of routes\n    }\n    return matcher;\n  }\n\n  /**\n   * Returns a matcher that combines the given matchers\n   * */\n  getCombined(matchers: UrlMatcher[]): UrlMatcher {\n    const matcher = function combinedUrlMatchers(\n      segments: UrlSegment[],\n      segmentGroup: UrlSegmentGroup,\n      route: Route\n    ): UrlMatchResult | null {\n      for (let i = 0; i < matchers.length; i++) {\n        const result = matchers[i](segments, segmentGroup, route);\n        if (result) {\n          return result;\n        }\n      }\n      return null;\n    };\n    if (isDevMode()) {\n      matcher['_matchers'] = matchers; // property added for easier debugging of routes\n    }\n    return matcher;\n  }\n\n  /**\n   * Similar to Angular's defaultUrlMatcher. Differences:\n   * - the `path` comes from function's argument, not from `route.path`\n   * - the empty path `''` is handled here, but in Angular is handled one level higher in the match() function\n   */\n  protected getFromPath(path: string = ''): UrlMatcher {\n    const matcher = function pathUrlMatcher(\n      segments: UrlSegment[],\n      segmentGroup: UrlSegmentGroup,\n      route: Route\n    ): UrlMatchResult | null {\n      /**\n       * @license\n       * The MIT License\n       * Copyright (c) 2010-2019 Google LLC. http://angular.io/license\n       *\n       * See:\n       * - https://github.com/angular/angular/blob/6f5f481fdae03f1d8db36284b64c7b82d9519d85/packages/router/src/shared.ts#L121\n       */\n\n      // use function's argument, not the `route.path`\n      if (path === '') {\n        if (\n          route.pathMatch === 'full' &&\n          (segmentGroup.hasChildren() || segments.length > 0)\n        ) {\n          return null;\n        }\n        return { consumed: [], posParams: {} };\n      }\n\n      const parts = path.split('/'); // use function's argument, not the `route.path`\n\n      if (parts.length > segments.length) {\n        // The actual URL is shorter than the config, no match\n        return null;\n      }\n\n      if (\n        route.pathMatch === 'full' &&\n        (segmentGroup.hasChildren() || parts.length < segments.length)\n      ) {\n        // The config is longer than the actual URL but we are looking for a full match, return null\n        return null;\n      }\n\n      const posParams: { [key: string]: UrlSegment } = {};\n\n      // Check each config part against the actual URL\n      for (let index = 0; index < parts.length; index++) {\n        const part = parts[index];\n        const segment = segments[index];\n        const isParameter = part.startsWith(':');\n        if (isParameter) {\n          posParams[part.substring(1)] = segment;\n        } else if (part !== segment.path) {\n          // The actual URL part does not match the config, no match\n          return null;\n        }\n      }\n\n      return { consumed: segments.slice(0, parts.length), posParams };\n    };\n    if (isDevMode()) {\n      matcher['_path'] = path; // property added for easier debugging of routes\n    }\n    return matcher;\n  }\n\n  /**\n   * Returns URL matcher that accepts almost everything (like `**` route), but not paths accepted by the given matcher\n   */\n  getOpposite(originalMatcher: UrlMatcher): UrlMatcher {\n    const matcher = function oppositeUrlMatcher(\n      segments: UrlSegment[],\n      group: UrlSegmentGroup,\n      route: Route\n    ) {\n      return originalMatcher(segments, group, route)\n        ? null\n        : { consumed: segments, posParams: {} };\n    };\n    if (isDevMode()) {\n      matcher['_originalMatcher'] = originalMatcher; // property added for easier debugging of routes\n    }\n    return matcher;\n  }\n\n  /**\n   * Returns URL matcher for the given list of glob-like patterns. Each pattern must start with `/` or `!/`.\n   */\n  getFromGlob(globPatterns: string[]): UrlMatcher {\n    const globValidator = this.globService.getValidator(globPatterns);\n\n    const matcher = function globUrlMatcher(\n      segments: UrlSegment[]\n    ): UrlMatchResult | null {\n      const fullPath = `/${segments.map(s => s.path).join('/')}`;\n\n      return globValidator(fullPath)\n        ? { consumed: segments, posParams: {} }\n        : null;\n    };\n    if (isDevMode()) {\n      matcher['_globPatterns'] = globPatterns; // property added for easier debugging of routes\n    }\n    return matcher;\n  }\n}\n","import { Injectable, InjectionToken, Injector, isDevMode } from '@angular/core';\nimport { Route, Router, Routes, UrlMatcher } from '@angular/router';\nimport { UrlMatcherService } from '../services/url-matcher.service';\nimport { UrlMatcherFactory } from '../url-matcher/url-matcher-factory';\nimport { RouteConfig } from './routes-config';\nimport { RoutingConfigService } from './routing-config.service';\n\n@Injectable({ providedIn: 'root' })\nexport class ConfigurableRoutesService {\n  constructor(\n    protected injector: Injector,\n    protected routingConfigService: RoutingConfigService,\n    protected urlMatcherService: UrlMatcherService\n  ) {}\n\n  protected initCalled = false; // guard not to call init() more than once\n\n  /**\n   * Enhances existing Angular routes using the routing config of Spartacus.\n   * Can be called only once.\n   */\n  init(): void {\n    if (!this.initCalled) {\n      this.initCalled = true;\n\n      this.configure();\n    }\n  }\n\n  /**\n   * Enhances existing Angular routes using the routing config of Spartacus.\n   */\n  protected configure(): void {\n    // Router could not be injected in constructor due to cyclic dependency with APP_INITIALIZER:\n    const router = this.injector.get(Router);\n    router.resetConfig(this.configureRoutes(router.config));\n  }\n\n  /**\n   * Sets the property `path` or `matcher` for the given routes, based on the Spartacus' routing configuration.\n   *\n   * @param routes list of Angular `Route` objects\n   */\n  protected configureRoutes(routes: Routes): Routes {\n    return routes.map(route => {\n      const configuredRoute = this.configureRoute(route);\n\n      if (route.children && route.children.length) {\n        configuredRoute.children = this.configureRoutes(route.children);\n      }\n      return configuredRoute;\n    });\n  }\n\n  /**\n   * Sets the property `path` or `matcher` of the `Route`, based on the Spartacus' routing configuration.\n   * Uses the property `data.cxRoute` to determine the name of the route.\n   * It's the same name used as a key in the routing configuration: `routing.routes[ROUTE NAME]`.\n   *\n   * @param route Angular `Route` object\n   */\n  protected configureRoute(route: Route): Route {\n    const routeName = this.getRouteName(route);\n    if (routeName) {\n      const routeConfig = this.routingConfigService.getRouteConfig(routeName);\n      this.validateRouteConfig(routeConfig, routeName, route);\n\n      if (routeConfig?.disabled) {\n        delete route.path;\n        return {\n          ...route,\n          matcher: this.urlMatcherService.getFalsy(),\n        };\n      } else if (routeConfig?.matchers) {\n        delete route.path;\n        return {\n          ...route,\n          matcher: this.resolveUrlMatchers(route, routeConfig?.matchers),\n        };\n      } else if (routeConfig?.paths?.length === 1) {\n        delete route.matcher;\n        return { ...route, path: routeConfig?.paths[0] };\n      } else {\n        delete route.path;\n        return {\n          ...route,\n          matcher: this.urlMatcherService.getFromPaths(\n            routeConfig?.paths || []\n          ),\n        };\n      }\n    }\n    return route; // if route doesn't have a name, just pass the original route\n  }\n\n  /**\n   * Creates a single `UrlMatcher` based on given matchers and factories of matchers.\n   *\n   * @param route Route object\n   * @param matchersOrFactories `UrlMatcher`s or injection tokens with a factory functions\n   *  that create UrlMatchers based on the given route.\n   */\n  protected resolveUrlMatchers(\n    route: Route,\n    matchersOrFactories: RouteConfig['matchers']\n  ): UrlMatcher {\n    const matchers: UrlMatcher[] = matchersOrFactories.map(matcherOrFactory => {\n      return typeof matcherOrFactory === 'function'\n        ? matcherOrFactory // matcher\n        : this.resolveUrlMatcherFactory(route, matcherOrFactory); // factory injection token\n    });\n    return this.urlMatcherService.getCombined(matchers);\n  }\n\n  /**\n   * Creates an `UrlMatcher` based on the given route, using the factory function coming from the given injection token.\n   *\n   * @param route Route object\n   * @param factoryToken injection token with a factory function that will create an UrlMatcher using given route\n   */\n  protected resolveUrlMatcherFactory(\n    route: Route,\n    factoryToken: InjectionToken<UrlMatcherFactory>\n  ): UrlMatcher {\n    const factory = this.injector.get(factoryToken);\n    return factory(route);\n  }\n\n  /**\n   * Returns the name of the Route stored in its property `data.cxRoute`\n   * @param route\n   */\n  protected getRouteName(route: Route): string {\n    return route.data && route.data.cxRoute;\n  }\n\n  protected validateRouteConfig(\n    routeConfig: RouteConfig,\n    routeName: string,\n    route: Route\n  ) {\n    if (isDevMode()) {\n      // - null value of routeConfig or routeConfig.paths means explicit switching off the route - it's valid config\n      // - routeConfig with defined `matchers` is valid, even if `paths` are undefined\n      if (\n        routeConfig === null ||\n        routeConfig.paths === null ||\n        routeConfig?.matchers\n      ) {\n        return;\n      }\n\n      // undefined value of routeConfig or routeConfig.paths is a misconfiguration\n      if (!routeConfig?.paths) {\n        this.warn(\n          `Could not configure the named route '${routeName}'`,\n          route,\n          `due to undefined config or undefined 'paths' property for this route`\n        );\n        return;\n      }\n    }\n  }\n\n  private warn(...args) {\n    if (isDevMode()) {\n      console.warn(...args);\n    }\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { SemanticPathService } from './semantic-path.service';\nimport { UrlCommands } from './url-command';\n\n@Pipe({\n  name: 'cxUrl',\n})\nexport class UrlPipe implements PipeTransform {\n  constructor(private urlService: SemanticPathService) {}\n\n  transform(commands: UrlCommands): any[] {\n    return this.urlService.transform(commands);\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { SemanticPathService } from './semantic-path.service';\nimport { Product } from '../../../model/product.model';\n@Pipe({\n  name: 'cxProductUrl',\n})\nexport class ProductURLPipe implements PipeTransform {\n  constructor(private semanticPath: SemanticPathService) {}\n  transform(product: Product) {\n    return this.semanticPath.transform({ cxRoute: 'product', params: product });\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { UrlPipe } from './url.pipe';\nimport { ProductURLPipe } from './product-url.pipe';\n\n@NgModule({\n  imports: [CommonModule],\n  declarations: [UrlPipe, ProductURLPipe],\n  exports: [UrlPipe, ProductURLPipe],\n})\nexport class UrlModule {}\n","export abstract class ExternalRoutesConfig {\n  routing?: {\n    internal?: string[];\n  };\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport {\n  ActivatedRouteSnapshot,\n  CanActivate,\n  RouterStateSnapshot,\n} from '@angular/router';\nimport { WindowRef } from '../../window/window-ref';\n\n@Injectable({ providedIn: 'root' })\nexport class ExternalRoutesGuard implements CanActivate {\n  constructor(\n    protected winRef: WindowRef,\n    @Inject(PLATFORM_ID) protected platformId: Object\n  ) {}\n\n  /**\n   * Redirects to different storefront system for anticipated URL\n   */\n  canActivate(\n    route: ActivatedRouteSnapshot,\n    state: RouterStateSnapshot\n  ): boolean {\n    if (isPlatformBrowser(this.platformId)) {\n      this.redirect(route, state);\n    }\n    return false;\n  }\n\n  /**\n   * Redirects to anticipated URL using full page reload, not Angular routing\n   */\n  protected redirect(_: ActivatedRouteSnapshot, state: RouterStateSnapshot) {\n    const window = this.winRef.nativeWindow;\n\n    if (window && window.location) {\n      window.location.href = state.url;\n    }\n  }\n}\n","import { ExternalRoutesService } from './external-routes.service';\n\nexport function addExternalRoutesFactory(service: ExternalRoutesService) {\n  const result = () => {\n    service.addRoutes();\n  };\n  return result;\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { Router, Routes, UrlMatcher } from '@angular/router';\nimport { UrlMatcherService } from '../services/url-matcher.service';\nimport { ExternalRoutesConfig } from './external-routes-config';\nimport { ExternalRoutesGuard } from './external-routes.guard';\n\n/**\n * Service that helps redirecting to different storefront systems for configured URLs\n */\n@Injectable()\nexport class ExternalRoutesService {\n  constructor(\n    protected config: ExternalRoutesConfig,\n    protected urlMatcherService: UrlMatcherService,\n    protected injector: Injector\n  ) {}\n\n  protected get internalUrlPatterns(): ExternalRoutesConfig['routing']['internal'] {\n    return (\n      (this.config && this.config.routing && this.config.routing.internal) || []\n    );\n  }\n\n  /**\n   * Prepends routes (to the Router.config) that are responsible for redirecting to a different storefront system\n   */\n  addRoutes(): void {\n    const router: Router = this.injector.get(Router);\n    const newRoutes = this.getRoutes();\n    if (newRoutes.length) {\n      router.resetConfig([...newRoutes, ...router.config]);\n    }\n  }\n\n  /**\n   * Returns routes that are responsible for redirection to different storefront systems\n   */\n  protected getRoutes(): Routes {\n    if (!this.internalUrlPatterns.length) {\n      return [];\n    }\n    const routes: Routes = [];\n\n    routes.push({\n      pathMatch: 'full',\n      matcher: this.getUrlMatcher(),\n      canActivate: [ExternalRoutesGuard],\n      component: {} as any,\n    });\n\n    return routes;\n  }\n\n  /**\n   * Returns the URL matcher for the external route\n   */\n  protected getUrlMatcher(): UrlMatcher {\n    const matcher = this.urlMatcherService.getFromGlob(\n      this.internalUrlPatterns\n    );\n    return this.urlMatcherService.getOpposite(matcher); // the external route should be activated only when it's NOT an internal route\n  }\n}\n","import { APP_INITIALIZER, ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config } from '../../config/config.module';\nimport { ExternalRoutesConfig } from './external-routes-config';\nimport { addExternalRoutesFactory } from './external-routes.providers';\nimport { ExternalRoutesService } from './external-routes.service';\n\n/**\n * Prepends the external route that redirects to a different storefront system for configured URLs\n */\n@NgModule()\nexport class ExternalRoutesModule {\n  static forRoot(): ModuleWithProviders<ExternalRoutesModule> {\n    return {\n      ngModule: ExternalRoutesModule,\n      providers: [\n        ExternalRoutesService,\n        { provide: ExternalRoutesConfig, useExisting: Config },\n        {\n          provide: APP_INITIALIZER,\n          multi: true,\n          useFactory: addExternalRoutesFactory,\n          deps: [ExternalRoutesService],\n        },\n      ],\n    };\n  }\n}\n","import { PageType } from '../../model/cms.model';\n\nexport class PageContext {\n  id: string;\n  type?: PageType;\n\n  constructor(id: string, type?: PageType) {\n    this.id = id;\n    this.type = type;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { RoutingConfig } from '../configurable-routes/config/routing-config';\n\n@Injectable({ providedIn: 'root' })\nexport class ProtectedRoutesService {\n  private nonProtectedPaths: string[][] = []; // arrays of paths' segments list\n\n  protected get routingConfig(): RoutingConfig['routing'] {\n    return this.config && this.config.routing;\n  }\n\n  /**\n   * Returns 'protected' property (boolean) from routing config\n   *\n   * @returns boolean\n   */\n  public get shouldProtect(): boolean {\n    return this.routingConfig.protected;\n  }\n\n  constructor(protected config: RoutingConfig) {\n    if (this.shouldProtect) {\n      // pre-process config for performance:\n      this.nonProtectedPaths = this.getNonProtectedPaths().map(path =>\n        this.getSegments(path)\n      );\n    }\n  }\n\n  /**\n   * Tells if the url is protected\n   */\n  isUrlProtected(urlSegments: string[]): boolean {\n    return (\n      this.shouldProtect &&\n      !this.matchAnyPath(urlSegments, this.nonProtectedPaths)\n    );\n  }\n\n  /**\n   * Tells whether the url matches at least one of the paths\n   */\n  protected matchAnyPath(\n    urlSegments: string[],\n    pathsSegments: string[][]\n  ): boolean {\n    return pathsSegments.some(pathSegments =>\n      this.matchPath(urlSegments, pathSegments)\n    );\n  }\n\n  /**\n   * Tells whether the url matches the path\n   */\n  protected matchPath(urlSegments: string[], pathSegments: string[]): boolean {\n    if (urlSegments.length !== pathSegments.length) {\n      return false;\n    }\n\n    for (let i = 0; i < pathSegments.length; i++) {\n      const pathSeg = pathSegments[i];\n      const urlSeg = urlSegments[i];\n\n      // compare only static segments:\n      if (!pathSeg.startsWith(':') && pathSeg !== urlSeg) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Returns a list of paths that are not protected\n   */\n  protected getNonProtectedPaths(): string[] {\n    return Object.values(this.routingConfig.routes).reduce(\n      (acc, routeConfig) =>\n        routeConfig.protected === false && // must be explicitly false, ignore undefined\n        routeConfig.paths &&\n        routeConfig.paths.length\n          ? acc.concat(routeConfig.paths)\n          : acc,\n      []\n    );\n  }\n\n  /**\n   * Splits the url by slashes\n   */\n  protected getSegments(url: string): string[] {\n    return (url || '').split('/');\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate } from '@angular/router';\nimport { Observable, of } from 'rxjs';\nimport { AuthGuard } from '../../auth/guards/auth.guard';\nimport { ProtectedRoutesService } from './protected-routes.service';\n\n@Injectable({ providedIn: 'root' })\nexport class ProtectedRoutesGuard implements CanActivate {\n  constructor(\n    protected service: ProtectedRoutesService,\n    protected authGuard: AuthGuard\n  ) {}\n\n  /**\n   * When the anticipated url is protected, it switches to the AuthGuard. Otherwise emits true.\n   */\n  canActivate(route: ActivatedRouteSnapshot): Observable<boolean> {\n    let urlSegments: string[] = route.url.map(seg => seg.path);\n\n    // For the root path `/` ActivatedRoute contains an empty array of segments:\n    urlSegments = urlSegments.length ? urlSegments : [''];\n\n    if (this.service.isUrlProtected(urlSegments)) {\n      return this.authGuard.canActivate();\n    }\n    return of(true);\n  }\n}\n","import { Location } from '@angular/common';\nimport { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { CmsRoute } from '../../models/cms-route';\nimport { RoutingActions } from '../actions/index';\n\n@Injectable()\nexport class RouterEffects {\n  @Effect({ dispatch: false })\n  navigate$: Observable<any> = this.actions$.pipe(\n    ofType(RoutingActions.ROUTER_GO),\n    map((action: RoutingActions.RouteGoAction) => action.payload),\n    tap(({ path, query: queryParams, extras }) => {\n      this.router.navigate(path, { queryParams, ...extras });\n    })\n  );\n\n  @Effect({ dispatch: false })\n  navigateBuUrl$: Observable<any> = this.actions$.pipe(\n    ofType(RoutingActions.ROUTER_GO_BY_URL),\n    map((action: RoutingActions.RouteGoAction) => action.payload),\n    tap(url => {\n      this.router.navigateByUrl(url);\n    })\n  );\n\n  @Effect({ dispatch: false })\n  clearCmsRoutes$: Observable<Action> = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      AuthActions.LOGOUT,\n      AuthActions.LOGIN\n    ),\n    tap(_ => {\n      const filteredConfig = this.router.config.filter(\n        (route: CmsRoute) => !(route.data && route.data.cxCmsRouteContext)\n      );\n      if (filteredConfig.length !== this.router.config.length) {\n        this.router.resetConfig(filteredConfig);\n      }\n    })\n  );\n\n  @Effect({ dispatch: false })\n  navigateBack$: Observable<Action> = this.actions$.pipe(\n    ofType(RoutingActions.ROUTER_BACK),\n    tap(() => this.location.back())\n  );\n\n  @Effect({ dispatch: false })\n  navigateForward$: Observable<Action> = this.actions$.pipe(\n    ofType(RoutingActions.ROUTER_FORWARD),\n    tap(() => this.location.forward())\n  );\n\n  constructor(\n    private actions$: Actions,\n    private router: Router,\n    private location: Location\n  ) {}\n}\n","import { RouterEffects } from './router.effect';\n\nexport const effects: any[] = [RouterEffects];\n\nexport * from './router.effect';\n","import { InjectionToken, Provider } from '@angular/core';\nimport { RouterStateSnapshot } from '@angular/router';\nimport * as fromNgrxRouter from '@ngrx/router-store';\nimport { ActionReducerMap } from '@ngrx/store';\nimport { PageType } from '../../../model/cms.model';\nimport { CmsActivatedRouteSnapshot } from '../../models/cms-route';\nimport { PageContext } from '../../models/page-context.model';\nimport {\n  ActivatedRouterStateSnapshot,\n  RouterState,\n  State,\n} from '../routing-state';\n\nexport const initialState: RouterState = {\n  navigationId: 0,\n  state: {\n    url: '',\n    queryParams: {},\n    params: {},\n    context: {\n      id: '',\n    },\n    cmsRequired: false,\n  },\n  nextState: undefined,\n};\n\nexport function getReducers(): ActionReducerMap<State> {\n  return {\n    router: reducer,\n  };\n}\n\nexport function reducer(\n  state: RouterState = initialState,\n  action: any\n): RouterState {\n  switch (action.type) {\n    case fromNgrxRouter.ROUTER_NAVIGATION: {\n      return {\n        ...state,\n        nextState: action.payload.routerState,\n        navigationId: action.payload.event.id,\n      };\n    }\n\n    case fromNgrxRouter.ROUTER_ERROR:\n    case fromNgrxRouter.ROUTER_CANCEL: {\n      return {\n        ...state,\n        nextState: undefined,\n      };\n    }\n\n    case fromNgrxRouter.ROUTER_NAVIGATED: {\n      return {\n        state: action.payload.routerState,\n        navigationId: action.payload.event.id,\n        nextState: undefined,\n      };\n    }\n\n    default: {\n      return state;\n    }\n  }\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  State\n>> = new InjectionToken<ActionReducerMap<State>>('RouterReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\n/* The serializer is there to parse the RouterStateSnapshot,\nand to reduce the amount of properties to be passed to the reducer.\n */\nexport class CustomSerializer\n  implements\n    fromNgrxRouter.RouterStateSerializer<ActivatedRouterStateSnapshot> {\n  serialize(routerState: RouterStateSnapshot): ActivatedRouterStateSnapshot {\n    const { url } = routerState;\n    const { queryParams } = routerState.root;\n\n    let state: CmsActivatedRouteSnapshot = routerState.root as CmsActivatedRouteSnapshot;\n    let cmsRequired = false;\n    let context: PageContext;\n\n    while (state.firstChild) {\n      state = state.firstChild as CmsActivatedRouteSnapshot;\n\n      // we use context information embedded in Cms driven routes from any parent route\n      if (state.data && state.data.cxCmsRouteContext) {\n        context = state.data.cxCmsRouteContext;\n      }\n\n      // we assume, that any route that has CmsPageGuard or it's child\n      // is cmsRequired\n      if (\n        !cmsRequired &&\n        (context ||\n          (state.routeConfig &&\n            state.routeConfig.canActivate &&\n            state.routeConfig.canActivate.find(\n              x => x && x.guardName === 'CmsPageGuard'\n            )))\n      ) {\n        cmsRequired = true;\n      }\n    }\n    const { params } = state;\n\n    // we give smartedit preview page a PageContext\n    if (state.url.length > 0 && state.url[0].path === 'cx-preview') {\n      context = {\n        id: 'smartedit-preview',\n        type: PageType.CONTENT_PAGE,\n      };\n    } else {\n      if (params['productCode']) {\n        context = { id: params['productCode'], type: PageType.PRODUCT_PAGE };\n      } else if (params['categoryCode']) {\n        context = { id: params['categoryCode'], type: PageType.CATEGORY_PAGE };\n      } else if (params['brandCode']) {\n        context = { id: params['brandCode'], type: PageType.CATEGORY_PAGE };\n      } else if (state.data.pageLabel !== undefined) {\n        context = { id: state.data.pageLabel, type: PageType.CONTENT_PAGE };\n      } else if (!context) {\n        if (state.url.length > 0) {\n          const pageLabel =\n            '/' + state.url.map(urlSegment => urlSegment.path).join('/');\n          context = {\n            id: pageLabel,\n            type: PageType.CONTENT_PAGE,\n          };\n        } else {\n          context = {\n            id: 'homepage',\n            type: PageType.CONTENT_PAGE,\n          };\n        }\n      }\n    }\n\n    return { url, queryParams, params, context, cmsRequired };\n  }\n}\n","import { APP_INITIALIZER, ModuleWithProviders, NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport {\n  RouterState,\n  RouterStateSerializer,\n  StoreRouterConnectingModule,\n} from '@ngrx/router-store';\nimport { StoreModule } from '@ngrx/store';\nimport { Config } from '../config/config.module';\nimport { RoutingConfig } from './configurable-routes/config/routing-config';\nimport { ConfigurableRoutesService } from './configurable-routes/configurable-routes.service';\nimport { effects } from './store/effects/index';\nimport {\n  CustomSerializer,\n  reducerProvider,\n  reducerToken,\n} from './store/reducers/router.reducer';\nimport { ROUTING_FEATURE } from './store/routing-state';\n\nexport function initConfigurableRoutes(\n  service: ConfigurableRoutesService\n): () => void {\n  const result = () => service.init(); // workaround for AOT compilation (see https://stackoverflow.com/a/51977115)\n  return result;\n}\n\n@NgModule({\n  imports: [\n    StoreModule.forFeature(ROUTING_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n    StoreRouterConnectingModule.forRoot({\n      routerState: RouterState.Minimal,\n      stateKey: ROUTING_FEATURE, // name of reducer key\n    }),\n  ],\n})\nexport class RoutingModule {\n  static forRoot(): ModuleWithProviders<RoutingModule> {\n    return {\n      ngModule: RoutingModule,\n      providers: [\n        reducerProvider,\n        {\n          provide: RouterStateSerializer,\n          useClass: CustomSerializer,\n        },\n        {\n          provide: APP_INITIALIZER,\n          useFactory: initConfigurableRoutes,\n          deps: [ConfigurableRoutesService],\n          multi: true,\n        },\n        { provide: RoutingConfig, useExisting: Config },\n      ],\n    };\n  }\n}\n","import { inject, InjectionToken } from '@angular/core';\nimport { Route } from '@angular/router';\nimport { RoutingConfigService } from '../configurable-routes';\nimport { UrlMatcherService } from '../services/url-matcher.service';\nimport { UrlMatcherFactory } from './url-matcher-factory';\n\nexport function getDefaultUrlMatcherFactory(\n  routingConfigService: RoutingConfigService,\n  urlMatcherService: UrlMatcherService\n): UrlMatcherFactory {\n  const factory = (route: Route) => {\n    const routeName = route.data && route.data['cxRoute'];\n    const routeConfig = routingConfigService.getRouteConfig(routeName);\n    const paths = (routeConfig && routeConfig.paths) || [];\n    return urlMatcherService.getFromPaths(paths);\n  };\n  return factory;\n}\n\n/**\n * Injection token with url matcher factory for spartacus routes containing property `data.cxRoute`.\n * The provided url matcher matches the configured `paths` from routing config.\n *\n * If this matcher doesn't fit the requirements, it can be replaced with custom matcher\n * or additional matchers can be added for a specific route. See for example PRODUCT_DETAILS_URL_MATCHER.\n *\n * Note: Matchers will \"match\" a route, but do not contribute to the creation of the route, nor do they guard routes.\n */\nexport const DEFAULT_URL_MATCHER = new InjectionToken<UrlMatcherFactory>(\n  'DEFAULT_URL_MATCHER',\n  {\n    providedIn: 'root',\n    factory: () =>\n      getDefaultUrlMatcherFactory(\n        inject(RoutingConfigService),\n        inject(UrlMatcherService)\n      ),\n  }\n);\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, filter, map, mergeMap, take } from 'rxjs/operators';\nimport { RoutingService } from '../../../routing/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CmsComponentConnector } from '../../connectors/component/cms-component.connector';\nimport { CmsActions } from '../actions/index';\n\n@Injectable()\nexport class NavigationEntryItemEffects {\n  @Effect()\n  loadNavigationItems$: Observable<\n    | CmsActions.LoadCmsNavigationItemsSuccess\n    | CmsActions.LoadCmsNavigationItemsFail\n  > = this.actions$.pipe(\n    ofType(CmsActions.LOAD_CMS_NAVIGATION_ITEMS),\n    map((action: CmsActions.LoadCmsNavigationItems) => action.payload),\n    map(payload => {\n      return {\n        ids: this.getIdListByItemType(payload.items),\n        nodeId: payload.nodeId,\n      };\n    }),\n    mergeMap(data => {\n      if (data.ids.componentIds.length > 0) {\n        return this.routingService.getRouterState().pipe(\n          filter(routerState => routerState !== undefined),\n          map(routerState => routerState.state.context),\n          take(1),\n          mergeMap(pageContext =>\n            // download all items in one request\n            this.cmsComponentConnector\n              .getList(data.ids.componentIds, pageContext)\n              .pipe(\n                map(\n                  components =>\n                    new CmsActions.LoadCmsNavigationItemsSuccess({\n                      nodeId: data.nodeId,\n                      components: components,\n                    })\n                ),\n                catchError(error =>\n                  of(\n                    new CmsActions.LoadCmsNavigationItemsFail(\n                      data.nodeId,\n                      makeErrorSerializable(error)\n                    )\n                  )\n                )\n              )\n          )\n        );\n      } else if (data.ids.pageIds.length > 0) {\n        // TODO: future work\n        // dispatch action to load cms page one by one\n      } else if (data.ids.mediaIds.length > 0) {\n        // TODO: future work\n        // send request to get list of media\n      } else {\n        return of(\n          new CmsActions.LoadCmsNavigationItemsFail(\n            data.nodeId,\n            'navigation nodes are empty'\n          )\n        );\n      }\n    })\n  );\n\n  // We only consider 3 item types: cms page, cms component, and media.\n  getIdListByItemType(\n    itemList: any[]\n  ): { pageIds: string[]; componentIds: string[]; mediaIds: string[] } {\n    const pageIds: string[] = [];\n    const componentIds: string[] = [];\n    const mediaIds: string[] = [];\n\n    itemList.forEach(item => {\n      if (item.superType === 'AbstractCMSComponent') {\n        componentIds.push(item.id);\n      } else if (item.superType === 'AbstractPage') {\n        pageIds.push(item.id);\n      } else if (item.superType === 'AbstractMedia') {\n        mediaIds.push(item.id);\n      }\n    });\n    return { pageIds: pageIds, componentIds: componentIds, mediaIds: mediaIds };\n  }\n\n  constructor(\n    private actions$: Actions,\n    private cmsComponentConnector: CmsComponentConnector,\n    private routingService: RoutingService\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError, switchMap } from 'rxjs/operators';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { CmsPageAdapter } from './cms-page.adapter';\nimport { CmsStructureConfigService } from '../../services/cms-structure-config.service';\nimport { PageContext } from '../../../routing/models/page-context.model';\nimport { CmsStructureModel } from '../../model/page.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CmsPageConnector {\n  constructor(\n    protected cmsPageAdapter: CmsPageAdapter,\n    protected cmsStructureConfigService: CmsStructureConfigService\n  ) {}\n\n  /**\n   * Returns an observable with the page structure. The page structure is\n   * typically loaded from a backend, but can also be returned from static\n   * configuration (see `CmsStructureConfigService`).\n   */\n  get(pageContext: PageContext): Observable<CmsStructureModel> {\n    return this.cmsStructureConfigService\n      .shouldIgnoreBackend(pageContext.id)\n      .pipe(\n        switchMap(loadFromConfig => {\n          if (!loadFromConfig) {\n            return this.cmsPageAdapter.load(pageContext).pipe(\n              catchError(error => {\n                if (\n                  error instanceof HttpErrorResponse &&\n                  error.status === 400\n                ) {\n                  return of({});\n                } else {\n                  return throwError(error);\n                }\n              })\n            );\n          } else {\n            return of({});\n          }\n        }),\n        switchMap(page => this.mergeDefaultPageStructure(pageContext, page))\n      );\n  }\n\n  /**\n   *\n   * Merge default page structure inot the given `CmsStructureModel`.\n   * This is benefitial for a fast setup of the UI without necessary\n   * finegrained CMS setup.\n   */\n  private mergeDefaultPageStructure(\n    pageContext: PageContext,\n    pageStructure: CmsStructureModel\n  ): Observable<CmsStructureModel> {\n    return this.cmsStructureConfigService.mergePageStructure(\n      pageContext.id,\n      pageStructure\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport {\n  catchError,\n  filter,\n  groupBy,\n  map,\n  mergeMap,\n  switchMap,\n  take,\n} from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { RoutingService } from '../../../routing/index';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { CmsPageConnector } from '../../connectors/page/cms-page.connector';\nimport { CmsStructureModel } from '../../model/page.model';\nimport { serializePageContext } from '../../utils/cms-utils';\nimport { CmsActions } from '../actions/index';\n\n@Injectable()\nexport class PageEffects {\n  @Effect()\n  refreshPage$: Observable<Action> = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      AuthActions.LOGOUT,\n      AuthActions.LOGIN\n    ),\n    switchMap(_ =>\n      this.routingService.getRouterState().pipe(\n        filter(\n          routerState =>\n            routerState &&\n            routerState.state &&\n            routerState.state.cmsRequired &&\n            !routerState.nextState\n        ),\n        take(1),\n        map(routerState => routerState.state.context),\n        mergeMap(context => of(new CmsActions.LoadCmsPageData(context)))\n      )\n    )\n  );\n\n  @Effect()\n  loadPageData$: Observable<Action> = this.actions$.pipe(\n    ofType(CmsActions.LOAD_CMS_PAGE_DATA),\n    map((action: CmsActions.LoadCmsPageData) => action.payload),\n    groupBy(pageContext => serializePageContext(pageContext)),\n    mergeMap(group =>\n      group.pipe(\n        switchMap(pageContext =>\n          this.cmsPageConnector.get(pageContext).pipe(\n            mergeMap((cmsStructure: CmsStructureModel) => {\n              const actions: Action[] = [\n                new CmsActions.CmsGetComponentFromPage(\n                  cmsStructure.components.map(component => ({\n                    component,\n                    pageContext,\n                  }))\n                ),\n                new CmsActions.LoadCmsPageDataSuccess(\n                  pageContext,\n                  cmsStructure.page\n                ),\n              ];\n\n              const pageLabel = cmsStructure.page.label;\n              // For content pages the page label returned from backend can be different than page ID initially assumed from route.\n              // In such a case let's save the success response not only for initially assumed page ID, but also for correct page label.\n              if (pageLabel && pageLabel !== pageContext.id) {\n                actions.unshift(\n                  new CmsActions.CmsSetPageSuccessIndex(\n                    { id: pageLabel, type: pageContext.type },\n                    cmsStructure.page\n                  )\n                );\n              }\n\n              return actions;\n            }),\n            catchError(error =>\n              of(\n                new CmsActions.LoadCmsPageDataFail(\n                  pageContext,\n                  makeErrorSerializable(error)\n                )\n              )\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private cmsPageConnector: CmsPageConnector,\n    private routingService: RoutingService\n  ) {}\n}\n","import { ComponentsEffects } from './components.effect';\nimport { NavigationEntryItemEffects } from './navigation-entry-item.effect';\nimport { PageEffects } from './page.effect';\n\nexport const effects: any[] = [\n  PageEffects,\n  ComponentsEffects,\n  NavigationEntryItemEffects,\n];\n\nexport * from './components.effect';\nexport * from './navigation-entry-item.effect';\nexport * from './page.effect';\n","import { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport { serializePageContext } from '../../utils/cms-utils';\nimport { CmsActions } from '../actions/index';\nimport { ComponentsContext } from '../cms-state';\n\nexport const initialState: ComponentsContext = {\n  component: undefined,\n  pageContext: {},\n};\n\nfunction componentExistsReducer<T>(\n  state = false,\n  action: CmsActions.CmsComponentAction<T>\n): boolean {\n  switch (action.type) {\n    case CmsActions.LOAD_CMS_COMPONENT_FAIL:\n      return false;\n\n    case CmsActions.CMS_GET_COMPONENT_FROM_PAGE:\n    case CmsActions.LOAD_CMS_COMPONENT_SUCCESS:\n      return true;\n  }\n  return state;\n}\n\nexport function reducer<T>(\n  state = initialState,\n  action: CmsActions.CmsComponentAction<T>\n): ComponentsContext {\n  switch (action.type) {\n    case CmsActions.LOAD_CMS_COMPONENT: {\n      const pageContextReducer = loaderReducer<boolean>(\n        action.meta.entityType,\n        componentExistsReducer\n      );\n      const context = serializePageContext(action.payload.pageContext, true);\n      return {\n        ...state,\n        pageContext: {\n          ...state.pageContext,\n          [context]: pageContextReducer(state.pageContext[context], action),\n        },\n      };\n    }\n    case CmsActions.LOAD_CMS_COMPONENT_FAIL: {\n      const pageContextReducer = loaderReducer<boolean>(\n        action.meta.entityType,\n        componentExistsReducer\n      );\n      const context = serializePageContext(action.payload.pageContext, true);\n      return {\n        ...state,\n        pageContext: {\n          ...state.pageContext,\n          [context]: pageContextReducer(state.pageContext[context], action),\n        },\n      };\n    }\n    case CmsActions.LOAD_CMS_COMPONENT_SUCCESS: {\n      const pageContextReducer = loaderReducer<boolean>(\n        action.meta.entityType,\n        componentExistsReducer\n      );\n      const context = serializePageContext(action.payload.pageContext, true);\n      return {\n        ...state,\n        component: action.payload.component as T,\n        pageContext: {\n          ...state.pageContext,\n          [context]: pageContextReducer(state.pageContext[context], action),\n        },\n      };\n    }\n    case CmsActions.CMS_GET_COMPONENT_FROM_PAGE: {\n      const pageContextReducer = loaderReducer<boolean>(\n        action.meta.entityType,\n        componentExistsReducer\n      );\n      if (!Array.isArray(action.payload)) {\n        const context = serializePageContext(action.payload.pageContext, true);\n        return {\n          ...state,\n          component: action.payload.component as T,\n          pageContext: {\n            ...state.pageContext,\n            [context]: pageContextReducer(state.pageContext[context], action),\n          },\n        };\n      }\n    }\n  }\n  return state;\n}\n","import { NodeItem } from '../../model/node-item.model';\nimport { CmsActions } from '../actions/index';\n\nexport const initialState: NodeItem = undefined;\n\nexport function reducer(\n  state = initialState,\n  action: CmsActions.CmsNavigationEntryItemAction\n): NodeItem {\n  switch (action.type) {\n    case CmsActions.LOAD_CMS_NAVIGATION_ITEMS_SUCCESS: {\n      if (action.payload.components) {\n        const components = action.payload.components;\n        const newItem: NodeItem = components.reduce(\n          (compItems: { [uid_type: string]: any }, component: any) => {\n            return {\n              ...compItems,\n              [`${component.uid}_AbstractCMSComponent`]: component,\n            };\n          },\n          {\n            ...{},\n          }\n        );\n\n        return {\n          ...state,\n          ...newItem,\n        };\n      }\n    }\n  }\n\n  return state;\n}\n","import { EntityState } from '../../../state/utils/entity/entity-state';\nimport { Page } from '../../model/page.model';\nimport { CmsActions } from '../actions/index';\n\nexport const initialState: EntityState<Page> = { entities: {} };\n\nexport function reducer(\n  state = initialState,\n  action: CmsActions.LoadCmsPageDataSuccess\n): EntityState<Page> {\n  switch (action.type) {\n    case CmsActions.LOAD_CMS_PAGE_DATA_SUCCESS: {\n      const page: Page = action.payload;\n      return { ...state, entities: { ...state.entities, [page.pageId]: page } };\n    }\n  }\n  return state;\n}\n","import { CmsActions } from '../actions/index';\n\nexport const initialState = undefined;\n\nexport function reducer(\n  entityType: string\n): (\n  state: string,\n  action:\n    | CmsActions.LoadCmsPageDataSuccess\n    | CmsActions.LoadCmsPageDataFail\n    | CmsActions.CmsSetPageFailIndex\n) => string {\n  return (\n    state = initialState,\n    action:\n      | CmsActions.LoadCmsPageDataSuccess\n      | CmsActions.LoadCmsPageDataFail\n      | CmsActions.CmsSetPageSuccessIndex\n      | CmsActions.CmsSetPageFailIndex\n  ): string => {\n    if (action.meta && action.meta.entityType === entityType) {\n      switch (action.type) {\n        case CmsActions.LOAD_CMS_PAGE_DATA_SUCCESS: {\n          return action.payload.pageId;\n        }\n\n        case CmsActions.LOAD_CMS_PAGE_DATA_FAIL: {\n          return initialState;\n        }\n\n        case CmsActions.CMS_SET_PAGE_FAIL_INDEX: {\n          return action.payload;\n        }\n\n        case CmsActions.CMS_SET_PAGE_SUCCESS_INDEX: {\n          return action.payload.pageId;\n        }\n      }\n    }\n    return state;\n  };\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  Action,\n  ActionReducer,\n  ActionReducerMap,\n  combineReducers,\n  MetaReducer,\n} from '@ngrx/store';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { PageType } from '../../../model/cms.model';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { entityLoaderReducer } from '../../../state/utils/entity-loader/entity-loader.reducer';\nimport { entityReducer } from '../../../state/utils/entity/entity.reducer';\nimport { NodeItem } from '../../model/node-item.model';\nimport {\n  CmsState,\n  COMPONENT_ENTITY,\n  NAVIGATION_DETAIL_ENTITY,\n  StateWithCms,\n} from '../cms-state';\nimport * as fromComponentsReducer from './components.reducer';\nimport * as fromNavigation from './navigation-entry-item.reducer';\nimport * as fromPageReducer from './page-data.reducer';\nimport * as fromPageIndexReducer from './page-index.reducer';\n\nexport function getReducers(): ActionReducerMap<CmsState> {\n  return {\n    page: combineReducers({\n      pageData: fromPageReducer.reducer,\n      index: combineReducers({\n        content: entityLoaderReducer<string>(\n          PageType.CONTENT_PAGE,\n          fromPageIndexReducer.reducer(PageType.CONTENT_PAGE)\n        ),\n        product: entityLoaderReducer<string>(\n          PageType.PRODUCT_PAGE,\n          fromPageIndexReducer.reducer(PageType.PRODUCT_PAGE)\n        ),\n        category: entityLoaderReducer<string>(\n          PageType.CATEGORY_PAGE,\n          fromPageIndexReducer.reducer(PageType.CATEGORY_PAGE)\n        ),\n        catalog: entityLoaderReducer<string>(\n          PageType.CATALOG_PAGE,\n          fromPageIndexReducer.reducer(PageType.CATALOG_PAGE)\n        ),\n      }),\n    }),\n    components: entityReducer(COMPONENT_ENTITY, fromComponentsReducer.reducer),\n    navigation: entityLoaderReducer<NodeItem>(\n      NAVIGATION_DETAIL_ENTITY,\n      fromNavigation.reducer\n    ),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  CmsState\n>> = new InjectionToken<ActionReducerMap<CmsState>>('CmsReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearCmsState(\n  reducer: ActionReducer<StateWithCms, Action>\n): ActionReducer<StateWithCms, Action> {\n  return function(state, action) {\n    if (\n      action.type === SiteContextActions.LANGUAGE_CHANGE ||\n      action.type === AuthActions.LOGOUT ||\n      action.type === AuthActions.LOGIN\n    ) {\n      state = undefined;\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<StateWithCms>[] = [clearCmsState];\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { provideDefaultConfigFactory } from '../../config/config.module';\nimport {\n  StateConfig,\n  StateTransferType,\n} from '../../state/config/state-config';\nimport { StateModule } from '../../state/state.module';\nimport { CMS_FEATURE } from './cms-state';\nimport { effects } from './effects/index';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function cmsStoreConfigFactory(): StateConfig {\n  // if we want to reuse CMS_FEATURE const in config, we have to use factory instead of plain object\n  const config: StateConfig = {\n    state: {\n      ssrTransfer: {\n        keys: { [CMS_FEATURE]: StateTransferType.TRANSFER_STATE },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StateModule,\n    StoreModule.forFeature(CMS_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(cmsStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class CmsStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { CmsConfig } from './config/cms-config';\nimport { CmsStructureConfig } from './config/cms-structure.config';\nimport { defaultCmsModuleConfig } from './config/default-cms-config';\nimport { CmsService } from './facade/cms.service';\nimport { CmsPageTitleModule } from './page/page.module';\nimport { CmsStoreModule } from './store/cms-store.module';\n\n@NgModule({\n  imports: [CmsStoreModule, CmsPageTitleModule],\n})\nexport class CmsModule {\n  static forRoot(): ModuleWithProviders<CmsModule> {\n    return {\n      ngModule: CmsModule,\n      providers: [\n        CmsService,\n        { provide: CmsConfig, useExisting: Config },\n        { provide: CmsStructureConfig, useExisting: Config },\n        provideDefaultConfig(defaultCmsModuleConfig),\n      ],\n    };\n  }\n}\n","import { Inject, Injectable, Optional } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { FeatureConfigService } from '../../features-config/services/feature-config.service';\nimport { Page, PageMeta } from '../model/page.model';\nimport { PageMetaResolver } from '../page/page-meta.resolver';\nimport { CmsService } from './cms.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class PageMetaService {\n  constructor(\n    @Optional()\n    @Inject(PageMetaResolver)\n    protected resolvers: PageMetaResolver[],\n    protected cms: CmsService,\n    protected featureConfigService?: FeatureConfigService\n  ) {\n    this.resolvers = this.resolvers || [];\n  }\n  /**\n   * The list of resolver interfaces will be evaluated for the pageResolvers.\n   *\n   * TOOD: optimize browser vs SSR resolvers; image, robots and description\n   *       aren't needed during browsing.\n   * TODO: we can make the list of resolver types configurable\n   */\n  resolverMethods = {\n    title: 'resolveTitle',\n    heading: 'resolveHeading',\n    description: 'resolveDescription',\n    breadcrumbs: 'resolveBreadcrumbs',\n    image: 'resolveImage',\n    robots: 'resolveRobots',\n  };\n\n  getMeta(): Observable<PageMeta> {\n    return this.cms.getCurrentPage().pipe(\n      filter(Boolean),\n      switchMap((page: Page) => {\n        const metaResolver = this.getMetaResolver(page);\n        if (metaResolver) {\n          return this.resolve(metaResolver);\n        } else {\n          // we do not have a page resolver\n          return of(null);\n        }\n      })\n    );\n  }\n\n  /**\n   * If a pageResolver has implemented a resolver interface, the resolved data\n   * is merged into the `PageMeta` object.\n   * @param metaResolver\n   */\n  private resolve(metaResolver): Observable<PageMeta> {\n    if (\n      metaResolver.resolve &&\n      (!this.featureConfigService || !this.featureConfigService.isLevel('1.3'))\n    ) {\n      return metaResolver.resolve();\n    } else {\n      // resolve individual resolvers to make the extension mechanism more flexible\n      const resolveMethods: any[] = Object.keys(this.resolverMethods)\n        .filter(key => metaResolver[this.resolverMethods[key]])\n        .map(key =>\n          metaResolver[this.resolverMethods[key]]().pipe(\n            map(data => ({\n              [key]: data,\n            }))\n          )\n        );\n\n      return combineLatest(resolveMethods).pipe(\n        map(data => Object.assign({}, ...data))\n      );\n    }\n  }\n\n  /**\n   * return the resolver with the best match\n   * resovers can by default match on PageType and page template\n   * but custom match comparisors can be implemented.\n   */\n  protected getMetaResolver(page: Page): PageMetaResolver {\n    const matchingResolvers = this.resolvers.filter(\n      resolver => resolver.getScore(page) > 0\n    );\n    matchingResolvers.sort(function(a, b) {\n      return b.getScore(page) - a.getScore(page);\n    });\n    return matchingResolvers[0];\n  }\n}\n","import { Injectable, Renderer2 } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class DynamicAttributeService {\n  /**\n   * Add dynamic attributes to DOM. These attributes are extracted from the properties of cms items received from backend.\n   * There can by many different groups of properties, one of them is smaredit. But EC allows addons to create different groups.\n   * For example, personalization may add 'script' group etc.\n   * @param properties: properties in each cms item response data\n   * @param element: slot or cms component element\n   * @param renderer\n   */\n  addDynamicAttributes(\n    properties: any,\n    element: Element,\n    renderer: Renderer2\n  ): void {\n    if (properties) {\n      // check each group of properties, e.g. smartedit\n      Object.keys(properties).forEach(group => {\n        const name = 'data-' + group + '-';\n        const groupProps = properties[group];\n\n        // check each property in the group\n        Object.keys(groupProps).forEach(propName => {\n          const propValue = groupProps[propName];\n          if (propName === 'classes') {\n            const classes = propValue.split(' ');\n            classes.forEach(classItem => {\n              element.classList.add(classItem);\n            });\n          } else {\n            renderer.setAttribute(\n              element,\n              name +\n                propName\n                  .split(/(?=[A-Z])/)\n                  .join('-')\n                  .toLowerCase(),\n              propValue\n            );\n          }\n        });\n      });\n    }\n  }\n}\n","import { DOCUMENT, isPlatformBrowser } from '@angular/common';\nimport {\n  InjectionToken,\n  ModuleWithProviders,\n  NgModule,\n  PLATFORM_ID,\n} from '@angular/core';\nimport { provideConfigFactory } from './config.module';\nimport { getCookie } from './utils/get-cookie';\n\nexport const TEST_CONFIG_COOKIE_NAME = new InjectionToken<string>(\n  'TEST_CONFIG_COOKIE_NAME'\n);\n\nexport function parseConfigJSON(config: string) {\n  try {\n    return JSON.parse(decodeURIComponent(config));\n  } catch (_) {\n    return {};\n  }\n}\n\nexport function configFromCookieFactory(\n  cookieName: string,\n  platform: any,\n  document: Document\n) {\n  if (isPlatformBrowser(platform) && cookieName) {\n    const config = getCookie(document.cookie, cookieName);\n    return parseConfigJSON(config);\n  }\n  return {};\n}\n\nexport interface TestConfigModuleOptions {\n  cookie: string;\n}\n\n/**\n * Designed/intended to provide dynamic configuration for testing scenarios ONLY (e.g. e2e tests).\n *\n * CAUTION: DON'T USE IT IN PRODUCTION! IT HASN'T BEEN REVIEWED FOR SECURITY ISSUES.\n */\n@NgModule({})\nexport class TestConfigModule {\n  /**\n   * Injects JSON config from the cookie of the given name.\n   *\n   * Be aware of the cookie limitations (4096 bytes).\n   *\n   * CAUTION: DON'T USE IT IN PRODUCTION! IT HASN'T BEEN REVIEWED FOR SECURITY ISSUES.\n   */\n  static forRoot(\n    options: TestConfigModuleOptions\n  ): ModuleWithProviders<TestConfigModule> {\n    return {\n      ngModule: TestConfigModule,\n      providers: [\n        {\n          provide: TEST_CONFIG_COOKIE_NAME,\n          useValue: options && options.cookie,\n        },\n        provideConfigFactory(configFromCookieFactory, [\n          TEST_CONFIG_COOKIE_NAME,\n          PLATFORM_ID,\n          DOCUMENT,\n        ]),\n      ],\n    };\n  }\n}\n","export function getCookie(cookie: string, name: string) {\n  const regExp = new RegExp('(?:^|;\\\\s*)' + name + '=([^;]*)', 'g');\n  const result: RegExpExecArray = regExp.exec(cookie);\n\n  return (result && decodeURIComponent(result[1])) || '';\n}\n","import {\n  APP_INITIALIZER,\n  isDevMode,\n  ModuleWithProviders,\n  NgModule,\n  Optional,\n} from '@angular/core';\nimport { ConfigInitializerService } from '../config-initializer/config-initializer.service';\nimport {\n  ConfigValidator,\n  ConfigValidatorToken,\n  validateConfig,\n} from './config-validator';\n\nexport function configValidatorFactory(\n  configInitializer: ConfigInitializerService,\n  validators: ConfigValidator[]\n) {\n  const validate = () => {\n    if (isDevMode()) {\n      configInitializer\n        .getStableConfig()\n        .then(config => validateConfig(config, validators || []));\n    }\n  };\n  return validate;\n}\n\n/**\n * Should stay private in 1.x\n * as forRoot() is used internally by ConfigInitializerModule\n *\n * issue: #5279\n */\n@NgModule()\nexport class ConfigValidatorModule {\n  static forRoot(): ModuleWithProviders<ConfigValidatorModule> {\n    return {\n      ngModule: ConfigValidatorModule,\n      providers: [\n        {\n          provide: APP_INITIALIZER,\n          multi: true,\n          useFactory: configValidatorFactory,\n          deps: [\n            ConfigInitializerService,\n            [new Optional(), ConfigValidatorToken],\n          ],\n        },\n      ],\n    };\n  }\n}\n","import {\n  APP_INITIALIZER,\n  ModuleWithProviders,\n  NgModule,\n  Optional,\n} from '@angular/core';\nimport { ConfigInitializerService } from './config-initializer.service';\nimport {\n  CONFIG_INITIALIZER,\n  CONFIG_INITIALIZER_FORROOT_GUARD,\n  ConfigInitializer,\n} from './config-initializer';\n\nexport function configInitializerFactory(\n  configInitializer: ConfigInitializerService,\n  initializers: ConfigInitializer[]\n) {\n  const isReady = () => configInitializer.initialize(initializers);\n  return isReady;\n}\n\n@NgModule({})\nexport class ConfigInitializerModule {\n  static forRoot(): ModuleWithProviders<ConfigInitializerModule> {\n    return {\n      ngModule: ConfigInitializerModule,\n      providers: [\n        {\n          provide: CONFIG_INITIALIZER_FORROOT_GUARD,\n          useValue: true,\n        },\n        {\n          provide: APP_INITIALIZER,\n          multi: true,\n          useFactory: configInitializerFactory,\n          deps: [\n            ConfigInitializerService,\n            [new Optional(), CONFIG_INITIALIZER],\n          ],\n        },\n      ],\n    };\n  }\n}\n","import { isDevMode, Pipe, PipeTransform } from '@angular/core';\nimport { DatePipe, getLocaleId } from '@angular/common';\nimport { LanguageService } from '../site-context/facade/language.service';\n\n// type CxDatePipe, not DatePipe, due to conflict with Angular's DatePipe - problem occurs for the backward compatibility compiler of Ivy\n@Pipe({ name: 'cxDate' })\nexport class CxDatePipe extends DatePipe implements PipeTransform {\n  constructor(protected language: LanguageService) {\n    super(null);\n  }\n\n  transform(value: any, format?: string, timezone?: string): string | null {\n    return super.transform(value, format, timezone, this.getLang());\n  }\n\n  private getLang() {\n    const lang = this.getActiveLang();\n    try {\n      getLocaleId(lang);\n      return lang;\n    } catch {\n      this.reportMissingLocaleData(lang);\n      return 'en';\n    }\n  }\n\n  private getActiveLang(): string {\n    let result;\n    this.language\n      .getActive()\n      .subscribe(lang => (result = lang))\n      .unsubscribe();\n    return result;\n  }\n\n  private reportMissingLocaleData(lang: string) {\n    if (isDevMode()) {\n      console.warn(\n        `cxDate pipe: No locale data registered for '${lang}' (see https://angular.io/api/common/registerLocaleData).`\n      );\n    }\n  }\n}\n","import {\n  ChangeDetectorRef,\n  OnDestroy,\n  Pipe,\n  PipeTransform,\n} from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { TranslationService } from './translation.service';\nimport { shallowEqualObjects } from '../util/compare-equal-objects';\nimport { Translatable, TranslatableParams } from './translatable';\n\n@Pipe({ name: 'cxTranslate', pure: false })\nexport class TranslatePipe implements PipeTransform, OnDestroy {\n  private lastKey: string;\n  private lastOptions: object;\n  private translatedValue: string;\n  private sub: Subscription;\n\n  constructor(\n    protected service: TranslationService,\n    protected cd: ChangeDetectorRef\n  ) {}\n\n  transform(\n    input: Translatable | string,\n    options: TranslatableParams = {}\n  ): string {\n    if ((input as Translatable).raw) {\n      return (input as Translatable).raw;\n    }\n\n    const key = typeof input === 'string' ? input : input.key;\n    if (typeof input !== 'string') {\n      options = { ...options, ...input.params };\n    }\n\n    this.translate(key, options);\n    return this.translatedValue;\n  }\n\n  private translate(key: any, options: object) {\n    if (\n      key !== this.lastKey ||\n      !shallowEqualObjects(options, this.lastOptions)\n    ) {\n      this.lastKey = key;\n      this.lastOptions = options;\n\n      if (this.sub) {\n        this.sub.unsubscribe();\n      }\n      this.sub = this.service\n        .translate(key, options, true)\n        .subscribe(val => this.markForCheck(val));\n    }\n  }\n\n  private markForCheck(value: string) {\n    this.translatedValue = value;\n    this.cd.markForCheck();\n  }\n\n  ngOnDestroy(): void {\n    if (this.sub) {\n      this.sub.unsubscribe();\n    }\n  }\n}\n","import { TranslationResources } from '../translation-resources';\n\nexport abstract class I18nConfig {\n  i18n?: {\n    /**\n     * When there are missing translation resources for the active language, the fallback language will be used.\n     */\n    fallbackLang?: string | false;\n\n    /**\n     * Configuration for lazy loading of translation files.\n     * For eager loading of translations please use config option `i18n.resources`\n     */\n\n    backend?: {\n      /**\n       * The path to JSON translations. It should contain placeholders:\n       * - `{{lng}}` for language\n       * - `{{ns}}` for the name of chunk.\n       *\n       * Example:\n       * `assets/i18n-assets/{{lng}}/{{ns}}.json`\n       */\n\n      loadPath?: string;\n    };\n\n    /**\n     * Reference to translation resources that are eagerly bundled with JS app.\n     * For lazy loading of translations please use config option `i18n.backend` instead.\n     */\n    resources?: TranslationResources;\n\n    /**\n     * Logs i18n events (like loading translation resources) to the console. Don't use in production!\n     */\n    debug?: boolean;\n\n    /**\n     * Mapping that assigns keys' namespaces to specific chunks. The main purpose of chunks is to lazy load them.\n     */\n    chunks?: {\n      [chunk: string]: string[];\n    };\n  };\n}\n","import { Injectable, isDevMode } from '@angular/core';\nimport { I18nConfig } from './config/i18n-config';\n\n@Injectable()\nexport class TranslationChunkService {\n  protected duplicates: { [key: string]: string[] } = {};\n  protected chunks: { [key: string]: string } = {};\n  constructor(protected config: I18nConfig) {\n    const chunks = (config.i18n && config.i18n.chunks) || {};\n    Object.keys(chunks).forEach(chunk => {\n      chunks[chunk].forEach(key => {\n        if (this.chunks.hasOwnProperty(key)) {\n          if (!this.duplicates[key]) {\n            this.duplicates[key] = [this.chunks[key]];\n          }\n          this.duplicates[key].push(chunk);\n        } else {\n          this.chunks[key] = chunk;\n        }\n      });\n    });\n    if (Object.keys(this.duplicates).length > 0 && isDevMode()) {\n      this.warnDuplicates(this.duplicates);\n    }\n  }\n\n  protected readonly KEY_SEPARATOR = '.';\n\n  getChunkNameForKey(key: string): string {\n    const mainKey = (key || '').split(this.KEY_SEPARATOR)[0];\n    const chunk = this.chunks && this.chunks[mainKey];\n\n    if (!chunk) {\n      return mainKey; // fallback to main key as a chunk\n    }\n    return chunk;\n  }\n\n  private warnDuplicates(items: { [key: string]: string[] }): void {\n    const dupes: string[] = [];\n    Object.keys(items).forEach(key => {\n      dupes.push(\n        `* '${key}' found in chunks: ${items[key].join(', ')}. Used '${\n          this.chunks[key]\n        }.${key}'.`\n      );\n    });\n    console.warn(\n      `Duplicated keys has been found in the config of i18n chunks:\\n${dupes.join(\n        '\\n'\n      )}`\n    );\n  }\n}\n","import { HttpClient } from '@angular/common/http';\nimport i18next from 'i18next';\nimport i18nextXhrBackend from 'i18next-xhr-backend';\nimport { ConfigInitializerService } from '../../config/config-initializer/config-initializer.service';\nimport { LanguageService } from '../../site-context/facade/language.service';\nimport { TranslationResources } from '../translation-resources';\n\nexport function i18nextInit(\n  configInit: ConfigInitializerService,\n  languageService: LanguageService,\n  httpClient: HttpClient,\n  serverRequestOrigin: string\n): () => Promise<any> {\n  return () =>\n    configInit.getStableConfig('i18n').then(config => {\n      let i18nextConfig: i18next.InitOptions = {\n        ns: [], // don't preload any namespaces\n        fallbackLng: config.i18n.fallbackLang,\n        debug: config.i18n.debug,\n        interpolation: {\n          escapeValue: false,\n        },\n      };\n      if (config.i18n.backend) {\n        i18next.use(i18nextXhrBackend);\n        const loadPath = getLoadPath(\n          config.i18n.backend.loadPath,\n          serverRequestOrigin\n        );\n        const backend = {\n          loadPath,\n          ajax: i18nextGetHttpClient(httpClient),\n        };\n        i18nextConfig = { ...i18nextConfig, backend };\n      }\n\n      return i18next.init(i18nextConfig, () => {\n        // Don't use i18next's 'resources' config key for adding static translations,\n        // because it will disable loading chunks from backend. We add resources here, in the init's callback.\n        i18nextAddTranslations(config.i18n.resources);\n        syncI18nextWithSiteContext(languageService);\n      });\n    });\n}\n\nexport function i18nextAddTranslations(resources: TranslationResources = {}) {\n  Object.keys(resources).forEach(lang => {\n    Object.keys(resources[lang]).forEach(chunkName => {\n      i18next.addResourceBundle(\n        lang,\n        chunkName,\n        resources[lang][chunkName],\n        true,\n        true\n      );\n    });\n  });\n}\n\nexport function syncI18nextWithSiteContext(language: LanguageService) {\n  // always update language of i18next on site context (language) change\n  language.getActive().subscribe(lang => i18next.changeLanguage(lang));\n}\n\n/**\n * Returns a function appropriate for i18next to make http calls for JSON files.\n * See docs for `i18next-xhr-backend`: https://github.com/i18next/i18next-xhr-backend#backend-options\n *\n * It uses Angular HttpClient under the hood, so it works in SSR.\n * @param httpClient Angular http client\n */\nexport function i18nextGetHttpClient(\n  httpClient: HttpClient\n): (url: string, options: object, callback: Function, data: object) => void {\n  return (url: string, _options: object, callback: Function, _data: object) => {\n    httpClient.get(url, { responseType: 'text' }).subscribe(\n      data => callback(data, { status: 200 }),\n      error => callback(null, { status: error.status })\n    );\n  };\n}\n\n/**\n * Resolves the relative path to the absolute one in SSR, using the server request's origin.\n * It's needed, because Angular Universal doesn't support relative URLs in HttpClient. See Angular issues:\n * - https://github.com/angular/angular/issues/19224\n * - https://github.com/angular/universal/issues/858\n */\nexport function getLoadPath(path: string, serverRequestOrigin: string): string {\n  if (!path) {\n    return undefined;\n  }\n  if (serverRequestOrigin && !path.match(/^http(s)?:\\/\\//)) {\n    if (path.startsWith('/')) {\n      path = path.slice(1);\n    }\n    if (path.startsWith('./')) {\n      path = path.slice(2);\n    }\n    const result = `${serverRequestOrigin}/${path}`;\n    return result;\n  }\n  return path;\n}\n","import { HttpClient } from '@angular/common/http';\nimport { APP_INITIALIZER, Optional, Provider } from '@angular/core';\nimport { ConfigInitializerService } from '../../config/config-initializer/config-initializer.service';\nimport { LanguageService } from '../../site-context/facade/language.service';\nimport { SERVER_REQUEST_ORIGIN } from '../../ssr/ssr.providers';\nimport { i18nextInit } from './i18next-init';\n\nexport const i18nextProviders: Provider[] = [\n  {\n    provide: APP_INITIALIZER,\n    useFactory: i18nextInit,\n    deps: [\n      ConfigInitializerService,\n      LanguageService,\n      HttpClient,\n      [new Optional(), SERVER_REQUEST_ORIGIN],\n    ],\n    multi: true,\n  },\n];\n","import { I18nConfig } from './i18n-config';\n\nexport const defaultI18nConfig: I18nConfig = {\n  i18n: {\n    fallbackLang: false,\n    debug: false,\n  },\n};\n","import { Injectable, isDevMode } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { TranslationService } from '../translation.service';\nimport i18next from 'i18next';\nimport { I18nConfig } from '../config/i18n-config';\nimport { TranslationChunkService } from '../translation-chunk.service';\n\n@Injectable()\nexport class I18nextTranslationService implements TranslationService {\n  private readonly NON_BREAKING_SPACE = String.fromCharCode(160);\n  protected readonly NAMESPACE_SEPARATOR = ':';\n\n  constructor(\n    protected config: I18nConfig,\n    protected translationChunk: TranslationChunkService\n  ) {}\n\n  translate(\n    key: string,\n    options: any = {},\n    whitespaceUntilLoaded: boolean = false\n  ): Observable<string> {\n    // If we've already loaded the chunk (or failed to load), we should immediately emit the value\n    // (or the fallback value in case the key is missing).\n\n    // Moreover, we SHOULD emit a value (or a fallback value) synchronously (not in a promise/setTimeout).\n    // Otherwise, we the will trigger additional deferred change detection in a view that consumes the returned observable,\n    // which together with `switchMap` operator may lead to an infinite loop.\n\n    const chunkName = this.translationChunk.getChunkNameForKey(key);\n    const namespacedKey = this.getNamespacedKey(key, chunkName);\n\n    return new Observable<string>(subscriber => {\n      const translate = () => {\n        if (i18next.exists(namespacedKey, options)) {\n          subscriber.next(i18next.t(namespacedKey, options));\n        } else {\n          if (whitespaceUntilLoaded) {\n            subscriber.next(this.NON_BREAKING_SPACE);\n          }\n          i18next.loadNamespaces(chunkName, () => {\n            if (!i18next.exists(namespacedKey, options)) {\n              this.reportMissingKey(key, chunkName);\n              subscriber.next(this.getFallbackValue(namespacedKey));\n            } else {\n              subscriber.next(i18next.t(namespacedKey, options));\n            }\n          });\n        }\n      };\n\n      translate();\n      i18next.on('languageChanged', translate);\n      return () => i18next.off('languageChanged', translate);\n    });\n  }\n\n  loadChunks(chunkNames: string | string[]): Promise<any> {\n    return i18next.loadNamespaces(chunkNames);\n  }\n\n  /**\n   * Returns a fallback value in case when the given key is missing\n   * @param key\n   */\n  protected getFallbackValue(key: string): string {\n    return isDevMode() ? `[${key}]` : this.NON_BREAKING_SPACE;\n  }\n\n  private reportMissingKey(key: string, chunkName: string) {\n    if (isDevMode()) {\n      console.warn(\n        `Translation key missing '${key}' in the chunk '${chunkName}'`\n      );\n    }\n  }\n\n  private getNamespacedKey(key: string, chunk: string): string {\n    return chunk + this.NAMESPACE_SEPARATOR + key;\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { TranslatePipe } from './translate.pipe';\nimport { i18nextProviders } from './i18next/i18next-providers';\nimport { defaultI18nConfig } from './config/default-i18n-config';\nimport { I18nConfig } from './config/i18n-config';\nimport { TranslationService } from './translation.service';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { I18nextTranslationService } from './i18next/i18next-translation.service';\nimport { CxDatePipe } from './date.pipe';\nimport { TranslationChunkService } from './translation-chunk.service';\n\n@NgModule({\n  declarations: [TranslatePipe, CxDatePipe],\n  exports: [TranslatePipe, CxDatePipe],\n})\nexport class I18nModule {\n  static forRoot(): ModuleWithProviders<I18nModule> {\n    return {\n      ngModule: I18nModule,\n      providers: [\n        provideDefaultConfig(defaultI18nConfig),\n        { provide: I18nConfig, useExisting: Config },\n        { provide: TranslationService, useClass: I18nextTranslationService },\n        TranslationChunkService,\n        ...i18nextProviders,\n      ],\n    };\n  }\n}\n","export function mockTranslate(key: string, options: any = {}) {\n  const optionsString = Object.keys(options)\n    .sort()\n    .map(optionName => `${optionName}:${options[optionName]}`)\n    .join(' ');\n  return optionsString ? `${key} ${optionsString}` : key;\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { mockTranslate } from './mock-translate';\nimport { Translatable } from '../translatable';\n\n@Pipe({ name: 'cxTranslate' })\nexport class MockTranslatePipe implements PipeTransform {\n  transform(input: Translatable | string, options: object = {}): string {\n    if ((input as Translatable).raw) {\n      return (input as Translatable).raw;\n    }\n\n    const key = typeof input === 'string' ? input : input.key;\n    if (typeof input !== 'string') {\n      options = { ...options, ...input.params };\n    }\n    return mockTranslate(key, options);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { TranslationService } from '../translation.service';\nimport { mockTranslate } from './mock-translate';\n\n@Injectable()\nexport class MockTranslationService implements TranslationService {\n  translate(\n    key: string,\n    options: any = {},\n    _whitespaceUntilLoaded: boolean = false\n  ): Observable<string> {\n    return new Observable<string>(subscriber => {\n      const value = mockTranslate(key, options);\n      subscriber.next(value);\n      subscriber.complete();\n    });\n  }\n\n  loadChunks(_chunks: string | string[]): Promise<any> {\n    return Promise.resolve();\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { DatePipe } from '@angular/common';\n\n@Pipe({ name: 'cxDate' })\nexport class MockDatePipe extends DatePipe implements PipeTransform {\n  transform(value: any, format?: string, timezone?: string): string {\n    return super.transform(value, format, timezone, 'en');\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { MockTranslatePipe } from './mock-translate.pipe';\nimport { TranslationService } from '../translation.service';\nimport { MockTranslationService } from './mock-translation.service';\nimport { MockDatePipe } from './mock-date.pipe';\n\n@NgModule({\n  declarations: [MockTranslatePipe, MockDatePipe],\n  exports: [MockTranslatePipe, MockDatePipe],\n  providers: [\n    { provide: TranslationService, useClass: MockTranslationService },\n  ],\n})\nexport class I18nTestingModule {}\n","import { OccConfig } from '../../occ/config/occ-config';\n\nexport abstract class KymaConfig extends OccConfig {\n  authentication?: {\n    /**\n     * If set to `true`, the integration with kyma will be enabled, and Open ID token will be retrieved when registering/logging in,\n     */\n    kyma_enabled?: boolean;\n    kyma_client_id?: string;\n    kyma_client_secret?: string;\n  };\n}\n","import { LoaderState } from '../../state/utils/loader/loader-state';\nimport { OpenIdToken } from '../models/kyma-token-types.model';\n\nexport const KYMA_FEATURE = 'kyma';\nexport const OPEN_ID_TOKEN_DATA = '[Kyma Auth] Open ID Token Data';\n\nexport interface StateWithKyma {\n  [KYMA_FEATURE]: KymaState;\n}\n\nexport interface KymaState {\n  openIdToken: LoaderState<OpenIdToken>;\n}\n","import { StateLoaderActions } from '../../../state/utils/index';\nimport { OpenIdToken } from '../../models/kyma-token-types.model';\nimport { OPEN_ID_TOKEN_DATA } from '../kyma-state';\n\nexport const LOAD_OPEN_ID_TOKEN = '[Kyma] Load Open ID Token';\nexport const LOAD_OPEN_ID_TOKEN_FAIL = '[Kyma] Load Open ID Token Fail';\nexport const LOAD_OPEN_ID_TOKEN_SUCCESS = '[Kyma] Load Open ID Token Success';\n\nexport class LoadOpenIdToken extends StateLoaderActions.LoaderLoadAction {\n  readonly type = LOAD_OPEN_ID_TOKEN;\n  constructor(public payload: { username: string; password: string }) {\n    super(OPEN_ID_TOKEN_DATA);\n  }\n}\n\nexport class LoadOpenIdTokenFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = LOAD_OPEN_ID_TOKEN_FAIL;\n  constructor(public payload: any) {\n    super(OPEN_ID_TOKEN_DATA, payload);\n  }\n}\n\nexport class LoadOpenIdTokenSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = LOAD_OPEN_ID_TOKEN_SUCCESS;\n  constructor(public payload: OpenIdToken) {\n    super(OPEN_ID_TOKEN_DATA);\n  }\n}\n\nexport type OpenIdTokenActions =\n  | LoadOpenIdToken\n  | LoadOpenIdTokenFail\n  | LoadOpenIdTokenSuccess;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport { KymaState, KYMA_FEATURE, StateWithKyma } from '../kyma-state';\n\nexport const getKymaState: MemoizedSelector<\n  StateWithKyma,\n  KymaState\n> = createFeatureSelector<KymaState>(KYMA_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { OpenIdToken } from '../../models/kyma-token-types.model';\nimport { StateWithKyma } from '../kyma-state';\nimport { getKymaState } from './feature.selector';\n\nexport const getOpenIdTokenState: MemoizedSelector<\n  StateWithKyma,\n  LoaderState<OpenIdToken>\n> = createSelector(getKymaState, state => state.openIdToken);\n\nexport const getOpenIdTokenValue: MemoizedSelector<\n  StateWithKyma,\n  OpenIdToken\n> = createSelector(\n  getOpenIdTokenState,\n  StateLoaderSelectors.loaderValueSelector\n);\n\nexport const getOpenIdTokenLoading: MemoizedSelector<\n  StateWithKyma,\n  boolean\n> = createSelector(\n  getOpenIdTokenState,\n  StateLoaderSelectors.loaderLoadingSelector\n);\n\nexport const getOpenIdTokenSuccess: MemoizedSelector<\n  StateWithKyma,\n  boolean\n> = createSelector(\n  getOpenIdTokenState,\n  StateLoaderSelectors.loaderSuccessSelector\n);\n\nexport const getOpenIdTokenError: MemoizedSelector<\n  StateWithKyma,\n  boolean\n> = createSelector(\n  getOpenIdTokenState,\n  StateLoaderSelectors.loaderErrorSelector\n);\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { OpenIdToken } from '../models/kyma-token-types.model';\nimport { KymaActions } from '../store/actions/index';\nimport { StateWithKyma } from '../store/kyma-state';\nimport { KymaSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class KymaService {\n  constructor(protected store: Store<StateWithKyma>) {}\n\n  /**\n   * Authorizes using the Kyma OAuth client with scope `openid`.\n   *\n   * @param username a username\n   * @param password a password\n   */\n  authorizeOpenId(username: string, password: string): void {\n    this.store.dispatch(\n      new KymaActions.LoadOpenIdToken({ username, password })\n    );\n  }\n\n  /**\n   * Returns the `OpenIdToken`, which was previously retrieved using `authorizeOpenId` method.\n   */\n  getOpenIdToken(): Observable<OpenIdToken> {\n    return this.store.pipe(select(KymaSelectors.getOpenIdTokenValue));\n  }\n}\n","import { KymaConfig } from './kyma-config';\n\nexport const defaultKymaConfig: KymaConfig = {\n  authentication: {\n    kyma_enabled: false,\n    kyma_client_id: 'client4kyma',\n    kyma_client_secret: 'secret',\n  },\n};\n","import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { KymaConfig } from '../../config/kyma-config';\nimport { OpenIdToken } from '../../models/kyma-token-types.model';\n\nconst OAUTH_ENDPOINT = '/authorizationserver/oauth/token';\n\n@Injectable()\nexport class OpenIdAuthenticationTokenService {\n  constructor(private config: KymaConfig, private http: HttpClient) {}\n\n  loadOpenIdAuthenticationToken(\n    username: string,\n    password: string\n  ): Observable<OpenIdToken> {\n    const url = this.getOAuthEndpoint();\n    const params = new HttpParams()\n      .set(\n        'client_id',\n        encodeURIComponent(this.config.authentication.kyma_client_id)\n      )\n      .set(\n        'client_secret',\n        encodeURIComponent(this.config.authentication.kyma_client_secret)\n      )\n      .set('grant_type', 'password') // authorization_code, client_credentials, password\n      .set('username', username)\n      .set('password', password)\n      .set('scope', 'openid');\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n    });\n\n    return this.http\n      .post<OpenIdToken>(url, params, { headers })\n      .pipe(catchError(error => throwError(error)));\n  }\n\n  private getOAuthEndpoint(): string {\n    return (this.config.backend.occ.baseUrl || '') + OAUTH_ENDPOINT;\n  }\n}\n","import { OpenIdAuthenticationTokenService } from './open-id-token/open-id-token.service';\n\nexport const KymaServices: any[] = [OpenIdAuthenticationTokenService];\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { iif, Observable, of } from 'rxjs';\nimport { catchError, exhaustMap, map, withLatestFrom } from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { KymaConfig } from '../../config/kyma-config';\nimport { OpenIdAuthenticationTokenService } from '../../services/open-id-token/open-id-token.service';\nimport { KymaActions } from '../actions/index';\n\n@Injectable()\nexport class OpenIdTokenEffect {\n  @Effect()\n  triggerOpenIdTokenLoading$: Observable<KymaActions.LoadOpenIdToken> = iif<\n    KymaActions.LoadOpenIdToken,\n    KymaActions.LoadOpenIdToken\n  >(\n    () => this.config.authentication && this.config.authentication.kyma_enabled,\n    this.actions$.pipe(\n      ofType<KymaActions.LoadOpenIdTokenSuccess>(\n        AuthActions.LOAD_USER_TOKEN_SUCCESS\n      ),\n      withLatestFrom(\n        this.actions$.pipe(\n          ofType<AuthActions.LoadUserToken>(AuthActions.LOAD_USER_TOKEN)\n        )\n      ),\n      map(\n        ([, loginAction]) =>\n          new KymaActions.LoadOpenIdToken({\n            username: loginAction.payload.userId,\n            password: loginAction.payload.password,\n          })\n      )\n    )\n  );\n\n  @Effect()\n  loadOpenIdToken$: Observable<\n    KymaActions.OpenIdTokenActions\n  > = this.actions$.pipe(\n    ofType(KymaActions.LOAD_OPEN_ID_TOKEN),\n    map((action: KymaActions.LoadOpenIdToken) => action.payload),\n    exhaustMap(payload =>\n      this.openIdTokenService\n        .loadOpenIdAuthenticationToken(payload.username, payload.password)\n        .pipe(\n          map(token => new KymaActions.LoadOpenIdTokenSuccess(token)),\n          catchError(error =>\n            of(\n              new KymaActions.LoadOpenIdTokenFail(makeErrorSerializable(error))\n            )\n          )\n        )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private openIdTokenService: OpenIdAuthenticationTokenService,\n    private config: KymaConfig\n  ) {}\n}\n","import { OpenIdTokenEffect } from './open-id-token.effect';\n\nexport const effects: any[] = [OpenIdTokenEffect];\n\nexport * from './open-id-token.effect';\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  Action,\n  ActionReducer,\n  ActionReducerMap,\n  MetaReducer,\n} from '@ngrx/store';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport { OpenIdToken } from '../../models/kyma-token-types.model';\nimport { KymaState, OPEN_ID_TOKEN_DATA } from '../kyma-state';\n\nexport function getReducers(): ActionReducerMap<KymaState> {\n  return {\n    openIdToken: loaderReducer<OpenIdToken>(OPEN_ID_TOKEN_DATA),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  KymaState\n>> = new InjectionToken<ActionReducerMap<KymaState>>('KymaReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearKymaState(\n  reducer: ActionReducer<KymaState, Action>\n): ActionReducer<KymaState, Action> {\n  return function(state, action) {\n    if (action.type === AuthActions.LOGOUT) {\n      state = {\n        ...state,\n        openIdToken: undefined,\n      };\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearKymaState];\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { provideDefaultConfigFactory } from '../../config/config.module';\nimport { StateConfig, StorageSyncType } from '../../state/config/state-config';\nimport { StateModule } from '../../state/state.module';\nimport { effects } from './effects/index';\nimport { KYMA_FEATURE } from './kyma-state';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function kymaStoreConfigFactory(): StateConfig {\n  // if we want to reuse KYMA_FEATURE const in config, we have to use factory instead of plain object\n  const config: StateConfig = {\n    state: {\n      storageSync: {\n        keys: {\n          'kyma.openIdToken.value': StorageSyncType.LOCAL_STORAGE,\n        },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StateModule,\n    StoreModule.forFeature(KYMA_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(kymaStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class KymaStoreModule {}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { defaultKymaConfig } from './config/default-kyma-config';\nimport { KymaConfig } from './config/kyma-config';\nimport { KymaServices } from './services/index';\nimport { KymaStoreModule } from './store/kyma-store.module';\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule, KymaStoreModule],\n  providers: [\n    provideDefaultConfig(defaultKymaConfig),\n    ...KymaServices,\n    { provide: KymaConfig, useExisting: Config },\n  ],\n})\nexport class KymaModule {}\n","export abstract class PersonalizationConfig {\n  personalization: {\n    enabled?: boolean;\n    httpHeaderName?: {\n      id: string;\n      timestamp: string;\n    };\n    context?: {\n      slotPosition?: string;\n      componentId?: string;\n    };\n  };\n}\n","import { PersonalizationConfig } from './personalization-config';\n\nexport const defaultPersonalizationConfig: PersonalizationConfig = {\n  personalization: {\n    enabled: false,\n    httpHeaderName: {\n      id: 'Occ-Personalization-Id',\n      timestamp: 'Occ-Personalization-Time',\n    },\n    context: {\n      slotPosition: 'PlaceholderContentSlot',\n      componentId: 'PersonalizationScriptComponent',\n    },\n  },\n};\n","import { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\n\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\nimport { PersonalizationConfig } from '../config/personalization-config';\nimport { WindowRef } from '../../window/window-ref';\nimport { isPlatformBrowser } from '@angular/common';\n\nconst PERSONALIZATION_ID_KEY = 'personalization-id';\n\n@Injectable({ providedIn: 'root' })\nexport class OccPersonalizationIdInterceptor implements HttpInterceptor {\n  private personalizationId: string;\n  private requestHeader: string;\n  private enabled = false;\n\n  constructor(\n    private config: PersonalizationConfig,\n    private occEndpoints: OccEndpointsService,\n    private winRef: WindowRef,\n    @Inject(PLATFORM_ID) private platform: any\n  ) {\n    if (isPlatformBrowser(this.platform)) {\n      this.enabled =\n        (this.winRef.localStorage && this.config.personalization.enabled) ||\n        false;\n\n      if (this.enabled) {\n        this.requestHeader = this.config.personalization.httpHeaderName.id.toLowerCase();\n        this.personalizationId = this.winRef.localStorage.getItem(\n          PERSONALIZATION_ID_KEY\n        );\n      } else if (this.winRef.localStorage.getItem(PERSONALIZATION_ID_KEY)) {\n        this.winRef.localStorage.removeItem(PERSONALIZATION_ID_KEY);\n      }\n    }\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (!this.enabled) {\n      return next.handle(request);\n    }\n\n    if (\n      this.personalizationId &&\n      request.url.includes(this.occEndpoints.getBaseEndpoint())\n    ) {\n      request = request.clone({\n        setHeaders: {\n          [this.requestHeader]: this.personalizationId,\n        },\n      });\n    }\n\n    return next.handle(request).pipe(\n      tap(event => {\n        if (event instanceof HttpResponse) {\n          if (event.headers.keys().includes(this.requestHeader)) {\n            const receivedId = event.headers.get(this.requestHeader);\n            if (this.personalizationId !== receivedId) {\n              this.personalizationId = receivedId;\n              this.winRef.localStorage.setItem(\n                PERSONALIZATION_ID_KEY,\n                this.personalizationId\n              );\n            }\n          }\n        }\n      })\n    );\n  }\n}\n","import { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport {\n  HttpEvent,\n  HttpHandler,\n  HttpInterceptor,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\n\nimport { OccEndpointsService } from '../../occ/services/occ-endpoints.service';\nimport { PersonalizationConfig } from '../config/personalization-config';\nimport { WindowRef } from '../../window/window-ref';\nimport { isPlatformBrowser } from '@angular/common';\n\nconst PERSONALIZATION_TIME_KEY = 'personalization-time';\n\n@Injectable({ providedIn: 'root' })\nexport class OccPersonalizationTimeInterceptor implements HttpInterceptor {\n  private timestamp: string;\n  private requestHeader: string;\n  private enabled = false;\n\n  constructor(\n    private config: PersonalizationConfig,\n    private occEndpoints: OccEndpointsService,\n    private winRef: WindowRef,\n    @Inject(PLATFORM_ID) private platform: any\n  ) {\n    if (isPlatformBrowser(this.platform)) {\n      this.enabled =\n        (this.winRef.localStorage && this.config.personalization.enabled) ||\n        false;\n\n      if (this.enabled) {\n        this.requestHeader = this.config.personalization.httpHeaderName.timestamp.toLowerCase();\n        this.timestamp = this.winRef.localStorage.getItem(\n          PERSONALIZATION_TIME_KEY\n        );\n      } else if (this.winRef.localStorage.getItem(PERSONALIZATION_TIME_KEY)) {\n        this.winRef.localStorage.removeItem(PERSONALIZATION_TIME_KEY);\n      }\n    }\n  }\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (!this.enabled) {\n      return next.handle(request);\n    }\n\n    if (\n      this.timestamp &&\n      request.url.includes(this.occEndpoints.getBaseEndpoint())\n    ) {\n      request = request.clone({\n        setHeaders: {\n          [this.requestHeader]: this.timestamp,\n        },\n      });\n    }\n\n    return next.handle(request).pipe(\n      tap(event => {\n        if (event instanceof HttpResponse) {\n          if (event.headers.keys().includes(this.requestHeader)) {\n            const receivedTimestamp = event.headers.get(this.requestHeader);\n            if (this.timestamp !== receivedTimestamp) {\n              this.timestamp = receivedTimestamp;\n              this.winRef.localStorage.setItem(\n                PERSONALIZATION_TIME_KEY,\n                this.timestamp\n              );\n            }\n          }\n        }\n      })\n    );\n  }\n}\n","import { Provider } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\n\nimport { OccPersonalizationIdInterceptor } from './occ-personalization-id.interceptor';\nimport { OccPersonalizationTimeInterceptor } from './occ-personalization-time.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: OccPersonalizationIdInterceptor,\n    multi: true,\n  },\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: OccPersonalizationTimeInterceptor,\n    multi: true,\n  },\n];\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { PersonalizationConfig } from './config/personalization-config';\nimport { defaultPersonalizationConfig } from './config/default-personalization-config';\n\nimport { interceptors } from './http-interceptors/index';\n\n@NgModule({\n  providers: [{ provide: PersonalizationConfig, useExisting: Config }],\n})\nexport class PersonalizationModule {\n  static forRoot(): ModuleWithProviders<PersonalizationModule> {\n    return {\n      ngModule: PersonalizationModule,\n      providers: [\n        provideDefaultConfig(defaultPersonalizationConfig),\n        ...interceptors,\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { filter, map } from 'rxjs/operators';\nimport { PersonalizationConfig } from '../config/personalization-config';\nimport { PersonalizationContext } from '../model/personalization-context.model';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { Page } from '../../cms/model/page.model';\nimport { ContentSlotData } from '../../cms/model/content-slot-data.model';\nimport { ContentSlotComponentData } from '../../cms/model/content-slot-component-data.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class PersonalizationContextService {\n  constructor(\n    protected config: PersonalizationConfig,\n    protected cmsService: CmsService\n  ) {}\n\n  getPersonalizationContext(): Observable<PersonalizationContext> {\n    return this.cmsService.getCurrentPage().pipe(\n      filter(Boolean),\n      map(\n        (page: Page) =>\n          page.slots[this.config.personalization.context.slotPosition]\n      ),\n      filter(Boolean),\n      map((slot: ContentSlotData) =>\n        slot.components.find(\n          i => i.uid === this.config.personalization.context.componentId\n        )\n      ),\n      filter(Boolean),\n      map((component: ContentSlotComponentData) =>\n        this.buildPersonalizationContext(component.properties.script.data)\n      )\n    );\n  }\n\n  private buildPersonalizationContext(data: string): PersonalizationContext {\n    const context = JSON.parse(atob(data));\n    context.actions.forEach(action => {\n      Object.keys(action).forEach(key => {\n        action[key] = atob(action[key]);\n      });\n    });\n    for (let i = 0; i < context.segments.length; i++) {\n      context.segments[i] = atob(context.segments[i]);\n    }\n    return context;\n  }\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducer, ActionReducerMap } from '@ngrx/store';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\nimport { entityLoaderReducer } from '../../../state/utils/entity-loader/entity-loader.reducer';\nimport { PROCESS_FEATURE } from '../process-state';\n\nexport function getReducers<T>(): ActionReducer<EntityLoaderState<T>> {\n  return entityLoaderReducer(PROCESS_FEATURE);\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  EntityLoaderState<any>\n>> = new InjectionToken<ActionReducerMap<EntityLoaderState<any>>>(\n  'ProcessReducers'\n);\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n","import {\n  ENTITY_FAIL_ACTION,\n  ENTITY_LOAD_ACTION,\n  ENTITY_RESET_ACTION,\n  ENTITY_SUCCESS_ACTION,\n  entityFailMeta,\n  EntityLoaderMeta,\n  entityLoadMeta,\n  entityResetMeta,\n  entitySuccessMeta,\n} from '../entity-loader/entity-loader.action';\nimport { Action } from '@ngrx/store';\n\nexport namespace EntityScopedLoaderActions {\n  export interface EntityScopedLoaderMeta extends EntityLoaderMeta {\n    scope?: string;\n  }\n\n  export interface EntityScopedLoaderAction extends Action {\n    readonly payload?: any;\n    readonly meta?: EntityScopedLoaderMeta;\n  }\n\n  export function entityScopedLoadMeta(\n    entityType: string,\n    id: string | string[],\n    scope?: string\n  ): EntityScopedLoaderMeta {\n    return {\n      ...entityLoadMeta(entityType, id),\n      scope,\n    };\n  }\n\n  export function entityScopedFailMeta(\n    entityType: string,\n    id: string | string[],\n    scope?: string,\n    error?: any\n  ): EntityScopedLoaderMeta {\n    return {\n      ...entityFailMeta(entityType, id, error),\n      scope,\n    };\n  }\n\n  export function entityScopedSuccessMeta(\n    entityType: string,\n    id: string | string[],\n    scope?: string\n  ): EntityScopedLoaderMeta {\n    return {\n      ...entitySuccessMeta(entityType, id),\n      scope,\n    };\n  }\n\n  export function entityScopedResetMeta(\n    entityType: string,\n    id: string | string[],\n    scope?: string\n  ): EntityScopedLoaderMeta {\n    return {\n      ...entityResetMeta(entityType, id),\n      scope,\n    };\n  }\n\n  export class EntityScopedLoadAction implements EntityScopedLoaderAction {\n    type = ENTITY_LOAD_ACTION;\n    readonly meta: EntityScopedLoaderMeta;\n    constructor(entityType: string, id: string | string[], scope?: string) {\n      this.meta = entityScopedLoadMeta(entityType, id, scope);\n    }\n  }\n\n  export class EntityScopedFailAction implements EntityScopedLoaderAction {\n    type = ENTITY_FAIL_ACTION;\n    readonly meta: EntityScopedLoaderMeta;\n    constructor(\n      entityType: string,\n      id: string | string[],\n      scope?: string,\n      error?: any\n    ) {\n      this.meta = entityScopedFailMeta(entityType, id, scope, error);\n    }\n  }\n\n  export class EntityScopedSuccessAction implements EntityScopedLoaderAction {\n    type = ENTITY_SUCCESS_ACTION;\n    readonly meta: EntityScopedLoaderMeta;\n    constructor(\n      entityType: string,\n      id: string | string[],\n      scope?: string,\n      public payload?: any\n    ) {\n      this.meta = entityScopedSuccessMeta(entityType, id, scope);\n    }\n  }\n\n  export class EntityScopedResetAction implements EntityScopedLoaderAction {\n    type = ENTITY_RESET_ACTION;\n    readonly meta: EntityScopedLoaderMeta;\n    constructor(entityType: string, id: string | string[], scope?: string) {\n      this.meta = entityScopedResetMeta(entityType, id, scope);\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { StoreModule } from '@ngrx/store';\nimport { StateModule } from '../../state/state.module';\nimport { PROCESS_FEATURE } from './process-state';\nimport { reducerProvider, reducerToken } from './reducers/index';\n\n@NgModule({\n  imports: [StateModule, StoreModule.forFeature(PROCESS_FEATURE, reducerToken)],\n  providers: [reducerProvider],\n})\nexport class ProcessStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { ProcessStoreModule } from './store/process-store.module';\n\n@NgModule({\n  imports: [ProcessStoreModule],\n})\nexport class ProcessModule {\n  static forRoot(): ModuleWithProviders<ProcessModule> {\n    return {\n      ngModule: ProcessModule,\n      providers: [],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Product } from '../../../model/product.model';\nimport { ProductAdapter } from './product.adapter';\nimport { ScopedProductData } from './scoped-product-data';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductConnector {\n  constructor(protected adapter: ProductAdapter) {}\n\n  get(productCode: string, scope = ''): Observable<Product> {\n    return this.adapter.load(productCode, scope);\n  }\n\n  getMany(products: ScopedProductData[]): ScopedProductData[] {\n    if (!this.adapter.loadMany) {\n      return products.map(product => ({\n        ...product,\n        data$: this.adapter.load(product.code, product.scope),\n      }));\n    }\n\n    return this.adapter.loadMany(products);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ProductReference } from '../../../model/product.model';\nimport { ProductReferencesAdapter } from './product-references.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductReferencesConnector {\n  constructor(protected adapter: ProductReferencesAdapter) {}\n\n  get(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]> {\n    return this.adapter.load(productCode, referenceType, pageSize);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ProductReviewsAdapter } from './product-reviews.adapter';\nimport { Review } from '../../../model/product.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductReviewsConnector {\n  constructor(protected adapter: ProductReviewsAdapter) {}\n\n  get(productCode: string, maxCount?: number): Observable<Review[]> {\n    return this.adapter.load(productCode, maxCount);\n  }\n\n  add(productCode: string, review: any): Observable<Review> {\n    return this.adapter.post(productCode, review);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ProductSearchAdapter } from './product-search.adapter';\nimport { SearchConfig } from '../../model/search-config';\nimport { Observable } from 'rxjs';\nimport {\n  Suggestion,\n  ProductSearchPage,\n} from '../../../model/product-search.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductSearchConnector {\n  constructor(protected adapter: ProductSearchAdapter) {}\n\n  search(\n    query: string,\n    searchConfig?: SearchConfig\n  ): Observable<ProductSearchPage> {\n    return this.adapter.search(query, searchConfig);\n  }\n\n  getSuggestions(term: string, pageSize?: number): Observable<Suggestion[]> {\n    return this.adapter.loadSuggestions(term, pageSize);\n  }\n}\n","import { Action } from '@ngrx/store';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { ProductReference } from '../../../model/product.model';\n\nexport const LOAD_PRODUCT_REFERENCES = '[Product] Load Product References Data';\nexport const LOAD_PRODUCT_REFERENCES_FAIL =\n  '[Product] Load Product References Data Fail';\nexport const LOAD_PRODUCT_REFERENCES_SUCCESS =\n  '[Product] Load Product References Data Success';\nexport const CLEAN_PRODUCT_REFERENCES = '[Product] Clean Product References';\n\nexport class LoadProductReferences implements Action {\n  readonly type = LOAD_PRODUCT_REFERENCES;\n  constructor(\n    public payload: {\n      productCode: string;\n      referenceType?: string;\n      pageSize?: number;\n    }\n  ) {}\n}\n\nexport class LoadProductReferencesFail implements Action {\n  readonly type = LOAD_PRODUCT_REFERENCES_FAIL;\n  constructor(public payload: ErrorModel) {}\n}\n\nexport class LoadProductReferencesSuccess implements Action {\n  readonly type = LOAD_PRODUCT_REFERENCES_SUCCESS;\n  constructor(\n    public payload: {\n      productCode: string;\n      list: ProductReference[];\n    }\n  ) {}\n}\n\nexport class CleanProductReferences implements Action {\n  readonly type = CLEAN_PRODUCT_REFERENCES;\n}\n\n// action types\nexport type ProductReferencesAction =\n  | LoadProductReferences\n  | LoadProductReferencesFail\n  | LoadProductReferencesSuccess\n  | CleanProductReferences;\n","import { Action } from '@ngrx/store';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { Review } from '../../../model/product.model';\n\nexport const LOAD_PRODUCT_REVIEWS = '[Product] Load Product Reviews Data';\nexport const LOAD_PRODUCT_REVIEWS_FAIL =\n  '[Product] Load Product Reviews Data Fail';\nexport const LOAD_PRODUCT_REVIEWS_SUCCESS =\n  '[Product] Load Product Reviews Data Success';\nexport const POST_PRODUCT_REVIEW = '[Product] Post Product Review';\nexport const POST_PRODUCT_REVIEW_FAIL = '[Product] Post Product Review Fail';\nexport const POST_PRODUCT_REVIEW_SUCCESS =\n  '[Product] Post Product Review Success';\n\nexport class LoadProductReviews implements Action {\n  readonly type = LOAD_PRODUCT_REVIEWS;\n  constructor(public payload: string) {}\n}\n\nexport class LoadProductReviewsFail implements Action {\n  readonly type = LOAD_PRODUCT_REVIEWS_FAIL;\n  constructor(public payload: ErrorModel) {}\n}\n\nexport class LoadProductReviewsSuccess implements Action {\n  readonly type = LOAD_PRODUCT_REVIEWS_SUCCESS;\n  constructor(public payload: { productCode: string; list: Review[] }) {}\n}\n\nexport class PostProductReview implements Action {\n  readonly type = POST_PRODUCT_REVIEW;\n  constructor(public payload: { productCode: string; review: Review }) {}\n}\n\nexport class PostProductReviewFail implements Action {\n  readonly type = POST_PRODUCT_REVIEW_FAIL;\n  constructor(public payload: string) {}\n}\n\nexport class PostProductReviewSuccess implements Action {\n  readonly type = POST_PRODUCT_REVIEW_SUCCESS;\n  constructor(public payload: Review) {}\n}\n\n// action types\nexport type ProductReviewsAction =\n  | LoadProductReviews\n  | LoadProductReviewsFail\n  | LoadProductReviewsSuccess\n  | PostProductReview\n  | PostProductReviewFail\n  | PostProductReviewSuccess;\n","import { Action } from '@ngrx/store';\nimport { ErrorModel } from '../../../model/misc.model';\nimport {\n  ClearSearch,\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport { SearchConfig } from '../../model/search-config';\n\nexport const SEARCH_PRODUCTS = '[Product] Search Products';\nexport const SEARCH_PRODUCTS_FAIL = '[Product] Search Products Fail';\nexport const SEARCH_PRODUCTS_SUCCESS = '[Product] Search Products Success';\nexport const GET_PRODUCT_SUGGESTIONS = '[Product] Get Product Suggestions';\nexport const GET_PRODUCT_SUGGESTIONS_SUCCESS =\n  '[Product] Get Product Suggestions Success';\nexport const GET_PRODUCT_SUGGESTIONS_FAIL =\n  '[Product] Get Product Suggestions Fail';\nexport const CLEAR_PRODUCT_SEARCH_RESULT =\n  '[Product] Clear Product Search Result';\n\nexport class SearchProducts implements Action {\n  readonly type = SEARCH_PRODUCTS;\n  constructor(\n    public payload: { queryText: string; searchConfig: SearchConfig },\n    public auxiliary?: boolean\n  ) {}\n}\n\nexport class SearchProductsFail implements Action {\n  readonly type = SEARCH_PRODUCTS_FAIL;\n  constructor(public payload: ErrorModel, public auxiliary?: boolean) {}\n}\n\nexport class SearchProductsSuccess implements Action {\n  readonly type = SEARCH_PRODUCTS_SUCCESS;\n  constructor(public payload: ProductSearchPage, public auxiliary?: boolean) {}\n}\n\nexport class GetProductSuggestions implements Action {\n  readonly type = GET_PRODUCT_SUGGESTIONS;\n  constructor(public payload: { term: string; searchConfig: SearchConfig }) {}\n}\n\nexport class GetProductSuggestionsSuccess implements Action {\n  readonly type = GET_PRODUCT_SUGGESTIONS_SUCCESS;\n  constructor(public payload: Suggestion[]) {}\n}\n\nexport class GetProductSuggestionsFail implements Action {\n  readonly type = GET_PRODUCT_SUGGESTIONS_FAIL;\n  constructor(public payload: ErrorModel) {}\n}\n\nexport class ClearProductSearchResult implements Action {\n  readonly type = CLEAR_PRODUCT_SEARCH_RESULT;\n  constructor(\n    public payload: ClearSearch = {\n      clearPageResults: false,\n      clearSearchboxResults: false,\n    }\n  ) {}\n}\n\n// action types\nexport type ProductSearchAction =\n  | SearchProducts\n  | SearchProductsFail\n  | SearchProductsSuccess\n  | GetProductSuggestions\n  | GetProductSuggestionsSuccess\n  | GetProductSuggestionsFail\n  | ClearProductSearchResult;\n","import { Product } from '../../../model/product.model';\nimport { PRODUCT_DETAIL_ENTITY } from '../product-state';\nimport { EntityLoaderMeta } from '../../../state/utils/entity-loader/entity-loader.action';\nimport { Action } from '@ngrx/store';\nimport { EntityScopedLoaderActions } from '../../../state/utils/scoped-loader/entity-scoped-loader.actions';\n\nexport const LOAD_PRODUCT = '[Product] Load Product Data';\nexport const LOAD_PRODUCT_FAIL = '[Product] Load Product Data Fail';\nexport const LOAD_PRODUCT_SUCCESS = '[Product] Load Product Data Success';\n\nexport interface ProductMeta extends EntityLoaderMeta {\n  scope?: string;\n}\n\nexport interface EntityScopedLoaderAction extends Action {\n  readonly payload?: any;\n  readonly meta?: ProductMeta;\n}\n\nexport class LoadProduct extends EntityScopedLoaderActions.EntityScopedLoadAction {\n  readonly type = LOAD_PRODUCT;\n  constructor(public payload: string, scope = '') {\n    super(PRODUCT_DETAIL_ENTITY, payload, scope);\n  }\n}\n\nexport class LoadProductFail extends EntityScopedLoaderActions.EntityScopedFailAction {\n  readonly type = LOAD_PRODUCT_FAIL;\n  constructor(productCode: string, public payload: any, scope = '') {\n    super(PRODUCT_DETAIL_ENTITY, productCode, scope, payload);\n  }\n}\n\nexport class LoadProductSuccess extends EntityScopedLoaderActions.EntityScopedSuccessAction {\n  readonly type = LOAD_PRODUCT_SUCCESS;\n  constructor(public payload: Product, scope = '') {\n    super(PRODUCT_DETAIL_ENTITY, payload.code, scope);\n  }\n}\n\n// action types\nexport type ProductAction = LoadProduct | LoadProductFail | LoadProductSuccess;\n","import {\n  ProductSearchPage,\n  Suggestion,\n} from '../../model/product-search.model';\nimport { Product, ProductReference, Review } from '../../model/product.model';\nimport { EntityScopedLoaderState } from '../../state/utils/scoped-loader/scoped-loader.state';\n\nexport const PRODUCT_FEATURE = 'product';\nexport const PRODUCT_DETAIL_ENTITY = '[Product] Detail Entity';\n\nexport interface StateWithProduct {\n  [PRODUCT_FEATURE]: ProductsState;\n}\n\nexport interface ProductsState {\n  details: EntityScopedLoaderState<Product>;\n  search: ProductsSearchState;\n  reviews: ProductReviewsState;\n  references: ProductReferencesState;\n}\n\nexport interface ProductsSearchState {\n  results: ProductSearchPage;\n  suggestions: Suggestion[];\n  auxResults: ProductSearchPage;\n}\n\nexport interface ProductReviewsState {\n  productCode: string;\n  list: Review[];\n}\n\nexport interface ProductReferencesState {\n  productCode: string;\n  list: ProductReference[];\n}\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  ProductsState,\n  PRODUCT_FEATURE,\n  StateWithProduct,\n} from '../product-state';\n\nexport const getProductsState: MemoizedSelector<\n  StateWithProduct,\n  ProductsState\n> = createFeatureSelector<ProductsState>(PRODUCT_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { ProductReference } from '../../../model/product.model';\nimport {\n  ProductReferencesState,\n  ProductsState,\n  StateWithProduct,\n} from '../product-state';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductReferencesState: MemoizedSelector<\n  StateWithProduct,\n  ProductReferencesState\n> = createSelector(\n  getProductsState,\n  (state: ProductsState) => state.references\n);\n\nexport const getSelectedProductReferencesFactory = (\n  productCode: string,\n  referenceType: string\n): MemoizedSelector<StateWithProduct, ProductReference[]> => {\n  return createSelector(getProductReferencesState, referenceTypeData => {\n    if (referenceTypeData.productCode === productCode) {\n      if (!!referenceTypeData.list) {\n        if (referenceType) {\n          return referenceTypeData.list.filter(\n            item => item.referenceType === referenceType\n          );\n        }\n\n        return referenceTypeData.list;\n      } else {\n        return [];\n      }\n    }\n  });\n};\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Review } from '../../../model/product.model';\nimport {\n  ProductReviewsState,\n  ProductsState,\n  StateWithProduct,\n} from '../product-state';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductReviewsState: MemoizedSelector<\n  StateWithProduct,\n  ProductReviewsState\n> = createSelector(getProductsState, (state: ProductsState) => state.reviews);\n\nexport const getSelectedProductReviewsFactory = (\n  productCode\n): MemoizedSelector<StateWithProduct, Review[]> => {\n  return createSelector(getProductReviewsState, reviewData => {\n    if (reviewData.productCode === productCode) {\n      return reviewData.list;\n    }\n  });\n};\n","import {\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport { ProductActions } from '../actions/index';\nimport { ProductsSearchState } from '../product-state';\n\nexport const initialState: ProductsSearchState = {\n  results: {},\n  suggestions: [],\n  auxResults: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: ProductActions.ProductSearchAction\n): ProductsSearchState {\n  switch (action.type) {\n    case ProductActions.SEARCH_PRODUCTS_SUCCESS: {\n      const results = action.payload;\n      const res = action.auxiliary ? { auxResults: results } : { results };\n      return {\n        ...state,\n        ...res,\n      };\n    }\n\n    case ProductActions.GET_PRODUCT_SUGGESTIONS_SUCCESS: {\n      const suggestions: Suggestion[] = action.payload;\n\n      return {\n        ...state,\n        suggestions,\n      };\n    }\n\n    case ProductActions.CLEAR_PRODUCT_SEARCH_RESULT: {\n      return {\n        ...state,\n        results: action.payload.clearPageResults ? {} : state.results,\n        suggestions: action.payload.clearSearchboxResults\n          ? []\n          : state.suggestions,\n        auxResults: action.payload.clearSearchboxResults\n          ? {}\n          : state.auxResults,\n      };\n    }\n  }\n  return state;\n}\n\nexport const getSearchResults = (\n  state: ProductsSearchState\n): ProductSearchPage => state.results;\nexport const getAuxSearchResults = (\n  state: ProductsSearchState\n): ProductSearchPage => state.auxResults;\nexport const getProductSuggestions = (\n  state: ProductsSearchState\n): Suggestion[] => state.suggestions;\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  ProductSearchPage,\n  Suggestion,\n} from '../../../model/product-search.model';\nimport {\n  ProductsSearchState,\n  ProductsState,\n  StateWithProduct,\n} from '../product-state';\nimport * as fromProductSearch from '../reducers/product-search.reducer';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductsSearchState: MemoizedSelector<\n  StateWithProduct,\n  ProductsSearchState\n> = createSelector(getProductsState, (state: ProductsState) => state.search);\n\nexport const getSearchResults: MemoizedSelector<\n  StateWithProduct,\n  ProductSearchPage\n> = createSelector(getProductsSearchState, fromProductSearch.getSearchResults);\n\nexport const getAuxSearchResults: MemoizedSelector<\n  StateWithProduct,\n  ProductSearchPage\n> = createSelector(\n  getProductsSearchState,\n  fromProductSearch.getAuxSearchResults\n);\n\nexport const getProductSuggestions: MemoizedSelector<\n  StateWithProduct,\n  Suggestion[]\n> = createSelector(\n  getProductsSearchState,\n  fromProductSearch.getProductSuggestions\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { Product } from '../../../model/product.model';\nimport { EntityLoaderState } from '../../../state/utils/entity-loader/entity-loader-state';\nimport {\n  initialLoaderState,\n  StateEntityLoaderSelectors,\n  StateLoaderSelectors,\n} from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport { ProductsState, StateWithProduct } from '../product-state';\nimport { getProductsState } from './feature.selector';\n\nexport const getProductState: MemoizedSelector<\n  StateWithProduct,\n  EntityLoaderState<Product>\n> = createSelector(getProductsState, (state: ProductsState) => state.details);\n\nexport const getSelectedProductsFactory = (\n  codes: string[]\n): MemoizedSelector<StateWithProduct, Product[]> => {\n  return createSelector(\n    getProductState,\n    (details: EntityLoaderState<Product>) => {\n      return codes\n        .map(code =>\n          details.entities[code] ? details.entities[code].value : undefined\n        )\n        .filter(product => product !== undefined);\n    }\n  );\n};\n\nexport const getSelectedProductStateFactory = (\n  code: string,\n  scope?: string\n): MemoizedSelector<StateWithProduct, LoaderState<Product>> => {\n  return createSelector(getProductState, details =>\n    scope\n      ? StateEntityLoaderSelectors.entityStateSelector(details, code)[scope] ||\n        initialLoaderState\n      : StateEntityLoaderSelectors.entityStateSelector(details, code)\n  );\n};\n\nexport const getSelectedProductFactory = (\n  code: string,\n  scope?: string\n): MemoizedSelector<StateWithProduct, Product> => {\n  return createSelector(\n    getSelectedProductStateFactory(code, scope),\n    productState => StateLoaderSelectors.loaderValueSelector(productState)\n  );\n};\n\nexport const getSelectedProductLoadingFactory = (\n  code: string,\n  scope?: string\n): MemoizedSelector<StateWithProduct, boolean> => {\n  return createSelector(\n    getSelectedProductStateFactory(code, scope),\n    productState => StateLoaderSelectors.loaderLoadingSelector(productState)\n  );\n};\n\nexport const getSelectedProductSuccessFactory = (\n  code: string,\n  scope?: string\n): MemoizedSelector<StateWithProduct, boolean> => {\n  return createSelector(\n    getSelectedProductStateFactory(code, scope),\n    productState => StateLoaderSelectors.loaderSuccessSelector(productState)\n  );\n};\n\nexport const getSelectedProductErrorFactory = (\n  code: string,\n  scope?: string\n): MemoizedSelector<StateWithProduct, boolean> => {\n  return createSelector(\n    getSelectedProductStateFactory(code, scope),\n    productState => StateLoaderSelectors.loaderErrorSelector(productState)\n  );\n};\n\nexport const getAllProductCodes: MemoizedSelector<\n  StateWithProduct,\n  string[]\n> = createSelector(getProductState, details => {\n  return Object.keys(details.entities);\n});\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { ProductReference } from '../../model/product.model';\nimport { ProductActions } from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class ProductReferenceService {\n  constructor(protected store: Store<StateWithProduct>) {}\n\n  get(\n    productCode: string,\n    referenceType?: string,\n    pageSize?: number\n  ): Observable<ProductReference[]> {\n    return this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductReferencesFactory(\n          productCode,\n          referenceType\n        )\n      ),\n      tap(references => {\n        if (references === undefined && productCode !== undefined) {\n          this.store.dispatch(\n            new ProductActions.LoadProductReferences({\n              productCode,\n              referenceType,\n              pageSize,\n            })\n          );\n        }\n      })\n    );\n  }\n\n  cleanReferences(): void {\n    this.store.dispatch(new ProductActions.CleanProductReferences());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { Review } from '../../model/product.model';\nimport { ProductActions } from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class ProductReviewService {\n  constructor(protected store: Store<StateWithProduct>) {}\n\n  getByProductCode(productCode: string): Observable<Review[]> {\n    return this.store.pipe(\n      select(ProductSelectors.getSelectedProductReviewsFactory(productCode)),\n      tap(reviews => {\n        if (reviews === undefined && productCode !== undefined) {\n          this.store.dispatch(\n            new ProductActions.LoadProductReviews(productCode)\n          );\n        }\n      })\n    );\n  }\n\n  add(productCode: string, review: Review): void {\n    this.store.dispatch(\n      new ProductActions.PostProductReview({\n        productCode: productCode,\n        review,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { ProductSearchPage } from '../../model/product-search.model';\nimport { SearchConfig } from '../model/search-config';\nimport { ProductActions } from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable()\nexport class ProductSearchService {\n  constructor(protected store: Store<StateWithProduct>) {}\n\n  search(query: string, searchConfig?: SearchConfig): void {\n    this.store.dispatch(\n      new ProductActions.SearchProducts({\n        queryText: query,\n        searchConfig: searchConfig,\n      })\n    );\n  }\n\n  getResults(): Observable<ProductSearchPage> {\n    return this.store.pipe(select(ProductSelectors.getSearchResults));\n  }\n\n  clearResults(): void {\n    this.store.dispatch(\n      new ProductActions.ClearProductSearchResult({\n        clearPageResults: true,\n      })\n    );\n  }\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { Actions, ofType } from '@ngrx/effects';\nimport { select, Store } from '@ngrx/store';\nimport {\n  combineLatest,\n  defer,\n  merge,\n  Observable,\n  of,\n  SchedulerLike,\n  using,\n} from 'rxjs';\nimport {\n  auditTime,\n  debounceTime,\n  delay,\n  distinctUntilChanged,\n  filter,\n  map,\n  mapTo,\n  shareReplay,\n  tap,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { deepMerge } from '../../config/utils/deep-merge';\nimport { Product } from '../../model/product.model';\nimport { LoadingScopesService } from '../../occ/services/loading-scopes.service';\nimport { withdrawOn } from '../../util/withdraw-on';\nimport { ProductActions } from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\nimport { ProductSelectors } from '../store/selectors/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductLoadingService {\n  protected products: {\n    [code: string]: { [scope: string]: Observable<Product> };\n  } = {};\n\n  constructor(\n    protected store: Store<StateWithProduct>,\n    protected loadingScopes: LoadingScopesService,\n    protected actions$: Actions,\n    @Inject(PLATFORM_ID) protected platformId: any\n  ) {}\n\n  get(productCode: string, scopes: string[]): Observable<Product> {\n    scopes = this.loadingScopes.expand('product', scopes);\n\n    this.initProductScopes(productCode, scopes);\n    return this.products[productCode][this.getScopesIndex(scopes)];\n  }\n\n  protected initProductScopes(productCode: string, scopes: string[]): void {\n    if (!this.products[productCode]) {\n      this.products[productCode] = {};\n    }\n\n    for (const scope of scopes) {\n      if (!this.products[productCode][scope]) {\n        this.products[productCode][scope] = this.getProductForScope(\n          productCode,\n          scope\n        );\n      }\n    }\n\n    if (scopes.length > 1) {\n      this.products[productCode][this.getScopesIndex(scopes)] = combineLatest(\n        scopes.map(scope => this.products[productCode][scope])\n      ).pipe(\n        auditTime(0),\n        map(productParts =>\n          productParts.every(Boolean)\n            ? deepMerge({}, ...productParts)\n            : undefined\n        ),\n        distinctUntilChanged()\n      );\n    }\n  }\n\n  protected getScopesIndex(scopes: string[]): string {\n    return scopes.join('ɵ');\n  }\n\n  /**\n   * Creates observable for providing specified product data for the scope\n   *\n   * @param productCode\n   * @param scope\n   */\n  protected getProductForScope(\n    productCode: string,\n    scope: string\n  ): Observable<Product> {\n    const shouldLoad$ = this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductStateFactory(productCode, scope)\n      ),\n      map(\n        productState =>\n          !productState.loading && !productState.success && !productState.error\n      ),\n      distinctUntilChanged(),\n      filter(x => x)\n    );\n\n    const isLoading$ = this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductLoadingFactory(productCode, scope)\n      )\n    );\n\n    const productLoadLogic$ = merge(\n      shouldLoad$,\n      ...this.getProductReloadTriggers(productCode, scope)\n    ).pipe(\n      debounceTime(0),\n      withLatestFrom(isLoading$),\n      tap(([, isLoading]) => {\n        if (!isLoading) {\n          this.store.dispatch(\n            new ProductActions.LoadProduct(productCode, scope)\n          );\n        }\n      })\n    );\n\n    const productData$ = this.store.pipe(\n      select(ProductSelectors.getSelectedProductFactory(productCode, scope))\n    );\n\n    return using(\n      () => productLoadLogic$.subscribe(),\n      () => productData$\n    ).pipe(shareReplay({ bufferSize: 1, refCount: true }));\n  }\n\n  /**\n   * Returns reload triggers for product per scope\n   *\n   * @param productCode\n   * @param scope\n   */\n  protected getProductReloadTriggers(\n    productCode: string,\n    scope: string\n  ): Observable<boolean>[] {\n    const triggers = [];\n\n    // max age trigger add\n    const maxAge = this.loadingScopes.getMaxAge('product', scope);\n    if (maxAge && isPlatformBrowser(this.platformId)) {\n      // we want to grab load product success and load product fail for this product and scope\n      const loadFinish$ = this.actions$.pipe(\n        filter(\n          (\n            action:\n              | ProductActions.LoadProductSuccess\n              | ProductActions.LoadProductFail\n          ) =>\n            (action.type === ProductActions.LOAD_PRODUCT_SUCCESS ||\n              action.type === ProductActions.LOAD_PRODUCT_FAIL) &&\n            action.meta.entityId === productCode &&\n            action.meta.scope === scope\n        )\n      );\n\n      const loadStart$ = this.actions$.pipe(\n        ofType(ProductActions.LOAD_PRODUCT),\n        filter(\n          (action: ProductActions.LoadProduct) =>\n            action.payload === productCode && action.meta.scope === scope\n        )\n      );\n\n      triggers.push(this.getMaxAgeTrigger(loadStart$, loadFinish$, maxAge));\n    }\n\n    return triggers;\n  }\n\n  /**\n   * Generic method that returns stream triggering reload by maxAge\n   *\n   * Could be refactored to separate service in future to use in other\n   * max age reload implementations\n   *\n   * @param loadStart$ Stream that emits on load start\n   * @param loadFinish$ Stream that emits on load finish\n   * @param maxAge max age\n   */\n  private getMaxAgeTrigger(\n    loadStart$: Observable<any>,\n    loadFinish$: Observable<any>,\n    maxAge: number,\n    scheduler?: SchedulerLike\n  ): Observable<boolean> {\n    let timestamp = 0;\n\n    const now = () => (scheduler ? scheduler.now() : Date.now());\n\n    const timestamp$ = loadFinish$.pipe(tap(() => (timestamp = now())));\n\n    const shouldReload$: Observable<boolean> = defer(() => {\n      const age = now() - timestamp;\n\n      const timestampRefresh$ = timestamp$.pipe(\n        delay(maxAge, scheduler),\n        mapTo(true),\n        withdrawOn(loadStart$)\n      );\n\n      if (age > maxAge) {\n        // we should emit first value immediately\n        return merge(of(true), timestampRefresh$);\n      } else if (age === 0) {\n        // edge case, we should emit max age timeout after next load success\n        // could happen with artificial schedulers\n        return timestampRefresh$;\n      } else {\n        // we should emit first value when age will expire\n        return merge(\n          of(true).pipe(delay(maxAge - age, scheduler)),\n          timestampRefresh$\n        );\n      }\n    });\n\n    return shouldReload$;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable, queueScheduler } from 'rxjs';\nimport { map, observeOn, shareReplay, tap } from 'rxjs/operators';\nimport { Product } from '../../model/product.model';\nimport { ProductActions } from '../store/actions/index';\nimport { StateWithProduct } from '../store/product-state';\nimport { ProductSelectors } from '../store/selectors/index';\nimport { ProductLoadingService } from '../services/product-loading.service';\nimport { ProductScope } from '../model/product-scope';\n\n@Injectable()\nexport class ProductService {\n  constructor(\n    store: Store<StateWithProduct>,\n    // tslint:disable-next-line:unified-signatures\n    productLoading: ProductLoadingService\n  );\n  /**\n   * @deprecated since 1.4\n   */\n  constructor(store: Store<StateWithProduct>);\n\n  constructor(\n    protected store: Store<StateWithProduct>,\n    protected productLoading?: ProductLoadingService\n  ) {}\n\n  /** @deprecated since 1.4 */\n  private products: { [code: string]: Observable<Product> } = {};\n\n  /**\n   * Returns the product observable. The product will be loaded\n   * whenever there's no value observed.\n   *\n   * The underlying product loader ensures that the product is\n   * only loaded once, even in case of parallel observers.\n   *\n   * You should provide product data scope you are interested in to not load all\n   * the data if not needed. You can provide more than one scope.\n   *\n   * @param productCode Product code to load\n   * @param scopes Scope or scopes of the product data\n   */\n  get(\n    productCode: string,\n    scopes: (ProductScope | string)[] | ProductScope | string = ''\n  ): Observable<Product> {\n    // TODO: Remove, deprecated since 1.4\n    if (!this.productLoading) {\n      if (!this.products[productCode]) {\n        this.products[productCode] = this.store.pipe(\n          select(ProductSelectors.getSelectedProductStateFactory(productCode)),\n          observeOn(queueScheduler),\n          tap(productState => {\n            const attemptedLoad =\n              productState.loading ||\n              productState.success ||\n              productState.error;\n\n            if (!attemptedLoad) {\n              this.store.dispatch(new ProductActions.LoadProduct(productCode));\n            }\n          }),\n          map(productState => productState.value),\n          shareReplay({ bufferSize: 1, refCount: true })\n        );\n      }\n      return this.products[productCode];\n    }\n    // END OF (TODO: Remove, deprecated since 1.4)\n\n    return this.productLoading.get(productCode, [].concat(scopes));\n  }\n\n  /**\n   * Returns boolean observable for product's loading state\n   */\n  isLoading(\n    productCode: string,\n    scope: ProductScope | string = ''\n  ): Observable<boolean> {\n    return this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductLoadingFactory(productCode, scope)\n      )\n    );\n  }\n\n  /**\n   * Returns boolean observable for product's load success state\n   */\n  isSuccess(\n    productCode: string,\n    scope: ProductScope | string = ''\n  ): Observable<boolean> {\n    return this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductSuccessFactory(productCode, scope)\n      )\n    );\n  }\n\n  /**\n   * Returns boolean observable for product's load error state\n   */\n  hasError(\n    productCode: string,\n    scope: ProductScope | string = ''\n  ): Observable<boolean> {\n    return this.store.pipe(\n      select(\n        ProductSelectors.getSelectedProductErrorFactory(productCode, scope)\n      )\n    );\n  }\n\n  /**\n   * Reloads the product. The product is loaded implicetly\n   * whenever selected by the `get`, but in some cases an\n   * explicit reload might be needed.\n   */\n  reload(productCode: string, scope: ProductScope | string = ''): void {\n    this.store.dispatch(new ProductActions.LoadProduct(productCode, scope));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { ProductSearchPage, Suggestion } from '../../model/index';\nimport { SearchConfig } from '../model/index';\nimport { ProductActions } from '../store/actions/index';\nimport { ProductSelectors } from '../store/selectors/index';\nimport { ProductSearchService } from './product-search.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SearchboxService extends ProductSearchService {\n  /**\n   * dispatch the search for the search box\n   */\n  search(query: string, searchConfig?: SearchConfig): void {\n    this.store.dispatch(\n      new ProductActions.SearchProducts(\n        {\n          queryText: query,\n          searchConfig: searchConfig,\n        },\n        true\n      )\n    );\n  }\n\n  getResults(): Observable<ProductSearchPage> {\n    return this.store.pipe(select(ProductSelectors.getAuxSearchResults));\n  }\n\n  /**\n   * clears the products and suggestions\n   */\n  clearResults(): void {\n    this.store.dispatch(\n      new ProductActions.ClearProductSearchResult({\n        clearSearchboxResults: true,\n      })\n    );\n  }\n\n  getSuggestionResults(): Observable<Suggestion[]> {\n    return this.store.pipe(select(ProductSelectors.getProductSuggestions));\n  }\n\n  searchSuggestions(query: string, searchConfig?: SearchConfig): void {\n    this.store.dispatch(\n      new ProductActions.GetProductSuggestions({\n        term: query,\n        searchConfig: searchConfig,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { Page, PageMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageBreadcrumbResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { ProductSearchPage } from '../../model/product-search.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { ProductSearchService } from '../facade/product-search.service';\n\n/**\n * Resolves the page data for the Product Listing Page\n * based on the `PageType.CATEGORY_PAGE`.\n *\n * The page title, and breadcrumbs are resolved in this implementation only.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class CategoryPageMetaResolver extends PageMetaResolver\n  implements PageTitleResolver, PageBreadcrumbResolver {\n  // reusable observable for search page data\n  private searchPage$: Observable<\n    ProductSearchPage | Page\n  > = this.cms.getCurrentPage().pipe(\n    filter(Boolean),\n    switchMap((page: Page) =>\n      // only the existence of a plp component tells us if products\n      // are rendered or if this is an ordinary content page\n      this.hasProductListComponent(page)\n        ? this.productSearchService.getResults().pipe(filter(Boolean))\n        : of(page)\n    )\n  );\n\n  constructor(\n    protected routingService: RoutingService,\n    protected productSearchService: ProductSearchService,\n    protected cms: CmsService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.CATEGORY_PAGE;\n  }\n\n  /**\n   * @deprecated since version 1.3\n   *\n   * The resolve method is no longer preferred and will be removed with release 2.0.\n   * The caller `PageMetaService` service is improved to expect all individual resolvers\n   * instead, so that the code is easier extensible.\n   */\n  resolve(): Observable<PageMeta> | any {\n    return this.cms.getCurrentPage().pipe(\n      filter(Boolean),\n      switchMap((page: Page) => {\n        // only the existence of a plp component tells us if products\n        // are rendered or if this is an ordinary content page\n        if (this.hasProductListComponent(page)) {\n          return this.productSearchService.getResults().pipe(\n            filter(data => data.breadcrumbs && data.breadcrumbs.length > 0),\n            switchMap(data =>\n              combineLatest([\n                this.resolveTitle(data),\n                this.resolveBreadcrumbLabel().pipe(\n                  switchMap(label => this.resolveBreadcrumbs(data, label))\n                ),\n              ])\n            ),\n            map(([title, breadcrumbs]) => ({ title, breadcrumbs }))\n          );\n        } else {\n          return of({\n            title: page.title || page.name,\n          });\n        }\n      })\n    );\n  }\n  resolveTitle(): Observable<string>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveTitle()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveTitle(searchPage: ProductSearchPage): Observable<string>;\n  resolveTitle(searchPage?: ProductSearchPage): Observable<string> {\n    const searchPage$ = searchPage ? of(searchPage) : this.searchPage$;\n\n    return searchPage$.pipe(\n      filter((page: ProductSearchPage) => !!page.pagination),\n      switchMap(p =>\n        this.translation.translate('pageMetaResolver.category.title', {\n          count: (<ProductSearchPage>p).pagination.totalResults,\n          query: (<ProductSearchPage>p).breadcrumbs[0].facetValueName,\n        })\n      )\n    );\n  }\n\n  /**\n   * @deprecated since version 1.3\n   * This method will removed with with 2.0\n   */\n  resolveBreadcrumbLabel(): Observable<string> {\n    return this.translation.translate('common.home');\n  }\n\n  resolveBreadcrumbs(): Observable<any[]>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveTitle()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveBreadcrumbs(\n    searchPage: ProductSearchPage,\n    breadcrumbLabel: string\n  ): Observable<any[]>;\n  resolveBreadcrumbs(\n    searchPage?: ProductSearchPage,\n    breadcrumbLabel?: string\n  ): Observable<any[]> {\n    const sources =\n      searchPage && breadcrumbLabel\n        ? [of(searchPage), of(breadcrumbLabel)]\n        : [this.searchPage$.pipe(), this.translation.translate('common.home')];\n\n    return combineLatest(sources).pipe(\n      map(([p, label]: [ProductSearchPage, string]) =>\n        p.breadcrumbs\n          ? this.resolveBreadcrumbData(<ProductSearchPage>p, label)\n          : null\n      )\n    );\n  }\n\n  private resolveBreadcrumbData(page: ProductSearchPage, label: string): any[] {\n    const breadcrumbs = [];\n    breadcrumbs.push({ label: label, link: '/' });\n\n    for (const br of page.breadcrumbs) {\n      if (br.facetCode === 'category' || br.facetCode === 'allCategories') {\n        breadcrumbs.push({\n          label: br.facetValueName,\n          link: `/c/${br.facetValueCode}`,\n        });\n      }\n      if (br.facetCode === 'brand') {\n        breadcrumbs.push({\n          label: br.facetValueName,\n          link: `/Brands/${br.facetValueName}/c/${br.facetValueCode}`,\n        });\n      }\n    }\n    return breadcrumbs;\n  }\n\n  private hasProductListComponent(page: Page): boolean {\n    return !!Object.keys(page.slots).find(\n      key =>\n        !!page.slots[key].components.find(\n          comp =>\n            comp.typeCode === 'CMSProductListComponent' ||\n            comp.typeCode === 'ProductGridComponent'\n        )\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { PageMeta, PageRobotsMeta } from '../../cms/model/page.model';\nimport { PageMetaResolver } from '../../cms/page/page-meta.resolver';\nimport {\n  PageBreadcrumbResolver,\n  PageDescriptionResolver,\n  PageHeadingResolver,\n  PageImageResolver,\n  PageTitleResolver,\n} from '../../cms/page/page.resolvers';\nimport { FeatureConfigService } from '../../features-config/services/feature-config.service';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { Product } from '../../model/product.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { ProductService } from '../facade/product.service';\nimport { ProductScope } from '../model/product-scope';\n\n/**\n * Resolves the page data for the Product Detail Page\n * based on the `PageType.PRODUCT_PAGE`.\n *\n * The page title, heading, description, breadcrumbs and\n * first GALLERY image are resolved if available in the data.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProductPageMetaResolver extends PageMetaResolver\n  implements\n    PageHeadingResolver,\n    PageTitleResolver,\n    PageDescriptionResolver,\n    PageBreadcrumbResolver,\n    PageImageResolver {\n  protected readonly PRODUCT_SCOPE =\n    this.features && this.features.isLevel('1.4') ? ProductScope.DETAILS : '';\n\n  // reusable observable for product data based on the current page\n  private product$ = this.routingService.getRouterState().pipe(\n    map(state => state.state.params['productCode']),\n    filter(code => !!code),\n    switchMap(code => this.productService.get(code, this.PRODUCT_SCOPE)),\n    filter(Boolean)\n  );\n\n  constructor(\n    routingService: RoutingService,\n    productService: ProductService,\n    translation: TranslationService,\n    // tslint:disable-next-line: unified-signatures\n    features: FeatureConfigService\n  );\n\n  /**\n   * @deprecated since 1.4\n   */\n  constructor(\n    routingService: RoutingService,\n    productService: ProductService,\n    translation: TranslationService\n  );\n\n  constructor(\n    protected routingService: RoutingService,\n    protected productService: ProductService,\n    protected translation: TranslationService,\n    protected features?: FeatureConfigService\n  ) {\n    super();\n    this.pageType = PageType.PRODUCT_PAGE;\n  }\n\n  /**\n   * @deprecated since version 1.3\n   *\n   * The resolve method is no longer preferred and will be removed with release 2.0.\n   * The caller `PageMetaService` service is improved to expect all individual resolvers\n   * instead, so that the code is easier extensible.\n   */\n  resolve(): Observable<PageMeta> | any {\n    return this.product$.pipe(\n      switchMap((p: Product) =>\n        combineLatest([\n          this.resolveHeading(p),\n          this.resolveTitle(p),\n          this.resolveDescription(p),\n          this.resolveBreadcrumbLabel().pipe(\n            switchMap(label => this.resolveBreadcrumbs(p, label))\n          ),\n          this.resolveImage(p),\n          this.resolveRobots(p),\n        ])\n      ),\n      map(\n        ([heading, title, description, breadcrumbs, image, robots]: [\n          string,\n          string,\n          string,\n          any[],\n          string,\n          string[]\n        ]) => ({\n          heading,\n          title,\n          description,\n          breadcrumbs,\n          image,\n          robots,\n        })\n      )\n    );\n  }\n\n  resolveHeading(): Observable<string>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveHeading()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveHeading(product: Product): Observable<string>;\n  resolveHeading(product?: Product): Observable<string> {\n    const product$ = product ? of(product) : this.product$;\n    return product$.pipe(\n      switchMap((p: Product) =>\n        this.translation.translate('pageMetaResolver.product.heading', {\n          heading: p.name,\n        })\n      )\n    );\n  }\n\n  resolveTitle(): Observable<string>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveTitle()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveTitle(product: Product): Observable<string>;\n  resolveTitle(product?: Product): Observable<string> {\n    const product$ = product ? of(product) : this.product$;\n    return product$.pipe(\n      switchMap((p: Product) => {\n        let title = p.name;\n        title += this.resolveFirstCategory(p);\n        title += this.resolveManufacturer(p);\n        return this.translation.translate('pageMetaResolver.product.title', {\n          title: title,\n        });\n      })\n    );\n  }\n\n  resolveDescription(): Observable<string>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveDescription()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveDescription(product: Product): Observable<string>;\n  resolveDescription(product?: Product): Observable<string> {\n    const product$: Observable<Product> = product ? of(product) : this.product$;\n    return product$.pipe(\n      switchMap((p: Product) =>\n        this.translation.translate('pageMetaResolver.product.description', {\n          description: p.summary,\n        })\n      )\n    );\n  }\n\n  /**\n   * @deprecated since version 1.3\n   * This method will be removed with with 2.0\n   */\n  resolveBreadcrumbLabel(): Observable<string> {\n    return this.translation.translate('common.home');\n  }\n\n  resolveBreadcrumbs(): Observable<any[]>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveBreadcrumbs()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveBreadcrumbs(\n    product: Product,\n    breadcrumbLabel: string\n  ): Observable<any[]>;\n  resolveBreadcrumbs(\n    product?: Product,\n    breadcrumbLabel?: string\n  ): Observable<any[]> {\n    const sources =\n      product && breadcrumbLabel\n        ? [of(product), of(breadcrumbLabel)]\n        : [this.product$.pipe(), this.translation.translate('common.home')];\n\n    return combineLatest(sources).pipe(\n      map(([p, label]: [Product, string]) => {\n        const breadcrumbs = [];\n        breadcrumbs.push({ label: label, link: '/' });\n        for (const { name, code, url } of p.categories || []) {\n          breadcrumbs.push({\n            label: name || code,\n            link: url,\n          });\n        }\n        return breadcrumbs;\n      })\n    );\n  }\n\n  resolveImage(): Observable<string>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveImage()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveImage(product: Product): Observable<string>;\n  resolveImage(product?: Product): Observable<string> {\n    const product$: Observable<Product> = product ? of(product) : this.product$;\n    return product$.pipe(\n      map((p: Product) =>\n        p.images &&\n        p.images.PRIMARY &&\n        (<any>p.images.PRIMARY).zoom &&\n        (<any>p.images.PRIMARY).zoom.url\n          ? (<any>p.images.PRIMARY).zoom.url\n          : null\n      )\n    );\n  }\n\n  private resolveFirstCategory(product: Product): string {\n    let firstCategory;\n    if (product.categories && product.categories.length > 0) {\n      firstCategory = product.categories[0];\n    }\n    return firstCategory\n      ? ` | ${firstCategory.name || firstCategory.code}`\n      : '';\n  }\n\n  private resolveManufacturer(product: Product): string {\n    return product.manufacturer ? ` | ${product.manufacturer}` : '';\n  }\n\n  resolveRobots(): Observable<PageRobotsMeta[]>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveRobots()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveRobots(product: Product): Observable<PageRobotsMeta[]>;\n  resolveRobots(product?: Product): Observable<PageRobotsMeta[]> {\n    const product$ = product ? of(product) : this.product$;\n    return product$.pipe(\n      switchMap((p: Product) => {\n        if (!p.purchasable) {\n          return of([PageRobotsMeta.FOLLOW, PageRobotsMeta.NOINDEX]);\n        } else {\n          return of([PageRobotsMeta.FOLLOW, PageRobotsMeta.INDEX]);\n        }\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { combineLatest, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { PageMetaResolver } from '../../cms';\nimport { PageMeta } from '../../cms/model/page.model';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { ProductSearchService } from '../facade/product-search.service';\n\n/**\n * Resolves the page data for the Search Result Page based on the\n * `PageType.CATEGORY_PAGE` and the `SearchResultsListPageTemplate` template.\n *\n * Only the page title is resolved in the implemenation.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class SearchPageMetaResolver extends PageMetaResolver\n  implements PageMetaResolver {\n  total$: Observable<number> = this.productSearchService.getResults().pipe(\n    filter(data => !!(data && data.pagination)),\n    map(results => results.pagination.totalResults)\n  );\n\n  query$: Observable<string> = this.routingService\n    .getRouterState()\n    .pipe(map(state => state.state.params['query']));\n\n  constructor(\n    protected routingService: RoutingService,\n    protected productSearchService: ProductSearchService,\n    protected translation: TranslationService\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'SearchResultsListPageTemplate';\n  }\n\n  /**\n   * @deprecated since version 1.3\n   *\n   * The resolve method is no longer preferred and will be removed with release 2.0.\n   * The caller `PageMetaService` service is improved to expect all individual resolvers\n   * instead, so that the code is easier extensible.\n   */\n  resolve(): Observable<PageMeta> | any {\n    return this.resolveTitle();\n  }\n\n  resolveTitle(): Observable<string>;\n  /**\n   * @deprecated since version 1.3\n   * With 2.0, the argument(s) will be removed and the return type will change. Use `resolveTitle()` instead\n   */\n  // tslint:disable-next-line: unified-signatures\n  resolveTitle(total: number, query: string): Observable<string>;\n  resolveTitle(\n    total?: number,\n    query?: string\n  ): Observable<{ title: string } | any> {\n    const sources =\n      total && query ? [of(total), of(query)] : [this.total$, this.query$];\n    return combineLatest(sources).pipe(\n      switchMap(([t, q]: [number, string]) =>\n        this.translation.translate('pageMetaResolver.search.title', {\n          count: t,\n          query: q,\n        })\n      )\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { ProductReferencesConnector } from '../../connectors/references/product-references.connector';\nimport { ProductActions } from '../actions/index';\n\n@Injectable()\nexport class ProductReferencesEffects {\n  @Effect()\n  loadProductReferences$: Observable<\n    | ProductActions.LoadProductReferencesSuccess\n    | ProductActions.LoadProductReferencesFail\n  > = this.actions$.pipe(\n    ofType(ProductActions.LOAD_PRODUCT_REFERENCES),\n    map((action: ProductActions.LoadProductReferences) => action.payload),\n    mergeMap(payload => {\n      return this.productReferencesConnector\n        .get(payload.productCode, payload.referenceType, payload.pageSize)\n        .pipe(\n          map(data => {\n            return new ProductActions.LoadProductReferencesSuccess({\n              productCode: payload.productCode,\n              list: data,\n            });\n          }),\n          catchError(_error =>\n            of(\n              new ProductActions.LoadProductReferencesFail({\n                message: payload.productCode,\n              } as ErrorModel)\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private productReferencesConnector: ProductReferencesConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, tap } from 'rxjs/operators';\nimport { ErrorModel } from '../../../model/misc.model';\nimport { ProductReviewsConnector } from '../../connectors/reviews/product-reviews.connector';\nimport { ProductActions } from '../actions/index';\nimport {\n  GlobalMessageService,\n  GlobalMessageType,\n} from '../../../global-message/index';\n\n@Injectable()\nexport class ProductReviewsEffects {\n  @Effect()\n  loadProductReviews$: Observable<\n    | ProductActions.LoadProductReviewsSuccess\n    | ProductActions.LoadProductReviewsFail\n  > = this.actions$.pipe(\n    ofType(ProductActions.LOAD_PRODUCT_REVIEWS),\n    map((action: ProductActions.LoadProductReviews) => action.payload),\n    mergeMap(productCode => {\n      return this.productReviewsConnector.get(productCode).pipe(\n        map(data => {\n          return new ProductActions.LoadProductReviewsSuccess({\n            productCode,\n            list: data,\n          });\n        }),\n        catchError(_error =>\n          of(\n            new ProductActions.LoadProductReviewsFail({\n              message: productCode,\n            } as ErrorModel)\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  postProductReview: Observable<\n    | ProductActions.PostProductReviewSuccess\n    | ProductActions.PostProductReviewFail\n  > = this.actions$.pipe(\n    ofType(ProductActions.POST_PRODUCT_REVIEW),\n    map((action: ProductActions.PostProductReview) => action.payload),\n    mergeMap(payload => {\n      return this.productReviewsConnector\n        .add(payload.productCode, payload.review)\n        .pipe(\n          map(reviewResponse => {\n            return new ProductActions.PostProductReviewSuccess(reviewResponse);\n          }),\n          catchError(_error =>\n            of(new ProductActions.PostProductReviewFail(payload.productCode))\n          )\n        );\n    })\n  );\n\n  @Effect({ dispatch: false })\n  showGlobalMessageOnPostProductReviewSuccess$ = this.actions$.pipe(\n    ofType(ProductActions.POST_PRODUCT_REVIEW_SUCCESS),\n    tap(() => {\n      this.globalMessageService.add(\n        { key: 'productReview.thankYouForReview' },\n        GlobalMessageType.MSG_TYPE_CONFIRMATION\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private productReviewsConnector: ProductReviewsConnector,\n    private globalMessageService: GlobalMessageService\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, groupBy, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { ProductSearchConnector } from '../../connectors/search/product-search.connector';\nimport { ProductActions } from '../actions/index';\n\n@Injectable()\nexport class ProductsSearchEffects {\n  @Effect()\n  searchProducts$: Observable<\n    ProductActions.SearchProductsSuccess | ProductActions.SearchProductsFail\n  > = this.actions$.pipe(\n    ofType(ProductActions.SEARCH_PRODUCTS),\n    groupBy((action: ProductActions.SearchProducts) => action.auxiliary),\n    mergeMap(group =>\n      group.pipe(\n        switchMap((action: ProductActions.SearchProducts) => {\n          return this.productSearchConnector\n            .search(action.payload.queryText, action.payload.searchConfig)\n            .pipe(\n              map(data => {\n                return new ProductActions.SearchProductsSuccess(\n                  data,\n                  action.auxiliary\n                );\n              }),\n              catchError(error =>\n                of(\n                  new ProductActions.SearchProductsFail(\n                    makeErrorSerializable(error),\n                    action.auxiliary\n                  )\n                )\n              )\n            );\n        })\n      )\n    )\n  );\n\n  @Effect()\n  getProductSuggestions$: Observable<\n    | ProductActions.GetProductSuggestionsSuccess\n    | ProductActions.GetProductSuggestionsFail\n  > = this.actions$.pipe(\n    ofType(ProductActions.GET_PRODUCT_SUGGESTIONS),\n    map((action: ProductActions.GetProductSuggestions) => action.payload),\n    switchMap(payload => {\n      return this.productSearchConnector\n        .getSuggestions(payload.term, payload.searchConfig.pageSize)\n        .pipe(\n          map(suggestions => {\n            if (suggestions === undefined) {\n              return new ProductActions.GetProductSuggestionsSuccess([]);\n            }\n            return new ProductActions.GetProductSuggestionsSuccess(suggestions);\n          }),\n          catchError(error =>\n            of(\n              new ProductActions.GetProductSuggestionsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private productSearchConnector: ProductSearchConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, createEffect, ofType } from '@ngrx/effects';\nimport { merge, Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { ProductConnector } from '../../connectors/product/product.connector';\nimport { ProductActions } from '../actions/index';\nimport { ScopedProductData } from '../../connectors/product/scoped-product-data';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { bufferDebounceTime } from '../../../util/buffer-debounce-time';\nimport { Action } from '@ngrx/store';\nimport { withdrawOn } from '../../../util/withdraw-on';\n\n@Injectable()\nexport class ProductEffects {\n  // we want to cancel all ongoing requests when currency or language changes,\n  private contextChange$: Observable<Action> = this.actions$.pipe(\n    ofType(\n      SiteContextActions.CURRENCY_CHANGE,\n      SiteContextActions.LANGUAGE_CHANGE\n    )\n  );\n\n  loadProduct$ = createEffect(\n    () => ({ scheduler, debounce = 0 } = {}): Observable<\n      ProductActions.LoadProductSuccess | ProductActions.LoadProductFail\n    > =>\n      this.actions$.pipe(\n        ofType(ProductActions.LOAD_PRODUCT),\n        map((action: ProductActions.LoadProduct) => ({\n          code: action.payload,\n          scope: action.meta.scope,\n        })),\n        // we are grouping all load actions that happens at the same time\n        // to optimize loading and pass them all to productConnector.getMany\n        bufferDebounceTime(debounce, scheduler),\n        mergeMap(products =>\n          merge(\n            ...this.productConnector\n              .getMany(products)\n              .map(this.productLoadEffect)\n          )\n        ),\n        withdrawOn(this.contextChange$)\n      )\n  );\n\n  private productLoadEffect(\n    productLoad: ScopedProductData\n  ): Observable<\n    ProductActions.LoadProductSuccess | ProductActions.LoadProductFail\n  > {\n    return productLoad.data$.pipe(\n      map(\n        data =>\n          new ProductActions.LoadProductSuccess(\n            { code: productLoad.code, ...data },\n            productLoad.scope\n          )\n      ),\n      catchError(error => {\n        return of(\n          new ProductActions.LoadProductFail(\n            productLoad.code,\n            makeErrorSerializable(error),\n            productLoad.scope\n          )\n        );\n      })\n    );\n  }\n\n  constructor(\n    private actions$: Actions,\n    private productConnector: ProductConnector\n  ) {}\n}\n","import { ProductReferencesEffects } from './product-references.effect';\nimport { ProductReviewsEffects } from './product-reviews.effect';\nimport { ProductsSearchEffects } from './product-search.effect';\nimport { ProductEffects } from './product.effect';\n\nexport const effects: any[] = [\n  ProductsSearchEffects,\n  ProductEffects,\n  ProductReviewsEffects,\n  ProductReferencesEffects,\n];\n\nexport * from './product-references.effect';\nexport * from './product-reviews.effect';\nexport * from './product-search.effect';\nexport * from './product.effect';\n","import { ProductReference } from '../../../model/product.model';\nimport { ProductActions } from '../actions/index';\nimport { ProductReferencesState } from '../product-state';\n\nexport const initialState: ProductReferencesState = {\n  productCode: '',\n  list: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: ProductActions.ProductReferencesAction\n): ProductReferencesState {\n  switch (action.type) {\n    case ProductActions.LOAD_PRODUCT_REFERENCES_SUCCESS: {\n      const productCode = action.payload.productCode;\n      const list = action.payload.list;\n\n      return {\n        ...state,\n        list: [...state.list, ...(list ? list : [])].reduce(\n          (\n            productReferences: ProductReference[],\n            productReference: ProductReference\n          ) => {\n            if (\n              !productReferences.some(\n                obj =>\n                  obj.referenceType === productReference.referenceType &&\n                  obj.target.code === productReference.target.code\n              )\n            ) {\n              productReferences.push(productReference);\n            }\n            return productReferences;\n          },\n          []\n        ),\n        productCode,\n      };\n    }\n\n    case ProductActions.CLEAN_PRODUCT_REFERENCES: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n\nexport const getProductReferenceList = (\n  state: ProductReferencesState\n): ProductReference[] => state.list;\nexport const getProductReferenceProductCode = (\n  state: ProductReferencesState\n): string => state.productCode;\n","import { Review } from '../../../model/product.model';\nimport { ProductActions } from '../actions/index';\nimport { ProductReviewsState } from '../product-state';\n\nexport const initialState: ProductReviewsState = {\n  productCode: '',\n  list: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: ProductActions.ProductReviewsAction\n): ProductReviewsState {\n  switch (action.type) {\n    case ProductActions.LOAD_PRODUCT_REVIEWS_SUCCESS: {\n      const productCode = action.payload.productCode;\n      const list = action.payload.list;\n\n      return {\n        ...state,\n        productCode,\n        list,\n      };\n    }\n  }\n\n  return state;\n}\n\nexport const getReviewList = (state: ProductReviewsState): Review[] =>\n  state.list;\nexport const getReviewProductCode = (state: ProductReviewsState): string =>\n  state.productCode;\n","import { initialLoaderState, loaderReducer } from '../loader/loader.reducer';\nimport { EntityScopedLoaderAction } from '../../../product/store/actions/product.action';\nimport { LoaderState } from '../loader/loader-state';\nimport { ScopedLoaderState } from './scoped-loader.state';\nimport { Action } from '@ngrx/store';\n\n/**\n * Higher order reducer designed to add scope support for loader reducer\n *\n * For backward compatibility, we accommodate scopes alongside current\n * loading/error/success/value flags, thus those names can't be used as scope\n * names.\n *\n * TODO: Improve, issue #5445\n *\n * @param entityType\n * @param reducer\n */\nexport function scopedLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: Action) => T\n): (\n  state: ScopedLoaderState<T> | LoaderState<T>,\n  action: EntityScopedLoaderAction\n) => ScopedLoaderState<T> | LoaderState<T> {\n  const loader = loaderReducer<T>(entityType, reducer);\n\n  return (\n    state: ScopedLoaderState<T> | LoaderState<T> = initialLoaderState,\n    action: EntityScopedLoaderAction\n  ): ScopedLoaderState<T> | LoaderState<T> => {\n    if (\n      action &&\n      action.meta &&\n      action.meta.entityType === entityType &&\n      action.meta.scope\n    ) {\n      return {\n        ...state,\n        [action.meta.scope]: loader(state[action.meta.scope], action),\n      };\n    } else {\n      return loader(state, action);\n    }\n  };\n}\n","import { ScopedLoaderState } from './scoped-loader.state';\nimport { scopedLoaderReducer } from './scoped-loader.reducer';\n\nimport { entityReducer } from '../entity/entity.reducer';\nimport { LoaderAction } from '../loader/loader.action';\nimport { EntityLoaderState } from '../entity-loader/entity-loader-state';\nimport { EntityLoaderAction } from '../entity-loader/entity-loader.action';\nimport { LoaderState } from '../loader/loader-state';\n\n/**\n * Higher order reducer that wraps scopedLoaderReducer and EntityReducer enhancing\n * single state reducer to support multiple entities with generic loading flags and scopes\n */\nexport function entityScopedLoaderReducer<T>(\n  entityType: string,\n  reducer?: (state: T, action: LoaderAction) => T\n): (\n  state: EntityLoaderState<T>,\n  action: EntityLoaderAction\n) => EntityLoaderState<T> {\n  return entityReducer<ScopedLoaderState<T> | LoaderState<T>>(\n    entityType,\n    scopedLoaderReducer<T>(entityType, reducer)\n  );\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport { ActionReducer, ActionReducerMap, MetaReducer } from '@ngrx/store';\nimport { Product } from '../../../model/product.model';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { PRODUCT_DETAIL_ENTITY, ProductsState } from '../product-state';\nimport * as fromProductReferences from './product-references.reducer';\nimport * as fromProductReviews from './product-reviews.reducer';\nimport * as fromProductsSearch from './product-search.reducer';\nimport { entityScopedLoaderReducer } from '../../../state/utils/scoped-loader/entity-scoped-loader.reducer';\n\nexport function getReducers(): ActionReducerMap<ProductsState> {\n  return {\n    search: fromProductsSearch.reducer,\n    details: entityScopedLoaderReducer<Product>(PRODUCT_DETAIL_ENTITY),\n    reviews: fromProductReviews.reducer,\n    references: fromProductReferences.reducer,\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  ProductsState\n>> = new InjectionToken<ActionReducerMap<ProductsState>>('ProductReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearProductsState(\n  reducer: ActionReducer<any>\n): ActionReducer<any> {\n  return function(state, action) {\n    if (\n      action.type === SiteContextActions.CURRENCY_CHANGE ||\n      action.type === SiteContextActions.LANGUAGE_CHANGE\n    ) {\n      state = undefined;\n    }\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearProductsState];\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { provideDefaultConfigFactory } from '../../config/config.module';\nimport {\n  StateConfig,\n  StateTransferType,\n} from '../../state/config/state-config';\nimport { effects } from './effects/index';\nimport { PRODUCT_FEATURE } from './product-state';\nimport { metaReducers, reducerProvider, reducerToken } from './reducers/index';\n\nexport function productStoreConfigFactory(): StateConfig {\n  // if we want to reuse PRODUCT_FEATURE const in config, we have to use factory instead of plain object\n  const config: StateConfig = {\n    state: {\n      ssrTransfer: {\n        keys: { [PRODUCT_FEATURE]: StateTransferType.TRANSFER_STATE },\n      },\n    },\n  };\n  return config;\n}\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StoreModule.forFeature(PRODUCT_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [\n    provideDefaultConfigFactory(productStoreConfigFactory),\n    reducerProvider,\n  ],\n})\nexport class ProductStoreModule {}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { PageMetaResolver } from '../cms/page/page-meta.resolver';\nimport { ProductReferenceService } from './facade/product-reference.service';\nimport { ProductReviewService } from './facade/product-review.service';\nimport { ProductSearchService } from './facade/product-search.service';\nimport { ProductService } from './facade/product.service';\nimport { CategoryPageMetaResolver } from './services/category-page-meta.resolver';\nimport { ProductPageMetaResolver } from './services/product-page-meta.resolver';\nimport { SearchPageMetaResolver } from './services/search-page-meta.resolver';\nimport { ProductStoreModule } from './store/product-store.module';\n\nconst pageTitleResolvers = [\n  {\n    provide: PageMetaResolver,\n    useExisting: ProductPageMetaResolver,\n    multi: true,\n  },\n  {\n    provide: PageMetaResolver,\n    useExisting: CategoryPageMetaResolver,\n    multi: true,\n  },\n  {\n    provide: PageMetaResolver,\n    useExisting: SearchPageMetaResolver,\n    multi: true,\n  },\n];\n\n@NgModule({\n  imports: [ProductStoreModule],\n})\nexport class ProductModule {\n  static forRoot(): ModuleWithProviders<ProductModule> {\n    return {\n      ngModule: ProductModule,\n      providers: [\n        ProductService,\n        ProductSearchService,\n        ProductReviewService,\n        ProductReferenceService,\n        ...pageTitleResolvers,\n      ],\n    };\n  }\n}\n","import { Injectable, NgZone } from '@angular/core';\nimport { combineLatest } from 'rxjs';\nimport { filter, take, takeWhile } from 'rxjs/operators';\nimport { CmsService } from '../../cms/facade/cms.service';\nimport { Page } from '../../cms/model/page.model';\nimport { PageType } from '../../model/cms.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { BaseSiteService } from '../../site-context/facade/base-site.service';\nimport { WindowRef } from '../../window/window-ref';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SmartEditService {\n  private _cmsTicketId: string;\n  private isPreviewPage = false;\n  private _currentPageId: string;\n\n  private defaultPreviewProductCode: string;\n  private defaultPreviewCategoryCode: string;\n\n  constructor(\n    protected cmsService: CmsService,\n    protected routingService: RoutingService,\n    protected baseSiteService: BaseSiteService,\n    protected zone: NgZone,\n    protected winRef: WindowRef\n  ) {\n    this.getCmsTicket();\n\n    if (winRef.nativeWindow) {\n      const window = winRef.nativeWindow as any;\n      // rerender components and slots after editing\n      window.smartedit = window.smartedit || {};\n      window.smartedit.renderComponent = (\n        componentId,\n        componentType,\n        parentId\n      ) => {\n        return this.renderComponent(componentId, componentType, parentId);\n      };\n\n      // reprocess page\n      window.smartedit.reprocessPage = this.reprocessPage;\n    }\n  }\n\n  get cmsTicketId(): string {\n    return this._cmsTicketId;\n  }\n\n  protected getCmsTicket() {\n    combineLatest([\n      this.cmsService.getCurrentPage(),\n      this.routingService.getRouterState(),\n    ])\n      .pipe(\n        takeWhile(([cmsPage]) => cmsPage === undefined),\n        filter(([, routerState]) => {\n          if (routerState.nextState && !this._cmsTicketId) {\n            this._cmsTicketId =\n              routerState.nextState.queryParams['cmsTicketId'];\n            if (this._cmsTicketId) {\n              return true;\n            }\n          }\n          return false;\n        }),\n        take(1)\n      )\n      .subscribe(_ => {\n        this.cmsService.launchInSmartEdit = true;\n        this.getDefaultPreviewCode();\n      });\n  }\n\n  protected getDefaultPreviewCode() {\n    this.baseSiteService\n      .getBaseSiteData()\n      .pipe(\n        filter(site => Object.keys(site).length !== 0),\n        take(1)\n      )\n      .subscribe(site => {\n        this.defaultPreviewCategoryCode = site.defaultPreviewCategoryCode;\n        this.defaultPreviewProductCode = site.defaultPreviewProductCode;\n\n        this.addPageContract();\n      });\n  }\n\n  protected addPageContract() {\n    this.cmsService.getCurrentPage().subscribe(cmsPage => {\n      if (cmsPage && this._cmsTicketId) {\n        this._currentPageId = cmsPage.pageId;\n\n        // before adding contract to page, we need redirect to that page\n        this.goToPreviewPage(cmsPage);\n\n        // remove old page contract\n        const previousContract = [];\n        Array.from(this.winRef.document.body.classList).forEach(attr =>\n          previousContract.push(attr)\n        );\n        previousContract.forEach(attr =>\n          this.winRef.document.body.classList.remove(attr)\n        );\n\n        // add new page contract\n        if (cmsPage.properties && cmsPage.properties.smartedit) {\n          const seClasses = cmsPage.properties.smartedit.classes.split(' ');\n          seClasses.forEach(classItem => {\n            this.winRef.document.body.classList.add(classItem);\n          });\n        }\n      }\n    });\n  }\n\n  protected goToPreviewPage(cmsPage: Page) {\n    // only the first page is the smartedit preview page\n    if (!this.isPreviewPage) {\n      this.isPreviewPage = true;\n      if (\n        cmsPage.type === PageType.PRODUCT_PAGE &&\n        this.defaultPreviewProductCode\n      ) {\n        this.routingService.go({\n          cxRoute: 'product',\n          params: { code: this.defaultPreviewProductCode, name: '' },\n        });\n      } else if (\n        cmsPage.type === PageType.CATEGORY_PAGE &&\n        this.defaultPreviewCategoryCode\n      ) {\n        this.routingService.go({\n          cxRoute: 'category',\n          params: { code: this.defaultPreviewCategoryCode },\n        });\n      }\n    }\n  }\n\n  protected renderComponent(\n    componentId: string,\n    componentType?: string,\n    parentId?: string\n  ): boolean {\n    if (componentId) {\n      this.zone.run(() => {\n        // without parentId, it is slot\n        if (!parentId) {\n          if (this._currentPageId) {\n            this.cmsService.refreshPageById(this._currentPageId);\n          } else {\n            this.cmsService.refreshLatestPage();\n          }\n        } else if (componentType) {\n          this.cmsService.refreshComponent(componentId);\n        }\n      });\n    }\n\n    return true;\n  }\n\n  protected reprocessPage() {\n    // TODO: reprocess page API\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {\n  HttpRequest,\n  HttpHandler,\n  HttpEvent,\n  HttpInterceptor,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\nimport { SmartEditService } from '../services/smart-edit.service';\n\n@Injectable({ providedIn: 'root' })\nexport class CmsTicketInterceptor implements HttpInterceptor {\n  constructor(private service: SmartEditService) {}\n\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    if (request.url.includes('/cms/') && this.service.cmsTicketId) {\n      request = request.clone({\n        setParams: {\n          cmsTicketId: this.service.cmsTicketId,\n        },\n      });\n    }\n\n    return next.handle(request);\n  }\n}\n","import { Provider } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\n\nimport { CmsTicketInterceptor } from './cms-ticket.interceptor';\n\nexport const interceptors: Provider[] = [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useExisting: CmsTicketInterceptor,\n    multi: true,\n  },\n];\n","import { NgModule, ModuleWithProviders } from '@angular/core';\n\nimport { interceptors } from './http-interceptors/index';\n\n@NgModule({})\nexport class SmartEditModule {\n  static forRoot(): ModuleWithProviders<SmartEditModule> {\n    return {\n      ngModule: SmartEditModule,\n      providers: [...interceptors],\n    };\n  }\n}\n","import { NgModuleFactory, StaticProvider, Type } from '@angular/core';\nimport { SERVER_REQUEST_ORIGIN, SERVER_REQUEST_URL } from './ssr.providers';\n\n/**\n * These are the allowed options for the engine\n */\nexport interface NgSetupOptions {\n  bootstrap: Type<{}> | NgModuleFactory<{}>;\n  providers?: StaticProvider[];\n}\n\n/**\n * These are the allowed options for the render\n */\nexport interface RenderOptions extends NgSetupOptions {\n  req: {\n    protocol: string;\n    originalUrl: string;\n    get: (_: string) => string;\n  }; // Request;\n  res?: any; // Response;\n  url?: string;\n  document?: string;\n}\n\nexport type NgExpressEngineInstance = (\n  filePath: string,\n  options: RenderOptions,\n  callback: (err?: Error | null | undefined, html?: string | undefined) => void\n) => void;\n\nexport type NgExpressEngine = (\n  setupOptions: NgSetupOptions\n) => NgExpressEngineInstance;\n\n/**\n * The wrapper over the standard ngExpressEngine, that provides tokens for Spartacus\n * @param ngExpressEngine\n */\nexport class NgExpressEngineDecorator {\n  /**\n   * Returns the higher order ngExpressEngine with provided tokens for Spartacus\n   *\n   * @param ngExpressEngine\n   */\n  static get(ngExpressEngine: NgExpressEngine): NgExpressEngine {\n    const result = function cxNgExpressEngine(\n      setupOptions: NgSetupOptions\n    ): NgExpressEngineInstance {\n      return (filePath, options, callback) => {\n        const engineInstance = ngExpressEngine({\n          ...setupOptions,\n          providers: [\n            ...getServerRequestProviders(options),\n            ...(setupOptions.providers || []),\n          ],\n        });\n        return engineInstance(filePath, options, callback);\n      };\n    };\n    return result;\n  }\n}\n\n/**\n * Returns Spartacus' providers to be passed to the Angular express engine (in SSR)\n *\n * @param options\n */\nexport function getServerRequestProviders(\n  options: RenderOptions\n): StaticProvider[] {\n  return [\n    {\n      provide: SERVER_REQUEST_URL,\n      useValue: getRequestUrl(options.req),\n    },\n    {\n      provide: SERVER_REQUEST_ORIGIN,\n      useValue: getRequestOrigin(options.req),\n    },\n  ];\n}\n\nfunction getRequestUrl(req: any): string {\n  return getRequestOrigin(req) + req.originalUrl;\n}\n\nfunction getRequestOrigin(req: any): string {\n  return req.protocol + '://' + req.get('host');\n}\n","export abstract class StoreFinderConfig {\n  googleMaps?: {\n    apiUrl: string;\n    apiKey: string;\n    scale: number;\n    selectedMarkerScale: number;\n  };\n}\n","import { LoaderState } from '../../state';\nimport { StoreEntities } from '../model';\n\nexport const STORE_FINDER_FEATURE = 'stores';\nexport const STORE_FINDER_DATA = '[StoreFinder] Store Finder Data';\n\nexport interface StateWithStoreFinder {\n  [STORE_FINDER_FEATURE]: StoresState;\n}\n\nexport interface StoresState {\n  findStores: LoaderState<FindStoresState>;\n  viewAllStores: LoaderState<ViewAllStoresState>;\n}\n\nexport interface FindStoresState {\n  findStoresEntities: StoreEntities;\n}\n\nexport interface ViewAllStoresState {\n  viewAllStoresEntities: StoreEntities;\n}\n","import { GeoPoint } from '../../../model/misc.model';\nimport { StateLoaderActions } from '../../../state/utils/index';\nimport { StoreFinderSearchConfig } from '../../model/search-config';\nimport { STORE_FINDER_DATA } from '../store-finder-state';\n\nexport const FIND_STORES_ON_HOLD = '[StoreFinder] On Hold';\nexport const FIND_STORES = '[StoreFinder] Find Stores';\nexport const FIND_STORES_FAIL = '[StoreFinder] Find Stores Fail';\nexport const FIND_STORES_SUCCESS = '[StoreFinder] Find Stores Success';\n\nexport const FIND_STORE_BY_ID = '[StoreFinder] Find a Store by Id';\nexport const FIND_STORE_BY_ID_FAIL = '[StoreFinder] Find a Store by Id Fail';\nexport const FIND_STORE_BY_ID_SUCCESS =\n  '[StoreFinder] Find a Store by Id Success';\n\nexport class FindStoresOnHold extends StateLoaderActions.LoaderLoadAction {\n  readonly type = FIND_STORES_ON_HOLD;\n  constructor() {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport class FindStores extends StateLoaderActions.LoaderLoadAction {\n  readonly type = FIND_STORES;\n  constructor(\n    public payload: {\n      queryText: string;\n      searchConfig?: StoreFinderSearchConfig;\n      longitudeLatitude?: GeoPoint;\n      useMyLocation?: boolean;\n      countryIsoCode?: string;\n    }\n  ) {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport class FindStoresFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = FIND_STORES_FAIL;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA, payload);\n  }\n}\n\nexport class FindStoresSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = FIND_STORES_SUCCESS;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport class FindStoreById extends StateLoaderActions.LoaderLoadAction {\n  readonly type = FIND_STORE_BY_ID;\n  constructor(public payload: { storeId: string }) {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport class FindStoreByIdFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = FIND_STORE_BY_ID_FAIL;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA, payload);\n  }\n}\n\nexport class FindStoreByIdSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = FIND_STORE_BY_ID_SUCCESS;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport type FindStoresAction =\n  | FindStoresOnHold\n  | FindStores\n  | FindStoresFail\n  | FindStoresSuccess\n  | FindStoreById\n  | FindStoreByIdFail\n  | FindStoreByIdSuccess;\n","import { StateLoaderActions } from '../../../state/utils/index';\nimport { STORE_FINDER_DATA } from '../store-finder-state';\n\nexport const VIEW_ALL_STORES = '[StoreFinder] View All Stores';\nexport const VIEW_ALL_STORES_FAIL = '[StoreFinder] View All Stores Fail';\nexport const VIEW_ALL_STORES_SUCCESS = '[StoreFinder] View All Stores Success';\n\nexport class ViewAllStores extends StateLoaderActions.LoaderLoadAction {\n  readonly type = VIEW_ALL_STORES;\n  constructor() {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport class ViewAllStoresFail extends StateLoaderActions.LoaderFailAction {\n  readonly type = VIEW_ALL_STORES_FAIL;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA, payload);\n  }\n}\n\nexport class ViewAllStoresSuccess extends StateLoaderActions.LoaderSuccessAction {\n  readonly type = VIEW_ALL_STORES_SUCCESS;\n  constructor(public payload: any) {\n    super(STORE_FINDER_DATA);\n  }\n}\n\nexport type ViewAllStoresAction =\n  | ViewAllStores\n  | ViewAllStoresFail\n  | ViewAllStoresSuccess;\n","import { createFeatureSelector, MemoizedSelector } from '@ngrx/store';\nimport {\n  StateWithStoreFinder,\n  StoresState,\n  STORE_FINDER_FEATURE,\n} from '../store-finder-state';\n\nexport const getStoreFinderState: MemoizedSelector<\n  StateWithStoreFinder,\n  StoresState\n> = createFeatureSelector<StoresState>(STORE_FINDER_FEATURE);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  FindStoresState,\n  StateWithStoreFinder,\n  StoresState,\n} from '../store-finder-state';\nimport { getStoreFinderState } from './feature.selector';\n\nexport const getFindStoresState: MemoizedSelector<\n  StateWithStoreFinder,\n  LoaderState<FindStoresState>\n> = createSelector(\n  getStoreFinderState,\n  (storesState: StoresState) => storesState.findStores\n);\n\nexport const getFindStoresEntities: MemoizedSelector<\n  StateWithStoreFinder,\n  FindStoresState\n> = createSelector(getFindStoresState, state =>\n  StateLoaderSelectors.loaderValueSelector(state)\n);\n\nexport const getStoresLoading: MemoizedSelector<\n  StateWithStoreFinder,\n  boolean\n> = createSelector(getFindStoresState, state =>\n  StateLoaderSelectors.loaderLoadingSelector(state)\n);\n","import { createSelector, MemoizedSelector } from '@ngrx/store';\nimport { StateLoaderSelectors } from '../../../state/utils/index';\nimport { LoaderState } from '../../../state/utils/loader/loader-state';\nimport {\n  StateWithStoreFinder,\n  StoresState,\n  ViewAllStoresState,\n} from '../store-finder-state';\nimport { getStoreFinderState } from './feature.selector';\n\nexport const getViewAllStoresState: MemoizedSelector<\n  StateWithStoreFinder,\n  LoaderState<ViewAllStoresState>\n> = createSelector(\n  getStoreFinderState,\n  (storesState: StoresState) => storesState.viewAllStores\n);\n\nexport const getViewAllStoresEntities: MemoizedSelector<\n  StateWithStoreFinder,\n  ViewAllStoresState\n> = createSelector(getViewAllStoresState, state =>\n  StateLoaderSelectors.loaderValueSelector(state)\n);\n\nexport const getViewAllStoresLoading: MemoizedSelector<\n  StateWithStoreFinder,\n  boolean\n> = createSelector(getViewAllStoresState, state =>\n  StateLoaderSelectors.loaderLoadingSelector(state)\n);\n","import { Injectable } from '@angular/core';\nimport { Action, select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { GeoPoint } from '../../model/misc.model';\nimport { WindowRef } from '../../window/window-ref';\nimport { StoreFinderActions } from '../store/actions/index';\nimport { StoreFinderSelectors } from '../store/selectors/index';\nimport {\n  FindStoresState,\n  StateWithStoreFinder,\n  ViewAllStoresState,\n} from '../store/store-finder-state';\nimport { StoreFinderSearchConfig } from './../model/search-config';\nimport {\n  GlobalMessageService,\n  GlobalMessageType,\n} from '../../global-message/index';\nimport { RoutingService } from '../../routing/index';\n\n@Injectable()\nexport class StoreFinderService {\n  private geolocationWatchId: number = null;\n\n  constructor(\n    protected store: Store<StateWithStoreFinder>,\n    protected winRef: WindowRef,\n    protected globalMessageService: GlobalMessageService,\n    protected routingService: RoutingService\n  ) {}\n\n  /**\n   * Returns boolean observable for store's loading state\n   */\n  getStoresLoading(): Observable<boolean> {\n    return this.store.pipe(select(StoreFinderSelectors.getStoresLoading));\n  }\n\n  /**\n   * Returns observable for store's entities\n   */\n  getFindStoresEntities(): Observable<FindStoresState> {\n    return this.store.pipe(select(StoreFinderSelectors.getFindStoresEntities));\n  }\n\n  /**\n   * Returns boolean observable for view all store's loading state\n   */\n  getViewAllStoresLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(StoreFinderSelectors.getViewAllStoresLoading)\n    );\n  }\n\n  /**\n   * Returns observable for view all store's entities\n   */\n  getViewAllStoresEntities(): Observable<ViewAllStoresState> {\n    return this.store.pipe(\n      select(StoreFinderSelectors.getViewAllStoresEntities)\n    );\n  }\n\n  /**\n   * Store finding action functionality\n   * @param queryText text query\n   * @param searchConfig search configuration\n   * @param longitudeLatitude longitude and latitude coordinates\n   * @param countryIsoCode country ISO code\n   * @param useMyLocation current location coordinates\n   */\n  findStoresAction(\n    queryText: string,\n    searchConfig?: StoreFinderSearchConfig,\n    longitudeLatitude?: GeoPoint,\n    countryIsoCode?: string,\n    useMyLocation?: boolean\n  ) {\n    if (useMyLocation && this.winRef.nativeWindow) {\n      this.clearWatchGeolocation(new StoreFinderActions.FindStoresOnHold());\n      this.geolocationWatchId = this.winRef.nativeWindow.navigator.geolocation.watchPosition(\n        (pos: Position) => {\n          const position: GeoPoint = {\n            longitude: pos.coords.longitude,\n            latitude: pos.coords.latitude,\n          };\n\n          this.clearWatchGeolocation(\n            new StoreFinderActions.FindStores({\n              queryText: queryText,\n              searchConfig: searchConfig,\n              longitudeLatitude: position,\n              countryIsoCode: countryIsoCode,\n            })\n          );\n        },\n        () => {\n          this.globalMessageService.add(\n            { key: 'storeFinder.geolocationNotEnabled' },\n            GlobalMessageType.MSG_TYPE_ERROR\n          );\n          this.routingService.go(['/store-finder']);\n        }\n      );\n    } else {\n      this.clearWatchGeolocation(\n        new StoreFinderActions.FindStores({\n          queryText: queryText,\n          searchConfig: searchConfig,\n          longitudeLatitude: longitudeLatitude,\n          countryIsoCode: countryIsoCode,\n        })\n      );\n    }\n  }\n\n  /**\n   * View all stores\n   */\n  viewAllStores() {\n    this.clearWatchGeolocation(new StoreFinderActions.ViewAllStores());\n  }\n\n  /**\n   * View all stores by id\n   * @param storeId store id\n   */\n  viewStoreById(storeId: string) {\n    this.clearWatchGeolocation(\n      new StoreFinderActions.FindStoreById({ storeId })\n    );\n  }\n\n  private clearWatchGeolocation(callbackAction: Action) {\n    if (this.geolocationWatchId !== null) {\n      this.winRef.nativeWindow.navigator.geolocation.clearWatch(\n        this.geolocationWatchId\n      );\n      this.geolocationWatchId = null;\n    }\n    this.store.dispatch(callbackAction);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { PointOfService } from '../../model/point-of-service.model';\n\n@Injectable()\nexport class StoreDataService {\n  readonly DECIMAL_BASE: 10;\n  readonly weekDays = {\n    0: 'Sun',\n    1: 'Mon',\n    2: 'Tue',\n    3: 'Wed',\n    4: 'Thu',\n    5: 'Fri',\n    6: 'Sat',\n  };\n\n  /**\n   * Returns store latitude\n   * @param location store location\n   */\n  getStoreLatitude(location: PointOfService): number {\n    return location.geoPoint.latitude;\n  }\n\n  /**\n   * Returns store longitude\n   * @param location store location\n   */\n  getStoreLongitude(location: PointOfService): number {\n    return location.geoPoint.longitude;\n  }\n\n  /**\n   * Returns store closing time\n   * @param location store location\n   * @param date date to compare\n   */\n  getStoreClosingTime(location: PointOfService, date: Date): string {\n    const requestedDaySchedule = this.getSchedule(location, date);\n\n    if (requestedDaySchedule) {\n      if (requestedDaySchedule.closed && requestedDaySchedule.closed === true) {\n        return 'closed';\n      }\n\n      if (requestedDaySchedule.closingTime) {\n        return requestedDaySchedule.closingTime.formattedHour;\n      }\n    }\n  }\n\n  /**\n   * Returns store opening time\n   * @param location store location\n   * @param date date to compare\n   */\n  getStoreOpeningTime(location: PointOfService, date: Date): string {\n    const requestedDaySchedule = this.getSchedule(location, date);\n\n    if (requestedDaySchedule) {\n      if (requestedDaySchedule.closed && requestedDaySchedule.closed === true) {\n        return 'closed';\n      }\n\n      if (requestedDaySchedule.openingTime) {\n        return requestedDaySchedule.openingTime.formattedHour;\n      }\n    }\n  }\n\n  /**\n   * Extracts schedule from the given location for the given date\n   * @param location location\n   * @param date date\n   *\n   * @returns payload describing the store's schedule for the given day.\n   */\n  protected getSchedule(location: PointOfService, date: Date): any {\n    const weekday = this.weekDays[date.getDay()];\n    return location.openingHours.weekDayOpeningList.find(\n      weekDayOpeningListItem => weekDayOpeningListItem.weekDay === weekday\n    );\n  }\n}\n","import { Inject, Injectable } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\n\n@Injectable()\nexport class ExternalJsFileLoader {\n  constructor(@Inject(DOCUMENT) protected document: any) {}\n\n  /**\n   * Loads a javascript from an external URL\n   * @param src URL for the script to be loaded\n   * @param params additional parameters to be attached to the given URL\n   * @param callback a function to be invoked after the script has been loaded\n   */\n  public load(src: string, params?: Object, callback?: EventListener): void {\n    const script = this.document.createElement('script');\n    script.type = 'text/javascript';\n    if (params) {\n      script.src = src + this.parseParams(params);\n    } else {\n      script.src = src;\n    }\n\n    script.async = true;\n    script.defer = true;\n    if (callback) {\n      script.addEventListener('load', callback);\n    }\n\n    document.head.appendChild(script);\n  }\n\n  /**\n   * Parses the given object with parameters to a string \"param1=value1&param2=value2\"\n   * @param params object containing parameters\n   */\n  private parseParams(params: Object): string {\n    let result = '';\n    const keysArray = Object.keys(params);\n    if (keysArray.length > 0) {\n      result =\n        '?' +\n        keysArray\n          .map(key => encodeURI(key) + '=' + encodeURI(params[key]))\n          .join('&');\n    }\n    return result;\n  }\n}\n","/// <reference types=\"@types/googlemaps\" />\nimport { ExternalJsFileLoader } from './external-js-file-loader.service';\nimport { Injectable } from '@angular/core';\nimport { StoreDataService } from '../facade/store-data.service';\nimport { StoreFinderConfig } from '../config/store-finder-config';\n\n@Injectable()\nexport class GoogleMapRendererService {\n  private googleMap: google.maps.Map = null;\n  private markers: google.maps.Marker[];\n\n  constructor(\n    protected config: StoreFinderConfig,\n    protected externalJsFileLoader: ExternalJsFileLoader,\n    protected storeDataService: StoreDataService\n  ) {}\n\n  /**\n   * Renders google map on the given element and draws markers on it.\n   * If map already exists it will use an existing map otherwise it will create one\n   * @param mapElement HTML element inside of which the map will be displayed\n   * @param locations array containign geo data to be displayed on the map\n   * @param selectMarkerHandler function to handle whenever a marker on a map is clicked\n   */\n  renderMap(\n    mapElement: HTMLElement,\n    locations: any[],\n    selectMarkerHandler?: Function\n  ): void {\n    if (this.googleMap === null) {\n      this.externalJsFileLoader.load(\n        this.config.googleMaps.apiUrl,\n        { key: this.config.googleMaps.apiKey },\n        () => {\n          this.drawMap(mapElement, locations, selectMarkerHandler);\n        }\n      );\n    } else {\n      this.drawMap(mapElement, locations, selectMarkerHandler);\n    }\n  }\n\n  /**\n   * Centers the map to the given point\n   * @param latitute latitude of the new center\n   * @param longitude longitude of the new center\n   */\n  centerMap(latitute: number, longitude: number): void {\n    this.googleMap.panTo({ lat: latitute, lng: longitude });\n    this.googleMap.setZoom(this.config.googleMaps.selectedMarkerScale);\n  }\n\n  /**\n   * Defines and returns {@link google.maps.LatLng} representing a point where the map will be centered\n   * @param locations list of locations\n   */\n  private defineMapCenter(locations: any[]): google.maps.LatLng {\n    return new google.maps.LatLng(\n      this.storeDataService.getStoreLatitude(locations[0]),\n      this.storeDataService.getStoreLongitude(locations[0])\n    );\n  }\n\n  /**\n   * Creates google map inside if the given HTML element centered to the given point\n   * @param mapElement {@link HTMLElement} inside of which the map will be created\n   * @param mapCenter {@link google.maps.LatLng} the point where the map will be centered\n   */\n  private initMap(\n    mapElement: HTMLElement,\n    mapCenter: google.maps.LatLng\n  ): void {\n    type GestureHandlingOptions = 'cooperative' | 'greedy' | 'none' | 'auto';\n    const gestureOption: GestureHandlingOptions = 'greedy';\n\n    const mapProp = {\n      center: mapCenter,\n      zoom: this.config.googleMaps.scale,\n      mapTypeId: google.maps.MapTypeId.ROADMAP,\n      gestureHandling: gestureOption,\n    };\n    this.googleMap = new google.maps.Map(mapElement, mapProp);\n  }\n\n  /**\n   * Erases the current map's markers and create a new one based on the given locations\n   * @param locations array of locations to be displayed on the map\n   * @param selectMarkerHandler function to handle whenever a marker on a map is clicked\n   */\n  private createMarkers(\n    locations: any[],\n    selectMarkerHandler?: Function\n  ): void {\n    this.markers = [];\n    locations.forEach((element, index) => {\n      const marker = new google.maps.Marker({\n        position: new google.maps.LatLng(\n          this.storeDataService.getStoreLatitude(element),\n          this.storeDataService.getStoreLongitude(element)\n        ),\n        label: index + 1 + '',\n      });\n      this.markers.push(marker);\n      marker.setMap(this.googleMap);\n      marker.addListener('mouseover', function() {\n        marker.setAnimation(google.maps.Animation.BOUNCE);\n      });\n      marker.addListener('mouseout', function() {\n        marker.setAnimation(null);\n      });\n      if (selectMarkerHandler) {\n        marker.addListener('click', function() {\n          selectMarkerHandler(index);\n        });\n      }\n    });\n  }\n\n  /**\n   * Initialize and draw the map\n   * @param mapElement {@link HTMLElement} inside of which the map will be drawn\n   * @param locations array of locations to be displayed on the map\n   * @param selectMarkerHandler function to handle whenever a marker on a map is clicked\n   */\n  private drawMap(\n    mapElement: HTMLElement,\n    locations: any[],\n    selectMarkerHandler: Function\n  ) {\n    this.initMap(mapElement, this.defineMapCenter(locations));\n    this.createMarkers(locations, selectMarkerHandler);\n  }\n}\n","import { StoreFinderConfig } from './store-finder-config';\n\nexport const defaultStoreFinderConfig: StoreFinderConfig = {\n  googleMaps: {\n    apiUrl: 'https://maps.googleapis.com/maps/api/js',\n    apiKey: '',\n    scale: 5,\n    selectedMarkerScale: 17,\n  },\n};\n","import { ActionReducerMap, MetaReducer } from '@ngrx/store';\n\nimport { InjectionToken, Provider } from '@angular/core';\nimport { StoresState, STORE_FINDER_DATA } from '../store-finder-state';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\n\nexport function getReducers(): ActionReducerMap<StoresState> {\n  return {\n    findStores: loaderReducer(STORE_FINDER_DATA),\n    viewAllStores: loaderReducer(STORE_FINDER_DATA),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  StoresState\n>> = new InjectionToken<ActionReducerMap<StoresState>>('StoreFinderReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport const metaReducers: MetaReducer<any>[] = [];\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { StoreFinderConnector } from '../../connectors/store-finder.connector';\nimport { StoreFinderActions } from '../actions/index';\n\n@Injectable()\nexport class FindStoresEffect {\n  constructor(\n    private actions$: Actions,\n    private storeFinderConnector: StoreFinderConnector\n  ) {}\n\n  @Effect()\n  findStores$: Observable<\n    StoreFinderActions.FindStoresSuccess | StoreFinderActions.FindStoresFail\n  > = this.actions$.pipe(\n    ofType(StoreFinderActions.FIND_STORES),\n    map((action: StoreFinderActions.FindStores) => action.payload),\n    mergeMap(payload =>\n      this.storeFinderConnector\n        .search(\n          payload.queryText,\n          payload.searchConfig,\n          payload.longitudeLatitude\n        )\n        .pipe(\n          map(data => {\n            if (payload.countryIsoCode) {\n              data.stores = data.stores.filter(\n                store =>\n                  store.address.country.isocode === payload.countryIsoCode\n              );\n              data.stores.sort((a, b) =>\n                a.name < b.name ? -1 : a.name > b.name ? 1 : 0\n              );\n            }\n\n            return new StoreFinderActions.FindStoresSuccess(data);\n          }),\n          catchError(error =>\n            of(\n              new StoreFinderActions.FindStoresFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    )\n  );\n\n  @Effect()\n  findStoreById$: Observable<\n    | StoreFinderActions.FindStoreByIdSuccess\n    | StoreFinderActions.FindStoreByIdFail\n  > = this.actions$.pipe(\n    ofType(StoreFinderActions.FIND_STORE_BY_ID),\n    map((action: StoreFinderActions.FindStoreById) => action.payload),\n    switchMap(payload =>\n      this.storeFinderConnector.get(payload.storeId).pipe(\n        map(data => new StoreFinderActions.FindStoreByIdSuccess(data)),\n        catchError(error =>\n          of(\n            new StoreFinderActions.FindStoreByIdFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { StoreFinderConnector } from '../../connectors/store-finder.connector';\nimport { StoreFinderActions } from '../actions/index';\n\n@Injectable()\nexport class ViewAllStoresEffect {\n  constructor(\n    private actions$: Actions,\n    private storeFinderConnector: StoreFinderConnector\n  ) {}\n\n  @Effect()\n  viewAllStores$: Observable<\n    | StoreFinderActions.ViewAllStoresSuccess\n    | StoreFinderActions.ViewAllStoresFail\n  > = this.actions$.pipe(\n    ofType(StoreFinderActions.VIEW_ALL_STORES),\n    switchMap(() => {\n      return this.storeFinderConnector.getCounts().pipe(\n        map(data => {\n          data.sort((a, b) => (a.name < b.name ? -1 : a.name > b.name ? 1 : 0));\n          return new StoreFinderActions.ViewAllStoresSuccess(data);\n        }),\n        catchError(error =>\n          of(\n            new StoreFinderActions.ViewAllStoresFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n}\n","import { FindStoresEffect } from './find-stores.effect';\nimport { ViewAllStoresEffect } from './view-all-stores.effect';\n\nexport const effects: any[] = [FindStoresEffect, ViewAllStoresEffect];\n\nexport * from './find-stores.effect';\nexport * from './view-all-stores.effect';\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\n\nimport { StoreModule } from '@ngrx/store';\nimport { EffectsModule } from '@ngrx/effects';\n\nimport { reducerToken, reducerProvider } from './reducers/index';\nimport { effects } from './effects/index';\nimport { STORE_FINDER_FEATURE } from './store-finder-state';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    StoreModule.forFeature(STORE_FINDER_FEATURE, reducerToken),\n    EffectsModule.forFeature(effects),\n  ],\n  providers: [reducerProvider],\n})\nexport class StoreFinderStoreModule {}\n","import { NgModule } from '@angular/core';\nimport { Config, provideDefaultConfig } from '../config/config.module';\nimport { defaultStoreFinderConfig } from './config/default-store-finder-config';\nimport { StoreFinderConfig } from './config/store-finder-config';\nimport { StoreDataService } from './facade/store-data.service';\nimport { StoreFinderService } from './facade/store-finder.service';\nimport {\n  ExternalJsFileLoader,\n  GoogleMapRendererService,\n} from './service/index';\nimport { StoreFinderStoreModule } from './store/store-finder-store.module';\n\n@NgModule({\n  imports: [StoreFinderStoreModule],\n  providers: [\n    provideDefaultConfig(defaultStoreFinderConfig),\n    StoreFinderService,\n    StoreDataService,\n    GoogleMapRendererService,\n    ExternalJsFileLoader,\n    { provide: StoreFinderConfig, useExisting: Config },\n  ],\n})\nexport class StoreFinderCoreModule {}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { Title, User, UserSignUp } from '../../../model/misc.model';\nimport { UserAdapter } from './user.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserConnector {\n  constructor(protected adapter: UserAdapter) {}\n\n  get(userId: string): Observable<User> {\n    return this.adapter.load(userId);\n  }\n\n  update(username: string, user: User): Observable<{}> {\n    return this.adapter.update(username, user);\n  }\n\n  register(user: UserSignUp): Observable<User> {\n    return this.adapter.register(user);\n  }\n\n  registerGuest(guid: string, password: string): Observable<User> {\n    return this.adapter.registerGuest(guid, password);\n  }\n\n  requestForgotPasswordEmail(userEmailAddress: string): Observable<{}> {\n    return this.adapter.requestForgotPasswordEmail(userEmailAddress);\n  }\n\n  resetPassword(token: string, newPassword: string): Observable<{}> {\n    return this.adapter.resetPassword(token, newPassword);\n  }\n\n  updateEmail(\n    userId: string,\n    currentPassword: string,\n    newUserId: string\n  ): Observable<{}> {\n    return this.adapter.updateEmail(userId, currentPassword, newUserId);\n  }\n\n  updatePassword(\n    userId: string,\n    oldPassword: string,\n    newPassword: string\n  ): Observable<{}> {\n    return this.adapter.updatePassword(userId, oldPassword, newPassword);\n  }\n\n  remove(userId: string): Observable<{}> {\n    return this.adapter.remove(userId);\n  }\n\n  getTitles(): Observable<Title[]> {\n    return this.adapter.loadTitles();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { UserConsentAdapter } from './user-consent.adapter';\nimport { ConsentTemplate } from '../../../model/consent.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserConsentConnector {\n  constructor(protected adapter: UserConsentAdapter) {}\n\n  loadConsents(userId: string): Observable<ConsentTemplate[]> {\n    return this.adapter.loadConsents(userId);\n  }\n\n  giveConsent(\n    userId: string,\n    consentTemplateId: string,\n    consentTemplateVersion: number\n  ): Observable<ConsentTemplate> {\n    return this.adapter.giveConsent(\n      userId,\n      consentTemplateId,\n      consentTemplateVersion\n    );\n  }\n\n  withdrawConsent(userId: string, consentCode: string): Observable<{}> {\n    return this.adapter.withdrawConsent(userId, consentCode);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { UserPaymentAdapter } from './user-payment.adapter';\nimport { Observable } from 'rxjs';\nimport { PaymentDetails } from '../../../model/cart.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserPaymentConnector {\n  constructor(protected adapter: UserPaymentAdapter) {}\n\n  getAll(userId: string): Observable<PaymentDetails[]> {\n    return this.adapter.loadAll(userId);\n  }\n\n  delete(userId: string, paymentMethodID: string): Observable<{}> {\n    return this.adapter.delete(userId, paymentMethodID);\n  }\n\n  setDefault(userId: string, paymentMethodID: string): Observable<{}> {\n    return this.adapter.setDefault(userId, paymentMethodID);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ConsignmentTracking } from '../../../model/consignment-tracking.model';\nimport {\n  CancellationRequestEntryInputList,\n  Order,\n  OrderHistoryList,\n  ReturnRequest,\n  ReturnRequestEntryInputList,\n  ReturnRequestList,\n  ReturnRequestModification,\n} from '../../../model/order.model';\nimport { UserOrderAdapter } from './user-order.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserOrderConnector {\n  constructor(protected adapter: UserOrderAdapter) {}\n\n  public get(userId: string, orderCode: string): Observable<Order> {\n    return this.adapter.load(userId, orderCode);\n  }\n\n  public getHistory(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<OrderHistoryList> {\n    return this.adapter.loadHistory(userId, pageSize, currentPage, sort);\n  }\n\n  public getConsignmentTracking(\n    orderCode: string,\n    consignmentCode: string,\n    userId?: string\n  ): Observable<ConsignmentTracking> {\n    return this.adapter.getConsignmentTracking(\n      orderCode,\n      consignmentCode,\n      userId\n    );\n  }\n\n  public cancel(\n    userId: string,\n    orderCode: string,\n    cancelRequestInput: CancellationRequestEntryInputList\n  ): Observable<{}> {\n    return this.adapter.cancel(userId, orderCode, cancelRequestInput);\n  }\n\n  public return(\n    userId: string,\n    returnRequestInput: ReturnRequestEntryInputList\n  ): Observable<ReturnRequest> {\n    return this.adapter.createReturnRequest(userId, returnRequestInput);\n  }\n\n  public getReturnRequestDetail(\n    userId: string,\n    returnRequestCode: string\n  ): Observable<ReturnRequest> {\n    return this.adapter.loadReturnRequestDetail(userId, returnRequestCode);\n  }\n\n  public getReturnRequestList(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string\n  ): Observable<ReturnRequestList> {\n    return this.adapter.loadReturnRequestList(\n      userId,\n      pageSize,\n      currentPage,\n      sort\n    );\n  }\n\n  public cancelReturnRequest(\n    userId: string,\n    returnRequestCode: string,\n    returnRequestModification: ReturnRequestModification\n  ): Observable<{}> {\n    return this.adapter.cancelReturnRequest(\n      userId,\n      returnRequestCode,\n      returnRequestModification\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport {\n  CustomerCouponSearchResult,\n  CustomerCouponNotification,\n  CustomerCoupon2Customer,\n} from '../../../model/customer-coupon.model';\nimport { CustomerCouponAdapter } from './customer-coupon.adapter';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CustomerCouponConnector {\n  constructor(protected adapter: CustomerCouponAdapter) {}\n\n  getCustomerCoupons(\n    userId: string,\n    pageSize: number,\n    currentPage: number,\n    sort: string\n  ): Observable<CustomerCouponSearchResult> {\n    return this.adapter.getCustomerCoupons(userId, pageSize, currentPage, sort);\n  }\n\n  turnOnNotification(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCouponNotification> {\n    return this.adapter.turnOnNotification(userId, couponCode);\n  }\n\n  turnOffNotification(userId: string, couponCode: string): Observable<{}> {\n    return this.adapter.turnOffNotification(userId, couponCode);\n  }\n\n  claimCustomerCoupon(\n    userId: string,\n    couponCode: string\n  ): Observable<CustomerCoupon2Customer> {\n    return this.adapter.claimCustomerCoupon(userId, couponCode);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { UserInterestsAdapter } from './user-interests.adapter';\nimport { Observable } from 'rxjs';\nimport {\n  ProductInterestSearchResult,\n  ProductInterestEntryRelation,\n  NotificationType,\n} from '../../../model/product-interest.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserInterestsConnector {\n  constructor(protected adapter: UserInterestsAdapter) {}\n  getInterests(\n    userId: string,\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string,\n    productCode?: string,\n    notificationType?: NotificationType\n  ): Observable<ProductInterestSearchResult> {\n    return this.adapter.getInterests(\n      userId,\n      pageSize,\n      currentPage,\n      sort,\n      productCode,\n      notificationType\n    );\n  }\n\n  removeInterest(\n    userId: string,\n    item: ProductInterestEntryRelation\n  ): Observable<any[]> {\n    return this.adapter.removeInterest(userId, item);\n  }\n\n  addInterest(\n    userId: string,\n    productCode: string,\n    notificationType: NotificationType\n  ): Observable<any> {\n    return this.adapter.addInterest(userId, productCode, notificationType);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { merge, Observable } from 'rxjs';\nimport { distinctUntilChanged, map } from 'rxjs/operators';\nimport { AnonymousConsentsService } from '../../anonymous-consents/index';\nimport { AnonymousConsent, Consent } from '../../model/index';\nimport { UserConsentService } from './user-consent.service';\n\n/**\n * Unified facade for both anonymous and registered user consents.\n */\n@Injectable({ providedIn: 'root' })\nexport class ConsentService {\n  constructor(\n    protected anonymousConsentsService: AnonymousConsentsService,\n    protected userConsentService: UserConsentService\n  ) {}\n\n  /**\n   * Returns either anonymous consent or registered consent as they are emmited.\n   * @param templateCode for which to return either anonymous or registered consent.\n   */\n  getConsent(templateCode: string): Observable<AnonymousConsent | Consent> {\n    return merge(\n      this.userConsentService.getConsent(templateCode),\n      this.anonymousConsentsService.getConsent(templateCode)\n    );\n  }\n\n  /**\n   * Checks if the `templateId`'s template has a given consent.\n   * The method returns `false` if the consent doesn't exist or if it's withdrawn. Otherwise, `true` is returned.\n   *\n   * @param templateId of a template which's consent should be checked\n   */\n  checkConsentGivenByTemplateId(templateId: string): Observable<boolean> {\n    return this.getConsent(templateId).pipe(\n      map(consent => {\n        if (!consent) {\n          return false;\n        }\n\n        return this.isAnonymousConsentType(consent)\n          ? this.anonymousConsentsService.isConsentGiven(consent)\n          : this.userConsentService.isConsentGiven(consent);\n      }),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   * Checks if the `templateId`'s template has a withdrawn consent.\n   * The method returns `true` if the consent doesn't exist or if it's withdrawn. Otherwise, `false` is returned.\n   *\n   * @param templateId of a template which's consent should be checked\n   */\n  checkConsentWithdrawnByTemplateId(templateId: string): Observable<boolean> {\n    return this.getConsent(templateId).pipe(\n      map(consent => {\n        if (!consent) {\n          return true;\n        }\n\n        return this.isAnonymousConsentType(consent)\n          ? this.anonymousConsentsService.isConsentWithdrawn(consent)\n          : this.userConsentService.isConsentWithdrawn(consent);\n      }),\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   *\n   * Checks the provided `consent`'s type and delegates to an appropriate method - `anonymousConsentsService.isConsentGiven(consent)` or `this.userConsentService.isConsentGiven`\n   *\n   * @param consent a consent to check\n   */\n  isConsentGiven(consent: AnonymousConsent | Consent): boolean {\n    return this.isAnonymousConsentType(consent)\n      ? this.anonymousConsentsService.isConsentGiven(consent)\n      : this.userConsentService.isConsentGiven(consent);\n  }\n\n  /**\n   *\n   * Checks the provided `consent`'s type and delegates to an appropriate method - `anonymousConsentsService.isConsentWithdrawn(consent)` or `this.userConsentService.isConsentWithdrawn`\n   *\n   * @param consent a consent to check\n   */\n  isConsentWithdrawn(consent: AnonymousConsent | Consent): boolean {\n    return this.isAnonymousConsentType(consent)\n      ? this.anonymousConsentsService.isConsentWithdrawn(consent)\n      : this.userConsentService.isConsentWithdrawn(consent);\n  }\n\n  /**\n   * Returns `true` if the provided consent is of type `AnonymousConsent`. Otherwise, `false` is returned.\n   */\n  isAnonymousConsentType(\n    consent: AnonymousConsent | Consent\n  ): consent is AnonymousConsent {\n    if (!consent) {\n      return false;\n    }\n\n    return (consent as AnonymousConsent).templateCode !== undefined;\n  }\n\n  /**\n   * Returns `true` if the provided consent is of type `Consent`. Otherwise, `false` is returned.\n   */\n  isConsentType(consent: AnonymousConsent | Consent): consent is Consent {\n    if (!consent) {\n      return false;\n    }\n\n    return (consent as Consent).code !== undefined;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, take } from 'rxjs/operators';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { Address, Country, Region } from '../../model/address.model';\nimport { OCC_USER_ID_CURRENT } from '../../occ/index';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport { StateWithUser } from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserAddressService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected authService: AuthService\n  ) {}\n\n  /**\n   * Retrieves user's addresses\n   */\n  loadAddresses(): void {\n    this.withUserId(userId =>\n      this.store.dispatch(new UserActions.LoadUserAddresses(userId))\n    );\n  }\n\n  /**\n   * Adds user address\n   * @param address a user address\n   */\n  addUserAddress(address: Address): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.AddUserAddress({\n          userId,\n          address,\n        })\n      )\n    );\n  }\n\n  /**\n   * Sets user address as default\n   * @param addressId a user address ID\n   */\n  setAddressAsDefault(addressId: string): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.UpdateUserAddress({\n          userId,\n          addressId,\n          address: { defaultAddress: true },\n        })\n      )\n    );\n  }\n\n  /**\n   * Updates existing user address\n   * @param addressId a user address ID\n   * @param address a user address\n   */\n  updateUserAddress(addressId: string, address: Address): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.UpdateUserAddress({\n          userId,\n          addressId,\n          address,\n        })\n      )\n    );\n  }\n\n  /**\n   * Deletes existing user address\n   * @param addressId a user address ID\n   */\n  deleteUserAddress(addressId: string): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.DeleteUserAddress({\n          userId,\n          addressId,\n        })\n      )\n    );\n  }\n\n  /**\n   * Returns addresses\n   */\n  getAddresses(): Observable<Address[]> {\n    return this.store.pipe(select(UsersSelectors.getAddresses));\n  }\n\n  /**\n   * Returns a loading flag for addresses\n   */\n  getAddressesLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getAddressesLoading));\n  }\n\n  getAddressesLoadedSuccess(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getAddressesLoadedSuccess));\n  }\n  /**\n   * Retrieves delivery countries\n   */\n  loadDeliveryCountries(): void {\n    this.store.dispatch(new UserActions.LoadDeliveryCountries());\n  }\n\n  /**\n   * Returns all delivery countries\n   */\n  getDeliveryCountries(): Observable<Country[]> {\n    return this.store.pipe(select(UsersSelectors.getAllDeliveryCountries));\n  }\n\n  /**\n   * Returns a country based on the provided `isocode`\n   * @param isocode an isocode for a country\n   */\n  getCountry(isocode: string): Observable<Country> {\n    return this.store.pipe(\n      select(UsersSelectors.countrySelectorFactory(isocode))\n    );\n  }\n\n  /**\n   * Retrieves regions for specified country by `countryIsoCode`\n   * @param countryIsoCode\n   */\n  loadRegions(countryIsoCode: string): void {\n    this.store.dispatch(new UserActions.LoadRegions(countryIsoCode));\n  }\n\n  /**\n   * Clear regions in store - useful when changing country\n   */\n  clearRegions(): void {\n    this.store.dispatch(new UserActions.ClearRegions());\n  }\n\n  /**\n   * Returns all regions\n   */\n  getRegions(countryIsoCode: string): Observable<Region[]> {\n    return this.store.pipe(\n      select(UsersSelectors.getRegionsDataAndLoading),\n      map(({ regions, country, loading, loaded }) => {\n        if (!countryIsoCode && (loading || loaded)) {\n          this.clearRegions();\n          return [];\n        } else if (loading && !loaded) {\n          // don't interrupt loading\n          return [];\n        } else if (!loading && countryIsoCode !== country && countryIsoCode) {\n          // country changed - clear store and load new regions\n          if (country) {\n            this.clearRegions();\n          }\n          this.loadRegions(countryIsoCode);\n          return [];\n        }\n        return regions;\n      })\n    );\n  }\n\n  /**\n   * Utility method to distinquish pre / post 1.3.0 in a convenient way.\n   *\n   */\n  private withUserId(callback: (userId: string) => void): void {\n    if (this.authService) {\n      this.authService\n        .getOccUserId()\n        .pipe(take(1))\n        .subscribe(userId => callback(userId));\n    } else {\n      // TODO(issue:#5628) Deprecated since 1.3.0\n      callback(OCC_USER_ID_CURRENT);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, take, tap } from 'rxjs/operators';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { ConsignmentTracking } from '../../model/consignment-tracking.model';\nimport {\n  CancellationRequestEntryInputList,\n  Order,\n  OrderHistoryList,\n} from '../../model/order.model';\nimport { OCC_USER_ID_CURRENT } from '../../occ/index';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport {\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport { CANCEL_ORDER_PROCESS_ID, StateWithUser } from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserOrderService {\n  constructor(\n    store: Store<StateWithUser | StateWithProcess<void>>,\n    // tslint:disable-next-line:unified-signatures\n    authService: AuthService\n  );\n  /**\n   * @deprecated since version 1.2\n   *  Use constructor(store: Store<StateWithUser | StateWithProcess<void>>,\n   *  authService: AuthService) instead\n   *\n   *  TODO(issue:#5628) Deprecated since 1.3.0\n   */\n  constructor(store: Store<StateWithUser | StateWithProcess<void>>);\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected authService?: AuthService\n  ) {}\n\n  /**\n   * Returns an order's detail\n   */\n  getOrderDetails(): Observable<Order> {\n    return this.store.pipe(select(UsersSelectors.getOrderDetails));\n  }\n\n  /**\n   * Retrieves order's details\n   *\n   * @param orderCode an order code\n   */\n  loadOrderDetails(orderCode: string): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.LoadOrderDetails({\n          userId,\n          orderCode,\n        })\n      )\n    );\n  }\n\n  /**\n   * Clears order's details\n   */\n  clearOrderDetails(): void {\n    this.store.dispatch(new UserActions.ClearOrderDetails());\n  }\n\n  /**\n   * Returns order history list\n   */\n  getOrderHistoryList(pageSize: number): Observable<OrderHistoryList> {\n    return this.store.pipe(\n      select(UsersSelectors.getOrdersState),\n      tap(orderListState => {\n        const attemptedLoad =\n          orderListState.loading ||\n          orderListState.success ||\n          orderListState.error;\n        if (!attemptedLoad) {\n          this.loadOrderList(pageSize);\n        }\n      }),\n      map(orderListState => orderListState.value)\n    );\n  }\n\n  /**\n   * Returns a loaded flag for order history list\n   */\n  getOrderHistoryListLoaded(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getOrdersLoaded));\n  }\n\n  /**\n   * Retrieves an order list\n   * @param pageSize page size\n   * @param currentPage current page\n   * @param sort sort\n   */\n  loadOrderList(pageSize: number, currentPage?: number, sort?: string): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.LoadUserOrders({\n          userId,\n          pageSize,\n          currentPage,\n          sort,\n        })\n      )\n    );\n  }\n\n  /**\n   * Cleaning order list\n   */\n  clearOrderList(): void {\n    this.store.dispatch(new UserActions.ClearUserOrders());\n  }\n\n  /**\n   *  Returns a consignment tracking detail\n   */\n  getConsignmentTracking(): Observable<ConsignmentTracking> {\n    return this.store.pipe(select(UsersSelectors.getConsignmentTracking));\n  }\n\n  /**\n   * Retrieves consignment tracking details\n   * @param orderCode an order code\n   * @param consignmentCode a consignment code\n   */\n  loadConsignmentTracking(orderCode: string, consignmentCode: string): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.LoadConsignmentTracking({\n          userId,\n          orderCode,\n          consignmentCode,\n        })\n      )\n    );\n  }\n\n  /**\n   * Cleaning consignment tracking\n   */\n  clearConsignmentTracking(): void {\n    this.store.dispatch(new UserActions.ClearConsignmentTracking());\n  }\n\n  /*\n   * Cancel an order\n   */\n  cancelOrder(\n    orderCode: string,\n    cancelRequestInput: CancellationRequestEntryInputList\n  ): void {\n    this.withUserId(userId => {\n      this.store.dispatch(\n        new UserActions.CancelOrder({\n          userId,\n          orderCode,\n          cancelRequestInput,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the cancel order loading flag\n   */\n  getCancelOrderLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(CANCEL_ORDER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the cancel order success flag\n   */\n  getCancelOrderSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(CANCEL_ORDER_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the cancel order process flags\n   */\n  resetCancelOrderProcessState(): void {\n    return this.store.dispatch(new UserActions.ResetCancelOrderProcess());\n  }\n\n  /**\n   * Utility method to distinquish pre / post 1.3.0 in a convenient way.\n   *\n   */\n  private withUserId(callback: (userId: string) => void): void {\n    if (this.authService) {\n      this.authService\n        .getOccUserId()\n        .pipe(take(1))\n        .subscribe(userId => callback(userId));\n    } else {\n      // TODO(issue:#5628) Deprecated since 1.3.0\n      callback(OCC_USER_ID_CURRENT);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  StateWithUser,\n  SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID,\n  UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID,\n  CLAIM_CUSTOMER_COUPON_PROCESS_ID,\n} from '../store/user-state';\nimport {\n  getProcessErrorFactory,\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { CustomerCouponSearchResult } from '../../model/customer-coupon.model';\nimport { OCC_USER_ID_CURRENT } from '../../occ/utils/occ-constants';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CustomerCouponService {\n  constructor(protected store: Store<StateWithUser | StateWithProcess<void>>) {}\n\n  /**\n   * Retrieves customer's coupons\n   * @param pageSize page size\n   * @param currentPage current page\n   * @param sort sort\n   */\n  loadCustomerCoupons(\n    pageSize: number,\n    currentPage?: number,\n    sort?: string\n  ): void {\n    this.store.dispatch(\n      new UserActions.LoadCustomerCoupons({\n        userId: OCC_USER_ID_CURRENT,\n        pageSize: pageSize,\n        currentPage: currentPage,\n        sort: sort,\n      })\n    );\n  }\n\n  /**\n   * Returns customer coupon search result\n   * @param pageSize page size\n   */\n  getCustomerCoupons(pageSize: number): Observable<CustomerCouponSearchResult> {\n    return this.store.pipe(\n      select(UsersSelectors.getCustomerCouponsState),\n      tap(customerCouponsState => {\n        const attemptedLoad =\n          customerCouponsState.loading ||\n          customerCouponsState.success ||\n          customerCouponsState.error;\n        if (!attemptedLoad) {\n          this.loadCustomerCoupons(pageSize);\n        }\n      }),\n      map(customerCouponsState => customerCouponsState.value)\n    );\n  }\n\n  /**\n   * Returns a loaded flag for customer coupons\n   */\n  getCustomerCouponsLoaded(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getCustomerCouponsLoaded));\n  }\n\n  /**\n   * Returns a loading flag for customer coupons\n   */\n  getCustomerCouponsLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getCustomerCouponsLoading));\n  }\n\n  /**\n   * Subscribe a CustomerCoupon Notification\n   * @param couponCode a customer coupon code\n   */\n  subscribeCustomerCoupon(couponCode: string): void {\n    this.store.dispatch(\n      new UserActions.SubscribeCustomerCoupon({\n        userId: OCC_USER_ID_CURRENT,\n        couponCode: couponCode,\n      })\n    );\n  }\n\n  /**\n   * Returns the subscribe customer coupon notification process loading flag\n   */\n  getSubscribeCustomerCouponResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the subscribe customer coupon notification process success flag\n   */\n  getSubscribeCustomerCouponResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the subscribe customer coupon notification process error flag\n   */\n  getSubscribeCustomerCouponResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(SUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Unsubscribe a CustomerCoupon Notification\n   * @param couponCode a customer coupon code\n   */\n  unsubscribeCustomerCoupon(couponCode: string): void {\n    this.store.dispatch(\n      new UserActions.UnsubscribeCustomerCoupon({\n        userId: OCC_USER_ID_CURRENT,\n        couponCode: couponCode,\n      })\n    );\n  }\n\n  /**\n   * Returns the unsubscribe customer coupon notification process loading flag\n   */\n  getUnsubscribeCustomerCouponResultLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the unsubscribe customer coupon notification process success flag\n   */\n  getUnsubscribeCustomerCouponResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the unsubscribe customer coupon notification process error flag\n   */\n  getUnsubscribeCustomerCouponResultError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(UNSUBSCRIBE_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Claim a CustomerCoupon\n   * @param couponCode a customer coupon code\n   */\n  claimCustomerCoupon(couponCode: string): void {\n    this.store.dispatch(\n      new UserActions.ClaimCustomerCoupon({\n        userId: OCC_USER_ID_CURRENT,\n        couponCode: couponCode,\n      })\n    );\n  }\n\n  /**\n   * Returns the claim customer coupon notification process success flag\n   */\n  getClaimCustomerCouponResultSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(CLAIM_CUSTOMER_COUPON_PROCESS_ID))\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport { Country } from '../../model/address.model';\nimport { PaymentDetails } from '../../model/cart.model';\nimport { OCC_USER_ID_CURRENT } from '../../occ/index';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport { StateWithUser } from '../store/user-state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserPaymentService {\n  constructor(\n    store: Store<StateWithUser | StateWithProcess<void>>,\n    // tslint:disable-next-line:unified-signatures\n    authService: AuthService\n  );\n  /**\n   * @deprecated since version 1.3\n   *  Use constructor(store: Store<StateWithUser | StateWithProcess<void>>,\n   *  authService: AuthService) instead\n   *\n   *  TODO(issue:#5628) Deprecated since 1.3.0\n   */\n  constructor(store: Store<StateWithUser | StateWithProcess<void>>);\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected authService?: AuthService\n  ) {}\n\n  /**\n   * Loads all user's payment methods.\n   */\n  loadPaymentMethods(): void {\n    this.withUserId(userId =>\n      this.store.dispatch(new UserActions.LoadUserPaymentMethods(userId))\n    );\n  }\n\n  /**\n   * Returns all user's payment methods\n   */\n  getPaymentMethods(): Observable<PaymentDetails[]> {\n    return this.store.pipe(select(UsersSelectors.getPaymentMethods));\n  }\n\n  /**\n   * Returns a loading flag for payment methods\n   */\n  getPaymentMethodsLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getPaymentMethodsLoading));\n  }\n\n  getPaymentMethodsLoadedSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(UsersSelectors.getPaymentMethodsLoadedSuccess)\n    );\n  }\n  /**\n   * Sets the payment as a default one\n   * @param paymentMethodId a payment method ID\n   */\n  setPaymentMethodAsDefault(paymentMethodId: string): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.SetDefaultUserPaymentMethod({\n          userId,\n          paymentMethodId,\n        })\n      )\n    );\n  }\n\n  /**\n   * Deletes the payment method\n   *\n   * @param paymentMethodId a payment method ID\n   */\n  deletePaymentMethod(paymentMethodId: string): void {\n    this.withUserId(userId =>\n      this.store.dispatch(\n        new UserActions.DeleteUserPaymentMethod({\n          userId,\n          paymentMethodId,\n        })\n      )\n    );\n  }\n\n  /**\n   * Returns all billing countries\n   */\n  getAllBillingCountries(): Observable<Country[]> {\n    return this.store.pipe(select(UsersSelectors.getAllBillingCountries));\n  }\n\n  /**\n   * Retrieves billing countries\n   */\n  loadBillingCountries(): void {\n    this.store.dispatch(new UserActions.LoadBillingCountries());\n  }\n\n  /**\n   * Utility method to distinquish pre / post 1.3.0 in a convenient way.\n   *\n   */\n  private withUserId(callback: (userId: string) => void): void {\n    if (this.authService) {\n      this.authService\n        .getOccUserId()\n        .pipe(take(1))\n        .subscribe(userId => callback(userId));\n    } else {\n      // TODO(issue:#5628) Deprecated since 1.3.0\n      callback(OCC_USER_ID_CURRENT);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map, take, tap } from 'rxjs/operators';\nimport { AuthService } from '../../auth/facade/auth.service';\nimport {\n  ReturnRequestList,\n  ReturnRequestEntryInputList,\n  ReturnRequest,\n  ReturnRequestModification,\n} from '../../model/order.model';\nimport {\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { CANCEL_RETURN_PROCESS_ID } from '../store/user-state';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport { StateWithUser } from '../store/user-state';\nimport { OCC_USER_ID_CURRENT } from '../../occ/index';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OrderReturnRequestService {\n  constructor(\n    protected store: Store<StateWithUser | StateWithProcess<void>>,\n    protected authService: AuthService\n  ) {}\n\n  /**\n   * Create order return request\n   * @param orderCode an order code\n   * @param returnRequestInput order return request entry input\n   */\n  createOrderReturnRequest(\n    returnRequestInput: ReturnRequestEntryInputList\n  ): void {\n    this.withUserId(userId => {\n      this.store.dispatch(\n        new UserActions.CreateOrderReturnRequest({\n          userId,\n          returnRequestInput,\n        })\n      );\n    });\n  }\n\n  /**\n   * Return an order return request\n   */\n  getOrderReturnRequest(): Observable<ReturnRequest> {\n    return this.store.pipe(select(UsersSelectors.getOrderReturnRequest));\n  }\n\n  /**\n   * Gets order return request list\n   */\n  getOrderReturnRequestList(pageSize: number): Observable<ReturnRequestList> {\n    return this.store.pipe(\n      select(UsersSelectors.getOrderReturnRequestListState),\n      tap(returnListState => {\n        const attemptedLoad =\n          returnListState.loading ||\n          returnListState.success ||\n          returnListState.error;\n        if (!attemptedLoad) {\n          this.loadOrderReturnRequestList(pageSize);\n        }\n      }),\n      map(returnListState => returnListState.value)\n    );\n  }\n\n  /**\n   * Loads order return request detail\n   * @param returnRequestCode\n   */\n  loadOrderReturnRequestDetail(returnRequestCode: string): void {\n    this.withUserId(userId => {\n      this.store.dispatch(\n        new UserActions.LoadOrderReturnRequest({\n          userId: userId,\n          returnRequestCode,\n        })\n      );\n    });\n  }\n\n  /**\n   * Loads order return request list\n   * @param pageSize page size\n   * @param currentPage current page\n   * @param sort sort\n   */\n  loadOrderReturnRequestList(\n    pageSize: number,\n    currentPage?: number,\n    sort?: string\n  ): void {\n    this.withUserId(userId => {\n      this.store.dispatch(\n        new UserActions.LoadOrderReturnRequestList({\n          userId: userId,\n          pageSize: pageSize,\n          currentPage: currentPage,\n          sort: sort,\n        })\n      );\n    });\n  }\n\n  /**\n   * Cleaning order return request list\n   */\n  clearOrderReturnRequestList(): void {\n    this.store.dispatch(new UserActions.ClearOrderReturnRequestList());\n  }\n\n  /**\n   * Get the order return request loading flag\n   */\n  getReturnRequestLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getOrderReturnRequestLoading));\n  }\n\n  /**\n   * Get the order return request success flag\n   */\n  getReturnRequestSuccess(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getOrderReturnRequestSuccess));\n  }\n\n  /**\n   * Cleaning order return request details\n   */\n  clearOrderReturnRequestDetail(): void {\n    this.store.dispatch(new UserActions.ClearOrderReturnRequest());\n  }\n\n  /*\n   * Cancel order return request\n   */\n  cancelOrderReturnRequest(\n    returnRequestCode: string,\n    returnRequestModification: ReturnRequestModification\n  ): void {\n    this.withUserId(userId => {\n      this.store.dispatch(\n        new UserActions.CancelOrderReturnRequest({\n          userId,\n          returnRequestCode,\n          returnRequestModification,\n        })\n      );\n    });\n  }\n\n  /**\n   * Returns the cancel return request loading flag\n   */\n  getCancelReturnRequestLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(CANCEL_RETURN_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns the cancel return request success flag\n   */\n  getCancelReturnRequestSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(CANCEL_RETURN_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Resets the cancel return request process flags\n   */\n  resetCancelReturnRequestProcessState(): void {\n    return this.store.dispatch(new UserActions.ResetCancelReturnProcess());\n  }\n\n  /*\n   * Utility method to distinquish pre / post 1.3.0 in a convenient way.\n   *\n   */\n  private withUserId(callback: (userId: string) => void): void {\n    if (this.authService) {\n      this.authService\n        .getOccUserId()\n        .pipe(take(1))\n        .subscribe(userId => callback(userId));\n    } else {\n      // TODO(issue:#5628) Deprecated since 1.3.0\n      callback(OCC_USER_ID_CURRENT);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { OCC_USER_ID_CURRENT } from '../../occ/utils/occ-constants';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { getProcessLoadingFactory } from '../../process/store/selectors/process.selectors';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  StateWithUser,\n  UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID,\n} from '../store/user-state';\nimport { NotificationPreference } from '../../model/notification-preference.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserNotificationPreferenceService {\n  constructor(protected store: Store<StateWithUser | StateWithProcess<void>>) {}\n\n  /**\n   * Returns all notification preferences.\n   */\n  getPreferences(): Observable<NotificationPreference[]> {\n    return this.store.pipe(select(UsersSelectors.getPreferences));\n  }\n\n  /**\n   * Returns all enabled notification preferences.\n   */\n  getEnabledPreferences(): Observable<NotificationPreference[]> {\n    return this.store.pipe(select(UsersSelectors.getEnabledPreferences));\n  }\n\n  /**\n   * Loads all notification preferences.\n   */\n  loadPreferences(): void {\n    this.store.dispatch(\n      new UserActions.LoadNotificationPreferences(OCC_USER_ID_CURRENT)\n    );\n  }\n\n  /**\n   * Clear all notification preferences.\n   */\n  clearPreferences(): void {\n    this.store.dispatch(new UserActions.ClearNotificationPreferences());\n  }\n\n  /**\n   * Returns a loading flag for notification preferences.\n   */\n  getPreferencesLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getPreferencesLoading));\n  }\n\n  /**\n   * Updating notification preferences.\n   * @param preferences a preference list\n   */\n  updatePreferences(preferences: NotificationPreference[]): void {\n    this.store.dispatch(\n      new UserActions.UpdateNotificationPreferences({\n        userId: OCC_USER_ID_CURRENT,\n        preferences: preferences,\n      })\n    );\n  }\n\n  /**\n   * Returns a loading flag for updating preferences.\n   */\n  getUpdatePreferencesResultLoading(): Observable<boolean> {\n    return this.store.select(\n      getProcessLoadingFactory(UPDATE_NOTIFICATION_PREFERENCES_PROCESS_ID)\n    );\n  }\n\n  /**\n   * Resets the update notification preferences process state. The state needs to be\n   * reset after the process concludes, regardless if it's a success or an error.\n   */\n  resetNotificationPreferences(): void {\n    this.store.dispatch(new UserActions.ResetNotificationPreferences());\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { StateWithProcess } from '../../process/store/process-state';\nimport { UserActions } from '../store/actions/index';\nimport { UsersSelectors } from '../store/selectors/index';\nimport {\n  StateWithUser,\n  REMOVE_PRODUCT_INTERESTS_PROCESS_ID,\n  ADD_PRODUCT_INTEREST_PROCESS_ID,\n} from '../store/user-state';\nimport {\n  ProductInterestSearchResult,\n  ProductInterestEntryRelation,\n  NotificationType,\n} from '../../model/product-interest.model';\nimport { tap, map } from 'rxjs/operators';\nimport {\n  getProcessLoadingFactory,\n  getProcessSuccessFactory,\n  getProcessErrorFactory,\n} from '../../process/store/selectors/process.selectors';\nimport { OCC_USER_ID_CURRENT } from '../../occ/utils/occ-constants';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserInterestsService {\n  constructor(protected store: Store<StateWithUser | StateWithProcess<void>>) {}\n\n  /**\n   * Retrieves an product interest list\n   * @param pageSize page size\n   * @param currentPage current page\n   * @param sort sort\n   */\n  loadProductInterests(\n    pageSize?: number,\n    currentPage?: number,\n    sort?: string,\n    productCode?: string,\n    notificationType?: NotificationType\n  ): void {\n    this.store.dispatch(\n      new UserActions.LoadProductInterests({\n        userId: OCC_USER_ID_CURRENT,\n        pageSize: pageSize,\n        currentPage: currentPage,\n        sort: sort,\n        productCode: productCode,\n        notificationType: notificationType,\n      })\n    );\n  }\n\n  /**\n   * Returns product interests\n   */\n  getProductInterests(): Observable<ProductInterestSearchResult> {\n    return this.store.pipe(select(UsersSelectors.getInterests));\n  }\n\n  /**\n   * Returns product interests\n   * @param pageSize the page size\n   */\n  getAndLoadProductInterests(\n    pageSize?: number\n  ): Observable<ProductInterestSearchResult> {\n    return this.store.pipe(\n      select(UsersSelectors.getInterestsState),\n      tap(interestListState => {\n        const attemptedLoad =\n          interestListState.loading ||\n          interestListState.success ||\n          interestListState.error;\n        if (!attemptedLoad) {\n          this.loadProductInterests(pageSize);\n        }\n      }),\n      map(interestListState => interestListState.value)\n    );\n  }\n\n  /**\n   * Returns a loading flag for product interests\n   */\n  getProdutInterestsLoading(): Observable<boolean> {\n    return this.store.pipe(select(UsersSelectors.getInterestsLoading));\n  }\n\n  /**\n   * Removes a ProductInterestRelation\n   * @param item product interest relation item\n   * @param singleDelete flag to delete only one interest\n   */\n  removeProdutInterest(\n    item: ProductInterestEntryRelation,\n    singleDelete?: boolean\n  ): void {\n    this.store.dispatch(\n      new UserActions.RemoveProductInterest({\n        userId: OCC_USER_ID_CURRENT,\n        item: item,\n        singleDelete: singleDelete,\n      })\n    );\n  }\n\n  /**\n   * Returns a loading flag for removing product interests.\n   */\n  getRemoveProdutInterestLoading(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessLoadingFactory(REMOVE_PRODUCT_INTERESTS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns a success flag for removing a product interests.\n   */\n  getRemoveProdutInterestSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(REMOVE_PRODUCT_INTERESTS_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Add a new product interest.\n   *\n   * @param productCode the product code\n   * @param notificationType the notification type\n   */\n  addProductInterest(\n    productCode: string,\n    notificationType: NotificationType\n  ): void {\n    this.store.dispatch(\n      new UserActions.AddProductInterest({\n        userId: OCC_USER_ID_CURRENT,\n        productCode: productCode,\n        notificationType: notificationType,\n      })\n    );\n  }\n\n  /**\n   * Returns a success flag for adding a product interest.\n   */\n  getAddProductInterestSuccess(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessSuccessFactory(ADD_PRODUCT_INTEREST_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Returns a error flag for adding a product interest.\n   */\n  getAddProductInterestError(): Observable<boolean> {\n    return this.store.pipe(\n      select(getProcessErrorFactory(ADD_PRODUCT_INTEREST_PROCESS_ID))\n    );\n  }\n\n  /**\n   * Reset product interest adding state.\n   */\n  resetAddInterestState(): void {\n    this.store.dispatch(new UserActions.ResetAddInterestState());\n  }\n\n  /**\n   * Reset product interest removing state.\n   */\n  resetRemoveInterestState(): void {\n    this.store.dispatch(new UserActions.ResetRemoveInterestState());\n  }\n\n  /**\n   * Clears product interests\n   */\n  clearProductInterests(): void {\n    this.store.dispatch(new UserActions.ClearProductInterests());\n  }\n}\n","import { UserActions } from '../actions/index';\nimport { BillingCountriesState } from '../user-state';\n\nexport const initialState: BillingCountriesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.BillingCountriesAction | UserActions.ClearUserMiscsData\n): BillingCountriesState {\n  switch (action.type) {\n    case UserActions.LOAD_BILLING_COUNTRIES_SUCCESS: {\n      const billingCountries = action.payload;\n      const entities = billingCountries.reduce(\n        (countryEntities: { [isocode: string]: any }, name: any) => {\n          return {\n            ...countryEntities,\n            [name.isocode]: name,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case UserActions.CLEAR_USER_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { ConsignmentTracking } from '../../../model/index';\nimport { UserActions } from '../actions/index';\nimport { ConsignmentTrackingState } from '../user-state';\n\nexport const initialState: ConsignmentTrackingState = {};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.ConsignmentTrackingAction\n): ConsignmentTrackingState {\n  switch (action.type) {\n    case UserActions.LOAD_CONSIGNMENT_TRACKING_SUCCESS: {\n      const tracking: ConsignmentTracking = action.payload;\n      return {\n        tracking,\n      };\n    }\n    case UserActions.CLEAR_CONSIGNMENT_TRACKING: {\n      return initialState;\n    }\n  }\n  return state;\n}\n","import { Country } from '../../../model/address.model';\nimport { UserActions } from '../actions/index';\nimport { DeliveryCountriesState } from '../user-state';\n\nexport const initialState: DeliveryCountriesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.DeliveryCountriesAction | UserActions.ClearUserMiscsData\n): DeliveryCountriesState {\n  switch (action.type) {\n    case UserActions.LOAD_DELIVERY_COUNTRIES_SUCCESS: {\n      const deliveryCountries = action.payload;\n      const entities = deliveryCountries.reduce(\n        (countryEntities: { [isocode: string]: Country }, country: Country) => {\n          return {\n            ...countryEntities,\n            [country.isocode]: country,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case UserActions.CLEAR_USER_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { NotificationPreference } from '../../../model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: NotificationPreference[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.NotificationPreferenceAction\n): NotificationPreference[] {\n  switch (action.type) {\n    case UserActions.LOAD_NOTIFICATION_PREFERENCES_FAIL: {\n      return initialState;\n    }\n\n    case UserActions.LOAD_NOTIFICATION_PREFERENCES_SUCCESS:\n    case UserActions.UPDATE_NOTIFICATION_PREFERENCES_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n  }\n\n  return state;\n}\n","import { Order } from '../../../model/order.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: Order = {};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.OrderDetailsAction\n): Order {\n  switch (action.type) {\n    case UserActions.LOAD_ORDER_DETAILS_SUCCESS: {\n      const order: Order = action.payload;\n      return order;\n    }\n  }\n  return state;\n}\n","import { PaymentDetails } from '../../../model/cart.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: PaymentDetails[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserPaymentMethodsAction\n): PaymentDetails[] {\n  switch (action.type) {\n    case UserActions.LOAD_USER_PAYMENT_METHODS_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n\n    case UserActions.LOAD_USER_PAYMENT_METHODS_FAIL: {\n      return initialState;\n    }\n  }\n  return state;\n}\n","import { Region } from '../../../model/address.model';\nimport { UserActions } from '../actions/index';\nimport { RegionsState } from '../user-state';\n\nexport const initialState: RegionsState = {\n  entities: [],\n  country: null,\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.RegionsAction | UserActions.ClearUserMiscsData\n): RegionsState {\n  switch (action.type) {\n    case UserActions.LOAD_REGIONS_SUCCESS: {\n      const entities: Region[] = action.payload.entities;\n      const country: string = action.payload.country;\n      if (entities || country) {\n        return {\n          ...state,\n          entities,\n          country,\n        };\n      }\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { UserActions } from '../actions/index';\n\nexport const initialState = false;\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.ResetPasswordAction\n): boolean {\n  switch (action.type) {\n    case UserActions.RESET_PASSWORD_SUCCESS: {\n      return true;\n    }\n  }\n  return state;\n}\n","import { Title } from '../../../model/misc.model';\nimport { UserActions } from '../actions/index';\nimport { TitlesState } from '../user-state';\n\nexport const initialState: TitlesState = {\n  entities: {},\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.TitlesAction | UserActions.ClearUserMiscsData\n): TitlesState {\n  switch (action.type) {\n    case UserActions.LOAD_TITLES_SUCCESS: {\n      const titles = action.payload;\n      const entities = titles.reduce(\n        (titleEntities: { [code: string]: Title }, name: Title) => {\n          return {\n            ...titleEntities,\n            [name.code]: name,\n          };\n        },\n        {\n          ...state.entities,\n        }\n      );\n\n      return {\n        ...state,\n        entities,\n      };\n    }\n\n    case UserActions.CLEAR_USER_MISCS_DATA: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import { Address } from '../../../model/address.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: Address[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserAddressesAction\n): Address[] {\n  switch (action.type) {\n    case UserActions.LOAD_USER_ADDRESSES_FAIL: {\n      return initialState;\n    }\n\n    case UserActions.LOAD_USER_ADDRESSES_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n  }\n  return state;\n}\n","import { ConsentTemplate } from '../../../model/consent.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: ConsentTemplate[] = [];\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserConsentsAction\n): ConsentTemplate[] {\n  switch (action.type) {\n    case UserActions.LOAD_USER_CONSENTS_SUCCESS: {\n      const consents = action.payload;\n      return consents ? consents : initialState;\n    }\n\n    case UserActions.GIVE_USER_CONSENT_SUCCESS: {\n      const updatedConsentTemplate = action.consentTemplate;\n      return state.map(consentTemplate =>\n        consentTemplate.id === updatedConsentTemplate.id\n          ? updatedConsentTemplate\n          : consentTemplate\n      );\n    }\n  }\n\n  return state;\n}\n","import { User } from '../../../model/misc.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: User = <User>{};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserDetailsAction | UserActions.EmailActions\n): User {\n  switch (action.type) {\n    case UserActions.LOAD_USER_DETAILS_SUCCESS: {\n      return action.payload;\n    }\n\n    case UserActions.UPDATE_USER_DETAILS_SUCCESS: {\n      const updatedDetails: User = {\n        ...state,\n        ...action.userUpdates,\n      };\n      return {\n        ...updatedDetails,\n        name: `${updatedDetails.firstName} ${updatedDetails.lastName}`,\n      };\n    }\n  }\n\n  return state;\n}\n","import { OrderHistoryList } from '../../../model/order.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: OrderHistoryList = {\n  orders: [],\n  pagination: {},\n  sorts: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.UserOrdersAction\n): OrderHistoryList {\n  switch (action.type) {\n    case UserActions.LOAD_USER_ORDERS_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n    case UserActions.LOAD_USER_ORDERS_FAIL: {\n      return initialState;\n    }\n  }\n\n  return state;\n}\n","import * as fromActions from '../actions/customer-coupon.action';\nimport {\n  CustomerCoupon,\n  CustomerCouponSearchResult,\n} from '../../../model/customer-coupon.model';\n\nexport const initialState: CustomerCouponSearchResult = {\n  coupons: [],\n  sorts: [],\n  pagination: {},\n};\nexport function reducer(\n  state = initialState,\n  action: fromActions.CustomerCouponAction\n): CustomerCouponSearchResult {\n  switch (action.type) {\n    case fromActions.LOAD_CUSTOMER_COUPONS_SUCCESS: {\n      return action.payload;\n    }\n\n    case fromActions.SUBSCRIBE_CUSTOMER_COUPON_SUCCESS: {\n      const updatedCustomerCoupon = action.payload.coupon;\n      const customerCoupons = new Array<CustomerCoupon>(state.coupons.length);\n      state.coupons.forEach((customerCoupon: CustomerCoupon, index) =>\n        customerCoupon.couponId === updatedCustomerCoupon.couponId\n          ? (customerCoupons[index] = updatedCustomerCoupon)\n          : (customerCoupons[index] = customerCoupon)\n      );\n      return { ...state, coupons: customerCoupons };\n    }\n\n    case fromActions.UNSUBSCRIBE_CUSTOMER_COUPON_SUCCESS: {\n      const updatedCouponCode = action.payload;\n      const customerCoupons = new Array<CustomerCoupon>(state.coupons.length);\n      state.coupons.forEach((customerCoupon: CustomerCoupon, index) =>\n        customerCoupon.couponId === updatedCouponCode\n          ? (customerCoupons[index] = {\n              ...customerCoupon,\n              notificationOn: false,\n            })\n          : (customerCoupons[index] = customerCoupon)\n      );\n      return { ...state, coupons: customerCoupons };\n    }\n  }\n  return state;\n}\n","import { UserActions } from '../actions/index';\nimport { ProductInterestSearchResult } from '../../../model/product-interest.model';\n\nexport const initialState: ProductInterestSearchResult = {\n  results: [],\n  pagination: {},\n  sorts: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.ProductInterestsAction\n): ProductInterestSearchResult {\n  switch (action.type) {\n    case UserActions.LOAD_PRODUCT_INTERESTS_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n    case UserActions.LOAD_PRODUCT_INTERESTS_FAIL: {\n      return initialState;\n    }\n  }\n  return state;\n}\n","import { ReturnRequestList } from '../../../model/order.model';\nimport { UserActions } from '../actions/index';\n\nexport const initialState: ReturnRequestList = {\n  returnRequests: [],\n  pagination: {},\n  sorts: [],\n};\n\nexport function reducer(\n  state = initialState,\n  action: UserActions.OrderReturnRequestAction\n): ReturnRequestList {\n  switch (action.type) {\n    case UserActions.LOAD_ORDER_RETURN_REQUEST_LIST_SUCCESS: {\n      return action.payload ? action.payload : initialState;\n    }\n  }\n\n  return state;\n}\n","import { InjectionToken, Provider } from '@angular/core';\nimport {\n  ActionReducer,\n  ActionReducerMap,\n  combineReducers,\n  MetaReducer,\n} from '@ngrx/store';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { Address } from '../../../model/address.model';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { ConsentTemplate } from '../../../model/consent.model';\nimport { NotificationPreference } from '../../../model/notification-preference.model';\nimport { CustomerCouponSearchResult } from '../../../model/customer-coupon.model';\nimport { ProductInterestSearchResult } from '../../../model/product-interest.model';\nimport {\n  OrderHistoryList,\n  ReturnRequestList,\n  ReturnRequest,\n  Order,\n} from '../../../model/order.model';\nimport { loaderReducer } from '../../../state/utils/loader/loader.reducer';\nimport {\n  REGIONS,\n  RegionsState,\n  UserState,\n  USER_ADDRESSES,\n  USER_CONSENTS,\n  USER_ORDERS,\n  USER_PAYMENT_METHODS,\n  CUSTOMER_COUPONS,\n  NOTIFICATION_PREFERENCES,\n  PRODUCT_INTERESTS,\n  USER_RETURN_REQUESTS,\n  USER_ORDER_DETAILS,\n  USER_RETURN_REQUEST_DETAILS,\n} from '../user-state';\nimport * as fromBillingCountriesReducer from './billing-countries.reducer';\nimport * as fromConsignmentTrackingReducer from './consignment-tracking.reducer';\nimport * as fromDeliveryCountries from './delivery-countries.reducer';\nimport * as fromNotificationPreferenceReducer from './notification-preference.reducer';\nimport * as fromOrderDetailsReducer from './order-details.reducer';\nimport * as fromPaymentReducer from './payment-methods.reducer';\nimport * as fromRegionsReducer from './regions.reducer';\nimport * as fromResetPasswordReducer from './reset-password.reducer';\nimport * as fromTitlesReducer from './titles.reducer';\nimport * as fromAddressesReducer from './user-addresses.reducer';\nimport * as fromUserConsentsReducer from './user-consents.reducer';\nimport * as fromUserDetailsReducer from './user-details.reducer';\nimport * as fromUserOrdersReducer from './user-orders.reducer';\nimport * as fromCustomerCouponReducer from './customer-coupon.reducer';\nimport * as fromInterestsReducer from './product-interests.reducer';\nimport * as fromOrderReturnRequestReducer from './order-return-request.reducer';\n\nexport function getReducers(): ActionReducerMap<UserState> {\n  return {\n    account: combineReducers({\n      details: fromUserDetailsReducer.reducer,\n    }),\n    addresses: loaderReducer<Address[]>(\n      USER_ADDRESSES,\n      fromAddressesReducer.reducer\n    ),\n    billingCountries: fromBillingCountriesReducer.reducer,\n    consents: loaderReducer<ConsentTemplate[]>(\n      USER_CONSENTS,\n      fromUserConsentsReducer.reducer\n    ),\n    payments: loaderReducer<PaymentDetails[]>(\n      USER_PAYMENT_METHODS,\n      fromPaymentReducer.reducer\n    ),\n    orders: loaderReducer<OrderHistoryList>(\n      USER_ORDERS,\n      fromUserOrdersReducer.reducer\n    ),\n    order: loaderReducer<Order>(\n      USER_ORDER_DETAILS,\n      fromOrderDetailsReducer.reducer\n    ),\n    orderReturn: loaderReducer<ReturnRequest>(USER_RETURN_REQUEST_DETAILS),\n    orderReturnList: loaderReducer<ReturnRequestList>(\n      USER_RETURN_REQUESTS,\n      fromOrderReturnRequestReducer.reducer\n    ),\n    countries: fromDeliveryCountries.reducer,\n    titles: fromTitlesReducer.reducer,\n    regions: loaderReducer<RegionsState>(REGIONS, fromRegionsReducer.reducer),\n    resetPassword: fromResetPasswordReducer.reducer,\n    consignmentTracking: fromConsignmentTrackingReducer.reducer,\n    customerCoupons: loaderReducer<CustomerCouponSearchResult>(\n      CUSTOMER_COUPONS,\n      fromCustomerCouponReducer.reducer\n    ),\n    notificationPreferences: loaderReducer<NotificationPreference[]>(\n      NOTIFICATION_PREFERENCES,\n      fromNotificationPreferenceReducer.reducer\n    ),\n    productInterests: loaderReducer<ProductInterestSearchResult>(\n      PRODUCT_INTERESTS,\n      fromInterestsReducer.reducer\n    ),\n  };\n}\n\nexport const reducerToken: InjectionToken<ActionReducerMap<\n  UserState\n>> = new InjectionToken<ActionReducerMap<UserState>>('UserReducers');\n\nexport const reducerProvider: Provider = {\n  provide: reducerToken,\n  useFactory: getReducers,\n};\n\nexport function clearUserState(\n  reducer: ActionReducer<any>\n): ActionReducer<any> {\n  return function(state, action) {\n    if (action.type === AuthActions.LOGOUT) {\n      state = undefined;\n    }\n\n    return reducer(state, action);\n  };\n}\n\nexport const metaReducers: MetaReducer<any>[] = [clearUserState];\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { CountryType } from '../../../model/address.model';\nimport { SiteConnector } from '../../../site-context/connectors/site.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class BillingCountriesEffect {\n  @Effect()\n  loadBillingCountries$: Observable<\n    UserActions.BillingCountriesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_BILLING_COUNTRIES),\n    switchMap(() => {\n      return this.siteConnector.getCountries(CountryType.BILLING).pipe(\n        map(\n          countries => new UserActions.LoadBillingCountriesSuccess(countries)\n        ),\n        catchError(error =>\n          of(\n            new UserActions.LoadBillingCountriesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class ClearMiscsDataEffect {\n  @Effect()\n  clearMiscsData$: Observable<Action> = this.actions$.pipe(\n    ofType(\n      SiteContextActions.LANGUAGE_CHANGE,\n      SiteContextActions.CURRENCY_CHANGE\n    ),\n    map(() => {\n      return new UserActions.ClearUserMiscsData();\n    })\n  );\n\n  constructor(private actions$: Actions) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { ConsignmentTracking } from '../../../model/consignment-tracking.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserOrderConnector } from '../../connectors/order/user-order.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class ConsignmentTrackingEffects {\n  @Effect()\n  loadConsignmentTracking$: Observable<\n    UserActions.ConsignmentTrackingAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_CONSIGNMENT_TRACKING),\n    map((action: UserActions.LoadConsignmentTracking) => action.payload),\n    switchMap(payload => {\n      return this.userOrderConnector\n        .getConsignmentTracking(\n          payload.orderCode,\n          payload.consignmentCode,\n          payload.userId\n        )\n        .pipe(\n          map(\n            (tracking: ConsignmentTracking) =>\n              new UserActions.LoadConsignmentTrackingSuccess(tracking)\n          ),\n          catchError(error =>\n            of(\n              new UserActions.LoadConsignmentTrackingFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userOrderConnector: UserOrderConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { CountryType } from '../../../model/address.model';\nimport { SiteConnector } from '../../../site-context/connectors/site.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class DeliveryCountriesEffects {\n  @Effect()\n  loadDeliveryCountries$: Observable<\n    UserActions.DeliveryCountriesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_DELIVERY_COUNTRIES),\n    switchMap(() => {\n      return this.siteConnector.getCountries(CountryType.SHIPPING).pipe(\n        map(\n          countries => new UserActions.LoadDeliveryCountriesSuccess(countries)\n        ),\n        catchError(error =>\n          of(\n            new UserActions.LoadDeliveryCountriesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map, switchMap } from 'rxjs/operators';\nimport { GlobalMessageType } from '../../../global-message/models/global-message.model';\nimport { GlobalMessageActions } from '../../../global-message/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class ForgotPasswordEffects {\n  @Effect()\n  requestForgotPasswordEmail$: Observable<\n    | UserActions.ForgotPasswordEmailRequestSuccess\n    | GlobalMessageActions.AddMessage\n    | UserActions.ForgotPasswordEmailRequestFail\n  > = this.actions$.pipe(\n    ofType(UserActions.FORGOT_PASSWORD_EMAIL_REQUEST),\n    map((action: UserActions.ForgotPasswordEmailRequest) => {\n      return action.payload;\n    }),\n    concatMap(userEmailAddress => {\n      return this.userAccountConnector\n        .requestForgotPasswordEmail(userEmailAddress)\n        .pipe(\n          switchMap(() => [\n            new UserActions.ForgotPasswordEmailRequestSuccess(),\n            new GlobalMessageActions.AddMessage({\n              text: { key: 'forgottenPassword.passwordResetEmailSent' },\n              type: GlobalMessageType.MSG_TYPE_CONFIRMATION,\n            }),\n          ]),\n          catchError(error =>\n            of(\n              new UserActions.ForgotPasswordEmailRequestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserNotificationPreferenceConnector } from '../../connectors/notification-preference/user-notification-preference.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class NotificationPreferenceEffects {\n  @Effect()\n  loadPreferences$: Observable<\n    UserActions.NotificationPreferenceAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_NOTIFICATION_PREFERENCES),\n    map((action: UserActions.LoadNotificationPreferences) => action.payload),\n    switchMap(payload =>\n      this.connector.loadAll(payload).pipe(\n        map(\n          preferences =>\n            new UserActions.LoadNotificationPreferencesSuccess(preferences)\n        ),\n        catchError(error =>\n          of(\n            new UserActions.LoadNotificationPreferencesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n\n  @Effect()\n  updatePreferences$: Observable<\n    UserActions.NotificationPreferenceAction\n  > = this.actions$.pipe(\n    ofType(UserActions.UPDATE_NOTIFICATION_PREFERENCES),\n    map((action: UserActions.UpdateNotificationPreferences) => action.payload),\n    mergeMap(payload =>\n      this.connector.update(payload.userId, payload.preferences).pipe(\n        map(\n          () =>\n            new UserActions.UpdateNotificationPreferencesSuccess(\n              payload.preferences\n            )\n        ),\n        catchError(error =>\n          of(\n            new UserActions.UpdateNotificationPreferencesFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private connector: UserNotificationPreferenceConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { Order } from '../../../model/order.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserOrderConnector } from '../../connectors/order/user-order.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class OrderDetailsEffect {\n  @Effect()\n  loadOrderDetails$: Observable<\n    UserActions.OrderDetailsAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_ORDER_DETAILS),\n    map((action: UserActions.LoadOrderDetails) => action.payload),\n    switchMap(payload => {\n      return this.orderConnector.get(payload.userId, payload.orderCode).pipe(\n        map((order: Order) => {\n          return new UserActions.LoadOrderDetailsSuccess(order);\n        }),\n        catchError(error =>\n          of(new UserActions.LoadOrderDetailsFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  @Effect()\n  cancelOrder$: Observable<UserActions.OrderDetailsAction> = this.actions$.pipe(\n    ofType(UserActions.CANCEL_ORDER),\n    map((action: UserActions.CancelOrder) => action.payload),\n    switchMap(payload => {\n      return this.orderConnector\n        .cancel(payload.userId, payload.orderCode, payload.cancelRequestInput)\n        .pipe(\n          map(_ => new UserActions.CancelOrderSuccess()),\n          catchError(error =>\n            of(new UserActions.CancelOrderFail(makeErrorSerializable(error)))\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private orderConnector: UserOrderConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { ReturnRequest, ReturnRequestList } from '../../../model/order.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserOrderConnector } from '../../connectors/order/user-order.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class OrderReturnRequestEffect {\n  @Effect()\n  createReturnRequest$: Observable<\n    UserActions.OrderReturnRequestAction\n  > = this.actions$.pipe(\n    ofType(UserActions.CREATE_ORDER_RETURN_REQUEST),\n    map((action: UserActions.CreateOrderReturnRequest) => action.payload),\n    switchMap(payload => {\n      return this.orderConnector\n        .return(payload.userId, payload.returnRequestInput)\n        .pipe(\n          map(\n            (returnRequest: ReturnRequest) =>\n              new UserActions.CreateOrderReturnRequestSuccess(returnRequest)\n          ),\n          catchError(error =>\n            of(\n              new UserActions.CreateOrderReturnRequestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  loadReturnRequest$: Observable<\n    UserActions.OrderReturnRequestAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_ORDER_RETURN_REQUEST),\n    map((action: UserActions.LoadOrderReturnRequest) => action.payload),\n    switchMap(payload => {\n      return this.orderConnector\n        .getReturnRequestDetail(payload.userId, payload.returnRequestCode)\n        .pipe(\n          map(\n            (returnRequest: ReturnRequest) =>\n              new UserActions.LoadOrderReturnRequestSuccess(returnRequest)\n          ),\n          catchError(error =>\n            of(\n              new UserActions.LoadOrderReturnRequestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  cancelReturnRequest$: Observable<\n    UserActions.OrderReturnRequestAction\n  > = this.actions$.pipe(\n    ofType(UserActions.CANCEL_ORDER_RETURN_REQUEST),\n    map((action: UserActions.CancelOrderReturnRequest) => action.payload),\n    switchMap(payload => {\n      return this.orderConnector\n        .cancelReturnRequest(\n          payload.userId,\n          payload.returnRequestCode,\n          payload.returnRequestModification\n        )\n        .pipe(\n          map(_ => new UserActions.CancelOrderReturnRequestSuccess()),\n          catchError(error =>\n            of(\n              new UserActions.CancelOrderReturnRequestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  loadReturnRequestList$: Observable<\n    UserActions.OrderReturnRequestAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_ORDER_RETURN_REQUEST_LIST),\n    map((action: UserActions.LoadOrderReturnRequestList) => action.payload),\n    switchMap(payload => {\n      return this.orderConnector\n        .getReturnRequestList(\n          payload.userId,\n          payload.pageSize,\n          payload.currentPage,\n          payload.sort\n        )\n        .pipe(\n          map(\n            (returnRequestList: ReturnRequestList) =>\n              new UserActions.LoadOrderReturnRequestListSuccess(\n                returnRequestList\n              )\n          ),\n          catchError(error =>\n            of(\n              new UserActions.LoadOrderReturnRequestListFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private orderConnector: UserOrderConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { PaymentDetails } from '../../../model/cart.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserPaymentConnector } from '../../connectors/payment/user-payment.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserPaymentMethodsEffects {\n  @Effect()\n  loadUserPaymentMethods$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_PAYMENT_METHODS),\n    map((action: UserActions.LoadUserPaymentMethods) => action.payload),\n    mergeMap(payload => {\n      return this.userPaymentMethodConnector.getAll(payload).pipe(\n        map((payments: PaymentDetails[]) => {\n          return new UserActions.LoadUserPaymentMethodsSuccess(payments);\n        }),\n        catchError(error =>\n          of(\n            new UserActions.LoadUserPaymentMethodsFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  setDefaultUserPaymentMethod$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.SET_DEFAULT_USER_PAYMENT_METHOD),\n    map((action: UserActions.SetDefaultUserPaymentMethod) => action.payload),\n    mergeMap(payload => {\n      return this.userPaymentMethodConnector\n        .setDefault(payload.userId, payload.paymentMethodId)\n        .pipe(\n          switchMap(data => [\n            new UserActions.SetDefaultUserPaymentMethodSuccess(data),\n            new UserActions.LoadUserPaymentMethods(payload.userId),\n          ]),\n          catchError(error =>\n            of(\n              new UserActions.SetDefaultUserPaymentMethodFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n  @Effect()\n  deleteUserPaymentMethod$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.DELETE_USER_PAYMENT_METHOD),\n    map((action: UserActions.DeleteUserPaymentMethod) => action.payload),\n    mergeMap(payload => {\n      return this.userPaymentMethodConnector\n        .delete(payload.userId, payload.paymentMethodId)\n        .pipe(\n          switchMap(data => [\n            new UserActions.DeleteUserPaymentMethodSuccess(data),\n            new UserActions.LoadUserPaymentMethods(payload.userId),\n          ]),\n          catchError(error =>\n            of(\n              new UserActions.DeleteUserPaymentMethodFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userPaymentMethodConnector: UserPaymentConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { SiteConnector } from '../../../site-context/connectors/site.connector';\nimport { StateLoaderActions } from '../../../state/utils/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserActions } from '../actions/index';\nimport { REGIONS } from '../user-state';\n\n@Injectable()\nexport class RegionsEffects {\n  @Effect()\n  loadRegions$: Observable<UserActions.RegionsAction> = this.actions$.pipe(\n    ofType(UserActions.LOAD_REGIONS),\n    map((action: UserActions.LoadRegions) => {\n      return action.payload;\n    }),\n    switchMap((countryCode: string) => {\n      return this.siteConnector.getRegions(countryCode).pipe(\n        map(\n          regions =>\n            new UserActions.LoadRegionsSuccess({\n              entities: regions,\n              country: countryCode,\n            })\n        ),\n        catchError(error =>\n          of(new UserActions.LoadRegionsFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  @Effect()\n  resetRegions$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.CLEAR_USER_MISCS_DATA, UserActions.CLEAR_REGIONS),\n    map(() => {\n      return new StateLoaderActions.LoaderResetAction(REGIONS);\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private siteConnector: SiteConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { GlobalMessageType } from '../../../global-message/models/global-message.model';\nimport { GlobalMessageActions } from '../../../global-message/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class ResetPasswordEffects {\n  @Effect()\n  resetPassword$: Observable<\n    | UserActions.ResetPasswordSuccess\n    | GlobalMessageActions.AddMessage\n    | UserActions.ResetPasswordFail\n  > = this.actions$.pipe(\n    ofType(UserActions.RESET_PASSWORD),\n    map((action: UserActions.ResetPassword) => action.payload),\n    switchMap(({ token, password }) => {\n      return this.userAccountConnector.resetPassword(token, password).pipe(\n        switchMap(() => [\n          new UserActions.ResetPasswordSuccess(),\n          new GlobalMessageActions.AddMessage({\n            text: { key: 'forgottenPassword.passwordResetSuccess' },\n            type: GlobalMessageType.MSG_TYPE_CONFIRMATION,\n          }),\n        ]),\n        catchError(error =>\n          of(new UserActions.ResetPasswordFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class TitlesEffects {\n  @Effect()\n  loadTitles$: Observable<UserActions.TitlesAction> = this.actions$.pipe(\n    ofType(UserActions.LOAD_TITLES),\n    switchMap(() => {\n      return this.userAccountConnector.getTitles().pipe(\n        map(titles => {\n          return new UserActions.LoadTitlesSuccess(titles);\n        }),\n        catchError(error =>\n          of(new UserActions.LoadTitlesFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UpdateEmailEffects {\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n\n  @Effect()\n  updateEmail$: Observable<\n    UserActions.UpdateEmailSuccessAction | UserActions.UpdateEmailErrorAction\n  > = this.actions$.pipe(\n    ofType(UserActions.UPDATE_EMAIL),\n    map((action: UserActions.UpdateEmailAction) => action.payload),\n    concatMap(payload =>\n      this.userAccountConnector\n        .updateEmail(payload.uid, payload.password, payload.newUid)\n        .pipe(\n          map(() => new UserActions.UpdateEmailSuccessAction(payload.newUid)),\n          catchError(error =>\n            of(\n              new UserActions.UpdateEmailErrorAction(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    )\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map } from 'rxjs/operators';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UpdatePasswordEffects {\n  constructor(\n    private actions$: Actions,\n    private userAccountConnector: UserConnector\n  ) {}\n\n  @Effect()\n  updatePassword$: Observable<\n    UserActions.UpdatePasswordSuccess | UserActions.UpdatePasswordFail\n  > = this.actions$.pipe(\n    ofType(UserActions.UPDATE_PASSWORD),\n    map((action: UserActions.UpdatePassword) => action.payload),\n    concatMap(payload =>\n      this.userAccountConnector\n        .updatePassword(\n          payload.userId,\n          payload.oldPassword,\n          payload.newPassword\n        )\n        .pipe(\n          map(_ => new UserActions.UpdatePasswordSuccess()),\n          catchError(error =>\n            of(new UserActions.UpdatePasswordFail(makeErrorSerializable(error)))\n          )\n        )\n    )\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, tap } from 'rxjs/operators';\nimport {\n  GlobalMessageService,\n  GlobalMessageType,\n} from '../../../global-message/index';\nimport { Address } from '../../../model/address.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserAddressConnector } from '../../connectors/address/user-address.connector';\nimport { UserAddressService } from '../../facade/user-address.service';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserAddressesEffects {\n  @Effect()\n  loadUserAddresses$: Observable<\n    UserActions.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_ADDRESSES),\n    map((action: UserActions.LoadUserAddresses) => action.payload),\n    mergeMap(payload => {\n      return this.userAddressConnector.getAll(payload).pipe(\n        map((addresses: Address[]) => {\n          return new UserActions.LoadUserAddressesSuccess(addresses);\n        }),\n        catchError(error =>\n          of(\n            new UserActions.LoadUserAddressesFail(makeErrorSerializable(error))\n          )\n        )\n      );\n    })\n  );\n\n  @Effect()\n  addUserAddress$: Observable<\n    UserActions.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.ADD_USER_ADDRESS),\n    map((action: UserActions.AddUserAddress) => action.payload),\n    mergeMap(payload => {\n      return this.userAddressConnector\n        .add(payload.userId, payload.address)\n        .pipe(\n          map((data: any) => {\n            return new UserActions.AddUserAddressSuccess(data);\n          }),\n          catchError(error =>\n            of(new UserActions.AddUserAddressFail(makeErrorSerializable(error)))\n          )\n        );\n    })\n  );\n\n  @Effect()\n  updateUserAddress$: Observable<\n    UserActions.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.UPDATE_USER_ADDRESS),\n    map((action: UserActions.UpdateUserAddress) => action.payload),\n    mergeMap(payload => {\n      return this.userAddressConnector\n        .update(payload.userId, payload.addressId, payload.address)\n        .pipe(\n          map(data => {\n            // don't show the message if just setting address as default\n            if (\n              payload.address &&\n              Object.keys(payload.address).length === 1 &&\n              payload.address.defaultAddress\n            ) {\n              return new UserActions.LoadUserAddresses(payload.userId);\n            } else {\n              return new UserActions.UpdateUserAddressSuccess(data);\n            }\n          }),\n          catchError(error =>\n            of(\n              new UserActions.UpdateUserAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  deleteUserAddress$: Observable<\n    UserActions.UserAddressesAction\n  > = this.actions$.pipe(\n    ofType(UserActions.DELETE_USER_ADDRESS),\n    map((action: UserActions.DeleteUserAddress) => action.payload),\n    mergeMap(payload => {\n      return this.userAddressConnector\n        .delete(payload.userId, payload.addressId)\n        .pipe(\n          map(data => {\n            return new UserActions.DeleteUserAddressSuccess(data);\n          }),\n          catchError(error =>\n            of(\n              new UserActions.DeleteUserAddressFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  /**\n   *  Reload addresses and notify about add success\n   */\n  @Effect({ dispatch: false })\n  showGlobalMessageOnAddSuccess$ = this.actions$.pipe(\n    ofType(UserActions.ADD_USER_ADDRESS_SUCCESS),\n    tap(() => {\n      this.loadAddresses();\n      this.showGlobalMessage('addressForm.userAddressAddSuccess');\n    })\n  );\n\n  /**\n   *  Reload addresses and notify about update success\n   */\n  @Effect({ dispatch: false })\n  showGlobalMessageOnUpdateSuccess$ = this.actions$.pipe(\n    ofType(UserActions.UPDATE_USER_ADDRESS_SUCCESS),\n    tap(() => {\n      this.loadAddresses();\n      this.showGlobalMessage('addressForm.userAddressUpdateSuccess');\n    })\n  );\n\n  /**\n   *  Reload addresses and notify about delete success\n   */\n  @Effect({ dispatch: false })\n  showGlobalMessageOnDeleteSuccess$ = this.actions$.pipe(\n    ofType(UserActions.DELETE_USER_ADDRESS_SUCCESS),\n    tap(() => {\n      this.loadAddresses();\n      this.showGlobalMessage('addressForm.userAddressDeleteSuccess');\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userAddressConnector: UserAddressConnector,\n    private userAddressService: UserAddressService,\n    private messageService: GlobalMessageService\n  ) {}\n\n  /**\n   * Show global confirmation message with provided text\n   */\n  private showGlobalMessage(text: string) {\n    this.messageService.add(\n      { key: text },\n      GlobalMessageType.MSG_TYPE_CONFIRMATION\n    );\n  }\n\n  private loadAddresses() {\n    this.userAddressService.loadAddresses();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map } from 'rxjs/operators';\nimport { GlobalMessageType } from '../../../global-message/models/global-message.model';\nimport { GlobalMessageActions } from '../../../global-message/store/actions';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConsentConnector } from '../../connectors/consent/user-consent.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserConsentsEffect {\n  @Effect()\n  resetConsents$: Observable<\n    UserActions.ResetLoadUserConsents\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LANGUAGE_CHANGE),\n    map(() => new UserActions.ResetLoadUserConsents())\n  );\n\n  @Effect()\n  getConsents$: Observable<UserActions.UserConsentsAction> = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_CONSENTS),\n    map((action: UserActions.LoadUserConsents) => action.payload),\n    concatMap(userId =>\n      this.userConsentConnector.loadConsents(userId).pipe(\n        map(consents => new UserActions.LoadUserConsentsSuccess(consents)),\n        catchError(error =>\n          of(new UserActions.LoadUserConsentsFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  @Effect()\n  giveConsent$: Observable<\n    UserActions.UserConsentsAction | GlobalMessageActions.RemoveMessagesByType\n  > = this.actions$.pipe(\n    ofType<UserActions.GiveUserConsent | UserActions.TransferAnonymousConsent>(\n      UserActions.GIVE_USER_CONSENT,\n      UserActions.TRANSFER_ANONYMOUS_CONSENT\n    ),\n    concatMap(action =>\n      this.userConsentConnector\n        .giveConsent(\n          action.payload.userId,\n          action.payload.consentTemplateId,\n          action.payload.consentTemplateVersion\n        )\n        .pipe(\n          map(consent => new UserActions.GiveUserConsentSuccess(consent)),\n          catchError(error => {\n            const errors: Array<\n              | UserActions.UserConsentsAction\n              | GlobalMessageActions.RemoveMessagesByType\n            > = [\n              new UserActions.GiveUserConsentFail(makeErrorSerializable(error)),\n            ];\n            if (\n              action.type === UserActions.TRANSFER_ANONYMOUS_CONSENT &&\n              error.status === 409\n            ) {\n              errors.push(\n                new GlobalMessageActions.RemoveMessagesByType(\n                  GlobalMessageType.MSG_TYPE_ERROR\n                )\n              );\n            }\n            return of(...errors);\n          })\n        )\n    )\n  );\n\n  @Effect()\n  withdrawConsent$: Observable<\n    UserActions.UserConsentsAction\n  > = this.actions$.pipe(\n    ofType(UserActions.WITHDRAW_USER_CONSENT),\n    map((action: UserActions.WithdrawUserConsent) => action.payload),\n    concatMap(({ userId, consentCode }) =>\n      this.userConsentConnector.withdrawConsent(userId, consentCode).pipe(\n        map(() => new UserActions.WithdrawUserConsentSuccess()),\n        catchError(error =>\n          of(\n            new UserActions.WithdrawUserConsentFail(\n              makeErrorSerializable(error)\n            )\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userConsentConnector: UserConsentConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, concatMap, map, mergeMap } from 'rxjs/operators';\nimport { User } from '../../../model/misc.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserDetailsEffects {\n  @Effect()\n  loadUserDetails$: Observable<\n    UserActions.UserDetailsAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_DETAILS),\n    map((action: UserActions.LoadUserDetails) => action.payload),\n    mergeMap(userId => {\n      return this.userConnector.get(userId).pipe(\n        map((user: User) => {\n          return new UserActions.LoadUserDetailsSuccess(user);\n        }),\n        catchError(error =>\n          of(new UserActions.LoadUserDetailsFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  @Effect()\n  updateUserDetails$: Observable<\n    UserActions.UpdateUserDetailsSuccess | UserActions.UpdateUserDetailsFail\n  > = this.actions$.pipe(\n    ofType(UserActions.UPDATE_USER_DETAILS),\n    map((action: UserActions.UpdateUserDetails) => action.payload),\n    concatMap(payload =>\n      this.userConnector.update(payload.username, payload.userDetails).pipe(\n        map(_ => new UserActions.UpdateUserDetailsSuccess(payload.userDetails)),\n        catchError(error =>\n          of(\n            new UserActions.UpdateUserDetailsFail(makeErrorSerializable(error))\n          )\n        )\n      )\n    )\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { OrderHistoryList } from '../../../model/order.model';\nimport { SiteContextActions } from '../../../site-context/store/actions/index';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserOrderConnector } from '../../connectors/order/user-order.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserOrdersEffect {\n  constructor(\n    private actions$: Actions,\n    private orderConnector: UserOrderConnector\n  ) {}\n\n  @Effect()\n  loadUserOrders$: Observable<\n    UserActions.UserOrdersAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_USER_ORDERS),\n    map((action: UserActions.LoadUserOrders) => action.payload),\n    switchMap(payload => {\n      return this.orderConnector\n        .getHistory(\n          payload.userId,\n          payload.pageSize,\n          payload.currentPage,\n          payload.sort\n        )\n        .pipe(\n          map((orders: OrderHistoryList) => {\n            return new UserActions.LoadUserOrdersSuccess(orders);\n          }),\n          catchError(error =>\n            of(new UserActions.LoadUserOrdersFail(makeErrorSerializable(error)))\n          )\n        );\n    })\n  );\n\n  @Effect()\n  resetUserOrders$: Observable<\n    UserActions.ClearUserOrders\n  > = this.actions$.pipe(\n    ofType(SiteContextActions.LANGUAGE_CHANGE),\n    map(() => {\n      return new UserActions.ClearUserOrders();\n    })\n  );\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap, switchMap } from 'rxjs/operators';\nimport { AuthActions } from '../../../auth/store/actions/index';\nimport { UserSignUp } from '../../../model/misc.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\nimport { UserConnector } from '../../connectors/user/user.connector';\nimport { UserActions } from '../actions/index';\n\n@Injectable()\nexport class UserRegisterEffects {\n  @Effect()\n  registerUser$: Observable<\n    UserActions.UserRegisterOrRemoveAction\n  > = this.actions$.pipe(\n    ofType(UserActions.REGISTER_USER),\n    map((action: UserActions.RegisterUser) => action.payload),\n    mergeMap((user: UserSignUp) =>\n      this.userConnector.register(user).pipe(\n        map(() => new UserActions.RegisterUserSuccess()),\n        catchError(error =>\n          of(new UserActions.RegisterUserFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  @Effect()\n  registerGuest$: Observable<\n    UserActions.UserRegisterOrRemoveAction | AuthActions.LoadUserToken\n  > = this.actions$.pipe(\n    ofType(UserActions.REGISTER_GUEST),\n    map((action: UserActions.RegisterGuest) => action.payload),\n    mergeMap(({ guid, password }) =>\n      this.userConnector.registerGuest(guid, password).pipe(\n        switchMap(user => [\n          new AuthActions.LoadUserToken({\n            userId: user.uid,\n            password: password,\n          }),\n          new UserActions.RegisterGuestSuccess(),\n        ]),\n        catchError(error =>\n          of(new UserActions.RegisterGuestFail(makeErrorSerializable(error)))\n        )\n      )\n    )\n  );\n\n  @Effect()\n  removeUser$: Observable<\n    UserActions.UserRegisterOrRemoveAction | AuthActions.Logout\n  > = this.actions$.pipe(\n    ofType(UserActions.REMOVE_USER),\n    map((action: UserActions.RemoveUser) => action.payload),\n    mergeMap((userId: string) => {\n      return this.userConnector.remove(userId).pipe(\n        switchMap(_result => [\n          new UserActions.RemoveUserSuccess(),\n          new AuthActions.Logout(),\n        ]),\n        catchError(error =>\n          of(new UserActions.RemoveUserFail(makeErrorSerializable(error)))\n        )\n      );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private userConnector: UserConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\nimport * as fromCustomerCouponsAction from '../actions/customer-coupon.action';\nimport { CustomerCouponConnector } from '../../connectors/customer-coupon/customer-coupon.connector';\nimport { CustomerCouponSearchResult } from '../../../model/customer-coupon.model';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\n\n@Injectable()\nexport class CustomerCouponEffects {\n  @Effect()\n  loadCustomerCoupons$: Observable<\n    fromCustomerCouponsAction.CustomerCouponAction\n  > = this.actions$.pipe(\n    ofType(fromCustomerCouponsAction.LOAD_CUSTOMER_COUPONS),\n    map(\n      (action: fromCustomerCouponsAction.LoadCustomerCoupons) => action.payload\n    ),\n    mergeMap(payload => {\n      return this.customerCouponConnector\n        .getCustomerCoupons(\n          payload.userId,\n          payload.pageSize,\n          payload.currentPage,\n          payload.sort\n        )\n        .pipe(\n          map((coupons: CustomerCouponSearchResult) => {\n            return new fromCustomerCouponsAction.LoadCustomerCouponsSuccess(\n              coupons\n            );\n          }),\n          catchError(error =>\n            of(\n              new fromCustomerCouponsAction.LoadCustomerCouponsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  subscribeCustomerCoupon$: Observable<\n    fromCustomerCouponsAction.CustomerCouponAction\n  > = this.actions$.pipe(\n    ofType(fromCustomerCouponsAction.SUBSCRIBE_CUSTOMER_COUPON),\n    map(\n      (action: fromCustomerCouponsAction.SubscribeCustomerCoupon) =>\n        action.payload\n    ),\n    mergeMap(payload => {\n      return this.customerCouponConnector\n        .turnOnNotification(payload.userId, payload.couponCode)\n        .pipe(\n          map((data: any) => {\n            return new fromCustomerCouponsAction.SubscribeCustomerCouponSuccess(\n              data\n            );\n          }),\n          catchError(error =>\n            of(\n              new fromCustomerCouponsAction.SubscribeCustomerCouponFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  unsubscribeCustomerCoupon$: Observable<\n    fromCustomerCouponsAction.CustomerCouponAction\n  > = this.actions$.pipe(\n    ofType(fromCustomerCouponsAction.UNSUBSCRIBE_CUSTOMER_COUPON),\n    map(\n      (action: fromCustomerCouponsAction.UnsubscribeCustomerCoupon) =>\n        action.payload\n    ),\n    mergeMap(payload => {\n      return this.customerCouponConnector\n        .turnOffNotification(payload.userId, payload.couponCode)\n        .pipe(\n          map(() => {\n            return new fromCustomerCouponsAction.UnsubscribeCustomerCouponSuccess(\n              payload.couponCode\n            );\n          }),\n          catchError(error =>\n            of(\n              new fromCustomerCouponsAction.UnsubscribeCustomerCouponFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  claimCustomerCoupon$: Observable<\n    fromCustomerCouponsAction.CustomerCouponAction\n  > = this.actions$.pipe(\n    ofType(fromCustomerCouponsAction.CLAIM_CUSTOMER_COUPON),\n    map(\n      (action: fromCustomerCouponsAction.ClaimCustomerCoupon) => action.payload\n    ),\n    mergeMap(payload => {\n      return this.customerCouponConnector\n        .claimCustomerCoupon(payload.userId, payload.couponCode)\n        .pipe(\n          map(data => {\n            return new fromCustomerCouponsAction.ClaimCustomerCouponSuccess(\n              data\n            );\n          }),\n          catchError(error =>\n            of(\n              new fromCustomerCouponsAction.ClaimCustomerCouponFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  constructor(\n    private actions$: Actions,\n    private customerCouponConnector: CustomerCouponConnector\n  ) {}\n}\n","import { Injectable } from '@angular/core';\n\nimport { Effect, Actions, ofType } from '@ngrx/effects';\nimport { Action } from '@ngrx/store';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap, catchError } from 'rxjs/operators';\nimport { UserActions } from '../actions/index';\nimport { ProductInterestSearchResult } from '../../../model/product-interest.model';\nimport { UserInterestsConnector } from '../../connectors/interests/user-interests.connector';\nimport { makeErrorSerializable } from '../../../util/serialization-utils';\n\n@Injectable()\nexport class ProductInterestsEffect {\n  constructor(\n    private actions$: Actions,\n    private userInterestsConnector: UserInterestsConnector\n  ) {}\n\n  @Effect()\n  loadProductInteres$: Observable<\n    UserActions.ProductInterestsAction\n  > = this.actions$.pipe(\n    ofType(UserActions.LOAD_PRODUCT_INTERESTS),\n    map((action: UserActions.LoadProductInterests) => action.payload),\n    switchMap(payload => {\n      return this.userInterestsConnector\n        .getInterests(\n          payload.userId,\n          payload.pageSize,\n          payload.currentPage,\n          payload.sort,\n          payload.productCode,\n          payload.notificationType\n        )\n        .pipe(\n          map((interests: ProductInterestSearchResult) => {\n            return new UserActions.LoadProductInterestsSuccess(interests);\n          }),\n          catchError(error =>\n            of(\n              new UserActions.LoadProductInterestsFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        );\n    })\n  );\n\n  @Effect()\n  removeProductInterest$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.REMOVE_PRODUCT_INTEREST),\n    map((action: UserActions.RemoveProductInterest) => action.payload),\n    switchMap(payload =>\n      this.userInterestsConnector\n        .removeInterest(payload.userId, payload.item)\n        .pipe(\n          switchMap(data => [\n            new UserActions.LoadProductInterests(\n              payload.singleDelete\n                ? {\n                    userId: payload.userId,\n                    productCode: payload.item.product.code,\n                    notificationType:\n                      payload.item.productInterestEntry[0].interestType,\n                  }\n                : { userId: payload.userId }\n            ),\n            new UserActions.RemoveProductInterestSuccess(data),\n          ]),\n          catchError(error =>\n            of(\n              new UserActions.RemoveProductInterestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    )\n  );\n\n  @Effect()\n  addProductInterest$: Observable<Action> = this.actions$.pipe(\n    ofType(UserActions.ADD_PRODUCT_INTEREST),\n    map((action: UserActions.AddProductInterest) => action.payload),\n    switchMap(payload =>\n      this.userInterestsConnector\n        .addInterest(\n          payload.userId,\n          payload.productCode,\n          payload.notificationType\n        )\n        .pipe(\n          switchMap((res: any) => [\n            new UserActions.LoadProductInterests({\n              userId: payload.userId,\n              productCode: payload.productCode,\n              notificationType: payload.notificationType,\n            }),\n            new UserActions.AddProductInterestSuccess(res),\n          ]),\n          catchError(error =>\n            of(\n              new UserActions.AddProductInterestFail(\n                makeErrorSerializable(error)\n              )\n            )\n          )\n        )\n    )\n  );\n}\n","import { BillingCountriesEffect } from './billing-countries.effect';\nimport { ClearMiscsDataEffect } from './clear-miscs-data.effect';\nimport { ConsignmentTrackingEffects } from './consignment-tracking.effect';\nimport { DeliveryCountriesEffects } from './delivery-countries.effect';\nimport { ForgotPasswordEffects } from './forgot-password.effect';\nimport { NotificationPreferenceEffects } from './notification-preference.effect';\nimport { OrderDetailsEffect } from './order-details.effect';\nimport { OrderReturnRequestEffect } from './order-return-request.effect';\nimport { UserPaymentMethodsEffects } from './payment-methods.effect';\nimport { RegionsEffects } from './regions.effect';\nimport { ResetPasswordEffects } from './reset-password.effect';\nimport { TitlesEffects } from './titles.effect';\nimport { UpdateEmailEffects } from './update-email.effect';\nimport { UpdatePasswordEffects } from './update-password.effect';\nimport { UserAddressesEffects } from './user-addresses.effect';\nimport { UserConsentsEffect } from './user-consents.effect';\nimport { UserDetailsEffects } from './user-details.effect';\nimport { UserOrdersEffect } from './user-orders.effect';\nimport { UserRegisterEffects } from './user-register.effect';\nimport { CustomerCouponEffects } from './customer-coupon.effect';\nimport { ProductInterestsEffect } from './product-interests.effect';\n\nexport const effects: any[] = [\n  ClearMiscsDataEffect,\n  DeliveryCountriesEffects,\n  RegionsEffects,\n  TitlesEffects,\n  UserDetailsEffects,\n  UserAddressesEffects,\n  UserPaymentMethodsEffects,\n  UserRegisterEffects,\n  UserOrdersEffect,\n  OrderDetailsEffect,\n  BillingCountriesEffect,\n  ResetPasswordEffects,\n  ForgotPasswordEffects,\n  UpdateEmailEffects,\n  UpdatePasswordEffects,\n  UserConsentsEffect,\n  ConsignmentTrackingEffects,\n  CustomerCouponEffects,\n  NotificationPreferenceEffects,\n  ProductInterestsEffect,\n  OrderReturnRequestEffect,\n];\n\nexport * from './billing-countries.effect';\nexport * from './clear-miscs-data.effect';\nexport * from './consignment-tracking.effect';\nexport * from './delivery-countries.effect';\nexport * from './notification-preference.effect';\nexport * from './order-details.effect';\nexport * from './order-return-request.effect';\nexport * from './payment-methods.effect';\nexport * from './regions.effect';\nexport * from './reset-password.effect';\nexport * from './titles.effect';\nexport * from './user-addresses.effect';\nexport * from './user-consents.effect';\nexport * from './user-details.effect';\nexport * from './user-orders.effect';\nexport * from './user-register.effect';\nexport * from './customer-coupon.effect';\nexport * from './product-interests.effect';\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { RouterModule } from '@angular/router';\n\nimport { metaReducers, reducerToken, reducerProvider } from './reducers/index';\nimport { effects } from './effects/index';\nimport { USER_FEATURE } from './user-state';\nimport { StateModule } from '../../state/state.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n    StateModule,\n    StoreModule.forFeature(USER_FEATURE, reducerToken, { metaReducers }),\n    EffectsModule.forFeature(effects),\n    RouterModule,\n  ],\n  providers: [reducerProvider],\n})\nexport class UserStoreModule {}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, combineLatest } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport {\n  PageMetaResolver,\n  PageTitleResolver,\n  PageBreadcrumbResolver,\n} from '../../cms/page';\nimport { PageMeta, Page } from '../../cms/model/page.model';\nimport { TranslationService } from '../../i18n/translation.service';\nimport { PageType } from '../../model/cms.model';\nimport { RoutingService } from '../../routing/facade/routing.service';\nimport { ProductSearchService } from '../../product/facade/product-search.service';\nimport { AuthService } from '../../auth/facade/auth.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class FindProductPageMetaResolver extends PageMetaResolver\n  implements PageTitleResolver, PageBreadcrumbResolver {\n  totalAndCode$: Observable<[number, any]> = combineLatest([\n    this.productSearchService.getResults().pipe(\n      filter(data => !!(data && data.pagination)),\n      map(results => results.pagination.totalResults)\n    ),\n    this.routingService.getRouterState().pipe(\n      map(state => state.state.queryParams['couponcode']),\n      filter(Boolean)\n    ),\n  ]);\n\n  constructor(\n    protected routingService: RoutingService,\n    protected productSearchService: ProductSearchService,\n    protected translation: TranslationService,\n    protected authService: AuthService\n  ) {\n    super();\n    this.pageType = PageType.CONTENT_PAGE;\n    this.pageTemplate = 'SearchResultsListPageTemplate';\n  }\n\n  /**\n   * @deprecated since version 1.3\n   *\n   * The resolve method is no longer preferred and will be removed with release 2.0.\n   * The caller `PageMetaService` service is improved to expect all individual resolvers\n   * instead, so that the code is easier extensible.\n   */\n  resolve(): Observable<PageMeta> {\n    return combineLatest([this.resolveTitle(), this.resolveBreadcrumbs()]).pipe(\n      map(([title, breadcrumbs]: [string, any[]]) => ({\n        title,\n        breadcrumbs,\n      }))\n    );\n  }\n\n  resolveBreadcrumbs(): Observable<any[]> {\n    const breadcrumbs = [{ label: 'Home', link: '/' }];\n    this.authService.isUserLoggedIn().subscribe(login => {\n      if (login)\n        breadcrumbs.push({ label: 'My Coupons', link: '/my-account/coupons' });\n    });\n\n    return of(breadcrumbs);\n  }\n\n  resolveTitle(): Observable<string> {\n    return this.totalAndCode$.pipe(\n      switchMap(([total, code]: [number, string]) =>\n        this.translation.translate('pageMetaResolver.search.findProductTitle', {\n          count: total,\n          coupon: code,\n        })\n      )\n    );\n  }\n\n  getScore(page: Page): number {\n    let score = 0;\n    if (this.pageType) {\n      score += page.type === this.pageType ? 1 : -1;\n    }\n    if (this.pageTemplate) {\n      score += page.template === this.pageTemplate ? 1 : -1;\n    }\n    this.routingService\n      .getRouterState()\n      .pipe(\n        map(state => {\n          return state.state.queryParams;\n        }),\n        filter(Boolean)\n      )\n      .subscribe((queryParams: any) => {\n        if (queryParams) {\n          score += queryParams['couponcode'] ? 1 : -1;\n        }\n      })\n      .unsubscribe();\n    return score;\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { UserStoreModule } from './store/user-store.module';\nimport { PageMetaResolver } from '../cms/page/page-meta.resolver';\nimport { FindProductPageMetaResolver } from './services/find-product-page-meta.resolver';\n\n@NgModule({\n  imports: [UserStoreModule],\n})\nexport class UserModule {\n  static forRoot(): ModuleWithProviders<UserModule> {\n    return {\n      ngModule: UserModule,\n      providers: [\n        {\n          provide: PageMetaResolver,\n          useExisting: FindProductPageMetaResolver,\n          multi: true,\n        },\n      ],\n    };\n  }\n}\n","import { filter } from 'rxjs/operators';\n\nimport { EntityLoadAction } from '../entity-loader/entity-loader.action';\nimport { MonoTypeOperatorFunction } from 'rxjs';\n\nexport function ofLoaderLoad(\n  entityType: string\n): MonoTypeOperatorFunction<EntityLoadAction> {\n  return filter(\n    (action: EntityLoadAction) =>\n      action.meta &&\n      action.meta.loader &&\n      action.meta.entityType === entityType &&\n      action.meta.loader.load\n  );\n}\n\nexport function ofLoaderFail(\n  entityType: string\n): MonoTypeOperatorFunction<EntityLoadAction> {\n  return filter(\n    (action: EntityLoadAction) =>\n      action.meta &&\n      action.meta.loader &&\n      action.meta.entityType === entityType &&\n      action.meta.loader.error\n  );\n}\n\nexport function ofLoaderSuccess(\n  entityType: string\n): MonoTypeOperatorFunction<EntityLoadAction> {\n  return filter(\n    (action: EntityLoadAction) =>\n      action.meta &&\n      action.meta.loader &&\n      action.meta.entityType === entityType &&\n      !action.meta.loader.load &&\n      !action.meta.loader.error\n  );\n}\n","export const testestsd = 'sare';\n"]}